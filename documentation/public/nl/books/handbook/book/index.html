<!doctype html><html class=theme-light lang=nl><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/nl/books/handbook/book/><title>FreeBSD handboek | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="FreeBSD handboek"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="nl"><meta property="og:url" content="https://docs.freebsd.org/nl/books/handbook/book/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/nl\/books\/handbook\/book\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/nl>Documentation portal</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/nl/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/nl/books>Books</a></li><li><a href=https://docs.freebsd.org/nl/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/nl/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=nl>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><div class=book><h1 class=title>FreeBSD handboek</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=copyright>Copyright © 1995-2020 The FreeBSD Dutch Documentation Project</div><div class=legalnotice><a id=trademarks></a><details><summary>trademarks</summary><p>FreeBSD is een geregistreerd handelsmerk van de FreeBSD Foundation.</p><p>IBM, AIX, OS/2, PowerPC, PS/2, S/390, en ThinkPad zijn handelsmerken van International Business Machines Corporation in de Verenigde Staten, andere landen, of beide.</p><p>IEEE, POSIX, en 802 zijn geregistreerde handelsmerken van Institute of Electrical and Electronics Engineers, Inc. in de Verenigde Staten.</p><p>Red Hat, RPM, zijn handelsmerken of geregistreerde handelsmerken van Red Hat, Inc. in de Verenigde Staten en andere landen.</p><p>3Com en HomeConnect zijn geregistreerde handelsmerken van 3Com Corporation.</p><p>Adobe, Acrobat, Acrobat Reader, en PostScript zijn òfwel geregistreerde handelsmerken òf handelsmerken van Adobe Systems Incorporated in de Verenigde Staten en/of andere landen.</p><p>Apple, AirPort, FireWire, Mac, Macintosh, Mac OS, Quicktime, en TrueType zijn handelsmerken van Apple Computer, Inc., geregistreerd in de Verenigde Staten en andere landen.</p><p>Intel, Celeron, EtherExpress, i386, i486, Itanium, Pentium, en Xeon zijn handelsmerken of geregistreerde handelsmerken van Intel Corporation of haar dochterondernemingen in de Verenigde Staten en andere landen.</p><p>Linux is een geregistreerd handelsmerk van Linus Torvalds.</p><p>Microsoft, IntelliMouse, MS-DOS, Outlook, Windows, Windows Media en Windows NT zijn òfwel geregistreerde handelsmerken òf handelsmerken van Microsoft Corporation in de Verenigde Staten en/of andere landen.</p><p>Motif, OSF/1, en UNIX zijn geregistreerde handelsmerken en IT DialTone en The Open Group zijn handelsmerken van The Open Group in de Verenigde Staten en andere landen.</p><p>Sun, Sun Microsystems, Java, Java Virtual Machine, JDK, JRE, JSP, JVM, Netra, OpenJDK, Solaris, StarOffice, SunOS en VirtualBox zijn handelsmerken of geregistreerde handelsmerken van Sun Microsystems, Inc. in de Verenigde Staten en andere landen.</p><p>RealNetworks, RealPlayer, en RealAudio zijn de geregistreerde handelsmerken van RealNetworks, Inc.</p><p>Oracle is een geregistreerd handelsmerk van Oracle Corporation.</p><p>3ware en Escalade zijn geregistreerde handelsmerken van 3ware Inc.</p><p>ARM is een geregistreerd handelsmerk van ARM Limited.</p><p>Adaptec is een geregistreerd handelsmerk van Adaptec, Inc.</p><p>Heidelberg, Helvetica, Palatino, en Times Roman zijn òfwel geregistreerde handelsmerken òf handelsmerken van Heidelberger Druckmaschinen AG in de Verenigde Staten en andere landen.</p><p>Intuit en Quicken zijn geregistreerde handelsmerken en/of geregistreerde dienstmerken van Intuit Inc., of een van haar dochterondernemingen, in de Verenigde Staten en andere landen.</p><p>LSI Logic, AcceleRAID, eXtremeRAID, MegaRAID en Mylex zijn handelsmerken of geregistreerde handelsmerken van LSI Logic Corp.</p><p>MATLAB is een geregistreerd handelsmerk van The MathWorks, Inc.</p><p>SpeedTouch is een handelsmerk van Thomson.</p><p>VMware is een handelsmerk van VMware, Inc.</p><p>Mathematica is een geregistreerd handelsmerk van Wolfram Research, Inc.</p><p>Ogg Vorbis en Xiph.Org zijn handelsmerken van Xiph.Org.</p><p>XFree86 is een handelsmerk van The XFree86 Project, Inc.</p><p>Veel van de termen die door fabrikanten en verkopers worden gebruikt om hun producten te onderscheiden worden geclaimd als handelsmerk. Op de plaatsen waar deze handelsmerken in dit document voorkomen, en het &amp;os; Project op de hoogte was van de claim op het handelsmerk, worden de termen gevolgd door het symbool “™” of het symbool “®”.</p></details></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#book-preface>Voorwoord</a><ul><li><a href=#preface-audience>Bedoeld publiek</a></li><li><a href=#preface-changes-from3>Wijzigingen ten opzichte van de derde editie</a></li><li><a href=#preface-changes-from2>Wijzigingen ten opzichte van de tweede editie (2004)</a></li><li><a href=#preface-changes>Veranderingen ten opzichte van de eerste editie (2001)</a></li><li><a href=#preface-overview>De opbouw van dit boek</a></li><li><a href=#preface-conv>Overeenkomsten in dit boek</a></li><li><a href=#preface-acknowledgements>Dankwoorden</a></li></ul></li><li><a href=#getting-started>Deel I: Beginnen</a><ul><li><a href=#introduction>Hoofdstuk 1. Introductie</a></li><li><a href=#install>Hoofdstuk 2. FreeBSD installeren op FreeBSD 8.X en eerder</a></li><li><a href=#bsdinstall>Hoofdstuk 3. FreeBSD 9.X en nieuwer installeren</a></li><li><a href=#basics>Hoofdstuk 4. UNIX® beginselen</a></li><li><a href=#ports>Hoofdstuk 5. Applicaties installeren: pakketten en ports</a></li><li><a href=#x11>Hoofdstuk 6. Het X Window systeem</a></li></ul></li><li><a href=#common-tasks>Deel II: Algemene taken</a><ul><li><a href=#desktop>Hoofdstuk 7. Bureaubladapplicaties</a></li><li><a href=#multimedia>Hoofdstuk 8. Multimedia</a></li><li><a href=#kernelconfig>Hoofdstuk 9. De FreeBSD-kernel instellen</a></li><li><a href=#printing>Hoofdstuk 10. Afdrukken</a></li><li><a href=#linuxemu>Hoofdstuk 11. Linux® binaire compatibiliteit</a></li></ul></li><li><a href=#system-administration>Deel III: Systeembeheer</a><ul><li><a href=#config-tuning>Hoofdstuk 12. Instellingen en optimalisatie</a></li><li><a href=#boot>Hoofdstuk 13. Het FreeBSD opstartproces</a></li><li><a href=#users>Hoofdstuk 14. Gebruikers- en basisaccountbeheer</a></li><li><a href=#security>Hoofdstuk 15. Beveiliging</a></li><li><a href=#jails>Hoofdstuk 16. Jails</a></li><li><a href=#mac>Hoofdstuk 17. Verplichte Toegangscontrole (MAC)</a></li><li><a href=#audit>Hoofdstuk 18. Security Event Auditing</a></li><li><a href=#disks>Hoofdstuk 19. Opslag</a></li><li><a href=#geom>Hoofdstuk 20. GEOM. Modulair schijftransformatie raamwerk</a></li><li><a href=#filesystems>Hoofdstuk 21. Ondersteuning van bestandssystemen</a></li><li><a href=#virtualization>Hoofdstuk 22. Virtualisatie</a></li><li><a href=#l10n>Hoofdstuk 23. Lokalisatie - I18N/L10N gebruiken en instellen</a></li><li><a href=#updating-upgrading>Hoofdstuk 24. FreeBSD updaten en upgraden</a></li><li><a href=#dtrace>Hoofdstuk 25. DTrace</a></li></ul></li><li><a href=#network-communication>Deel IV: Netwerkcommunicatie</a><ul><li><a href=#serialcomms>Hoofdstuk 26. Seriële communicatie</a></li><li><a href=#ppp-and-slip>Hoofdstuk 27. PPP en SLIP</a></li><li><a href=#mail>Hoofdstuk 28. Elektronische mail</a></li><li><a href=#network-servers>Hoofdstuk 29. Netwerkdiensten</a></li><li><a href=#firewalls>Hoofdstuk 30. Firewalls</a></li><li><a href=#advanced-networking>Hoofdstuk 31. Geavanceerde netwerken</a></li></ul></li><li><a href=#appendices>Deel V: Appendix</a><ul><li><a href=#mirrors>Bijlage A: FreeBSD verkrijgen</a></li><li><a href=#bibliography>Bijlage B: Bibliography</a></li><li><a href=#eresources>Bijlage C: Bronnen op Internet</a></li><li><a href=#pgpkeys>Bijlage D: PGP sleutels</a></li></ul></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody><div class="quoteblock abstract abstract-title"><blockquote>Samenvatting</blockquote></div><div class=paragraph><p>Welkom bij FreeBSD! Dit handboek behandelt de installatie en het dagelijks gebruik van <em>FreeBSD 11.2-RELEASE</em> en <em>FreeBSD 12.0-RELEASE</em>. Aan deze handleiding wordt nog gewerkt, en is het resultaat van het werk van veel mensen. Veel hoofdstukken of paragrafen bestaan nog niet en wat bestaat dient soms nog bijgewerkt te worden. Als de lezer mee wil helpen aan dit project kan een mail gestuurd worden naar de <a href=https://lists.FreeBSD.org/subscription/freebsd-doc>FreeBSD documentatieproject mailinglijst</a>. De meest recente versie van dit document is te vinden op de <a href=http://www.FreeBSD.org/>FreeBSD website</a>. Eerdere versies van dit handboek zijn te vinden op <a href=http://docs.FreeBSD.org/doc/>http://docs.FreeBSD.org/doc/</a>. Het kan ook gedownload worden in veel verschillende formaten en compressiewijzen van de <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/>FreeBSD FTP server</a> of een van de vele <a href=#mirrors-ftp>mirrorsites</a>. Een gedrukt exemplaar van het handboek is te koop bij de <a href=http://www.freebsdmall.com/>FreeBSD Mall</a> (Engels). Het handboek kan ook <a href=https://www.FreeBSD.org/search/>doorzocht worden</a>.</p></div><hr></div></div><div class=sect1><h2 id=book-preface>Voorwoord<a class=anchor href=#book-preface></a></h2><div class=sectionbody><div class=sect2><h3 id=preface-audience>Bedoeld publiek<a class=anchor href=#preface-audience></a></h3><div class=paragraph><p>De nieuwkomers bij FreeBSD zullen zien dat de eerste sectie van dit boek ze begeleidt door de FreeBSD installatieprocedure en de geleidelijke introductie in de concepten van UNIX®. Om deze sectie goed te kunnen doorlopen is meer nodig dan de wens om te ontdekken en de mogelijkheid om nieuwe concepten op te nemen wanneer ze geïntroduceerd worden.</p></div><div class=paragraph><p>De tweede, veel grotere, sectie van het handboek is een uitvoerige referentie naar alle mogelijke (relevante) onderwerpen die interessant zijn voor FreeBSD systeembeheerders. Sommige van deze hoofdstukken adviseren mogelijk om eerdere documentatie te lezen. Dit wordt aangegeven in de samenvatting aan het begin van elk hoofdstuk.</p></div><div class=paragraph><p>Voor een lijst van extra bronnen van informatie zie <a href=./#bibliography>Bibliografie</a>.</p></div></div><div class=sect2><h3 id=preface-changes-from3>Wijzigingen ten opzichte van de derde editie<a class=anchor href=#preface-changes-from3></a></h3><div class=paragraph><p>De huidige online versie van het Handboek representeert de gezamenlijke inspanning van vele honderden bijdragende vrijwilligers van de laatste 10 jaar. Hieronder staan enkele van de belangrijke wijzigingen sinds de tweedelige derde editie in 2004 werd uitgegeven:</p></div><div class=ulist><ul><li><p><a href=./#dtrace>DTrace</a>, DTrace, is toegevoegd met informatie over het krachtige prestatie-analysegereedschap DTrace.</p></li><li><p><a href=./#filesystems>Ondersteuning van bestandssystemen</a>, Ondersteuning voor bestandssystemen, is toegevoegd met informatie over vreemde bestandssystemen in FreeBSD, zoals ZFS van Sun™.</p></li><li><p><a href=./#audit>Security Event Auditing</a>, Beveiliginsgebeurtenissen auditen, is toegevoegd om de nieuwe auditing-mogelijkheden van FreeBSD te bespreken en het gebruik ervan uit te leggen.</p></li><li><p><a href=./#virtualization>Virtualisatie</a>, Virtualisatie, is toegevoegd met informatie over het installeren van FreeBSD op virtualisatiesoftware.</p></li><li><p><a href=./#bsdinstall>FreeBSD 9.X en nieuwer installeren</a>, FreeBSD 9.<em>X</em> en nieuwer installeren, is toegevoegd om het installeren van FreeBSD met het nieuwe installatiegereedschap, bsdinstall te behandelen.</p></li></ul></div></div><div class=sect2><h3 id=preface-changes-from2>Wijzigingen ten opzichte van de tweede editie (2004)<a class=anchor href=#preface-changes-from2></a></h3><div class=paragraph><p>De derde editie was het resultaat van meer dan twee jaar werk van de toegewijde leden van het FreeBSD Documentation Project. De gedrukte editie werd zo groot dat het noodzakelijk was om het was om het als twee afzonderlijke delen te publiceren. Hieronder staan de grootste veranderingen in deze nieuwe editie:</p></div><div class=ulist><ul><li><p><a href=./#config-tuning>Configuration et optimisation</a>, Instellingen en optimalisatie, is uitgebreid met nieuwe informatie over ACPI power en resource management, het systeemhulpprogramma <code>cron</code> en er staan meer opties voor het optimaliseren van de kernel beschreven.</p></li><li><p><a href=./#security>Sécurité</a>, Beveiliging, is uitgebreid met meer informatie over virtuele private netwerken (VPN’s), toegangscontrolelijsten voor het bestandssysteem (ACL’s) en beveiligingswaarschuwingen.</p></li><li><p><a href=./#mac>Mandatory Access Control</a>, Verplichte toegangscontrole (MAC), is een nieuw hoofdstuk in deze editie. Er wordt in uitgelegd wat MAC is en hoe het gebruikt kan worden om FreeBSD te beveiligen.</p></li><li><p><a href=./#disks>Stockage des données</a>, Opslag, is uitgebreid met informatie over USB opslagapparaten, snapshots van bestandssystemen, bestandssystemen op basis van bestanden en het netwerk en versleutelde partities op schijven.</p></li><li><p>Aan <a href=./#ppp-and-slip>PPP et SLIP</a>, PPP en SLIP, is een paragraaf toegevoegd over problemen oplossen.</p></li><li><p><a href=./#mail>Courrier électronique</a>, E-mail, is uitgebreid met informatie over alternatieve transport programma’s, SMTP authenticatie, UUCP, fetchmail, procmail en een aantal andere gevorderde onderwerpen.</p></li><li><p><a href=./#network-servers>Serveurs réseau</a>, Netwerkdiensten, is nieuw in deze editie. Dit hoofdstuk bevat informatie over het opzetten van een Apache HTTP Server, ftpd en het opzetten van een server voor Microsoft® Windows® clients met Samba. Een aantal paragrafen uit <a href=./#advanced-networking>Geavanceerd netwerken</a>, Geavanceerde Netwerken, zijn om reden van presentatie naar dit hoofdstuk verplaatst.</p></li><li><p><a href=./#advanced-networking>Geavanceerd netwerken</a>, Netwerken voor gevorderden, is uitgebreid met informatie over het gebruik van Bluetooth® apparaten met FreeBSD, het opzetten van draadloze netwerken en Asynchronous Transfer Mode (ATM) netwerken.</p></li><li><p>Er is een termenoverzicht toegevoegd als centrale locatie voor definities van technische termen die in dit boek gebruikt worden.</p></li><li><p>Tenslotte zijn er nog veel esthetische wijzigingen doorgevoerd aan tabellen en figuren in het boek.</p></li></ul></div></div><div class=sect2><h3 id=preface-changes>Veranderingen ten opzichte van de eerste editie (2001)<a class=anchor href=#preface-changes></a></h3><div class=paragraph><p>Deze tweede editie is een optelsom van meer dan twee jaar werk door vaste leden van het FreeBSD Documentation Project. Het volgende zijn de grote wijzigingen in deze editie:</p></div><div class=ulist><ul><li><p>Er is een complete INDEX toegevoegd.</p></li><li><p>Alle ASCII-figuren zijn vervangen door grafische diagrammen.</p></li><li><p>Aan elk hoofdstuk is een standaardsamenvatting toegevoegd om een snel overzicht te geven welke informatie zich in het hoofdstuk bevindt en wat de lezer geacht wordt te weten.</p></li><li><p>De inhoud is logisch ingedeeld in drie delen: "Starten", "Systeembeheer" en "Appendix".</p></li><li><p><a href=./#install>FreeBSD installeren op FreeBSD 8.X en eerder</a> ("FreeBSD installeren") is compleet herschreven met veel schermafdrukken erbij om het makkelijker te maken voor nieuwe gebruikers om greep te krijgen op de tekst.</p></li><li><p><a href=./#basics>UNIX® beginselen</a> ("UNIX® beginselen") is uitgebreid met extra informatie over processen, daemons en signalen.</p></li><li><p><a href=./#ports>Applicaties installeren. pakketten en ports</a> ("Applicaties installeren") is uitgebreid met extra informatie over binair package-beheer.</p></li><li><p><a href=./#x11>Het X Window systeem</a> ("Het X Window systeem") is compleet herschreven met de nadruk op het gebruik van moderne bureaubladtechnologiën zoals KDE en GNOME op XFree86™ 4.X.</p></li><li><p><a href=./#boot>Het FreeBSD Opstartproces</a> ("Het FreeBSD Opstartproces") is uitgebreid.</p></li><li><p><a href=./#disks>Opslag</a> ("Opslag") is herschreven uit wat eens twee aparte hoofdstukken waren over "schijven" en "back-ups". We vinden dat de onderwerpen beter begrijpbaar zijn wanneer ze in één hoofdstuk zijn ondergebracht. Er is ook een sectie over RAID (zowel hardware- als softwarematig) toegevoegd.</p></li><li><p><a href=./#serialcomms>Seriële communicatie</a> ("Seriële communicatie") is compleet gereorganiseerd en bijgewerkt voor FreeBSD 4.X/5.X.</p></li><li><p><a href=./#ppp-and-slip>PPP en SLIP</a> ("PPP en SLIP") is aanzienlijk bijgewerkt.</p></li><li><p>Veel nieuwe secties zijn toegevoegd aan <a href=./#advanced-networking>Geavanceerd netwerken</a> ("Geavanceerd netwerken").</p></li><li><p><a href=./#mail>Elektronische mail</a> ("E-mail") is uitgebreid met meer informatie over het instellen van sendmail.</p></li><li><p><a href=./#linuxemu>Linux® binaire compatibiliteit</a> ("Linux® binaire compatibiliteit") is uitgebreid met informatie over het installeren van Oracle®.</p></li><li><p>De volgende nieuwe onderwerpen worden behandeld in de tweede editie:</p><div class=ulist><ul><li><p>Instellingen en optimalisatie (<a href=./#config-tuning>Instellingen en optimalisatie</a>).</p></li><li><p>Multimedia (<a href=./#multimedia>Multimedia</a>)</p></li></ul></div></li></ul></div></div><div class=sect2><h3 id=preface-overview>De opbouw van dit boek<a class=anchor href=#preface-overview></a></h3><div class=paragraph><p>Dit boek is opgedeeld in vijf logische secties. De eerste sectie, <em>Beginnen</em>, behandelt de installatie en het basisgebruik van FreeBSD. Er wordt verwacht dat lezers deze hoofdstukken volgt, en mogelijk hoofdstukken overslaat met bekende onderwerpen. De tweede sectie, <em>Algemene Taken</em>, behandelt veelgebruikte functies van FreeBSD. Deze sectie en alle volgende kunnen in een willekeurige volgorde gelezen worden. Iedere sectie begint met een beknopte samenvatting die beschrijft wat het hoofdstuk inhoudt en wat de lezer al moet weten. Dit is bedoeld om de lezer de kans te geven alleen dat te lezen wat voor hem van belang is. In de derde sectie, <em>Systeembeheer</em>, wordt het beheer behandeld. De vierde sectie, <em>Netwerkcommunicatie</em>, gaat over netwerken en servers. De vijfde sectie bevat appendices met referentiemateriaal.</p></div><div class=dlist><dl><dt class=hdlist1><em><a href=./#introduction>Introductie</a>, Introductie</em></dt><dd><p>Introduceert FreeBSD aan een nieuwe gebruiker. Het beschrijft de geschiedenis van het FreeBSD project, de doelen en het ontwikkelmodel.</p></dd><dt class=hdlist1><em><a href=./#install>FreeBSD installeren op FreeBSD 8.X en eerder</a>, Installatie van FreeBSD 8._X</em> en eerder_</dt><dd><p>Begeleidt de gebruiker door het gehele installatieproces van FreeBSD 8.<em>X</em> en eerder door middel van sysinstall. Sommige geavanceerde onderwerpen over installeren, zoals installeren via een seriële console, worden ook behandeld.</p></dd><dt class=hdlist1><em><a href=./#bsdinstall>FreeBSD 9.X en nieuwer installeren</a>, Installatie van FreeBSD 9._X</em> en nieuwer_</dt><dd><p>Begeleidt een gebruiker door het gehele installatieproces van FreeBSD 9.<em>X</em> en nieuwer door middel van bsdinstall.</p></dd><dt class=hdlist1><em><a href=./#basics>UNIX® beginselen</a>, UNIX® beginselen</em></dt><dd><p>Behandelt de basiscommando’s en functionaliteit van het FreeBSD besturingssysteem. Als de lezer bekend is met Linux® of een andere UNIX® variant, kan dit hoofdstuk waarschijnlijk overgeslagen worden.</p></dd><dt class=hdlist1><em><a href=./#ports>Applicaties installeren. pakketten en ports</a>, Applicaties installeren</em></dt><dd><p>Behandelt de installatie van software van derden, met zowel FreeBSD’s innovatieve "Portscollectie" als de standaard binaire packages.</p></dd><dt class=hdlist1><em><a href=./#x11>Het X Window systeem</a>, Het X Window systeem</em></dt><dd><p>Beschrijft het X Window systeem in het algemeen en het gebruik van X11 op FreeBSD in het bijzonder. Het beschrijft ook standaard bureaubladomgevingen zoals KDE en GNOME.</p></dd><dt class=hdlist1><em><a href=./#desktop>Bureaubladapplicaties</a></em>, Bureaubladapplicaties_</dt><dd><p>Levert standaard bureaubladapplicaties in een lijst, zoals webbrowsers en productiviteitspakketten, en beschrijft hoe ze te installeren op FreeBSD.</p></dd><dt class=hdlist1><em><a href=./#multimedia>Multimedia</a>, Multimedia</em></dt><dd><p>Laat zien hoe geluid- en video-ondersteuning te installeren voor een systeem. Het beschrijft ook een aantal voorbeeld audio- en video- applicaties.</p></dd><dt class=hdlist1><em><a href=./#kernelconfig>De FreeBSD-kernel instellen</a>, Instellen van de FreeBSD kernel</em></dt><dd><p>Beschrijft waarom misschien een nieuwe kernel ingesteld moet worden en levert gedetailleerde instructies voor het instellen, bouwen en installeren van een eigen kernel.</p></dd><dt class=hdlist1><em><a href=./#printing>Afdrukken</a>, Afdrukken</em></dt><dd><p>Beschrijft hoe printers beheerd worden onder FreeBSD, met informatie over bannerpagina’s, afdruk-accounting en initiële installatie.</p></dd><dt class=hdlist1><em><a href=./#linuxemu>Linux® binaire compatibiliteit</a>, Linux® binaire compatibiliteit</em></dt><dd><p>Beschrijft de mogelijkheden van FreeBSD voor binaire compatibiliteit met Linux®. Het biedt ook gedetailleerde installatie-instructies voor vele populaire Linux® applicaties zoals Oracle®, SAP® R/3®, en Mathematica®.</p></dd><dt class=hdlist1>_<a href=./#config-tuning>Instellingen en optimalisatie</a>, Instellingen en optimalisatie _</dt><dd><p>Beschrijft de parameters beschikbaar voor systeembeheerders om een FreeBSD te optimaliseren voor de beste prestaties. Het beschrijft ook diverse instellingenbestanden die gebruikt worden in FreeBSD en waar die te vinden zijn.</p></dd><dt class=hdlist1><em><a href=./#boot>Het FreeBSD opstartproces</a>, Het FreeBSD opstartproces</em></dt><dd><p>Beschrijft de FreeBSD opstartprocedure en legt uit hoe deze aan te passen met instellingen.</p></dd><dt class=hdlist1><em><a href=./#users>Gebruikers- en basisaccountbeheer</a>, Gebruikers en basis accountbeheer</em></dt><dd><p>Beschrijft hoe gebruikersaccounts aan te maken en te wijzigen. Het beschrijft ook welke resourcebeperkingen er gezet kunnen worden op gebruikers en andere account-beheerstaken.</p></dd><dt class=hdlist1><em><a href=./#security>Beveiliging</a>, Beveiliging</em></dt><dd><p>Beschrijft vele verschillende hulpapplicaties die beschikbaar zijn die helpen om een FreeBSD systeem veilig te houden, met oa: Kerberos, IPsec en OpenSSH.</p></dd><dt class=hdlist1><em><a href=./#jails>Jails</a>, Jails</em></dt><dd><p>Beschrijft het jail-raamwerk, en de verbeteringen van jails (gevangenissen) ten opzichte van de traditionele ondersteuning voor chroot van FreeBSD.</p></dd><dt class=hdlist1><em><a href=./#mac>Verplichte Toegangscontrole (MAC)</a>, Verplichte Toegangscontrole (MAC)</em></dt><dd><p>Legt uit was Verplichte Toegangscontrole (MAC) is en hoe het gebruikt kan worden om een FreeBSD te beveiligen.</p></dd><dt class=hdlist1><em><a href=./#audit>Security Event Auditing</a>, Security Event Auditing</em></dt><dd><p>Beschrijft wat FreeBSD Event Auditing is, hoe het geïnstalleerd kan worden, en hoe audit trails geïnspecteerd en gemonitord kunnen worden.</p></dd><dt class=hdlist1><em><a href=./#disks>Opslag</a>, Opslag</em></dt><dd><p>Beschrijft hoe opslagmedia en bestandssystemen beheerd worden onder FreeBSD. Dit omvat fysieke schijven, RAID arrays, optische en tape media, geheugenschijven en netwerkbestandssystemen.</p></dd><dt class=hdlist1><em><a href=./#geom>Overzicht</a>, GEOM</em></dt><dd><p>Beschrijft wat het GEOM raamwerk in FreeBSD is en hoe de verschillende ondersteunde RAID-niveau’s in te stellen.</p></dd><dt class=hdlist1><em><a href=./#filesystems>Ondersteuning van bestandssystemen</a>, Ondersteuning van bestandssystemen</em></dt><dd><p>Gaat de ondersteuning voor vreemde bestandssystemen in FreeBSD na, zoals het Z File System van Sun™.</p></dd><dt class=hdlist1><em><a href=./#virtualization>Virtualisatie</a>, Virtualisatie</em></dt><dd><p>Beschrijft wat virtualisatiesystemen bieden, en hoe ze met FreeBSD gebruikt kunnen worden.</p></dd><dt class=hdlist1><em><a href=./#l10n>Lokalisatie - I18N/L10N gebruiken en instellen</a>, Lokalisatie - I18N/L10N gebruiken en instellen</em></dt><dd><p>Beschrijft hoe FreeBSD met andere talen dan Engels te gebruiken is. Behandelt zowel het systeem- als applicatieniveau van localisatie.</p></dd><dt class=hdlist1><em><a href=./#updating-upgrading>FreeBSD updaten en upgraden</a>, FreeBSD updaten en upgraden</em></dt><dd><p>Geeft uitleg over de verschillen tussen FreeBSD-STABLE, FreeBSD-CURRENT en FreeBSD uitgaven. Beschrijft welke gebruikers voordeel hebben van het bijhouden van een ontwikkelsysteem en legt dat proces uit. Beschrijft de manier waarop gebruikers hun systeem naar de laatste beveiligingsuitgave kunnen bijwerken.</p></dd><dt class=hdlist1><em><a href=./#dtrace>DTrace</a></em>, DTrace_</dt><dd><p>Beschrijft hoe het gereedschap DTrace van Sun™ te configureren en gebruiken in FreeBSD. Dynamisch tracen kan helpen bij het lokaliseren van prestatieproblemen, door real-time systeemanalyse uit te voeren.</p></dd><dt class=hdlist1><em><a href=./#serialcomms>Seriële communicatie</a>, Seriële communicatie</em></dt><dd><p>Legt uit hoe een verbinding te maken met terminals en modems op een FreeBSD systeem voor zowel dial-in als dial-out verbindingen.</p></dd><dt class=hdlist1><em><a href=./#ppp-and-slip>PPP en SLIP</a>, PPP en SLIP</em></dt><dd><p>Beschrijft hoe PPP, SLIP en PPP over Ethernet te gebruiken om verbinding te maken met remote systemen met FreeBSD.</p></dd><dt class=hdlist1><em><a href=./#mail>Elektronische mail</a>, E-mail</em></dt><dd><p>Legt verschillende componenten uit van een mailserver en gaat dieper in op simpele instellingen voor de populairste mailserver software: sendmail.</p></dd><dt class=hdlist1><em><a href=./#network-servers>Netwerkdiensten</a>, Netwerkdiensten</em></dt><dd><p>Geeft gedetailleerde instructies en voorbeeldinstellingen om een FreeBSD machine als een netwerk bestandssysteem server, DNS server, netwerk informatiesysteem server of tijdserver in te stellen.</p></dd><dt class=hdlist1><em><a href=./#firewalls>Firewalls</a>, Firewalls</em></dt><dd><p>Licht de filosofie achter op software gebaseerde firewalls toe en beschrijf in detail hoe de verschillende firewalls die in FreeBSD beschikbaar zijn ingesteld kunnen worden.</p></dd><dt class=hdlist1><em><a href=./#advanced-networking>Netwerken voor gevorderden</a>, Netwerken voor gevorderden</em></dt><dd><p>Beschrijft meerdere netwerk onderwerpen, inclusief het delen van een Internetverbinding met andere computers in een LAN, routeren voor gevorderden, draadloze netwerken, Bluetooth®, ATM, IPv6 en nog veel meer.</p></dd><dt class=hdlist1><em><a href=./#mirrors>FreeBSD verkrijgen</a>, FreeBSD verkrijgen</em></dt><dd><p>Geeft verschillende bronnen aan voor het verkrijgen van FreeBSD media op CD-ROM of DVD evenals verschillende sites op het Internet die gebruikers in staat stellen FreeBSD te downloaden en te installeren.</p></dd><dt class=hdlist1><em><a href=./#bibliography>Bibliografie</a>, Bibliografie</em></dt><dd><p>Dit boek behandelt veel verschillende onderwerpen die de lezer misschien hongerig maken naar een gedetailleerdere uitleg. De bibliografie bevat verwijzingen naar een aantal uitstekende boeken.</p></dd><dt class=hdlist1><em><a href=./#eresources>Bronnen op Internet</a>, Bronnen op Internet</em></dt><dd><p>Beschrijft de vele forums die beschikbaar zijn voor FreeBSD gebruikers om vragen te stellen, en om deel te nemen aan technische conversaties over FreeBSD.</p></dd><dt class=hdlist1><em><a href=./#pgpkeys>PGP sleutels</a>, PGP sleutels</em></dt><dd><p>Geeft de PGP-vingerafdrukken van verschillende FreeBSD ontwikkelaars.</p></dd></dl></div></div><div class=sect2><h3 id=preface-conv>Overeenkomsten in dit boek<a class=anchor href=#preface-conv></a></h3><div class=paragraph><p>Om consistentie en leesbaarheid te behouden en de leesbaarheid te behouden worden er een aantal overeenkomsten nageleefd in dit boek.</p></div><div class=sect3><h4 id=preface-conv-typographic>Typografische overeenkomsten<a class=anchor href=#preface-conv-typographic></a></h4><div class=dlist><dl><dt class=hdlist1><em>Italic</em></dt><dd><p>Een <em>italic</em> lettertype wordt gebruikt voor bestandsnamen, URL’s, benadrukte tekst, en het eerste gebruik van technische termen.</p></dd><dt class=hdlist1><code>Monospace</code></dt><dd><p>Een <code>monospaced</code> lettertype wordt gebruikt voor foutmeldingen, commando’s, omgevingsvariabelen, namen van ports, hostnamen, gebruikersnamen, groepsnamen, apparaatnamen, variabelen en stukjes code.</p></dd><dt class=hdlist1>Vet</dt><dd><p>Een vet lettertype wordt gebruikt voor applicaties, commando’s en toetsen.</p></dd></dl></div></div><div class=sect3><h4 id=preface-conv-commands>Gebruikersinvoer<a class=anchor href=#preface-conv-commands></a></h4><div class=paragraph><p>Toetsen worden weergegeven in <strong>bold</strong> om op te vallen tussen andere tekst. Toetscombinaties die bedoeld zijn om tegelijkertijd getypt te worden, worden weergeven met <code>+</code> tussen de toetsen zoals</p></div><div class=paragraph><p><span class=keyseq><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Del</kbd></span></p></div><div class=paragraph><p>Betekent dat de gebruiker de volgende toetsen op hetzelfde moment moet indrukken: <kbd>Ctrl</kbd>, <kbd>Alt</kbd> en <kbd>Del</kbd>.</p></div><div class=paragraph><p>Toetsen die bedoeld zijn om achter elkaar te typen worden gescheiden door komma’s, bijvoorbeeld</p></div><div class=paragraph><p><span class=keyseq><kbd>Ctrl</kbd>+<kbd>X</kbd></span>, <span class=keyseq><kbd>Ctrl</kbd>+<kbd>S</kbd></span></p></div><div class=paragraph><p>zou betekenen dat de gebruiker de <kbd>Ctrl</kbd> en <kbd>X</kbd> toetsen tegelijk moet indrukken en erna <kbd>Ctrl</kbd> en <kbd>S</kbd> tegelijkertijd moet indrukken.</p></div></div><div class=sect3><h4 id=preface-conv-examples>Voorbeelden<a class=anchor href=#preface-conv-examples></a></h4><div class=paragraph><p>Voorbeelden die beginnen met <span class=filename>E:\</span> geven aan dat het een MS-DOS® commando betreft. Tenzij anders vermeld, kunnen deze commando’s in een "Command prompt"scherm in een moderne Microsoft® Windows® omgeving worden gebruikt.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>E:<span class=se>\ </span>tools<span class=se>\f</span>dimage floppies<span class=se>\k</span>ern.flp A:</code></pre></div></div><div class=paragraph><p>Voorbeelden die starten met een # geven aan dat een commando ingegeven moet worden als de superuser in FreeBSD. Er kan aangemeld worden met <code>root</code> om het commando in te typen, of er kan na als gewone gebruiker aangemeld te hebben gebruikt gemaakt worden van <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> om superuser-rechten te verkrijgen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=kern.flp of=/dev/fd0</span></code></pre></div></div><div class=paragraph><p>Voorbeelden die starten met % geven aan dat een commando opgegeven moet worden vanuit een normale gebruikersaccount. Tenzij anders vermeld, wordt de C-shell syntaxis gebruikt voor het instellen van omgevingsvariabelen en andere shellcommando’s.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% top</code></pre></div></div></div></div><div class=sect2><h3 id=preface-acknowledgements>Dankwoorden<a class=anchor href=#preface-acknowledgements></a></h3><div class=paragraph><p>Het boek dat nu voorligt representeert de inspanningen van honderden mensen over de hele wereld. Of ze nu foutjes verbeteren of complete hoofdstukken inleveren, ze hebben allemaal nuttig bijgedragen.</p></div><div class=paragraph><p>Verschillende bedrijven hebben bijgedragen aan het maken van dit document door de schrijvers te betalen om hier voltijds aan te werken, door te betalen voor de publicatie, etc. In het bijzonder heeft BSDi (Overgenomen door <a href=httl://www.windriver.com>Wind River Systems</a>) leden van het FreeBSD Documentation Project betaald om voltijds te werken aan het verbeteren van dit boek, wat leidde tot de publicatie van de eerste editie in maart 2000 (ISBN 1-57176-241-8). Wind River Systems heeft daarna verschillende schrijvers betaald om een aantal verbeteringen uit te voeren voor de printuitvoer-infrastructuur en om extra hoofdstukken toe te voegen aan de tekst. Dit werk leverde de publicatie van de tweede gedrukte editie in november 2001 (ISBN 1-57176-303-1). In 2003-2004 heeft <a href=http://www.freebsdmall.com>FreeBSD Mall, Inc</a> een aantal mensen die bijdragen hebben geleverd betaald om het handboek te verbeteren voor een derde gedrukte editie.</p></div></div></div></div><h1 id=getting-started class=sect0>Deel I: Beginnen<a class=anchor href=#getting-started></a></h1><div class="openblock partintro"><div class=content><div class=paragraph><p>Dit deel van het FreeBSD handboek is voor gebruikers en beheerders die net beginnen met FreeBSD. Deze hoofdstukken:</p></div><div class=ulist><ul><li><p>Geven een inleiding in FreeBSD;</p></li><li><p>Lichten het installatieproces toe;</p></li><li><p>Bespreken de UNIX® basisbegrippen en grondslag;</p></li><li><p>Tonen hoe de vele aanvullende applicaties voor FreeBSD geïnstalleerd kunnen worden;</p></li><li><p>Introduceren X, het venstersysteem van UNIX® en gaan uitvoerig in op hoe een bureaubladomgeving wordt ingesteld die een gebruiker helpt productiever te zijn.</p></li></ul></div><div class=paragraph><p>Er is geprobeerd het aantal vooruitwijzingen tot een minimum te beperken zodat het handboek van begin tot einde gelezen kan worden zonder bladeren.</p></div></div></div><div class=sect1><h2 id=introduction>Hoofdstuk 1. Introductie<a class=anchor href=#introduction></a></h2><div class=sectionbody><div class=sect2><h3 id=introduction-synopsis>1.1. Overzicht<a class=anchor href=#introduction-synopsis></a></h3><div class=paragraph><p>Welkom bij FreeBSD! Dit hoofdstuk beschrijft de verschillende aspecten van het FreeBSD Project: geschiedenis, doelen, ontwikkelmodel en meer.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe FreeBSD gerelateerd is aan andere besturingssystemen;</p></li><li><p>De geschiedenis van het FreeBSD Project;</p></li><li><p>De doelen van het FreeBSD Project;</p></li><li><p>De fundering van het FreeBSD open-source ontwikkelmodel;</p></li><li><p>En natuurlijk: waar de naam "FreeBSD" vandaan komt.</p></li></ul></div></div><div class=sect2><h3 id=nutshell>1.2. Welkom bij FreeBSD!<a class=anchor href=#nutshell></a></h3><div class=paragraph><p>FreeBSD is een op 4.4BSD-Lite gebaseerd besturingssysteem voor Intel (x86 en Itanium®), AMD64 en Sun UltraSPARC® computers. Er zijn ook ports naar andere architecturen in voorbereiding. Er is nog meer informatie over de <a href=#history>geschiedenis van FreeBSD</a> of over de <a href=#relnotes>huidige uitgave</a>. Als de lezer wil bijdragen aan het project (code, hardware, geld) wordt aangeraden het artikel <a href=https://docs.freebsd.org/nl/articles/contributing/>Bijdragen aan FreeBSD</a> te lezen.</p></div><div class=sect3><h4 id=os-overview>1.2.1. Wat kan FreeBSD?<a class=anchor href=#os-overview></a></h4><div class=paragraph><p>FreeBSD heeft veel mogelijkheden die het bespreken waard zijn. Hier zijn er enkele op een rij gezet:</p></div><div class=ulist><ul><li><p><em>Preemptive multitasking</em> zorgt ervoor dat meerdere programma’s en gebruikers op dezelfde computer kunnen werken, zonder dat de systeemrespons of stabiliteit beïnvloed wordt.</p></li><li><p>Ondersteuning voor <em>meerdere gebruikers</em> maakt het mogelijk dat verschillende mensen een FreeBSD systeem tegelijkertijd kunnen gebruiken voor een groot aantal taken. Dit betekent bijvoorbeeld dat randapparaten als printers en tapedrives gedeeld kunnen worden door alle gebruikers van het systeem en dat individuele beperkingen ingesteld kunnen worden voor gebruikers of voor groepen gebruikers, zodat kritieke systeembronnen beschermd kunnen worden tegen onrechtmatig of overmatig gebruik.</p></li><li><p>Krachtige mogelijkheden voor <em>TCP/IP netwerken</em> met ondersteuning voor industriestandaarden als SCTP, DHCP, NFS, NIS, PPP, SLIP, IPsec en IPv6. Dit betekent dat een FreeBSD-systeem makkelijk kan samenwerken met andere systemen en dat het kan functioneren als bedrijfsserver, waarbij het belangrijke functies als NFS (bestandsdeling over het netwerk), email, webdiensten, FTP, routing en firewall-diensten kan aanbieden.</p></li><li><p><em>Geheugenbeveiliging</em> garandeert dat applicaties (of gebruikers) elkaar niet kunnen storen. Een crashende applicatie heeft totaal geen effect op andere applicaties.</p></li><li><p>FreeBSD is een <em>32-bits</em> besturingssysteem (<em>64-bits</em> op de Itanium®, AMD64, en UltraSPARC®) en is van de grond af aan zo ontworpen.</p></li><li><p>Het <em>X Window systeem</em> (X11R7), een industriële standaard, biedt een grafische gebruikersinterface (GUI) met als enige benodigdheden een VGA-kaart en een beeldscherm.</p></li><li><p>Door <em>binaire compatibiliteit</em> met veel programma’s voor Linux®, SCO, SVR4, BSDI en NetBSD is het mogelijk om deze programma’s zonder snelheidsverlies op FreeBSD te draaien.</p></li><li><p>Er zijn duizenden applicaties beschikbaar in de FreeBSD <em>ports</em> en <em>pakketten</em> collectie. Waarom zoeken op het Internet als het allemaal al klaarstaat?</p></li><li><p>Duizenden andere en <em>makkelijk over te zetten</em> applicaties zijn beschikbaar op het Internet. FreeBSD is broncode-compatibel met de meeste populaire commerciële UNIX® systemen, wat betekent dat veel applicaties nagenoeg geen wijzigingen vereisen om te compileren op FreeBSD.</p></li><li><p>Het demand-paged <em>virtueel geheugen</em> en de "gecombineerde VM/buffer cache" van FreeBSD zorgen ervoor dat applicaties met grote geheugenbehoeften niets te kort komen, terwijl de systeemrespons niet achteruit gaat.</p></li><li><p><em>SMP</em>-ondersteuning voor computers met meerdere processoren.</p></li><li><p>Een volledige <em>C</em> en <em>C++</em> ontwikkelomgeving. Vele andere programmeertalen, te gebruiken voor onderzoek of geavanceerde ontwikkeling, zijn ook beschikbaar in de ports- en pakketcollectie.</p></li><li><p>De <em>broncode</em> van het hele systeem is beschikbaar, zodat gebruikers de volledige controle over het systeem in handen hebben. Waarom genoegen nemen met alleen het erewoord van de softwarefabrikant, als een compleet open systeem ook tot de mogelijkheden behoort?</p></li><li><p>Uitgebreide <em>online documentatie</em>.</p></li><li><p><em>En nog veel meer!</em></p></li></ul></div><div class=paragraph><p>FreeBSD is gebaseerd op de 4.4BSD-Lite uitgave van de Computer Systems Research Group (CSRG) aan de University of California in Berkeley en borduurt voort op een lange traditie van ontwikkeling van BSD-systemen. Het FreeBSD Project heeft duizenden uren gestoken in het afstellen van het systeem voor maximale prestaties en betrouwbaarheid in realistische en veel voorkomende situaties. Terwijl veel commerciële bedrijven blijven worstelen met het uitbrengen van besturingssystemen met dergelijke mogelijkheden, prestaties en betrouwbaarheid, kan FreeBSD deze <em>nu</em> bieden!</p></div><div class=paragraph><p>De toepassingen voor FreeBSD worden alleen beperkt door eigen fantasie. Van software-ontwikkeling tot fabrieksautomatisering, van voorraadbeheersing tot de azimuth-correctie van een satellietantenne: als het kan met een commercieel UNIX®product, dan kan het ook met FreeBSD! FreeBSD vaart ook wel bij de letterlijk duizenden open-source programma’s, vaak van bijzonder hoge kwaliteit, die ontwikkeld zijn in onderzoekscentra, universiteiten over de hele wereld en open-source gemeenschappen, en die beschikbaar zijn voor weinig of geen geld. Ook steeds meer commerciële applicaties vinden hun weg naar FreeBSD.</p></div><div class=paragraph><p>Omdat ook de broncode van FreeBSD zelf vrij beschikbaar is, kan het systeem aangepast worden voor speciale toepassingen of projecten, op manieren die meestal niet mogelijk zijn met besturingssystemen van vooraanstaande commerciële softwarehuizen. Hier zijn een aantal voorbeelden van toepassingen waar FreeBSD voor gebruikt wordt:</p></div><div class=ulist><ul><li><p><em>Internetdiensten:</em> de robuuste TCP/IP netwerkarchitectuur die in FreeBSD zit, maakt het een ideaal platform voor uiteenlopende Internetdiensten als:</p><div class=ulist><ul><li><p>FTP servers;</p></li><li><p>World Wide Webservers (standaard of beveiligd [SSL]);</p></li><li><p>IPv4 en IPv6 routering</p></li><li><p>Firewalls en NAT ("IP-maskering") gateways;</p></li><li><p>E-mail servers;</p></li><li><p>USENET nieuws of Bulletin Board (BBS) systemen;</p></li><li><p>En meer…​</p><div class=paragraph><p>FreeBSD kan eenvoudig geleerd worden op een goedkope standaard-PC, om later verder te groeien naar een professioneel Xeon-systeem met 4 processoren (of meer!) en RAID opslagsystemen als een bedrijf groeit.</p></div></li></ul></div></li><li><p><em>Onderwijs:</em> is de lezer informaticastudent of werkzaam in een ander vakgebied dat hier mee te maken heeft? Er is geen betere manier om besturingssystemen, computerarchitecturen en netwerken te bestuderen dan de hands-on open-source ervaring die FreeBSD kan bieden. Gratis beschikbare programma’s voor CAD, wiskundige toepassingen en grafisch ontwerp maken FreeBSD ook heel handig voor mensen wiens primaire interesse voor de computer ligt bij het voltooien van <em>ander</em> werk!</p></li><li><p><em>Onderzoek:</em> omdat de broncode van het volledige systeem beschikbaar is, vormt FreeBSD een uitstekende basis voor het onderzoeken van besturingssystemen of andere takken in de informatica. De open natuur van FreeBSD maakt het ook mogelijk voor groepen mensen over de hele wereld om met elkaar samen te werken, zonder dat men zich zorgen hoeft te maken over speciale licentieovereenkomsten of beperkingen op wat er besproken kan worden in open fora.</p></li><li><p><em>Netwerken:</em> nieuwe router nodig? Of een nameserver (DNS)? Een firewall om een intern netwerk te beschermen? FreeBSD kan die ongebruikte 486 of Pentium PC die nog ergens in een hoekje ligt gemakkelijk omtoveren tot een geavanceerde router met uitgebreide pakketfilter mogelijkheden.</p></li><li><p><em>X Window werkstation:</em> FreeBSD is een prima keuze als goedkope X terminal oplossing, door gebruik te maken van de gratis beschikbare X11 server. In tegenstelling tot een pure X terminal kan FreeBSD ook applicaties lokaal draaien, wat een verlichting van de centrale server tot gevolg kan hebben. FreeBSD heeft zelfs de mogelijkheid om "schijfloos" op te starten, zodat individuele werkstations nog goedkoper en makkelijker te beheren zijn.</p></li><li><p><em>Bureaublad:</em> de beschikbaarheid van geavanceerde bureaubladomgevingen als KDE en GNOME en kantoortoepassingen als tekstverwerkers en spreadsheet-programma’s in de ports- en pakketcollectie maken van FreeBSD een uitgebreid desktop-platform. Thuis en op het werk zorgt FreeBSD ervoor dat er snel, efficiënt en veilig gewerkt kan worden!</p></li><li><p><em>Software Ontwikkeling:</em> bij het standaard FreeBSD-systeem zit al een volledige verzameling van ontwikkelgereedschappen, inclusief de bekende GNU C/C++ compiler en debugger.</p></li></ul></div><div class=paragraph><p>FreeBSD is beschikbaar in zowel broncode als binaire vorm op CD-ROM, DVD en via FTP. In <a href=./#mirrors>FreeBSD verkrijgen</a> staat meer informatie over het verkrijgen van FreeBSD.</p></div></div><div class=sect3><h4 id=introduction-nutshell-users>1.2.2. Wie gebruiken FreeBSD?<a class=anchor href=#introduction-nutshell-users></a></h4><div class=paragraph><p>FreeBSD wordt gebruikt als platform voor apparaten en producten van vele van 's werelds grootste IT-bedrijven, waaronder:</p></div><div class=ulist><ul><li><p><a href=http://www.apple.com/>Apple</a></p></li><li><p><a href=http://www.cisco.com/>Cisco</a></p></li><li><p><a href=http://www.juniper.net/>Juniper</a></p></li><li><p><a href=http://www.netapp.com/>NetApp</a></p></li></ul></div><div class=paragraph><p>FreeBSD wordt ook gebruikt om sommige van de grootste sites op het Internet te draaien, waaronder:</p></div><div class=ulist><ul><li><p><a href=http://www.yahoo.com/>Yahoo!</a></p></li><li><p><a href=http://www.yandex.ru/>Yandex</a></p></li><li><p><a href=http://www.apache.org/>Apache</a></p></li><li><p><a href=http://www.rambler.ru/>Rambler</a></p></li><li><p><a href=http://www.sina.com/>Sina</a></p></li><li><p><a href=http://www.pair.com/>Pair Networks</a></p></li><li><p><a href=http://www.sony.co.jp/>Sony Japan</a></p></li><li><p><a href=http://www.netcraft.com/>Netcraft</a></p></li><li><p><a href=http://www.163.com/>NetEase</a></p></li><li><p><a href=http://www.wni.com/>Weathernews</a></p></li><li><p><a href=http://www.telehouse.com/>TELEHOUSE America</a></p></li><li><p><a href=http://www.experts-exchange.com/>Experts Exchange</a></p></li></ul></div><div class=paragraph><p>en nog veel meer sites.</p></div></div></div><div class=sect2><h3 id=history>1.3. Over het FreeBSD Project<a class=anchor href=#history></a></h3><div class=paragraph><p>Deze paragraaf geeft wat meer achtergrondinformatie over het project, inclusief een korte geschiedenis, projectdoelen, en het ontwikkelmodel van het project.</p></div><div class=sect3><h4 id=intro-history>1.3.1. Een korte geschiedenis van FreeBSD<a class=anchor href=#intro-history></a></h4><div class=paragraph><p>Het FreeBSD Project zag het licht in het begin van 1993, gedeeltelijk als een voortzetting van de "Unofficial 386BSD Patchkit" door de 3 laatste coördinatoren van de patchkit: Nate Williams, Rod Grimes en ikzelf.</p></div><div class=paragraph><p>Het oorspronkelijke doel was om een zogenaamde 'snapshot'-uitgave te maken van 386BSD, om zo een aantal problemen op te lossen die niet op te lossen waren met het patchkit-mechanisme dat eerder gebruikt was. Sommigen kunnen zich misschien nog herinneren dat de werktitel van het project in het begin nog "386BSD 0.5" of "386BSD Interim" was, refererend aan het oorspronkelijke doel.</p></div><div class=paragraph><p>386BSD was het besturingssysteem van Bill Jolitz en had tot op dat moment geleden onder het feit dat er al bijna een jaar niet naar omgekeken was. Terwijl de patchkit steeds groter en onhandiger werd, was een groep mensen het er over eens dat er iets moest gebeuren en beslisten om Bill te assisteren bij het maken van een tussentijdse "cleanup"-snapshot. Deze plannen kwamen echter tot een plotseling einde toen Bill Jolitz besliste om zijn toestemming voor het project in te trekken, zonder dat er een alternatief werd geboden.</p></div><div class=paragraph><p>Het duurde niet lang om te beslissen dat het doel nog steeds belangrijk was, zelfs zonder de ondersteuning van Bill, dus werd de naam "FreeBSD" aangenomen, naar een idee van David Greenman. De oorspronkelijke doelen werden opgesteld na het raadplegen van de gebruikers van het systeem. Toen het erop begon te lijken dat dit project misschien wel snel realiteit kon worden, werd contact opgenomen met Walnut Creek CD-ROM vanuit het oogpunt om de distributiekanalen van FreeBSD te verbeteren voor diegenen die geen toegang hadden tot Internet. Walnut Creek CD-ROM ondersteunde niet alleen het idee om FreeBSD op CD-ROM te distribueren, maar bood het project ook een systeem en een snelle Internetverbinding om mee te werken. Zonder Walnut Creek CD-ROM’s bijna onbeperkte vertrouwen in wat op dat moment nog een compleet onbekend project was, is het onwaarschijnlijk dat FreeBSD zo ver gekomen zou zijn, en zo snel, als het vandaag de dag is.</p></div><div class=paragraph><p>De eerste CD-ROM (en algemene op het net beschikbare) distributie was FreeBSD 1.0, uitgebracht in december 1993. Deze versie was gebaseerd op de 4.3BSD-Lite ("Net/2") tape van U.C. Berkeley, met veel toevoegingen van 386BSD en de Free Software Foundation. Het werd een redelijk succes voor een eerste aanbod, en werd opgevolgd door de zeer succesvolle FreeBSD 1.1 uitgave in mei 1994.</p></div><div class=paragraph><p>Rond deze tijd vormde zich nogal onverwacht een stormachtige lucht aan de horizon toen Novell en U.C. Berkeley hun langlopende rechtszaak over de legale status van de Berkeley Net/2 tape oplosten met een schikking. Een voorwaarde van deze schikking was dat U.C. Berkeley toegaf dat grote delen van Net/2 "beladen" code was en het eigendom van Novell, die deze code op haar beurt overgenomen had van AT&amp;T enige tijd hiervoor. Wat Berkeley hiervoor terugkreeg was Novell’s "zegen" over de 4.4BSD-Lite uitgave; wanneer deze uitkwam zou Novell verklaren dat geen van de code hierin eigendom van Novell was, en bestaande Net/2 gebruikers zou sterk aanbevolen worden om over te stappen naar deze nieuwe versie. Dit gold ook voor FreeBSD en het project werd de tijd gegeven tot juli 1994 om te stoppen met het distribueren van het eigen op Net/2-gebaseerde product. De schikking liet wel toe dat nog een laatste uitgave werd uitgebracht voor de deadline en dat was FreeBSD 1.1.5.1.</p></div><div class=paragraph><p>FreeBSD nam toen de enorme taak op zich om zichzelf letterlijk opnieuw uit te vinden, met als basis een volledig nieuwe en nogal incomplete verzameling van delen van 4.4BSD-Lite. De "Lite" uitgaven werden zo genoemd omdat Berkeley’s CSRG grote delen code die nodig waren om een werkend systeem te construeren had weggelaten (om allerlei legale redenen) en omdat de Intel port van 4.4 grotendeels incompleet was. Het kostte het project tot november 1994 om deze overstap te maken. Op dat moment werd FreeBSD 2.0 op het net en op CD-ROM (aan het einde van december) uitgebracht. Ondanks het feit dat deze uitgave nog wat ruige kanten had, werd het een groot succes en werd het gevolgd door de robuustere en makkelijker te installeren FreeBSD 2.0.5 in juni 1995.</p></div><div class=paragraph><p>In augustus 1996 is FreeBSD 2.1.5 uitgebracht en deze bleek populair genoeg bij Internet service providers (ISP’s) en andere commerciële gebruikers van FreeBSD om nog een uitgave van de 2.1-STABLE tak te rechtvaardigen. Dit was FreeBSD 2.1.7.1, uitgebracht in februari 1997. Deze uitgave markeerde het einde van de hoofdstroomontwikkeling op 2.1-STABLE; alleen beveilingsupdates en andere kritieke bugfixes werden nog op deze tak uitgevoerd (RELENG_2_1_0).</p></div><div class=paragraph><p>FreeBSD 2.2 werd afgesplitst van de ontwikkelingstak ("-CURRENT") in november 1996 als RELENG_2_2 en de eerste volledige uitgave (2.2.1) werd uitgebracht in april 1997. Andere uitgaven van de 2.2 tak werden uitgebracht in de zomer en herfst van '97. De laatste (2.2.8) verscheen in november 1998. De eerste officiële 3.0 uitgave verscheen in oktober 1998 en was het begin van het einde voor de 2.2 tak.</p></div><div class=paragraph><p>Er was opnieuw een afsplitsing op 20 januari 1999, wat leidde tot de 4.0-CURRENT en 3.X-STABLE takken. Vanuit 3.X-STABLE werd versie 3.1 uitgebracht op 15 februari 1999, 3.2 op 15 mei 1999, 3.3 op 16 september 1999, 3.4 op 20 december 1999 en 3.5 op 24 juni 2000. De laatste werd enkele dagen later gevolgd door een puntuitgave-update naar 3.5.1, om enkele net-ontdekte beveiligingsfouten in Kerberos te corrigeren. Dit was de laatste uitgave van de 3.X tak.</p></div><div class=paragraph><p>Een nieuwe tak werd gemaakt op 13 maart 2000, de 4.X-STABLE tak. Er zijn verschillende uitgaven van deze tak gemaakt: 4.0-RELEASE werd geïntroduceerd in maart 2000, en de laatste 4.11-RELEASE verscheen in januari 2005.</p></div><div class=paragraph><p>De langverwachte 5.0-RELEASE werd aangekondigd op 19 januari 2003. Dit resultaat van bijna drie jaar werk zette FreeBSD stevig neer op de weg naar geavanceerde multiprocessor- en threading-ondersteuning en introduceerde nieuwe FreeBSD ports voor de UltraSPARC® en <code>ia64</code> architecturen. Deze uitgave werd gevolgd door 5.1 in juni 2003. De laatste 5.X uitgave uit de -CURRENT-tak was 5.2.1-RELEASE uit februari 2004.</p></div><div class=paragraph><p>De RELENG_5 tak is gemaakt in augustus 2004 en werd gevolgd door 5.3-RELEASE, die het begin van de 5-STABLE tak markeert. De meest recente 5.5-RELEASE is uitgekomen in mei 2006. Er staan geen nieuwe versies gepland voor de RELENG_5 tak.</p></div><div class=paragraph><p>De RELENG_6 tak is gemaakt in juli 2005, de eerste uitgave van de 6.X tak werd vrijgegeven in november 2005. De meest recente 6.4-RELEASE kwam uit in november 2008. Er zullen geen verdere uitgaven komen van de RELENG_6 tak. Deze tak is de laatste tak waarin ondersteuning zit voor de Alpha architectuur.</p></div><div class=paragraph><p>De RELENG_7 tak is gemaakt in oktober 2007. De eerste uitgave van deze tak is 7.0-RELEASE, welke is uitgekomen in februari 2008. De meest recente 7.4-RELEASE kwam uit in februari 2011. Er zullen geen andere uitgaven van de RELENG_7 tak uitkomen.</p></div><div class=paragraph><p>De RELENG_8 tak is gemaakt in augustus 2009. De eerste uitgave van de 8.X tak is 8.0-RELEASE, vrijgegeven in november 2009. De meest recente uitgave 11.2-RELEASE kwam uit in June 28, 2018. Er zullen nog andere uitgaven van de RELENG_8 tak uitkomen.</p></div><div class=paragraph><p>De RELENG_9 tak is gemaakt in september 2011. De eerste uitgave van deze tak was 12.0-RELEASE, vrijgegeven in December 11, 2018. Er zullen nog andere uitgaven van de RELENG_9 tak uitkomen.</p></div><div class=paragraph><p>Op dit moment vinden lange-termijn ontwikkelprojecten plaats in de 10.X-CURRENT tak, en snapshot uitgaven van 10.X op CD-ROM (en natuurlijk op het Net) worden continu beschikbaar gemaakt op <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/snapshots/>de snapshot server</a>.</p></div></div><div class=sect3><h4 id=goals>1.3.2. Doelen van het FreeBSD Project<a class=anchor href=#goals></a></h4><div class=paragraph><p>Het doel van het FreeBSD Project is om software aan te bieden die gebruikt kan worden voor iedere mogelijke toepassing, zonder beperkingen. Vele ontwikkelaars hebben een belangrijke investering in de code (en het project) zitten en vinden het niet erg om af en toe een financiële compensatie te ontvangen, maar dat is zeker geen voorwaarde. De ontwikkelaars van FreeBSD geloven dat de eerste en belangrijkste "missie" het aanbieden van code is, aan iedereen die het wil hebben, voor wat voor doel dan ook, zodat de code zo breed mogelijk gebruikt kan worden tot voordeel van zoveel mogelijk mensen. Dit is een van de meest fundamentele doelen van Vrije Software dat FreeBSD enthousiast ondersteunt.</p></div><div class=paragraph><p>Sommige code in FreeBSD valt onder de GNU General Public License (GPL) of Library General Public License (LGPL). Deze code heeft iets meer beperkingen, maar in ieder geval aan de kant waarbij vrije toegang tot de code geforceerd wordt, in plaats van het gebruikelijke tegenovergestelde hiervan. Door de toegevoegde moeilijkheden die kunnen voortkomen uit het commerciële gebruik van GPL software geeft het FreeBSD Project echter de voorkeur aan het meer vrije BSD copyright, wanneer er een redelijk alternatief voor handen is.</p></div></div><div class=sect3><h4 id=development>1.3.3. Het FreeBSD ontwikkelmodel<a class=anchor href=#development></a></h4><div class=paragraph><p>De ontwikkeling van FreeBSD is een erg open en flexibel proces en wordt gevormd door de bijdragen van letterlijk honderden mensen over de hele wereld, zoals te zien is in de <a href=https://docs.freebsd.org/en/articles/contributors/>lijst van medewerkers</a>. De infrastructuur die wordt gebruikt voor de ontwikkeling van FreeBSD zorgt ervoor dat deze honderden ontwikkelaars kunnen samenwerken over het Internet. Het FreeBSD Project is continu op zoek naar nieuwe ontwikkelaars en ideeën. Om bij te dragen aan de ontwikkeling van FreeBSD is een mail naar <a href=https://lists.FreeBSD.org/subscription/freebsd-hackers>FreeBSD technische discussie mailinglijst</a> voldoende. De <a href=https://lists.FreeBSD.org/subscription/freebsd-announce>FreeBSD aankondigingen mailinglijst</a> is beschikbaar om mededelingen te doen aan andere FreeBSD-gebruikers over grote veranderingen.</p></div><div class=paragraph><p>Een aantal dingen over het FreeBSD Project en haar ontwikkelingsproces zijn handig om te weten, of een bijdrage nu onafhankelijk of in samenwerking met anderen komt:</p></div><div class=dlist><dl><dt class=hdlist1>Het CVS-archief<a id=development-cvs-repository></a></dt><dd><p>Gedurende een aantal jaren werd de centrale broncode voor FreeBSD bijgehouden door <a href=http://www.nongnu.org/cvs/>CVS</a> (Concurrent Versions System), een vrij verkrijgbaar pakket voor het onderhouden van broncode dat bij FreeBSD zit. In juni 2008 is het Project <a href=http://subversion.tigris.org/>SVN</a> (Subversion) gaan gebruiken. Deze overgang werd nodig geacht omdat de technische beperkingen die door CVS worden opgelegd duidelijk werden wegens de snelle uitbreiding van de broncode en de hoeveelheid geschiedenis die reeds is opgeslagen. De reservoirs van het Documentatieproject en de Portscollectie zijn ook omgezet van CVS naar SVN, respectievelijk in mei 2012 en juli 2012.</p><div class=paragraph><p>Hoewel de reservoirs voor <code>src/</code> en <code>ports/</code> nu SVN gebruiken, blijven cliëntgereedschappen zoals csup die van de oudere CVS-infrastructuur afhankelijk zijn normaal werken - veranderingen in het SVN-archief worden voor dit doel teruggeplaatst naar CVS. In tegenstelling tot <code>src/</code> en <code>ports/</code> wordt het SVN-reservoir voor de documentatie niet teruggeplaatst naar CVS.</p></div><div class=paragraph><p>Het primaire CVS <a href=http://www.FreeBSD.org/cgi/cvsweb.cgi>archief</a> staat op een systeem in Santa Clara, Californië, in de VS, waar het wordt gesynchroniseerd met verschillende "mirrors" over de hele wereld. De boomstructuur van SVN , waarin de broncode voor <a href=./#current>-CURRENT</a> en <a href=./#stable>-STABLE</a> is te vinden, kan ook makkelijk met die op een eigen systeem gesynchroniseerd worden. <a href=./#synching>Synchroniseren van broncode</a> bevat meer informatie over dit onderwerp.</p></div></dd><dt class=hdlist1>Committers <a id=development-committers></a></dt><dd><p>De zogenaamde <em>committers</em> zijn alle mensen die <em>schrijf</em>-rechten hebben in het Subversion-archief van FreeBSD. Deze mensen mogen veranderingen maken aan de broncode van FreeBSD (de term "committer" is afkomstig van het <code>commit</code> commando van versiebeheersystemen, wat gebruikt wordt om veranderingen door te voeren in het archief). De beste manier om eigen bijdragen te laten keuren door een van de committers is door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a>. Als het erop lijkt dat een bijdrage ergens in het systeem blijft hangen, dan is het ook mogelijk om mail te sturen naar de FreeBSD committer’s mailinglijst.</p></dd><dt class=hdlist1>Het FreeBSD Core Team<a id=development-core></a></dt><dd><p>Het <em>FreeBSD core team</em> zou het equivalent zijn van een raad van bestuur als het FreeBSD Project een bedrijf zou zijn. De primaire taak van het core team is ervoor zorg te dragen dat het project, in zijn geheel, in goede vorm verkeert en de goede richting opgaat. Toegewijde en verantwoordelijke ontwikkelaars uitnodigen om deel te worden van de committers is één van de taken van het core team, net als het rekruteren van nieuwe leden van het core team. Het huidige core team is gekozen door de committers uit een groep van kandidaten (ook allen committers) in juli 2012. Elke twee jaar worden verkiezingen gehouden.</p><div class=paragraph><p>Sommige leden van het core team hebben een bijzondere verantwoordelijkheid, wat wil zeggen dat zij er speciaal op toezien dat een bepaald deel van het systeem werkt zoals het hoort. In de <a href=https://docs.freebsd.org/en/articles/contributors/>lijst van medewerkers</a> staat een complete lijst van ontwikkelaars en hun verantwoordelijkheden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De meeste leden van het core team zijn vrijwilligers. "Toewijding" betekent dus niet "gegarandeerde ondersteuning". De "raad van bestuur"-analogie hierboven klopt niet helemaal en het is misschien beter om te zeggen dat dit de mensen zijn die hun leven opgaven voor FreeBSD, tegen beter weten in!</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1>Externe Bijdragen</dt><dd><p>De grootste groep ontwikkelaars zijn de gebruikers zelf, die FreeBSD continu voorzien van constructief commentaar en oplossingen voor fouten. De handigste manier om contact te houden met het niet-gecentraliseerde deel van de ontwikkeling van FreeBSD is een abonnement nemen op de <a href=https://lists.FreeBSD.org/subscription/freebsd-hackers>FreeBSD technische discussie mailinglijst</a>, waar allerlei bijdragen, patches en nieuwe ideeën worden bediscussieerd. In <a href=./#eresources>Bronnen op Internet</a> is meer informatie te vinden over de verschillende FreeBSD mailinglijsten.</p><div class=paragraph><p><a href=https://docs.freebsd.org/en/articles/contributors/>De lijst van medewerkers</a> is lang en groeit iedere dag, dus wat let de lezer om zelf een bijdrage te doen aan FreeBSD?</p></div><div class=paragraph><p>Programmeren is niet de enige manier om een bijdrage te leveren aan het project. Een meer volledige lijst van dingen die gedaan moeten worden staat op de <a href=https://www.FreeBSD.org/>FreeBSD website</a>.</p></div></dd></dl></div><div class=paragraph><p>Samengevat is het FreeBSD ontwikkelmodel georganiseerd als een onsamenhangende verzameling van concentrische cirkels. Het gecentraliseerde model is ontworpen voor het gemak van de <em>gebruikers</em> van FreeBSD, die op deze manier makkelijk de wijzigingen in het project kunnen volgen. Niet om potentiële medewerkers buiten de deur te houden! Het is wenselijk om een stabiel besturingssysteem te maken, met een grote verzameling samenhangende <a href=./#ports>applicaties</a>. Dit model heeft zijn waarde op dat gebied bewezen.</p></div><div class=paragraph><p>Om bij te dragen en samen FreeBSD verder te ontwikkelen, is het enige wat het FreeBSD Project vraagt dat te doen met dezelfde toewijding als de huidige ontwikkelaars: succes gegarandeerd!</p></div></div><div class=sect3><h4 id=relnotes>1.3.4. Huidige FreeBSD uitgave<a class=anchor href=#relnotes></a></h4><div class=paragraph><p>FreeBSD is een open source, op 4.4BSD-Lite gebaseerd besturingssysteem voor Intel (x86 en Itanium®), AMD64, n Sun UltraSPARC® computers. Het is grotendeels gebaseerd op software van de Computer Systems Research Group (CSRG) van de University of California in Berkeley (U.C. Berkeley), met verbeteringen overgenomen van NetBSD, OpenBSD, 386BSD en de Free Software Foundation.</p></div><div class=paragraph><p>Sinds het uitbrengen van FreeBSD 2.0 tegen het einde van 1994, zijn de prestaties, mogelijkheden en stabiliteit van FreeBSD dramatisch verbeterd. FreeBSD heeft namelijk de beschikking over een compleet nieuw subsysteem voor virtueel geheugen, dat niet alleen de prestaties ten goede komt, maar er ook voor zorgt dat het systeem minder geheugen gebruikt dan ooit tevoren. Andere belangrijke verbeteringen zijn de ondersteuning van veel nieuwe hardware, een compleet nieuw systeem voor de ondersteuning van machines met meerdere processoren (SMP) en een nieuwe bibliotheek voor de ondersteuning van multithreading in applicaties.</p></div><div class=paragraph><p>Behalve de basisdistributie van het besturingssysteem, biedt FreeBSD ook een enorme softwarecollectie met duizenden veelgebruikte programma’s, de zogenaamde ports. Op het moment van schrijven zijn er al meer dan 36000 ports! In de ports zitten alle mogelijke klassen van software die te bedenken zijn, van HTTP-servers tot spellen, van kantoorapplicaties tot multimedia en alles wat er tussenin zit. De complete Portscollectie beslaat zo’n 3 GB aan schijfruimte. Meer informatie over de ports en over de pakketten is te vinden in <a href=./#ports>Applicaties installeren. pakketten en ports</a>.</p></div><div class=paragraph><p>Alle recente versies van FreeBSD bieden een optie aan in de installer (ofwel <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> ofwel <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdinstall&amp;sektion=8&amp;format=html">bsdinstall(8)</a>) om aanvullende documentatie te installeren onder <span class=filename>/usr/local/shared/doc/freebsd</span> tijdens de eerste installatie van het systeem. De documentatie kan ook op elk later tijdstip worden geïnstalleerd door pakketten te gebruiken zoals beschreven in <a href=./#doc-ports-install-package>Documentatiepakketten gebruiken</a>. De lokaal geïnstalleerde documentatie kan in een browser bekeken worden door de volgende URLs te gebruiken:</p></div><div class=dlist><dl><dt class=hdlist1>Het FreeBSD handboek</dt><dd><p><a href=file://localhost/usr/local/shared/doc/freebsd/handbook/index.html>/usr/local/shared/doc/freebsd/handbook/index.html</a></p></dd><dt class=hdlist1>De FreeBSD FAQ</dt><dd><p><a href=file://localhost/usr/local/shared/doc/freebsd/faq/index.html>/usr/local/shared/doc/freebsd/faq/index.html</a></p></dd></dl></div><div class=paragraph><p>De nieuwste versies van deze documenten zijn altijd te vinden op <a href=http://www.FreeBSD.org/>http://www.FreeBSD.org/</a>.</p></div></div></div></div></div><div class=sect1><h2 id=install>Hoofdstuk 2. FreeBSD installeren op FreeBSD 8.X en eerder<a class=anchor href=#install></a></h2><div class=sectionbody><div class=sect2><h3 id=install-synopsis>2.1. Overzicht<a class=anchor href=#install-synopsis></a></h3><div class=paragraph><p>FreeBSD heeft een tekstgebaseerd, gebruikersvriendelijk installatieprogramma. FreeBSD 9.0-RELEASE en later gebruiken het installatieprogramma bsdinstall, uitgaven eerder dan 9.0-RELEASE gebruiken sysinstall voor de installatie. Dit hoofdstuk beschrijft het gebruikt van sysinstall om FreeBSD te installeren. Het gebruik van bsdinstall wordt behandeld in <a href=./#bsdinstall>FreeBSD 9.X en nieuwer installeren</a>.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe FreeBSD installatieschijven gemaakt kunnen worden;</p></li><li><p>Hoe FreeBSD harde schijven benoemt en onderverdeelt;</p></li><li><p>Hoe sysinstall gestart kan worden;</p></li><li><p>Welke vragen sysinstall stelt, wat ze betekenen en hoe er geantwoord kan worden.</p></li></ul></div><div class=paragraph><p>Veronderstelde voorkennis:</p></div><div class=ulist><ul><li><p>De ondersteunde hardwarelijst doornemen van de versie van FreeBSD die geïnstalleerd gaat worden op aanwezigheid van de beschikbare hardware.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In zijn algemeenheid zijn deze installatie-instructies geschreven voor computers met een i386™ architectuur ("PC compatible"). Waar van toepassing worden instructies voor andere platformen gegeven. Deze handleiding is zoveel mogelijk bijgewerkt, maar toch kunnen er verschillen optreden tussen de installatieprocedure en deze tekst. Er wordt aangeraden dit hoofdstuk te beschouwen als een algemene richtlijn en niet als een letterlijke handleiding voor installatie.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=install-hardware>2.2. Hardware-eisen<a class=anchor href=#install-hardware></a></h3><div class=sect3><h4 id=install-hardware-minimal>2.2.1. Minimale configuratie<a class=anchor href=#install-hardware-minimal></a></h4><div class=paragraph><p>De minimale configuratie om FreeBSD te installeren varieert met de versie van FreeBSD en de hardware-architectuur.</p></div><div class=paragraph><p>Een samenvatting van deze informatie wordt in de volgende secties gegeven. Afhankelijk van de methode die u kiest om FreeBSD te installeren, heeft u misschien ook een floppydrive, een ondersteunde CDROM drive, en in sommige gevallen een netwerkadapter nodig. Dit zal worden behandeld door het <a href=#install-boot-media>Opstartmedia aanmaken</a>.</p></div><div class=sect4><h5 id=_freebsdi386_en_freebsdpc98>2.2.1.1. FreeBSD/i386 en FreeBSD/pc98<a class=anchor href=#_freebsdi386_en_freebsdpc98></a></h5><div class=paragraph><p>Zowel FreeBSD/i386 en FreeBSD/pc98 hebben een 486 of betere processor en tenminste 24 MB aan RAM nodig. U zult tenminste 150 MB aan vrije hardeschijfruimte nodig hebben voor de meest minimale installatie.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In het geval van oude configuraties is het verkrijgen van meer RAM en meer hardeschijfruimte meestal belangrijker dan het verkrijgen van een snellere processor.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_freebsdamd64>2.2.1.2. FreeBSD/amd64<a class=anchor href=#_freebsdamd64></a></h5><div class=paragraph><p>Er zijn twee klassen processoren die FreeBSD/amd64 kunnen draaien. De eerste zijn AMD64 processoren, inclusief de AMD Athlon™64, AMD Athlon™64-FX, AMD Opteron™ of betere processoren.</p></div><div class=paragraph><p>De tweede klasse van processoren die FreeBSD/amd64 kan gebruiken omvat degenen die de Intel® EM64T architectuur gebruiken. Voorbeelden van deze processoren omvatten de Intel® Core™ 2 Duo, Quad, en Extreme processorfamilies en de Intel® Xeon™ 3000, 5000, en 7000 rijen van processoren.</p></div><div class=paragraph><p>Indien u een machine heeft die gebaseerd is op een nVidia nForce3 Pro-150, <em>moet</em> u de BIOS-setup gebruiken om IO APIC uit te zetten. Indien u geen optie heeft om dit te doen, moet u waarschijnlijk in plaats hiervan ACPI uitzetten. Er zitten bugs in de Pro-150 chipset waarvoor we nog geen oplossing hebben gevonden.</p></div></div><div class=sect4><h5 id=_freebsdsparc64>2.2.1.3. FreeBSD/sparc64<a class=anchor href=#_freebsdsparc64></a></h5><div class=paragraph><p>Om FreeBSD/sparc64 te installeren heeft u een ondersteund platform nodig (zie <a href=#install-hardware-supported>Ondersteunde hardware</a>).</p></div><div class=paragraph><p>U heeft een toegewijde schijf nodig voor FreeBSD/sparc64. Het is momenteel niet mogelijk om een schijf met een ander besturingssysteem te delen.</p></div></div></div><div class=sect3><h4 id=install-hardware-supported>2.2.2. Ondersteunde hardware<a class=anchor href=#install-hardware-supported></a></h4><div class=paragraph><p>Een lijst van ondersteunde hardware wordt geleverd bij elke uitgave van FreeBSD in de FreeBSD Hardware Notes. Dit document kan normaliter worden gevonden in een bestand genaamd <span class=filename>HARDWARE.TXT</span>, in de bovenste map van een CDROM- of FTP-distributie of in het documentatiemenu van sysinstall. Het somt, voor een gegeven architectuur, op welke hardware-apparaten door welke uitgave van FreeBSD worden ondersteund. Kopiën van de lijst van ondersteunde hardware voor verschillende uitgaven en architecturen kunnen ook gevonden worden op de <a href=http://www.FreeBSD.org/releases/>Uitgave Informatie</a> pagina van de FreeBSD website.</p></div></div></div><div class=sect2><h3 id=install-pre>2.3. Voorbereidende taken<a class=anchor href=#install-pre></a></h3><div class=sect3><h4 id=install-inventory>2.3.1. Beschrijf de computer<a class=anchor href=#install-inventory></a></h4><div class=paragraph><p>Probeer een computer te inventariseren voordat FreeBSD wordt geïnstalleerd. De FreeBSD installatieroutines geven een overzicht van alle componenten (harde schijven, netwerkkaarten, CD-ROM-spelers, enzovoort) met hun typenummer en fabrikant. FreeBSD probeert ook de juiste instellingen te achterhalen, zoals IRQ en IO-poort gebruik. Vanwege de verscheidenheid aan PC-hardware verloopt dit niet altijd helemaal succesvol en daarom kan het nodig zijn om de gegevens die FreeBSD achterhaalt te verbeteren.</p></div><div class=paragraph><p>Mocht er al een ander besturingssysteem geïnstalleerd zijn, zoals Windows® of Linux®, dan is het aan te raden de mogelijkheden van dat besturingssysteem te gebruiken om te achterhalen hoe hardware is ingesteld. Als niet volledig bekend is welke instellingen een uitbreidingskaart heeft, dan kan het zijn dat ze op de kaart zelf zijn afgedrukt. Veelvoorkomende IRQ nummers zijn 3, 5 en 7 en IO-poort adressen zijn meestal geschreven als hexadecimale getallen, zoals 0x330.</p></div><div class=paragraph><p>Er wordt aangeraden deze informatie af te drukken of op te schrijven voordat FreeBSD wordt geïnstalleerd. Het kan handig zijn om een tabel te maken, zoals deze:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 1. Voorbeeld van beschrijving van componenten</caption><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Component</th><th class="tableblock halign-left valign-top">IRQ</th><th class="tableblock halign-left valign-top">IO-poort(en)</th><th class="tableblock halign-left valign-top">Opmerkingen</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Eerste harde schijf</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>40 GB, Seagate, eerste IDE master</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CD-ROM</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Eerste IDE slave</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Tweede harde schijf</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20 GB, IBM, tweede IDE master</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Eerste IDE controller</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>14</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0x1f0</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Netwerkkaart</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Intel® 10/100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Modem</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3Com® 56K faxmodem, op COM1</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>…​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>…​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>…​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>…​</p></td></tr></tbody></table><div class=paragraph><p>Nadat de inventarisatie van de componenten in uw computer voltooid is, dient u te controleren of ze aan de hardware-eisen van de uitgave van FreeBSD die u wilt installeren voldoen.</p></div></div><div class=sect3><h4 id=_maak_een_back_up_van_gegevens>2.3.2. Maak een back-up van gegevens<a class=anchor href=#_maak_een_back_up_van_gegevens></a></h4><div class=paragraph><p>Als de computer waarop FreeBSD geïnstalleerd gaat worden waardevolle gegevens bevat, dan dient er een back-up te zijn en dient deze back-up getest te zijn voordat FreeBSD wordt geïnstalleerd. De FreeBSD installatieprocedure vraagt om bevestiging voordat er naar de schijven geschreven wordt, maar als dat eenmaal is begonnen kan het niet meer teruggedraaid worden.</p></div></div><div class=sect3><h4 id=install-where>2.3.3. Bepaal waar FreeBSD geïnstalleerd wordt<a class=anchor href=#install-where></a></h4><div class=paragraph><p>Als de hele harde schijf voor FreeBSD beschikbaar is, dan hoeft op dit punt verder niets gedaan te worden. Ga verder naar de volgende sectie.</p></div><div class=paragraph><p>Als FreeBSD echter naast een ander besturingssysteem op een computer komt, dan moet basaal bekend zijn hoe gegevens op schrijven worden opgeslagen en wat dat voor consequenties heeft.</p></div><div class=sect4><h5 id=install-where-i386>2.3.3.1. Indeling van schrijven voor FreeBSD/i386<a class=anchor href=#install-where-i386></a></h5><div class=paragraph><p>Een PC schijf kan worden onderverdeeld in aparte stukken. Deze stukken heten <em>partities</em>. Aangezien FreeBSD intern ook partities heeft, kan de naamgeving snel verwarrend worden, daarom wordt naar deze schijfstukken verwezen als schijfsnedes of simpelweg snedes (slices) in FreeBSD zelf. Het FreeBSD gereedschap <code>fdisk</code> bijvoorbeeld, dat met PC diskpartities werkt, verwijst naar snedes in plaats van partities. In het ontwerp van de PC is opgenomen dat een schijf slechts vier partities kan bevatten. Deze partities heten de <em>primaire partities</em>. Om deze beperking te omzeilen is een nieuwe soort partitie bedacht, de <em>extended partitie</em>. Een schijf kan slechts één extended partitie bevatten. Binnen een extended partitie kunnen speciale partities, genaamd <em>logische partities</em>, worden aangemaakt.</p></div><div class=paragraph><p>Elke partitie heeft een <em>partitie-ID</em>, een getal dat aangeeft welk soort gegevens er op die partitie staan. FreeBSD-partities hebben partitie-ID <code>165</code>.</p></div><div class=paragraph><p>In zijn algemeenheid benoemt elk besturingssysteem partities op zijn eigen manier. Bijvoorbeeld: MS-DOS® en zijn afgeleiden, zoals Windows®, geven elke primaire en logische partitie een <em>(station) letter</em>, beginnend met <span class=filename>C:</span>.</p></div><div class=paragraph><p>FreeBSD moet geïnstalleerd worden op een primaire partitie. FreeBSD kan al zijn gegevens, inclusief alle bestanden die zelf zijn gemaakt, op deze partitie opslaan. Als er meerdere schijven zijn, dan kunnen er FreeBSD-partities worden aangemaakt op alle of op sommige schijven. Als FreeBSD wordt geïnstalleerd moet er een partitie beschikbaar zijn. Dit kan een lege partitie zijn die is aangemaakt of het mag een bestaande partitie zijn met gegevens die niet langer bewaard hoeven te blijven.</p></div><div class=paragraph><p>Als alle partities op alle schijven gebruikt worden, dan moet er een leeg gemaakt worden voor FreeBSD met de hulpprogramma’s van het andere besturingssysteem dat wordt gebruikt (bijvoorbeeld <code>fdisk</code> onder MS-DOS® of Windows®).</p></div><div class=paragraph><p>Als er een partitie over is, dan kan die gebruikt worden. Het kan zo zijn dat één of meer van de bestaande partities verkleind moet worden.</p></div><div class=paragraph><p>Een minimale installatie van FreeBSD heeft 100 MB schijfruimte nodig. Dat is wel een <em>zeer</em> minimale installatie, waarop bijna geen ruimte over is voor eigen bestanden. Een meer realistisch minimum is 250 MB zonder grafische gebruikersomgeving en 350 MB of meer als er ook een grafische gebruikersomgeving moet draaien. Als er ook nog gebruikt gemaakt wordt van een heleboel programma’s van derde partijen dan is nog meer ruimte nodig.</p></div><div class=paragraph><p>Met commerciële software zoals PartitionMagic®, of gratis software zoals GPartEd, kunnen partities van grootte gewijzigd worden om ruimte te maken voor FreeBSD. Van zowel PartitionMagic® als GPartEd is bekend dat ze met NTFS kunnen werken. GPartEd is beschikbaar op een aantal Live CD Linux-distributies, zoals <a href=http://www.sysresccd.org/>SystemRescueCD</a>.</p></div><div class=paragraph><p>Er zijn problemen gemeld met het veranderen van de grootte van Microsoft® Vista-partities. Het beschikbaar hebben van een Vista installatie-CDROM tijdens het pogen van zo’n bewerking is aanbevolen. Zoals met al zulke schijfonderhoudtaken is een recente verzameling back-ups ook sterk aangeraden.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Verkeerd gebruik van deze programma’s kan gegevens van een schijf verwijderen. Er dient een goede, werkende back-up te zijn voordat deze programma’s gebruikt worden.</p></div></td></tr></tbody></table></div><div class=exampleblock><div class=title>Voorbeeld 1. Gebruik van een bestaande, ongewijzigde partitie</div><div class=content><div class=paragraph><p>Stel er is al een computer met een enkele 4 GB harde schijf waarop een versie van Windows® is geïnstalleerd en de schijf is verdeeld in twee schijfstations, <span class=filename>C:</span> en <span class=filename>D:</span>, van elk 2 GB. Er staat 1 GB aan gegevens op <span class=filename>C:</span> en 0.5 GB aan gegevens op <span class=filename>D:</span>.</p></div><div class=paragraph><p>Dit betekent dat de harde schijf twee partities heeft, één voor elke letter. Alle gegevens op <span class=filename>D:</span> kunnen gekopieerd worden naar <span class=filename>C:</span>, waardoor de tweede partitie beschikbaar komt voor FreeBSD.</p></div></div></div><div class=exampleblock><div class=title>Voorbeeld 2. Een bestaande partitie verkleinen</div><div class=content><div class=paragraph><p>Stel er is een computer met een enkele 4 GB harde schijf waarop een versie van Windows® is geïnstalleerd. Bij het installeren van Windows® is een grote partitie gemaakt, station <span class=filename>C:</span> van 4 GB. Er is 1.5 GB in gebruik en voor FreeBSD is 2 GB schijfruimte wenselijk.</p></div><div class=paragraph><p>Voor een installatie van FreeBSD is één van onderstaande opties de oplossing:</p></div><div class="olist arabic"><ol class=arabic><li><p>Maak een back-up van de Windows® gegevens en installeer Windows® opnieuw, waarbij een partitie van 2 GB wordt aanmaakt bij het installeren.</p></li><li><p>Gebruik één van de bovengenoemde programma’s zoals PartitionMagic® om de Windows®-partitie te verkleinen.</p></li></ol></div></div></div></div></div><div class=sect3><h4 id=_netwerkgegevens_verzamelen>2.3.4. Netwerkgegevens verzamelen<a class=anchor href=#_netwerkgegevens_verzamelen></a></h4><div class=paragraph><p>Als bij de installatie van FreeBSD gebruik gemaakt wordt van een netwerk (bijvoorbeeld bij een installatie vanaf een FTP site of een NFS server), dan moeten de netwerkinstellingen bekend zijn. Deze informatie wordt gevraagd tijdens het installeren, zodat FreeBSD contact kan maken met het netwerk om de installatie te voltooien.</p></div><div class=sect4><h5 id=_contact_maken_met_een_ethernet_netwerk_of_kabeldsl_modem>2.3.4.1. Contact maken met een Ethernet netwerk of kabel/DSL modem<a class=anchor href=#_contact_maken_met_een_ethernet_netwerk_of_kabeldsl_modem></a></h5><div class=paragraph><p>Als er contact gemaakt wordt met een Ethernet netwerk of een Internetverbinding met een Ethernet netwerkkaart via de kabel of DSL, dan is de volgende informatie nodig:</p></div><div class="olist arabic"><ol class=arabic><li><p>IP-adres</p></li><li><p>IP-adres van de default gateway</p></li><li><p>Hostnaam</p></li><li><p>IP-adressen van de DNS server(s)</p></li><li><p>Subnetmasker</p></li></ol></div><div class=paragraph><p>Als deze informatie niet bekend is, dan kan deze meestal nagevraagd worden bij de systeembeheerder of service provider. Het kan zijn dat zij aangeven dat één en ander automatisch wordt toegekend door middel van <em>DHCP</em>. Het is van belang hier een notitie van te maken.</p></div></div><div class=sect4><h5 id=_contact_maken_met_een_modem>2.3.4.2. Contact maken met een modem<a class=anchor href=#_contact_maken_met_een_modem></a></h5><div class=paragraph><p>Ook door middel van inbellen bij een Internet service provider met een gewoon modem kan FreeBSD geïnstalleerd worden via Internet, het duurt alleen erg lang.</p></div><div class=paragraph><p>Dan is nodig:</p></div><div class="olist arabic"><ol class=arabic><li><p>Het inbelnummer van een ISP</p></li><li><p>De COM: poort waaraan het modem zit</p></li><li><p>Gebruikersnaam en wachtwoord bij de ISP</p></li></ol></div></div></div><div class=sect3><h4 id=_controleer_op_freebsd_errata>2.3.5. Controleer op FreeBSD Errata<a class=anchor href=#_controleer_op_freebsd_errata></a></h4><div class=paragraph><p>Hoewel het FreeBSD project er naar streeft om elke versie van FreeBSD zo stabiel mogelijk te laten zijn, kan het voorkomen dat er foutjes in het systeem sluipen. Heel af en toe beïnvloeden deze foutjes de installatieprocedure. Als ze ontdekt en opgelost zijn worden ze beschreven in de <a href=https://www.FreeBSD.org/releases/12.0r/errata/>FreeBSD Errata</a> op de FreeBSD website. Het is verstandig voor een installatie te controleren of er errata zijn om er zeker van te zijn dat er geen obstakels zijn.</p></div><div class=paragraph><p>Informatie over alle uitgaven, inclusief de errata staan in de <a href=https://www.FreeBSD.org/releases/>uitgave-informatie </a>op de <a href=https://www.FreeBSD.org/>FreeBSD website</a>.</p></div></div><div class=sect3><h4 id=_de_freebsd_installatiebestanden>2.3.6. De FreeBSD installatiebestanden<a class=anchor href=#_de_freebsd_installatiebestanden></a></h4><div class=paragraph><p>De FreeBSD installatieprocedure kan FreeBSD installeren vanaf één van de volgende plaatsen:</p></div><div class=ulist><div class=title>Lokale media</div><ul><li><p>Cd-rom of DVD</p></li><li><p>Een USB-geheugenstick</p></li><li><p>Een MS-DOS® partitie op dezelfde computer</p></li><li><p>SCSI of QIC tape</p></li><li><p>Diskettestation</p></li></ul></div><div class=ulist><div class=title>Netwerk</div><ul><li><p>FTP site, indien noodzakelijk door een firewall of via een HTTP proxy</p></li><li><p>NFS server</p></li><li><p>Parallelle of seriële verbinding</p></li></ul></div><div class=paragraph><p>Als FreeBSD gekocht is op CD of DVD dan is alles wat nodig is aanwezig om door te gaan naar <a href=#install-boot-media>Opstartmedia aanmaken</a>.</p></div><div class=paragraph><p>Als de installatiebestanden nog niet beschikbaar zijn wordt in <a href=#install-diff-media>Aangepaste installatiemedia maken</a> uitgelegd hoe de installatie via bovenstaande methoden voorbereid kan worden. Nadat de installatiebestanden beschikbaar zijn kunnen de voorbereidingen voor de installatie verdergaan in <a href=#install-boot-media>Opstartmedia aanmaken</a>.</p></div></div><div class=sect3><h4 id=install-boot-media>2.3.7. Opstartmedia aanmaken<a class=anchor href=#install-boot-media></a></h4><div class=paragraph><p>De FreeBSD installatieprocedure begint met het opstarten van een computer met het FreeBSD installatieprogramma. Dit programma wordt niet uitgevoerd vanuit een ander besturingssysteem. Normaliter start een computer op met het besturingssysteem dat is geïnstalleerd op een harde schijf, maar hij kan ook ingesteld worden om op te starten van een "bootable" diskette. De meeste hedendaagse computers kunnen ook opstarten van een CD-ROM in het CD-ROM station of van een USB-schijf.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Als FreeBSD op CD-ROM of DVD beschikbaar is (gekocht of zelf gebrand) en een computer kan opstarten van een CD-ROM of DVD (meestal een BIOS optie genaamd "Boot Order" of iets dergelijks), dan is het doorwerken van deze sectie niet nodig. De FreeBSD CD-ROM en DVD images zijn bootable en kunnen zonder verdere voorbereidingen gebruikt worden om FreeBSD te installeren.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om een opstartbare geheugenstick te maken kunnen deze stappen gevolgd worden:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Bemachtig een image voor de geheugenstick</p><div class=paragraph><p>Images voor de geheugenstick voor FreeBSD 8.<em>X</em> en ouder kunnen worden gedownload vanuit de map <span class=filename>ISO-IMAGES</span> van <code><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/arch/ISO-IMAGES/versie/FreeBSD-versie-RELEASE-arch-memstick.img class=bare>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/arch/ISO-IMAGES/versie/FreeBSD-versie-RELEASE-arch-memstick.img</a></code>. Vervang <em>arch</em> en <em>versie</em> door de architectuur en de versie die u wilt installeren. De geheugenstick-images voor FreeBSD/i386 11.2-RELEASE zijn beschikbaar op <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/11.2/FreeBSD-11.2-RELEASE-i386-memstick.img>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/11.2/FreeBSD-11.2-RELEASE-i386-memstick.img</a>.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Voor FreeBSD 9.0-RELEASE en nieuwere uitgaven wordt een ander pad voor de mappen gebruikt. Details over het downloaden en installeren van FreeBSD 9.0-RELEASE enn later wordt behandeld in <a href=./#bsdinstall>FreeBSD 9.X en nieuwer installeren</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het beeldbestand van de geheugenstick heeft een extensie <span class=filename>.img</span>. De map <span class=filename>ISO-IMAGES</span> bevat een aantal verschillende images, en degene die u nodig heeft zal afhangen van de FreeBSD-versie die u installeert, en in sommige gevallen van de hardware waarop u het installeert.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Maak voordat u verder gaat een <em>back-up</em> van de gegevens die nu op uw USB-stick staan, aangezien deze procedure ze zal <em>wissen</em>.</p></div></td></tr></tbody></table></div></li><li><p>Schrijf het beeldbestand naar de geheugenstick</p><div class="sidebarblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: FreeBSD gebruiken om het beeldbestand te schrijven</strong></p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Het onderstaande voorbeeld vermeldt <span class=filename>/dev/da0</span> als het doelapparaat van waar af u zal opstarten. Zorg er voor dat u het juiste apparaat als het uitvoerapparaat opgeeft om te voorkomen dat u uw bestaande gegevens vernietigt.</p></div></td></tr></tbody></table></div><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>Het beeldbestand schrijven door middel van <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a></p><div class=paragraph><p>Het <span class=filename>.img</span>-bestand is <em>geen</em> gewoon bestand dat u naar de geheugenstick kopieert. Het is een afbeelding van de complete inhoud van de stick. Dit betekent dat u de bestanden <em>niet</em> op de gewone manier van de ene schijf naar de andere kan kopieëren. U dient in plaats hiervan <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a> gebruiken om de afbeelding direct naar de schijf te schrijven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=FreeBSD-11.2-RELEASE-i386-memstick.img of=/dev/da0 bs=64k</span></code></pre></div></div><div class=paragraph><p>Als een <code>Operation not permitted</code> wordt weergegeven, controleer dan dat het apparaat niet in gebruik is en is aangekoppeld, eventueel automatisch door een gereedschap met goede intenties. Probeer het vervolgens opnieuw.</p></div></li></ol></div></div></div><div class="sidebarblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Windows® gebruiken om het beeldbestand te schrijven</strong></p></div><div class=paragraph><p>Zorg ervoor dat de juiste schijf letter gebruikt wordt als doelschijf, anders kan het voorkomen dat er bestaande data wordt overschreven.</p></div><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>Image Writer for Windows verkrijgen</p><div class=paragraph><p>Image Writer for Windows is een gratis applicatie die een beeld bestand correct naar een geheugen-stick kan schrijven. Download deze van <a href=https://launchpad.net/win32-image-writer/>https://launchpad.net/win32-image-writer/</a> en pak deze uit in een map.</p></div></li><li><p>Writing The Image with Image Writer</p><div class=paragraph><p>Dubbelklik op het Win23DiskImager icoon om het programma te starten. Controleer of de schijfletter welke getoond is onder <code>Device</code> de schijf is van de geheugen-stick. Klik op het map icoon en selecteer het bestand welke naar de geheugen-stick geschreven moet worden. Klik op <b class=button>Save</b> om het bestand te accepteren. Controleer of alles correct is en dat er geen bestanden en dergelijke open zijn in andere vensters. Klik als laatste op <b class=button>Write</b> om het bestand te schrijven naar de schijf.</p></div></li></ol></div></div></div></li></ol></div></div></div><div class=paragraph><p>Om opstartdiskettes te maken kunnen de volgende stappen gevolgd worden:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Bemachtig de images voor opstartdiskettes</p><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Merk op dat met ingang van FreeBSD 8.<em>X</em> floppy-images niet langer beschikbaar zijn. Zie de bovenstaande instructies voor hoe FreeBSD met behulp van een USB-geheugenstick te installeren, of gebruik een CD-ROM of DVD.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De opstartschijven zijn beschikbaar op de installatiemedia in de map <span class=filename>floppies/</span> en kunnen ook gedownload worden uit de map floppies, <code><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/arch/versie-RELEASE/floppies/ class=bare>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/arch/versie-RELEASE/floppies/</a></code>. Vervang <em>arch</em> en <em>versie</em> door de architectuur en het versienummer dat geïnstalleerd moet worden. De images voor bootdiskettes voor bijvoorbeeld FreeBSD/i386 11.2-RELEASE zijn beschikbaar op <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/11.2-RELEASE/floppies/>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/11.2-RELEASE/floppies/</a>.</p></div><div class=paragraph><p>De diskette-images hebben de extensie <span class=filename>.flp</span>. De map <span class=filename>floppies/</span> bevat een aantal images en het hangt af van de gewenste FreeBSD versie, en in sommige gevallen ook van de hardware, welke images nodig zijn. In de meeste gevallen zijn er vier floppies nodig, <span class=filename>boot.flp</span>, <span class=filename>kern1.flp</span>, <span class=filename>kern2.flp</span>, en <span class=filename>kern3.flp</span>. In dezelfde map staat <span class=filename>README.TXT</span> voor de laatste informatie over de diskette-images.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Het FTP-programma moet ingesteld staan in <em>binary modus</em> om de disk-images te downloaden. Sommige webbrowsers blijken de <em>text</em> (of <em>ASCII</em>) modus te gebruiken en dan kan er niet van de diskettes opgestart worden.</p></div></td></tr></tbody></table></div></li><li><p>Maak de diskettes aan</p><div class=paragraph><p>Per gedownload image wordt een diskette aangemaakt. Vanzelfsprekend moeten deze diskettes vrij zijn van fouten. Het gemakkelijkst is dit te testen door de diskettes te formatteren. Vanaf de fabriek geformatteerde floppies kunnen niet vertrouwd worden. Het programma format in Windows® meldt niet of er <code>bad blocks</code> zijn, het markeert ze gewoon als "bad" en negeert ze. Het wordt geadviseerd schone, nieuwe floppies te gebruiken als op deze manier wordt geïnstalleerd.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Als bij het installeren van FreeBSD het installatieprogramma vastloopt, blijft hangen of zich op een andere manier vreemd gedraagt, dan ligt dat meestal aan de floppies. Probeer dan de diskette-images op nieuwe schijven te schrijven en probeer het opnieuw.</p></div></td></tr></tbody></table></div></li><li><p>Schrijf de imagebestanden op diskettes</p><div class=paragraph><p>De <span class=filename>.flp</span>-bestanden zijn <em>geen</em> gewone bestanden die naar een diskette te kopiëren zijn. Het zijn images van de complete inhoud van een diskette. Dit betekent dat ze <em>niet</em> eenvoudigweg gekopieerd kunnen worden van de ene schijf naar de andere. In plaats daarvan moet speciale software gebruikt worden om de images rechtstreeks op de diskettes te schrijven.</p></div><div class=paragraph><p>Als de diskettes aanmaakt worden op een computer met MS-DOS® / Windows®, dan levert het FreeBSD project de software <code>fdimage</code>.</p></div><div class=paragraph><p>Als de floppies van de CD-ROM worden gebruikt en het CD-ROM station is <span class=filename>E:</span>, dan kan dit als volgt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>E:<span class=se>\&gt;</span> tools<span class=se>\f</span>dimage floppies<span class=se>\b</span>oot.flp A:</code></pre></div></div><div class=paragraph><p>Herhaal dit commando voor elk <span class=filename>.flp</span>-bestand, waarbij steeds een nieuwe diskette wordt gebruikt. Merk elke diskette met de naam van het bestand dat erop wordt gekopieerd. Pas de opdrachtregel steeds aan, afhankelijk van waar de <span class=filename>.flp</span>-bestanden staan. Als er geen CD-ROM beschikbaar is dan kan <code>fdimage</code> gedownload worden vanuit de <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/tools/>map tools</a> op de FreeBSD FTP site.</p></div><div class=paragraph><p>Als de diskettes worden aanmaakt op een UNIX® systeem (zoals een ander FreeBSD systeem) dan kan <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a> gebruikt worden om de imagebestanden naar diskette te kopiëren. Onder FreeBSD:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=boot.flp of=/dev/fd0</span></code></pre></div></div><div class=paragraph><p>Onder FreeBSD verwijst <span class=filename>/dev/fd0</span> naar het eerste diskettestation (de <span class=filename>A:</span>-schijf). <span class=filename>/dev/fd1</span> zou de <span class=filename>B:</span>-schijf zijn enzovoorts. Andere UNIX®-varianten kunnen andere namen hebben voor de diskettestations. Meer informatie staat in de documentatie van ieder systeem.</p></div></li></ol></div></div></div><div class=paragraph><p>Het installeren van FreeBSD kan nu beginnen.</p></div></div></div><div class=sect2><h3 id=install-start>2.4. Beginnen met de installatie<a class=anchor href=#install-start></a></h3><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>De installatie maakt geen wijzigingen op schijven totdat het volgende bericht verschijnt:</p></div><div class=literalblock><div class=content><pre>Last Chance: Are you SURE you want continue the installation?

If you&#39;re running this on a disk with data you wish to save then WE
STRONGLY ENCOURAGE YOU TO MAKE PROPER BACKUPS before proceeding!

We can take no responsibility for lost disk contents!</pre></div></div><div class=paragraph><p>De installatie kan worden beëindigd op elk moment voor deze laatste waarschuwing zonder dat de inhoud van harde schijven wordt gewijzigd. Als de angst bestaat dat er iets verkeerd is ingesteld, dan kan op dat moment gewoon de computer uitgezet worden zonder dat er schade optreedt.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=install-starting>2.4.1. Opstarten<a class=anchor href=#install-starting></a></h4><div class=sect4><h5 id=install-starting-i386>2.4.1.1. Opstarten van i386™<a class=anchor href=#install-starting-i386></a></h5><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Begin met een computer die uit staat.</p></li><li><p>Zet de computer aan. Als hij aangaat laat hij een optie zien om het systeeminstelmenu, of BIOS, te bereiken, gewoonlijk via <kbd>F2</kbd>, <kbd>F10</kbd>, <kbd>Del</kbd>, of <span class=keyseq><kbd>Alt</kbd>+<kbd>S</kbd></span>. Gebruik de toets die op het scherm wordt aangegeven. In sommige gevallen laat de computer een plaatje zien terwijl hij opstart. Gewoonlijk verdwijnt dit plaatje door het intypen van <kbd>Esc</kbd> zodat eventuele verborgen berichten zichtbaar worden.</p></li><li><p>Zoek de instelling die bepaalt vanaf welk medium de computer opstart. Dit wordt meestal aangeduid met "Boot Order" en laat een lijst met media zien, zoals <code>Floppy</code>, <code>CD-ROM</code>, <code>eerste harde schijf</code>, enzovoorts.</p><div class=paragraph><p>Als u van de CD-ROM opstart, zorg er dan voor dat de CD-ROM geselecteerd is. Als wordt opstart van een USB-schijf of een diskette, stel dat dan in. Raadpleeg in geval van twijfel de documentatie van de computer en/of het moederbord.</p></div><div class=paragraph><p>Maak de instellingen, bewaar de veranderingen en sluit het instelprogramma af. De computer moet dan opnieuw starten.</p></div></li><li><p>Als u een "opstartbare" USB-stick heeft klaargemaakt zoals beschreven in <a href=#install-boot-media>Opstartmedia aanmaken</a>, steek dan de USB-stick in voordat u de computer aanzet.</p><div class=paragraph><p>Bij opstarten vanaf CD moet na het aanzetten van de computer zo snel mogelijk de CD-ROM ingestoken worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voor FreeBSD 7.<em>X</em> zijn installatiediskettes beschikbaar en ze kunnen worden klaargemaakt zoals beschreven in <a href=#install-boot-media>Opstartmedia aanmaken</a>. Eén van deze is de eerste opstartschijf: <span class=filename>boot.flp</span>. Plaats deze schijf in uw diskettestation en start de computer op.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als de computer opstart zoals altijd en met het huidige besturingssysteem begint, dan kan dat om de volgende redenen zijn:
.. De opstartschijven waren niet vroeg genoeg in de computer gedaan om ervan op te starten. Laat ze er dan inzitten en probeer de computer te herstarten.
.. De gemaakte wijzigingen in de BIOS zijn niet goed doorgekomen. Doe dat dan nog een keer totdat de juiste instelling gevonden is.
.. De BIOS ondersteunt het opstarten van het gekozen medium niet.</p></div></li><li><p>FreeBSD start nu op. Bij opstarten vanaf CD-ROM is iets als het volgende op het scherm te zien (versie-informatie weggelaten):</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Booting from CD-Rom...
645MB medium detected
CD Loader 1.2

Building the boot loader arguments
Looking up /BOOT/LOADER... Found
Relocating the loader and the BTX
Starting the BTX loader

BTX loader 1.00 BTX version is 1.02
Consoles: internal video/keyboard
BIOS CD is cd0
BIOS drive C: is disk0
BIOS drive D: is disk1
BIOS 636kB/261056kB available memory

FreeBSD/i386 bootstrap loader, Revision 1.1

Loading /boot/defaults/loader.conf
/boot/kernel/kernel <span class=nv>text</span><span class=o>=</span>0x64daa0 <span class=nv>data</span><span class=o>=</span>0xa4e80+0xa9e40 <span class=nv>syms</span><span class=o>=[</span>0x4+0x6cac0+0x4+0x88e9d]
<span class=se>\</span></code></pre></div></div><div class=paragraph><p>Bij opstarten vanaf diskette is iets als het volgende op het scherm te zien (versie-informatie weggelaten):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Booting from Floppy...
Uncompressing ... <span class=k>done

</span>BTX loader 1.00  BTX version is 1.01
Console: internal video/keyboard
BIOS drive A: is disk0
BIOS drive C: is disk1
BIOS 639kB/261120kB available memory

FreeBSD/i386 bootstrap loader, Revision 1.1

Loading /boot/defaults/loader.conf
/kernel <span class=nv>text</span><span class=o>=</span>0x277391 <span class=nv>data</span><span class=o>=</span>0x3268c+0x332a8 |

Insert disk labelled <span class=s2>&#34;Kernel floppy 1&#34;</span> and press any key...</code></pre></div></div><div class=paragraph><p>Volg de instructies op en haal de diskette met <span class=filename>boot.flp</span> eruit, stop de diskette met <span class=filename>kern1.flp</span> in het station en druk op <kbd>Enter</kbd>. Start op vanaf de eerste diskette en geef volgende diskettes in als daarom wordt gevraagd.</p></div></li><li><p>Of nu wordt opstart van CD-ROM, USB-stick of diskette, de opstartprocedure komt op een gegeven moment bij het bootloader-menu van FreeBSD:</p><div id=boot-loader-menu class=imageblock><div class=content><img src=../../../../images/books/handbook/install/boot-loader-menu.png alt="boot loader menu"></div><div class=title>Figuur 1. FreeBSD bootloader-menu</div></div><div class=paragraph><p>Wacht 10 seconden of druk op <kbd>Enter</kbd>.</p></div></li></ol></div></div></div></div><div class=sect4><h5 id=_opstarten_voor_sparc64>2.4.1.2. Opstarten voor sparc64<a class=anchor href=#_opstarten_voor_sparc64></a></h5><div class=paragraph><p>De meeste sparc64-systemen zijn ingesteld om automatisch vanaf schijf op te starten. Om FreeBSD te installeren dient u over het netwerk of vanaf een CDROM op te starten, waarvoor u in de PROM (OpenFirmware) dient te breken.</p></div><div class=paragraph><p>Start het systeem opnieuw op, en wacht totdat te opstartboodschappen verschijnen om dit te doen. Het hangt af van het model, maar het zou er ongeveer zo uit moeten zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Sun Blade 100 <span class=o>(</span>UltraSPARC-IIe<span class=o>)</span>, Keyboard Present
Copyright 1998-2001 Sun Microsystems, Inc.  All rights reserved.
OpenBoot 4.2, 128 MB memory installed, Serial <span class=c>#51090132.</span>
Ethernet address 0:3:ba:b:92:d4, Host ID: 830b92d4.</code></pre></div></div><div class=paragraph><p>Als uw systeem vanaf hier verder gaat met opstarten vanaf schijf, dient u <span class=keyseq><kbd>L1</kbd>+<kbd>A</kbd></span> of <span class=keyseq><kbd>Stop</kbd>+<kbd>A</kbd></span> op het toetsenbord in te drukken, of een <code>BREAK</code> over de seriële console te versturen (door bijvoorbeeld <code>~#</code> in <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=cu&amp;sektion=1&amp;format=html">cu(1)</a> te gebruiken) om bij de PROM-prompt te komen. Het ziet er als volgt uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ok     <i class=conum data-value=1></i><b>(1)</b>
ok <span class=o>{</span>0<span class=o>}</span> <i class=conum data-value=2></i><b>(2)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Deze prompt wordt gebruikt op systemen met slechts één CPU.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Deze prompt wordt op SMP-systemen gebruikt, het cijfer geeft het aantal actieve CPUs aan.</td></tr></tbody></table></div><div class=paragraph><p>Stop hier de CDROM in uw drive, en typ op de PROM-prompt <code>boot cdrom</code>.</p></div></div></div><div class=sect3><h4 id=view-probe>2.4.2. Resultaten van het hardware-onderzoek bekijken<a class=anchor href=#view-probe></a></h4><div class=paragraph><p>De laatste paar honderd regels die op het scherm verschenen zijn bewaard en kunnen bekeken worden.</p></div><div class=paragraph><p>Druk op <kbd>Scroll Lock</kbd> om ze te bekijken. Hiermee wordt de scrollmodus ingeschakeld. Gebruik de pijltjestoetsen en <kbd>PageUp</kbd> en <kbd>PageDown</kbd> om de resultaten te bekijken. Druk weer op <kbd>Scroll Lock</kbd> om de scrollmodus uit te schakelen.</p></div><div class=paragraph><p>Dit kan nu gedaan worden om de tekst te bekijken die over het scherm rolde terwijl de kernel de hardware onderzocht. Er is tekst te zoals in <a href=#install-dev-probe>Voorbeeld resultaten hardware-onderzoek</a>, maar de exacte tekst is anders, afhankelijk van de componenten in een computer.</p></div><div id=install-dev-probe class=listingblock><div class=title>Voorbeeld resultaten hardware-onderzoek</div><div class=content><pre class="rouge highlight"><code data-lang=shell>avail memory <span class=o>=</span> 253050880 <span class=o>(</span>247120K bytes<span class=o>)</span>
Preloaded elf kernel <span class=s2>&#34;kernel&#34;</span> at 0xc0817000.
Preloaded mfs_root <span class=s2>&#34;/mfsroot&#34;</span> at 0xc0817084.
md0: Preloaded image &lt;/mfsroot&gt; 4423680 bytes at 0xc03ddcd4

md1: Malloc disk
Using <span class=nv>$PIR</span> table, 4 entries at 0xc00fde60
npx0: &lt;math processor&gt; on motherboard
npx0: INT 16 interface
pcib0: &lt;Host to PCI bridge&gt; on motherboard
pci0: &lt;PCI bus&gt; on pcib0
pcib1:&lt;VIA 82C598MVP <span class=o>(</span>Apollo MVP3<span class=o>)</span> PCI-PCI <span class=o>(</span>AGP<span class=o>)</span> bridge&gt; at device 1.0 on pci0
pci1: &lt;PCI bus&gt; on pcib1
pci1: &lt;Matrox MGA G200 AGP graphics accelerator&gt; at 0.0 irq 11
isab0: &lt;VIA 82C586 PCI-ISA bridge&gt; at device 7.0 on pci0
isa0: &lt;iSA bus&gt; on isab0
atapci0: &lt;VIA 82C586 ATA33 controller&gt; port 0xe000-0xe00f at device 7.1 on pci0
ata0: at 0x1f0 irq 14 on atapci0
ata1: at 0x170 irq 15 on atapci0
uhci0 &lt;VIA 83C572 USB controller&gt; port 0xe400-0xe41f irq 10 at device 7.2 on pci
0
usb0: &lt;VIA 83572 USB controller&gt; on uhci0
usb0: USB revision 1.0
uhub0: VIA UHCI root hub, class 9/0, rev 1.00/1.00, addr1
uhub0: 2 ports with 2 removable, self powered
pci0: &lt;unknown card&gt; <span class=o>(</span><span class=nv>vendor</span><span class=o>=</span>0x1106, <span class=nv>dev</span><span class=o>=</span>0x3040<span class=o>)</span> at 7.3
dc0: &lt;ADMtek AN985 10/100BaseTX&gt; port 0xe800-0xe8ff mem 0xdb000000-0xeb0003ff ir
q 11 at device 8.0 on pci0
dc0: Ethernet address: 00:04:5a:74:6b:b5
miibus0: &lt;MII bus&gt; on dc0
ukphy0: &lt;Generic IEEE 802.3u media interface&gt; on miibus0
ukphy0: 10baseT, 10baseT-FDX, 100baseTX, 100baseTX-FDX, auto
ed0: &lt;NE2000 PCI Ethernet <span class=o>(</span>RealTek 8029<span class=o>)&gt;</span> port 0xec00-0xec1f irq 9 at device 10.
0 on pci0
ed0 address 52:54:05:de:73:1b, <span class=nb>type </span>NE2000 <span class=o>(</span>16 bit<span class=o>)</span>
isa0: too many dependant configs <span class=o>(</span>8<span class=o>)</span>
isa0: unexpected small tag 14
orm0: &lt;Option ROM&gt; at iomem 0xc0000-0xc7fff on isa0
fdc0: &lt;NEC 72065B or clone&gt; at port 0x3f0-0x3f5,0x3f7 irq 6 drq2 on isa0
fdc0: FIFO enabled, 8 bytes threshold
fd0: &lt;1440-KB 3.5” drive&gt; on fdc0 drive 0
atkbdc0: &lt;Keyboard controller <span class=o>(</span>i8042<span class=o>)&gt;</span> at port 0x60,0x64 on isa0
atkbd0: &lt;AT Keyboard&gt; flags 0x1 irq1 on atkbdc0
kbd0 at atkbd0
psm0: &lt;PS/2 Mouse&gt; irq 12 on atkbdc0
psm0: model Generic PS/@ mouse, device ID 0
vga0: &lt;Generic ISA VGA&gt; at port 0x3c0-0x3df iomem 0xa0000-0xbffff on isa0
sc0: &lt;System console&gt; at flags 0x100 on isa0
sc0: VGA &lt;16 virtual consoles, <span class=nv>flags</span><span class=o>=</span>0x300&gt;
sio0 at port 0x3f8-0x3ff irq 4 flags 0x10 on isa0
sio0: <span class=nb>type </span>16550A
sio1 at port 0x2f8-0x2ff irq 3 on isa0
sio1: <span class=nb>type </span>16550A
ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
pppc0: SMC-like chipset <span class=o>(</span>ECP/EPP/PS2/NIBBLE<span class=o>)</span> <span class=k>in </span>COMPATIBLE mode
ppc0: FIFO with 16/16/15 bytes threshold
plip0: &lt;PLIP network interface&gt; on ppbus0
ad0: 8063MB &lt;IBM-DHEA-38451&gt; <span class=o>[</span>16383/16/63] at ata0-master UDMA33
acd0: CD-RW &lt;LITE-ON LTR-1210B&gt; at ata1-slave PIO4
Mounting root from ufs:/dev/md0c
/stand/sysinstall running as init on vty0</code></pre></div></div><div class=paragraph><p>Controleer de resultaten van het hardware-onderzoek nauwgezet om er zeker van te zijn dat FreeBSD alle componenten gevonden heeft die verwacht worden. Als een component niet is gevonden, dan wordt die niet genoemd. Een <a href=./#kernelconfig>eigen kernel</a> staat u toe om apparaten te ondersteunen die niet in de <span class=filename>GENERIC</span> kernel zitten, zoals geluidskaarten.</p></div><div class=paragraph><p>Na de procedure voor het opsporen van apparaten <a href=#config-country>Landmenu kiezen</a>. Gebruik de pijltoetsen om een land, regio, of groep te kiezen. Druk daarna op <kbd>Enter</kbd>, dit stelt gemakkelijk uw land in.</p></div><div id=config-country class=imageblock><div class=content><img src=../../../../images/books/handbook/install/config-country.png alt="config country"></div><div class=title>Figuur 2. Landmenu kiezen</div></div><div class=paragraph><p>Als u <span class=guimenuitem>United States</span> als land heeft geselecteerd, dan zal de standaard Amerikaanse toetsenbordindeling worden gebruikt, als een ander land gekozen is, zal het volgende menu worden afgebeeld. Gebruik de pijltoetsen om de juiste toetsenbordindeling te kiezen en druk op <kbd>Enter</kbd>.</p></div><div id=config-keymap class=imageblock><div class=content><img src=../../../../images/books/handbook/install/config-keymap.png alt="config keymap"></div><div class=title>Figuur 3. Toetsenbordmenu kiezen</div></div><div class=paragraph><p>Nadat het juiste land is gekozen zal sysinstall het hoofd menu tonen.</p></div></div></div><div class=sect2><h3 id=using-sysinstall>2.5. Inleiding Sysinstall<a class=anchor href=#using-sysinstall></a></h3><div class=paragraph><p>Het hulpprogramma sysinstall is het installatieprogramma voor FreeBSD. Het is tekstgebaseerd en is onderverdeeld in een aantal menu’s en schermen die gebruikt kunnen worden om de installatieprocedure in te stellen en te beheren.</p></div><div class=paragraph><p>Het menu van sysinstall wordt bestuurd met de pijltjestoetsen, <kbd>Enter</kbd>, <kbd>Tab</kbd>, <kbd>Space</kbd> en andere toetsen. Een gedetailleerde beschrijving van de gebruikte toetsen en wat ze doen is opgenomen in de gebruikersinformatie voor sysinstall.</p></div><div class=paragraph><p>Selecteer de optie <span class=guimenuitem>Usage</span> om deze informatie te lezen. Selecteer de knop <b class=button>Select</b>, zoals in <a href=#sysinstall-main3>Usage selecteren in het sysinstall hoofdmenu</a>, en druk op <kbd>Enter</kbd>.</p></div><div class=paragraph><p>De instructies om het menusysteem te gebruiken worden getoond. Na het lezen kan met <kbd>Enter</kbd> het hoofdmenu weer getoond worden.</p></div><div id=sysinstall-main3 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/main1.png alt=main1></div><div class=title>Figuur 4. Usage selecteren in het sysinstall hoofdmenu</div></div><div class=sect3><h4 id=select-doc>2.5.1. Menu Documentation selecteren<a class=anchor href=#select-doc></a></h4><div class=paragraph><p>Kies met de pijltjestoetsen in het hoofdmenu <span class=guimenuitem>Doc</span> en druk op <kbd>Enter</kbd>.</p></div><div id=main-doc class=imageblock><div class=content><img src=../../../../images/books/handbook/install/main-doc.png alt="main doc"></div><div class=title>Figuur 5. Menu Documentation selecteren</div></div><div class=paragraph><p>Dit toont het menu Documentation.</p></div><div id=docmenu1 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/docmenu1.png alt=docmenu1></div><div class=title>Figuur 6. Sysinstall menu Documentation</div></div><div class=paragraph><p>Het is belangrijk om de documentatie te lezen.</p></div><div class=paragraph><p>Selecteer een document met de pijltjestoetsen en druk op <kbd>Enter</kbd> om het te bekijken. Na het lezen wordt met <kbd>Enter</kbd> teruggekeerd naar het menu Documentation.</p></div><div class=paragraph><p>Selecteer <span class=guimenuitem>Exit</span> met de pijltjestoetsen en druk op <kbd>Enter</kbd> om het menu Documentation te verlaten.</p></div></div><div class=sect3><h4 id=keymap>2.5.2. Menu Keymap selecteren<a class=anchor href=#keymap></a></h4><div class=paragraph><p>Kies met de pijltjestoetsen <span class=guimenuitem>Keymap</span> in het menu en druk op <kbd>Enter</kbd> om de toetsenbordinstellingen te wijzigen. Dit is alleen nodig als geen standaard of VS-toetsenbord wordt gebruikt.</p></div><div id=sysinstall-keymap class=imageblock><div class=content><img src=../../../../images/books/handbook/install/main-keymap.png alt="main keymap"></div><div class=title>Figuur 7. Sysinstall hoofdmenu</div></div><div class=paragraph><p>Een andere toetsenbordindeling is te kiezen door het menu-item te selecteren met omhoog/omlaag en dan op <kbd>Space</kbd> te drukken. Nog een keer <kbd>Space</kbd> deselecteert het item. Nadat de keuze is gemaakt kan met de pijltjestoetsen <b class=button>OK</b> gekozen worden en op <kbd>Enter</kbd> gedrukt worden.</p></div><div class=paragraph><p>In de schermafbeelding wordt maar een deel van de lijst getoond. Selecteer <b class=button>Cancel</b> door op <kbd>Tab</kbd> te drukken. Dan wordt de standaard toetsenbordindeling gebruikt en het programma gaat terug naar het hoofdmenu voor de installatie.</p></div><div id=sysinstall-keymap-menu class=imageblock><div class=content><img src=../../../../images/books/handbook/install/keymap.png alt=keymap></div><div class=title>Figuur 8. Sysinstall menu Keymap</div></div></div><div class=sect3><h4 id=viewsetoptions>2.5.3. Installatiescherm Options<a class=anchor href=#viewsetoptions></a></h4><div class=paragraph><p>Kies <span class=guimenuitem>Options</span> en druk op <kbd>Enter</kbd>.</p></div><div id=sysinstall-options class=imageblock><div class=content><img src=../../../../images/books/handbook/install/main-options.png alt="main options"></div><div class=title>Figuur 9. Sysinstall hoofdmenu</div></div><div id=options class=imageblock><div class=content><img src=../../../../images/books/handbook/install/options.png alt=options></div><div class=title>Figuur 10. Sysinstall opties</div></div><div class=paragraph><p>De standaardwaarden zijn in orde voor de meeste gebruikers en hoeven meestal niet gewijzigd te worden. De <code>release name</code> hangt af van de versie die geïnstalleerd wordt.</p></div><div class=paragraph><p>Er staat een beschrijving van het geselecteerde item aan de onderkant van het scherm, geaccentueerd in blauw. Eén van de opties is <span class=guimenuitem>Use Defaults</span> waarmee opnieuw de beginwaarden worden ingesteld.</p></div><div class=paragraph><p>Druk op <kbd>F1</kbd> om de helptekst van de diverse opties te bekijken.</p></div><div class=paragraph><p>Druk op <kbd>Q</kbd> om terug te gaan naar het hoofdmenu van de installatie.</p></div></div><div class=sect3><h4 id=start-install>2.5.4. Een standaardinstallatie starten<a class=anchor href=#start-install></a></h4><div class=paragraph><p>De <span class=guimenuitem>Standard</span> installatie wordt aangeraden voor nieuwe gebruikers van UNIX® of FreeBSD. Gebruik de pijltjestoetsen om <span class=guimenuitem>Standard</span> te selecteren en druk op <kbd>Enter</kbd> om de installatie te starten.</p></div><div id=sysinstall-standard class=imageblock><div class=content><img src=../../../../images/books/handbook/install/main-std.png alt="main std"></div><div class=title>Figuur 11. Een standaardinstallatie starten</div></div></div></div><div class=sect2><h3 id=install-steps>2.6. Schijfruimte toewijzen<a class=anchor href=#install-steps></a></h3><div class=paragraph><p>Als eerste moet schijfruimte aan FreeBSD worden toegewezen en die ruimte dient gemerkt te worden zodat sysinstall deze kan voorbereiden.Om dit te kunnen doen is kennis nodig over hoe FreeBSD informatie op schijven verwacht aan te treffen.</p></div><div class=sect3><h4 id=install-drive-bios-numbering>2.6.1. BIOS schijfnummering<a class=anchor href=#install-drive-bios-numbering></a></h4><div class=paragraph><p>Voordat FreeBSD op een systeem geïnstalleerd en ingesteld kan worden is er een belangrijk onderwerp waarover kennis nodig is, met name als er meerdere harde schijven zijn.</p></div><div class=paragraph><p>Op een PC met een BIOS-afhankelijk besturingssysteem zoals MS-DOS® en Microsoft® Windows®, kan het BIOS de normale schijfvolgorde abstraheren en volgt het besturingssysteem die wijzigingen. Dit stelt de gebruiker in staat op te starten van een andere schijf dan de zogenaamde "primary master". Dit is erg handig voor gebruikers die er achter zijn gekomen dat de gemakkelijkste en goedkoopste manier om een systeemback-up te maken het plaatsen van een identieke tweede harde schijf is en het daarop regelmatig kopieëren van de inhoud van de eerste schijf met Ghost of XCOPY. Als de eerste schijf weigert of aangevallen is door een virus of vervuild is door een fout in het besturingssysteem, dan kan eenvoudig overgeschakeld worden door in het BIOS de twee schijven logisch te wisselen. Dat is als het verwisselen van de kabels, maar dan zonder de systeemkast open te maken.</p></div><div class=paragraph><p>Duurdere systemen met SCSI controllers hebben vaak BIOS-uitbreidingen die het mogelijk maken SCSI-schijven op soortgelijke wijze in te delen voor maximaal zeven schijven.</p></div><div class=paragraph><p>Een gebruiker die gewend is hiervan gebruik te maken kan verrast worden als de resultaten met FreeBSD niet overeenkomen met de verwachtingen. FreeBSD maakt geen gebruik van het BIOS en heeft dus geen kennis van "logical BIOS drive mapping". Dit kan leiden tot verbazingwekkende situaties, met name als de schijven fysiek gelijk zijn in geometrie en ook de data klonen van elkaar zijn.</p></div><div class=paragraph><p>Bij het gebruik van FreeBSD moet altijd de natuurlijke schijfnummering hersteld worden voordat een installatie wordt gestart en die moet ook zo blijven. Als de schijven gewisseld moeten worden, dan moet dat op de moeilijke manier: maak de systeemkast open en verplaats jumpers en kabels.</p></div><div class=sidebarblock><div class=content><div class=paragraph><p>Willem sloopt een oude Wintel machine om er nog een FreeBSD machine voor Fred van te maken. Willem installeert een enkele SCSI-schijf met SCSI ID 0 en installeert er FreeBSD op.</p></div><div class=paragraph><p>Fred begint met systeem te werken, maar na een paar dagen komt hij er achter dat de oude SCSI-schijf veel fouten geeft en hij geeft het door aan Willem.</p></div><div class=paragraph><p>Na weer een paar dagen besluit Willem dat het tijd is om er iets aan te doen, dus hij pakt een identieke SCSI-schijf uit het "archief" met schijven in een achterkamertje. Een oppervlaktecontrole toont aan dat deze schijf goed functioneert, dus Willem installeert deze schijf als SCSI ID 4 en maakt een image kopie van schijf 0 naar schijf 4. Nu de nieuwe schijf is geïnstalleerd en het prima doet, besluit Willem dat het een goed idee is om hem in bedrijf te nemen, dus gebruikt hij de mogelijkheid van het BIOS om de schijven te hernummeren, om er voor te zorgen dat het systeem opstart van schijf 4. FreeBSD start op en werkt goed.</p></div><div class=paragraph><p>Fred werkt nog een paar dagen door en vlot besluiten Willem en Fred dat het tijd is voor een nieuw avontuur: tijd op om te waarderen naar een nieuwere versie van FreeBSD. Willem haalt SCSI unit 0 eruit, want die was een beetje instabiel en vervangt hem door een andere schijf uit het "archief". Willem installeert vervolgens de nieuwe versie van FreeBSD op de nieuwe SCSI ID 0 met Fred’s magische Internet FTP diskettes. De installatie gaat goed.</p></div><div class=paragraph><p>Fred gebruikt de nieuwe versie van FreeBSD een paar dagen en bevestigt dat die goed genoeg is om gebruikt te worden op de programmeerafdeling. Het is tijd om al zijn werk vanaf de oude versie te kopiëren. Dus Fred mount SCSI ID 4 (de laatste kopie van de oudere FreeBSD versie). Fred baalt behoorlijk als hij ontdekt dat niets van zijn kostbare werk aanwezig is op SCSI ID 4.</p></div><div class=paragraph><p>Waar zijn de gegevens gebleven?</p></div><div class=paragraph><p>Toen Willem een zuivere kopie van de originele SCSI ID 0 maakte op SCSI ID 4, werd SCSI ID 4 de "nieuwe kloon". Toen Willem het SCSI BIOS zo instelde dat hij kon opstarten van SCSI ID 4 hield hij zichzelf gewoonweg voor de gek. FreeBSD draaide nog steeds op SCSI ID 0. Dit soort wijzigingen in het BIOS zorgen ervoor dat sommige of alle opstart- en laadprogramma’s van de geselecteerde BIOS schijf komen, maar als de FreeBSD kernelstuurprogramma’s het overnemen, wordt de BIOS nummering genegeerd en valt FreeBSD terug op de normale schijfnummering. In dit voorbeeld werkte het systeem nog steeds op de originele SCSI ID 0 en Fred’s gegevens stonden daarop en niet op SCSI ID 4. Het feit dat het systeem leek te draaien vanaf SCSI ID 4 was eenvoudig een luchtkasteel als gevolg van menselijke verwachtingspatronen.</p></div><div class=paragraph><p>Verheugd kunnen we mededelen dat er geen enkele byte weggegooid is bij de ontdekking van dit verschijnsel. De oude SCSI-schijf ID 0 werd teruggehaald van de stapel en al Fred’s werk is aan hem teruggegeven (en Willem weet nu dat hij al tot 0 kan tellen).</p></div><div class=paragraph><p>Hoewel in dit voorbeeld SCSI-schijven zijn gebruikt, geldt hetzelfde voor IDE-schijven.</p></div></div></div></div><div class=sect3><h4 id=main-fdisk>2.6.2. Slices maken met FDisk<a class=anchor href=#main-fdisk></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Wijzigingen die op dit punt gemaakt worden, worden niet weggeschreven naar de schijf. Als er een fout gemaakt is kan opnieuw begonnen worden door via de menu’s sysinstall te verlaten en het nog een keer te proberen of door <kbd>U</kbd> te toetsen kan de optie <span class=guimenuitem>Undo</span> gebruikt worden. Als alles te verwarrend is kan zelfs de computer uitgezet worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Na de keuze een standaardinstallatie te beginnen toont sysinstall het volgende bericht:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                                 Message
 In the next menu, you will need to <span class=nb>set </span>up a DOS-style <span class=o>(</span><span class=s2>&#34;fdisk&#34;</span><span class=o>)</span>
 partitioning scheme <span class=k>for </span>your hard disk. If you simply wish to devote
 all disk space to FreeBSD <span class=o>(</span>overwriting anything <span class=k>else </span>that might be on
 the disk<span class=o>(</span>s<span class=o>)</span> selected<span class=o>)</span> <span class=k>then </span>use the <span class=o>(</span>A<span class=o>)</span>ll <span class=nb>command </span>to <span class=k>select </span>the default
 partitioning scheme followed by a <span class=o>(</span>Q<span class=o>)</span>uit. If you wish to allocate only
 free space to FreeBSD, move to a partition marked <span class=s2>&#34;unused&#34;</span> and use the
 <span class=o>(</span>C<span class=o>)</span>reate command.
                                <span class=o>[</span>  OK  <span class=o>]</span>

                      <span class=o>[</span> Press enter or space <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Toets <kbd>Enter</kbd>. Er wordt dan een lijst getoond met alle harde schijven die de kernel gevonden heeft bij het onderzoeken van de hardware. <a href=#sysinstall-fdisk-drive1>Schijf kiezen voor FDisk</a> toont een voorbeeld van een systeem met twee IDE-schijven. Ze heten <span class=filename>ad0</span> en <span class=filename>ad2</span>.</p></div><div id=sysinstall-fdisk-drive1 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/fdisk-drive1.png alt="fdisk drive1"></div><div class=title>Figuur 12. Schijf kiezen voor FDisk</div></div><div class=paragraph><p>Waarom staat <span class=filename>ad1</span> niet in de lijst?</p></div><div class=paragraph><p>Stel er zitten twee IDE-schijven in een systeem, de eerste als master op de eerste IDE controller en de andere als master op de tweede IDE controller. Als FreeBSD deze zou nummeren zoals ze worden aangetroffen, als <span class=filename>ad0</span> en <span class=filename>ad1</span>, dan zou het allemaal werken.</p></div><div class=paragraph><p>Maar als dan een derde schijf wordt toegevoegd, als slave op de eerste IDE controller, dan wordt die <span class=filename>ad1</span> en de vorige <span class=filename>ad1</span> wordt dan <span class=filename>ad2</span>. Omdat apparaatnamen (zoals <span class=filename>ad1s1a</span>) in gebruik zijn om bestandssystemen te vinden, lijken bestandssystemen niet meer in orde zijn en moeten de FreeBSD instellingen gewijzigd worden.</p></div><div class=paragraph><p>Om dit te omzeilen kan de kernel zo ingesteld worden dat de IDE schijven namen krijgen gebaseerd op hun lokatie en niet in de volgorde waarin ze gevonden worden. Met dat schema wordt de masterschijf op de tweede IDE controller <em>altijd</em><span class=filename>ad2</span>, ook als er geen <span class=filename>ad0</span> of <span class=filename>ad1</span> apparaten zijn.</p></div><div class=paragraph><p>Dit is de standaardinstelling van de FreeBSD kernel, vandaar dat dit scherm <span class=filename>ad0</span> en <span class=filename>ad2</span> laat zien. De machine waarop deze schermafdruk gemaakt is had IDE schijven op beide masterkanalen van de IDE controllers en geen schijven op de slavekanalen.</p></div><div class=paragraph><p>Nu kan de schijf waarop de FreeBSD installatie moet komen worden geselecteerd. Druk daarna op <b class=button>OK</b>. FDisk start op met een scherm vergelijkbaar met <a href=#sysinstall-fdisk1>Typische <code>fdisk</code>-partities vóór het wijzigen</a>.</p></div><div class=paragraph><p>Het scherm van FDisk bestaat uit drie delen.</p></div><div class=paragraph><p>Het eerste deel, de eerste twee regels van het scherm, toont de details zien van de selecteerde schijf, inclusief de FreeBSD naam, de schijfgeometrie en de totale grootte van de schijf.</p></div><div class=paragraph><p>Het tweede deel laat de slices zien die momenteel op de schijf aanwezig zijn, waar ze beginnen en eindigen, hoe groot ze zijn en de namen die FreeBSD ze geeft, hun omschrijving en subtype. In dit voorbeeld zijn twee kleine ongebruikte delen te zien, die een afspiegeling zijn van de schijfindeling op het systeem. Het laat ook een grote FAT-slice zien, die bijna zeker zichtbaar is als <span class=filename>C:</span> in MS-DOS® of Windows®, en een extended deel, dat de andere schijfletters kan bevatten voor MS-DOS® of Windows®.</p></div><div class=paragraph><p>Het derde deel toont de commando’s zien die beschikbaar zijn in FDisk.</p></div><div id=sysinstall-fdisk1 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/fdisk-edit1.png alt="fdisk edit1"></div><div class=title>Figuur 13. Typische <code>fdisk</code>-partities vóór het wijzigen</div></div><div class=paragraph><p>De volgende stap hangt af van hoe de schijf moet worden opgedeeld.</p></div><div class=paragraph><p>Als de hele schijf voor FreeBSD wordt gebruikt (waardoor alle andere data op die schijf verwijderd wordt als later in de procedure met sysinstall wordt bevestigd dat de installatie verder kan gaan) toets dan <kbd>A</kbd>, de optie <span class=guimenuitem>Use Entire Disk</span>. De bestaande delen worden verwijderd en daarvoor in de plaats komt een klein gebied, dat als <code>unused</code> wordt aangegeven (alweer een afspiegeling van de PC schijfopmaak) en dan een groot deel voor FreeBSD. Hierna dient het nieuwe FreeBSD-deel met de pijltjestoetsen geselecteerd te worden en daarna kan <kbd>S</kbd> ingetoetst worden om het deel <code>bootable</code> te maken. Het scherm ziet er dan ongeveer uit als in <a href=#sysinstall-fdisk2>FDisk partitie voor een hele schijf</a>. Let op de <code>A</code> in de kolom <code>Flags</code>. Deze geeft aan dat dit deel <em>actief</em> is en er van opgestart wordt.</p></div><div class=paragraph><p>Als er ruimte voor FreeBSD gemaakt wordt door een bestaande slice te verwijderen, dan moet dat deel geselecteerd worden met de pijltjestoetsen en kan vervolgens op <kbd>D</kbd> gedrukt worden. Daarna kan <kbd>C</kbd> getoetst worden en wordt er gevraagd hoe groot het deel moet zijn. Geef het gewenste getal in en druk op <kbd>Enter</kbd>. De standaardwaarde in dit invoervak is het grootst mogelijke deel dat gemaakt kan worden. Dat kan de grootst mogelijke aaneengesloten ruimte op de harde schijf zijn of de hele schijf.</p></div><div class=paragraph><p>Als er al ruimte gemaakt is voor FreeBSD (bijvoorbeeld met een programma als PartitionMagic®), dan kan de optie <kbd>C</kbd> gebruikt worden om een nieuw deel te maken. Opnieuw komt de vraag naar de grootte van het gebied dat aangemaakt moet worden.</p></div><div id=sysinstall-fdisk2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/fdisk-edit2.png alt="fdisk edit2"></div><div class=title>Figuur 14. FDisk partitie voor een hele schijf</div></div><div class=paragraph><p>Toets na afronding <kbd>Q</kbd>. De wijzigingen worden bewaard in sysinstall, maar worden nog niet op de schijf weggeschreven.</p></div></div><div class=sect3><h4 id=bootmgr>2.6.3. Bootmanager installeren<a class=anchor href=#bootmgr></a></h4><div class=paragraph><p>Hierna is het mogelijk een bootmanager te installeren. Het installeren van de FreeBSD bootmanager is verstandig als:</p></div><div class=ulist><ul><li><p>Er meer dan één schijf in een systeem zit en FreeBSD op een andere dan de eerste schijf wordt geïnstalleerd;</p></li><li><p>FreeBSD geïnstalleerd wordt naast een ander besturingssysteem op dezelfde schijf en er bij het opstarten van de computer gekozen moet worden of FreeBSD of het andere besturingssysteem wordt gestart.</p></li></ul></div><div class=paragraph><p>Als FreeBSD het enige besturingssysteem op een computer wordt en het is geïnstalleerd op de eerste harde schijf, dan volstaat de <span class=guimenuitem>Standard</span> bootmanager. Kies <span class=guimenuitem>None</span> als een bootmanager van een derde partij wordt gebruikt die in staat is om FreeBSD te starten.</p></div><div class=paragraph><p>Maak de keuze en druk op <kbd>Enter</kbd>.</p></div><div id=sysinstall-bootmgr class=imageblock><div class=content><img src=../../../../images/books/handbook/install/boot-mgr.png alt="boot mgr"></div><div class=title>Figuur 15. Sysinstall menu Boot Manager</div></div><div class=paragraph><p>Het hulpscherm, bereikbaar via <kbd>F1</kbd>, beschrijft de problemen die mogelijk zijn als de harde schijf voor meerdere besturingssystemen gebruikt gaat worden.</p></div></div><div class=sect3><h4 id=_slices_maken_op_een_andere_schijf>2.6.4. Slices maken op een andere schijf<a class=anchor href=#_slices_maken_op_een_andere_schijf></a></h4><div class=paragraph><p>Als er meer dan één schijf is komt het programma terug in het scherm "Select Drives" na het installeren van de bootmanager. Als FreeBSD wordt geïnstalleerd op meerdere schijven, selecteer dan een andere schijf en herhaal het indelen van de schijf met FDisk.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Als FreeBSD wordt geïnstalleerd op een andere dan de eerste schijf, dan moet de FreeBSD bootmanager geïnstalleerd worden op beide schijven.</p></div></td></tr></tbody></table></div><div id=sysinstall-fdisk-drive2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/fdisk-drive2.png alt="fdisk drive2"></div><div class=title>Figuur 16. Schijf selecteren verlaten</div></div><div class=paragraph><p>Met <kbd>Tab</kbd> wordt gewisseld tussen de laatst geselecteerde schijf, <b class=button>OK</b> en <b class=button>Cancel</b>.</p></div><div class=paragraph><p>Druk één keer op <kbd>Tab</kbd> om <b class=button>OK</b> actief te maken en druk dan op <kbd>Enter</kbd> om door te gaan met de installatie.</p></div></div><div class=sect3><h4 id=bsdlabeleditor>2.6.5. Partities maken met Disklabel<a class=anchor href=#bsdlabeleditor></a></h4><div class=paragraph><p>Nu moeten er slices in elke zojuist aangemaakte partitie aangemaakt worden. Onthoud dat elke partitie een letter heeft van <code>a</code> tot en met <code>h</code> en dat partities <code>b</code>, <code>c</code> en <code>d</code> een betekenis hebben die gehonoreerd moet worden.</p></div><div class=paragraph><p>Bepaalde programma’s hebben voordeel van specifieke partitieschema’s, met name als partities worden aanmaakt over meerdere schijven. Maar voor nu, als eerste FreeBSD installatie, is het niet zo van belang hoe de schijf wordt gepartitioneerd. Het is belangrijker dat FreeBSD wordt geïnstalleert en geleerd wordt hoe ermee te werken. FreeBSD kan altijd opnieuw geïnstalleerd worden om een partitieschema te wijzigen als er meer bekendheid is met het besturingssysteem.</p></div><div class=paragraph><p>Het onderstaande schema heeft vier partities. Eén als swapgebied en drie voor bestandssystemen.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 2. Partitieopmaak voor de eerste schijf</caption><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Partitie</th><th class="tableblock halign-left valign-top">Bestandssysteem</th><th class="tableblock halign-left valign-top">Grootte</th><th class="tableblock halign-left valign-top">Omschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>a</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1 GB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Dit is het root-bestandssysteem. Elk ander bestandssyteem wordt ergens in dit systeem aangekoppeld. 1 GB is een redelijke grootte voor dit bestandssysteem. Er wordt niet al te veel data in opgeslagen, want een normale FreeBSD installatie slaat hier ongeveer 128 MB aan gegevens op. De rest van de ruimte is voor tijdelijke gegevens en laat extra ruimte over voor het geval nieuwere versies van FreeBSD meer ruimte nodig hebben in <span class=filename>/</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>b</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2-3 x RAM</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De swapruimte van een systeem wordt op de <code>b</code>-partitie opgeslagen. De keuze van de juiste hoeveelheid swapruimte is een beetje een kunst. Een goede vuistregel is dat swapruimte twee of drie keer de hoeveelheid intern geheugen (RAM) moet zijn. Er moet minstens 64 MB aan swap zijn, dus als er minder dan 32 MB RAM in een computer zit, zet dan de swapruimte op 64 MB.</p><p class=tableblock>Als er meer dan één schijf in een computer zit, dan kan er op iedere schijf swapruimte gemaakt worden. FreeBSD gebruikt dan elke schijf als swap, wat effectief de snelheid van het swappen verhoogt. Bereken in dat geval de totale hoeveelheid swap die nodig is (bijvoorbeeld 128 MB) en deel dat door het aantal schijven dat aanwezig is (bijvoorbeeld twee schijven) om de hoeveelheid swap per schijf te bepalen, in dit voorbeeld 64 MB swapruimte per schijf.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>e</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>512 MB tot 4096 MB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De map <span class=filename>/var</span> bevat bestanden die constant veranderen: logboekbestanden en andere administratieve bestanden. Veel van deze bestanden worden intensief gelezen of beschreven gedurende het dagelijks draaien van FreeBSD. Door deze bestanden op een apart bestandssysteem te zetten heeft FreeBSD de mogelijkheid de toegang tot deze bestanden te optimaliseren, zonder invloed te hebben op bestanden in andere map die niet zo’n toegangspatroon hebben.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>f</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Overige schijfruimte (minstens 8 GB)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle andere bestanden worden gewoonlijk opgeslagen in <span class=filename>/usr</span> en submappen.</p></td></tr></tbody></table><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>De bovenstaande waardes dienen als voorbeeld en dienen alleen door ervaren gebruikers gebruikt te worden. Gebruikers worden aangeraden om de automatische partitie-indeling genaamd <code>Auto Defaults</code>van de partitiebewerker van FreeBSD te gebruiken.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als FreeBSD wordt geïnstalleerd op meer dan één schijf dan moeten ook partities aangemaakt worden op de andere slices die zijn ingesteld. De meest eenvoudige manier om dat te doen is het aanmaken van twee partities op elke schijf: een als swap en een voor een bestandssysteem.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 3. Partitieopmaak voor volgende schijven</caption><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Partitie</th><th class="tableblock halign-left valign-top">Bestandssysteem</th><th class="tableblock halign-left valign-top">Grootte</th><th class="tableblock halign-left valign-top">Omschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>b</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>N/A</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Zie omschrijving</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Zoals beschreven kan swapruimte over alle schijven verdeeld worden. Ook al is de <code>a</code> partitie vrij, de conventie schrijft voor dat de swapruimte op partitie <code>b</code> staat.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>e</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/disk<em>n</em></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Overige schijfruimte</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De overige schijfruimte wordt gebruikt voor één grote partitie. Dit kan gemakkelijk op de <code>a</code>-partitie, in plaats van de <code>e</code>-partitie. De conventie schrijft echter voor dat partitie <code>a</code> op een slice is gereserveerd voor het bestandssysteem dat de root (<span class=filename>/</span>) van het bestandssysteem is. Deze conventie hoeft niet gevolgd te worden, maar sysinstall doet dat wel, dus als de conventie wordt nageleefd wordt de installatie iets schoner. Er kan gekozen worden om dit bestandssysteem waar dan ook te mounten. Dit voorbeeld suggereert dat het wordt aangekoppeld als <span class=filename>/diskn</span>, waarbij <em>n</em> een getal is dat verandert voor elke schijf. Er kan natuurlijk ook een ander schema worden aanhouden als dat de voorkeur heeft.</p></td></tr></tbody></table><div class=paragraph><p>Na het kiezen van de partitieopmaak kunnen ze worden aangemaakt met sysinstall. Dan verschijnt het volgende bericht:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                                 Message
 Now, you need to create BSD partitions inside of the fdisk
 partition<span class=o>(</span>s<span class=o>)</span> just created. If you have a reasonable amount of disk
 space <span class=o>(</span>1GB or more<span class=o>)</span> and don<span class=s1>&#39;t have any special requirements, simply
 use the (A)uto command to allocate space automatically. If you have
 more specific needs or just don&#39;</span>t care <span class=k>for </span>the layout chosen by
 <span class=o>(</span>A<span class=o>)</span>uto, press F1 <span class=k>for </span>more information on manual layout.

                                <span class=o>[</span>  OK  <span class=o>]</span>
                          <span class=o>[</span> Press enter or space <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Druk op <kbd>Enter</kbd> om de FreeBSD partitie-editor, Disklabel te starten.</p></div><div class=paragraph><p><a href=#sysinstall-label>Sysinstall Disklabel Editor</a> toont het scherm als Disklabel opstart. Het scherm bestaat uit drie delen.</p></div><div class=paragraph><p>De eerste paar regels tonen de naam van de actieve schijf en het gebied dat de partities bevat die worden aangemaakt (op dit punt noemt Disklabel dit de <code>Partitienaam</code> in plaats van de slicenaam). Dit scherm toont ook de hoeveelheid vrije ruimte in de slice. Dat is de gereserveerde ruimte in de slice die nog niet aan een partitie is toegewezen.</p></div><div class=paragraph><p>Het middelste deel toont de partities die aangemaakt zijn, de naam van het bestandssysteem dat elke partitie bevat, de grootte en enkele opties betreffende het aanmaken van het bestandssysteem.</p></div><div class=paragraph><p>Het onderste deel van het scherm toont de toetsaanslagen die geldig zijn in Disklabel.</p></div><div id=sysinstall-label class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-ed1.png alt="disklabel ed1"></div><div class=title>Figuur 17. Sysinstall Disklabel Editor</div></div><div class=paragraph><p>Disklabel kan automatisch de partities aanmaken en ze de standaardgrootte geven. De standaardgroottes worden met behulp van een intern algoritme om de partitiegrootte te bepalen gebaseerd op de schijfgrootte berekend. Dit kan door op <kbd>A</kbd> te drukken. Dan verschijnt een scherm zoals in <a href=#sysinstall-label2>Sysinstall Disklabel Editor met standaardwaarden</a>. Afhankelijk van de grootte van de schrijf die wordt gebruikt zijn de standaardwaarden wel of niet van toepassing. Dit maakt niets uit, omdat de standaardwaarden niet geaccepteerd hoeven te worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De standaard partitionering wijst <span class=filename>/tmp</span> zijn eigen partitie toe en is die geen onderdeel meer van de partitie <span class=filename>/</span>. Dit voorkomt het vollopen van de partitie <span class=filename>/</span> met tijdelijke bestanden.</p></div></td></tr></tbody></table></div><div id=sysinstall-label2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-auto.png alt="disklabel auto"></div><div class=title>Figuur 18. Sysinstall Disklabel Editor met standaardwaarden</div></div><div class=paragraph><p>Als er gekozen is om niet de standaard partities te gebruiken en ze te vervangen door een eigen indeling, gebruik dan de pijltjestoetsen om de eerste partitie te selecteren en druk dan op <kbd>D</kbd> om deze te verwijderen. Herhaal dit om alle aanbevolen partities te verwijderen.</p></div><div class=paragraph><p>Selecteer het juiste schijfdeel aan de bovenkant van het scherm om de eerste partitie aan te maken (<code>a</code>, gemount als <span class=filename>/</span> - root) en druk op <kbd>C</kbd>. Een dialoogscherm verschijnt met de vraag hoe groot de nieuwe partitie moet zijn (zoals te zien in <a href=#sysinstall-label-add>Vrije ruimte voor de rootpartitie</a>). De grootte kan opgeven worden in schijfblokken of als een getal gevolgd door <code>M</code> voor megabytes, <code>G</code> voor gigabytes of <code>C</code> voor cylinders.</p></div><div id=sysinstall-label-add class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-root1.png alt="disklabel root1"></div><div class=title>Figuur 19. Vrije ruimte voor de rootpartitie</div></div><div class=paragraph><p>De standaardgrootte maakt een partitie aan zo groot als de rest van het schijfdeel. Als de partitiegroottes worden gebruikt als beschreven in het eerdere voorbeeld, verwijder dan het reeds ingevulde getal met <kbd>Backspace</kbd> en type <code>512M</code>, zoals te zien in <a href=#sysinstall-label-add2>Grootte van de rootpartitie wijzigen</a>. Druk dan op <b class=button>OK</b>.</p></div><div id=sysinstall-label-add2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-root2.png alt="disklabel root2"></div><div class=title>Figuur 20. Grootte van de rootpartitie wijzigen</div></div><div class=paragraph><p>Als de grootte van een partitie gekozen is, wordt gevraagd of deze partitie een bestandssysteem of een wisselbestand (<code>swap</code>) bevat. Deze dialoog is te zien in <a href=#sysinstall-label-type>Type van de rootpartitie kiezen</a>. Deze eerste partitie bevat een bestandssysteem, dus controleer of <span class=guimenuitem>FS</span> geselecteerd is en druk op <kbd>Enter</kbd>.</p></div><div id=sysinstall-label-type class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-fs.png alt="disklabel fs"></div><div class=title>Figuur 21. Type van de rootpartitie kiezen</div></div><div class=paragraph><p>Omdat een bestandssysteem wordt aangemaakt moet disklabel verteld worden waar het bestandssysteem gemount moet worden. Het dialoogscherm is te zien in <a href=#sysinstall-label-mount>Root mountpunt kiezen</a>. Het mountpunt van het root-bestandssysteem is <span class=filename>/</span>, dus type <code>/</code> en druk dan op <kbd>Enter</kbd>.</p></div><div id=sysinstall-label-mount class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-root3.png alt="disklabel root3"></div><div class=title>Figuur 22. Root mountpunt kiezen</div></div><div class=paragraph><p>Het scherm wordt dan bijgewerkt met de nieuw aangemaakte partitie. Deze stappen moeten herhaald worden voor de andere partities. Als een wisselbestandpartitie wordt aanmaakt, wordt niet gevraagd naar het mountpunt, want wisselbestanden worden nooit gemount. Als de laatste partitie is aanmaakt, <span class=filename>/usr</span>, kan de aangegeven grootte blijven staan, want dat is de rest van de schijf.</p></div><div class=paragraph><p>Het uiteindelijke FreeBSD Disklabel Editor scherm kan eruit zien als <a href=#sysinstall-label4>Sysinstall Disklabel Editor</a>, maar de waarden kunnen afwijken. Druk op <kbd>Q</kbd> om af te sluiten.</p></div><div id=sysinstall-label4 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-ed2.png alt="disklabel ed2"></div><div class=title>Figuur 23. Sysinstall Disklabel Editor</div></div></div></div><div class=sect2><h3 id=install-choosing>2.7. Wat installeren<a class=anchor href=#install-choosing></a></h3><div class=sect3><h4 id=distset>2.7.1. Distributieset selecteren<a class=anchor href=#distset></a></h4><div class=paragraph><p>De keuze van de distributieset om te installeren hangt af van het gebruiksdoel van een systeem en de beschikbare schijfruimte. De voorgedefiniëerde opties variëren van het installeren van kleinste mogelijke installatie tot "alles". Nieuwelingen in UNIX® en/of FreeBSD kiezen bijna zeker één van voorgedefinieerde opties. Het aanpassen van de distributieset is typisch iets voor de meer ervaren gebruikers.</p></div><div class=paragraph><p>Druk op <kbd>F1</kbd> voor meer informatie over de distributiesets en wat ze bevatten. Na het bekijken van de informatie geeft het toetsen van <kbd>Enter</kbd> opnieuw het menu Select Distributions weer.</p></div><div class=paragraph><p>Als een grafische gebruikersinterface gewenst is, dan dient de configuratie van de X-server en het kiezen van een standaard bureaublad na de installatie van FreeBSD te worden uitgevoerd. Meer informatie over het installeren en instellen van een X-server staat beschreven in <a href=./#x11>Het X Window systeem</a>.</p></div><div class=paragraph><p>Xorg is de standaardversie van X11 die wordt geïnstalleerd.</p></div><div class=paragraph><p>Als het wenselijk is een aangepaste kernel te compileren, kies dan een optie die de broncode bevat. Meer informatie over de redenen om een aangepaste kernel te bouwen en hoe dat moet staat in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div><div class=paragraph><p>Vanzelfsprekend is het meest uitgebreide systeem het systeem dat alles omvat. Als er genoeg schijfruimte is, kies dan met de pijltjestoetsen <span class=guimenuitem>All</span>, zoals in <a href=#distribution-set1>Distributies kiezen</a> en druk op <kbd>Enter</kbd>. Als schijfruimte een zorg is, overweeg dan een optie die meer toegespitst is op de gewenste situatie. De perfecte keuze maken is niet nodig, naderhand kunnen distributies worden toevoegd.</p></div><div id=distribution-set1 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/dist-set.png alt="dist set"></div><div class=title>Figuur 24. Distributies kiezen</div></div></div><div class=sect3><h4 id=portscol>2.7.2. Portscollectie installeren<a class=anchor href=#portscol></a></h4><div class=paragraph><p>Na het kiezen van de gewenste distributie komt de vraag of de FreeBSD Portscollectie geïnstalleerd moet worden. De Portscollectie is een gemakkelijke en handige manier om software te installeren. De Portscollectie bevat niet de broncode die nodig is om de software te compileren. In plaats daarvan is het een verzameling bestanden die het downloaden, compileren en installeren van software automatiseert. In <a href=./#ports>Applicaties installeren. pakketten en ports</a> wordt beschreven hoe de Portscollectie gebruikt kan worden.</p></div><div class=paragraph><p>Het installatieprogramma controleert niet of er genoeg schijfruimte is. Deze optie dient alleen gekozen te worden als er voldoende schijfruimte is. In FreeBSD 12.0 neemt de Portscollectie ongeveer 3 GB schijfruimte in. Het is verstandig om aan te nemen dat in recentere versies van FreeBSD meer ruimte nodig is.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                         User Confirmation Requested
 Would you like to <span class=nb>install </span>the FreeBSD ports collection?

 This will give you ready access to over 24,000 ported software packages,
 at a cost of around 500 MB of disk space when <span class=s2>&#34;clean&#34;</span> and possibly much
 more than that <span class=k>if </span>a lot of the distribution tarballs are loaded
 <span class=o>(</span>unless you have the extra CDs from a FreeBSD CD/DVD distribution
 available and can mount it on /cdrom, <span class=k>in </span>which <span class=k>case</span> this is far less
 of a problem<span class=p>)</span><span class=nb>.</span>

 The ports collection is a very valuable resource and well worth having
 on your /usr partition, so it is advisable to say Yes to this option.

 For more information on the ports collection &amp; the latest ports,
 visit:
     http://www.FreeBSD.org/ports

                              <span class=o>[</span> Yes <span class=o>]</span>     No</code></pre></div></div><div class=paragraph><p>Selecteer <b class=button>yes</b> met de pijltjestoetsen om de Portscollectie te installeren of <b class=button>no</b> om deze optie over te slaan. Druk op <kbd>Enter</kbd> om verder te gaan. Het menu Choose Distributions wordt opnieuw getoond.</p></div><div id=distribution-set2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/dist-set2.png alt="dist set2"></div><div class=title>Figuur 25. Distributies kiezen</div></div><div class=paragraph><p>Als alle keuzes gemaakt zijn, selecteer dan <span class=guimenuitem>Exit</span> met de pijltjestoetsen, zorg ervoor dat <b class=button>OK</b> actief is en druk op <kbd>Enter</kbd> om verder te gaan.</p></div></div></div><div class=sect2><h3 id=install-media>2.8. Installatiemedia kiezen<a class=anchor href=#install-media></a></h3><div class=paragraph><p>Als wordt geïnstalleerd vanaf een CD-ROM of DVD kies dan met de pijltjestoetsen de optie <span class=guimenuitem>Install from a FreeBSD CD/DVD</span>. Zorg ervoor dat <b class=button>OK</b> actief is en druk op <kbd>Enter</kbd> om verder te gaan.</p></div><div class=paragraph><p>Kies voor andere installatiemethodes de desbetreffende optie en volg de aanwijzingen.</p></div><div class=paragraph><p>Druk op <kbd>F1</kbd> om de online help voor de installatiemedia te lezen. Druk op <kbd>Enter</kbd> om terug te gaan naar het menu mediaselectie.</p></div><div id=choose-media class=imageblock><div class=content><img src=../../../../images/books/handbook/install/media.png alt=media></div><div class=title>Figuur 26. Mediaselectie</div></div><div class=sect3><h4 id=_ftp_installatiemethoden>2.8.1. FTP installatiemethoden<a class=anchor href=#_ftp_installatiemethoden></a></h4><div class=paragraph><p>Er zijn drie manieren van installeren via FTP: active FTP, passive FTP of via een HTTP proxy.</p></div><div class=dlist><dl><dt class=hdlist1>Actieve FTP: <span class=guimenuitem>Install from an FTP server</span></dt><dd><p>Deze optie zorgt ervoor dat alle FTP acties gebruik maken van de "Active" modus. Dit werkt niet door firewalls, maar werkt wel met oudere FTP-servers die de passieve modus niet ondersteunen. Als een verbinding blijft hangen met de passieve modus probeer dan de actieve modus!</p></dd><dt class=hdlist1>Passieve FTP: <span class=guimenuitem>Install from an FTP server through a firewall</span></dt><dd><p>Deze optie geeft sysinstall aan gebruik te maken van de "Passive" modus voor al het FTP-verkeer. Dit zorgt ervoor dat verbindingen door firewalls heen kunnen die inkomende verbindingen niet toelaten op willekeurige TCP-poorten.</p></dd><dt class=hdlist1>FTP via een HTTP proxy: <span class=guimenuitem>Install from an FTP server through a http proxy</span></dt><dd><p>Deze optie geeft sysinstall aan gebruik te maken van het HTTP protocol (zoals een webbrowser) om verbinding te maken met een proxy voor alle FTP verbindingen. De proxy vertaalt de verzoeken en stuurt ze naar de FTP server. Dit zorgt ervoor dat verbindingen door firewalls heen kunnen die helemaal geen FTP toestaan, maar wel een HTTP proxy hebben. In dit geval moet naast de FTP-server ook een HTTP proxy opgegeven worden.</p></dd></dl></div><div class=paragraph><p>Bij het gebruik van een proxy FTP-server moet meestal de server waar uiteindelijk verbinding mee gemaakt moet worden onderdeel zijn van de gebruikersnaam, na het teken "@". De proxy server "imiteert" dan de echte server. Zo kan bijvoorbeeld geïnstalleerd worden vanaf <code>ftp.FreeBSD.org</code>, gebruikmakend van proxy FTP-server <code>foo.example.com</code>, luisterend op poort 1234.</p></div><div class=paragraph><p>In dit geval kan in het menu opties menu als FTP gebruikersnaam <code>ftp@ftp.FreeBSD.org</code> ingevuld worden en als wachtwoord een emailadres. Als installatiemedium kan FTP ingevuld worden (of passieve FTP als de gebruikte proxy het ondersteunt) en als URL <code><a href=ftp://foo.example.com:1234/pub/FreeBSD class=bare>ftp://foo.example.com:1234/pub/FreeBSD</a></code>.</p></div><div class=paragraph><p>Omdat <span class=filename>/pub/FreeBSD</span> van <code>ftp.FreeBSD.org</code> via de proxy van <code>foo.example.com</code> wordt benaderd kan vanaf <em>die</em> machine geïnstalleerd worden (die de bestanden ophaalt van <code>ftp.FreeBSD.org</code> als het installatieprogramma erom vraagt).</p></div></div></div><div class=sect2><h3 id=install-final-warning>2.9. De installatie bevestigen<a class=anchor href=#install-final-warning></a></h3><div class=paragraph><p>Nu kan de installatie verder gaan. Dit is ook de laatste mogelijkheid om de installatie te beëindigen ter voorkoming van wijzigingen op de harde schijf.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
 Last Chance! Are you SURE you want to <span class=k>continue </span>the installation?

 If you<span class=s1>&#39;re running this on a disk with data you wish to save then WE
 STRONGLY ENCOURAGE YOU TO MAKE PROPER BACKUPS before proceeding!

 We can take no responsibility for lost disk contents!

                             [ Yes ]    No</span></code></pre></div></div><div class=paragraph><p>Kies <b class=button>yes</b> en druk op <kbd>Enter</kbd> om verder te gaan.</p></div><div class=paragraph><p>De duur van de installatie hangt af van de gekozen distributie, het installatiemedium en de snelheid van de computer. Er wordt een serie berichten getoond die de voortgang aangeeft.</p></div><div class=paragraph><p>De installatie is klaar als het volgende bericht wordt getoond:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                               Message

Congratulations! You now have FreeBSD installed on your system.

We will now move on to the final configuration questions.
For any option you <span class=k>do </span>not wish to configure, simply <span class=k>select </span>No.

If you wish to re-enter this utility after the system is up, you may
<span class=k>do </span>so by typing: /usr/sbin/sysinstall.

                                 <span class=o>[</span> OK <span class=o>]</span>

                      <span class=o>[</span>  Press enter or space  <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Druk op <kbd>Enter</kbd> om verder te gaan met instellingen na de installatie.</p></div><div class=paragraph><p>Kiezen voor <b class=button>no</b> en bevestigen met <kbd>Enter</kbd> beëindigt de installatie en er worden geen wijzigingen aan het systeem gemaakt. Het volgende bericht verschijnt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                                Message
Installation <span class=nb>complete </span>with some errors.  You may wish to scroll
through the debugging messages on VTY1 with the scroll-lock feature.
You can also choose <span class=s2>&#34;No&#34;</span> at the next prompt and go back into the
installation menus to retry whichever operations have failed.

                                 <span class=o>[</span> OK <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Het bovenstaande bericht verschijnt omdat er niets is geïnstalleerd. Kies <kbd>Enter</kbd> om terug te gaan naar het menu Main Installation en de installatie te verlaten.</p></div></div><div class=sect2><h3 id=install-post>2.10. Instellingen na de installatie<a class=anchor href=#install-post></a></h3><div class=paragraph><p>Na het installeren volgt de instelling van diverse opties. Een optie kan worden ingesteld door opnieuw naar de instellingenopties te gaan voordat de nieuwe FreeBSD-installatie wordt gestart of door na de installatie <code>sysinstall</code> te gebruiken en te kiezen voor <span class=guimenuitem>Configure</span>.</p></div><div class=sect3><h4 id=inst-network-dev>2.10.1. Netwerkapparaten instellen<a class=anchor href=#inst-network-dev></a></h4><div class=paragraph><p>Als al eerder PPP is ingesteld voor een FTP-installatie verschijnt het volgende scherm niet en kan dit onderdeel worden geïnstalleerd zoals eerder beschreven.</p></div><div class=paragraph><p>Gedetailleerde informatie over lokale netwerken (LAN’s) en het instellen van FreeBSD als een gateway of router staat in het hoofdstuk <a href=./#advanced-networking>Netwerken voor Gevorderden</a>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
   Would you like to configure any Ethernet or PPP network devices?

                             <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Kies <b class=button>yes</b> en druk op <kbd>Enter</kbd> om een netwerkapparaat in te stellen. Kies anders <b class=button>no</b> om verder te gaan.</p></div><div id=ed-config1 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/ed0-conf.png alt="ed0 conf"></div><div class=title>Figuur 27. Ethernetapparaat kiezen</div></div><div class=paragraph><p>Kies de in te stellen interface met de pijltjestoetsen en druk op <kbd>Enter</kbd>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
       Do you want to try IPv6 configuration of the interface?

                              Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>In dit gesloten lokale netwerk was het huidige type Internet protocol (IPv4) toereikend en dus werd <b class=button>no</b> geselecteerd met de pijltjestoetsen en kon met <kbd>Enter</kbd> verder gegaan worden.</p></div><div class=paragraph><p>Als er verbinding is met een bestaand IPv6 netwerk met een RA server, kies dan <b class=button>yes</b> en druk op <kbd>Enter</kbd>. Zoeken naar RA servers duurt een paar seconden.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                             User Confirmation Requested
        Do you want to try DHCP configuration of the interface?

                              Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Kies <b class=button>no</b> met de pijltjestoetsen en druk op <kbd>Enter</kbd> als DHCP (Dynamic Host Configuration Protocol) niet nodig is.</p></div><div class=paragraph><p><b class=button>yes</b> kiezen start dhclient op en als het goed gaat stelt het netwerk zichzelf in. In <a href=./#network-dhcp>Automatisch netwerk instellen (DHCP)</a> staat meer informatie.</p></div><div class=paragraph><p>Het volgende scherm met netwerkinstellingen toont de instellingen van een Ethernetapparaat van een systeem dat als gateway voor een lokaal netwerk functioneert.</p></div><div id=ed-config2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/ed0-conf2.png alt="ed0 conf2"></div><div class=title>Figuur 28. Netwerkinstellingen voor <em>ed0</em></div></div><div class=paragraph><p>Met <kbd>Tab</kbd> kunnen de velden geselecteerd worden waarna de juiste informatie ingevuld kan worden:</p></div><div class=dlist><dl><dt class=hdlist1>Host</dt><dd><p>De "fully-qualified hostname", in dit geval <code>k6-2.example.com</code>.</p></dd><dt class=hdlist1>Domain</dt><dd><p>De naam van het domein waar toe de machine behoort, in dit geval <code>example.com</code>.</p></dd><dt class=hdlist1>IPv4 Gateway</dt><dd><p>Het IP-adres van de host die pakketjes doorstuurt naar niet-lokale bestemmingen. Dit moet ingesteld worden als een machine een onderdeel is van netwerk. <em>Laat dit veld leeg</em> als de machine de gateway is naar het Internet voor het netwerk. De IPv4 Gateway staat ook bekend onder de naam default gateway of default route.</p></dd><dt class=hdlist1>Name server</dt><dd><p>Het IP-adres van de lokale DNS server. Er is op dit gesloten lokale netwerk geen DNS server, dus wordt het IP-adres van de DNS server van de provider gebruikt (<code>208.163.10.2</code>).</p></dd><dt class=hdlist1>IPv4 Address</dt><dd><p>Het IP-adres dat gebruikt moet worden voor deze interface (<code>192.168.0.1</code>).</p></dd><dt class=hdlist1>Netmask</dt><dd><p>Het adresblok dat gebruikt wordt door het lokale netwerk is <code>192.168.0.0</code> - <code>192.168.255.255</code> met netmasker <code>255.255.255.0</code>.</p></dd><dt class=hdlist1>Extra options to ifconfig</dt><dd><p>Elke interface-specifieke optie voor <code>ifconfig</code> die toegevoegd moet worden. In dit geval waren er geen.</p></dd></dl></div><div class=paragraph><p>Gebruik <kbd>Tab</kbd> om <b class=button>OK</b> te selecteren als de instellingen gereed zijn en druk op <kbd>Enter</kbd>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
        Would you like to Bring the ed0 interface up right now?

                             <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Het kiezen van <b class=button>yes</b> en het drukken op <kbd>Enter</kbd> maakt een machine onderdeel van een netwerk en daarna is hij klaar voor gebruik. Dit heeft echter nog weinig zin, omdat de machine nog opnieuw opgestart moet worden.</p></div></div><div class=sect3><h4 id=gateway>2.10.2. Als gateway instellen<a class=anchor href=#gateway></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
       Do you want this machine to <span class=k>function </span>as a network gateway?

                              <span class=o>[</span> Yes <span class=o>]</span>    No</code></pre></div></div><div class=paragraph><p>Als de machine gateway voor een lokaal netwerk is en pakketjes doorstuurt naar andere machines kies dan <b class=button>yes</b> en druk op <kbd>Enter</kbd>. Als de machine alleen host op een netwerk is, kies dan <b class=button>no</b> en druk op <kbd>Enter</kbd> om verder te gaan.</p></div></div><div class=sect3><h4 id=inetd-services>2.10.3. Internetdiensten instellen<a class=anchor href=#inetd-services></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
Do you want to configure inetd and the network services that it provides?

                               Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Door het selecteren van <b class=button>no</b> worden diverse diensten als telnetd niet aangezet. Dat betekent dat gebruikers op afstand niet met telnet bij de machine kunnen. Lokale gebruikers kunnen wel met telnet naar andere machines.</p></div><div class=paragraph><p>Deze diensten kunnen na de installatie worden aangezet door <span class=filename>/etc/inetd.conf</span> te wijzigen met een editor naar keuze. In <a href=./#network-inetd-overview>Overzicht</a> staat meer informatie.</p></div><div class=paragraph><p>Selecteer <b class=button>yes</b> om deze diensten in te stellen tijdens de installatie. Er wordt een extra bevestiging getoond:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
The Internet Super Server <span class=o>(</span>inetd<span class=o>)</span> allows a number of simple Internet
services to be enabled, including finger, ftp and telnetd.  Enabling
these services may increase risk of security problems by increasing
the exposure of your system.

With this <span class=k>in </span>mind, <span class=k>do </span>you wish to <span class=nb>enable </span>inetd?

                             <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Selecteer <b class=button>yes</b> om verder te gaan.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
inetd<span class=o>(</span>8<span class=o>)</span> relies on its configuration file, /etc/inetd.conf, to determine
which of its Internet services will be available.  The default FreeBSD
inetd.conf<span class=o>(</span>5<span class=o>)</span> leaves all services disabled by default, so they must be
specifically enabled <span class=k>in </span>the configuration file before they will
<span class=k>function</span>, even once inetd<span class=o>(</span>8<span class=o>)</span> is enabled.  Note that services <span class=k>for
</span>IPv6 must be separately enabled from IPv4 services.

Select <span class=o>[</span>Yes] now to invoke an editor on /etc/inetd.conf, or <span class=o>[</span>No] to
use the current settings.

                             <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Het selecteren van <b class=button>yes</b> geeft de mogelijkheid diensten toe te voegen door het teken <code>#</code> aan het begin van een regel te verwijderen.</p></div><div id=inetd-edit class=imageblock><div class=content><img src=../../../../images/books/handbook/install/edit-inetd-conf.png alt="edit inetd conf"></div><div class=title>Figuur 29. <span class=filename>inetd.conf</span> bewerken</div></div><div class=paragraph><p>Druk na het toevoegen van de gewenste diensten, op <kbd>Esc</kbd> om het menu te krijgen waarin de wijzigingen opgeslagen kunnen worden en de editor verlaten kan worden.</p></div></div><div class=sect3><h4 id=ssh-login>2.10.4. SSH-login aanzetten<a class=anchor href=#ssh-login></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
                 Would you like to <span class=nb>enable </span>SSH login?
                          Yes        <span class=o>[</span>  No  <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Het kiezen van <b class=button>yes</b> zal <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> aanzetten, het daemon-programma voor OpenSSH. Dit zal beveiligde toegang op afstand tot uw machine toestaan. Zie voor meer informatie over OpenSSH <a href=./#openssh>OpenSSH</a>.</p></div></div><div class=sect3><h4 id=ftpanon>2.10.5. Anonieme FTP<a class=anchor href=#ftpanon></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
 Do you want to have anonymous FTP access to this machine?

                              Yes    <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=sect4><h5 id=deny-anon>2.10.5.1. Anonieme FTP weigeren<a class=anchor href=#deny-anon></a></h5><div class=paragraph><p>Het selecteren van de standaardwaarde <b class=button>no</b> en het drukken op <kbd>Enter</kbd> stelt gebruikers met toegang en een wachtwoord nog steeds in staat om de machine via FTP te benaderen.</p></div></div><div class=sect4><h5 id=ftpallow>2.10.5.2. Anonieme FTP toestaan<a class=anchor href=#ftpallow></a></h5><div class=paragraph><p>Als anonieme FTP wordt toegestaan kan iedereen de machine met FTP benaderen. De gevolgen voor de veiligheid van de machine moeten overwogen worden voordat deze optie wordt ingeschakeld. Meer informatie over beveiliging staat in <a href=./#security>Beveiliging</a>.</p></div><div class=paragraph><p>Selecteer met de pijltjestoetsen <b class=button>yes</b> om anonieme FTP toe te staan en druk op <kbd>Enter</kbd>. Een aanvullende bevestiging zal verschijnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
Anonymous FTP permits un-authenticated <span class=nb>users </span>to connect to the system
FTP server, <span class=k>if </span>FTP service is enabled.  Anonymous <span class=nb>users </span>are
restricted to a specific subset of the file system, and the default
configuration provides a drop-box incoming directory to which uploads
are permitted.  You must separately <span class=nb>enable </span>both inetd<span class=o>(</span>8<span class=o>)</span>, and <span class=nb>enable
</span>ftpd<span class=o>(</span>8<span class=o>)</span> <span class=k>in </span>inetd.conf<span class=o>(</span>5<span class=o>)</span> <span class=k>for </span>FTP services to be available.  If you
did not <span class=k>do </span>so earlier, you will have the opportunity to <span class=nb>enable </span>inetd<span class=o>(</span>8<span class=o>)</span>
again later.

If you want the server to be read-only you should leave the upload
directory option empty and add the <span class=nt>-r</span> command-line option to ftpd<span class=o>(</span>8<span class=o>)</span>
<span class=k>in </span>inetd.conf<span class=o>(</span>5<span class=o>)</span>

Do you wish to <span class=k>continue </span>configuring anonymous FTP?

                         <span class=o>[</span> Yes <span class=o>]</span>         No</code></pre></div></div><div class=paragraph><p>Dit bericht informeert u dat de FTP-dienst ook in <span class=filename>/etc/inetd.conf</span> aangezet moet worden als u anonieme FTP-verbindingen wilt toestaan, zie <a href=#inetd-services>Internetdiensten instellen</a>. Kies <b class=button>yes</b> en druk op <kbd>Enter</kbd> om verder te gaan; het volgende scherm zal verschijnen:</p></div><div id=anon-ftp2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/ftp-anon1.png alt="ftp anon1"></div><div class=title>Figuur 30. Standaard anonieme FTP instellingen</div></div><div class=paragraph><p>Gebruik <kbd>Tab</kbd> om de informatievelden te selecteren en de juiste informatie in te vullen:</p></div><div class=dlist><dl><dt class=hdlist1>UID</dt><dd><p>De gebruikers-ID die u aan de anonieme FTP-gebruiker wilt toekennen. Alle geuploade bestanden zullen eigendom zijn van deze ID.</p></dd><dt class=hdlist1>Group</dt><dd><p>In welke groep de anonieme FTP-gebruiker dient te zitten.</p></dd><dt class=hdlist1>Comment</dt><dd><p>Een string die deze gebruiker in <span class=filename>/etc/passwd</span> beschrijft.</p></dd><dt class=hdlist1>FTP Root Directory</dt><dd><p>Waar de bestanden beschikbaar voor anonieme FTP worden bewaard.</p></dd><dt class=hdlist1>Upload Subdirectory</dt><dd><p>Waar bestanden geupload door anonieme FTP-gebruikers naar toe gaan.</p></dd></dl></div><div class=paragraph><p>De startmap voor FTP wordt standaard ingesteld op <span class=filename>/var</span>. Als daar niet genoeg ruimte is voor de geschatte FTP-wensen dan kan <span class=filename>/usr</span> gebruikt worden door de waarde FTP root directory op <span class=filename>/usr/ftp</span> in te stellen.</p></div><div class=paragraph><p>Druk op <kbd>Enter</kbd> om verder te gaan als de instellingen gemaakt zijn.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                          User Confirmation Requested
         Create a welcome message file <span class=k>for </span>anonymous FTP <span class=nb>users</span>?

                              <span class=o>[</span> Yes <span class=o>]</span>    No</code></pre></div></div><div class=paragraph><p>Na het kiezen van <b class=button>yes</b> en op <kbd>Enter</kbd> drukken opent zich een editor waarin het welkomstbericht bewerkt kan worden.</p></div><div id=anon-ftp4 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/ftp-anon2.png alt="ftp anon2"></div><div class=title>Figuur 31. FTP welkomstbericht bewerken</div></div><div class=paragraph><p>De bovenstaande editor is <code>ee</code>. Volg de instructies om het bericht te wijzigen of wijzig het bericht later door gebruik te maken van een editor naar keuze. Let op de bestandsnaam en lokatie onderaan het scherm van de editor.</p></div><div class=paragraph><p>Druk op <kbd>Esc</kbd> en een pop-up menu verschijnt met als standaardoptie <span class=guimenuitem>a) leave editor</span>. Druk op <kbd>Enter</kbd> om de editor te verlaten en verder te gaan. Druk nog een keer op <kbd>Enter</kbd> om de eventuele wijzigingen te bewaren.</p></div></div></div><div class=sect3><h4 id=nfsconf>2.10.6. Network File System instellen<a class=anchor href=#nfsconf></a></h4><div class=paragraph><p>Network File System (NFS) maakt het mogelijk bestanden te delen over een netwerk. Een machine kan worden ingesteld als server, client of beide. In <a href=./#network-nfs>Netwerkbestandssysteem (NFS)</a> staat meer informatie.</p></div><div class=sect4><h5 id=nsf-server-options>2.10.6.1. NFS Server<a class=anchor href=#nsf-server-options></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
 Do you want to configure this machine as an NFS server?

                              Yes    <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Kies <b class=button>no</b> als er geen noodzaak is voor een Network File System server en druk op <kbd>Enter</kbd>.</p></div><div class=paragraph><p>Na het kiezen van <b class=button>yes</b> wordt een bericht getoond dat aangeeft dat er een betand <span class=filename>exports</span> moet worden gemaakt.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                               Message
Operating as an NFS server means that you must first configure an
/etc/exports file to indicate which hosts are allowed certain kinds of
access to your <span class=nb>local </span>filesystems.
Press <span class=o>[</span>Enter] now to invoke an editor on /etc/exports
                               <span class=o>[</span> OK <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Druk op <kbd>Enter</kbd> om verder te gaan. Een editor start om <span class=filename>exports</span> te maken en te bewerken.</p></div><div id=nfs-server-edit class=imageblock><div class=content><img src=../../../../images/books/handbook/install/nfs-server-edit.png alt="nfs server edit"></div><div class=title>Figuur 32. <span class=filename>exports</span> bewerken</div></div><div class=paragraph><p>Volg de instructies om een te exporteren bestandssysteem toe te voegen of doe het later met een editor naar keuze. Let op de bestandsnaam en lokatie onderaan het scherm van de editor.</p></div><div class=paragraph><p>Druk op <kbd>Esc</kbd> en een pop-up menu verschijnt met als standaardoptie <span class=guimenuitem>a) leave editor</span>. Druk op <kbd>Enter</kbd> om de editor te verlaten en verder te gaan.</p></div></div><div class=sect4><h5 id=nfs-client-options>2.10.6.2. NFS Client<a class=anchor href=#nfs-client-options></a></h5><div class=paragraph><p>De NFS client maakt het mogelijk om NFS servers te benaderen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
 Do you want to configure this machine as an NFS client?

                              Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Kies met de pijltjestoetsen de optie <b class=button>yes</b> of <b class=button>no</b> en druk op <kbd>Enter</kbd>.</p></div></div></div><div class=sect3><h4 id=console>2.10.7. Systeemconsole instellen<a class=anchor href=#console></a></h4><div class=paragraph><p>Er is een aantal opties beschikbaar om de systeemconsole in aan te passen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
       Would you like to customize your system console settings?

                              <span class=o>[</span> Yes <span class=o>]</span>  No</code></pre></div></div><div class=paragraph><p>Om de opties te bekijken en in te stellen, kies <b class=button>yes</b> en druk op <kbd>Enter</kbd>.</p></div><div id=saver-options class=imageblock><div class=content><img src=../../../../images/books/handbook/install/console-saver1.png alt="console saver1"></div><div class=title>Figuur 33. Systeemconsole instellingen</div></div><div class=paragraph><p>Een gebruikelijke optie is de schermbeveiliging. Gebruik de pijltjestoetsen om <span class=guimenuitem>Saver</span> te selecteren en druk op <kbd>Enter</kbd>.</p></div><div id=saver-select class=imageblock><div class=content><img src=../../../../images/books/handbook/install/console-saver2.png alt="console saver2"></div><div class=title>Figuur 34. Schermbeveiligingsopties</div></div><div class=paragraph><p>Kies met de pijltjestoetsen de gewenste schermbeveiliging en druk op <kbd>Enter</kbd>. Het instellingenmenu System Console verschijnt weer.</p></div><div class=paragraph><p>De standaard activeringstijd is 300 seconden. Kies voor het wijzigen van de activeringstijd weer <span class=guimenuitem>Saver</span>. Kies in het optiemenu Screen Saver met de pijltjestoetsen <span class=guimenuitem>Timeout</span> en druk op <kbd>Enter</kbd>. Een pop-up verschijnt:</p></div><div id=saver-timeout class=imageblock><div class=content><img src=../../../../images/books/handbook/install/console-saver3.png alt="console saver3"></div><div class=title>Figuur 35. Schermbeveiliging activeringstijd</div></div><div class=paragraph><p>Wijzig de waarde, selecteer <b class=button>OK</b> en druk op <kbd>Enter</kbd> om terug te gaan naar het instellingenmenu System Console.</p></div><div id=saver-exit class=imageblock><div class=content><img src=../../../../images/books/handbook/install/console-saver4.png alt="console saver4"></div><div class=title>Figuur 36. Systeemconsole instellingen verlaten</div></div><div class=paragraph><p>Met het selecteren van <span class=guimenuitem>Exit</span> en drukken op <kbd>Enter</kbd> kan verdergegaan worden met de andere instellingen.</p></div></div><div class=sect3><h4 id=timezone>2.10.8. Tijdzone instellen<a class=anchor href=#timezone></a></h4><div class=paragraph><p>Het instellen van de tijdzone van een machine maakt het mogelijk om automatisch correcties door te voeren voor regionale tijdswijzigingen en het juist uitvoeren van andere tijdzone-afhankelijke functies.</p></div><div class=paragraph><p>Het voorbeeld toont een machine die staat in de oostelijke tijdzone van de Verenigde Staten. De keuze voor een specifiek systeem hangt af van de geografische locatie.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
          Would you like to <span class=nb>set </span>this machine<span class=s1>&#39;s time zone now?

                            [ Yes ]   No</span></code></pre></div></div><div class=paragraph><p>Selecteer <b class=button>yes</b> en druk op <kbd>Enter</kbd> om de tijdzone in te stellen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
 Is this machine<span class=s1>&#39;s CMOS clock set to UTC? If it is set to local time
 or you don&#39;</span>t know, please choose NO here!

                              Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Kies <b class=button>yes</b> of <b class=button>no</b> afhankelijk van de instellingen van de klok van de machine en druk op <kbd>Enter</kbd>.</p></div><div id=set-timezone-region class=imageblock><div class=content><img src=../../../../images/books/handbook/install/timezone1.png alt=timezone1></div><div class=title>Figuur 37. Regio instellen</div></div><div class=paragraph><p>Kies met de pijltjestoetsen de juiste regio en druk op <kbd>Enter</kbd>.</p></div><div id=set-timezone-country class=imageblock><div class=content><img src=../../../../images/books/handbook/install/timezone2.png alt=timezone2></div><div class=title>Figuur 38. Land kiezen</div></div><div class=paragraph><p>Kies met de pijltjestoetsen het juiste land en druk op <kbd>Enter</kbd>.</p></div><div id=set-timezone-locality class=imageblock><div class=content><img src=../../../../images/books/handbook/install/timezone3.png alt=timezone3></div><div class=title>Figuur 39. Tijdzone kiezen</div></div><div class=paragraph><p>Kies met de pijltjestoetsen de juiste tijdzone en druk op <kbd>Enter</kbd>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                            Confirmation
            Does the abbreviation <span class=s1>&#39;EDT&#39;</span> look reasonable?

                            <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Bevestig dat de afkorting van de tijdzone juist is. Als die er goed uit ziet, druk dan op <kbd>Enter</kbd> om verder te gaan met de overige instellingen.</p></div></div><div class=sect3><h4 id=linuxcomp>2.10.9. Linux compatibiliteit<a class=anchor href=#linuxcomp></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Dit gedeelte is alleen van toepassing op installaties van FreeBSD 7.<em>X</em>, als u FreeBSD 8.<em>X</em> installeert wordt dit scherm niet getoond.</p></div></td></tr></tbody></table></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
          Would you like to <span class=nb>enable </span>Linux binary compatibility?

                            <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Selecteer <b class=button>yes</b> en druk op <kbd>Enter</kbd> als de mogelijkheid om Linux software te draaien op FreeBSD geactiveerd moet worden. Deze optie installeert de voor Linux compatibiliteit benodigde pakketten.</p></div><div class=paragraph><p>Als via FTP wordt geïnstalleerd, dan moet de machine verbonden zijn met Internet. Soms heeft een FTP-site niet alle distributies, zoals de Linux comptabiliteit, beschikbaar. Zonodig kan deze ook later geïnstalleerd worden.</p></div></div><div class=sect3><h4 id=mouse>2.10.10. Muisinstellingen<a class=anchor href=#mouse></a></h4><div class=paragraph><p>Deze optie geeft de mogelijkheid om tekst te kopiëren en te plakken in de console en programma’s met een 3-knops muis. Als een 2-knops muis wordt gebruikt, ga dan naar de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=moused&amp;sektion=8&amp;format=html">moused(8)</a> na de installatie voor de details over het emuleren van een 3-knops muis. Dit voorbeeld toont een niet-USB muisinstelling (zoals een PS/2 of seriële poort muis):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
         Does this system have a PS/2, serial, or bus mouse?

                            <span class=o>[</span> Yes <span class=o>]</span>    No</code></pre></div></div><div class=paragraph><p>Selecteer <b class=button>yes</b> voor een PS/2-, seriële of busmuis of <b class=button>no</b> voor een USB-muis en druk op <kbd>Enter</kbd>.</p></div><div id=mouse-protocol class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse1.png alt=mouse1></div><div class=title>Figuur 40. Muisprotocoltype selecteren</div></div><div class=paragraph><p>Gebruik de pijltjestoetsen om <span class=guimenuitem>Type</span> te selecteren en druk op <kbd>Enter</kbd>.</p></div><div id=set-mouse-protocol class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse2.png alt=mouse2></div><div class=title>Figuur 41. Muisprotocol kiezen</div></div><div class=paragraph><p>De muis in dit voorbeeld is een PS/2-muis, dus de standaardoptie <span class=guimenuitem>Auto</span> was van toepassing. Selecteer met de pijltjestoetsen een andere optie om het protocol te wijzigen. Zorg ervoor dat <b class=button>OK</b> geselecteerd is en druk op <kbd>Enter</kbd> om dit menu te verlaten.</p></div><div id=config-mouse-port class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse3.png alt=mouse3></div><div class=title>Figuur 42. Muispoort instellen</div></div><div class=paragraph><p>Gebruik de pijltjestoetsen om <span class=guimenuitem>Port</span> te selecteren en druk op <kbd>Enter</kbd>.</p></div><div id=set-mouse-port class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse4.png alt=mouse4></div><div class=title>Figuur 43. Muispoort instellen</div></div><div class=paragraph><p>Dit systeem heeft een PS/2 muis, dus de standaardoptie <span class=guimenuitem>PS/2</span> was van toepassing. Gebruik de pijltjestoetsen en druk op <kbd>Enter</kbd> om de poort te wijzigen.</p></div><div id=test-daemon class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse5.png alt=mouse5></div><div class=title>Figuur 44. Muisdaemon inschakelen</div></div><div class=paragraph><p>Gebruik tenslotte de pijltjestoetsen om <span class=guimenuitem>Enable</span> te selecteren en druk op <kbd>Enter</kbd> om de muisdaemon aan te zetten en te testen.</p></div><div id=test-mouse-daemon class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse6.png alt=mouse6></div><div class=title>Figuur 45. Het testen van de muisdaemon</div></div><div class=paragraph><p>Beweeg de muis over het scherm en controleer of de cursor op de juiste manier reageert. Als dat in orde is, selecteer dan <b class=button>yes</b> en druk op <kbd>Enter</kbd>. Als het niet goed gaat, dan is de muis niet goed ingesteld. Kies dan <b class=button>no</b> en probeer het met andere instellingen.</p></div><div class=paragraph><p>Kies met de pijltjestoetsen <span class=guimenuitem>Exit</span> en druk op <kbd>Enter</kbd> om terug te gaan naar het instellingenmenu.</p></div></div><div class=sect3><h4 id=packages>2.10.11. Pakketten installeren<a class=anchor href=#packages></a></h4><div class=paragraph><p>Pakketten zijn voorgebouwde binaire bestanden en zijn een gemakkelijke manier om software te installeren.</p></div><div class=paragraph><p>De installatie van één pakket wordt als voorbeeld getoond. Er kunnen nog meer pakketten geïnstalleerd worden als dat wenselijk is. Na de installatie kan <code>sysinstall</code> gebruikt worden om extra pakketten te installeren.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     User Confirmation Requested
 The FreeBSD package collection is a collection of hundreds of
 ready-to-run applications, from text editors to games to WEB servers
 and more. Would you like to browse the collection now?

                            <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Na het kiezen van <b class=button>yes</b> en drukken op <kbd>Enter</kbd> verschijnt het menu pakketkeuze:</p></div><div id=package-category class=imageblock><div class=content><img src=../../../../images/books/handbook/install/pkg-cat.png alt="pkg cat"></div><div class=title>Figuur 46. Pakketcategorie kiezen</div></div><div class=paragraph><p>Alleen pakketten die aanwezig zijn op het huidige installatiemedium zijn beschikbaar voor installatie op dat moment.</p></div><div class=paragraph><p>Alle beschikbare pakketten worden getoond na het selecteren van <span class=guimenuitem>All</span>, maar er kan ook een bepaalde categorie geselecteerd worden. De categorie kan gekozen worden met de pijltjestoetsen en door te bevestigen met <kbd>Enter</kbd>.</p></div><div class=paragraph><p>Dan wordt een menu getoond met alle beschikbare pakketten binnen de gemaakte selectie:</p></div><div id=package-select class=imageblock><div class=content><img src=../../../../images/books/handbook/install/pkg-sel.png alt="pkg sel"></div><div class=title>Figuur 47. Pakketten selecteren</div></div><div class=paragraph><p>De shell bash is geselecteerd. Er kunnen zoveel pakketten als wenselijk gekozen worden door ze te selecteren en op de spatiebalk te drukken. Een korte beschrijving van elk pakket verschijnt in de linker benedenhoek van het scherm.</p></div><div class=paragraph><p>Door te drukken op <kbd>Tab</kbd> wordt gewisseld tussen het laatst geselecteerde pakket, <b class=button>OK</b> en <b class=button>Cancel</b>.</p></div><div class=paragraph><p>Druk na het selecteren van pakketten voor installatie één keer op <kbd>Tab</kbd> om naar <b class=button>OK</b> te gaan en druk op <kbd>Enter</kbd> om terug te gaan naar het menu pakketkeuze.</p></div><div class=paragraph><p>De linker- en rechterpijltjestoets wisselen eveneens tussen <b class=button>OK</b> en <b class=button>Cancel</b>. Die manier kan ook gebruikt worden om <b class=button>OK</b> te kiezen en op <kbd>Enter</kbd> te drukken om terug te gaan naar het menu pakketkeuze.</p></div><div id=package-install class=imageblock><div class=content><img src=../../../../images/books/handbook/install/pkg-install.png alt="pkg install"></div><div class=title>Figuur 48. Pakketten installeren</div></div><div class=paragraph><p>Gebruik <kbd>Tab</kbd> en de pijltjestoetsen om <b class=button>Install</b> te selecteren en druk op <kbd>Enter</kbd>. Daarna moet de pakketinstallatie bevestigd worden:</p></div><div id=package-install-confirm class=imageblock><div class=content><img src=../../../../images/books/handbook/install/pkg-confirm.png alt="pkg confirm"></div><div class=title>Figuur 49. Pakketinstallatie bevestigen</div></div><div class=paragraph><p>Het selecteren van <b class=button>OK</b> en drukken op <kbd>Enter</kbd> start de installatie. Er worden installatieberichten getoond tot alle installaties zijn afgerond. Maak een notitie van eventuele foutmeldingen.</p></div><div class=paragraph><p>Na het installeren van pakketten gaat het maken van de laatste instellingen verder. Als er geen pakketten geselecteerd zijn kan om terug te gaan naar het menu toch <b class=button>Install</b> gekozen worden.</p></div></div><div class=sect3><h4 id=addusers>2.10.12. Gebruikers en groepen toevoegen<a class=anchor href=#addusers></a></h4><div class=paragraph><p>Er moet minstens één gebruiker toegevoegd worden tijdens de installatie, zodat het systeem gebruikt kan worden zonder als <code>root</code> aan te hoeven melden. De rootpartitie is in het algemeen klein en het draaien van programma’s als <code>root</code> kan de schijfruimte snel vullen. Een groter gevaar wordt hieronder aangegeven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     User Confirmation Requested
 Would you like to add any initial user accounts to the system? Adding
 at least one account <span class=k>for </span>yourself at this stage is suggested since
 working as the <span class=s2>&#34;root&#34;</span> user is dangerous <span class=o>(</span>it is easy to <span class=k>do </span>things which
 adversely affect the entire system<span class=o>)</span><span class=nb>.</span>

                            <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Kies <b class=button>yes</b> en druk op <kbd>Enter</kbd> om verder te gaan met het toevoegen van een gebruiker.</p></div><div id=add-user2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/adduser1.png alt=adduser1></div><div class=title>Figuur 50. Gebruiker kiezen</div></div><div class=paragraph><p>Selecteer <span class=guimenuitem>User</span> met de pijltjestoetsen en druk op <kbd>Enter</kbd>.</p></div><div id=add-user3 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/adduser2.png alt=adduser2></div><div class=title>Figuur 51. Gebruikersinformatie toevoegen</div></div><div class=paragraph><p>De volgende beschrijvingen verschijnen in het onderste deel van het scherm als opties zijn geselecteerd met <kbd>Tab</kbd> en kunnen behulpzaam zijn bij het invullen van de benodigde informatie:</p></div><div class=dlist><dl><dt class=hdlist1>Login ID</dt><dd><p>De aanmeldnaam van de nieuwe gebruiker (verplicht).</p></dd><dt class=hdlist1>UID</dt><dd><p>Het numerieke ID van de gebruiker (laat leeg voor automatische toewijzing).</p></dd><dt class=hdlist1>Group</dt><dd><p>De naam van de aanmeldgroep van de gebruiker (laat leeg voor automatische keuze).</p></dd><dt class=hdlist1>Password</dt><dd><p>Het wachtwoord voor de gebruiker (vul dit zorgvuldig in!).</p></dd><dt class=hdlist1>Full name</dt><dd><p>De volledige naam van de gebruiker (commentaar).</p></dd><dt class=hdlist1>Member groups</dt><dd><p>De groepen waar de gebruiker in zit (waar hij toegangsrechten voor krijgt).</p></dd><dt class=hdlist1>Home directory</dt><dd><p>De locatie van de thuismap van de gebruiker (laat leeg voor de standaardwaarde).</p></dd><dt class=hdlist1>Login shell</dt><dd><p>De aanmeldshell voor de gebruiker (laat leeg voor de standaardwaarde, zoals <span class=filename>/bin/sh</span>).</p></dd></dl></div><div class=paragraph><p>De aanmeldshell is hier veranderd van <span class=filename>/bin/sh</span> in <span class=filename>/usr/local/bin/bash</span> om de shell bash te gebruiken die eerder is geïnstalleerd als pakket. Probeer geen shell op te geven die niet bestaat, want dan kan niet aangemeld worden. De meest gebruikte shell in de BSD-wereld is de C shell, die aangegeven kan worden als <span class=filename>/bin/tcsh</span>.</p></div><div class=paragraph><p>De gebruiker is ook toegevoegd aan de groep <code>wheel</code> om het mogelijk te maken superuser te worden met <code>root</code>-rechten.</p></div><div class=paragraph><p>Druk op <b class=button>OK</b> als de instellingen zijn gemaakt om naar het menu <code>User and Group Management</code> terug te gaan:</p></div><div id=add-user4 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/adduser3.png alt=adduser3></div><div class=title>Figuur 52. Gebruikers en groepbeheer</div></div><div class=paragraph><p>Op dit moment kunnen ook groepen worden toegevoegd als de specifieke behoeften bekend zijn. Dit kan ook door <code>sysinstall</code> (<code>/stand/sysinstall</code> in FreeBSD versies ouder dan 5.2) na de installatie te gebruiken.</p></div><div class=paragraph><p>Kies na het toevoegen van gebruikers <span class=guimenuitem>Exit</span> met de pijltjestoetsen en druk op <kbd>Enter</kbd> om verder te gaan met de installatie.</p></div></div><div class=sect3><h4 id=rootpass>2.10.13. <code>root</code> wachtwoord instellen<a class=anchor href=#rootpass></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                        Message
 Now you must <span class=nb>set </span>the system manager<span class=s1>&#39;s password.
 This is the password you&#39;</span>ll use to log <span class=k>in </span>as <span class=s2>&#34;root&#34;</span><span class=nb>.</span>

                         <span class=o>[</span> OK <span class=o>]</span>

               <span class=o>[</span> Press enter or space <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Druk op <kbd>Enter</kbd> om het <code>root</code> wachtwoord in te stellen.</p></div><div class=paragraph><p>Het wachtwoord moet twee keer gelijk ingegeven worden. Het is vast overbodig om op te merken dat het belangrijk is zorg te dragen voor een manier om het wachtwoord terug te vinden in het geval het wordt vergeten. Tijdens de ingave van het wachtwoord wordt dit niet weergegeven en er worden ook geen sterretjes getoond.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Changing <span class=nb>local </span>password <span class=k>for </span>root.
New password:
Retype new password :</code></pre></div></div><div class=paragraph><p>De installatie gaat verder als het wachtwoord succesvol is ingevoerd.</p></div></div><div class=sect3><h4 id=exit-inst>2.10.14. Install verlaten<a class=anchor href=#exit-inst></a></h4><div class=paragraph><p>Als het nodig is om extra netwerkapparaten toe te voegen of andere instellingen te maken, dan kan dat nu of later met <code>sysinstall</code>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     User Confirmation Requested
 Visit the general configuration menu <span class=k>for </span>a chance to <span class=nb>set </span>any last
 options?

                              Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Selecteer <b class=button>no</b> met de pijltjestoetsen en druk op <kbd>Enter</kbd> om terug te gaan naar het menu Main Installation.</p></div><div id=final-main class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mainexit.png alt=mainexit></div><div class=title>Figuur 53. Install afsluiten</div></div><div class=paragraph><p>Selecteer <b class=button>X Exit Install</b> met de pijltjestoetsen en druk op <kbd>Enter</kbd>. Er wordt om bevestiging gevraagd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     User Confirmation Requested
 Are you sure you wish to <span class=nb>exit</span>? The system will reboot.

                            <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Selecteer <b class=button>yes</b>. Als u van het CD-ROM-station opstart zal de volgende boodschap u eraan herinneren de schijf te verwijderen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                    Message
 Be sure to remove the media from the drive.

                    <span class=o>[</span> OK <span class=o>]</span>
           <span class=o>[</span> Press enter or space <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Het CD-ROM-station is geblokkeerd totdat de machine opnieuw wordt opgestart, dan kan de schijf snel uit het station worden gehaald. Druk op <b class=button>OK</b> om opnieuw op te starten.</p></div><div class=paragraph><p>Het systeem start op, dus let op eventuele foutberichten die getoond worden, zie <a href=#freebsdboot>FreeBSD opstarten</a> voor meer details.</p></div></div><div class=sect3><h4 id=network-services>2.10.15. Extra netwerkdiensten instellen<a class=anchor href=#network-services></a></h4><div class=paragraph><p>Het instellen van netwerkdiensten kan afschrikwekkend zijn voor nieuwe gebruikers zonder (voldoende) voorkennis op dit gebied. Netwerken, inclusief Internet, is van levensbelang voor alle moderne besturingssystemen, inclusief FreeBSD. Als gevolg daarvan is het handig enig begrip te hebben van de uitgebreide netwerkmogelijkheden van FreeBSD. Door dit tijdens de installatie te doen hebben gebruikers in elk geval enige kennis van de diverse netwerkdiensten die hen ter beschikking staan.</p></div><div class=paragraph><p>Netwerkdiensten zijn programma’s die invoer accepteren vanaf het netwerk. Al het mogelijke is gedaan om er voor te zorgen dat deze programma’s niets "schadelijks" doen. Helaas zijn programmeurs niet perfect en in de loop van de tijd zijn er fouten gevonden in netwerkdiensten die door aanvallers zijn uitgebuit om slechte dingen te doen. Het is belangrijk alleen netwerkdiensten aan te zetten die nodig zijn. Bij twijfel kan een netwerkdienst het beste niet ingeschakeld worden totdat duidelijk is dat de dienst wél nodig is. Diensten kunnen later alsnog ingeschakeld worden door sysinstall nog een keer te draaien of door middel van de mogelijkheden van het bestand <span class=filename>/etc/rc.conf</span>.</p></div><div class=paragraph><p>Het kiezen van de optie <b class=menuref>Networking</b> toont het volgende menu:</p></div><div id=network-configuration class=imageblock><div class=content><img src=../../../../images/books/handbook/install/net-config-menu1.png alt="net config menu1"></div><div class=title>Figuur 54. Netwerkinstellingen - bovenste opties</div></div><div class=paragraph><p>De eerste optie, <span class=guimenuitem>Interfaces</span>, is al behandeld in <a href=#inst-network-dev>Netwerkapparaten instellen</a>, dus die wordt overgeslagen.</p></div><div class=paragraph><p>Kies <span class=guimenuitem>AMD</span> voor het toevoegen van ondersteuning voor het BSD hulpprogramma voor automatisch mounten. Dit wordt meestal gebruikt in combinatie met het NFS protocol (zie verderop) voor het automatisch mounten van externe bestandssystemen. Hier zijn geen speciale instellingen nodig.</p></div><div class=paragraph><p>De volgende optie is <span class=guimenuitem>AMD Flags</span>. Als deze optie wordt selecteert komt er een pop-up menu waarin de specifieke AMD vlaggen kunnen worden ingesteld. Het menu bevat al een lijst standaardopties:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>-a</span> /.amd_mnt <span class=nt>-l</span> syslog /host /etc/amd.map /net /etc/amd.map</code></pre></div></div><div class=paragraph><p>De optie <code>-a</code> bepaalt de standaard mountlocatie die is hier ingesteld op <span class=filename>/.amd_mnt</span>. De optie <code>-l</code> bepaalt het standaardbestand voor <span class=filename>log</span>, maar als <code>syslogd</code> wordt gebruikt, dan worden alle acties naar de systeemlogdaemon gestuurd. De map <span class=filename>/host</span> wordt gebruikt om een geëxporteerd bestandssysteem van een externe host te mounten, terwijl de map <span class=filename>/net</span> wordt gebruikt om een geëxporteerd bestandssysteem van een IP-adres te mounten. Het bestand <span class=filename>/etc/amd.map</span> bepaalt de standaardopties voor AMD exports.</p></div><div class=paragraph><p>De optie <span class=guimenuitem>Anon FTP</span> staat anonieme FTP verbindingen toe. Kies deze optie om van een machine een anonieme FTP server te maken. Hierbij zijn de beveiligingsimplicaties van belang. Er wordt een volgend menu getoond om de beveiligingsrisico’s en verdere instellingen te verklaren.</p></div><div class=paragraph><p>Het instellingenmenu <span class=guimenuitem>Gateway</span> maakt van de machine een gateway, zoals eerder beschreven. Hier kan de optie <span class=guimenuitem>Gateway</span> ook gebruikt worden om de optie uit te zetten als die eerder in de installatie per ongeluk is aangezet.</p></div><div class=paragraph><p>De optie <span class=guimenuitem>Inetd</span> kan gebruikt worden om de <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> daemon in te stellen of helemaal uit te schakelen, zoals boven beschreven.</p></div><div class=paragraph><p>De optie <span class=guimenuitem>Mail</span> kan gebruikt worden om de standaard MTA (Mail Transfer Agent) van het systeem in te stellen. Hiervoor wordt het volgende menu gebruikt:</p></div><div id=mta-selection class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mta-main.png alt="mta main"></div><div class=title>Figuur 55. Standaard MTA kiezen</div></div><div class=paragraph><p>Hier kan gekozen worden welke MTA moet worden geïnstalleerd en gebruikt. Een MTA is niets meer dan een mailserver die mail aflevert bij gebruikers op het systeem of op Internet.</p></div><div class=paragraph><p>Het kiezen van <span class=guimenuitem>Sendmail</span> installeert de populaire server sendmail, die de standaard is voor FreeBSD. De optie <span class=guimenuitem>Sendmail local</span> maakt van sendmail de standaard MTA, maar zet de mogelijkheid om mail te ontvangen vanaf het Internet uit. De andere opties, <span class=guimenuitem>Postfix</span> en <span class=guimenuitem>Exim</span> werken net zo als <span class=guimenuitem>Sendmail</span>. Allebei leveren ze mail af. Sommige gebruikers geven de voorkeur aan deze alternatieven boven de sendmailMTA.</p></div><div class=paragraph><p>Na het kiezen van een MTA of de keuze geen MTA te installeren, verschijnt het menu netwerkinstellingen met als volgende optie <span class=guimenuitem>NFS client</span>.</p></div><div class=paragraph><p>De optie <span class=guimenuitem>NFS client</span> stelt het systeem in om te communiceren met een server via NFS. Een NFS server stelt bestandssystemen beschikbaar aan andere machines via het NFS protocol. Als de te installeren machine een op zichzelf staande machine is, dan kan deze optie uitgeschakeld blijven. Het kan zijn dat het systeem later meer instellingen nodig heeft. In <a href=./#network-nfs>Netwerkbestandssysteem (NFS)</a> staat meer informatie over client- en serverinstellingen.</p></div><div class=paragraph><p>De volgende optie is <span class=guimenuitem>NFS server</span>, die het mogelijk maakt een systeem in te stellen als NFS server. Deze optie voegt de nodige informatie toe om de dienst RPC, "remote procedure call", op te starten. RPC wordt gebruikt om de verbindingen tussen hosts en programma’s te coördineren.</p></div><div class=paragraph><p>Daarna volgt de optie <span class=guimenuitem>Ntpdate</span> die de tijdsynchronisatie afhandelt. Als deze wordt geselecteerd verschijnt het volgende menu:</p></div><div id=Ntpdate-config class=imageblock><div class=content><img src=../../../../images/books/handbook/install/ntp-config.png alt="ntp config"></div><div class=title>Figuur 56. Ntpdate instellingen</div></div><div class=paragraph><p>Kies uit dit menu de server die het dichtst bij het te installeren systeem staat. Door het kiezen van een server in de buurt is de synchronisatie preciezer omdat een verder gelegen server meer vertraging in de verbinding kan hebben.</p></div><div class=paragraph><p>De volgende optie is de PCNFSD selectie. Deze optie installeert het pakket <a class=package href=https://cgit.freebsd.org/ports/tree/net/pcnfsd/>net/pcnfsd</a> uit de Portscollectie. Dat is een handig hulpprogramma dat het mogelijk maakt om aan te melden bij NFS met systemen die zelf geen aanmeldsysteem hebben, zoals het besturingssysteem MS-DOS® van Microsoft®.</p></div><div class=paragraph><p>Door naar beneden te scrollen in het hoofdmenu worden de onderstaande opties zichtbaar:</p></div><div id=Network-configuration-cont class=imageblock><div class=content><img src=../../../../images/books/handbook/install/net-config-menu2.png alt="net config menu2"></div><div class=title>Figuur 57. Netwerkinstellingen - onderste opties</div></div><div class=paragraph><p>De hulpprogramma’s <a href="https://man.freebsd.org/cgi/man.cgi?query=rpcbind&amp;sektion=8&amp;format=html">rpcbind(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.statd&amp;sektion=8&amp;format=html">rpc.statd(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.lockd&amp;sektion=8&amp;format=html">rpc.lockd(8)</a> worden allemaal gebruikt voor "Remote Procedure Calls" (RPC). Het hulpprogramma <code>rpcbind</code> beheert de communicatie tussen NFS servers en clients en is noodzakelijk om NFS servers correct te laten werken. De daemon rpc.statd communiceert met de daemon rpc.statd op andere machines om statusinformatie te leveren. De gerapporteerde status wordt gewoonlijk bijgehouden in het bestand <span class=filename>/var/db/statd.status</span>. De volgende optie in de lijst is <span class=guimenuitem>rpc.lockd</span> die, mits geselecteerd, bestandslockdiensten mogelijk maakt. Dit wordt meestal gebruikt door rpc.statd om bij te houden welke hosts vragen om bestanden te locken en hoe vaak ze dat doen. Hoewel deze laatste twee opties fantastisch zijn om fouten om te sporen, zijn ze niet noodzakelijk voor NFS servers en clients om correct te werken.</p></div><div class=paragraph><p>De dan volgende optie in de lijst is <span class=guimenuitem>Routed</span>, een routeringsdaemon. Het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=routed&amp;sektion=8&amp;format=html">routed(8)</a> beheert netwerkrouteringstabellen, ontdekt "multicast" routers en stelt op verzoek kopieën van de routeringstabellen ter beschikking aan fysiek verbonden apparaten. Dit wordt vooral gebruikt door machines die dienst doen als gateway voor het lokale netwerk. Na het selecteren van deze optie verschijnt een menu waarin naar de standaardlocatie van het hulpprogramma wordt gevraagd. De standaardlocatie is al gedefiniëerd en kan met <kbd>Enter</kbd> worden geactiveerd. Dan komt er een ander menu dat vraagt om de opties die doorgegeven moeten worden aan routed op te geven. De standaard is <code>-q</code> en die staat al op het scherm.</p></div><div class=paragraph><p>Dan volgt de optie <span class=guimenuitem>Rwhod</span> die, als geselecteerd, de daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=rwhod&amp;sektion=8&amp;format=html">rwhod(8)</a> inschakelt bij het opstarten. Het hulpprogramma <code>rwhod</code> zendt periodiek systeemberichten uit over het netwerk of verzamelt die in de modus "consumer". Meer informatie staat in de hulppagina’s <a href="https://man.freebsd.org/cgi/man.cgi?query=ruptime&amp;sektion=1&amp;format=html">ruptime(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=rwho&amp;sektion=1&amp;format=html">rwho(1)</a>.</p></div><div class=paragraph><p>De één na laatste optie in de lijst is de daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a>. Dat is de "secure shell server" van OpenSSH en deze wordt sterk aangeraden boven de standaardservers telnet en FTP. De server sshd wordt gebruikt om een veilige verbinding op te zetten van de ene computer naar de andere door een versleutelde verbinding te gebruiken.</p></div><div class=paragraph><p>Tenslotte is er de optie <span class=guimenuitem>TCP Extensions</span>. Dit schakelt TCP uitbreidingen in zoals gedefiniëerd in RFC 1323 en RFC 1644. Hoewel dit op veel machines de verbindingen kan versnellen, kan het ook de oorzaak zijn van het wegvallen van sommige verbindingen. Het wordt niet aangeraden voor servers, maar voor alleenstaande machines kan het voordelig zijn.</p></div><div class=paragraph><p>Nu de netwerkmogelijkheden zijn ingesteld kan het menu via <span class=guimenuitem>Exit</span> verlaten worden en doorgegaan worden met het instellen in de volgende sectie.</p></div></div><div class=sect3><h4 id=freebsdboot>2.10.16. FreeBSD opstarten<a class=anchor href=#freebsdboot></a></h4><div class=sect4><h5 id=freebsdboot-i386>2.10.16.1. FreeBSD/i386 opstarten<a class=anchor href=#freebsdboot-i386></a></h5><div class=paragraph><p>Als alles goed is gegaan komen er berichten over het scherm rollen en komt dit uit bij de aanmeldprompt. De inhoud van de berichten kan bekeken worden door te drukken op <kbd>Scroll-Lock</kbd> en dan met <kbd>PgUp</kbd> en <kbd>PgDn</kbd> door de tekst heen te lopen. Druk weer op <kbd>Scroll-Lock</kbd> om terug te gaan naar de prompt.</p></div><div class=paragraph><p>Het kan zijn dat het totale bericht niet getoond kan worden (beperking van de buffer). Dan kunnen de berichten later bekeken worden op de commandoregel door na het aanmelden <code>dmesg</code> in te geven op de prompt.</p></div><div class=paragraph><p>Meld aan met de gebruikersnaam en het wachtwoord die zijn aangemaakt tijdens de installatie (in dit voorbeeld <code>rpratt</code>). Vermijd het aanmelden als <code>root</code>, behalve als het noodzakelijk is.</p></div><div class=paragraph><p>Gebruikelijke opstartberichten (versie-informatie verwijderd):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Copyright <span class=o>(</span>c<span class=o>)</span> 1992-2002 The FreeBSD Project.
Copyright <span class=o>(</span>c<span class=o>)</span> 1979, 1980, 1983, 1986, 1988, 1989, 1991, 1992, 1993, 1994
        The Regents of the University of California. All rights reserved.

Timecounter <span class=s2>&#34;i8254&#34;</span>  frequency 1193182 Hz
CPU: AMD-K6<span class=o>(</span>tm<span class=o>)</span> 3D processor <span class=o>(</span>300.68-MHz 586-class CPU<span class=o>)</span>
  Origin <span class=o>=</span> <span class=s2>&#34;AuthenticAMD&#34;</span>  Id <span class=o>=</span> 0x580  Stepping <span class=o>=</span> 0
  <span class=nv>Features</span><span class=o>=</span>0x8001bf&lt;FPU,VME,DE,PSE,TSC,MSR,MCE,CX8,MMX&gt;
  AMD <span class=nv>Features</span><span class=o>=</span>0x80000800&lt;SYSCALL,3DNow!&gt;
real memory  <span class=o>=</span> 268435456 <span class=o>(</span>262144K bytes<span class=o>)</span>
config&gt; di sn0
config&gt; di lnc0
config&gt; di le0
config&gt; di ie0
config&gt; di fe0
config&gt; di cs0
config&gt; di bt0
config&gt; di aic0
config&gt; di aha0
config&gt; di adv0
config&gt; q
avail memory <span class=o>=</span> 256311296 <span class=o>(</span>250304K bytes<span class=o>)</span>
Preloaded elf kernel <span class=s2>&#34;kernel&#34;</span> at 0xc0491000.
Preloaded userconfig_script <span class=s2>&#34;/boot/kernel.conf&#34;</span> at 0xc049109c.
md0: Malloc disk
Using <span class=nv>$PIR</span> table, 4 entries at 0xc00fde60
npx0: &lt;math processor&gt; on motherboard
npx0: INT 16 interface
pcib0: &lt;Host to PCI bridge&gt; on motherboard
pci0: &lt;PCI bus&gt; on pcib0
pcib1: &lt;VIA 82C598MVP <span class=o>(</span>Apollo MVP3<span class=o>)</span> PCI-PCI <span class=o>(</span>AGP<span class=o>)</span> bridge&gt; at device 1.0 on pci0
pci1: &lt;PCI bus&gt; on pcib1
pci1: &lt;Matrox MGA G200 AGP graphics accelerator&gt; at 0.0 irq 11
isab0: &lt;VIA 82C586 PCI-ISA bridge&gt; at device 7.0 on pci0
isa0: &lt;ISA bus&gt; on isab0
atapci0: &lt;VIA 82C586 ATA33 controller&gt; port 0xe000-0xe00f at device 7.1 on pci0
ata0: at 0x1f0 irq 14 on atapci0
ata1: at 0x170 irq 15 on atapci0
uhci0: &lt;VIA 83C572 USB controller&gt; port 0xe400-0xe41f irq 10 at device 7.2 on pci0
usb0: &lt;VIA 83C572 USB controller&gt; on uhci0
usb0: USB revision 1.0
uhub0: VIA UHCI root hub, class 9/0, rev 1.00/1.00, addr 1
uhub0: 2 ports with 2 removable, self powered
chip1: &lt;VIA 82C586B ACPI interface&gt; at device 7.3 on pci0
ed0: &lt;NE2000 PCI Ethernet <span class=o>(</span>RealTek 8029<span class=o>)&gt;</span> port 0xe800-0xe81f irq 9 at
device 10.0 on pci0
ed0: address 52:54:05:de:73:1b, <span class=nb>type </span>NE2000 <span class=o>(</span>16 bit<span class=o>)</span>
isa0: too many dependant configs <span class=o>(</span>8<span class=o>)</span>
isa0: unexpected small tag 14
fdc0: &lt;NEC 72065B or clone&gt; at port 0x3f0-0x3f5,0x3f7 irq 6 drq 2 on isa0
fdc0: FIFO enabled, 8 bytes threshold
fd0: &lt;1440-KB 3.5<span class=s2>&#34; drive&gt; on fdc0 drive 0
atkbdc0: &lt;keyboard controller (i8042)&gt; at port 0x60-0x64 on isa0
atkbd0: &lt;AT Keyboard&gt; flags 0x1 irq 1 on atkbdc0
kbd0 at atkbd0
psm0: &lt;PS/2 Mouse&gt; irq 12 on atkbdc0
psm0: model Generic PS/2 mouse, device ID 0
vga0: &lt;Generic ISA VGA&gt; at port 0x3c0-0x3df iomem 0xa0000-0xbffff on isa0
sc0: &lt;System console&gt; at flags 0x1 on isa0
sc0: VGA &lt;16 virtual consoles, flags=0x300&gt;
sio0 at port 0x3f8-0x3ff irq 4 flags 0x10 on isa0
sio0: type 16550A
sio1 at port 0x2f8-0x2ff irq 3 on isa0
sio1: type 16550A
ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset (ECP/EPP/PS2/NIBBLE) in COMPATIBLE mode
ppc0: FIFO with 16/16/15 bytes threshold
ppbus0: IEEE1284 device found /NIBBLE
Probing for PnP devices on ppbus0:
plip0: &lt;PLIP network interface&gt; on ppbus0
lpt0: &lt;Printer&gt; on ppbus0
lpt0: Interrupt-driven port
ppi0: &lt;Parallel I/O&gt; on ppbus0
ad0: 8063MB &lt;IBM-DHEA-38451&gt; [16383/16/63] at ata0-master using UDMA33
ad2: 8063MB &lt;IBM-DHEA-38451&gt; [16383/16/63] at ata1-master using UDMA33
acd0: CDROM &lt;DELTA OTC-H101/ST3 F/W by OIPD&gt; at ata0-slave using PIO4
Mounting root from ufs:/dev/ad0s1a
swapon: adding /dev/ad0s1b as swap device
Automatic boot in progress...
/dev/ad0s1a: FILESYSTEM CLEAN; SKIPPING CHECKS
/dev/ad0s1a: clean, 48752 free (552 frags, 6025 blocks, 0.9% fragmentation)
/dev/ad0s1f: FILESYSTEM CLEAN; SKIPPING CHECKS
/dev/ad0s1f: clean, 128997 free (21 frags, 16122 blocks, 0.0% fragmentation)
/dev/ad0s1g: FILESYSTEM CLEAN; SKIPPING CHECKS
/dev/ad0s1g: clean, 3036299 free (43175 frags, 374073 blocks, 1.3% fragmentation)
/dev/ad0s1e: filesystem CLEAN; SKIPPING CHECKS
/dev/ad0s1e: clean, 128193 free (17 frags, 16022 blocks, 0.0% fragmentation)
Doing initial network setup: hostname.
ed0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
        inet6 fe80::5054::5ff::fede:731b%ed0 prefixlen 64 tentative scopeid 0x1
        ether 52:54:05:de:73:1b
lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 16384
        inet6 fe80::1%lo0 prefixlen 64 scopeid 0x8
        inet6 ::1 prefixlen 128
        inet 127.0.0.1 netmask 0xff000000
Additional routing options: IP gateway=YES TCP keepalive=YES
routing daemons:.
additional daemons: syslogd.
Doing additional network setup:.
Starting final network daemons: creating ssh RSA host key
Generating public/private rsa1 key pair.
Your identification has been saved in /etc/ssh/ssh_host_key.
Your public key has been saved in /etc/ssh/ssh_host_key.pub.
The key fingerprint is:
cd:76:89:16:69:0e:d0:6e:f8:66:d0:07:26:3c:7e:2d root@k6-2.example.com
 creating ssh DSA host key
Generating public/private dsa key pair.
Your identification has been saved in /etc/ssh/ssh_host_dsa_key.
Your public key has been saved in /etc/ssh/ssh_host_dsa_key.pub.
The key fingerprint is:
f9:a1:a9:47:c4:ad:f9:8d:52:b8:b8:ff:8c:ad:2d:e6 root@k6-2.example.com.
setting ELF ldconfig path: /usr/lib /usr/lib/compat /usr/X11R6/lib
/usr/local/lib
a.out ldconfig path: /usr/lib/aout /usr/lib/compat/aout /usr/X11R6/lib/aout
starting standard daemons: inetd cron sshd usbd sendmail.
Initial rc.i386 initialization:.
rc.i386 configuring syscons: blank_time screensaver moused.
Additional ABI support: linux.
Local package initialization:.
Additional TCP options:.

FreeBSD/i386 (k6-2.example.com) (ttyv0)

login: rpratt
Password:</span></code></pre></div></div><div class=paragraph><p>Het aanmaken van de RSA en DSA sleutels kan een tijdje duren op langzamere machines. Dit gebeurt alleen bij de eerste keer aanmelden na een nieuwe installatie. De volgende keren gaan sneller.</p></div><div class=paragraph><p>Als de X-server ingesteld is en er een standaard desktop is gekozen, dan kan die worden gestart door <code>startx</code> in te geven op de commandoregel.</p></div></div></div><div class=sect3><h4 id=shutdown>2.10.17. FreeBSD uitschakelen<a class=anchor href=#shutdown></a></h4><div class=paragraph><p>Het is belangrijk om het besturingssysteem op de juiste manier uit te schakelen. Schakel niet gewoon de stroom uit. Neem eerst de rol van superuser aan door <code>su</code> in te geven op de commandoregel en het <code>root</code> wachtwoord in te geven. Dit kan alleen als gebruiker die lid is van de groep <code>wheel</code>. Anders moet eerst worden aangemeld als <code>root</code>. Gebruik <code>shutdown -h now</code> om het systeem uit te schakelen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>The operating system has halted.
Please press any key to reboot.</code></pre></div></div><div class=paragraph><p>Het is veilig om de stroom uit te schakelen als na het commando <code>shutdown</code> het bericht "Please press any key to reboot" getoond wordt. Als een toets wordt ingedrukt in plaats van het uitschakelen van de stroom, dan start het systeem opnieuw.</p></div><div class=paragraph><p>De combinatie <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Del</kbd></span> kan ook gebruikt worden om het systeem te herstarten, maar dit wordt niet aangeraden tijdens normaal gebruik.</p></div></div></div><div class=sect2><h3 id=install-trouble>2.11. Problemen oplossen<a class=anchor href=#install-trouble></a></h3><div class=paragraph><p>Dit onderdeel behandelt het oplossen van installatieproblemen, zoals veel voorkomende problemen die gebruikers hebben gerapporteerd. Er is ook een aantal vragen en antwoorden voor mensen die een systeem willen hebben met zowel FreeBSD als MS-DOS® of Windows® (dual-boot).</p></div><div class=sect3><h4 id=_wat_als_er_iets_misgaat>2.11.1. Wat als er iets misgaat?<a class=anchor href=#_wat_als_er_iets_misgaat></a></h4><div class=paragraph><p>Door de beperkingen van de PC-architectuur is het onmogelijk om 100% betrouwbaar een hardware-onderzoek te doen, maar er zijn een paar dingen die wel gedaan kunnen worden in geval van storingen.</p></div><div class=paragraph><p>Controleer het <a href=http://www.FreeBSD.org/releases/>Hardware Notes</a> document voor uw versie van FreeBSD om er zeker van te zijn dat de hardware ondersteund wordt.</p></div><div class=paragraph><p>Als de hardware wordt ondersteund, maar het systeem loopt nog steeds vast of heeft andere problemen, dient u een <a href=./#kernelconfig>eigen kernel</a> te bouwen. Dit maakt het mogelijk om ondersteuning voor apparaten toe te voegen de niet in de <span class=filename>GENERIC</span> kernel zitten. De kernel op de opstartschijven gaat er vanuit dat de hardware ingesteld is op de fabrieksinstellingen wat betreft IRQ’s, IO adressen en DMA kanalen. Als de hardware anders is ingesteld, dan moet waarschijnlijk de instellingeneditor gebruikt worden om FreeBSD te vertellen waar de apparaten te vinden zijn.</p></div><div class=paragraph><p>Het is ook mogelijk dat een onderzoek naar een apparaat dat niet aanwezig is een probleem veroorzaakt bij een later onderzoek naar een ander apparaat dat er wel is. In dat geval moet het conflicterende stuurprogramma uitgeschakeld worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige installatieproblemen kunnen voorkomen of verminderd worden door de firmware op de diverse hardwarecomponenten bij te werken, zeker als het om het moederbord gaat. De firmware voor een moederbord wordt ook aangeduid als het BIOS en de meeste moederbord- en computerfabrikanten hebben een website waar upgrades en upgrade-informatie beschikbaar is.</p></div><div class=paragraph><p>De meeste fabrikanten raden sterk af om het BIOS te upgraden, tenzij er een goede reden voor is, zoals bijvoorbeeld een kritische update. Het upgradeproces <em>kan</em> misgaan, wat beschadiging van de BIOS chip kan veroorzaken.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_ms_dos_en_windows_bestandssystemen_gebruiken>2.11.2. MS-DOS® en Windows® bestandssystemen gebruiken<a class=anchor href=#_ms_dos_en_windows_bestandssystemen_gebruiken></a></h4><div class=paragraph><p>FreeBSD ondersteunt geen bestandssystemen die gecomprimeerd zijn met het programma Double Space™. Daarom moet het bestandssysteem eerst gedecomprimeerd worden voordat FreeBSD de gegevens kan benaderen. Dit kan met de Compression Agent, te vinden in het menu <span class=guimenuitem>Start</span>> <span class=guimenuitem>Programma’s</span> > <span class=guimenuitem>Bureau-accessoires</span> > <span class=guimenuitem>Systeemwerkset</span>.</p></div><div class=paragraph><p>FreeBSD kan MS-DOS® gebaseerde bestandssystemen (soms FAT bestandssystemen genoemd) ondersteunen. Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> plaatst zulke bestandssystemen in de bestaande maphierarchie, waardoor de inhoud van het bestandssysteem benaderd kan worden. Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> wordt normaliter niet direct gebruikt; in plaats hiervan wordt het aangeroepen door een regel in <span class=filename>/etc/fstab</span> of door een aanroep van het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> met de juiste parameters.</p></div><div class=paragraph><p>Een typische regel in <span class=filename>/etc/fstab</span> is:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ad0sN  /dos  msdosfs rw  0  0</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De map <span class=filename>/dos</span> moet reeds bestaan om dit te laten werken. Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> voor details over het formaat van <span class=filename>/etc/fstab</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Een typische aanroep naar <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> voor een MS-DOS® bestandssysteem ziet er uit als:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t msdosfs /dev/ad0s1 /mnt</span></code></pre></div></div><div class=paragraph><p>In dit voorbeeld staat het MS-DOS® bestandssysteem op de eerste partitie van de primaire harde schijf. Iedere situatie kan anders zijn, dus controleer de uitvoer van de commando’s <code>dmesg</code> en <code>mount</code>. Dat zou voldoende informatie moeten leveren om een idee te vormen over het partitieschema.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>FreeBSD kan schijfstukken (dat zijn MS-DOS® partities) anders nummeren dan andere besturingssystemen. In het bijzonder krijgen extended MS-DOS® partities gewoonlijk hogere schijfstuknummers dan primaire MS-DOS® partities. Het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> kan helpen te bepalen welke schijfstukken bij FreeBSD en welke bij andere besturingssystemen horen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>NTFS-partities kunnen op soortgelijke manier aangekoppeld worden met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_ntfs&amp;sektion=8&amp;format=html">mount_ntfs(8)</a>.</p></div></div><div class=sect3><h4 id=_vragen_en_antwoorden_bij_het_oplossen_van_problemen>2.11.3. Vragen en antwoorden bij het oplossen van problemen<a class=anchor href=#_vragen_en_antwoorden_bij_het_oplossen_van_problemen></a></h4><div class=sect4><h5 id=_mijn_systeem_hangt_bij_het_opsporen_van_hardware_tijdens_het_opstarten_of_het_gedraagt_zich_vreemd_tijdens_het_installeren_of_de_floppydrive_wordt_niet_onderzocht>2.11.3.1. Mijn systeem hangt bij het opsporen van hardware tijdens het opstarten, of het gedraagt zich vreemd tijdens het installeren, of de floppydrive wordt niet onderzocht.<a class=anchor href=#_mijn_systeem_hangt_bij_het_opsporen_van_hardware_tijdens_het_opstarten_of_het_gedraagt_zich_vreemd_tijdens_het_installeren_of_de_floppydrive_wordt_niet_onderzocht></a></h5><div class=paragraph><p>FreeBSD maakt veelvuldig gebruik van de ACPI-diensten van het systeem op de i386, amd64 en ia64 platformen bij het helpen van de systeemconfiguratie als het tijdens het opstarten is gedetecteerd. Helaas bestaan er nog enkele bugs in zowel het ACPI-stuurprogramma als in sommige systeemmoederborden en BIOSsen. ACPI kan worden uitgeschakeld door de hint <code>hint.acpi.0.disabled</code> in te stellen in de derde-fase-bootloader:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> <span class=nb>set </span>hint.acpi.0.disabled<span class=o>=</span><span class=s2>&#34;1&#34;</span></code></pre></div></div><div class=paragraph><p>Dit wordt telkens wanneer het systeem opnieuw wordt opgestart teruggezet, dus is het nodig om <code>hint.acpi.0.disabled="1"</code> aan het bestand <span class=filename>/boot/loader.conf</span> toe te voegen. Meer informatie over de bootloader kan worden gevonden in <a href=./#boot-synopsis>Overzicht</a>.</p></div></div><div class=sect4><h5 id=_ik_ga_naar_opstarten_van_harde_schijf_voor_de_eerste_keer_na_het_installeren_van_freebsd_de_kernel_laadt_en_onderzoekt_mijn_hardware_maar_stopt_met_berichten_zoals_deze>2.11.3.2. Ik ga naar opstarten van harde schijf voor de eerste keer na het installeren van FreeBSD, de kernel laadt en onderzoekt mijn hardware, maar stopt met berichten zoals deze:<a class=anchor href=#_ik_ga_naar_opstarten_van_harde_schijf_voor_de_eerste_keer_na_het_installeren_van_freebsd_de_kernel_laadt_en_onderzoekt_mijn_hardware_maar_stopt_met_berichten_zoals_deze></a></h5><div class=paragraph><p>Er is een langdurig probleem in het geval dat de opstartschijf niet de eerste schijf in het systeem is. Het BIOS gebruikt een ander nummeringsschema dan FreeBSD, en uitzoeken welke nummers met welke overeenkomen is lastig goed te krijgen.</p></div><div class=paragraph><p>In het geval dat de opstartschijf niet de eerste schijf in het systeem is, kan FreeBSD wel wat hulp gebruiken om het te vinden. Er zijn hier twee bekende situaties, en in beide gevallen dient u FreeBSD te vertellen waar het root-bestandssysteem zich bevindt. U kunt dit doen door het BIOS schijfnummer te specificeren, het soort schijf en het FreeBSD schijfnummer voor die soort.</p></div><div class=paragraph><p>De eerste situatie is wanneer u twee IDE-schijven heeft, elk geconfigureerd als de meester op hun respectievelijke IDE-bus, en u FreeBSD wilt opstarten vanaf de tweede schijf. Het BIOS ziet dit als schijf 0 en schijf 1, terwijl FreeBSD ze als <span class=filename>ad0</span> en <span class=filename>ad2</span>.</p></div><div class=paragraph><p>FreeBSD staat op BIOS schijf 1, van het soort <code>ad</code> en het FreeBSD schijfnummer is 2, dus geldt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> 1:ad<span class=o>(</span>2,a<span class=o>)</span>kernel</code></pre></div></div><div class=paragraph><p>Merk op dat indien u een slaaf op de primaire bus heeft, bovenstaande niet nodig is (en effectief onjuist is).</p></div><div class=paragraph><p>De tweede situatie is omvat opstarten van een SCSI-schijf wanneer u één of meer IDE-schijven in het systeem heeft. In dit geval is het FreeBSD schijfnummer lager dan het BIOS schijfnummer. Als u twee IDE-schijven alsook de SCSI-schijf heeft, dan is de SCSI-schijf BIOS schijf 2, soort <code>da</code> en FreeBSD schijfnummer 0, dus geldt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> 2:da<span class=o>(</span>0,a<span class=o>)</span>kernel</code></pre></div></div><div class=paragraph><p>wanneer u FreeBSD wilt vertellen dat u van BIOS schijf 2 wilt opstarten, welke de eerste SCSI-schijf in het systeem is. Als u slechts één IDE-schijf had, zou <code>1:</code> gegolden hebben.</p></div><div class=paragraph><p>Wanneer u de juiste waardes heeft bepaald om te gebruiken, kunt u het commando precies zoals u het zou typen in het bestand <span class=filename>/boot.config</span> plaatsen met een standaard tekstverwerker. Tenzij anders geïnstrueerd, gebruikt FreeBSD de inhoud van dit bestand als het standaardantwoord op de prompt <code>boot:</code>.</p></div></div><div class=sect4><h5 id=_ik_ga_naar_opstarten_van_harde_schijf_voor_de_eerste_keer_na_de_installatie_van_freebsd_maar_de_prompt_van_de_boot_manager_geeft_telkens_alleen_f_weer_in_het_opstartmenu_maar_het_opstarten_gaat_niet_verder>2.11.3.3. Ik ga naar opstarten van harde schijf voor de eerste keer na de installatie van FreeBSD, maar de prompt van de Boot Manager geeft telkens alleen F? weer in het opstartmenu maar het opstarten gaat niet verder.<a class=anchor href=#_ik_ga_naar_opstarten_van_harde_schijf_voor_de_eerste_keer_na_de_installatie_van_freebsd_maar_de_prompt_van_de_boot_manager_geeft_telkens_alleen_f_weer_in_het_opstartmenu_maar_het_opstarten_gaat_niet_verder></a></h5><div class=paragraph><p>De geometrie van de harde schijf was verkeerd ingesteld in de partitiebewerker toen u FreeBSD installeerde. Ga terug naar de partitiebewerker en specificeer de eigenlijke geometrie van uw harde schijf. U moet FreeBSD weer van het begin af herinstalleren met de juiste geometrie.</p></div><div class=paragraph><p>Als u geheel faalt in het bepalen van de juiste geometrie van uw machine, is hier een tip: Installeer een kleine MS-DOS® partitie aan het begin van de schijf en installeer FreeBSD na die partitie. Het installatieprogramma zal de MS-DOS® partitie zien en proberen de juiste geometrie er uit af te leiden, wat gewoonlijk werkt.</p></div><div class=paragraph><p>De volgende tip wordt niet meer aangeraden, maar is hier achtergelaten ter referentie:</p></div><div class="paragraph blockquote"><p>Als u een echt toegewijde FreeBSD server of werkstation installeert waar u geen (toekomstige) compatibiliteit met MS-DOS®, Linux of een ander besturingssysteem wilt, heeft u ook de mogelijkheid om de gehele schijf (<span class=guimenuitem>A</span> in de partitiebewerker) te gebruiken, de niet-standaard optie selecterende waarbij FreeBSD de gehele schijf van de allereerste tot de allerlaatste sector beslaat. Dit laat alle geometrieoverwegingen buiten beschouwing, maar is wat beperkend tenzij u nooit iets anders dan FreeBSD op een schijf gaat draaien.</p></div></div><div class=sect4><h5 id=_het_systeem_vindt_mijn_ed4_netwerkkaart_maar_ik_blijf_apparaat_timeout_fouten_krijgen>2.11.3.4. Het systeem vindt mijn <a href="https://man.freebsd.org/cgi/man.cgi?query=ed&amp;sektion=4&amp;format=html">ed(4)</a> netwerkkaart, maar ik blijf apparaat-timeout-fouten krijgen.<a class=anchor href=#_het_systeem_vindt_mijn_ed4_netwerkkaart_maar_ik_blijf_apparaat_timeout_fouten_krijgen></a></h5><div class=paragraph><p>Uw kaart zit waarschijnlijk op een andere IRQ dan wat is gespecificeerd in het bestand <span class=filename>/boot/device.hints</span>. Het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ed&amp;sektion=4&amp;format=html">ed(4)</a> gebruikt standaard niet de "soft"-configuratie (waardes gegeven met EZSETUP in MS-DOS®), maar het zal de softwareconfiguratie gebruiken wanneer u <code>-1</code> specificeert in de hints voor de interface.</p></div><div class=paragraph><p>Verplaats òf de jumper op de kaart naar een vaste configuratie-instelling (pas indien nodig de kernelinstellingen aan), òf specificeer het IRQ als <code>-1</code> door de hint <code>hint.ed.0.irq="-1"</code> in te stellen. Dit vertelt de kernel om de softconfiguratie te gebruiken.</p></div><div class=paragraph><p>Een andere mogelijkheid is dat uw kaart op IRQ 9 zit, welke gedeeld is met IRQ 2 en vaak een bron van problemen is (al helemaal wanneer u een VGA-kaart heeft die IRQ 2 gebruikt!). U dient IRQ 2 en 9 te vermijden indien mogelijk.</p></div></div><div class=sect4><h5 id=_wanneer_sysinstall_in_een_x11_terminal_wordt_gebruikt_is_het_moeilijk_om_het_gele_font_op_de_lichtgrijze_achtergrond_te_lezen_is_er_een_manier_om_het_contrast_kleurcontrast_van_deze_applicatie_te_verhogen>2.11.3.5. Wanneer sysinstall in een X11-terminal wordt gebruikt, is het moeilijk om het gele font op de lichtgrijze achtergrond te lezen. Is er een manier om het contrast kleurcontrast van deze applicatie te verhogen?<a class=anchor href=#_wanneer_sysinstall_in_een_x11_terminal_wordt_gebruikt_is_het_moeilijk_om_het_gele_font_op_de_lichtgrijze_achtergrond_te_lezen_is_er_een_manier_om_het_contrast_kleurcontrast_van_deze_applicatie_te_verhogen></a></h5><div class=paragraph><p>Als X11 reeds geïnstalleerd is en de kleuren die standaard door sysinstall worden gekozen de tekst onleesbaar maken wanneer <a href="https://man.freebsd.org/cgi/man.cgi?query=xterm&amp;sektion=1&amp;format=html">xterm(1)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=rxvt&amp;sektion=1&amp;format=html">rxvt(1)</a> wordt gebruikt, voeg dan het volgende aan <span class=filename>~/.Xdefaults</span> toe om een donkerder grijs als achtergrond te krijgen: <code>XTerm*color7: #c0c0c0</code></p></div></div></div></div><div class=sect2><h3 id=install-advanced>2.12. Installeren voor gevorderden<a class=anchor href=#install-advanced></a></h3><div class=paragraph><p>In dit onderdeel wordt het installeren van FreeBSD in bijzondere situaties beschreven.</p></div><div class=sect3><h4 id=headless-install>2.12.1. FreeBSD installeren op een systeem zonder monitor of toetsenbord<a class=anchor href=#headless-install></a></h4><div class=paragraph><p>Dit type installatie heet ook wel een "headless install", omdat de met FreeBSD te installeren machine of geen monitor heeft aangesloten of zelfs geen VGA-uitvoer heeft. Hoe is dat mogelijk, kan de vraag zijn. Dat kan met een seriële console. Een seriële console is gewoonweg een andere machine die optreedt als monitor en toetsenbord voor een systeem. Om dit te doen moet eerst een installatie-USB-stick worden gemaakt, zoals uitgelegd is in <a href=#install-boot-media>Opstartmedia aanmaken</a> of het juiste ISO-image voor de installatie worden gedownloadt (zie <a href=#install-cdrom>Installatie CD-ROM maken</a>).</p></div><div class=paragraph><p>Volg de volgende stappen om de media te wijzigen om in een seriële console op te starten (voor een CD-ROM kan de eerste stap worden overgeslagen):</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Installatie-USB-stick geschikt maken voor een seriële console</p><div class=paragraph><p>Als wordt opgestart van de zojuist gemaakt USB-stick, start FreeBSD op in de normale installatiemodus. FreeBSD moet echter opstarten naar een seriële console voor de installatie. Om dit te regelen moet de USB-stick gekoppeld worden aan het FreeBSD systeem met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/da0a /mnt</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Pas het apparaat en het koppelpunt aan uw situatie aan.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Nu dat de stick is aangekoppeld, moet deze ingesteld worden om in een seriële toestand op te starten. Aan het bestand <span class=filename>loader.conf</span> van het bestandssysteem van de USB-stick een regel worden toegevoegd dat de seriële console instelt als de systeemconsole:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;console=&#34;comconsole&#34;&#39; &gt;&gt; /mnt/boot/loader.conf</span></code></pre></div></div><div class=paragraph><p>Nu de USB-stick correct is geconfigureerd, moet deze afgekoppeld worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=umount&amp;sektion=8&amp;format=html">umount(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /mnt</span></code></pre></div></div><div class=paragraph><p>Nu kan de USB-stick worden afgekoppeld en direct naar de derde stap van deze procedure gegaan worden.</p></div></li><li><p>De installatie-CD in staat stellen om in een seriële console op te starten</p><div class=paragraph><p>Als met de CD zou worden opgestart die zojuist van het installatie-ISO-image is gemaakt (zie <a href=#install-cdrom>Installatie CD-ROM maken</a>), dan zou FreeBSD opstarten in de normale installatiemodus. We willen dat FreeBSD voor de installatie opstart in een seriële console. Om dit te doen, moet het ISO-image worden uitgepakt, gewijzigd, en opnieuw worden gegenereerd voordat het op een CD-R wordt gebrandt.</p></div><div class=paragraph><p>Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> om alle bestanden uit te pakken van het installatie-ISO-image, bijvoorbeeld <span class=filename>FreeBSD-12.0-RELEASE-i386-disc1.iso</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /pad/naar/headless-iso</span>
<span class=c># tar -C /pad/naar/headless-iso -pxvf FreeBSD-12.0-RELEASE-i386-disc1.iso</span></code></pre></div></div><div class=paragraph><p>Nu moet het installatiemedium worden ingesteld om in een seriële console op te starten. Aan het bestand <span class=filename>loader.conf</span> van het uitgepakte ISO-image moet een regel worden toegevoegd dat de seriële console als de systeemconsole instelt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;console=&#34;comconsole&#34;&#39; &gt;&gt;</span>
 /pad/naar/headless-iso/boot/loader.conf</code></pre></div></div><div class=paragraph><p>Nu kan er een nieuw ISO-image van het gewijzigde bestandssysteem worden gemaakt. Het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> van de port <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> wordt gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -v -b boot/cdboot -no-emul-boot -r -J -V &#34;Headless_installatie&#34; \</span>
	  <span class=nt>-o</span> Headless-FreeBSD-12.0-RELEASEi386-disc1.iso /pad/naar/headless-iso</code></pre></div></div><div class=paragraph><p>Nu het ISO-image correct is geconfigureerd, kan het met uw favoriete brandprogramma op een CD-R worden gebrandt.</p></div></li><li><p>Null-modem kabel aansluiten</p><div class=paragraph><p>Nu moeten de twee machines verbonden worden met een <a href=./#term-cables-null>null-modem kabel</a>. De kabel kan gewoon aangesloten worden tussen de seriële poorten van de machines. <em>Een gewone seriële kabel werkt niet</em>, er is een null-modem kabel nodig omdat daarin sommige draden kruiselings zijn verbonden.</p></div></li><li><p>Opstarten voor het installeren</p><div class=paragraph><p>Nu is het tijd om te beginnen met installeren. Steek de USB-stick in de machine die headless wordt geïnstalleerd en zet hem aan. Als u een voorbereidde CD-ROM gebruikt, zet dan de machine aan en steek de CD-ROM erin.</p></div></li><li><p>Verbinden met de headless machine</p><div class=paragraph><p>Nu moet verbinding gemaakt worden met die machine met <a href="https://man.freebsd.org/cgi/man.cgi?query=cu&amp;sektion=1&amp;format=html">cu(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -l /dev/cuau0</span></code></pre></div></div><div class=paragraph><p>Gebruik op FreeBSD 7.<em>X</em> het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -l /dev/cuad0</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Dat is alles! De headless machine kan bediend worden via de <code>cu</code> sessie. Het zal de kernel laden en vraagt dan wat voor terminal er gebruikt moeten worden. Selecteer de FreeBSD color console en ga verder met de installatie!</p></div></div></div><div class=sect2><h3 id=install-diff-media>2.13. Aangepaste installatiemedia maken<a class=anchor href=#install-diff-media></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Om herhaling te voorkomen: "FreeBSD-schijf" betekent in deze context een FreeBSD CD-ROM of DVD die gekocht is of zelf is gemaakt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Er kunnen zich situaties voordoen waarin aangepaste FreeBSD installatiemedia en/of bronnen gemaakt moeten worden. Dat kunnen fysieke media zijn zoals een tape of een bron die sysinstall kan gebruiken om bestanden op te halen, zoals een lokale FTP site of een MS-DOS®-partitie.</p></div><div class=paragraph><p>Bijvoorbeeld:</p></div><div class=ulist><ul><li><p>Er zijn veel machines aangesloten op een lokaal netwerk en er is maar één FreeBSD-schijf. Er moet een lokale FTP site gemaakt worden met de inhoud van de FreeBSD schijf en vervolgens gebruiken andere machines die in plaats van steeds naar het Internet te moeten.</p></li><li><p>Er is een FreeBSD-schijf, FreeBSD herkent de CD/DVD-speler niet, maar MS-DOS® / Windows® wel. De FreeBSD installatiebestanden moeten gekopieerd worden naar een MS-DOS® partitie op dezelfde computer en dan moet FreeBSD geïnstalleerd worden met die bestanden.</p></li><li><p>De computer die geïnstalleerd moet worden heeft geen CD/DVD-speler of netwerkkaart, maar kan wel verbonden worden via een "Laplink-achtige" seriële of parallelle kabel met een computer die wel een CD/DVD-speler heeft.</p></li><li><p>Er moet een tape gemaakt worden die gebruikt kan worden om FreeBSD te installeren.</p></li></ul></div><div class=sect3><h4 id=install-cdrom>2.13.1. Installatie CD-ROM maken<a class=anchor href=#install-cdrom></a></h4><div class=paragraph><p>Als onderdeel van elke versie stelt het FreeBSD project tenminste twee CDROM images beschikbaar ("ISO images") per ondersteunde architectuur. Deze images kunnen op een CD-R gebrand worden en dan gebruikt worden om FreeBSD te installeren. Als een CD-schrijver aanwezig is en bandbreedte is goedkoop, dan is dit de makkelijkste manier om FreeBSD te installeren.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>De juiste ISO images downloaden</p><div class=paragraph><p>De ISO images voor iedere versie kunnen worden gedownload van <span class=filename><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/ISO-IMAGES-arch/versie class=bare>ftp://ftp.FreeBSD.org/pub/FreeBSD/ISO-IMAGES-arch/versie</a></span> of de dichtstbijzijnde mirror. Vervang <em>arch</em> en <em>versie</em> door de gewenste waarden.</p></div><div class=paragraph><p>De bovenstaande map bevat meestal de volgende images:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 4. FreeBSD 7.<em>X</em> en 8.<em>X</em> ISO image-namen en verklaring</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Bestandsnaam</th><th class="tableblock halign-left valign-top">Inhoud</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-versie-RELEASE-arch-bootonly.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Met dit CD-image kunt u het installatieproces starten door vanaf een CD-ROM-drive op te starten maar het bevat geen ondersteuning om FreeBSD van de CD zelf te installeren. U dient hiervoor een installatie vanaf het netwerk ( bijvoorbeeld een FTP-server) uit te voeren nadat u van deze CD heeft opgestart.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD-<span class=filename>versie-RELEASE-arch-disc1.iso.gz</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Dit DVD-image bevat alles wat u nodig heeft om het basisgedeelte van FreeBSD te installeren, een verzameling van vooraf gebouwde pakketten, en de documentatie. Het ondersteunt ook het opstarten in een "livefs" gebaseerde reddingsmodus.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-versie-RELEASE-arch-memstick.img</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Dit image kan naar een USB-geheugenstick worden geschreven en gebruikt worden om een installatie uit te voeren op machines die vanaf USB-drives kunnen opstarten. Het ondersteunt ook het opstarten in een "livefs" gebaseerde reddingsmodus. De documentatiepakketten worden geleverd, echter geen andere pakketten. Dit image is niet beschikbaar voor FreeBSD 7.<em>X</em>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-versie-RELEASE-arch-disc1.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Dit CD-image bevat het basisgedeelte van FreeBSD en de documentatiepakketten maar geen andere pakketten.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-versie-RELEASE-arch-disc2.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een CD-image met zoveel mogelijk pakketten van derde partijen als er op de schijf passen. Dit image is niet beschikbaar voor FreeBSD 8.<em>X</em>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD-<span class=filename>versie-RELEASE-arch-disc3.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nog een CD-image met zoveel mogelijk pakketten van derde partijen als op de schijf passen. Dit image is niet beschikbaar voor FreeBSD 8.0 en hoger.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-versie-RELEASE-arch-docs.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De FreeBSD documentatie. Dit beeld is niet beschikbaar voor FreeBSD 8.<em>X</em>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-versie-RELEASE-arch-livefs.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Dit CD-image bevat ondersteuning om in een "livefs" gebaseerde reddingsmodus op te starten maar het ondersteunt niet het installeren van de CD zelf.</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Uitgaven van FreeBSD 7.<em>X</em> voor FreeBSD 7.3 en uitgaven van FreeBSD 8.0 gebruikten een andere naamconventie. Voor de namen van hun ISO-images staat geen <code>FreeBSD-</code>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>U <em>moet</em> òof het <code>bootonly</code> image downloaden, òf het beeldbestand van <code>disc1</code>. Download ze niet allebei, aangezien het beeldbestand <code>disc1</code> alles bevat wat het <code>bootonly</code> image bevat.</p></div><div class=paragraph><p>Gebruik de <code>bootonly</code> ISO als toegang tot Internet goedkoop is. Hiermee kan FreeBSD geïnstalleerd worden, waarna pakketten van derde partijen gedownload en geïnstalleerd kunnen worden via het ports/packages systeem (zie <a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></div><div class=paragraph><p>Gebruik het <code>dvd1</code> image om een uitgave van FreeBSD te installeren en een redelijke hoeveelheid pakketten op de schijf te installeren.</p></div><div class=paragraph><p>De additionele disc images zijn nuttig, maar niet noodzakelijk, zeker niet als er breedband toegang tot Internet is.</p></div></li><li><p>CD’s branden</p><div class=paragraph><p>Daarna moeten de CD images op een schijf gebrand worden. Als dat wordt gedaan op een ander FreeBSD systeem, dan staat in <a href=./#creating-cds>Optische media (CD’s) aanmaken en gebruiken</a> meer informatie (meer in het bijzonder in <a href=./#burncd>burncd</a> en <a href=./#cdrecord>cdrecord</a>).</p></div><div class=paragraph><p>Als de CD’s op een ander platform worden gebrand, gebruik dan de op dat platform beschikbare hulpprogramma’s om een CD-brander aan te sturen. De images zijn samengesteld in het standaard ISO-formaat dat ondersteund wordt door de meeste CD-brandprogramma’s.</p></div></li></ol></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als er interesse is in het bouwen van een aangepaste versie van FreeBSD dan staat hierover informatie in het <a href=https://docs.freebsd.org/en/articles/releng/>Release Engineering artikel</a>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=install-ftp>2.13.2. Een lokale FTP site maken met een FreeBSD-schijf<a class=anchor href=#install-ftp></a></h4><div class=paragraph><p>FreeBSD-schijven zijn op dezelfde manier ingedeeld als de FTP site. Dat maakt het erg gemakkelijk om een lokale FTP site te maken die gebruikt kan worden door andere machines op een netwerk bij het installeren van FreeBSD.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Op de FreeBSD computer die de FTP site bevat moet de CD-ROM in het CD-ROM station zitten en aangekoppeld zijn op <span class=filename>/cdrom</span>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /cdrom</span></code></pre></div></div></li><li><p>Maak een gebruikersaccount voor anonieme FTP toegang in <span class=filename>/etc/passwd</span> het bestand te bewerken met <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> en de volgende regel toe te voegen:</p><div class="literalblock programlisting"><div class=content><pre>ftp:*:99:99::0:0:FTP:/cdrom:/nonexistent</pre></div></div></li><li><p>Zorg ervoor dat de dienst FTP aan staat in <span class=filename>/etc/inetd.conf</span>.</p></li></ol></div></div></div><div class=paragraph><p>Iedereen met een netwerkverbinding naar de machine kan nu als mediumtype FTP kiezen en <code><a href=ftp://de-machine class=bare>ftp://de-machine</a></code> ingeven na het kiezen van "Other" in het menu FTP sites tijdens de installatie.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als de bootmedia (meestal diskettes) voor een FTP client niet precies dezelfde versie hebben als die van de lokale FTP site, dan kan sysinstall de installatie niet volledig afronden. Als de versies niet gelijk zijn, dan kan in het menu <b class=menuref>Options</b> de distributienaam gewijzigd worden in <span class=guimenuitem>any</span>.</p></div></td></tr></tbody></table></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Deze aanpak is in orde voor een machine die aan een lokaal netwerk hangt en beschermd wordt door een firewall. Het aanbieden van FTP-diensten aan andere machines over Internet (en niet alleen het lokale netwerk) stelt een computer bloot aan de aandacht van krakers en andere ongewenste personen. We raden sterk aan om voldoende voorzorgsmaatregelen te nemen als hiervoor wordt gekozen.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_installatiediskettes_maken>2.13.3. Installatiediskettes maken<a class=anchor href=#_installatiediskettes_maken></a></h4><div class=paragraph><p>Als wordt geïnstalleerd met diskettes (we adviseren om dit <em>niet</em> te doen), hetzij vanwege niet ondersteunde hardware of eenvoudigweg omdat de persoon die installeert er op staat dingen op de moeilijkste manier te doen, dan moeten eerst diskettes gemaakt worden voor de installatie.</p></div><div class=paragraph><p>Er zijn minstens zoveel 1.44 MB diskettes nodig als nodig zijn om alle bestanden die in de map <span class=filename>base</span> (basisdistributie) staan op te slaan. Als de diskettes worden gemaakt vanuit MS-DOS®, dan <em>moeten</em> ze geformatteerd worden met het MS-DOS® commando <code>FORMAT</code>. Als Windows® wordt gebruikt, formatteer de schijven dan via de verkenner (rechtermuisklik op <span class=filename>A:</span> en kies dan "Format").</p></div><div class=paragraph><p>Vertrouw voorgeformatteerde schijven <em>niet</em>. Formatteer ze voor de zekerheid opnieuw. Veel door gebruikers gerapporteerde problemen kwamen voort uit het gebruik van verkeerd geformatteerde media, vandaar dat dit punt hier wordt benadrukt.</p></div><div class=paragraph><p>Als de diskettes worden gemaakt op een andere FreeBSD machine is formatteren nog steeds geen slecht idee, hoewel niet op elke diskette een MS-DOS® bestandssysteem nodig is. Met de commando’s <code>bsdlabel</code> en <code>newfs</code> kan er een UFS bestandssysteem op gezet worden, zoals met de volgende commando’s wordt getoond (voor een 3.5" 1.44 MB diskette):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fdformat -f 1440 fd0.1440</span>
<span class=c># bsdlabel -w fd0.1440 floppy3</span>
<span class=c># newfs -t 2 -u 18 -l 1 -i 65536 /dev/fd0</span></code></pre></div></div><div class=paragraph><p>Daarna kunnen ze aangekoppeld en beschreven worden als elk ander bestandssysteem.</p></div><div class=paragraph><p>Nadat de diskettes zijn geformatteerd moeten de bestanden op de diskettes gezet worden. De distributiebestanden zijn opgedeeld in porties zodat vijf stuks gemakkelijk op een ouderwetse 1.44 MB diskette passen. Ga door met alle diskettes en zet zoveel bestanden als mogelijk op elke diskette tot alle distributies op die manier gekopiëerd zijn. Elke distributie moet in een submap op de diskette komen, bijvoorbeeld: <span class=filename>a:\base\base.aa</span>, <span class=filename>a:\base\base.ab</span>, enzovoorts.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Het bestand <span class=filename>base.inf</span> dient ook op de eerste diskette van de <span class=filename>base</span> verzameling te staan aangezien het door het installatieprogramma wordt gelezen om uit te zoeken naar hoeveel aanvullende delen te kijken wanneer de distributie opgehaald en aan elkaar geregen wordt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als tijdens de installatie het scherm Media verschijnt kan <span class=guimenuitem>Floppy</span> gekozen worden en het installatiesysteem vraagt daarna om de overige diskettes.</p></div></div><div class=sect3><h4 id=install-msdos>2.13.4. Installeren vanaf een MS-DOS®-partitie<a class=anchor href=#install-msdos></a></h4><div class=paragraph><p>Om een installatie voor te bereiden vanaf een MS-DOS®-partitie kunnen alle bestanden vanaf de distributie in een map genaamd <span class=filename>freebsd</span> in de hoofdmap van de partitie gezet worden, bijvoorbeeld <span class=filename>c:\freebsd</span>. De mappenstructuur van de CD-ROM of FTP site moet gedeeltelijk worden gereproduceerd in deze map, dus we raden aan het MS-DOS® commando <code>xcopy</code> te gebruiken als de bron een CD-ROM is. Om bijvoorbeeld een minimale installatie van FreeBSD voor te bereiden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>C:<span class=se>\&gt;</span> md c:<span class=se>\f</span>reebsd
C:<span class=se>\&gt;</span> xcopy e:<span class=se>\b</span><span class=k>in </span>c:<span class=se>\f</span>reebsd<span class=se>\b</span><span class=k>in</span><span class=se>\ </span>/s
C:<span class=se>\&gt;</span> xcopy e:<span class=se>\m</span>anpages c:<span class=se>\f</span>reebsd<span class=se>\m</span>anpages<span class=se>\ </span>/s</code></pre></div></div><div class=paragraph><p>Hierbij wordt aangenomen dat <span class=filename>C:</span> de schijf is met voldoende vrije ruimte en dat <span class=filename>E:</span> het CD-ROM station is.</p></div><div class=paragraph><p>Als er geen CD-ROM station is, dan kan de distributie gedownload worden van <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/12.0-RELEASE/>ftp.FreeBSD.org</a>. Elke distributie heeft zijn eigen map. De <em>base</em> distributie staat bijvoorbeeld in de map <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/12.0-RELEASE/base/>12.0/base/</a>.</p></div><div class=paragraph><p>Kopiëer de vanaf een MS-DOS®-partitie te installeren distributies (en waar schijfruimte voor is) en plaats ze elk onder <span class=filename>c:\freebsd</span>. De distributie <code>BIN</code> is de enige noodzakelijke voor een minimale installatie.</p></div></div><div class=sect3><h4 id=_installeren_van_tape>2.13.5. Installeren van tape<a class=anchor href=#_installeren_van_tape></a></h4><div class=paragraph><p>Het installeren vanaf een tape is waarschijnlijk de gemakkelijkste manier, sneller dan een online FTP installatie of een CD-ROM installatie. Het installatieprogramma verwacht dat de bestanden eenvoudigweg getarred zijn op een tape. Na het ophalen van alle benodigde distributiebestanden moeten ze op een tape getarred worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /freebsd/distdir</span>
<span class=c># tar cvf /dev/rwt0 dist1 ... dist2</span></code></pre></div></div><div class=paragraph><p>Bij het uitvoeren van de installatie moet ervoor gezorgd worden dat er voldoende ruimte is in een tijdelijke map (die gekozen kan worden) om de <em>volledige</em> inhoud van de gemaakte tape te bevatten. Door de sequentiële toegangsmethode van een tape heeft deze manier van installeren nogal wat tijdelijke schijfruimte nodig.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Bij het begin van de installatie moet de tape al in de drive zitten <em>voor</em> het opstarten van de opstartdiskette. Het installatieprogramma kan hem anders niet vinden.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_installeren_over_een_netwerk>2.13.6. Installeren over een netwerk<a class=anchor href=#_installeren_over_een_netwerk></a></h4><div class=paragraph><p>Er zijn drie soorten netwerkinstallaties beschikbaar: Ethernet (een standaard Ethernet-controller), seriële poort (PPP), of parallelle poort (PLIP, laplink-kabel).</p></div><div class=paragraph><p>Voor de snelst mogelijke netwerkinstallatie is een Ethernet adapter altijd een goede keuze! FreeBSD ondersteunt de meeste Ethernetkaarten. Een overzicht van de ondersteunde kaarten (en de benodigde instellingen) is beschikbaar in de Hardware Notes voor elke versie van FreeBSD. Als gebruik gemaakt wordt van een ondersteunde PCMCIA kaart, stop deze dan in het slot <em>vóór</em> de laptop wordt aangezet. FreeBSD ondersteunt momenteel helaas geen "hot insertion" van PCMCIA-kaarten tijdens de installatie.</p></div><div class=paragraph><p>Een toe te wijzen IP-adres op het netwerk, het netmask van de adresklasse en de naam voor de te installeren machine moeten ook bekend zijn. Als wordt geïnstalleerd over een PPP-verbinding en er is geen vast IP-adres, wanhoop dan niet. Het IP-adres kan dynamisch toegekend worden door een ISP. Een systeembeheerder kan aangeven welke waarden gebruikt moeten worden voor netwerkinstellingen. Als andere hosts benaderd moeten worden op naam en niet op IP-adres, dan moet ook een nameserver en mogelijk het adres van een gateway opgegeven worden (als PPP wordt gebruikt is dat het IP-adres van de provider). Bij installatie met FTP via een HTTP-proxy moet ook het adres van de proxy bekend zijn. Als het antwoord op één of meerdere vragen niet bekend is, dan moet echt gesproken worden met de systeembeheerder of ISP <em>vóóor</em> dit soort installaties worden uitgevoerd.</p></div><div class=paragraph><p>Als een modem wordt gebruikt is PPP hoogstwaarschijnlijk de enige mogelijkheid. Er dient informatie over de provider beschikbaar te zijn omdat die redelijk vroeg in het installatieproces nodig is.</p></div><div class=paragraph><p>Als PAP of CHAP wordt gebruikt om een verbinding te maken met een ISP (met andere woorden als een verbinding gemaakt kan worden met een ISP onder Windows® zonder een script te gebruiken), dan is alles wat gedaan moet worden het ingeven van het <code>dial</code> commando op de ppp prompt. Anders moet bekend zijn hoe de ISP gebeld moet worden met "AT commando’s" die specifiek zijn voor een modem, aangezien de PPP-dialer slechts een erg eenvoudige terminal emulator bevat. In het ppp-gebruikers <a href=./#userppp>handboek</a> en de <a href=https://docs.freebsd.org/en/books/faq/#ppp>FAQ</a> staat meer informatie. Bij problemen kan de log naar het scherm worden gestuurd met het commando <code>set log local …​</code>.</p></div><div class=paragraph><p>Als een hard-wired verbinding naar een andere FreeBSD machine beschikbaar is kan ook overwogen worden te installeren via een "laplink" parallelle poort kabel. De snelheid van een parallelle poort is veel hoger dan wat normaal mogelijk is over een seriële kabel (tot 50 kbytes/sec), resulterend een veel snellere installatie.</p></div><div class=sect4><h5 id=_installeren_via_nfs>2.13.6.1. Installeren via NFS<a class=anchor href=#_installeren_via_nfs></a></h5><div class=paragraph><p>De installatie via NFS is redelijk rechttoe-rechtaan. Kopiëer gewoon de FreeBSD distributiebestanden die nodig zijn naar een NFS server en geef die server dan aan in de NFS-media selectie.</p></div><div class=paragraph><p>Als de server alleen zogenaamde "privileged ports" toestaat (zoals in z’n algemeenheid de standaard voor Sun workstations), dan moet ook de optie <code>NFS Secure</code> aangezet worden in het menu <b class=menuref>Options</b> voor de installatie verder kan gaan.</p></div><div class=paragraph><p>Bij het gebruik van een Ethernetkaart van lage kwaliteit die last heeft van erg lage overdrachtssnelheden kan ook de vlag <code>NFS Slow</code> aangezet worden.</p></div><div class=paragraph><p>Om de installatie van NFS te laten werken, moet de server het aankoppelen van submappen ondersteunen. Als bijvoorbeeld een FreeBSD 12.0 distributie op <span class=filename>ziggy:/usr/archive/stuff/FreeBSD</span> staat, dan moet <code>ziggy</code> toestaan dat <span class=filename>/usr/archive/stuff/FreeBSD</span> rechtstreeks wordt aangekoppeld en niet alleen <span class=filename>/usr</span> of <span class=filename>/usr/archive/stuff</span>.</p></div><div class=paragraph><p>Dit wordt vanuit het FreeBSD-bestand <span class=filename>/etc/exports</span> geregeld door de opties <code>-alldirs</code>. Andere NFS servers kunnen andere gewoontes hebben. Bij een foutbericht <code>permission denied</code> van de server is het waarschijnlijk dat deze niet goed is ingesteld.</p></div></div></div></div></div></div><div class=sect1><h2 id=bsdinstall>Hoofdstuk 3. FreeBSD 9.X en nieuwer installeren<a class=anchor href=#bsdinstall></a></h2><div class=sectionbody><div class=sect2><h3 id=bsdinstall-synopsis>3.1. Overzicht<a class=anchor href=#bsdinstall-synopsis></a></h3><div class=paragraph><p>Wordt nog vertaald.</p></div></div></div></div><div class=sect1><h2 id=basics>Hoofdstuk 4. UNIX® beginselen<a class=anchor href=#basics></a></h2><div class=sectionbody><div class=sect2><h3 id=basics-synopsis>4.1. Overzicht<a class=anchor href=#basics-synopsis></a></h3><div class=paragraph><p>Het volgende hoofdstuk behandelt de basiscommando’s en functionaliteit van het FreeBSD besturingssysteem. Veel van dit materiaal is relevant voor elk UNIX® achtig besturingssysteem. Als de lezer reeds bekend is met het materiaal, hoeft dit hoofdstuk niet gelezen te worden. Lezer die nog niet eerder met FreeBSD te maken hebben gehad wordt aangeraden door te lezen.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe "virtuele consoles" in FreeBSD gebruikt kunnen worden;</p></li><li><p>Hoe UNIX® bestandspermissies werken en hoe bestandsvlaggen in FreeBSD werken;</p></li><li><p>Hoe het standaard FreeBSD bestandssysteem eruit ziet;</p></li><li><p>Hoe een FreeBSD harde schijf is ingedeeld;</p></li><li><p>Hoe bestandssystemen gekoppeld en ontkoppeld worden;</p></li><li><p>Wat processen, daemons en signalen zijn;</p></li><li><p>Wat een shell is en hoe de standaard omgevingsvariabelen veranderd kunnen worden;</p></li><li><p>Hoe elementaire tekstverwerkers te gebruiken;</p></li><li><p>Wat apparaten en apparaatkoppelpunten zijn;</p></li><li><p>Welk binair formaat FreeBSD gebruikt;</p></li><li><p>Hoe handleidingen te gebruiken meer informatie.</p></li></ul></div></div><div class=sect2><h3 id=consoles>4.2. Virtuele consoles en terminals<a class=anchor href=#consoles></a></h3><div class=paragraph><p>FreeBSD kan op diverse manieren gebruikt worden. Één van deze manieren is het typen van commando’s in een tekstterminal. Veel van de flexibiliteit en kracht van een UNIX® besturingssysteem is gemakkelijk beschikbaar als je FreeBSD op deze manier gebruikt. Dit onderdeel beschrijft wat "terminals " en "consoles" zijn en hoe je deze kan gebruiken in FreeBSD.</p></div><div class=sect3><h4 id=consoles-intro>4.2.1. De console<a class=anchor href=#consoles-intro></a></h4><div class=paragraph><p>Als FreeBSD niet is ingesteld om automatisch een grafische omgeving te starten tijdens het opstarten, geeft het systeem een login prompt als het gestart is. Dit gebeurt direct nadat de startscripts klaar zijn. Er wordt iets als het volgende getoond:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Additional ABI support:.
Local package initialization:.
Additional TCP options:.

Fri Sep 20 13:01:06 EEST 2002

FreeBSD/i386 <span class=o>(</span>pc3.example.org<span class=o>)</span> <span class=o>(</span>ttyv0<span class=o>)</span>

login:</code></pre></div></div><div class=paragraph><p>De meldingen op het scherm kunnen wellicht iets anders zijn op een systeem, maar het zal iets soortgelijks zijn. De laatste twee regels zijn de regels waar het nu over gaat. De voorlaatste regel toont:</p></div><div class="literalblock programlisting"><div class=content><pre>FreeBSD/i386 (pc3.example.org) (ttyv0)</pre></div></div><div class=paragraph><p>Deze regel bevat enkele informatie over het systeem dat net gestart is: dit is een "FreeBSD" console, draaiend op een Intel of soortgelijke processor op de x86 architectuur. De naam van de machine (elke UNIX® machine heeft een naam) is <code>pc3.example.org</code> en dit is de console van het systeem, de <span class=filename>ttyv0</span> terminal.</p></div><div class=paragraph><p>De laatste regel is altijd:</p></div><div class="literalblock programlisting"><div class=content><pre>login:</pre></div></div><div class=paragraph><p>Dit is het deel waar een "gebruikersnaam" ingevuld moet worden om aan te melden op FreeBSD. Het volgende deel beschrijft hoe dat werkt.</p></div></div><div class=sect3><h4 id=consoles-login>4.2.2. Aanmelden op FreeBSD<a class=anchor href=#consoles-login></a></h4><div class=paragraph><p>FreeBSD is een multi-user en multi-processing systeem. Dit is de formele beschrijving die meestal gegeven wordt aan een systeem dat gebruikt wordt door meerdere personen die gelijktijdig verschillende programma’s draaien op één enkele machine.</p></div><div class=paragraph><p>Elk multi-user systeem heeft een manier nodig om een "gebruiker" van alle andere gebruikers te kunnen onderscheiden. In FreeBSD (en alle andere UNIX® achtige besturingssystemen), wordt dit bereikt door te eisen dat elke gebruiker moet "aanmelden" op het systeem voordat hij/zij programma’s kan draaien. Elke gebruiker heeft een unieke naam (de "gebruikersnaam") en een persoonlijke, geheime sleutel (het "wachtwoord"). FreeBSD vraagt om deze twee gegevens voordat het een gebruiker toegestaat om programma’s te draaien.</p></div><div class=paragraph><p>Direct nadat FreeBSD is opgestart en de opstartscripts afgerond zijn, wordt een prompt getoond dat vraagt om een geldige aanmeldnaam op te geven.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>login:</code></pre></div></div><div class=paragraph><p>In dit voorbeeld wordt aangenomen de gebruikersnaam <code>john</code> is. Als na deze prompt <code>john</code> wordt getype en op <kbd>Enter</kbd> wordt gedrukt, verschijnt hierna een prompt om het " wachtwoord" in te voeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>login: john
Password:</code></pre></div></div><div class=paragraph><p>Nu kan `john’s wachtwoord ingevoerd worden en op <kbd>Enter</kbd> gedrukt worden. Het wachtwoord wordt <em>niet getoond</em>! Daarover hoeft geen zorg te bestaan. Het is voldoende om te zeggen dat dit om veiligheidsredenen gedaan wordt.</p></div><div class=paragraph><p>Als het juiste wachtwoord is ingegeven, is er aangemeld bij op FreeBSD en in het systeem klaar om alle beschikbare commando’s uit te voeren.</p></div><div class=paragraph><p>Na het aanmelden is de MOTD of het bericht van de dag zichtbaar, gevolgd door een commandoprompt (een <code>#</code>, <code>$</code> of een <code>%</code> karakter). Dit geeft aan dat er succesvol is aangemeld op FreeBSD.</p></div></div><div class=sect3><h4 id=consoles-virtual>4.2.3. Meerdere consoles<a class=anchor href=#consoles-virtual></a></h4><div class=paragraph><p>UNIX® programma’s draaien in één console is prima, maar FreeBSD kan veel programma’s tegelijk draaien. Om maar één console te hebben waar commando’s ingetypt kunnen worden zou zonde zijn van een besturingssysteem als FreeBSD waar meerdere programma’s tegelijkertijd op kunnen draaien. Hier kunnen "virtuele consoles" van pas komen.</p></div><div class=paragraph><p>FreeBSD kan ingesteld worden om verschillende virtuele consoles te tonen. Met toetscombinaties kan van de ene console naar de gewisseld worden. Elke console heeft zijn eigen uitvoerkanaal, en FreeBSD zorgt ervoor dat alle toetsenbordinvoer en monitoruitvoer goed wordt gezet als er van de ene console naar de volgende wordt gewisseld.</p></div><div class=paragraph><p>In FreeBSD kunnen speciale toetscombinaties gebruikt worden om te wisselen naar een ander virtueel console. In FreeBSD kan <span class=keyseq><kbd>Alt</kbd>+<kbd>F1</kbd></span>, <span class=keyseq><kbd>Alt</kbd>+<kbd>F2</kbd></span> tot en met <span class=keyseq><kbd>Alt</kbd>+<kbd>F8</kbd></span> gebruikt worden om te wisselen naar een ander virtueel console.</p></div><div class=paragraph><p>Als wordt gewisseld van de ene naar de andere console zorgt FreeBSD dat de uitvoer bewaard blijft. Het resultaat is een "illusie" van het hebben van meerdere schermen en toetsenborden die gebruikt kunnen worden om commando’s in te voeren om FreeBSD te laten draaien. De programma’s die in de ene virtuele console draaien, stoppen niet als de console niet zichtbaar is. Ze blijven doordraaien als naar een andere virtuele console wordt gewisseld.</p></div></div><div class=sect3><h4 id=consoles-ttys>4.2.4. Het bestand <span class=filename>/etc/ttys</span><a class=anchor href=#consoles-ttys></a></h4><div class=paragraph><p>De standaardinstelling van FreeBSD start op met acht virtuele consoles. Dit is echter geen vaste waarde en een installatie kan eenvoudig aangepast worden, zodat het systeem gestart wordt met meer of minder virtuele consoles. De hoeveelheid en instellingen van de virtuele consoles worden ingesteld in <span class=filename>/etc/ttys</span>.</p></div><div class=paragraph><p><span class=filename>/etc/ttys</span> kan gebruikt worden om virtuele consoles in te stellen. Elke niet-commentaar regel in dit bestand (regels die niet beginnen met een <code>#</code> karakter) bevat instellingen voor een terminal of virtuele console. De standaardversie van dit bestand die meegeleverd wordt met FreeBSD stelt negen virtuele consoles in en activeert er acht. Dit zijn de regels die beginnen met <code>ttyv</code>:</p></div><div class="literalblock programlisting"><div class=content><pre># naam  getty                             type    status           commentaar
#
ttyv0   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
# Virtual terminals
ttyv1   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv2   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv3   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv4   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv5   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv6   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv7   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv8   &#34;/usr/X11R6/bin/xdm -nodaemon&#34;  xterm   off secure</pre></div></div><div class=paragraph><p>Een uitgebreide beschrijving van elke kolom in dit bestand en alle mogelijke opties voor virtuele consoles staan in de <a href="https://man.freebsd.org/cgi/man.cgi?query=ttys&amp;sektion=5&amp;format=html">ttys(5)</a> hulppagina gebruiken.</p></div></div><div class=sect3><h4 id=consoles-singleuser>4.2.5. Single-user console<a class=anchor href=#consoles-singleuser></a></h4><div class=paragraph><p>In <a href=./#boot-singleuser>Single-user modus</a> staat een gedetailleerde beschrijving van de "single-user modus". Het is belanrijk te melden dat er in single-user modus maar één console is. Er zijn geen virtuele consoles beschikbaar. De instellingen van de single-user modus console staan ook in <span class=filename>/etc/ttys</span>. De regel begint met <code>console</code>:</p></div><div class="literalblock programlisting"><div class=content><pre># name  getty                             type    status           commentaar
#
# Als een console gemarkeerd is als &#34;insecure&#34;, zal het init script om het root-wachtwoord
# vragen wanneer het in single-user mode komt.
console none                              unknown off secure</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Zoals het commentaar boven de <code>console</code> regel aangeeft, kan in deze regel het woord <code>secure</code> gewijzigd worden in <code>insecure</code>. In dat geval vraagt FreeBSD bij het opstarten in single-user modus nog steeds om een <code>root</code>-wachtwoord.</p></div><div class=paragraph><p><em>Pas op als dit wordt veranderd in <code>_insecure</code></em><code>`_. Als het wachtwoord van de gebruiker `root</code> zoek is, wordt het opstarten in single-user modus lastig. Het is nog steeds mogelijk, maar het kan vrij moeilijk zijn voor iemand die FreeBSD niet zo goed kent met betrekking tot het opstarten en de programma’s die daarbij gebruikt worden.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=consoles-vidcontrol>4.2.6. Het wijzigen van de console video mode<a class=anchor href=#consoles-vidcontrol></a></h4><div class=paragraph><p>De FreeBSD standaard video mode kan worden gewijzigd in 1024x768, 1280x1024, of een van de vele andere formaten die ondersteund worden door de grafische kaart en monitor. Laad de module <code>VESA</code> om gebruik te maken van de verschillende video modes:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload vesa</span></code></pre></div></div><div class=paragraph><p>Kijk daarna welke video modes er ondersteund worden door de hardware door gebruik te maken van de <a href="https://man.freebsd.org/cgi/man.cgi?query=vidcontrol&amp;sektion=1&amp;format=html">vidcontrol(1)</a> applicatie. Om een overzicht te krijgen van de ondersteunde video modes moet het volgende ingevoerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># vidcontrol -i mode</span></code></pre></div></div><div class=paragraph><p>Het resultaat van dit commando is een lijst van video modes welke ondersteund worden door de hardware. Hierna kan de nieuwe video mode gekozen worden door dit aan te geven aan <a href="https://man.freebsd.org/cgi/man.cgi?query=vidcontrol&amp;sektion=1&amp;format=html">vidcontrol(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># vidcontrol MODE_279</span></code></pre></div></div><div class=paragraph><p>Als de nieuwe video mode acceptabel is, kan dit permanent ingesteld worden door het volgende in <span class=filename>/etc/rc.conf</span> te zetten:</p></div><div class="literalblock programlisting"><div class=content><pre>allscreens_flags=&#34;MODE_279&#34;</pre></div></div></div></div><div class=sect2><h3 id=permissions>4.3. Rechten<a class=anchor href=#permissions></a></h3><div class=paragraph><p>FreeBSD, direct afgeleid van BSD UNIX®, is gebaseerd op verschillende belangrijke UNIX® concepten. Het meest bekende is dat FreeBSD een multi-user systeem is. Het systeem kan meerdere gebruikers behandelen die tegelijkertijd totaal verschillende dingen doen. Het systeem is verantwoordelijk voor het netjes delen en beheren voor aanvragen voor hardware, randapparatuur, geheugen en cpu tijd tussen elke gebruiker.</p></div><div class=paragraph><p>Omdat het systeem in staat is om meerdere gebruikers te ondersteunen, heeft alles wat door het systeem beheerd wordt een set van rechten die aangeeft wie mag lezen, schrijven en de bron mag uitvoeren. Deze rechten zijn opgeslagen in drie octetten, die weer in drie stukjes onderverdeeld zijn: één voor de eigenaar van het bestand, één voor de groep waar het bestand toe behoort en één voor de overigen. De numerieke weergave werkt als volgt:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Waarde</th><th class="tableblock halign-left valign-top">Recht</th><th class="tableblock halign-left valign-top">Maprecht</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Niet lezen, niet schrijven, niet uitvoeren</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>---</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Niet lezen, niet schrijven, uitvoeren</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>--x</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Niet lezen, schrijven, niet uitvoeren</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-w-</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Niet lezen, schrijven, uitvoeren</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-wx</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lezen, niet schrijven, niet uitvoeren</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>r--</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lezen, niet schrijven, uitvoeren</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>r-x</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lezen, schrijven, niet uitvoeren</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>rw-</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lezen, schrijven, uitvoeren</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>rwx</code></p></td></tr></tbody></table><div class=paragraph><p>De <code>-l</code> optie kan gebruikt worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> om een lange lijst met de inhoud van een map te zien die een kolom heeft met informatie over bestandsrechten voor de eigenaar, groep en de rest. <code>ls -l</code> in een willekeurige map kan het volgende laten zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>ls</span> <span class=nt>-l</span>
total 530
<span class=nt>-rw-r--r--</span>  1 root  wheel     512 Sep  5 12:31 myfile
<span class=nt>-rw-r--r--</span>  1 root  wheel     512 Sep  5 12:31 otherfile
<span class=nt>-rw-r--r--</span>  1 root  wheel    7680 Sep  5 12:31 email.txt
...</code></pre></div></div><div class=paragraph><p>Zo ziet de eerste kolom van <code>ls -l</code> eruit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>-rw-r--r--</span></code></pre></div></div><div class=paragraph><p>Het eerste (meest linkse) karakter geeft aan of dit een reguliere bestand is, een map, een speciaal karakter component(!), een socket of een andere pseudo-file component(!). In dit geval betekent de <code>-</code> dat het een regulier bestand is. De volgende drie karakters, <code>rw-</code> in dit voorbeeld, geven de rechten voor de eigenaar van het bestand. De drie karakters <code>r--</code> erna geven de rechten van voor de groep van het bestand. De overige drie karakters <code>r--</code> tonen de rechten voor alle overige gebruikers. Een streepje betekent dat de rechten uitgeschakeld zijn. In het geval van dit bestand zijn de rechten zo ingesteld dat de eigenaar kan lezen en schrijven naar het bestand, de groep het bestand kan lezen, en alle overige gebruikers kunnen ook het bestand lezen. Volgens de tabel hierboven worden de rechten <code>644</code>, waar de cijfers de drie stukjes van de rechten aangeven.</p></div><div class=paragraph><p>Dit is allemaal leuk en aardig, maar hoe controleert het systeem dan rechten voor apparaten? FreeBSD behandelt de meeste hardware apparaten als bestanden die door programma’s kunnen worden geopend en gelezen, en waar data naar toe kan worden geschreven, net zoals elk ander bestand. Deze speciale apparaat bestanden worden bewaard in de map <span class=filename>/dev</span>.</p></div><div class=paragraph><p>Mappen worden ook behandeld als bestanden. Ze hebben lees, schrijf en uitvoerbare rechten. De uitvoerbare vlag voor een map heeft een klein verschil qua betekenis dan die voor gewone bestanden. Als een map als uitvoerbaar gemarkeerd is, betekent het dat erin gekeken mag worden. Het is dus mogelijk om te wisselen naar de map met <code>cd</code> (wissel van map). Dit betekent ook dat in de map bestanden benaderd kunnen worden waarvan de naam bekend is. Dit is natuurlijk afhankelijk van de rechten op het bestand zelf.</p></div><div class=paragraph><p>In het bijzonder, om een lijst van de map te kunnen maken, moet een gebruiker leesrechten op de map hebben. Om een bestand te verwijderen zijn de naam van het bestand en schrijf <em>en</em> uitvoerrechten op de map nodig waarin het bestand zich bevindt.</p></div><div class=paragraph><p>Er zijn meer rechtenvlaggen, maar die worden slechts gebruikt in speciale gevallen, zoals bij setuid binaries en sticky mappen. Meer informatie over bestandsrechten en hoe die aangepast kunnen worden staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a>.</p></div><div class=sect3><h4 id=_symbolische_rechten>4.3.1. Symbolische rechten<a class=anchor href=#_symbolische_rechten></a></h4><div class=paragraph><p>Symbolische rechten, soms ook wel symbolische expressies, gebruiken karakters in plaats van octale getallen om rechten aan bestanden en mappen te geven. Symbolische expressies gebruiken de volgende opbouw: (wie) (actie) (permissies), waar de volgende waardes beschikbaar zijn:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Optie</th><th class="tableblock halign-left valign-top">Letter</th><th class="tableblock halign-left valign-top">Vertegenwoordigt</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(wie)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>u</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gebruiker</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(wie)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>g</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Groepseigenaar</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(wie)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>o</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Overigen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(wie)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>a</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Iedereen ("wereld")</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(actie)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>+</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Rechten toevoegen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(actie)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Rechten verwijderen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(actie)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>=</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Stel deze rechten in</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(recht)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>r</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lezen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(recht)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>w</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Schrijven</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(recht)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>x</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Uitvoeren</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(recht)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>t</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Sticky bit</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(recht)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>s</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Verander UID of GID</p></td></tr></tbody></table><div class=paragraph><p>Deze waardes worden gebruikt met <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a>, net zoals eerder, alleen nu met letters. Het volgende commando kan gebruikt worden om de overige gebruikers toegang tot <em>BESTAND</em> te ontzeggen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>chmod </span><span class=nv>go</span><span class=o>=</span> BESTAND</code></pre></div></div><div class=paragraph><p>Er kan een door komma’s gescheiden lijst geleverd worden als meer dan één wijziging aan een bestand moet worden uitgevoerd. Het volgende commando past de rechten voor de groep en de "wereld" aan door de schrijfrechten te ontnemen om daarna iedereen uitvoerrechten te geven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>chmod </span>go-w,a+x BESTAND</code></pre></div></div></div><div class=sect3><h4 id=_freebsd_bestandsvlaggen>4.3.2. FreeBSD bestandsvlaggen<a class=anchor href=#_freebsd_bestandsvlaggen></a></h4><div class=paragraph><p>Naast de bestandsrechten die hiervoor zijn besproken, biedt FreeBSD ondersteuning voor "bestandsvlaggen." Deze vlaggen bieden een aanvullend beveiligingsniveau en controle over bestanden, maar niet over mappen.</p></div><div class=paragraph><p>Bestandsvlaggen voegen een extra niveau van controle over bestanden, waardoor verzekerd kan worden dat in sommige gevallen zelfs <code>root</code> een bestand niet kan verwijderen of wijzigen.</p></div><div class=paragraph><p>Bestandsvlaggen worden gewijzigd met het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a>, dat een eenvoudige interface heeft. Om bijvoorbeeld de systeemvlag niet verwijderdbaar in te stellen op het bestand <span class=filename>file1</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chflags sunlink file1</span></code></pre></div></div><div class=paragraph><p>Om de vlag niet verwijderbaar weer te verwijderen kan het voorgaande commando met "no" voor <code>sunlink</code> worden uitgevoerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chflags nosunlink file1</span></code></pre></div></div><div class=paragraph><p>Om de vlaggen op een bestand te bekijken, kan het <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> commando met de vlaggen <code>-lo</code> gebruikt worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls -lo file1</span></code></pre></div></div><div class=paragraph><p>De uitvoer hoort er ongeveer als volgt uit te zien:</p></div><div class="literalblock programlisting"><div class=content><pre>-rw-r--r--  1 trhodes  trhodes  sunlnk 0 Mar  1 05:54 file1</pre></div></div><div class=paragraph><p>Een aantal vlaggen kan alleen ingesteld of verwijderd worden door de gebruiker <code>root</code>. In andere gevallen kan de eigenaar van een bestand vlaggen instellen. Meer informatie voor beheerders staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=2&amp;format=html">chflags(2)</a>.</p></div></div><div class=sect3><h4 id=_de_setuid_setgid_en_klevende_toestemmingen>4.3.3. De <code>setuid</code>-, <code>setgid</code>-, en <code>klevende</code> toestemmingen<a class=anchor href=#_de_setuid_setgid_en_klevende_toestemmingen></a></h4><div class=paragraph><p>Buiten de toestemmingen die reeds besproken zijn, zijn er nog drie specifieke instellingen waarvan alle beheerders kennis dienen te hebben. Dit zijn de <code>setuid</code>-, <code>setgid</code>-, en <code>sticky</code> toestemmingen.</p></div><div class=paragraph><p>Deze instellingen zijn belangrijk voor sommige UNIX®-bewerkingen omdat ze functionaliteit bieden die normaliter niet aan normale gebruikers wordt gegeven. Om ze te begrijpen, dient ook het verschil tussen de echte gebruikers-ID en de effectieve gebruikers-ID opgemerkt te worden.</p></div><div class=paragraph><p>De echte gebruikers-ID is de UID die het proces start of bezit. De effectieve UID is de gebruikers-ID waaronder het proces draait. Bijvoorbeeld, het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=1&amp;format=html">passwd(1)</a> draait met de echte gebruikers-ID van de gebruiker die het wachtwoord verandert; echter, om de database met wachtwoorden te manipuleren, draait het met de effectieve ID van de gebruiker <code>root</code>. Dit is wat normale gebruikers in staat stelt om hun wachtwoorden te veranderen zonder een fout <code>Permission Denied</code> te zien.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>-optie <code>nosuid</code> zorgt ervoor dat deze binairen zwijgend falen. Dit houdt in dat ze niet worden uitgevoerd zonder ooit de gebruiker op de hoogte te stellen. Deze optie is ook niet geheel betrouwbaar aangezien een <code>nosuid</code>-wrapper dit volgens de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> kan omzeilen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De setuid-toestemming kan aangezet worden door het cijfer vier (4) voor een toestemmingenverzameling te plaatsen zoals te zien is in het volgende voorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 4755 suidvoorbeeld.sh</span></code></pre></div></div><div class=paragraph><p>De toestemmingen op het bestand <span class=filename>suidvoorbeeld.sh</span> dienen er nu als volgt uit te zien:</p></div><div class="literalblock programlisting"><div class=content><pre>-rwsr-xr-x   1 trhodes  trhodes    63 Aug 29 06:36 suidvoorbeeld.sh</pre></div></div><div class=paragraph><p>Het zou in dit voorbeeld te zien moeten zijn dat een <code>s</code> nu deel is van de toestemmingenverzameling bestemd voor de bestandseigenaar, en de uitvoerbare bit vervangt. Dit staat gereedschappen toe die verhoogde toestemmingen nodig hebben, zoals <code>passwd</code>.</p></div><div class=paragraph><p>Open twee terminals om dit in real-time te zien. Start op het ene het proces <code>passwd</code> als een normale gebruiker. Controleer de procestabel terwijl het op een nieuw wachtwoord wacht en kijk naar de gebruikersinformatie van het commando <code>passwd</code>.</p></div><div class=paragraph><p>In terminal A:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Changing <span class=nb>local </span>password <span class=k>for </span>trhodes
Old Password:</code></pre></div></div><div class=paragraph><p>In terminal B:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ps aux | grep passwd</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>trhodes  5232  0.0  0.2  3420  1608   0  R+    2:10AM   0:00.00 <span class=nb>grep </span>passwd
root     5211  0.0  0.2  3620  1724   2  I+    2:09AM   0:00.01</code></pre></div></div><div class=paragraph><p>Zoals boven vermeld, wordt <code>passwd</code> door een normale gebruiker gedraaid, maar gebruikt het de effectieve UID van <code>root</code>.</p></div><div class=paragraph><p>De <code>setgid</code>-toestemming voert dezelfde functie uit als de <code>setuid</code>-toestemming; behalve dat het de groepsinstellingen verandert. Wanneer een applicatie of gereedschap met deze instelling wordt gedraaid, krijgt het de toestemmingen gebaseerd op de groep die het bestand bezit, niet op de gebruiker die het proces startte.</p></div><div class=paragraph><p>Om de <code>setgid</code>-toestemming op een bestand aan te zetten, dient een voorlopende twee (2) aan het commando <code>chmod</code> gegeven te worden zoals in het volgende voorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 2755 sgidvoorbeeld.sh</span></code></pre></div></div><div class=paragraph><p>De nieuwe instelling kan zoals hierboven bekeken worden, merk op dat de <code>s</code> nu in het veld bestemd voor de instellingen van de groepstoestemmingen staat:</p></div><div class="literalblock programlisting"><div class=content><pre>-rwxr-sr-x   1 trhodes  trhodes    44 Aug 31 01:49 sgidvoorbeeld.sh</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In deze voorbeelden zal het shellscript niet met een andere EUID of effectief gebruikers-ID draaien, zelfs al is het shellscript uitvoerbaar. Dit is omdat shellscripts geen toegang hebben tot de <a href="https://man.freebsd.org/cgi/man.cgi?query=setuid&amp;sektion=2&amp;format=html">setuid(2)</a>-systeemaanroepen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De eerste twee speciale toestemmingsbits die we besproken hebben (de toestemmingsbits <code>setuid</code> en <code>setgid</code>) kunnen de systeemveiligheid verlagen, door verhoogde toestemmingen toe te staan. Er is een derde bit voor speciale toestemmingen die de veiligheid van een systeem kan verhogen: de <code>klevende bit</code>.</p></div><div class=paragraph><p>De <code>klevende bit</code>, wanneer deze op een map is ingesteld, staat alleen het verwijderen van bestanden toe door de eigenaar van die bestanden. Deze toestemmingenverzameling is nuttig om het verwijderen van bestanden in publieke mappen, zoals <span class=filename>/tmp</span>, door gebruikers die het bestand niet bezitten te voorkomen. Zet een één (1) voor de toestemming om deze toestemming te gebruiken. Bijvoorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 1777 /tmp</span></code></pre></div></div><div class=paragraph><p>Het effect kan nu met het commando <code>ls</code> bekeken worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls -al / | grep tmp</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>drwxrwxrwt  10 root  wheel         512 Aug 31 01:49 tmp</code></pre></div></div><div class=paragraph><p>De toestemming <code>klevende bit</code> is te onderscheiden met de <code>t</code> aan het einde van de verzameling.</p></div></div></div><div class=sect2><h3 id=dirstructure>4.4. Mappenstructuur<a class=anchor href=#dirstructure></a></h3><div class=paragraph><p>De FreeBSD mappenstructuur is erg belangrijk om het systeem goed te leren kennen. Het belangrijkste concept om greep op te krijgen is die van de rootmap, "/". Deze map is de eerste die gekoppeld wordt tijdens het opstarten en bevat het basissysteem dat nodig is om het besturingssysteem gereed te maken voor multi-user taken. De rootmap bevat ook koppelpunten voor elk ander bestandssysteem dat misschien gekoppeld wordt.</p></div><div class=paragraph><p>Een koppelpunt is een map waar extra bestandssystemen aan het een bestandssysteem gekoppeld kunnen worden (meestal het root bestandssysteem). Dit wordt beschreven in <a href=#disk-organization>Organisatie van schijven</a>. Standaard koppelpunten zijn <span class=filename>/usr</span>, <span class=filename>/var</span>, <span class=filename>/tmp</span>, <span class=filename>/mnt</span> en <span class=filename>/cdrom</span>. Naar deze mappen wordt meestal verwezen in <span class=filename>/etc/fstab</span>, een tabel met bestandssystemen en koppelpunten ter referentie voor het systeem. De meeste bestandssystemen in <span class=filename>/etc/fstab</span> worden automatisch gekoppeld tijdens het opstarten door het script <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>, behalve als de optie <code>noauto</code> gedefinieerd is. Details staan beschreven in <a href=#disks-fstab>Het bestand <span class=filename>fstab</span></a>.</p></div><div class=paragraph><p>Een complete beschrijving over het bestandssysteem staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=hier&amp;sektion=7&amp;format=html">hier(7)</a>. Hier wordt volstaan met een overzicht van de voorkomende mappen.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Map</th><th class="tableblock halign-left valign-top">Omschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Rootmap van het bestandssysteem.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/bin/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gebruikersapplicaties, belangrijk voor zowel single user als multi-user omgevingen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/boot/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Programma’s en instellingenbestanden die gebruikt worden tijdens het opstarten van het besturingssysteem.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/boot/defaults/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Bestanden met standaardinstellingen voor opstarten;, zie <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/dev/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Apparaatnodes;, zie <a href="https://man.freebsd.org/cgi/man.cgi?query=intro&amp;sektion=4&amp;format=html">intro(4)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Bestanden met systeeminstellingen en scripts.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/defaults/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Bestanden met standaard systeeminstellingen;, zie <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Instellingenbestanden voor mail transport programma’s zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/namedb/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Instellingenbestanden voor <code>named</code>, zie <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/periodic/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Scripts die dagelijks, wekelijks en maandelijks via <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> worden uitgevoerd, zie <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/ppp/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Instellingenbestanden voor <code>ppp</code>, zie <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/mnt/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lege map, veel gebruikt door systeembeheerders als tijdelijk koppelpunt voor opslagruimtes.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/proc/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Process bestandssysteem;, zie <a href="https://man.freebsd.org/cgi/man.cgi?query=procfs&amp;sektion=5&amp;format=html">procfs(5)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_procfs&amp;sektion=8&amp;format=html">mount_procfs(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/rescue/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Statisch gelinkte programma’s voor noodherstel, zie <a href="https://man.freebsd.org/cgi/man.cgi?query=rescue&amp;sektion=8&amp;format=html">rescue(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/root/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Thuismap van de gebruiker <code>root</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/sbin/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Systeemprogramma’s en administratieprogramma’s belangrijk voor zowel single-user en multi-user omgevingen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/tmp/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Tijdelijke bestanden. De inhoud van <span class=filename>/tmp</span> blijft meestal NIET bewaard na een herstart. Er wordt vaak een geheugengebaseerd bestandssysteem gekoppeld op <span class=filename>/tmp</span>. Dit kan geautomatiseerd worden met de tmpmfs-gerelateerde variabelen van <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> (of met een regel in <span class=filename>/etc/fstab</span>). Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Hier bevindt zich het leeuwendeel van alle hulpprogramma’s en gewone programma’s.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/bin/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Standaard programma’s, programmeertools.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/include/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Standaard C invoegbestanden.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/lib/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Functiebibliotheken.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/libdata/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Diverse databestanden voor hulpprogramma’s.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/libexec/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Systeemdaemons en systeemhulpprogramma’s (uitgevoerd door andere programma’s).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/local/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lokale programma’s, bibliotheken, etc. Wordt ook gebruikt als standaard locatie voor de FreeBSD ports. Binnen <span class=filename>/usr/local</span>, wordt de algemene layout bepaald door <a href="https://man.freebsd.org/cgi/man.cgi?query=hier&amp;sektion=7&amp;format=html">hier(7)</a>, dat ook voor <span class=filename>/usr</span> wordt gebruikt. Uitzonderingen is de map man, die direct onder <span class=filename>/usr/local</span> ligt in plaats van onder <span class=filename>/usr/local/share</span>, en de documentatie voor ports is te vinden in <span class=filename>share/doc/port</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/obj/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Architectuur afhankelijke doelstructuur voor resultaten van de bouw van <span class=filename>/usr/src</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/ports/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De FreeBSD Portscollectie (optioneel).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/sbin/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Systeemdaemons en systeemhulpprogramma’s (uitgevoerd door gebruikers).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/shared/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Architectuur onafhankelijke bestanden.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>BSD en/of lokale broncodebestanden.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/X11R6/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Uitvoerbare bestanden en bibliotheken, etc, voor de X11R6 distributie (optioneel).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Multifunctionele logboek-, tijdelijke, transparante en spool bestanden.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/log/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Diverse logboekbestanden van het systeem.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/mail/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Postbusbestanden van gebruikers.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/spool/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Diverse printer- en mailsysteemspoolingmappen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/tmp/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Tijdelijke bestanden die bewaard worden bij een herstart van het systeem.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/yp/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>NIS maps.</p></td></tr></tbody></table></div><div class=sect2><h3 id=disk-organization>4.5. Organisatie van schijven<a class=anchor href=#disk-organization></a></h3><div class=paragraph><p>De kleinste vorm van organisatie die FreeBSD gebruikt om bestanden te vinden is de bestandsnaam. Bestandsnamen zijn hoofdlettergevoelig, wat betekent dat <span class=filename>readme.txt</span> en <span class=filename>README.TXT</span> twee verschillende bestanden zijn. FreeBSD gebruikt de extensie niet (<span class=filename>.txt</span>) van een bestand om te bepalen of het bestand een programma, een document of een vorm van data is.</p></div><div class=paragraph><p>Bestanden worden bewaard in mappen. Een map kan leeg zijn of honderden bestanden bevatten. Een map kan ook andere mappen bevatten, wat het mogelijk maakt om een hiërarchie van mappen te maken. Dit maakt het veel makkelijker om data te organiseren.</p></div><div class=paragraph><p>Bestanden en mappen worden aangegeven door het bestand of de map aan te geven, gevolgd door een voorwaardse slash, <code>/</code>, gevolgd door andere mapnamen die nodig zijn. Als map <span class=filename>foo</span> de map <span class=filename>bar</span> bevat, die op zijn beurt het bestand <span class=filename>readme.txt</span> bevat, dan wordt de volledige naam of <em>pad</em> naar het bestand <span class=filename>foo/bar/readme.txt</span>.</p></div><div class=paragraph><p>Mappen en bestanden worden bewaard op een bestandssysteem. Elk bestandssysteem bevat precies één map op het hoogste niveau die <em>de rootmap</em> van het bestandssysteem heet. Deze rootmap kan op zijn beurt andere mappen bevatten.</p></div><div class=paragraph><p>Tot zover is dit waarschijnlijk hetzelfde als voor elk ander besturingssysteem. Er zijn een paar verschillen. MS-DOS® gebruikt bijvoorbeeld een <code>\</code> om bestanden en mappen te scheiden, terwijl Mac OS® gebruik maakt van <code>:</code>.</p></div><div class=paragraph><p>FreeBSD gebruikt geen schijfletters, of andere schijfnamen in het pad. FreeBSD gebruikt geen <span class=filename>c:/foo/bar/readme.txt</span>.</p></div><div class=paragraph><p>Eén bestandssysteem wordt aangewezen als <em>root</em> bestandssysteem, waar naar wordt verwezen met <code>/</code>. Elk ander bestandssysteem wordt daarna <em>gekoppeld</em> onder het root bestandssysteem. Hoeveel schijven er ook aan een FreeBSD systeem hangen, het lijkt alsof elke map zich op dezelfde schijf bevindt.</p></div><div class=paragraph><p>Stel er zijn drie bestandssystemen met de namen <code>A</code>,<code>B</code> en <code>C</code>. Elk bestandssysteem heeft één root map die twee andere mappen bevat, <code>A1</code> en <code>A2</code> (zo ook voor de andere twee: <code>B1</code>, <code>B2</code>, <code>C1</code> en <code>C2</code>).</p></div><div class=paragraph><p><code>A</code> wordt het root besturingsysteem. Met <code>ls</code>, dat de inhoud van de map kan tonen, zijn de twee mappen <code>A1</code> en <code>A2</code> te zien. De mappenstructuur ziet er als volgend uit:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/example-dir1.png alt="example dir1"></div></div><div class=paragraph><p>Een bestandssysteem moet gekoppeld worden in een map op een ander bestandssysteem. Als nu bestandssysteem <code>B</code> wordt gekoppeld onder de map <code>A1</code> vervangt <code>B``A1</code> en zien de koppelingen in <code>B</code> er als volgt uit:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/example-dir2.png alt="example dir2"></div></div><div class=paragraph><p>Elk bestand dat in de mappen <code>B1</code> en <code>B2</code> aanwezig is, kan benaderd worden met het pad <span class=filename>/A1/B1</span> of <span class=filename>/A1/B2</span>. Elk bestand dat in <span class=filename>/A1</span> stond is tijdelijk verborgen en komt tevoorschijn als `B`is _ontkoppeld_van A.</p></div><div class=paragraph><p>Als <code>B</code> gekoppeld is onder <code>A2</code> ziet de diagram er als volgt uit:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/example-dir3.png alt="example dir3"></div></div><div class=paragraph><p>en de paden zouden dan respectievelijk <span class=filename>/A2/B1</span> en <span class=filename>/A2/B2</span> zijn.</p></div><div class=paragraph><p>Bestandssystemen kunnen op elkaar worden gekoppeld. Doorgaand op het vorige voorbeeld kan het bestandssysteem <code>C</code> gekoppeld worden bovenop de map <code>B1</code> in het bestandssysteem <code>B</code>. Dit resulteert in:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/example-dir4.png alt="example dir4"></div></div><div class=paragraph><p>Of <code>C</code> kan direct onder het bestandssysteem <code>A</code> gekoppeld worden, onder de map <code>A1</code>:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/example-dir5.png alt="example dir5"></div></div><div class=paragraph><p>Hoewel het niet gelijk is, lijkt het op het gebruik van <code>join</code> in MS-DOS®.</p></div><div class=paragraph><p>Beginnende gebruikers hoeven zich hier gewoonlijk niet mee bezig te houden. Normaal gesproken worden bestandssystemen gemaakt als FreeBSD wordt geïnstalleerd en er wordt besloten waar ze gekoppeld worden. Meestal worden ze ook niet gewijzigd tot er een nieuwe schijf aan een systeem wordt toegevoegd.</p></div><div class=paragraph><p>Het is mogelijk om één groot root bestandssysteem te hebben en geen andere. Deze benadering heeft voordelen en nadelen.</p></div><div class=ulist><div class=title>Voordelen van meerdere bestandssystemen</div><ul><li><p>Verschillende bestandssystemen kunnen verschillende <em>mount opties</em> hebben. Met een goede voorbereiding kan het root bestandssysteem bijvoorbeeld als alleen-lezen gekoppeld worden, waardoor het onmogelijk wordt om per ongeluk kritische bestanden te verwijderen of te bewerken. Het scheiden van andere bestandssystemen die beschrijfbaar zijn door gebruikers, zoals <span class=filename>/home</span> van andere bestandssystemen stelt de beheerder in staat om ze <em>nosuid</em> te koppelen. Deze optie voorkomt dat <em>suid</em>/<em>guid</em> bits op uitvoerbare bestanden effectief gebruikt kunnen worden, waardoor de beveiliging mogelijk beter wordt.</p></li><li><p>FreeBSD optimaliseert automatisch de layout van bestanden op een bestandssysteem, afhankelijk van hoe het bestandssysteem wordt gebruikt. Een bestandsysteem dat veel bestanden bevat waar regelmatig naar geschreven wordt, wordt anders geoptimaliseerd dan een bestandssysteem dat minder maar grotere bestanden bevat. Door het gebruik van één groot bestandssysteem werkt deze optimalisatie niet.</p></li><li><p>FreeBSD’s bestandssystemen zijn erg robuust als er bijvoorbeeld een stroomstoring is, hoewel een stroomstoring op een kritiek moment nog steeds kan leiden tot schade aan de structuur van het bestandssysteem. Door het verdelen van data over meerdere bestandssystemen, is de kans groter dat het systeem nog opstart, wat terugzetten van een back-up makkelijker maakt als dat nodig is.</p></li></ul></div><div class=ulist><div class=title>Voordeel van één bestandssysteem</div><ul><li><p>Bestandssystemen hebben een vaste grootte. Als bij de installatie van FreeBSD een bestandssysteem wordt gemaakt, is het later mogelijk dat de partitie groter gemaakt moet worden. Dit is niet zo makkelijk zonder een back-up, het opnieuw maken van het bestandssysteem met gewijzigde grootte en het terugzetten van de geback-upte gegevens.</p><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>FreeBSD heeft <a href="https://man.freebsd.org/cgi/man.cgi?query=growfs&amp;sektion=8&amp;format=html">growfs(8)</a> waarmee de grootte van het bestandssysteem is aan te passen terwijl het draait.</p></div></td></tr></tbody></table></div></li></ul></div><div class=paragraph><p>Bestandssystemen worden opgeslagen in partities. Dit betekent niet hetzelfde als de algemene betekenis van de term partitie (bijvoorbeeld, MS-DOS® partitie), vanwege FreeBSD’s UNIX® achtergrond. Elke partitie wordt geïdentificeerd door een letter van <code>a</code> tot en met <code>h</code>. Elke partitie kan slechts één bestandssysteem hebben, wat betekent dat bestandssystem vaak omschreven worden aan de hand van hun koppelpunt in de bestandssysteem hiërarchie of de letter van de partitie waar ze in opgeslagen zijn.</p></div><div class=paragraph><p>FreeBSD gebruikt ook schijfruimte voor <em>wisselbestanden</em>. Wisselbestanden geven FreeBSD <em>virtueel geheugen</em>. Dit geeft de computer de mogelijkheid om net te doen alsof er veel meer geheugen in de machine aanwezig is dan werkelijk het geval is. Als FreeBSD geen geheugen meer heeft, verplaatst het data die op dat moment niet gebruikt wordt naar de wisselbestanden en plaatst het terug als het wel nodig is (en zet iets anders in ruil daarvoor terug).</p></div><div class=paragraph><p>Aan sommige partities zijn bepaalde conventies gekoppeld.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Partitie</th><th class="tableblock halign-left valign-top">Conventie</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>a</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Bevat meestal het root bestandssysteem</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>b</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Bevat meestal de swapruimte</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>c</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Heeft meestal dezelfde grootte als de hele harde schijf. Dit geeft hulpprogramma’s de mogelijkheid om op een complete schijf te werken (voor bijvoorbeeld een bad block scanner) om te werken op de <code>c</code> partitie. Meest wordt hierop dan ook geen bestandssysteem gecreeërd.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>d</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Partitie <code>d</code> had vroeger een speciale betekenis, maar die is verdwenen. <code>d</code> zou nu kunnen werken als een normale partitie.</p></td></tr></tbody></table><div class=paragraph><p>Elke partitie die een bestandssysteem bevat is opgeslagen in wat FreeBSD noemt een <em>slice</em>. Slice is FreeBSD’s term voor wat meeste mensen partities noemen. Dit komt wederom door FreeBSD’s UNIX® achtergrond. Slices zijn genummerd van 1 tot en met 4.</p></div><div class=paragraph><p>Slicenummers volgen de apparaatnamen, voorafgegaan door een <code>s</code> die begint bij 1. Dus "da0_s1_" is de eerste slice op de eerste SCSI drive. Er kunnen maximaal vier fysieke slices op een schijf staan, maar er kunnen logische slices in fysieke slices van het correcte type staan. Deze uitgebreide slices zijn genummerd vanaf 5. Dus "ad0_s5_" is de eerste uitgebreide slice op de eerste IDE schijf. Deze apparaten worden gebruikt door bestandssystemen waarvan verwacht wordt dat ze een slice in beslag nemen.</p></div><div class=paragraph><p>Slices, "gevaarlijk toegewijde" (dangerously dedicated) fysieke drivers en andere drives bevatten <em>partities</em>, die worden weergegeven door letters vanaf <code>a</code> tot <code>h</code>. Deze letter wordt achter de apparaatnaam geplakt. Dus "da0_a_" is de a partitie op de eerste da drive, die "gevaarlijk toegewijd" is. "ad1s3_e_" is de vijfde partitie op de derde slice van de tweede IDE schijf.</p></div><div class=paragraph><p>Elke schijf op het systeem wordt geïdentificeerd. Een schijfnaam start met een code die het type aangeeft en dan een nummer dat aangeeft welke schijf het is. In tegenstelling tot bij slices, start het nummeren van schijven bij 0. Standaardcodes staan beschreven in <a href=#basics-dev-codes>Schijf apparaatcodes</a>.</p></div><div class=paragraph><p>Bij een referentie aan een partitie verwacht FreeBSD ook dat de slice en schijf refereert naar die partitie en als naar een slice wordt verwezen moet ook de schijfnaam genoemd worden. Dit kan door de schijfnaam, <code>s</code>, het slice nummer en de partitieletter aan te geven. Voorbeelden staan in <a href=#basics-disk-slice-part>Voorbeeld schijf-, slice- en partitienamen</a>.</p></div><div class=paragraph><p>In <a href=#basics-concept-disk-model>Conceptmodel van een schijf</a> staat een conceptmodel van een schijflayout die een en ander verduidelijkt.</p></div><div class=paragraph><p>Voordat FreeBSD geïnstalleerd kan worden moeten eerst de schijfslices gemaakt worden en daarna moeten de partities op de slices voor FreeBSD gemaakt worden. Daarna wordt op elke partitie het bestandssysteem (of wisselbestand) gemaakt en als laatste wordt besloten waar het filesysteem gekoppeld wordt.</p></div><table id=basics-dev-codes class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 5. Schijf apparaatcodes</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Code</th><th class="tableblock halign-left valign-top">Betekenis</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>ad</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ATAPI (IDE) schijf</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>da</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI directe toegang schijf</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>acd</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ATAPI (IDE) CDROM</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>cd</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI CDROM</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>fd</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Floppydisk</p></td></tr></tbody></table><div id=basics-disk-slice-part class=exampleblock><div class=title>Voorbeeld 3. Voorbeeld schijf-, slice- en partitienamen</div><div class=content><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Name</th><th class="tableblock halign-left valign-top">Betekenis</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ad0s1a</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De eerste partitie (<code>a</code>) op de eerste slice (<code>s1</code>) op de eerste IDE schijf (<code>ad0</code>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>da1s2e</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De vijfde partitie (<code>e</code>) op de tweede slice (<code>s1</code>) op de tweede SCSI schijf (<code>da1</code>).</p></td></tr></tbody></table></div></div><div id=basics-concept-disk-model class=exampleblock><div class=title>Voorbeeld 4. Conceptmodel van een schijf</div><div class=content><div class=paragraph><p>Het onderstaande diagram geeft aan hoe FreeBSD de eerste IDE schijf in het systeem ziet. Stel dat de schijf 4 GB groot is en dat deze twee 2 GB slices (MS-DOS® partities) bevat. De eerste slice bevat een MS-DOS® schijf, <span class=filename>C:</span> en de tweede slice bevat een FreeBSD installatie. Deze FreeBSD installatie heeft drie partities en een partitie met een wisselbestand.</p></div><div class=paragraph><p>De drie partities hebben elk een bestandssysteem. Partitie <code>a</code> wordt gebruikt voor het root bestandssysteem, <code>e</code> voor de map <span class=filename>/var</span> en <code>f</code> voor de map <span class=filename>/usr</span>.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/disk-layout.png alt="disk layout"></div></div></div></div></div><div class=sect2><h3 id=mount-unmount>4.6. Het koppelen en ontkoppelen van bestandssystemen<a class=anchor href=#mount-unmount></a></h3><div class=paragraph><p>Het bestandssysteem wordt het best weergegeven als een boom, met de stam als <span class=filename>/</span>. <span class=filename>/dev</span>, <span class=filename>/usr</span> en de andere map in root zijn takken die weer hun eigen takken kunnen hebben, zoals <span class=filename>/usr/local</span>, etc.</p></div><div class=paragraph><p>Er zijn verschillende redenen om sommige van deze mappen op aparte bestandssystemen te plaatsen. <span class=filename>/var</span> bevat de mappen <span class=filename>log/</span>, <span class=filename>spool/</span> en verschillende types tijdelijke bestanden en kan volraken. Het laten vollopen van het root bestandssysteem is geen goed idee, dus het splitsen van <span class=filename>/var</span> van <span class=filename>/</span> is vaak de favoriet.</p></div><div class=paragraph><p>Een andere vaak voorkomende reden om bepaalde mapbomen op aparte bestandssystemen te plaatsen, is om ze op verschillende fysieke schrijven te zetten of gescheiden virtuele schijven zoals gemounte <a href=./#network-nfs>Netwerk bestandssystemen</a> of cd-rom drives.</p></div><div class=sect3><h4 id=disks-fstab>4.6.1. Het bestand <span class=filename>fstab</span><a class=anchor href=#disks-fstab></a></h4><div class=paragraph><p>Tijdens het <a href=./#boot>opstartproces</a>, worden bestandssystemen die vermeld staan in <span class=filename>/etc/fstab</span> automatisch gekoppeld (tenzij ze vermeld staan met <code>noauto</code>).</p></div><div class=paragraph><p><span class=filename>/etc/fstab</span> bevat een lijst van regels die aan het volgende formaat voldoen:</p></div><div class="literalblock programlisting"><div class=content><pre>apparaat        /koppelpunt fstype     opties      dumpfreq     passno</pre></div></div><div class=dlist><dl><dt class=hdlist1><code>apparaat</code></dt><dd><p>Een apparaatnaam (die moet bestaan) zoals uitgelegd in <a href=./#disks-naming>Apparaatnamen</a>.</p></dd><dt class=hdlist1><code>koppelpunt</code></dt><dd><p>Een map (die moet bestaan) waarop het bestandssysteem gekoppeld moet worden.</p></dd><dt class=hdlist1><code>fstype</code></dt><dd><p>Het bestandssysteem type dat aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> gegeven wordt. Het standaard FreeBSD bestandssysteem is <code>ufs</code>.</p></dd><dt class=hdlist1><code>opties</code></dt><dd><p>Dit is of <code>rw</code> voor lezen en schrijven bestandssytemen, of <code>ro</code> voor alleen lezen, gevolgd door elke andere optie die mogelijk nodig is. Een standaard optie is <code>noauto</code> voor bestandssystemen die niet automatisch gekoppeld worden tijdens het opstarten. Andere opties staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>.</p></dd><dt class=hdlist1><code>dumpfreq</code></dt><dd><p>Dit wordt gebruikt door <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> om te bepalen welke bestandssystemen gedumpt moeten worden. Als het veld niet is ingevuld, wordt aangenomen dat er een nul staat.</p></dd><dt class=hdlist1><code>passno</code></dt><dd><p>Dit bepaalt in welke volgorde bestandssystemen gecontroleerd moeten worden. Bestandssystemen die overgeslagen moeten worden moeten hun <code>passno</code> waarde op nul hebben staan. Voor het root bestandssysteem (dat voor alle andere gecontroleerd moet worden) moet <code>passno</code> op één staan en <code>passno</code> waarden voor andere bestandssystemen moeten een waarde hebben groter dan één. Als bestandssysteem dezelfde <code>passno</code> waarde hebben probeert <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> deze bestandssystemen tegelijkertijd te controleren.</p></dd></dl></div><div class=paragraph><p>In <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> staat meer informatie over de opmaak van <span class=filename>/etc/fstab</span> en de mogelijke opties.</p></div></div><div class=sect3><h4 id=disks-mount>4.6.2. Het commando <code>mount</code><a class=anchor href=#disks-mount></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> wordt gebruikt om bestandsystemen te koppelen.</p></div><div class=paragraph><p>De meest eenvoudige vorm is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount apparaat koppelpunt</span></code></pre></div></div><div class=paragraph><p>Alle opties voor het commando staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>, maar de meest voorkomende zijn:</p></div><div class=dlist><div class=title>Mountopties</div><dl><dt class=hdlist1><code>-a</code></dt><dd><p>Mount alle bestandssystemen die in <span class=filename>/etc/fstab</span> staan, behalve die gemarkeerd staan als "noauto", uitgesloten zijn door de optie <code>-t</code> of die al gekoppeld zijn.</p></dd><dt class=hdlist1><code>-d</code></dt><dd><p>Doe alles behalve het echt aanroepen van de systeemopdracht <code>mount</code>. Deze optie is handig in samen met de optie <code>-v</code> om te bepalen wat <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> eigenlijk probeert te doen.</p></dd><dt class=hdlist1><code>-f</code></dt><dd><p>Forceert het koppelen van een niet schoon bestandssysteem (gevaarlijk) of forceert het innemen van schrijftoegang als de koppelstatus van een bestandssysteem wijzigt van lezen en schrijven naar alleen lezen.</p></dd><dt class=hdlist1><code>-r</code></dt><dd><p>Mount het bestandssysteem alleen lezen. Dit is identiek aan de optie <code>ro</code> voor de optie <code>-o</code>.</p></dd><dt class=hdlist1><code>-t</code> <em>fstype</em></dt><dd><p>Mount het opgegeven bestandssysteem als het opgegeven type bestandssysteem of koppelt alleen bestandssystemen van het aangegeven type als ook de optie <code>-a</code> is opgegeven.</p><div class=paragraph><p>"ufs" is het standaard bestandssysteem.</p></div></dd><dt class=hdlist1><code>-u</code></dt><dd><p>Werk koppel opties van het bestandssysteem bij.</p></dd><dt class=hdlist1><code>-v</code></dt><dd><p>Geef uitgebreide informatie (verbose).</p></dd><dt class=hdlist1><code>-w</code></dt><dd><p>Mount het bestandssysteem lezen en schrijven.</p></dd></dl></div><div class=paragraph><p>De optie <code>-o</code> accepteert een door komma’s gescheiden lijst van opties, waaronder de volgende:</p></div><div class=dlist><dl><dt class=hdlist1>noexec</dt><dd><p>Sta geen uitvoerbare bestanden toe op dit bestandssysteem. Ook dit is een nuttige veiligheidsoptie.</p></dd><dt class=hdlist1>nosuid</dt><dd><p>Interpreteer geen setuid of setgid opties op het bestandssysteem. Ook dit is een nuttige veiligheidsoptie.</p></dd></dl></div></div><div class=sect3><h4 id=disks-umount>4.6.3. Het commando <code>umount</code><a class=anchor href=#disks-umount></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=umount&amp;sektion=8&amp;format=html">umount(8)</a> heeft een koppelpunt, een apparaatnaam, <code>-a</code> of <code>-A</code> als parameter.</p></div><div class=paragraph><p>Alle vormen kunnen de optie <code>-f</code> hebben om een bestandsysteem te forceren te ontkoppelen en de optie <code>-v</code> voor uitgebreide informatie. De optie <code>-f</code> is meestal geen goed idee. Forceren dat een bestandssysteem ontkoppeld wordt kan de computer laten crashen of data op het bestandssysteem beschadigen.</p></div><div class=paragraph><p>De opties <code>-a</code> en <code>-A</code> worden gebruikt om alle bestandssystemen te unmounten, mogelijk nader gespecificeerd door de optie <code>-t</code> met daarachter op welke typen bestandssystemen het betrekking heeft. Voor de optie <code>-A</code> geldt dat deze niet probeert het root bestandssysteem te ontkoppelen.</p></div></div></div><div class=sect2><h3 id=basics-processes>4.7. Processen<a class=anchor href=#basics-processes></a></h3><div class=paragraph><p>FreeBSD is een multi-tasking besturingssysteem. Dit betekent dat het lijkt alsof er meer dan één proces tegelijkertijd draait. Elk programma dat draait wordt een <em>proces</em> genoemd. Elk commando dat wordt uitgevoerd start op zijn minst één nieuw proces en er zijn systeemprocessen die continu draaien om het systeem functioneel te houden.</p></div><div class=paragraph><p>Elk proces wordt geïdentificeerd door een nummer dat <em>process ID</em> of <em>PID</em> heet, en net zoals bij bestanden heeft elk proces één eigenaar en groep. De eigenaars- en groepsinformatie wordt gebruikt om te bepalen welke bestanden en apparaten het proces mag openen, waarbij gebruik wordt gemaakt van de bestandsrechten die eerder zijn behandeld. Veel processen hebben ook een ouderproces (parent process). Een ouderproces is een proces dat het nieuwe proces heeft gestart. Als commando’s in een shell worden ingevoerd, start de shell een proces en elk commando dat draait is ook een proces. De uitzondering hierop is het speciale proces <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a>. <code>init</code> is altijd het eerste proces, dus het PID is altijd 1. <code>init</code> wordt automatisch gestart door de kernel als FreeBSD opstart.</p></div><div class=paragraph><p>Twee commando’s die erg handig zijn om te zien welke processen er draaien zijn <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a>. <code>ps</code> wordt gebruikt om een statische lijst op te vragen van de processen die op het moment van uitvoeren draaien en kan hun PID, geheugengebruik, de startende commandoregel, enzovoort, tonen. <code>top</code> geeft alle draaiende processen weer en werkt de status elke paar seconden bij zodat interactief wordt weergegeven wat een computer aan het doen is.</p></div><div class=paragraph><p>Standaard laat <code>ps</code> alleen zien welke commando’s draaien waarvan de gebruiker die het uitvoert de eigenaar is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ps
  PID  TT  STAT      TIME COMMAND
  298  p0  Ss     0:01.10 tcsh
 7078  p0  S      2:40.88 xemacs mdoc.xsl <span class=o>(</span>xemacs-21.1.14<span class=o>)</span>
37393  p0  I      0:03.11 xemacs freebsd.dsl <span class=o>(</span>xemacs-21.1.14<span class=o>)</span>
48630  p0  S      2:50.89 /usr/local/lib/netscape-linux/navigator-linux-4.77.bi
48730  p0  IW     0:00.00 <span class=o>(</span>dns helper<span class=o>)</span> <span class=o>(</span>navigator-linux-<span class=o>)</span>
72210  p0  R+     0:00.00 ps
  390  p1  Is     0:01.14 tcsh
 7059  p2  Is+    1:36.18 /usr/local/bin/mutt <span class=nt>-y</span>
 6688  p3  IWs    0:00.00 tcsh
10735  p4  IWs    0:00.00 tcsh
20256  p5  IWs    0:00.00 tcsh
  262  v0  IWs    0:00.00 <span class=nt>-tcsh</span> <span class=o>(</span>tcsh<span class=o>)</span>
  270  v0  IW+    0:00.00 /bin/sh /usr/X11R6/bin/startx <span class=nt>--</span> <span class=nt>-bpp</span> 16
  280  v0  IW+    0:00.00 xinit /home/nik/.xinitrc <span class=nt>--</span> <span class=nt>-bpp</span> 16
  284  v0  IW     0:00.00 /bin/sh /home/nik/.xinitrc
  285  v0  S      0:38.45 /usr/X11R6/bin/sawfish</code></pre></div></div><div class=paragraph><p>In het bovenstaande voorbeeld is de uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> georganiseerd in een aantal kolommen. <code>PID</code> is het proces ID. PIDs worden toegekend vanaf 1 en lopen op tot 99999. Als ze allemaal zijn gebruikt, worden ze hergebruikt. (een PID wordt niet hergebruikt als deze reeds in gebruik is). De <code>TT</code> kolom toont de tty vanwaar het programma draait en wordt nu buiten beschouwing gelaten. <code>STAT</code> toont de huidige staat van het programma en ook deze kolom wordt buiten beschouwing gelaten. <code>TIME</code> is de hoeveelheid tijd die het programma gedraaid heeft op de CPU. Dit is meestal niet de verstreken tijd vanaf het moment dat het programma is gestart. Veel programma’s wachten omdat er alleen gebruik wordt gemaakt van de CPU als er iets voor het programma te doen is. Als laatste is <code>COMMAND</code> de commandoregel die gebruikt is om het programma te starten.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> ondersteunt een aantal opties die de informatie wijzigen die wordt weergegeven. Één van de meest nuttige combinaties is <code>auxww</code>. De optie <code>a</code> toont informatie over alle draaiende processen, niet alleen die van de gebruiker die is aangemeld. De optie <code>u</code> toont de gebruikersnaam van de proceseigenaar, evenals geheugengebruik. De optie <code>x</code> toont informatie over daemonprocessen en met de optie <code>ww</code> laat <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> de volledige commandoregel zien voor elk proces, in plaats van een mogelijk afgekorte regel omdat die te lang is om op het scherm te passsen.</p></div><div class=paragraph><p>De uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> is hetzelfde:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% top
last pid: 72257<span class=p>;</span>  load averages:  0.13,  0.09,  0.03    up 0+13:38:33  22:39:10
47 processes:  1 running, 46 sleeping
CPU states: 12.6% user,  0.0% <span class=nb>nice</span>,  7.8% system,  0.0% interrupt, 79.7% idle
Mem: 36M Active, 5256K Inact, 13M Wired, 6312K Cache, 15M Buf, 408K Free
Swap: 256M Total, 38M Used, 217M Free, 15% Inuse

  PID USERNAME PRI NICE  SIZE    RES STATE    TIME   WCPU    CPU COMMAND
72257 nik	28   0  1960K  1044K RUN      0:00 14.86%  1.42% top
 7078 nik	2   0 15280K 10960K <span class=k>select   </span>2:54  0.88%  0.88% xemacs-21.1.14
  281 nik	2   0 18636K  7112K <span class=k>select   </span>5:36  0.73%  0.73% XF86_SVGA
  296 nik	2   0  3240K  1644K <span class=k>select   </span>0:12  0.05%  0.05% xterm
48630 nik	2   0 29816K  9148K <span class=k>select   </span>3:18  0.00%  0.00% navigator-linu
  175 root	2   0   924K   252K <span class=k>select   </span>1:41  0.00%  0.00% syslogd
 7059 nik	2   0  7260K  4644K poll     1:38  0.00%  0.00% mutt
...</code></pre></div></div><div class=paragraph><p>De uitvoer is gesplitst in twee secties. De kop (de eerste vijf regels) toont het laatst uitgegeven PID, de gemiddelde systeembelasting (hoe druk is een systeem), de uptime van het systeem (tijd verstreken sinds laatste reboot) en de huidige tijd. De andere cijfers in de kop tonen hoeveel processen er draaien (in dit geval 47) , hoeveel geheugen en swap er gebruikt wordt en hoeveel processortijd het systeem besteed aan verschillende taakgroepen.</p></div><div class=paragraph><p>Daaronder staat een serie van kolommen die soortgelijke informatie bevatten als de uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a>. Zo zijn het PID, de gebruikersnaam, de hoeveelheid processortijd en het commando dat gebruikt is om het proces te starten te zien. <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> laat standaard ook zien hoeveel geheugen er gebruikt wordt door een proces. Dit staat in twee kolommen waarbij in de eerste kolom het maximale geheugengebruik wordt getoond en in de tweede kolom het huidige geheugengebruik. Maximale gebruik is de hoeveelheid geheugen die het proces nodig had in de tijd dat het bestaat en het residente gebruik is hoeveel er op het moment van weergeven gebruikt wordt. In dit voorbeeld is zichtbaar dat <a href="https://man.freebsd.org/cgi/man.cgi?query=getenv&amp;sektion=3&amp;format=html">getenv(3)</a> bijna 30 MB RAM nodig had, maar op het moment van uitvoeren 9 MB verbruikt.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> werkt het beeld automatisch iedere twee seconden bij. Dat kan gewijzigd worden met de optie <code>s</code>.</p></div></div><div class=sect2><h3 id=basics-daemons>4.8. Daemons, signalen en het stoppen van processen<a class=anchor href=#basics-daemons></a></h3><div class=paragraph><p>Als een gebruiker een editor draait is het makkelijk om de editor te besturen, te vertellen om bestanden te openen, etc. Dit kan omdat de editor de mogelijkheden geeft om dat te doen en omdat de editor gekoppeld is aan een <em>terminal</em>. Sommige programma’s zijn niet ontworpen om te draaien met continue gebruikersinvoer, dus als zij de kans krijgen ontkoppelen zij zich van de terminal. Een webserver reageert bijvoorbeeld de hele dag op webaanvragen en heeft eigenlijk geen input van een lokale gebruiker nodig. Programma’s die email van locatie naar locatie transporteren zijn een ander voorbeeld.</p></div><div class=paragraph><p>Deze programma’s heten <em>daemons</em>. Daemons waren karakters in de Griekste mythologie, goed noch slecht, ze waren dienende geesten die op grote schaal nuttige dingen deden voor de mensheid. Net zoals de huidige webservers en mailservers nuttige dingen doen. Dit is waarom de mascotte voor BSD al lang een vrolijk kijkende daemon met puntoren en een drietand is.</p></div><div class=paragraph><p>Er is een overeenkomst om programma’s die meestal draaien als daemon te voorzien van het achtervoegsel "d". BIND is de Berkeley Internet Name Domain (het echte programma heet <code>named</code>), de Apache webserver heet <code>httpd</code>, de printerspooldriver heet <code>lpd</code>, etc. Deze overeenkomst geldt niet altijd. De hoofd maildaemon voor Sendmail heet bijvoorbeeld <code>sendmail</code> en niet <code>maild</code>.</p></div><div class=paragraph><p>Soms is communicatie met een daemon nodig. Een manier om dit te doen is het versturen van een signaal (<em>signals</em>). Er zijn een verschillende signalen. Sommige hebben een specifieke bedoeling, andere worden geïntrepeteerd door de applicatie. In de documentatie van de applicatie staat hoe de applicatie signalen intrepeteert. Er kan alleen een signaal naar een proces gezonden worden waar de uitvoerende gebruiker eigenaar van is. Als met <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=2&amp;format=html">kill(2)</a> een signaal naar een proces van een andere gebruiker wordt gestuurd, wordt de toegang geweigerd. De enige uitzondering hierop is de <code>root</code> gebruiker, die signalen naar processen van alle gebruikers kan sturen.</p></div><div class=paragraph><p>FreeBSD stuurt soms ook signalen naar applicaties. Als een applicatie slecht geschreven is en hij probeert geheugen te benaderen waar hij niet naartoe mag, stuurt FreeBSD het proces een <em>Segmentation Violation</em> signaal (<code>SIGSEGV</code>). Als een applicatie de systeemaanroep <a href="https://man.freebsd.org/cgi/man.cgi?query=alarm&amp;sektion=3&amp;format=html">alarm(3)</a> heeft gebruikt om na een bepaalde periode een alarm te ontvangen, wordt er een Alarm signaal heen gestuurd (<code>SIGALRM</code>), etc.</p></div><div class=paragraph><p>Twee signalen kunnen gebruikt worden om een proces te stoppen: <code>SIGTERM</code> en <code>SIGKILL</code>. <code>SIGTERM</code> is de nette manier om een proces te killen. Het proces kan het signaal <em>afvangen</em>, begrijpen dat de eigenaar wil dat het wordt afgesloten, wellicht logboekbestanden sluiten die geopend zijn en alle onderhanden activiteiten afhandelen. In een aantal gevallen kan een proces <code>SIGTERM</code> negeren: als het midden in een taak zit die niet beëindigd kan worden.</p></div><div class=paragraph><p><code>SIGKILL</code> mag niet worden genegeerd door een proces. Dit is het "Wat je ook aan het doen bent, stop er nu mee" signaal. Na een <code>SIGKILL</code> stopt FreeBSD het proces meteen.</p></div><div class=paragraph><p>Andere veelgebruikte signalen zijn <code>SIGHUP</code>, <code>SIGUSR1</code> en <code>SIGUSR2</code>. Dit zijn algemeen bruikbare signalen en verschillende applicaties zullen verschillend reageren als ze verstuurd worden.</p></div><div class=paragraph><p>Stel dat het bestand met instellingen voor de webserver is aangepast. Dan moet aan de webserver verteld worden dat die de instellingen opnieuw moet lezen. Hiervoor zou <code>httpd</code> gestopt en gestart kunnen worden, maar dit resulteert in een korte onderbreking van de webserverdienst, wat ongewenst kan zijn. De meeste daemons zijn geschreven om te reageren op het <code>SIGHUP</code> signaal door het opnieuw inlezen van het instellingenbestand. Dus in plaats van het stoppen en herstarten van <code>httpd</code> kan het <code>SIGHUP</code> signaal gezonden worden. Omdat er geen standaard manier is om op deze signalen te reageren, reageren verschillende daemons anders. Het is verstandig eerst de documentatie van de daemon in kwestie te lezen.</p></div><div class=paragraph><p>Zoals onderstaand voorbeeld laat zien, worden signalen door <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> verzonden.</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Het versturen van een signaal naar een proces</strong></p></div><div class=paragraph><p>Dit voorbeeld toont hoe een signaal naar <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> wordt verstuurd. Het bestand met instellingen voor <code>inetd</code> is <span class=filename>/etc/inetd.conf</span> en <code>inetd</code> leest dit bestand opnieuw in als er een <code>SIGHUP</code> wordt verstuurd.</p></div><div class="olist arabic"><ol class=arabic><li><p>Eerst moet het proces ID worden opgezocht van het proces waar een signaal naar verzonden moeten worden. Dit kan door <a href="https://man.freebsd.org/cgi/man.cgi?query=pgrep&amp;sektion=1&amp;format=html">pgrep(1)</a> te gebruiken.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% pgrep <span class=nt>-l</span> inetd
198  inetd <span class=nt>-wW</span></code></pre></div></div><div class=paragraph><p>Dus het PID van <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> is 198.</p></div></li><li><p>Met <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> kan het signaal verzonden worden. Omdat <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> wordt gedraaid door <code>root</code> moet <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> gebruikt worden om <code>root</code> te worden.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% su
Password:
<span class=c># /bin/kill -s HUP 198</span></code></pre></div></div><div class=paragraph><p>Zoals zovaak met UNIX® commando’s, geeft <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> geen uitvoer als het succesvol uitgevoerd is. Als een signaal wordt verzonden naar een proces waarvan de gebruiker niet zelf de eigenaar is, dan is de melding: <code>kill: <em>PID</em>: Operation not permitted</code>. Als het PID verkeerd wordt ingevuld, wordt het signaal naar het verkeerde proces verzonden, wat slecht kan zijn, of, als de gebruiker geluk heeft, wordt het verzonden naar een PID dat momenteel niet in gebruik is, waarop de foutmelding <code>kill: <em>PID</em>: No such process</code> verschijnt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=title>Waarom <code>/bin/kill</code> gebruiken?</div><div class=paragraph><p>Veel shells leveren <code>kill</code> als ingebouwd commando. Dat betekent dat de shell het signaal direct verstuurt in plaats van door het starten van <span class=filename>/bin/kill</span>. Dit kan erg nuttig zijn, maar verschillende shells hebben een verschillende opdrachtregel voor het specificeren van de naam van het signaal dat verstuurd moet worden. In plaats van ze allemaal te leren, is het eenvoudiger om gewoon <code>/bin/kill PID</code> te gebruiken.</p></div></td></tr></tbody></table></div></li></ol></div></div></div><div class=paragraph><p>Andere signalen versturen werkt bijna hetzelfde door <code>TERM</code> of <code>KILL</code> op de commandoregel te vervangen door wat nodig is.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Het stoppen van willekeurige processen op een systeem is meestal een slecht idee. In het bijzonder bij <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> met proces ID 1. Het draaien van <code>/bin/kill -s KILL 1</code> is een snelle manier om een systeem uit te zetten. Argumenten die aan <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> worden meegegeven moeten <em>altijd</em> twee keer gecontroleerd worden <em>voordat</em> op <kbd>Enter</kbd> gedrukt wordt.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=shells>4.9. Shells<a class=anchor href=#shells></a></h3><div class=paragraph><p>In FreeBSD wordt een groot deel van het alledaagse werk gedaan vanuit een omgeving met een commandoregel die shell heet. De grootste taak van een shell is om commando’s van het invoerkanaal op te vangen en deze uit te voeren. Veel shells hebben ook functies ingebouwd om mee te helpen om alledaagse taken zoals bestandsbeheer, bestandsglobbing, bestanden wijzigen vanaf de commandoregel, commandomacro’s schrijven en uitvoeren en omgevingsvariabelen instellen en wijzigen. FreeBSD heeft een aantal shells bijgeleverd zoals <code>sh</code>, de Bourne Shell en <code>tcsh</code>, de verbeterde C-shell. Er zijn veel andere shells beschikbaar in de FreeBSD Portscollectie zoals <code>zsh</code> en <code>bash</code>.</p></div><div class=paragraph><p>Welke shell gebruiken? Dit is een kwestie van smaak. Een C-programmeur voelt zich misschien prettiger bij een C-achtige shell, zoals <code>tcsh</code>. Een voormalig Linux® gebruiker of iemand die niet veel ervaring heeft met een UNIX® commandoregel interface wil misschien <code>bash</code> proberen. Elke shell heeft zijn eigen unieke eigenschappen die wel of niet werken voor een bepaalde gebruiker.</p></div><div class=paragraph><p>Een standaard optie in een shell is bestandsnaam completie. Door het intikken van de eerste paar letters van een commando of bestandsnaam, kan de shell opdracht gegeven worden om automatisch de rest het commando of bestandsnaam toe te voegen met de <kbd>Tab</kbd> toets op het toetsenbord. Stel dat er twee bestanden zijn met de namen <span class=filename>foobar</span> en <span class=filename>foo.bar</span> en <span class=filename>foo.bar</span> moet verwijderd worden. Dan kan op het toetsenbord <code>rm fo[Tab].[Tab]</code> ingevoerd worden.</p></div><div class=paragraph><p>De shell geeft <code>rm foo[BEEP].bar</code> weer.</p></div><div class=paragraph><p>De [BEEP] geeft aan dat de shell in staat was om de bestandsnaam te completeren omdat er meer dan één soortgelijk bestand was. <span class=filename>foobar</span> en <span class=filename>foo.bar</span> beginnen met <code>fo</code>, maar het was in staat om het af te maken tot <code>foo</code>. Na het invoeren van een <code>.</code> en daarna <kbd>Tab</kbd>, is de shell in staat om de rest van de bestandsnaam aan te vullen.</p></div><div class=paragraph><p>Een andere optie van de shell is het gebruik van omgevingsvariabelen. Omgevingsvariabelen zijn variabele sleutelparen die opgeslagen zijn in de omgevingsruimte van een shell. Deze ruimte kan uitgelezen worden door elk programma dat door de shell wordt uitgevoerd en bevat dus veel programmainstellingen. Hieronder staat een lijst van standaard omgevingsvariabelen en wat ze betekenen:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Variabele</th><th class="tableblock halign-left valign-top">Omschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gebruikersnaam van de gebruiker die is aangemeld.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een lijst van mappen, gescheiden door een <code>:</code> voor het zoeken naar binaire bestanden.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>DISPLAY</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Netwerknaam van het X11 scherm om verbinding mee te maken, indien beschikbaar.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>SHELL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De huidige shell.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>TERM</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De naam van de huidige gebruikersterminal. Gebruikt om de mogelijkheden van de terminal te bepalen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>TERMCAP</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Databaseregel met terminal escape codes voor het uitvoeren van diverse terminalfuncties.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>OSTYPE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Type besturingssysteem, bijvoorbeeld FreeBSD.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>MACHTYPE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De CPU architectuur waar het systeem op draait.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>EDITOR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De teksteditor waar de gebruiker de voorkeur aan geeft.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PAGER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De tekstpager waar de gebruiker de voorkeur aan geeft.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>MANPATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lijst van mappen gescheiden door een <code>:</code> voor het zoeken naar handleidingen.</p></td></tr></tbody></table><div class=paragraph><p>Het instellen van omgevingsvariabelen verschilt van shell tot shell. In de C-achtige shells zoals <code>tcsh</code> en <code>csh</code> moet <code>setenv</code> gebruikt worden om omgevingsvariabelen in te stellen. In Bourne-shells zoals <code>sh</code> en <code>bash</code> moet <code>export</code> gebruikt worden om de omgevingsvariabelen in te stellen. Om bijvoorbeeld de omgevingsvariabele <code>EDITOR</code> te wijzigen naar <span class=filename>/usr/local/bin/emacs</span> onder <code>csh</code> of <code>tcsh</code> moet het volgende gedaan worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setenv EDITOR /usr/local/bin/emacs</code></pre></div></div><div class=paragraph><p>In Bourne shells is dat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>export </span><span class=nv>EDITOR</span><span class=o>=</span><span class=s2>&#34;/usr/local/bin/emacs&#34;</span></code></pre></div></div><div class=paragraph><p>Met de meeste shells kunnen de omgevingsvariabelen ook weergegeven worden door een <code>$</code> karakter voor de variabelenaam te plaatsen op de commandoregel. <code>echo $TERM</code> zou weergeven wat er in <code>$TERM</code> gezet is, omdat de shell <code>$TERM</code> uitbreid en het resultaat doorgeeft aan <code>echo</code>.</p></div><div class=paragraph><p>Shells kennen veel speciale karakters, die meta-karakters heten, als speciale weergaves van data. De meest voorkomende is het karakter <code>*</code> karakter, dat elk karakter in een bestandsnaam voorstelt. Deze speciale meta-karakters kunnen gebruikt worden om bestandsnaamglobbing te doen. Door bijvoorbeeld <code>echo *</code> in te voeren, is het resultaat bijna hetzelfde als door het uitvoeren van <code>ls</code>, omdat de shell alle bestanden die van toepassing zijn aan echo geeft om ze daarna te tonen.</p></div><div class=paragraph><p>Om te voorkomen dat de shell deze speciale tekens verwerkt, kunnen ze uitgeschakeld worden door er het backslash karakter (<code>\</code>) voor te plaatsen. <code>echo $TERM</code> print de inhoud van TERM naar het scherm. <code>echo \$TERM</code> print $TERM zoals het geschreven is.</p></div><div class=sect3><h4 id=changing-shells>4.9.1. Shell wijzigen<a class=anchor href=#changing-shells></a></h4><div class=paragraph><p>De makkelijkste manier om de shell te wijzigen is door het <code>chsh</code> commando te gebruiken. Door <code>chsh</code> te starten wordt de editor gestart die in de <code>EDITOR</code> omgevingsvariable staat. Als deze niet is ingesteld, wordt vi gestart. In de editor kan de regel waarop "Shell:" staat gewijzigd worden.</p></div><div class=paragraph><p>Aan <code>chsh</code> kan ook de optie <code>-s</code> meegegeven worden. Dit stelt de shell in, zonder dat een editor gebruikt hoeft te worden. Als de shell bijvoorbeeld gewijzigd moet worden in <code>bash</code>, kan dat als volgt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% chsh <span class=nt>-s</span> /usr/local/bin/bash</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De te gebruiken shell <em>moet</em> geregistreerd zijn in <span class=filename>/etc/shells</span>. Als een shell uit de <a href=./#ports>Portscollectie</a> is geïnstalleerd, is dit meestal automatisch gebeurd. Als de shell met de hand is geïnstalleerd moet het onderstaande gedaan worden.</p></div><div class=paragraph><p>Als bijvoorbeeld <code>bash</code> met de hand geïnstalleerd is in <span class=filename>/usr/local/bin</span>, dient het onderstaande te gebeuren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#34;/usr/local/bin/bash&#34; &gt;&gt; /etc/shells</span></code></pre></div></div><div class=paragraph><p>Hierna kan <code>chsh</code> weer gedraaid worden.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=editors>4.10. Teksteditors<a class=anchor href=#editors></a></h3><div class=paragraph><p>Een groot deel van de instellingen in FreeBSD wordt gemaakt door het bewerken van tekstbestanden. Hierdoor is het een goed idee om bekend te zijn met een tekstverwerker. FreeBSD heeft er een paar in het basissysteem en veel anderen zijn beschikbaar via de Portscollectie.</p></div><div class=paragraph><p>De makkelijkste en simpelste editor om te leren is de editor ee, wat "easy editor" betekent. Om ee te starten, moet op de commandoregel <code>ee bestandsnaam</code> ingevoerd worden, waar <em>bestandsnaam</em> de naam is van het bestand dat bewerkt moet worden. Om bijvoorbeeld <span class=filename>/etc/rc.conf</span> te bewerken, wordt <code>ee /etc/rc.conf</code> ingegeven. Eenmaal in <code>ee</code> worden alle manipulatie commando’s die de editor heeft weergegeven aan de bovenkant van het scherm. Het karakter dakje <code>^</code> staat voor de toets <kbd>CTRL</kbd> op het toetsenbord, dus <code>^e</code> vormt de toetscombinatie <span class=keyseq><kbd>Ctrl</kbd>+<kbd>e</kbd></span>. Om uit ee te komen wordt op de toets <kbd>Esc</kbd> gedrukt en daar kan gekozen worden om de editor te verlaten. De editor vraagt dan of de wijzigingen bewaard moeten worden als het bestand veranderd is.</p></div><div class=paragraph><p>FreeBSD heeft ook uitgebreidere tekstverwerkers, zoals vi, in het basissysteem en andere editors als Emacs en vim maken onderdeel uit van de FreeBSD Portscollectie (<a class=package href=https://cgit.freebsd.org/ports/tree/editors/emacs/>editors/emacs</a> en <a class=package href=https://cgit.freebsd.org/ports/tree/editors/vim/>editors/vim</a>). Deze editors leveren veel meer functionaliteit en kracht maar zijn lastiger om te leren. Als echter veel met tekstverwerking gedaan wordt, is het leren van een krachtige editor als vim of Emacs verstandig omdat deze uiteindelijk veel tijd kan besparen.</p></div><div class=paragraph><p>Veel applicaties die bestanden wijzigen of getypte invoer nodig hebben zullen automatisch een tekstverwerker openen. Om de tekstverwerker te wijzigen die standaard wordt gebruikt, stelt u de omgevingsvariabele <code>EDITOR</code> in. Zie de sectie <a href=#shells>shells</a> voor meer details.</p></div></div><div class=sect2><h3 id=basics-devices>4.11. Apparaten en apparaatnodes<a class=anchor href=#basics-devices></a></h3><div class=paragraph><p>Apparaat is een term die meestal wordt gebruikt voor hardwareonderdelen in een systeem, zoals schijven, printers grafische kaarten en toetsenborden. Als FreeBSD opstart laat het vooral zien welke apparaten gedetecteerd worden. Deze opstartmeldingen kunnen nagekeken worden door het bestand <span class=filename>/var/run/dmesg.boot</span> te bekijken.</p></div><div class=paragraph><p><span class=filename>acd0</span> is bijvoorbeeld de eerste IDE cd-rom drive, terwijl <span class=filename>kbd0</span> staat voor het toetsenbord.</p></div><div class=paragraph><p>Veel van deze apparaten moeten in een UNIX® besturingssysteem benaderd worden via speciale bestanden die apparaatnodes heten en te vinden zijn in de map <span class=filename>/dev</span>.</p></div><div class=sect3><h4 id=_apparaatnodes_maken>4.11.1. Apparaatnodes maken<a class=anchor href=#_apparaatnodes_maken></a></h4><div class=paragraph><p>Als een nieuw apparaat wordt toegevoegd aan een systeem of als ondersteuning voor extra apparaten wordt gecompileerd, dan moeten er misschien nieuwe apparaat nodes aangemaakt worden.</p></div><div class=sect4><h5 id=_devfs_apparaatbestandssysteem_device_file_system>4.11.1.1. <code>DEVFS</code> (apparaatbestandssysteem - DEVice File System)<a class=anchor href=#_devfs_apparaatbestandssysteem_device_file_system></a></h5><div class=paragraph><p>Het apparaatbestandssysteem of <code>DEVFS</code>, levert toegang tot de apparaatruimte van de kernel in het globale bestandssysteem. In plaats van dat het nodig is om apparaatnodes te maken en te wijzigen, doet <code>DEVFS</code> dit.</p></div><div class=paragraph><p>In <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> staat meer informatie.</p></div></div></div></div><div class=sect2><h3 id=binary-formats>4.12. Binaire formaten<a class=anchor href=#binary-formats></a></h3><div class=paragraph><p>Om te kunnen begrijpen waarom FreeBSD gebruik maakt van het <a href="https://man.freebsd.org/cgi/man.cgi?query=elf&amp;sektion=5&amp;format=html">elf(5)</a> formaat, is het belangrijk op de hoogte zijn van de drie "dominante" uitvoerbare formaten voor UNIX®:</p></div><div class=ulist><ul><li><p><a href="https://man.freebsd.org/cgi/man.cgi?query=a.out&amp;sektion=5&amp;format=html">a.out(5)</a></p><div class=paragraph><p>Het oudste en "klassieke" UNIX® object formaat. Het gebruikt een korte en compacte kop met een magisch nummer aan het begin dat veel gebruikt wordt om het formaat aan te geven (<a href="https://man.freebsd.org/cgi/man.cgi?query=a.out&amp;sektion=5&amp;format=html">a.out(5)</a> geeft meer details). Het bevat drie laadbare segmenten: .tekst, .data en .bss, een symbolentabel en een stringtabel.</p></div></li><li><p>COFF</p><div class=paragraph><p>Het SVR3 object formaat. De kop bestaat uit een sectietabel, dus er kunnen meer dan alleen .tekst, .data, en .bss secties zijn.</p></div></li><li><p><a href="https://man.freebsd.org/cgi/man.cgi?query=elf&amp;sektion=5&amp;format=html">elf(5)</a></p><div class=paragraph><p>De opvolger van COFF, heeft meerdere secties en 32-bit of 64-bit als mogelijke waarden. Één nadeel: ELF was ook ontworpen met de aanname dat er maar één ABI per systeemarchitectuur zou zijn. Deze aanname is eigenlijk redelijk incorrect, zelfs niet in de commerciële SYSV wereld (die op zijn minst drie ABIs heeft: SRV4, Solaris en SCO).</p></div><div class=paragraph><p>FreeBSD probeert om dit probleem heen te werken door een hulpprogramma te leveren voor het <em>brandmerken</em> van een bekend ELF uitvoerbaar bestand met informatie over de ABI waar hij mee kan werken. In <a href="https://man.freebsd.org/cgi/man.cgi?query=brandelf&amp;sektion=1&amp;format=html">brandelf(1)</a> staat meer informatie.</p></div></li></ul></div><div class=paragraph><p>FreeBSD komt uit het "klassieke" kamp en gebruikt het <a href="https://man.freebsd.org/cgi/man.cgi?query=a.out&amp;sektion=5&amp;format=html">a.out(5)</a> formaat, een technologie die zich bewezen heeft door meerdere generaties van BSD versies heen, tot het begin van de 3.X versies. Alhoewel het al mogelijk was om ELF programma’s en kernels te bouwen en te draaien op een FreeBSD systeem , verzette FreeBSD zich eerst tegen de druk om over te schakelen naar ELF als standaard formaat. Waarom? Toen het Linux® kamp hun pijnlijke wissel maakte naar ELF, was dat niet zozeer om van het <span class=filename>a.out</span> formaat af te komen, maar meer omdat van het op de inflexibele jump-tabel gebaseerde gedeelde bibliotheekmechanisme af te komen, die het maken van gedeelde bibliotheken erg moeilijk maakte voor bedrijven en ontwikkelaars. Omdat de ELF hulprogramma’s een oplossing voor het gedeelde bibliotheek probleem waren en algemeen gezien werden als een "stap vooruit", werd de migratie geaccepteerd als noodzakelijk kwaad en werd de wissel uitgevoerd. Het gedeelde bibliotheek mechanisme van FreeBSD is meer gebaseerd op het gedeelde bibliotheek mechanisme van Sun’s SunOS™ en daardoor erg makkelijk te gebruiken.</p></div><div class=paragraph><p>Waarom zijn er zoveel verschillende formaten?</p></div><div class=paragraph><p>In het duistere donkere verleden was er simpele hardware. Deze simpele hardware ondersteunde een simpel klein systeem. <span class=filename>a.out</span> was volledig adequaat voor de taak om binaire bestanden op dat simpele systeem te vertegenwoordigen (een PDP-11). Toen mensen UNIX® van deze machine gingen porten, behielden ze het <span class=filename>a.out</span> formaat omdat het voldeed voor de vroege ports van UNIX® naar architecturen als Motorola 68k, VAXen, enzovoort.</p></div><div class=paragraph><p>Toen besloot een slimme hardware engineer dat als hij de software kon forceren om wat simpele truckjes te doen, hij in staat was om een paar onderdelen van het ontwerp af te schaven, waardoor zijn processorcore sneller kon draaien. Terwijl men probeerde om het met deze nieuwe vorm van hardware te laten werken (vandaag de dag beter bekend als RISC), was <span class=filename>a.out</span> te beperkt voor deze hardware. Dus werden er vele formaten ontworpen om betere prestaties te krijgen uit deze hardware dan het simpele formaat <span class=filename>a.out</span> kon leveren. Toen werden COFF, ECOFF en een paar andere duistere formaten uitgevonden en werden de limieten verkend, waarna men besloot om zich te richten op ELF.</p></div><div class=paragraph><p>Daarnaast werden programma’s groter en bleven schijven (en fysiek geheugen) relatief klein, zodat het concept van een gedeelde bibliotheek werd geboren. Het VM systeem werd ook meer verfijnd. Terwijl al deze verbeteringen bereikt werden door het <span class=filename>a.out</span> formaat, werd het nut met elke nieuwe eigenschap verder uitgerekt. Daarnaast wilde men dingen dynamisch laden tijdens het starten of delen weggooien nadat het programma zijn intiële code had gedraaid om te blijven hangen in het hoofdgeheugen en in de wisselbestanden. Talen werden verder verfijnd en men wilde dat code automatisch werd aangeroepen voor main. Er werden veel hacks gedaan in het <span class=filename>a.out</span> formaat om alles mogelijk te maken en dit werkte ook enige tijd. Na verloop van tijd was <span class=filename>a.out</span> niet meer in staat om alle problemen te adresseren zonder toenemende overhead in code en complexibiliteit. Hoewel ELF veel van deze problemem verhielp, was het moeilijk om te wisselen naar een systeem dat compleet anders werkte. Dus moest ELF wachten totdat het pijnlijker was om <span class=filename>a.out</span> te behouden dan het te migreren naar ELF.</p></div><div class=paragraph><p>Met het verstrijken van de tijd, werden de bouwprogramma’s die FreeBSD heeft afgeleid van hun bouwprogramma’s (vooral de assembler en de loader) ontwikkeld in twee parallel lopende takken. De FreeBSD tree voegde gedeelde bibliotheken toe en heeft wat bugs opgelost. De mensen van GNU die deze programma’s hebben geschreven, hebben ze herschreven en simpelere ondersteuning toegevoegd voor het bouwen van cross-compilers, waarbij verschillende formaten zo nodig ingevoegd konden worden, enzovoort. Omdat veel mensen cross-compilers wilden bouwen die gericht waren op FreeBSD, hadden die pech, omdat de oudere broncode van FreeBSD voor as en ld niet opgewassen was tegen deze taak. De nieuwe GNU programmaketen (binutils) ondersteunt cross-compiling, ELF, gedeelde bibliotheken, C++ extensies, enzovoort. Daarnaast leveren veel leverancierds ELF binaire bestanden en is het goed voor FreeBSD om het te draaien.</p></div><div class=paragraph><p>ELF heeft meer expressiemogelijkheden dan <span class=filename>a.out</span> en geeft meer uitbreidingsmogelijkheden aan het basissysteem. De ELF hulpprogramma’s worden beter onderhouden en geven de mogelijkheid tot ondersteuning voor cross compilatie, wat voor veel mensen belangrijk is. ELF is misschien iets trager dan <span class=filename>a.out</span>, maar het meten daarvan kan vrij lastig zijn. Er zijn ook ontelbare verschillen tussen de twee in hoe ze pages opslaan, initiële code verwerken, enzovoort. Geen van allen zijn ze erg belangrijk, maar er zijn verschillen. Na verloop van tijd verdwijnt de ondersteuning voor <span class=filename>a.out</span> uit de <span class=filename>GENERIC</span> kernel en uiteindelijk ook helemaal uit de kernel als de noodzaak voor <span class=filename>a.out</span> gebaseerde programma’s voorbij is.</p></div></div><div class=sect2><h3 id=basics-more-information>4.13. Meer informatie<a class=anchor href=#basics-more-information></a></h3><div class=sect3><h4 id=basics-man>4.13.1. Handleidingen<a class=anchor href=#basics-man></a></h4><div class=paragraph><p>De meest uitvoerige documentatie van FreeBSD is geschreven in de vorm van handleidingen. Bijna elk programma op het systeem heeft een kleine handleiding die uitlegt wat de basisopties en verschillende argumenten doen. Deze handleidingen bekeken worden met <code>man</code>. Het gebruik van <code>man</code> gaat als volgt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% man commando</code></pre></div></div><div class=paragraph><p><code>commando</code> is de naam van het commando waar meer informatie over getoond moet worden. Om bijvoorbeeld meer informatie weer te geven over <code>ls</code> kan het volgende uitgevoerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% man <span class=nb>ls</span></code></pre></div></div><div class=paragraph><p>De handleidingen zijn opgedeeld in genummerde onderdelen:</p></div><div class="olist arabic"><ol class=arabic><li><p>Gebruikerscommando’s.</p></li><li><p>Systeemaanroepen en foutnummernummers.</p></li><li><p>Functies in de C bibliotheken.</p></li><li><p>Apparaatdrivers.</p></li><li><p>Bestandsindelingen.</p></li><li><p>Spelletjes en andere afleidingen.</p></li><li><p>Diverse informatie.</p></li><li><p>Systeemonderhoud en commando’s</p></li><li><p>Kernelontwikkelaars.</p></li></ol></div><div class=paragraph><p>In sommige gevallen kan een bepaald onderwerp vaker voorkomen in een onderdeel van de handleidingen. Er is bijvoorbeeld een gebruikerscommando <code>chmod</code> en een systeemaanroep <code>chmod()</code>. In deze gevallen kan <code>man</code> aangegeven worden welke documentatie weer te geven door het specificeren van het onderdeel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% man 1 <span class=nb>chmod</span></code></pre></div></div><div class=paragraph><p>Dit geeft de handleiding van het gebruikerscommando <code>chmod</code> weer. Verwijzingen naar een bepaald onderdeel van de handleiding worden traditioneel tussen haakjes geplaatst: <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> verwijst naar het commando <code>chmod</code> en <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=2&amp;format=html">chmod(2)</a> verwijst naar de systeemaanroep.</p></div><div class=paragraph><p>Dit werkt prima als de naam van het commando bekend is en alleen informatie nodig is over hoe het commando gebruikt kan worden, maar wat als de naam van het commando niet bekend is? Dan kan <code>man</code> gebruikt worden om naar trefwoorden te zoeken in de commandobeschrijvingen door de optie <code>-k</code> te gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% man <span class=nt>-k</span> mail</code></pre></div></div><div class=paragraph><p>Met dit commando wordt een overzicht getoond met commando’s die het trefwoord "mail" in hun omschrijving hebben. Dit is gelijk aan het commando <code>apropos</code>.</p></div><div class=paragraph><p>Dus om meer informatie over spannende commando’s met een onbekende functie in <span class=filename>/usr/bin</span> te krijgen is het volgende commando voldoende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cd</span> /usr/bin
% man <span class=nt>-f</span> <span class=k>*</span></code></pre></div></div><div class=paragraph><p>Het onderstaande commando resulteert in hetzelfde:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cd</span> /usr/bin
% whatis <span class=k>*</span></code></pre></div></div></div><div class=sect3><h4 id=basics-info>4.13.2. Gnu infobestanden<a class=anchor href=#basics-info></a></h4><div class=paragraph><p>FreeBSD heeft veel applicaties en hulpmiddelen die gemaakt zijn door de Free Software Foundation (FSF). Als extraatje voor de documentatie hebben deze programma’s uitgebreidere html bestanden die <code>info`bestanden heten, die uitgelezen kunnen worden met `info</code> of, als emacs is geïnstalleerd, de infomodus van emacs.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=info&amp;sektion=1&amp;format=html">info(1)</a> wordt als volgt gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% info</code></pre></div></div><div class=paragraph><p><code>h</code> geeft een korte beschrijving en <code>?</code> toont een kort commando-overzicht.</p></div></div></div></div></div><div class=sect1><h2 id=ports>Hoofdstuk 5. Applicaties installeren: pakketten en ports<a class=anchor href=#ports></a></h2><div class=sectionbody><div class=sect2><h3 id=ports-synopsis>5.1. Overzicht<a class=anchor href=#ports-synopsis></a></h3><div class=paragraph><p>FreeBSD bevat een grote collectie aan systeemgereedschappen als onderdeel van het basissysteem. De mogelijkheden reiken echter niet heel ver en daarom is er snel een applicatie van een andere partij nodig. FreeBSD bevat twee complementaire technologieën om andere applicaties te installeren: de FreeBSD Portscollectie (voor het installeren vanuit broncode) en pakketten (voor het installeren vanuit voorgecompileerde binaire bestanden). Beide systemen kunnen gebruikt worden om de nieuwste versies van een gewenste applicatie te installeren van lokale media of rechtstreeks van het netwerk.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe binaire softwarepakketten van derden te installeren;</p></li><li><p>Hoe software van derden vanuit de Portscollectie vanuit broncode te installeren;</p></li><li><p>Hoe eerder geïnstalleerde pakketten of ports te verwijderen;</p></li><li><p>Hoe standaardwaarden die door de ports worden gebruikt te wijzigen;</p></li><li><p>Hoe het juiste softwarepakket te vinden;</p></li><li><p>Hoe applicaties bij te werken.</p></li></ul></div></div><div class=sect2><h3 id=ports-overview>5.2. Overzicht van softwareinstallatie<a class=anchor href=#ports-overview></a></h3><div class=paragraph><p>Als u eerder gebruik heeft gemaakt van een UNIX®-systeem dan is het bekend dat de standaardprocedure voor het installeren van software van derden ongeveer als volgt is:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Download de software als broncode of als binair bestand;</p></li><li><p>Pak de software uit vanuit zijn originele distributietype (meestal een tar-bestand gecomprimeerd met <a href="https://man.freebsd.org/cgi/man.cgi?query=compress&amp;sektion=1&amp;format=html">compress(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=gzip&amp;sektion=1&amp;format=html">gzip(1)</a>, of <a href="https://man.freebsd.org/cgi/man.cgi?query=bzip2&amp;sektion=1&amp;format=html">bzip2(1)</a>);</p></li><li><p>Zoek de documentatie (meestal een <span class=filename>INSTALL</span> of <span class=filename>README</span> bestand of enkele bestanden in een submap <span class=filename>doc/</span>) en lees zorgvuldig hoe de software geïnstalleerd moet worden;</p></li><li><p>Als de software als broncode is gedistribueerd, moet de broncode gecompileerd worden. Dit kan wijzigingen in een <span class=filename>Makefile</span> vereisen of het draaien van een <code>configure</code> script en andere werkzaamheden;</p></li><li><p>De software installeren en testen.</p></li></ol></div></div></div><div class=paragraph><p>En dat geldt alleen als alles goed gaat. Als er een softwarepakket geïnstalleerd wordt dat niet specifiek gemaakt is voor FreeBSD moet mogelijkerwijs zelfs de code aangepast worden om alles goed te laten werken.</p></div><div class=paragraph><p>Als de gebruiker het wenst, kan hij in FreeBSD doorgaan met het installeren van software op de "traditionele" manier. FreeBSD levert echter twee technologieën die veel moeite kunnen besparen: pakketten en ports. Op dit moment zijn zo meer dan 36000 applicaties beschikbaar.</p></div><div class=paragraph><p>Voor iedere gewenste applicatie is het FreeBSD pakket voor die applicatie één te downloaden bestand. Het pakket bevat voorgecompileerde kopiën met alle commando’s voor de applicatie en alle instellingenbestanden of documentatie. Een gedownload pakketbestand kan gemanipuleerd worden met FreeBSD pakketbeheercommando’s zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_info&amp;sektion=1&amp;format=html">pkg_info(1)</a>, enzovoort. Het installeren van een nieuwe applicatie kan met één commando.</p></div><div class=paragraph><p>Een FreeBSD port van een applicatie is een groep bestanden ontworpen om het proces van compileren van een applicatie vanuit broncode te automatiseren.</p></div><div class=paragraph><p>Het is te vergelijken met de stappen die normaal gevolgd worden om een programma te compileren (downloaden, uitpakken, aanpassen, compileren en installeren). De bestanden die samen een port vormen bevatten alle noodzakelijke informatie om het systeem dit te laten doen. Met een aantal eenvoudige commando’s wordt de broncode voor de applicatie automatisch gedownload, uitgepakt, aangepast, gecompileerd en geïnstalleerd.</p></div><div class=paragraph><p>Het portssysteem kan zelfs gebruikt worden om pakketten te maken die later weer gemanipuleerd kunnen worden met <code>pkg_add</code> en andere pakketbeheercommando’s, waarover later meer uitleg wordt gegeven.</p></div><div class=paragraph><p>Zowel pakketten als ports kennen afhankelijkheden (<em>dependencies</em>). Stel dat er een applicatie geïnstalleerd gaat worden die er vanuit gaat dat een specifieke bibliotheek wordt geïnstalleerd. Zowel de applicatie als de bibliotheek zijn beschikbaar als FreeBSD ports en pakketten. Als het commando <code>pkg_add</code> of het portssysteem wordt gebruikt om de applicatie toe te voegen, dan zien beiden dat de bibliotheek niet geïnstalleerd is en wordt deze automatisch eerst geïnstalleerd.</p></div><div class=paragraph><p>Gezien het feit dat beide technologieën vrijwel identiek zijn, kan de vraag rijzen waarom FreeBSD de moeite neemt om beide te faciliteren. Pakketten en ports hebben ieder hun eigen kracht. Welke gebruikt wordt hangt af van voorkeuren en omstandigheden.</p></div><div class=ulist><div class=title>Voordelen van pakketten</div><ul><li><p>Een gecomprimeerd pakket tar-bestand is meestal kleiner dan het gecomprimeerde tar-bestand met de broncode van de applicatie;</p></li><li><p>Pakketten vereisen geen additionele compilatie. Voor grote applicaties als Mozilla, KDE of GNOME kan dit belangrijk zijn, vooral als een systeem wat trager is;</p></li><li><p>Pakketten vereisen geen begrip van het proces van het compileren van software op FreeBSD.</p></li></ul></div><div class=ulist><div class=title>Voordelen van ports</div><ul><li><p>Pakketten worden meestal gecompileerd met conservatieve opties, omdat ze moeten draaien op een maximaal aantal systemen. Bij het installeren vanuit de port kunnen de compilatie-instellingen aangepast worden om zo bijvoorbeeld code te maken die specifiek voor een Pentium 4 of een Athlon processor is;</p></li><li><p>Sommige applicaties hebben compilatie-instellingen gerelateerd aan wat ze wel of niet kunnen doen. Apache kan bijvoorbeeld ingesteld worden met een uitgebreide hoeveelheid verschillende ingebouwde instellingen. Door vanuit de port te werken hoeven niet alle standaardinstellingen geaccepteerd te worden en kunnen ze ingesteld worden;</p><div class=paragraph><p>In sommige gevallen zijn er meerdere pakketten voor dezelfde applicatie om specifieke instellingen aan te geven. Ghostscript is bijvoorbeeld beschikbaar als een <span class=filename>ghostscript</span> pakket en <span class=filename>ghostscript-nox11</span> pakket, afhankelijk van het al dan niet geïnstalleerd hebben van een X11 server. Deze ruwe vorm van tweaking is mogelijk met pakketten, maar dit wordt snel onmogelijk als een applicatie meer dan één of twee verschillende compilatie-instellingen heeft;</p></div></li><li><p>De licentievoorwaarden van sommige softwaredistributies verbieden binaire distributie. Ze moeten dus gedistribueerd worden als broncode;</p></li><li><p>Sommige mensen vertrouwen binaire distributies niet. Broncode kan tenminste (in theorie) zelf doorgelezen en gecontroleerd worden op potentiële problemen;</p></li><li><p>Als er lokale modificaties zijn, is de broncode nodig om ze toe te passen;</p></li><li><p>Sommige mensen hebben graag de broncode zodat ze die kunnen lezen als ze zich vervelen, erin kunnen hacken, code kunnen overnemen (indien de licentie dit toestaat natuurlijk), enzovoort.</p></li></ul></div><div class=paragraph><p>Om vernieuwingen van ports bij te houden kan een abonnement genomen worden op de <a href=https://lists.FreeBSD.org/subscription/freebsd-ports>FreeBSD ports mailinglijst</a> en/of de <a href=https://lists.FreeBSD.org/subscription/freebsd-ports-bugs>FreeBSD ports bugs mailinglijst</a>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Voordat een applicatie wordt geïnstalleerd is het aan te raden op <a href=http://vuxml.freebsd.org/>http://vuxml.freebsd.org/</a> na kijken of er geen beveiligingsproblemen voor de gewenste applicatie bekend zijn.</p></div><div class=paragraph><p>Het is ook mogelijk om <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portaudit/>ports-mgmt/portaudit</a> te installeren, dat automatisch alle geïnstalleerde applicaties controleert op bekende fouten. Deze controle wordt ook uitgevoerd voordat een port wordt geïnstalleerd. Met het commando <code>portaudit -F -a</code> kunnen de pakketten die al geïnstalleerd zijn worden gecontroleerd.</p></div></td></tr></tbody></table></div><div class=paragraph><p>In de rest van dit hoofdstuk wordt uitgelegd hoe pakketten en ports gebruikt kunnen worden om software in FreeBSD te installeren en te beheren.</p></div></div><div class=sect2><h3 id=ports-finding-applications>5.3. Applicaties zoeken<a class=anchor href=#ports-finding-applications></a></h3><div class=paragraph><p>Voordat een applicatie geïnstalleerd kan worden, moeten de doelen bekend zijn en hoe de applicatie heet.</p></div><div class=paragraph><p>De lijst met voor FreeBSD beschikbare applicaties groeit continu. Gelukkig zijn er een aantal manieren om te zoeken:</p></div><div class=ulist><ul><li><p>Op de FreeBSD website staat een recente doorzoekbare lijst met alle beschikbare applicaties: <a href=https://www.FreeBSD.org/ports/>http://www.FreeBSD.org/ports/</a>. De ports zijn onderverdeeld in categorieën. Er kan naar een applicatie gezocht worden op naam (als die bekend is) of alle applicaties in een categorie kunnen bekeken worden.</p></li><li><p>Dan Langille onderhoudt FreshPorts op <a href=http://www.FreshPorts.org/>http://www.FreshPorts.org/</a>. FreshPorts volgt veranderingen in applicaties in de ports en biedt de mogelijkheid om of meer ports te volgen. Er wordt dan een email gestuurd als de port is bijgewerkt.</p></li><li><p>Als de naam van de gewenst applicatie niet bekend is, is het wellicht mogelijk deze te achterhalen via een website als Freecode (<a href=http://www.freecode.com/>http://www.freecode.com/</a>) en kan daarna op de FreeBSD site gecontroleerd worden of de applicatie al geschikt gemaakt is voor gebruik met FreeBSD.</p></li><li><p>Als de precieze naam van de port bekend is, maar niet bekend is in welke categorie deze staat, kan dit achterhaald worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=whereis&amp;sektion=1&amp;format=html">whereis(1)</a>. Door simpelweg <code>whereis bestand</code> in te geven, waar <em>bestand</em> het te installeren programma is. Als het op het systeem staat, wordt dat als volgt aangegeven:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># whereis lsof</span>
lsof: /usr/ports/sysutils/lsof</code></pre></div></div><div class=paragraph><p>Dit geeft aan dat <code>lsof</code> (een systeemhulpprogramma) in de map <span class=filename>/usr/ports/sysutils/lsof</span> staat.</p></div></li><li><p>U kunt ook een eenvoudig <a href="https://man.freebsd.org/cgi/man.cgi?query=echo&amp;sektion=1&amp;format=html">echo(1)</a>-statement gebruiken om uit te zoeken waar een port zich in te ports tree bevindt. Bijvoorbeeld:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo /usr/ports/*/*lsof*</span>
/usr/ports/sysutils/lsof</code></pre></div></div><div class=paragraph><p>Merk op dat dit alle overeenkomstige bestanden die gedownload zijn in de map <span class=filename>/usr/ports/distfiles</span> terruggeeft.</p></div></li><li><p>Nog een andere manier om een port op te sporen is door het ingebouwde zoekmechanisme van de Portscollectie te gebruiken. Hiervoor moet het huidige pad de map <span class=filename>/usr/ports</span> zijn. Vanuit die map kan <code>make search name=programmanaam</code> uitgevoerd worden, waar <em>programmanaam</em> de naam is van het programma dat wordt gezocht. Als bijvoorbeeld <code>lsof</code> wordt gezocht:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports</span>
<span class=c># make search name=lsof</span>
Port:   lsof-4.56.4
Path:   /usr/ports/sysutils/lsof
Info:   Lists information about open files <span class=o>(</span>similar to fstat<span class=o>(</span>1<span class=o>))</span>
Maint:  obrien@FreeBSD.org
Index:  sysutils
B-deps:
R-deps:</code></pre></div></div><div class=paragraph><p>Het belangrijkste onderdeel van de uitvoer is in dit geval de regel waarop "Path:" staat, omdat die aangeeft waar de port staat. De andere informatie is niet nodig voor de installatie van de port en wordt hier niet behandeld.</p></div><div class=paragraph><p>Voor nog dieper zoeken kan ook <code>make search key=string</code> gebruikt worden waar <em>string</em> tekst is waarnaar gezocht moet worden. Hiermee wordt naar namen van ports, commentaar, beschrijvingen en afhankelijkheden gezocht en dit kan gebruikt worden om ports te vinden die te maken hebben met een bepaald onderwerp als onbekend is hoe het gezochte programma heet.</p></div><div class=paragraph><p>In beide gevallen is de zoekstring niet hoofdlettergevoelig. Zoeken naar "LSOF" geeft hetzelfde resultaat als zoeken naar "lsof".</p></div></li></ul></div></div><div class=sect2><h3 id=packages-using>5.4. Het pakkettensysteem gebruiken<a class=anchor href=#packages-using></a></h3><div class=paragraph><p>Er zijn verschillende gereedschappen die gebruikt worden om pakketten op FreeBSD te beheren:</p></div><div class=ulist><ul><li><p>Het gereedschap <code>sysinstall</code> kan op een draaiend systeem worden gebruikt om beschikbare en geïnstalleerde pakketten te installeren, te verwijderen, en weer te geven. Zie voor meer informatie <a href=./#packages>Pakketten installeren</a>.</p></li><li><p>De opdrachtregelgereedschappen om pakketten te beheren, welke het onderwerp van de rest van deze sectie zijn.</p></li></ul></div><div class=sect3><h4 id=_pakketten_installeren>5.4.1. Pakketten installeren<a class=anchor href=#_pakketten_installeren></a></h4><div class=paragraph><p>Met <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> kan een FreeBSD softwarepakket geïnstalleerd worden vanaf een lokaal bestand of vanaf een server op het netwerk.</p></div><div class=exampleblock><div class=title>Voorbeeld 5. Handmatig pakketten downloaden en lokaal installeren</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ftp -a ftp2.FreeBSD.org</span>
Connected to ftp2.FreeBSD.org.
220 ftp3.FreeBSD.org FTP server <span class=o>(</span>Version 6.00LS<span class=o>)</span> ready.
331 Guest login ok, send your email address as password.
230-
230-     This machine is <span class=k>in </span>Vienna, VA, USA, hosted by Verio.
230-         Questions? E-mail freebsd@vienna.verio.net.
230-
230-
230 Guest login ok, access restrictions apply.
Remote system <span class=nb>type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt; <span class=nb>cd</span> /pub/FreeBSD/ports/packages/sysutils/
250 CWD <span class=nb>command </span>successful.
ftp&gt; get lsof-4.56.4.tgz
<span class=nb>local</span>: lsof-4.56.4.tgz remote: lsof-4.56.4.tgz
200 PORT <span class=nb>command </span>successful.
150 Opening BINARY mode data connection <span class=k>for</span> <span class=s1>&#39;lsof-4.56.4.tgz&#39;</span> <span class=o>(</span>92375 bytes<span class=o>)</span><span class=nb>.</span>
100% |<span class=k>**************************************************</span>| 92375       00:00 ETA
226 Transfer complete.
92375 bytes received <span class=k>in </span>5.60 seconds <span class=o>(</span>16.11 KB/s<span class=o>)</span>
ftp&gt; <span class=nb>exit</span>
<span class=c># pkg_add lsof-4.56.4.tgz</span></code></pre></div></div></div></div><div class=paragraph><p>Als er lokaal geen bron is voor pakketten (zoals de FreeBSD CD-ROM-verzameling) dan is het waarschijnlijk makkelijker om de <code>-r</code> optie te gebruiken met <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>. Deze optie zorgt er voor dat het hulpprogramma automatisch het correcte formaat en de juiste versie bepaalt en die daarna binnenhaalt en installeert vanaf een FTP site.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r lsof</span></code></pre></div></div><div class=paragraph><p>Het voorbeeld hierboven haalt het correcte pakket binnen en installeert het zonder dat de gebruiker iets hoeft te doen. Als u een alternatieve FreeBSD Pakkettenmirror wilt specificeren, in plaats van de hoofddistributiesite, dan moet u de omgevingsvariabele <code>PACKAGESITE</code> overeenkomstig instellen om de standaardinstellingen aan te passen. <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> gebruikt <a href="https://man.freebsd.org/cgi/man.cgi?query=fetch&amp;sektion=3&amp;format=html">fetch(3)</a> om de bestanden binnen te halen, dat gebruik maakt van diverse omgevingsvariabelen zoals <code>FTP_PASSIVE_MODE</code>, <code>FTP_PROXY</code>, en <code>FTP_PASSWORD</code>. Mogelijk moeten ook één of meer van deze variabelen gebruikt worden als een machine achter een firewall staat of als gebruik gemaakt moet worden van een FTP/HTTP proxy. In <a href="https://man.freebsd.org/cgi/man.cgi?query=fetch&amp;sektion=3&amp;format=html">fetch(3)</a> staat de complete lijst. In het voorbeeld hierboven is gebruik gemaakt van <code>lsof</code> in plaats van <code>lsof-4.56.4</code>. Als het pakket wordt binnengehaald met behulp van de bovenstaande instellingen, dan moet het versienummer van het pakket niet gebruikt worden. <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> haalt automatisch de laatste versie van de applicatie binnen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> downloadt de meest recente versie van een applicatie als FreeBSD-CURRENT of FreeBSD-STABLE. Als een -RELEASE versie wordt gebruikt, wordt het pakket dat bij die release hoort gebruikt. Het is mogelijk dit gedrag te veranderen door <code>PACKAGESITE</code> te wijzigen. Als u bijvoorbeeld FreeBSD 8.1-RELEASE draait, dan haalt <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> standaard de pakketten uit <code><a href=ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-8.1-release/Latest/ class=bare>ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-8.1-release/Latest/</a></code>. Om <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> de FreeBSD 8-STABLE pakketten te laten downloaden kan <code>PACKAGESITE</code> ingesteld worden op <code><a href=ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-8-stable/Latest/ class=bare>ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-8-stable/Latest/</a></code>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Pakketbestanden worden gedistribueerd in de formaten <span class=filename>.tgz</span> en <span class=filename>.tbz</span>. Ze zijn te vinden op <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/>ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/</a> of op de FreeBSD CD-ROM-distributie. Iedere CD-ROM in de FreeBSD 4-CD-ROM-verzameling (en de PowerPak, enzovoort) bevat pakketten in de map <span class=filename>/packages</span>. De opbouw van de pakketten is ongeveer gelijk aan die van <span class=filename>/usr/ports</span>. Iedere categorie heeft zijn eigen map en ieder pakket staat ook in de map <span class=filename>All</span>.</p></div><div class=paragraph><p>De mappenstructuur van het pakkettensysteem is gelijk aan die van het portssysteem. Samen vormen ze het pakket/portssysteem.</p></div></div><div class=sect3><h4 id=_pakketten_beheren>5.4.2. Pakketten beheren<a class=anchor href=#_pakketten_beheren></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_info&amp;sektion=1&amp;format=html">pkg_info(1)</a> is een hulpprogramma dat de diverse geïnstalleerde pakketten toont en beschrijft.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_info</span>
cvsup-16.1          A general network file distribution system optimized <span class=k>for </span>CV
docbook-1.2         Meta-port <span class=k>for </span>the different versions of the DocBook DTD
...</code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_version&amp;sektion=1&amp;format=html">pkg_version(1)</a> is een hulpprogramma dat een samenvatting van de versie van alle geïnstalleerde pakketten geeft. Het vergelijkt de versie van het pakket met de huidige versie in de Portscollectie.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_version</span>
cvsup                       <span class=o>=</span>
docbook                     <span class=o>=</span>
...</code></pre></div></div><div class=paragraph><p>De symbolen in de tweede kolom geven aan hoe de geïnstalleerde versie staat ten opzichte van de versie die beschikbaar is in de lokale Portscollectie.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Symbool</th><th class="tableblock halign-left valign-top">Betekenis</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>=</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De versie van het geïnstalleerde pakket komt overeen met die in de lokale Portscollectie.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>&lt;</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De geïnstalleerde versie is ouder dan die beschikbaar is in de ports.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De geïnstalleerde versie is nieuwer dan die in de lokale Portscollectie. De lokale Portscollectie is waarschijnlijk verouderd.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>?</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het geïnstalleerde pakket kan niet gevonden worden in index van de Portscollectie. Dit kan bijvoorbeeld gebeuren als een geïnstalleerde port uit de Portscollectie wordt verwijderd of hernoemd.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>*</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Er zijn meerdere versies van het pakket.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>!</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het geïnstalleerde pakket bestaat in de index maar om de een of andere reden was <code>pkg_version</code> niet in staat om het versienummer van het geïnstalleerde pakket met de overeenkomstige ingang in de index te vergelijken.</p></td></tr></tbody></table></div><div class=sect3><h4 id=_pakketten_verwijderen>5.4.3. Pakketten verwijderen<a class=anchor href=#_pakketten_verwijderen></a></h4><div class=paragraph><p>Voor het verwijderen van een geïnstalleerd pakket wordt het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> gebruikt.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_delete xchat-1.7.1</span></code></pre></div></div><div class=paragraph><p>Merk op dat <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> de volledige naam en het volledige nummer van het pakket nodig heeft; het bovenstaande commando zou niet werken als <em>xchat</em> in plaats van <em>xchat-1.7.1</em> was gegeven. Het is echter eenvoudig om <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_version&amp;sektion=1&amp;format=html">pkg_version(1)</a> te gebruiken om de versie van het geïnstalleerde pakket te achterhalen. U zou ook eenvoudigweg een wildcard kunnen gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_delete xchat\*</span></code></pre></div></div><div class=paragraph><p>In dit geval zullen alle pakketten waarvan de naam met <code>xchat</code> begint worden verwijderd.</p></div></div><div class=sect3><h4 id=_diversen>5.4.4. Diversen<a class=anchor href=#_diversen></a></h4><div class=paragraph><p>Alle informatie over pakketten wordt opgeslagen in de map <span class=filename>/var/db/pkg</span>. De lijst met geïnstalleerde bestanden en beschrijvingen van ieder pakket staat in de bestanden in deze map.</p></div></div></div><div class=sect2><h3 id=ports-using>5.5. De Portscollectie gebruiken<a class=anchor href=#ports-using></a></h3><div class=paragraph><p>In de volgende paragrafen worden basisinstructies gegeven over het gebruik van de Portscollectie om programma’s op een systeem te installeren of ervan te verwijderen. Een gedetailleerde beschrijving van de <code>make</code>-doelen en omgevingsvariabelen staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=ports&amp;sektion=7&amp;format=html">ports(7)</a>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Sinds eind 2012 is het FreeBSD Ports Project bezig om het versiebeheersysteem te migreren van CVS naar Subversion. Als gevolg hiervan zijn deze instructies aan verandering onderhevig. Het aanbevolen mechanisme voor algemeen gebruik van de ports is Portsnap. Gebruikers die lokale aanpassingen van ports nodig hebben (dus aanvullende lokale patches beheren) zullen er waarschijnlijk de voorkeur aan geven om rechtstreeks Subversion te gebruiken. De dienst CVSup wordt per 28 februari 2013 uitgefaseerd en verder gebruik wordt ontmoedigd.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=ports-tree>5.5.1. De Portscollectie verkrijgen<a class=anchor href=#ports-tree></a></h4><div class=paragraph><p>De Portscollectie is een verzameling van <span class=filename>Makefiles</span>, patches en bestanden met beschrijvingen in <span class=filename>/usr/ports</span>. Deze verzameling bestanden wordt gebruikt om applicaties op FreeBSD te bouwen en te installeren. De onderstaande instructies laten verschillende methodes zien om de Portscollectie te verkrijgen als dit niet tijdens de initiële installatie van FreeBSD is gebeurd.</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Met Portsnap</strong></p></div><div class=paragraph><p>Portsnap is een snel en gebruiksvriendelijk gereedschap om de Portscollectie te verkrijgen en de aanbevolen manier voor de meeste gebruikers. Zie <a href=./#updating-upgrading-portsnap>Portsnap gebruiken</a> voor een gedetailleerde beschrijving van Portsnap.</p></div><div class="olist arabic"><ol class=arabic><li><p>Download een gecomprimeerde momentopname van de Portscollectie naar <span class=filename>/var/db/portsnap</span>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap fetch</span></code></pre></div></div></li><li><p>Pak de momentopname bij het eerste gebruik van Portsnap uit naar <span class=filename>/usr/ports</span>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap extract</span></code></pre></div></div><div class=paragraph><p>Nadat het eerste gebruik van Portsnap is voltooid zoals hierboven is aangegeven, kan <span class=filename>/usr/ports</span> worden bijgewerkt met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap update</span></code></pre></div></div></li></ol></div></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Met Subversion</strong></p></div><div class=paragraph><p>Als meer controle over de ports-boom nodig is (om bijvoorbeeld lokale veranderingen te beheren) kan Subversion worden gebruikt om de Portscollectie te verkrijgen. Zie de <a href=https://docs.freebsd.org/en/articles/committers-guide/#subversion-primer>Subversion Primer</a> voor een gedetailleerde beschrijving van Subversion.</p></div><div class="olist arabic"><ol class=arabic><li><p>Subversion moet geïnstalleerd zijn voordat het gebruikt kan worden om de ports-boom uit te checken. Als er reeds een kopie van de ports-boom aanwezig is, installeer dan Subversion als volgt:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/devel/subversion</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Als de ports-boom niet beschikbaar is, kan Subversion worden geïnstalleerd als een pakket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r subversion</span></code></pre></div></div><div class=paragraph><p>Als pkgng wordt gebruikt om pakketten te beheren, kan Subversion in plaats daarvan worden geïnstalleerd met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg install subversion</span></code></pre></div></div></li><li><p>Check een kopie van de ports-boom uit. Gebruik voor een betere prestatie een specifieke <a href=https://docs.freebsd.org/nl/books/handbook/mirrors#svn-mirrors>Subversion mirror</a> dichtbij u in plaats van <em>svn.FreeBSD.org</em> in onderstaand commando. Committers dienen eerst de <a href=https://docs.freebsd.org/en/articles/committers-guide/#subversion-primer>Subversion Primer</a> te lezen om er zeker van te zijn dat het juiste protocol is gekozen.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># svn checkout svn://svn.FreeBSD.org/ports/head /usr/ports</span></code></pre></div></div></li><li><p>Om <span class=filename>/usr/ports</span> na de initiële checkout met Subversion bij te werken:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># svn update /usr/ports</span></code></pre></div></div></li></ol></div></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Met CVSup</strong></p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Het gebruik van CVsup om de Portscollectie te verkrijgen en te synchroniseren wordt ontmoedigd als onderdeel van een migratie naar Subversion. Hoewel het ondersteund blijft zal de dienst niet meer worden geleverd na 28 februari 2013.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Dit is een snelle methode voor het verkrijgen en bijhouden van een kopie van Portscollectie met behulp van het CVSup-protocol. Meer informatie over CVSup staat in <a href=./#cvsup>CVSup gebruiken</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De implementatie van het CVSup-protocol dat met FreeBSD wordt geleverd heet csup.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Zorg ervoor dat <span class=filename>/usr/ports</span> leeg is voordat csup voor het eerst gebruikt wordt! Als er reeds een Ports Collectie aanwezig is die via een andere bron is opgehaald, zal csup verwijderde patchbestanden niet verwijderen.</p></div><div class="olist arabic"><ol class=arabic><li><p>Draai <code>csup</code>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># csup -L 2 -h cvsup.FreeBSD.org /usr/shared/examples/cvsup/ports-supfile</span></code></pre></div></div><div class=paragraph><p>Wijzig <em>cvsup.FreeBSD.org</em> in een CVSup server in de buurt. In <a href=./#cvsup-mirrors>CVSup Mirrors</a> (<a href=./#cvsup-mirrors>CVSup sites</a>) staat een complete lijst van mirrorsites;</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het kan wenselijk zijn een aangepaste <span class=filename>ports-supfile</span> te gebruiken, bijvoorbeeld om een CVSup server niet mee te hoeven geven op de commandoregel.</p></div><div class="sidebarblock procedure"><div class=content><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>Kopieer in dit geval, als <code>root</code>, <span class=filename>/usr/shared/examples/cvsup/ports-supfile</span> naar een nieuwe locatie, zoals /root of een thuismap.</p></li><li><p>Wijzig <span class=filename>ports-supfile</span>.</p></li><li><p>Wijzig <em>CHANGE_THIS.FreeBSD.org</em> in een CVSup server in de buurt. In <a href=./#cvsup-mirrors>CVSup Mirrors</a> (<a href=./#cvsup-mirrors>CVSup sites</a>) staat een volledige lijst met mirrorsites.</p></li><li><p>Roep nu als volgt <code>csup</code> aan:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># csup -L 2 /root/ports-supfile</span></code></pre></div></div></li></ol></div></div></div></td></tr></tbody></table></div></li><li><p>Het later draaien van <a href="https://man.freebsd.org/cgi/man.cgi?query=csup&amp;sektion=1&amp;format=html">csup(1)</a> zal alle recente veranderingen aan uw Portscollectie downloaden en toepassen, behalve het eigenlijke herbouwen van ports voor uw eigen systeem.</p></li></ol></div></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Met sysinstall</strong></p></div><div class=paragraph><p>Bij deze methode wordt sysinstall gebruikt om de Portscollectie van installatiemedia te installeren. Hier wordt wel de Portscollectie op het moment dat de release gemaakt is geïnstalleerd. Bij toegang tot Internet is het advies altijd een andere methode te gebruiken.</p></div><div class="olist arabic"><ol class=arabic><li><p>Draai als <code>root sysinstall</code> zoals hieronder aangegeven:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysinstall</span></code></pre></div></div></li><li><p>Scroll naar beneden en selecteer <span class=guimenuitem>Configure</span>, druk op <kbd>Enter</kbd>.</p></li><li><p>Scroll naar beneden en selecteer <span class=guimenuitem>Distributions</span>, druk op <kbd>Enter</kbd>.</p></li><li><p>Scroll naar <span class=guimenuitem>ports</span>, druk op <kbd>Space</kbd>.</p></li><li><p>Scroll naar boven naar <span class=guimenuitem>Exit</span>, druk op <kbd>Enter</kbd>.</p></li><li><p>Selecteer de gewenste installatiemedia, zoals CD-ROM, FTP, enzovoort.</p></li><li><p>Scroll omhoog naar <span class=guimenuitem>Exit</span> en druk op <kbd>Enter</kbd>.</p></li><li><p>Druk op <kbd>X</kbd> om sysinstall af te sluiten.</p></li></ol></div></div></div></div><div class=sect3><h4 id=cvsup-migration>5.5.2. Migreren van CVSup/csup naar portsnap<a class=anchor href=#cvsup-migration></a></h4><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Per 28 februari 2013 zal de ports-boom niet langer naar CVS worden en daarom geëxporteerd zullen CVSup en csup niet langer updates voor de Portscollectie bieden.</p></div></td></tr></tbody></table></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Migreren naar Portsnap</strong></p></div><div class=paragraph><p>De migratie zal ongeveer 1 GB aan schijfruimte op <span class=filename>/usr</span> nodig hebben, en Portsnap zal ongeveer 150 MB aan schijfruimte op <span class=filename>/var</span> nodig hebben.</p></div><div class="olist arabic"><ol class=arabic><li><p>Schakel alle automatische updates aan ports die u gebruikt, zoals een <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a>-taak die CVSup of csup uit.</p></li><li><p>Verplaats de bestaande ports-boom naar een tijdelijke lokatie:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mv /usr/ports /usr/ports.old</span></code></pre></div></div></li><li><p>Haal de nieuwe ports-boom met Portsnap op en pak deze uit in <span class=filename>/usr/ports</span>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap fetch extract</span></code></pre></div></div></li><li><p>Verplaats distfiles en bewaarde pakketten naar de nieuwe ports-boom:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mv /usr/ports.old/distfiles /usr/ports</span>
<span class=c># mv /usr/ports.old/packages /usr/ports</span></code></pre></div></div></li><li><p>Verwijder de oude ports-boom:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rm -rf /usr/ports.old</span></code></pre></div></div></li><li><p>Indien voorheen CVSup gebruikt werd, kan het nu worden gedeïnstalleerd:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_delete -r -v cvsup-without-gui-\*</span></code></pre></div></div><div class=paragraph><p>Gebruikers van pkgng kunnen het volgende commando gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg remove cvsup-without-gui</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Zie <a href=./#updating-upgrading-portsnap>Portsnap gebruiken</a> voor een gedetailleerde beschrijving van Portsnap en hoe de ports-boom met Portsnap bij te werken.</p></div></div><div class=sect3><h4 id=ports-skeleton>5.5.3. Ports installeren<a class=anchor href=#ports-skeleton></a></h4><div class=paragraph><p>Het eerste wat uitleg behoeft als het over de Portscollectie gaat is de term "skelet" ("skeleton"). In een notendop is een portskelet een minimaal aantal bestanden dat FreeBSD aangeeft hoe een programma gecompileerd en geïnstalleerd kan worden. Ieder portskelet bevat:</p></div><div class=ulist><ul><li><p>Een <span class=filename>Makefile</span>. De <span class=filename>Makefile</span> bevat verschillende definities die aangeven hoe de applicatie gecompileerd moet worden en waar die op een systeem geïnstalleerd moet worden;</p></li><li><p>Een bestand <span class=filename>distinfo</span>. Dit bestand bevat informatie over de bestanden die gedownload moeten worden om de port te bouwen, en hun checksums (door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=sha256&amp;sektion=1&amp;format=html">sha256(1)</a>), om vast te stellen dat de bestanden niet corrupt zijn geraakt tijdens de download;</p></li><li><p>Een map <span class=filename>files</span>. Deze map bevat patches om het programma op een FreeBSD systeem te laten compileren en installeren. Patches zijn in essentie kleine bestanden waarin kleine veranderingen aan andere, specifieke, bestanden staan aangegeven. Ze zijn opgesteld in platte tekst en er staan dingen in als "Verwijder regel 10" of "Wijzig regel 26 in …​". Patches staan ook wel bekend als "diffs" omdat ze gemaakt worden met het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a>.</p><div class=paragraph><p>Deze map kan ook andere bestanden bevatten die gebruikt worden om de port te bouwen;</p></div></li><li><p>Een bestand <span class=filename>pkg-descr</span>. Dit is een meer gedetailleerde beschrijving van het programma, vaak in één regel;</p></li><li><p>Een bestand <span class=filename>pkg-plist</span>. Dit is een lijst met alle bestanden die door de port geïnstalleerd worden. Het geeft het portssysteem ook aan welke bestanden bij het verwijderen van de port weer verwijderd kunnen worden.</p></li></ul></div><div class=paragraph><p>Sommige ports bevatten nog andere bestanden, zoals <span class=filename>pkg-message</span>. Het portssysteem gebruikt die bestanden voor het afhandelen van bijzondere situaties. Meer details over die bestanden en over ports in het algemeen zijn na te lezen in het <a href=https://docs.freebsd.org/en/books/porters-handbook/>FreeBSD Handboek voor Porters</a>.</p></div><div class=paragraph><p>De port bevat instructies over hoe de broncode gebouwd moet worden, maar de broncode zelf is er geen onderdeel van. De broncode staat op een CD-ROM of op Internet. De broncode wordt verspreid op de wijze waarop de auteur dat wenst. Vaak is dat als een tar of gzip bestand, maar het kan ook ingepakt zijn met een ander programma of helemaal niet ingepakt zijn. De broncode van een programma, in welke vorm dan ook, heet een "distributiebestand". De twee methoden om een FreeBSD port te installeren worden hieronder beschreven.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ports installeren dient als <code>root</code> te gebeuren.</p></div></td></tr></tbody></table></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Voordat een port wordt geïnstalleerd is het aan te raden op <a href=http://vuxml.freebsd.org/>http://vuxml.freebsd.org/</a> na kijken of er geen beveiligingsproblemen voor de gewenste port bekend zijn.</p></div><div class=paragraph><p>Er kan automatisch een controle op beveiligingsproblemen door portaudit gedaan worden voordat er een nieuwe applicatie wordt geïnstalleerd. Dit gereedschap kan in de Portscollectie gevonden worden (<a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portaudit/>ports-mgmt/portaudit</a>). Overweeg om <code>portaudit -F</code> te draaien voordat er een nieuwe port wordt geïnstalleerd, om de huidige database met beveiligingsproblemen op te halen. Tijdens de dagelijkse beveiligingscontrole van het systeem zal er een beveiligingsaudit en een update van de database plaatsvinden. Lees voor meer informatie de hulppagina’s <a href="https://man.freebsd.org/cgi/man.cgi?query=portaudit&amp;sektion=1&amp;format=html">portaudit(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De Portscollectie neemt aan dat er een werkende Internetverbinding is. Als die niet aanwezig is, zet dan handmatig een kopie van het benodigde distributiebestand in <span class=filename>/usr/ports/distfiles</span>.</p></div><div class=paragraph><p>Ga om te beginnen naar de juiste map voor een port:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/sysutils/lsof</span></code></pre></div></div><div class=paragraph><p>Eenmaal in de map <span class=filename>lsof</span> is het skelet van de port te zien. In de volgende stap wordt de broncode voor de port gecompileerd of "gebouwd". Dit wordt gedaan door op het prompt <code>make</code> in te voeren. Dat levert iets als het volgende op:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make</span>
<span class=o>&gt;&gt;</span> lsof_4.57D.freebsd.tar.gz doesn<span class=s1>&#39;t seem to exist in /usr/ports/distfiles/.
&gt;&gt; Attempting to fetch from ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/.
===&gt;  Extracting for lsof-4.57
...
[uitvoer van uitpakken verwijderd]
...
&gt;&gt; Checksum OK for lsof_4.57D.freebsd.tar.gz.
===&gt;  Patching for lsof-4.57
===&gt;  Applying FreeBSD patches for lsof-4.57
===&gt;  Configuring for lsof-4.57
...
[uitvoer van configure verwijderd]
...
===&gt;  Building for lsof-4.57
...
[uitvoer van compileren verwijderd]
...
#</span></code></pre></div></div><div class=paragraph><p>Als het compileren is afgerond is het prompt weer zichtbaar. In de volgende stap wordt de port geïnstalleerd. Om dat te bewerkstelligen wordt het woord <code>install</code> aan <code>make</code> toegevoegd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make install</span>
<span class=o>===&gt;</span>  Installing <span class=k>for </span>lsof-4.57
...
<span class=o>[</span>uitvoer installatie verwijderd]
...
<span class=o>===&gt;</span>   Generating temporary packing list
<span class=o>===&gt;</span>   Compressing manual pages <span class=k>for </span>lsof-4.57
<span class=o>===&gt;</span>   Registering installation <span class=k>for </span>lsof-4.57
<span class=o>===&gt;</span>  SECURITY NOTE:
      This port has installed the following binaries which execute with
      increased privileges.
<span class=c>#</span></code></pre></div></div><div class=paragraph><p>Als de prompt weer beschikbaar is, is de applicatie klaar voor gebruik. Omdat <code>lsof</code> met verhoogde rechten wordt uitgevoerd, wordt er een waarschuwing getoond. Tijdens het bouwen en installeren van ports zijn de getoonde waarschuwingen van belang.</p></div><div class=paragraph><p>Het is verstandig om de submap die als werkmap wordt gebruikt te verwijderen. Hierin staan alle tijdelijke bestanden die tijdens het compileren worden gebruikt. Die bestanden gebruiken niet alleen waardevolle schijfruimte, maar ze kunnen later ook problemen veroorzaken als de port wordt bijgewerkt.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make clean</span>
<span class=o>===&gt;</span>  Cleaning <span class=k>for </span>lsof-4.57
<span class=c>#</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is mogelijk twee stappen minder te gebruiken door <code>make install clean</code> uit te voeren in plaats van <code>make</code>, <code>make install</code> en <code>make clean</code> als drie afzonderlijke stappen.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Wanneer een port alleen met <code>make install</code> wordt geïnstalleerd, betekent dit dat er in het begin mogelijk veel gewacht moet worden tussen interacties van de gebruiker aangezien het standaardgedrag is om de gebruiker te vragen om keuzes voor opties. Wanneer er veel afhankelijkheden zijn, kan dit voor het bouwen van een enkele port soms een hele opgave zijn. Om dit te voorkomen, kan <code>make config-recursive</code> gedraaid worden om de configuratie in één keer te doen. Draai daarna <code>make install [clean]</code>.</p></div></td></tr></tbody></table></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Wanneer <code>config-recursive</code> wordt gebruikt, wordt de lijst met ports om te configureren opgesteld door het doel <code>all-depends-list</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a>. Het wordt vaak aangeraden om <code>make config-recursive</code> totdat de opties van alle afhankelijke ports zijn gedefinieerd en er geen schermen van <a href="https://man.freebsd.org/cgi/man.cgi?query=dialog&amp;sektion=1&amp;format=html">dialog(1)</a> voor opties van ports meer verschijnen, om er zeker van te zijn dat de opties van alle ports zijn geconfigureerd zoals bedoeld.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige shells houden een cache bij van de commando’s die in de mappen uit de omgevingsvariabele <code>PATH</code> staan om het opzoeken van een uitvoerbaar bestand te versnellen. Als zo’n shell wordt gebruikt, moet er na de installatie van een port het commando <code>rehash</code> worden uitgevoerd voordat zojuist geïnstalleerde commando’s kunnen worden gebruikt. Dit commando werkt voor shells zoals <code>tcsh</code>. Gebruik voor shells als <code>sh hash -r</code>. In de documentatie van een shell staat meer informatie.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Sommige DVD-ROM-producten van andere partijen, zoals de FreeBSD Toolkit van de <a href=http://www.freebsdmall.com/>FreeBSD Mall</a> bevatten distributiebestanden. Die kunnen met de Portscollectie gebruikt worden. Koppel de DVD-ROM aan op <span class=filename>/cdrom</span>. Stel bij gebruik van een ander aankoppelpunt de make variabele <code>CD_MOUNTPTS</code> in. De benodigde distributiebestanden worden automatisch gebruikt als ze op de schijf aanwezig zijn.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Licenties van sommige ports staan niet toe dat de code wordt opgenomen in een CD-ROM. Dit kan komen doordat er een formulier ingevuld moet worden voor een download of doordat herdistributie niet is toegestaan of om een andere reden. Om een port te installeren die niet op de CD-ROM staat moet de computer waarop de port geïnstalleerd wordt een Internetverbinding hebben.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het portssysteem gebruikt <a href="https://man.freebsd.org/cgi/man.cgi?query=fetch&amp;sektion=1&amp;format=html">fetch(1)</a> om bestanden te downloaden. Dat programma maakt gebruik van een aantal omgevingsvariabelen, waaronder <code>FTP_PASSIVE_MODE</code>, <code>FTP_PROXY</code>, en <code>FTP_PASSWORD</code>. Als een systeem achter een firewall staat, is het wellicht noodzakelijk om een of meer van deze omgevingsvariabelen in te stellen of om gebruik te maken van een FTP/HTTP proxy. In <a href="https://man.freebsd.org/cgi/man.cgi?query=fetch&amp;sektion=3&amp;format=html">fetch(3)</a> staat een complete lijst.</p></div><div class=paragraph><p>Als er geen continue Internetverbinding is, kan gebruik gemaakt worden van <code>make fetch</code>. Door dit commando in de map <span class=filename>/usr/ports</span> uit te voeren worden <em>alle</em> benodigde bestanden gedownload. Dit commando werkt ook op een lager niveau als <span class=filename>/usr/ports/net</span> of <span class=filename>/usr/ports/net/xmule</span>. Als een port afhankelijk is van bibliotheken of andere ports dan worden de distributiebestanden van die ports <em>niet</em> opgehaald. Om dat de bereiken dient <code>fetch</code> vervangen te worden door <code>fetch-recursive</code>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is mogelijk alle ports in een categorie te bouwen door <code>make</code> in een hogere map uit te voeren, naar analogie van het voorbeeld voor <code>make fetch</code>. Dit is wel gevaarlijk, omdat sommige ports niet tegelijk met andere geïnstalleerd kunnen zijn. In andere gevallen installeren twee ports hetzelfde bestand met een andere inhoud.</p></div></td></tr></tbody></table></div><div class=paragraph><p>In zeldzame gevallen willen of moeten gebruikers de tar-bestanden van een andere site dan de <code>MASTER_SITES</code> halen (de locatie waar de bestanden vandaan komen). Dat is mogelijk met de optie <code>MASTER_SITES</code> met een volgend commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/directory</span>
<span class=c># make MASTER_SITE_OVERRIDE= \</span>
ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/ fetch</code></pre></div></div><div class=paragraph><p>In het voorgaande voorbeeld is de optie <code>MASTER_SITES</code> gewijzigd naar <code>ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/</code>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige ports staan toe (of schrijven zelfs voor) dat er een aantal instellingen worden meegegeven die bepaalde onderdelen (niet gebruikt, beveiligingsinstellingen en andere aanpassingen) van de applicatie in- of uitschakelen. Voorbeelden van ports waarbij dat het geval is zijn <a class=package href=https://cgit.freebsd.org/ports/tree/www/firefox/>www/firefox</a>, <a class=package href=https://cgit.freebsd.org/ports/tree/security/gpgme/>security/gpgme</a> en <a class=package href=https://cgit.freebsd.org/ports/tree/mail/sylpheed-claws/>mail/sylpheed-claws</a>. Er wordt een bericht getoond als dit soort instellingen beschikbaar zijn.</p></div></td></tr></tbody></table></div><div class=sect4><h5 id=_standaardmappen_voor_ports_wijzigen>5.5.3.1. Standaardmappen voor ports wijzigen<a class=anchor href=#_standaardmappen_voor_ports_wijzigen></a></h5><div class=paragraph><p>Soms is het handig (of verplicht) om een andere map voor werk of ports te gebruiken. Met de variabelen <code>WRKDIRPREFIX</code> en <code>PREFIX</code> kunnen de standaardmappen veranderd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make WRKDIRPREFIX=/usr/home/example/ports install</span></code></pre></div></div><div class=paragraph><p>Het voorbeeld hierboven compileert de port in <span class=filename>/usr/home/example/ports</span> en installeert alles in <span class=filename>/usr/local</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make PREFIX=/usr/home/example/local install</span></code></pre></div></div><div class=paragraph><p>Het voorbeeld hierboven compileert in <span class=filename>/usr/ports</span> en installeert in <span class=filename>/usr/home/example/local</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make WRKDIRPREFIX=../ports PREFIX=../local install</span></code></pre></div></div><div class=paragraph><p>Het voorbeeld hierboven combineert de twee instellingen. Het gaat te ver om dit volledig in het handboek te beschrijven, maar hier krijgt de lezer een idee van de mogelijkheden.</p></div><div class=paragraph><p>Het is ook mogelijk de bovenstaande variabelen als deel van de omgeving in te stellen. In de hulppagina’s van de gebruikte shell staat hoe dat mogelijk is.</p></div></div><div class=sect4><h5 id=_omgaan_met_imake>5.5.3.2. Omgaan met <code>imake</code><a class=anchor href=#_omgaan_met_imake></a></h5><div class=paragraph><p>Er zijn ports die <code>imake</code> gebruiken (een onderdeel van het X Window systeem) die niet goed werken met <code>PREFIX</code> en erop staan te installeren in <span class=filename>/usr/X11R6</span>. Er zijn ook een aantal Perl ports die <code>PREFIX</code> negeren en in de Perl hiërarchie installeren. Deze ports op de <code>PREFIX</code> locatie laten installeren is meestal erg moeilijk of onmogelijk.</p></div></div><div class=sect4><h5 id=_ports_herconfigureren>5.5.3.3. Ports herconfigureren<a class=anchor href=#_ports_herconfigureren></a></h5><div class=paragraph><p>Tijdens het bouwen van bepaalde ports kan er een menu dat op ncurses is gebaseerd verschijnen waaruit u bepaalde bouwopties kunt selecteren. Het is niet ongebruikelijk dat gebruikers dit menu opnieuw willen bezoeken om deze opties toe te voegen, te verwijderen, of te veranderen nadat een port is gebouwd. Er zijn vele manieren om dit te doen. Eén optie is om naar de map waarin de port staat te gaan en <code>make config</code> te typen, wat eenvoudigweg het menu opnieuw toont met daarin de zelfde opties geselecteerd. Een andere optie is om <code>make showconfig</code> te gebruiken, wat alle instelopties voor de port aan u laat zien. Nog een andere optie is om <code>make rmconfig</code> uit te voeren wat alle geselecteerde opties zal verwijderen en u toestaat opnieuw te beginnen. Al deze opties, en anderen, worden zeer gedetailleerd uitgelegd in de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ports&amp;sektion=7&amp;format=html">ports(7)</a>.</p></div></div></div><div class=sect3><h4 id=ports-removing>5.5.4. Geïnstalleerde ports verwijderen<a class=anchor href=#ports-removing></a></h4><div class=paragraph><p>Nu u weet hoe ports te installeren, zult u zich waarschijnlijk afvragen hoe ze te verwijderen, in het geval dat u er een installeert en later besluit dat u de verkeerde port heeft geïnstalleerd. We zullen ons vorige voorbeeld (<code>lsof</code>) verwijderen. Ports worden op precies dezelfde manier verwijderd als pakketten met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> (zoals beschreven in het onderdeel <a href=#packages-using>Pakketten</a>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_delete lsof-4.57</span></code></pre></div></div></div><div class=sect3><h4 id=ports-upgrading>5.5.5. Ports bijwerken<a class=anchor href=#ports-upgrading></a></h4><div class=paragraph><p>Stel als eerste een lijst samen met ports waarvoor een nieuwere versie beschikbaar is in de Portscollectie met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_version&amp;sektion=1&amp;format=html">pkg_version(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_version -v</span></code></pre></div></div><div class=sect4><h5 id=ports-file-updating>5.5.5.1. <span class=filename>/usr/ports/UPDATING</span><a class=anchor href=#ports-file-updating></a></h5><div class=paragraph><p>Als de Portscollectie eenmaal is bijgewerkt vóór het bijwerken van ports, is het verstandig het bestand <span class=filename>/usr/ports/UPDATING</span> te raadplegen. In dat bestand staan aanwijzingen en wijzigingen voor gebruikers die van belang zijn bij het bijwerken van ports, zoals het veranderen van bestandsformaten, veranderen van de locatie van configuratie bestanden, en andere incompatibiliteiten met voorgaande versies.</p></div><div class=paragraph><p>Als <span class=filename>UPDATING</span> tegenstrijdig is met wat hier beschreven is, moet men <span class=filename>UPDATING</span> als waar beschouwen.</p></div></div><div class=sect4><h5 id=portupgrade>5.5.5.2. Ports bijwerken met portupgrade<a class=anchor href=#portupgrade></a></h5><div class=paragraph><p>Het hulpprogramma portupgrade is ontworpen om geïnstalleerde ports eenvoudig bij te werken. Het is beschikbaar via de port <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portupgrade/>ports-mgmt/portupgrade</a>. Installeer het net als iedere andere port met het commando <code>make install clean</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/ports-mgmt/portupgrade</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Scan de lijst met geïnstalleerde ports met het commando <code>pkgdb -F</code> en corrigeer alle gerapporteerde inconsistenties. Het is verstandig dit regelmatig te doen, voor iedere keer bijwerken.</p></div><div class=paragraph><p>Door het draaien van <code>portupgrade -a</code> zal portupgrade beginnen met het bijwerken van alle geïnstalleerde ports op een systeem waarvoor een nieuwere versie beschikbaar is. Met de vlag <code>-i</code> is het mogelijk in te stellen dat voor iedere bij te werken port om bevestiging wordt gevraagd.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -ai</span></code></pre></div></div><div class=paragraph><p>Gebruik om alleen een specifieke applicatie bij te werken en niet alle beschikbare ports <code>portupgrade pkgname</code>. Gebruik de vlag <code>-R</code> om portupgrade eerst alle ports bij te laten werken die voor een bij te werken toepassing benodigd zijn.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -R firefox</span></code></pre></div></div><div class=paragraph><p>Gebruik de vlag <code>-P</code> om bij installatie van pakketten in plaats van ports gebruik te maken. Met deze optie zoekt portupgrade in de lokale mappen uit <code>PKG_PATH</code> of haalt de pakketten via het netwerk op als ze lokaal niet worden aangetroffen. Als een pakket niet lokaal en niet via het netwerk wordt gevonden, dan gebruikt portupgrade ports. Om het gebruik van ports te voorkomen kan gebruik gemaakt worden van de optie <code>-PP</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -PP gnome2</span></code></pre></div></div><div class=paragraph><p>Om alleen de distributiebestanden op te halen (of pakketten als <code>-P</code> is opgegeven), zonder bouwen of installeren, is <code>-F</code> beschikbaar. Meer informatie staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=portupgrade&amp;sektion=1&amp;format=html">portupgrade(1)</a>.</p></div></div><div class=sect4><h5 id=portmaster>5.5.5.3. Ports bijwerken met portmaster<a class=anchor href=#portmaster></a></h5><div class=paragraph><p>portmaster is nog een gereedschap voor het bijwerken van geïnstalleerde ports. portmaster was ontworpen om gebruik te maken van de gereedschappen die in het "basis" systeem te vinden zijn (het hangt niet af andere ports) en het gebruikt de informatie in <span class=filename>/var/db/pkg</span> om te bepalen welke ports bij te werken. Het is beschikbaar via de port <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portmaster/>ports-mgmt/portmaster</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/ports-mgmt/portmaster</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>portmaster verdeelt ports in vier categoriën:</p></div><div class=ulist><ul><li><p>Wortelpoorten (geen afhankelijkheden, wordt niet van afgehangen)</p></li><li><p>Stampoorten (geen afhankelijkheden, wordt van afgehangen)</p></li><li><p>Takpoorten (hebben afhankelijkheden, wordt van afgehangen)</p></li><li><p>Bladpoorten (hebben afhankelijkheden, wordt niet van afgehangen)</p></li></ul></div><div class=paragraph><p>U kunt de optie <code>-L</code> gebruiken om alle geïnstalleerde ports tonen en naar updates te zoeken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster -L</span>
<span class=o>===&gt;&gt;&gt;</span> Root ports <span class=o>(</span>No dependencies, not depended on<span class=o>)</span>
<span class=o>===&gt;&gt;&gt;</span> ispell-3.2.06_18
<span class=o>===&gt;&gt;&gt;</span> screen-4.0.3
        <span class=o>===&gt;&gt;&gt;</span> New version available: screen-4.0.3_1
<span class=o>===&gt;&gt;&gt;</span> tcpflow-0.21_1
<span class=o>===&gt;&gt;&gt;</span> 7 root ports
...
<span class=o>===&gt;&gt;&gt;</span> Branch ports <span class=o>(</span>Have dependencies, are depended on<span class=o>)</span>
<span class=o>===&gt;&gt;&gt;</span> apache-2.2.3
        <span class=o>===&gt;&gt;&gt;</span> New version available: apache-2.2.8
...
<span class=o>===&gt;&gt;&gt;</span> Leaf ports <span class=o>(</span>Have dependencies, not depended on<span class=o>)</span>
<span class=o>===&gt;&gt;&gt;</span> automake-1.9.6_2
<span class=o>===&gt;&gt;&gt;</span> bash-3.1.17
        <span class=o>===&gt;&gt;&gt;</span> New version available: bash-3.2.33
...
<span class=o>===&gt;&gt;&gt;</span> 32 leaf ports

<span class=o>===&gt;&gt;&gt;</span> 137 total installed ports
        <span class=o>===&gt;&gt;&gt;</span> 83 have new versions available</code></pre></div></div><div class=paragraph><p>Alle geïnstalleerde ports kunnen met dit eenvoudige commando worden bijgewerkt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster -a</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Standaard maakt portmaster een back-up-pakket aan voordat het een bestaande port verwijderd. Als de installatie van de nieuwe versie succesvol is, zal portmaster de reservekopie verwijderen. Het gebruik van <code>-b</code> zal portmaster instrueren om de reservekopie niet automatisch te verwijderen. Het toevoegen van de optie <code>-i</code> zal portmaster in interactieve modus opstarten, en u vragen voordat het elke port bijwerkt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als u fouten tegenkomt tijdens het bijwerkproces, kunt u de optie <code>-f</code> gebruiken om alle ports bij te werken/te herbouwen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster -af</span></code></pre></div></div><div class=paragraph><p>U kunt portmaster ook gebruiken om nieuwe ports op het systeem te installeren, en alle afhankelijkheden bijwerken voordat de nieuwe port gebouwd en geïnstalleerd wordt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster shells/bash</span></code></pre></div></div><div class=paragraph><p>Bekijk <a href="https://man.freebsd.org/cgi/man.cgi?query=portmaster&amp;sektion=8&amp;format=html">portmaster(8)</a> voor meer informatie.</p></div></div></div><div class=sect3><h4 id=ports-disk-space>5.5.6. Ports en schijfruimte<a class=anchor href=#ports-disk-space></a></h4><div class=paragraph><p>Werken met de Portscollectie kan in de loop der tijd veel schijfruimte gebruiken. Na het bouwen en installeren van software uit de ports, is het van belang altijd de tijdelijke mappen <span class=filename>work</span> op te ruimen met het commando <code>make clean</code>. De complete Portscollectie kan geschoond worden met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsclean -C</span></code></pre></div></div><div class=paragraph><p>In de loop der tijd komen ook veel oude bestanden met broncode in de map <span class=filename>distfiles</span> te staan. Die kunnen handmatig verwijderd worden of met het volgende commando dat alle distributiebestanden waarnaar in de huidige ports geen verwijzingen meer staan verwijdert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsclean -D</span></code></pre></div></div><div class=paragraph><p>Of om alle distributiebestanden te verwijderen waardoor momenteel door geen één geïnstalleerde port op uw systeem wordt verwezen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsclean -DD</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het hulpprogramma <code>portsclean</code> is onderdeel van de suite portupgrade.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Vergeet niet ports die niet langer gebruikt worden te verwijderen. Een handig hulpmiddel hiervoor kan de port <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/pkg_cutleaves/>ports-mgmt/pkg_cutleaves</a> zijn.</p></div></div></div><div class=sect2><h3 id=ports-nextsteps>5.6. Activiteiten na het installeren<a class=anchor href=#ports-nextsteps></a></h3><div class=paragraph><p>Na het installeren van een nieuwe applicatie is het meestal verstandig om de documentatie te lezen die bij een applicatie zit, bestanden met instellingen die vereist zijn aan te passen, ervoor te zorgen dat de applicatie start na het opstarten (als het een daemon is), enzovoort.</p></div><div class=paragraph><p>De exacte stappen om een applicatie in te stellen zijn natuurlijk voor iedere applicatie anders. Maar als er net een nieuwe applicatie is geïnstalleerd en het is niet vanzelfsprekend hoe verder te gaan, dan kunnen de volgende tips helpen:</p></div><div class=ulist><ul><li><p>Met <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_info&amp;sektion=1&amp;format=html">pkg_info(1)</a> kan uitgevonden worden welke bestanden geïnstalleerd zijn en waar. Om bijvoorbeeld uit te vinden welke bestanden door FooPackage versie 1.0.0 zijn geïnstalleerd:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_info -L foopackage-1.0.0 | less</span></code></pre></div></div><div class=paragraph><p>Bestanden in mapnamen met <span class=filename>man/</span> zijn hulppagina’s, <span class=filename>etc/</span> bevat bestanden met instellingen en <span class=filename>doc/</span> bevat uitgebreidere documentatie.</p></div><div class=paragraph><p>Als niet helemaal duidelijk is welke versie van het programma is geïnstalleerd, kan een commando als volgt gebruikt worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_info | grep -i foopackage</span></code></pre></div></div><div class=paragraph><p>Hiermee worden alle pakketten getoond waar <em>foopackage</em> in de pakketnaam voorkomt.</p></div></li><li><p>Als de hulppagina’s zijn gevonden, kunnen die bekeken worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=man&amp;sektion=1&amp;format=html">man(1)</a>. Zo kan er ook in de bestanden met voorbeeldinstellingen gekeken worden en naar aanvullende documentatie, als die is bijgeleverd.</p></li><li><p>Als er een website is voor de applicatie staat daar vaak ook aanvullende documentatie, veelgestelde vragen, enzovoort. Als het webadres niet bekend is, kan dat nog staan in de uitvoer van het volgende commando:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_info foopackage-1.0.0</span></code></pre></div></div><div class=paragraph><p>Als er een regel met <code>WWW:</code> in staat, is dat de URL naar de website voor de applicatie.</p></div></li><li><p>Ports die na het opstarten moeten starten (zoals Internet diensten) hebben meestal een voorbeeldscript in <span class=filename>/usr/local/etc/rc.d</span>. Dit script kan bekeken, aangepast en hernoemd worden waar nodig. Meer informatie staat in <a href=./#configtuning-starting-services>Diensten Starten</a>.</p></li></ul></div></div><div class=sect2><h3 id=ports-broken>5.7. Omgaan met kapotte ports<a class=anchor href=#ports-broken></a></h3><div class=paragraph><p>Als een port niet werkt, zijn er een aantal mogelijke manieren om verder te komen:</p></div><div class="olist arabic"><ol class=arabic><li><p>Zoek uit of er een oplossing voor de port staat te wachten in de <a href=https://www.FreeBSD.org/support/#gnats>Problem Report database</a>. Als dat zo is kan wellicht de voorgestelde reparatie gebruikt worden.</p></li><li><p>Vraag de beheerder van de port om hulp. Voor het emailadres van de beheerder kan <code>make maintainer</code> getypt worden of het kan in de <span class=filename>Makefile</span> staan. Zet in de mail in ieder geval de naam en versie van de port (de regel met <code>$FreeBSD:</code> in de <span class=filename>Makefile</span>) en de uitvoer tot en met de foutmelding.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige ports worden niet beheerd door een individu maar in plaats daarvan door een <a href=https://docs.freebsd.org/en/articles/mailing-list-faq/>mailinglijst</a>. Veel, maar niet alle, van deze adressen zien eruit als <a href=mailto:freebsd-lijstnaam@FreeBSD.org>freebsd-lijstnaam@FreeBSD.org</a>. Houd hier alstublieft rekening mee bij het formuleren van vragen.</p></div><div class=paragraph><p>In het bijzonder worden ports die geregistreerd staan als onderhouden door <a href=mailto:ports@FreeBSD.org>ports@FreeBSD.org</a> helemaal niet onderhouden. Reparaties en ondersteuning, als dat al beschikbaar is, komt vanuit de gemeenschap die is geabonneerd op die mailinglijst. Meer vrijwilligers zijn altijd nodig!</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als er geen antwoord komt, stuur dan met <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> een foutrapport in. Zie <a href=https://docs.freebsd.org/nl/articles/problem-reports/>Writing FreeBSD Problem Reports</a>).</p></div></li><li><p>Repareren! In het <a href=https://docs.freebsd.org/en/books/porters-handbook/>Handboek voor de Porter</a> is gedetailleerde informatie te vinden over de infrastructuur van de "Ports", zodat een kapotte port gemaakt kan worden of er zelfs een nieuwe port ingestuurd kan worden.</p></li><li><p>Zoek een pakket van een FTP site in de buurt. De "master" pakketcollectie staat op <code>ftp.FreeBSD.org</code> in de <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/>map pakketten</a>, maar het is van belang dat er <em>eerst</em> <a href=./#mirrors-ftp>in de buurt</a> wordt gekeken! Dat het pakket werkt is waarschijnlijker dan wanneer uit de broncode wordt gecompileerd en het is nog sneller ook. Een pakket kan met <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> geïnstalleerd worden.</p></li></ol></div></div></div></div><div class=sect1><h2 id=x11>Hoofdstuk 6. Het X Window systeem<a class=anchor href=#x11></a></h2><div class=sectionbody><div class=sect2><h3 id=x11-synopsis>6.1. Overzicht<a class=anchor href=#x11-synopsis></a></h3><div class=paragraph><p>FreeBSD gebruikt X11 om gebruikers een krachtige grafische gebruikersschil te bieden. X11 is een vrij beschikbare versie van het X Window System dat geïmplementeerd is in XorgXFree86™ (en andere softwarepakketten die hier niet worden besproken). De standaard en officiele smaak van X11 in FreeBSD is Xorg, de X11-server die is ontwikkeld door de X.Org Foundation onder een licentie die veel lijkt op degene die door FreeBSD wordt gebruikt.</p></div><div class=paragraph><p>Meer informatie over de videohardware die X11 ondersteunt kan gevonden worden op de <a href=http://www.x.org/>Xorg</a> website.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Wat de componenten van het X Window systeem zijn en hoe zij samenwerken.</p></li><li><p>Hoe X11 geïnstalleerd en ingesteld kan worden.</p></li><li><p>Hoe verschillende window managers geïnstalleerd en gebruikt kunnen worden.</p></li><li><p>Hoe TrueType® lettertypen in X11 te gebruiken.</p></li><li><p>Hoe het systeem ingesteld moet worden voor grafisch aanmelden (XDM).</p></li></ul></div><div class=paragraph><p>Aangeraden voorkennis:</p></div><div class=ulist><ul><li><p>Hoe extra software van derden te installeren (<a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></li></ul></div></div><div class=sect2><h3 id=x-understanding>6.2. X begrijpen<a class=anchor href=#x-understanding></a></h3><div class=paragraph><p>X voor de eerste keer gebruiken kan een hele schok zijn voor mensen die gewend zijn aan andere grafische omgevingen, zoals Microsoft® Windows® of Mac OS®.</p></div><div class=paragraph><p>Het is niet noodzakelijk om alle details te kennen over de X componenten en hoe zij samenwerken, maar enige basiskennis draagt wel bij aan krachtiger gebruik kunnen maken van X.</p></div><div class=sect3><h4 id=_waarom_x>6.2.1. Waarom X?<a class=anchor href=#_waarom_x></a></h4><div class=paragraph><p>X is niet het eerste windows systeem dat geschreven is voor UNIX®, maar wel het meest populaire. Het oorspronkelijke X ontwikkelteam werkte eerst aan een ander window systeem. De naam van dat systeem was "W" (van "Window"). X was gewoon de volgende letter in het alfabet.</p></div><div class=paragraph><p>X kan gewoon "X", "X Window systeem", "X11" of nog anders genoemd worden. X11 "X Windows" noemen kan door sommigen als een belediging opgevat worden. <a href="https://man.freebsd.org/cgi/man.cgi?query=X&amp;sektion=7&amp;format=html">X(7)</a> kan hierover wat licht laten schijnen.</p></div></div><div class=sect3><h4 id=_het_x_clientserver_model>6.2.2. Het X client/server model<a class=anchor href=#_het_x_clientserver_model></a></h4><div class=paragraph><p>X is vanaf het begin aan ontworpen om netwerk-centraal te zijn en gebruikt een "client-server" model.</p></div><div class=paragraph><p>In het X model draait de "X server" op de computer waar het toetsenbord, beeldscherm en muis aan vast zit. De server is verantwoordelijk voor het regelen van beeldinformatie, verwerken van invoer van toetsenbord en muis, en andere invoer- of uitvoerapparaten (i.e., een "tablet" kan als invoerapparaat worden gebruikt, en een videoprojector kan een alternatief uitvoerapparaat zijn). Iedere X applicatie (zoals XTerm of Firefox) is een "cliënt". Een cliënt stuurt berichten naar de server zoals "teken een venster op deze coördinaten" en de server stuurt berichten terug zoals "de gebruiker heeft op de OK knop gedrukt".</p></div><div class=paragraph><p>Thuis of in kleine bedrijven draaien zowel de X server als de X clients op dezelfde machine. Het is heel goed mogelijk dat de X server op een minder krachtige desktop computer draait en de X applicaties (de clients) op een, zeg maar, dure krachtige machine van het bedrijf. Hier vindt de communicatie tussen de X client en server plaats over het netwerk.</p></div><div class=paragraph><p>Dit verwart sommige mensen, omdat de X terminologie geheel omgekeerd is aan wat ze verwachten. Dat is namelijk dat de "X server" de grote krachtige machine aan het eind van de gang is en de "X client" de machine op hun bureau is.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De X server is de machine met het beeldscherm en het toetsenbord en de X clients zijn de programma’s die de vensters tonen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het protocol vereist niet dat de clients en servers hetzelfde besturingssysteem moeten draaien of hetzelfde soort computer moeten zijn. Het is heel goed mogelijk om X server op een Microsoft® Windows® of Apple’s Mac OS® te draaien en er zijn verschillende gratis en commerciële applicaties die dat doen.</p></div></div><div class=sect3><h4 id=_de_window_manager>6.2.3. De window manager<a class=anchor href=#_de_window_manager></a></h4><div class=paragraph><p>De filosofie van het X ontwerp lijkt veel op die van UNIX®: "gereedschappen, geen beleid". Dit houdt in dat X niet bepaalt hoe een taak volbracht moet worden. In plaats daarvan worden gereedschappen geleverd aan de gebruiker die verantwoordelijk is voor het juiste gebruik hiervan.</p></div><div class=paragraph><p>Deze filosofie verbreedt zich door X niet te laten bepalen hoe vensters er moeten uitzien op het scherm, hoe ze verplaatst moeten worden met de muis, welke toetsaanslagen gebruikt moeten worden om te schakelen tussen vensters (bijvoorbeeld <span class=keyseq><kbd>Alt</kbd>+<kbd>Tab</kbd></span> in het geval van Microsoft® Windows®), hoe de titelbalken eruit moeten zien, of ze wel of niet sluitknoppen moeten hebben, enzovoort.</p></div><div class=paragraph><p>In plaats daarvan delegeert X deze verantwoordelijkheid aan een applicatie die "Window Manager" heet. Er zijn <a href=http://xwinman.org/>tientallen window managers</a> beschikbaar voor X. Elk van deze window managers heeft een eigen voorkomen en werking. Er zijn window managers met "virtual desktops" of met eigen toetscombinaties om de desktop te beheren; of hebben een "Start" knop of iets gelijksoortig. Sommige gebruiken "thema’s" die uiterlijk en beleving compleet veranderen door een nieuw thema te kiezen. Window managers zijn te vinden in de categorie <span class=filename>x11-wm</span> van de Portscollectie.</p></div><div class=paragraph><p>De KDE en GNOME desktop omgevingen hebben hun eigen window managers die in het bureaublad zijn geïntegreerd.</p></div><div class=paragraph><p>Iedere windows manager heeft zijn eigen manier van instellen. Sommige werken met handgetypte bestanden, anderen beschikken over grafische gereedschappen voor de meeste instellingen. Er is er minstens één (Sawfish) waarvan het instellingenbestand is geschreven in een dialect van de taal Lisp.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=title>Focusbeleid</div><div class=paragraph><p>De window manager is ook verantwoordelijk voor het "focusbeleid" van de muis. Ieder window geörienteerd systeem heeft een manier nodig om te bepalen welk venster actief is, toetsaanslagen ontvangt en daarbij zichtbaar aangeeft welk venster actief is.</p></div><div class=paragraph><p>Een bekend focus beleid heet "click-to-focus". Dit model wordt gebruikt door Microsoft® Windows®, waarbij een venster actief wordt door er met de muis op te klikken.</p></div><div class=paragraph><p>X ondersteunt geen specifiek focusbeleid. In plaats daarvan bepaalt de window manager op welk venster, op welk moment, de focus ligt. Een aantal window managers ondersteunen verschillende focusmethoden. Ze ondersteunen allemaal "click to focus" en de meerderheid ondersteunt ook nog andere.</p></div><div class=paragraph><p>De meest populaire zijn:</p></div><div class=dlist><dl><dt class=hdlist1>focus-volgt-muis (focus-follows-mouse)</dt><dd><p>Het venster dat onder de muis zit is het venster waarop de focus ligt. Dit hoeft niet het venster te zijn dat bovenop alle andere vensters ligt. De focus verandert door te wijzen naar een ander venster. Het is niet nodig om er ook nog eens op te klikken.</p></dd><dt class=hdlist1>slordige-focus (sloppy-focus)</dt><dd><p>Dit beleid is een kleine uitbreiding op focus-follows-mouse. Indien bij focus-follows-mouse de muis over het root venster (of de achtergrond) gaat, ligt op geen enkel venster de focus en gaan alle toetsaanslagen verloren. Bij sloppy-focus, verandert de focus alleen als de muis in een nieuw venster komt en niet als het huidige venster wordt verlaten.</p></dd><dt class=hdlist1>klik-voor-focus (click-to-focus)</dt><dd><p>Het actieve venster wordt geselecteerd door erop te klikken. Het venster wordt dan "opgetild" en verschijnt dan voor alle andere vensters. Alle toetsaanslagen worden nu naar dit venster gestuurd, zelfs als de cursor naar een ander scherm wordt verplaatst.</p></dd></dl></div><div class=paragraph><p>Veel window managers ondersteunen andere soorten of variaties op de bovenstaande typen muisbeleid. Hierover staat meestal meer in de documentatie van de betreffende window manager.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_widgets>6.2.4. Widgets<a class=anchor href=#_widgets></a></h4><div class=paragraph><p>De X aanpak door gereedschappen te leveren en niets af te dwingen breidt zich uit naar de widgets die in elk applicatievenster te zien zijn.</p></div><div class=paragraph><p>"Widget" is een term voor alle dingen van de gebruikersinterface waarop geklikt kan worden of een andere actie mee uitgevoerd kan worden: knoppen, vinkvakjes, iconen, lijsten en ga zo maar door. Microsoft® Windows® noemt ze "controls".</p></div><div class=paragraph><p>Microsoft® Windows® en Apple’s Mac OS® hebben beide een erg strikt widgetbeleid. Van de applicatieontwikkelaars wordt verwacht dat hun applicaties eenduidig zijn wat betreft uiterlijk en beleving. Bij X is ervoor gekozen geen grafische stijl of widgets te verplichten.</p></div><div class=paragraph><p>X applicaties hebben dus niet allemaal hetzelfde uiterlijk. Er zijn populaire widgetsets en variaties, inclusief Qt, gebruikt door KDE, of GTK+ van het GNOME project. Vanuit dit oogpunt lijkt het enigszins op de UNIX® desktop, wat het makkelijker maakt voor de beginnende gebruiker.</p></div></div></div><div class=sect2><h3 id=x-install>6.3. X11 installeren<a class=anchor href=#x-install></a></h3><div class=paragraph><p>Xorg is de X11-implementatie voor FreeBSD. Xorg is de X11 server van de open source implementatie die is uitgebracht door de X.Org Foundation. Xorg is gebaseerd op de code van XFree86™ 4.4RC2 en X11R6.6. De versie van Xorg die momenteel beschikbaar is in de FreeBSD Portscollectie is 7.7.</p></div><div class=paragraph><p>Om Xorg vanuit de Portscollectie te bouwen en te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11/xorg</span>
<span class=c># make install clean</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Om Xorg compleet te bouwen is tenminste 4 GB vrije schijfruimte nodig.</p></div></td></tr></tbody></table></div><div class=paragraph><p>X11 kan ook als pakket geïnstalleerd worden doordat er binaire pakketten beschikbaar zijn voor <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>. Als hiervoor de optie "remote fetching" van <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> wordt gebruikt, dan moet het versienummer verwijderd worden. <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> haalt automatisch de laatste versie van het programma op.</p></div><div class=paragraph><p>Om het pakket voor Xorg op te halen en te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r xorg</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het voorbeeld hierboven installeert de complete X11 distributie inclusief de servers, clients, lettertypen enz. Er zijn ook afzonderlijke pakketten en ports beschikbaar voor verschillende delen van X11.</p></div><div class=paragraph><p>Om een minimale X11-distributie te installeren kunt u als alternatief <a class=package href=https://cgit.freebsd.org/ports/tree/x11/xorg-minimal/>x11/xorg-minimal</a> installeren.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De rest van dit hoofdstuk licht toe hoe X11 wordt ingesteld en hoe een productieve desktopomgeving gebouwd kan worden.</p></div></div><div class=sect2><h3 id=x-config>6.4. X11 instellen<a class=anchor href=#x-config></a></h3><div class=sect3><h4 id=_voorbereiding>6.4.1. Voorbereiding<a class=anchor href=#_voorbereiding></a></h4><div class=paragraph><p>In de meeste gevallen configureert X11 zichzelf. Voor degenen met oudere of ongebruikelijke apparatuur kan het nuttig zijn om informatie over de hardware te verzamelen voordat er met de configuratie wordt begonnen.</p></div><div class=ulist><ul><li><p>Monitor synchronisatiefrequenties</p></li><li><p>Chipset van de videokaart</p></li><li><p>Geheugen van de videokaart</p></li></ul></div><div class=paragraph><p>De schermresolutie en ververssnelheid worden bepaald door de horizontale en verticale synchronisatiefrequenties. Bijna alle monitoren ondersteunen het automatisch elektronisch detecteren van deze waardes. Sommige monitoren geven deze waardes niet, dus moeten de specificaties worden bepaald uit de geprinte handleiding of van de website van de fabrikant.</p></div><div class=paragraph><p>De chipset van de videokaart wordt ook automatisch gedetecteerd en gebruikt om het juiste videostuurprogramma te selecteren. Het kan handig voor de gebruiker zijn om te weten welke chipset is geïnstalleerd wanneer de automatische detectie niet het gewenste resultaat geeft.</p></div><div class=paragraph><p>Het geheugen van de videokaart bepaalt de maximale resolutie en de kleurdiepte die afgebeeld kunnen worden.</p></div></div><div class=sect3><h4 id=_x11_instellen>6.4.2. X11 instellen<a class=anchor href=#_x11_instellen></a></h4><div class=paragraph><p>Xorg gebruikt HAL om toetsenborden en muizen automatisch te detecteren. De ports <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/hal/>sysutils/hal</a> en <a class=package href=https://cgit.freebsd.org/ports/tree/devel/dbus/>devel/dbus</a> worden als afhankelijkheden van <a class=package href=https://cgit.freebsd.org/ports/tree/x11/xorg/>x11/xorg</a> geïnstalleerd, maar moeten met de volgende regels in het bestand <span class=filename>/etc/rc.conf</span> worden aangezet:</p></div><div class="literalblock programlisting"><div class=content><pre>hald_enable=&#34;YES&#34;
dbus_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Deze diensten dienen gestart te worden (ofwel handmatig of door opnieuw op te starten) voordat er verder wordt gegaan met de configuratie of gebruik van Xorg.</p></div><div class=paragraph><p>Xorg werkt vaak zonder enige verdere configuratie door het volgende op de prompt te typen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% startx</code></pre></div></div><div class=paragraph><p>De automatische configuratie kan met sommige hardware mislukken, of het kan dingen anders instellen dan gewenst is. In deze gevallen is handmatige configuratie nodig.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Bureaubladomgevingen als GNOME, KDE, of Xfce hebben gereedschappen waarmee de gebruiker eenvoudig de schermparameters zoals de resolutie kan instellen. Dus als de standaardconfiguratie niet acceptabel is en u van plan bent om een bureaubladomgeving te installeren kunt u gewoon doorgaan met de installatie van de bureaubladomgeving en het juiste scherminstelgereedschap gebruiken.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het instellen van X11 bestaat uit meerdere stappen. De eerste stap is het bouwen van een instellingenbestand. Dit kan als de supergebruiker met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># Xorg -configure</span></code></pre></div></div><div class=paragraph><p>Dit genereert een kaal X11-instellingenbestand in de map <span class=filename>/root</span> met de naam <span class=filename>xorg.conf.new</span>. Feitelijk wordt bepaald waar de map staat door hoe er superuser rechten zijn verkregen. <code>$HOME</code> is anders bij gebruik van <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> of bij direct aanmelden. Het X11 programma probeert dan de grafische hardware te detecteren en schrijft een instellingenbestand dat de juiste stuurprogramma’s laadt voor de gevonden hardware van het systeem.</p></div><div class=paragraph><p>De volgende stap is het testen van de bestaande instellingen om te controleren of Xorg met de grafische kaart van het doelsysteem kan werken. Typ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># Xorg -config xorg.conf.new -retro</span></code></pre></div></div><div class=paragraph><p>Als er een zwart/grijs rooster en een X muis cursor verschijnen was de instelling succesvol. Om de test te stoppen dient naar de virtuele console waarmee de test werd gestart overgeschakeld te worden door op <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Fn</kbd></span> (<kbd>F1</kbd> voor de eerste virtuele console) en <span class=keyseq><kbd>Ctrl</kbd>+<kbd>C</kbd></span> te drukken.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De toetsencombinatie <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Backspace</kbd></span> kan ook gebruikt worden om uit Xorg te breken. Om het aan te zetten, kunt u òfwel het volgende commando uitvoeren vanaf elke X-terminal-emulator:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setxkbmap <span class=nt>-option</span> terminate:ctrl_alt_bksp</code></pre></div></div><div class=paragraph><p>òf een instellingenbestand voor het toetsenbord genaamd <span class=filename>x11-input.fdi</span> voor hald aanmaken en het in de map <span class=filename>/usr/local/etc/hal/fdi/policy</span> opslaan. Dit bestand dient het volgende te bevatten:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;deviceinfo version=&#34;0.2&#34;&gt;
  &lt;device&gt;
    &lt;match key=&#34;info.capabilities&#34; contains=&#34;input.keyboard&#34;&gt;
      &lt;merge key=&#34;input.x11_options.XkbOptions&#34; type=&#34;string&#34;&gt;terminate:ctrl_alt_bksp&lt;/merge&gt;
    &lt;/match&gt;
  &lt;/device&gt;
&lt;/deviceinfo&gt;</pre></div></div><div class=paragraph><p>U moet uw machine opnieuw opstarten om hald te forceren om dit bestand te lezen.</p></div><div class=paragraph><p>De volgende regel dient ook aan de sectie <code>ServerLayout</code> of <code>ServerFlags</code> van <span class=filename>xorg.conf.new</span> te worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>Option &#34;DontZap&#34;	&#34;off&#34;</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Als de muis niet werkt, dan moet deze eerst ingesteld worden. Zie <a href=./#mouse>Muisinstellingen</a> in het FreeBSD installatiehoofdstuk. In recente versies van Xorg worden de secties <code>InputDevice</code> in <span class=filename>xorg.conf</span> genegeerd ten voorkeur van de automatisch gedetecteerde apparaten. Voeg de volgende regel aan de sectie <code>ServerLayout</code> of <code>ServerFlags</code> van dit bestand toe om het oude gedrag te herstellen:</p></div><div class="literalblock programlisting"><div class=content><pre>Option &#34;AutoAddDevices&#34; &#34;false&#34;</pre></div></div><div class=paragraph><p>Invoerapparaten kunnen dan zoals in vorige versies worden geconfigureerd, tezamen met eventuele andere benodigde opties (bijvoorbeeld omschakelen van toetsenbordindeling).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Zoals al eerder is uitgelegd zal de daemon hald standaard automatisch uw toetsenbord detecteren. Het kan zijn dat de indeling of het model van uw toetsenbord niet juist zijn. Bureaubladomgevingen zoals GNOME, KDE of Xfce bieden gereedschappen om het toetsenbord in te stellen. Het is echter mogelijk om de eigenschappen direct in te stellen met behulp van het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=setxkbmap&amp;sektion=1&amp;format=html">setxkbmap(1)</a> of met een configuratieregel van hald.</p></div><div class=paragraph><p>Als men bijvoorbeeld een PC-toetsenbord met 102 toetsen met een Franse indeling wilt gebruiken, dienen we een instellingenbestand voor het toestenbord voor hald aan te maken genaamd <span class=filename>x11-input.fdi</span> en het op te slaan in de map <span class=filename>/usr/local/etc/hal/fdi/policy</span>. Het dient de volgende regels te bevatten:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;deviceinfo version=&#34;0.2&#34;&gt;
  &lt;device&gt;
    &lt;match key=&#34;info.capabilities&#34; contains=&#34;input.keyboard&#34;&gt;
      &lt;merge key=&#34;input.x11_options.XkbModel&#34; type=&#34;string&#34;&gt;pc102&lt;/merge&gt;
      &lt;merge key=&#34;input.x11_options.XkbLayout&#34; type=&#34;string&#34;&gt;fr&lt;/merge&gt;
    &lt;/match&gt;
  &lt;/device&gt;
&lt;deviceinfo&gt;</pre></div></div><div class=paragraph><p>Als dit bestand al bestaat, kunt u de regels betreffende de configuratie van het toetsenbord kopiëren en aan uw bestand toevoegen.</p></div><div class=paragraph><p>U dient uw machine opnieuw op te starten om hald te forceren om dit bestand te lezen.</p></div><div class=paragraph><p>Het is mogelijk om hetzelfde te bereiken vanaf een X-terminal of een script met dit commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setxkbmap <span class=nt>-model</span> pc102 <span class=nt>-layout</span> fr</code></pre></div></div><div class=paragraph><p>Het bestand <span class=filename>/usr/local/shared/X11/xkb/rules/base.lst</span> noemt de beschikbare toetsenborden, indelingen en opties.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het bestand <span class=filename>xorg.conf.new</span> kan nu naar wens worden aangepast. Open het bestand in een tesktverwerker zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=emacs&amp;sektion=1&amp;format=html">emacs(1)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=ee&amp;sektion=1&amp;format=html">ee(1)</a>. Indien de monitor een ouder of ongebruikelijk model is dat geen automatische detectie van de synchronisatiefrequenties ondersteunt, dan kunnen deze instellingen worden toegevoegd aan <span class=filename>xorg.conf.new</span> in de sectie <code>"Monitor"</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;Monitor&#34;
        Identifier   &#34;Monitor0&#34;
        VendorName   &#34;Monitor Vendor&#34;
        ModelName    &#34;Monitor Model&#34;
        HorizSync    30-107
        VertRefresh  48-120
EndSection</pre></div></div><div class=paragraph><p>De meeste monitoren ondersteunen de automatische detectie van de synchronisatiefrequentie, wat het handmatig invoeren van deze waardes overbodig maakt. Voor de enkele monitoren die geen automatische detectie ondersteunen, dienen om mogelijke schade te voorkomen alleen waardes die door de fabrikant zijn opgegeven te worden ingevoerd.</p></div><div class=paragraph><p>X kan DPMS (Energy Star) eigenschappen gebruiken bij monitoren die dit ondersteunen. <a href="https://man.freebsd.org/cgi/man.cgi?query=xset&amp;sektion=1&amp;format=html">xset(1)</a> regelt de timeouts en kan de statussen standby, suspend of uit forceren. Om DPMS eigenschappen voor een monitor te activeren, moet de volgende regel toegevoegd worden aan de monitor sectie:</p></div><div class="literalblock programlisting"><div class=content><pre>Option       &#34;DPMS&#34;</pre></div></div><div class=paragraph><p>Als het instellingenbestand <span class=filename>xorg.conf.new</span> toch open staat in de editor dan kan ook meteen de gewenste standaardresolutie en kleurdiepte gekozen worden. Dit staat in het onderdeel <code>"Screen"</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;Screen&#34;
        Identifier &#34;Screen0&#34;
        Device     &#34;Card0&#34;
        Monitor    &#34;Monitor0&#34;
        DefaultDepth 24
        SubSection &#34;Display&#34;
                Viewport  0 0
                Depth     24
                Modes     &#34;1024x768&#34;
        EndSubSection
EndSection</pre></div></div><div class=paragraph><p>Het sleutelwoord <code>DefaultDepth</code> beschrijft de kleurdiepte die standaard wordt gebruikt. Met de commandoregeloptie <code>-depth</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=Xorg&amp;sektion=1&amp;format=html">Xorg(1)</a> kan dit overschreven worden. Het sleutelwoord <code>Modes</code> beschrijft de resolutie waarmee gewerkt wordt bij de opgegeven kleurdiepte. Alleen VESA standaarden die door de grafische kaart van het systeem worden gedefinieerd worden ondersteund. In het voorbeeld hierboven is de standaard kleurdiepte 24 bits per pixel. Bij deze kleurdiepte is de toegestane resolutie 1024 bij 768 pixels.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Bij het oplossen van problemen zijn de logboekbestanden van X11 vaak een goede hulp. Ze bevatten informatie voor ieder apparaat waar de X11 server verbinding mee maakt. Namen van Xorg logboekbestanden hebben de vorm <span class=filename>/var/log/Xorg.0.log</span>. De precieze naam van een logboekbestand van variëren van <span class=filename>Xorg.0.log</span> tot <span class=filename>Xorg.8.log</span> enzovoort.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als alles is ingesteld, moet het instellingenbestand op een plaats gezet worden waar <a href="https://man.freebsd.org/cgi/man.cgi?query=Xorg&amp;sektion=1&amp;format=html">Xorg(1)</a> het kan vinden. Dit is meestal <span class=filename>/etc/X11/xorg.conf</span> of <span class=filename>/usr/local/etc/X11/xorg.conf</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp xorg.conf.new /etc/X11/xorg.conf</span></code></pre></div></div><div class=paragraph><p>Het instellen van X11 is nu gereed. Xorg gestart worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=startx&amp;sektion=1&amp;format=html">startx(1)</a>. De X11-server kan ook gestart worden met behulp van <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=1&amp;format=html">xdm(1)</a>.</p></div></div><div class=sect3><h4 id=_bijzondere_instellingen>6.4.3. Bijzondere instellingen<a class=anchor href=#_bijzondere_instellingen></a></h4><div class=sect4><h5 id=_instellen_met_de_intel_i810_grafische_chipset>6.4.3.1. Instellen met de Intel® <code>i810</code> grafische chipset<a class=anchor href=#_instellen_met_de_intel_i810_grafische_chipset></a></h5><div class=paragraph><p>Instellen met Intel® i810 geïntegreerde chipsets vereist de <span class=filename>agpgart</span> AGP programmeerinterface voor X11 om de kaart aan te sturen. Zie de <a href="https://man.freebsd.org/cgi/man.cgi?query=agp&amp;sektion=4&amp;format=html">agp(4)</a> handleiding voor meer informatie.</p></div><div class=paragraph><p>Hierdoor wordt het instellen van de hardware net als ieder andere grafische kaart. Bij systemen die zonder <a href="https://man.freebsd.org/cgi/man.cgi?query=agp&amp;sektion=4&amp;format=html">agp(4)</a> stuurprogramma gecompileerd zijn slaagt het laden van module met <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> niet. Het stuurprogramma moet in de kernel geladen zijn tijdens het opstarten door te compileren of door <span class=filename>/boot/loader.conf</span> te gebruiken.</p></div></div><div class=sect4><h5 id=_een_breedbeeld_flatpanel_toevoegen>6.4.3.2. Een Breedbeeld Flatpanel toevoegen<a class=anchor href=#_een_breedbeeld_flatpanel_toevoegen></a></h5><div class=paragraph><p>Deze sectie gaat uit van wat diepere configuratiekennis. Als pogingen om de bovenstaande standaard instelgereedschappen niet tot een werkende configuratie leidden, dan is er genoeg informatie in de logbestanden om de opstelling aan de praat te krijgen. Het gebruik van een tekstverwerker zal nodig zijn.</p></div><div class=paragraph><p>Huidige breedbeeldformaten (zoals WSXGA, WSXGA+, WUXGA, WXGA en WXGA+) ondersteunen 16:10 en 10:9 formaten of aspectverhoudingen die problematisch kunnen zijn. Voorbeelden van enkele veelvoorkomende schermresoluties voor 16:10 aspectverhoudingen zijn:</p></div><div class=ulist><ul><li><p>2560x1600</p></li><li><p>1920x1200</p></li><li><p>1680x1050</p></li><li><p>1440x900</p></li><li><p>1280x800</p></li></ul></div><div class=paragraph><p>Op een gegeven moment zal het toevoegen van een van deze resoluties net zo eenvoudig zijn als een mogelijke <code>Mode</code> in het <code>Section "Screen"</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;Screen&#34;
Identifier &#34;Screen 0&#34;
Device     &#34;Card0&#34;
Monitor    &#34;Monitor0&#34;
DefaultDepth 24
SubSection &#34;Display&#34;
	Viewport 0 0
	Depth    24
	Modes    &#34;1680x1050&#34;
EndSubSection
EndSection</pre></div></div><div class=paragraph><p>Xorg is slim genoeg om de resolutie-informatie via I2C/DDC-informtie uit het flatpanel te onttrekken zodat het weet wat de monitor aan kan wat betreft frequenties en resoluties.</p></div><div class=paragraph><p>Als die <code>ModeLines</code> niet bestaan in de stuurprogramma’s, dient men Xorg een kleine hint te geven. Met behulp van <span class=filename>/var/log/Xorg.0.log</span> kan men genoeg informatie onttrekken om handmatig een werkende <code>ModeLine</code> aan te maken. Kijk naar informatie die op deze lijkt:</p></div><div class="literalblock programlisting"><div class=content><pre>(II) MGA(0): Supported additional Video Mode:
(II) MGA(0): clock: 146.2 MHz   Image Size:  433 x 271 mm
(II) MGA(0): h_active: 1680  h_sync: 1784  h_sync_end 1960 h_blank_end 2240 h_border: 0
(II) MGA(0): v_active: 1050  v_sync: 1053  v_sync_end 1059 v_blanking: 1089 v_border: 0
(II) MGA(0): Ranges: V min: 48  V max: 85 Hz, H min: 30  H max: 94 kHz, PixClock max 170 MHz</pre></div></div><div class=paragraph><p>Deze informatie wordt EDID-informatie genoemd. Hiervan een <code>ModeLine</code> maken is gewoon een kwestie van de nummers in de juiste volgorde zetten:</p></div><div class="literalblock programlisting"><div class=content><pre>ModeLine &lt;name&gt; &lt;clock&gt; &lt;4 horiz. timings&gt; &lt;4 vert. timings&gt;</pre></div></div><div class=paragraph><p>Dus de <code>ModeLine</code> in <code>Section "Monitor"</code> zou er voor dit voorbeeld uitzien als:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;Monitor&#34;
Identifier       &#34;Monitor1&#34;
VendorName       &#34;GroteNaam&#34;
ModelName        &#34;BesteModel&#34;
ModeLine         &#34;1680x1050&#34; 146.2 1680 1784 1960 2240 1050 1053 1059 1089
Option           &#34;DPMS&#34;
EndSection</pre></div></div><div class=paragraph><p>Na het voltooien van deze eenvoudige stappen, zou X moeten starten op uw nieuwe breedbeeldmonitor.</p></div></div></div></div><div class=sect2><h3 id=x-fonts>6.5. Lettertypen gebruiken in X11<a class=anchor href=#x-fonts></a></h3><div class=sect3><h4 id=type1>6.5.1. Type1 lettertypen<a class=anchor href=#type1></a></h4><div class=paragraph><p>De standaard lettertypen van X11 zijn allerminst ideaal voor het typische bureaubladprogramma. Grote presentatielettertypen zien er hoekig en onprofessioneel uit en kleine lettertypen zijn bijna onleesbaar. Er zijn diverse gratis, kwalitatief goede Type1 (PostScript®) lettertypen die meteen gebruikt kunnen worden met X11. De URW lettertypecollectie (<a class=package href=https://cgit.freebsd.org/ports/tree/x11-fonts/urwfonts/>x11-fonts/urwfonts</a>) heeft bijvoorbeeld hoge kwaliteit versies van standaard Type1 lettertypen (Times Roman™, Helvetica™, Palatino™ en anderen). De Freefonts collectie (<a class=package href=https://cgit.freebsd.org/ports/tree/x11-fonts/freefonts/>x11-fonts/freefonts</a>) heeft nog meer lettertypen, maar de meesten ervan zijn bedoeld om in grafische software als Gimp gebruikt te worden en zijn niet compleet genoeg om als schermlettertypen te gebruiken. Daarbij kan X11 zonder veel moeite ingesteld worden om TrueType® lettertypen te gebruiken. Meer informatie staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=X&amp;sektion=7&amp;format=html">X(7)</a> of de paragraaf over <a href=#truetype>TrueType® Lettertypen</a>.</p></div><div class=paragraph><p>Om de bovenstaande Type1 lettertypecollectie van de Portscollectie te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11-fonts/urwfonts</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Dat geldt ook voor de freefont en andere collecties. Om de X server te vertellen dat deze lettertypen bestaan, dient de volgende regel toegevoegd te worden aan het instellingenbestand van de X server (<span class=filename>/etc/X11/xorg.conf</span>):</p></div><div class="literalblock programlisting"><div class=content><pre>FontPath &#34;/usr/local/lib/X11/fonts/URW/&#34;</pre></div></div><div class=paragraph><p>Ook kan op de commando regel in de X sessie het volgende gestart worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% xset fp+ /usr/local/lib/X11/fonts/URW
% xset fp rehash</code></pre></div></div><div class=paragraph><p>Dit werkt wel, maar zodra de X sessie wordt afgesloten is het weer verdwenen tenzij het is toegevoegd aan het opstartbestand (<span class=filename>~/.xinitrc</span> voor een normale <code>startx</code> sessie of <span class=filename>~/.xsession</span> als er wordt aangemeld met een grafische aanmeldmanager als XDM). Een derde manier is het gebruik van het nieuwe bestand <span class=filename>/usr/local/etc/fonts/local.conf</span>: zie hiervoor de paragraaf over <a href=#antialias>Anti-aliasing</a>.</p></div></div><div class=sect3><h4 id=truetype>6.5.2. TrueType® lettertypen<a class=anchor href=#truetype></a></h4><div class=paragraph><p>Xorg heeft ingebouwde ondersteuning voor het renderen van TrueType® lettertypen. Er zijn twee verschillende modules die deze functionaliteit activeren. In dit voorbeeld wordt de freetype module gebruikt omdat deze beter werkt met de andere lettertypen die back-ends renderen. Om de freetype module te activeren dient de volgende regel toegevoegd te worden aan het onderdeel <code>"Module"</code> van <span class=filename>/etc/X11/xorg.conf</span>.</p></div><div class="literalblock programlisting"><div class=content><pre>Load  &#34;freetype&#34;</pre></div></div><div class=paragraph><p>Hierna dient een map voor de TrueType® lettertypen gemaakt te worden (bijvoorbeeld <span class=filename>/usr/local/lib/X11/fonts/TrueType</span>) en alle TrueType® lettertypen moeten naar deze map gekopieerd worden. TrueType® lettertypen kunnen niet direct van een Macintosh® gehaald worden. Ze moeten in een UNIX®/MS-DOS®/Windows® formaat zijn voor X11. Zodra de bestanden naar deze map zijn gekopieerd, kan ttmkfdir gestart worden om een <span class=filename>fonts.dir</span> bestand te maken zodat de X lettertyperenderer weet waar deze nieuwe bestanden zijn geïnstalleerd. <code>ttmkfdir</code> zit in de FreeBSD Portscollectie als <a class=package href=https://cgit.freebsd.org/ports/tree/x11-fonts/ttmkfdir/>x11-fonts/ttmkfdir</a>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/local/lib/X11/fonts/TrueType</span>
<span class=c># ttmkfdir -o fonts.dir</span></code></pre></div></div><div class=paragraph><p>Nu moet de TrueType® map toe aan het lettertypepad toegevoegd worden. Dit gebeurt op dezelfde wijze als boven is beschreven voor <a href=#type1>Type1</a> lettertypen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% xset fp+ /usr/local/lib/X11/fonts/TrueType
% xset fp rehash</code></pre></div></div><div class=paragraph><p>of door een <code>FontPath</code> regel toe te voegen aan <span class=filename>xorg.conf</span>.</p></div><div class=paragraph><p>Dat is alles. Nu herkennen Gimp, Apache OpenOffice en alle andere X applicaties de geïnstalleerde TrueType® lettertypen. Extreem kleine lettertypen (zoals hoge resolutie tekst op een webpagina) en extreme grote lettertypen (in StarOffice™) zien er nu veel beter uit.</p></div></div><div class=sect3><h4 id=antialias>6.5.3. Antialias lettertypen<a class=anchor href=#antialias></a></h4><div class=paragraph><p>Alle lettertypen die X11 in de mappen <span class=filename>/usr/local/lib/X11/fonts/</span> en <span class=filename>~/.fonts/</span> staan zijn automatisch beschikbaar voor anti-aliasing in applicaties die Xft ondersteunen. De meeste recente applicaties ondersteunen Xft, inclusief KDE, GNOME, en Firefox.</p></div><div class=paragraph><p>Om te kunnen regelen welke lettertypen gebruik maken van anti-alias of om de eigenschappen van anti-aliasing in te stellen kan <span class=filename>/usr/local/etc/fonts/local.conf</span> gemaakt of gewijzigd worden. In dit bestand kunnen speciale eigenschappen van het Xft lettertypesysteem aangepast worden. Deze paragraaf beschrijft wat eenvoudige mogelijkheden. Meer details staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=fonts-conf&amp;sektion=5&amp;format=html">fonts-conf(5)</a>.</p></div><div class=paragraph><p>Dit bestand moet in het XML formaat opgemaakt worden. Hoofdletters en kleine letters worden onderscheiden en alle tags moeten netjes worden afgesloten. Het bestand begint met de gewone XML header gevolgd door een DOCTYPE definitie en daarna de <code>&lt;fontconfig></code> tag:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;?xml version=&#34;1.0&#34;?&gt;
&lt;!DOCTYPE fontconfig SYSTEM &#34;fonts.dtd&#34;&gt;
&lt;fontconfig&gt;</pre></div></div><div class=paragraph><p>Zoals al eerder is vermeld zijn alle lettertypen in <span class=filename>/usr/local/lib/X11/fonts/</span> en in <span class=filename>~/.fonts/</span> al geschikt gemaakt voor Xft applicaties. Als naast deze twee mappen nog een andere lettertypen moeten kunnen bevatten, dan dient een soortgelijke regel als de onderstaande aan <span class=filename>/usr/local/etc/fonts/local.conf</span> toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;dir&gt;/pad/naar/mijn/fonts&lt;/dir&gt;</pre></div></div><div class=paragraph><p>Na het toevoegen van nieuwe lettertypen en zeker nieuwe lettertypemappen dienen de lettertypecaches opnieuw opgebouwd worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fc-cache -f</span></code></pre></div></div><div class=paragraph><p>Anti-aliasing maakt randen een beetje wazig wat kleine teksten beter leesbaar maakt en voorkomt "trapvorming" van grote letters. Maar het kan oogkramp veroorzaken als het op normale tekst wordt toegepast. Om lettertypen kleiner dan 14 punten uit te sluiten van anti-aliasing moeten de volgende regels toegevoegd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;match target=&#34;font&#34;&gt;
    &lt;test name=&#34;size&#34; compare=&#34;less&#34;&gt;
        &lt;double&gt;14&lt;/double&gt;
    &lt;/test&gt;
    &lt;edit name=&#34;antialias&#34; mode=&#34;assign&#34;&gt;
        &lt;bool&gt;false&lt;/bool&gt;
    &lt;/edit&gt;
&lt;/match&gt;
&lt;match target=&#34;font&#34;&gt;
    &lt;test name=&#34;pixelsize&#34; compare=&#34;less&#34; qual=&#34;any&#34;&gt;
        &lt;double&gt;14&lt;/double&gt;
    &lt;/test&gt;
    &lt;edit mode=&#34;assign&#34; name=&#34;antialias&#34;&gt;
        &lt;bool&gt;false&lt;/bool&gt;
    &lt;/edit&gt;
&lt;/match&gt;</pre></div></div><div class=paragraph><p>Spatiëring voor sommige enkel gespatieerde lettertypen kan ook ongepast zijn bij anti-aliasing. Dit lijkt vooral een probleem te zijn bij KDE. Een mogelijke oplossing hiervoor is het vergroten van de spatiëring van die lettertypen naar 100:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;match target=&#34;pattern&#34; name=&#34;family&#34;&gt;
   &lt;test qual=&#34;any&#34; name=&#34;family&#34;&gt;
       &lt;string&gt;fixed&lt;/string&gt;
   &lt;/test&gt;
   &lt;edit name=&#34;family&#34; mode=&#34;assign&#34;&gt;
       &lt;string&gt;mono&lt;/string&gt;
   &lt;/edit&gt;
&lt;/match&gt;
&lt;match target=&#34;pattern&#34; name=&#34;family&#34;&gt;
    &lt;test qual=&#34;any&#34; name=&#34;family&#34;&gt;
        &lt;string&gt;console&lt;/string&gt;
    &lt;/test&gt;
    &lt;edit name=&#34;family&#34; mode=&#34;assign&#34;&gt;
        &lt;string&gt;mono&lt;/string&gt;
    &lt;/edit&gt;
&lt;/match&gt;</pre></div></div><div class=paragraph><p>Het bovenstaande hernoemt de standaardnamen van lettertypen naar <code>"mono"</code>). Voeg daarna het volgende toe:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;match target=&#34;pattern&#34; name=&#34;family&#34;&gt;
    &lt;test qual=&#34;any&#34; name=&#34;family&#34;&gt;
        &lt;string&gt;mono&lt;/string&gt;
    &lt;/test&gt;
    &lt;edit name=&#34;spacing&#34; mode=&#34;assign&#34;&gt;
        &lt;int&gt;100&lt;/int&gt;
    &lt;/edit&gt;
&lt;/match&gt;</pre></div></div><div class=paragraph><p>Bepaalde lettertypen, zoals Helvetica, kunnen problemen hebben met anti-aliasing. Dit uit zich meestal in een lettertype dat verticaal door midden lijkt gesneden. Op zijn ergst kan het applicaties laten crashen. Om dit te voorkomen kan overwogen worden om ook de volgende regels toe te voegen aan <span class=filename>local.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;match target=&#34;pattern&#34; name=&#34;family&#34;&gt;
    &lt;test qual=&#34;any&#34; name=&#34;family&#34;&gt;
        &lt;string&gt;Helvetica&lt;/string&gt;
    &lt;/test&gt;
    &lt;edit name=&#34;family&#34; mode=&#34;assign&#34;&gt;
        &lt;string&gt;sans-serif&lt;/string&gt;
    &lt;/edit&gt;
&lt;/match&gt;</pre></div></div><div class=paragraph><p>Als de wijzigingen in <span class=filename>local.conf</span> zijn gemaakt dient niet vergeten te worden het bestand te eindigen met de tag <code>&lt;/fontconfig></code> tag. Als dit niet gedaan wordt, dan worden de wijzigingen niet gezien.</p></div><div class=paragraph><p>Als laatste kunnen gebruikers hun eigen instellingen aan een persoonlijk <span class=filename>.fonts.conf</span> bestand toevoegen. Om dit te doen moet iedere gebruiker het bestand <span class=filename>~/.fonts.conf</span> maken. Ook dit bestand moet in het XML formaat zijn.</p></div><div class=paragraph><p>Nog een laatste punt: bij een LCD scherm kan sub-pixel sampling prettig zijn. Eigenlijk zorgt dit er voor dat de (horizontaal gesplitste) rode, groene en blauwe componenten gewijzigd worden om de horizontale resolutie te verbeteren. Het resultaat is geweldig. Voeg hiervoor de volgende regels ergens aan <span class=filename>local.conf</span> toe:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;match target=&#34;font&#34;&gt;
    &lt;test qual=&#34;all&#34; name=&#34;rgba&#34;&gt;
        &lt;const&gt;unknown&lt;/const&gt;
    &lt;/test&gt;
    &lt;edit name=&#34;rgba&#34; mode=&#34;assign&#34;&gt;
        &lt;const&gt;rgb&lt;/const&gt;
    &lt;/edit&gt;
&lt;/match&gt;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Afhankelijk van het soort beeldscherm kan <code>rgb</code> veranderd moeten worden in <code>bgr</code>, <code>vrgb</code> of <code>vbgr</code>. Experimenteren levert de beste instelling op.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=x-xdm>6.6. De X beeldschermmanager<a class=anchor href=#x-xdm></a></h3><div class=sect3><h4 id=_overzicht>6.6.1. Overzicht<a class=anchor href=#_overzicht></a></h4><div class=paragraph><p>De X beeldschermmanager (XDM) is een optioneel onderdeel van het X Window systeem dat gebruikt wordt voor beheer van aanmeldsessies. Dit is vaak erg handig bij bijvoorbeeld "X Terminals", desktops en grote netwerk beeldschermservers. Omdat het X Window systeem netwerk- en protocolonafhankelijk is, zijn er veel mogelijkheden om X clients en servers op verschillende machines in een netwerk te verbinden. XDM levert een grafische interface waarmee er gekozen kan worden welke beeldschermserver gebruikt moet worden en handelt autorisatie informatie (gebruikersnaam en wachtwoord) af.</p></div><div class=paragraph><p>XDM levert de gebruiker dezelfde functionaliteit levert als <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a> (zie <a href=./#term-config>Instellen</a>). Dus het regelt de systeemaanmeldingen voor de schermen waaraan verbonden moet worden en start dan een sessie manager namens de gebruiker (meestal een X window manager). XDM wacht dan tot het programma stopt en geeft aan dat de gebruiker klaar is en afgemeld kan worden. Hierna kan XDM het aanmeldscherm weer tonen zodat de volgende gebruiker kan aanmelden.</p></div></div><div class=sect3><h4 id=_xdm_gebruiken>6.6.2. XDM gebruiken<a class=anchor href=#_xdm_gebruiken></a></h4><div class=paragraph><p>Om XDM te gebruiken moet de port <a class=package href=https://cgit.freebsd.org/ports/tree/x11/xdm/>x11/xdm</a> geïnstalleerd worden (het wordt in recente versies van Xorg niet standaard geïnstalleerd). Het daemon-programma XDM is daarna beschikbaar in <span class=filename>/usr/local/bin/xdm</span>. Dit programma kan als <code>root</code> altijd gestart worden en regelt dan het X weergavegedeelte van de lokale machine. Als XDM iedere keer bij het opstarten moet starten is het handig om een regel toe te voegen aan <span class=filename>/etc/ttys</span>. Meer informatie over het gebruik van dit bestand staat in <a href=./#term-etcttys>Een regel aan /etc/ttys toevoegen</a>. In de standaardversie van <span class=filename>/etc/ttys</span> staat een regel om de applicatie daemon XDM op een virtuele terminal te draaien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ttyv8   <span class=s2>&#34;/usr/local/bin/xdm -nodaemon&#34;</span>  xterm   off secure</code></pre></div></div><div class=paragraph><p>Standaard staat deze regel uit. Om hem aan te zetten moet veld 5 van <code>off</code> naar <code>on</code> gewijzigd worden en moet met <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> herstart worden met gebruikmaking van de aanwijzingen in <a href=./#term-hup>init forceren om /etc/ttys opnieuw te lezen</a>. Het eerste veld, de naam van de terminal die het programma aanstuurt, is <code>ttyv8</code>. Dit houdt in dat XDM op de negende virtuele terminal begint te draaien.</p></div></div><div class=sect3><h4 id=_xdm_instellen>6.6.3. XDM instellen<a class=anchor href=#_xdm_instellen></a></h4><div class=paragraph><p>De map met instellingen voor XDM is <span class=filename>/usr/local/lib/X11/xdm</span>. In deze map staan diverse bestanden die gebruikt kunnen worden om het gedrag en uiterlijk van XDM te veranderen. Meestal zijn dit de volgende bestanden:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Bestand</th><th class="tableblock halign-left valign-top">Omschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>Xaccess</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Regels voor client authorisatie.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>Xresources</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Standaard waarden voor X bronnen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>Xservers</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lijst met op afstand en lokaal te beheren schermen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>Xsession</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Standaard sessie script voor logins.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>Xsetup_</span>*</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Script die applicaties start voordat de login interface start.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>xdm-config</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Algehele instellingen voor alle schermen op deze machine.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>xdm-errors</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Fouten die gegenereerd zijn door het serverprogramma.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>xdm-pid</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het proces ID van de draaiende XDM.</p></td></tr></tbody></table><div class=paragraph><p>Tevens staan in deze map een aantal scripts en programma’s om het bureaublad in te stellen als XDM draait. Het doel van elk van deze bestanden wordt kort omschreven. De juiste syntaxis en het gebruik van deze bestanden staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=1&amp;format=html">xdm(1)</a>.</p></div><div class=paragraph><p>De standaardinstelling regelt een eenvoudig rechthoekig aanmeldvenster met bovenin de hostnaam van de machine in een groot lettertype met een "Login:" en "Password:" prompt eronder. Dit is een goed beginpunt om het uiterlijk en werking van het XDM venster te veranderen.</p></div><div class=sect4><h5 id=_xaccess>6.6.3.1. Xaccess<a class=anchor href=#_xaccess></a></h5><div class=paragraph><p>Om een verbinding te maken met XDM-gestuurde schermen wordt het protocol X Display Manager Connection Protocol (XDMCP) gebruikt. Het bestand is een set regels die XDMCP verbindingen met andere machines bestuurt. Het wordt genegeerd, tenzij <span class=filename>xdm-config</span> is gewijzigd zodat er wordt geluisterd naar inkomende verbindingen. Standaard wordt het clients niet toegestaan te verbinden.</p></div></div><div class=sect4><h5 id=_xresources>6.6.3.2. Xresources<a class=anchor href=#_xresources></a></h5><div class=paragraph><p>Dit is een bestand met standaarden voor de schermkiezer en de aanmeldschermen. Hier kan het uiterlijk van het aanmeldprogramma gewijzigd worden. De indeling is hetzelfde als bij het app-defaults bestand en is beschreven in de X11 documentatie.</p></div></div><div class=sect4><h5 id=_xservers>6.6.3.3. Xservers<a class=anchor href=#_xservers></a></h5><div class=paragraph><p>Dit is een lijst met netwerkschermen waaruit gekozen kan worden.</p></div></div><div class=sect4><h5 id=_xsession>6.6.3.4. Xsession<a class=anchor href=#_xsession></a></h5><div class=paragraph><p>Dit is het standaard sessiescript voor XDM dat start nadat de gebruiker is aangemeld. Normaal heeft iedere gebruiker een eigen sessiescript in <span class=filename>~/.xsession</span> dat dit script overheerst.</p></div></div><div class=sect4><h5 id=_xsetup>6.6.3.5. Xsetup_*<a class=anchor href=#_xsetup></a></h5><div class=paragraph><p>Deze starten automatisch voordat de kiezers of aanmeldschermen getoond worden. Er is een script voor ieder gebruikt scherm met de naam <span class=filename>Xsetup_</span> gevolgd door het lokale schermnummer (bijvoorbeeld <span class=filename>Xsetup_0</span>). Normaal draaien deze scripts éé of twee programma’s in de achtergrond zoals <code>xconsole</code>.</p></div></div><div class=sect4><h5 id=_xdm_config>6.6.3.6. xdm-config<a class=anchor href=#_xdm_config></a></h5><div class=paragraph><p>Dit bevat de instellingen die toegepast worden op ieder scherm die deze installatie aanstuurt. De indeling is hetzelfde als van app-defaults.</p></div></div><div class=sect4><h5 id=_xdm_errors>6.6.3.7. xdm-errors<a class=anchor href=#_xdm_errors></a></h5><div class=paragraph><p>Hierin staan de meldingen die de X servers geven als XDM ze probeert te starten. Als een scherm dat gestart is door XDM om onduidelijke reden hangt, is dit een goede plaats om te zoeken naar foutmeldingen. Deze meldingen worden ook per sessie naar het <span class=filename>~/.xsession-errors</span> van de gebruiker gestuurd.</p></div></div></div><div class=sect3><h4 id=_een_netwerk_beeldschermserver_gebruiken>6.6.4. Een netwerk beeldschermserver gebruiken<a class=anchor href=#_een_netwerk_beeldschermserver_gebruiken></a></h4><div class=paragraph><p>Om gebruikers een verbinding te laten maken met een X server moeten de toegangsregels gewijzigd worden en de connectielistener moet aangezet worden. Deze hebben standaard wat terughoudende waarden. Om XDM te laten luisteren naar verbindingen moet als eerste een regel uitgecommentarieerd worden in <span class=filename>xdm-config</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>!</span> SECURITY: <span class=k>do </span>not listen <span class=k>for </span>XDMCP or Chooser requests
<span class=o>!</span> Comment out this line <span class=k>if </span>you want to manage X terminals with XDM
DisplayManager.requestPort:     0</code></pre></div></div><div class=paragraph><p>Hierna moet XDM herstart worden. Afwijkend in dit bestand is dat commentaar in app-defaults bestanden begint met het karakter "!" en niet met het karakter "#". Het kan wenselijk zijn om de toegangscontrole aan te scherpen - hiervoor staan voorbeeldregels in <span class=filename>Xaccess</span> en lees de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=1&amp;format=html">xdm(1)</a> voor meer informatie.</p></div></div><div class=sect3><h4 id=_alternatieven_voor_xdm>6.6.5. Alternatieven voor XDM<a class=anchor href=#_alternatieven_voor_xdm></a></h4><div class=paragraph><p>Er bestaan diverse alternatieven voor het XDM programma. KDM (wordt geleverd bij KDE) wordt later in dit hoofdstuk behandeld. De beeldschermmanager KDM biedt vele grafische verbeteringen en cosmetische franje en de mogelijkheid om de gebruiker de kans te geven een window manager te laten kiezen bij het aanmelden.</p></div></div></div><div class=sect2><h3 id=x11-wm>6.7. Bureaubladomgevingen<a class=anchor href=#x11-wm></a></h3><div class=paragraph><p>Deze sectie beschrijft de verschillende bureaubladomgevingen voor X op FreeBSD. Een "bureaubladomgeving" kan van alles inhouden: van een simpele window manager tot een complete suite van bureaubladapplicaties zoals KDE of GNOME.</p></div><div class=sect3><h4 id=x11-wm-gnome>6.7.1. GNOME<a class=anchor href=#x11-wm-gnome></a></h4><div class=sect4><h5 id=x11-wm-gnome-about>6.7.1.1. Over GNOME<a class=anchor href=#x11-wm-gnome-about></a></h5><div class=paragraph><p>GNOME is een gebruikersvriendelijke bureaubladomgeving die de gebruiker de mogelijkheid geeft om gemakkelijk de computer te gebruiken en in te stellen. GNOME heeft een paneel (voor het starten en tonen van statusinformatie van applicaties), een bureaublad (waar data en applicaties geplaatst kunnen worden), een set standaard bureaubladapplicaties en een regels die het makkelijker maakt voor applicaties om eenduidig met elkaar samen te werken. Gebruikers van andere besturingssystemen of omgevingen voelen zich meestal meteen thuis bij het gebruik van de krachtige grafisch gestuurde omgeving die GNOME biedt. Meer informatie over GNOME op FreeBSD staat op de <a href=http://www.FreeBSD.org/gnome>FreeBSD GNOME Project</a> website. De website bevat ook redelijk complete FAQ’s over het installeren, instellen en beheren van GNOME.</p></div></div><div class=sect4><h5 id=x11-wm-gnome-install>6.7.1.2. GNOME installeren<a class=anchor href=#x11-wm-gnome-install></a></h5><div class=paragraph><p>De software kan eenvoudig worden geïnstalleerd vanuit een pakket of de Portscollectie:</p></div><div class=paragraph><p>Om het GNOME pakket te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gnome2</span></code></pre></div></div><div class=paragraph><p>Om GNOME vanuit de Portscollectie te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11/gnome2</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Voor een correcte werking, vereist GNOME dat het <span class=filename>/proc</span> bestandssysteem gekoppeld is. Voeg</p></div><div class="literalblock programlisting"><div class=content><pre>proc           /proc       procfs  rw  0   0</pre></div></div><div class=paragraph><p>toe aan <span class=filename>/etc/fstab</span> om <a href="https://man.freebsd.org/cgi/man.cgi?query=procfs&amp;sektion=5&amp;format=html">procfs(5)</a> automatisch te koppelen tijdens het opstarten.</p></div><div class=paragraph><p>Zodra GNOME geïnstalleerd is, moet de X server verteld worden dat in plaats van de standaard window manager GNOME gebruikt moet worden.</p></div><div class=paragraph><p>De meest eenvoudige manier om GNOME te starten is via GDM, de GNOME Display Manager. GDM wordt meegeïnstalleerd met de GNOME bureaubladomgeving, maar staat standaard uitgeschakeld. Dit programma kan ingeschakeld worden door het volgende toe te voegen aan <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>gdm_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Na een herstart zal GDM automatisch gestart worden.</p></div><div class=paragraph><p>Meestal is het gewenst om alle GNOME applicaties tegelijkertijd met GDM te starten. Om dit te bereiken moet de volgende regel worden toegevoegd aan <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>gnome_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>GNOME kan ook gestart worden vanaf de commandoregel door het bestand <span class=filename>.xinitrc</span> juist in te stellen. Als er al een <span class=filename>.xinitrc</span> is, dan hoeft alleen de regel die de huidige window manager start veranderd te worden in een regel die /usr/local/bin/gnome-session start. Als er niets speciaals met dit instellingenbestand is gedaan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>echo</span> <span class=s2>&#34;/usr/local/bin/gnome-session&#34;</span> <span class=o>&gt;</span> ~/.xinitrc</code></pre></div></div><div class=paragraph><p>Nu kan met <code>startx</code> de GNOME bureaubladomgeving gestart worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als een beeldschermmanager als XDM gebruikt wordt werkt het bovenstaande niet. In plaats daarvan moet een uitvoerbaar <span class=filename>.xsession</span> gemaakt worden met hetzelfde commando erin. Hiervoor moet het bestand aangepast worden door het bestaande window manager commando te vervangen door /usr/local/bin/gnome-session:</p></div></td></tr></tbody></table></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>echo</span> <span class=s2>&#34;#!/bin/sh&#34;</span> <span class=o>&gt;</span> ~/.xsession
% <span class=nb>echo</span> <span class=s2>&#34;/usr/local/bin/gnome-session&#34;</span> <span class=o>&gt;&gt;</span> ~/.xsession
% <span class=nb>chmod</span> +x ~/.xsession</code></pre></div></div><div class=paragraph><p>Het is ook mogelijk de beeldschermmanager zo in te stellen dat de window manager gekozen kan worden tijdens het aanmelden. In de paragraaf <a href=#x11-wm-kde-details>Meer KDE Details</a> wordt uitgelegd hoe dit gedaan moet worden voor de KDM beeldschermmanager van KDE.</p></div></div></div><div class=sect3><h4 id=x11-wm-kde>6.7.2. KDE<a class=anchor href=#x11-wm-kde></a></h4><div class=sect4><h5 id=x11-wm-kde-about>6.7.2.1. Over KDE<a class=anchor href=#x11-wm-kde-about></a></h5><div class=paragraph><p>KDE is een bureaubladomgeving die eigentijds is en makkelijk in gebruik. KDE biedt de gebruiker:</p></div><div class=ulist><ul><li><p>Een schitterende eigentijdse desktop;</p></li><li><p>Een desktop die volledig netwerktransparant is;</p></li><li><p>Een geïntegreerd hulpsysteem dat eenvoudig bruikbare informatie geeft over het gebruik van het KDE bureaublad en de applicaties;</p></li><li><p>Alle KDE applicaties werken op dezelfde manier en zien er hetzelfde uit;</p></li><li><p>Gestandaardiseerde menu’s en werkbalken, keybindings, kleurschema’s, enzovoort;</p></li><li><p>Internationalisatie: KDE is beschikbaar in meer dan 55 talen;</p></li><li><p>Gecentraliseerde, consistente, dialooggedreven bureaubladinstelling;</p></li><li><p>Een grote hoeveelheid bruikbare KDE applicaties;</p></li></ul></div><div class=paragraph><p>KDE wordt geleverd met een webbrowser genaamd Konqueror die niet onder doet voor de andere bestaande webbrowsers op UNIX® systemen. Meer informatie over KDE staat op de <a href=http://www.kde.org/>KDE website</a>. Voor FreeBSD specifieke informatie en bronnen over KDE is er de website <a href=http://freebsd.kde.org/>KDE/FreeBSD initiatief</a>.</p></div><div class=paragraph><p>Er zijn twee versies van KDE beschikbaar op FreeBSD. Versie 3 is sinds lange tijd aanwezig en is nog steeds beschikbaar in de Portscollectie alhoewel het nu onbeheerd en gedeeltelijk kapot is. Versie 4 wordt punctueel bijgewerkt en is de standaardkeuze voor gebruikers van KDE. Ze kunnen zelfs naast elkaar worden geïnstalleerd.</p></div></div><div class=sect4><h5 id=x11-wm-kde-install>6.7.2.2. KDE installeren<a class=anchor href=#x11-wm-kde-install></a></h5><div class=paragraph><p>Net als bij GNOME of iedere andere bureaubladomgeving kan de software eenvoudig geïnstalleerd met een pakket of uit de Portscollectie:</p></div><div class=paragraph><p>Om het KDE 3 pakket van het netwerk te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r kde</span></code></pre></div></div><div class=paragraph><p>Om het KDE 4 pakket van het netwerk te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r kde4</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> haalt automatisch de laatste versie van de applicatie op.</p></div><div class=paragraph><p>Om KDE 3 vanuit de Portscollectie te bouwen en te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11/kde3</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Gebruik de Portscollectie om KDE 4 vanuit de broncode te bouwen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11/kde4</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Nadat KDE geïnstalleerd is, moet de X server verteld worden dat déze applicatie gestart moet worden in plaats van de standaard window manager. Hiervoor kan <span class=filename>.xinitrc</span> aangepast worden:</p></div><div class=paragraph><p>Voor KDE 3:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>echo</span> <span class=s2>&#34;exec startkde&#34;</span> <span class=o>&gt;</span> ~/.xinitrc</code></pre></div></div><div class=paragraph><p>Voor KDE 4:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>echo</span> <span class=s2>&#34;exec /usr/local/kde4/bin/startkde&#34;</span> <span class=o>&gt;</span> ~/.xinitrc</code></pre></div></div><div class=paragraph><p>Als het X Window System wordt gestart met <code>startx</code> is KDE het bureaublad.</p></div><div class=paragraph><p>Als er een beeldschermmanager als XDM gebruikt wordt, is de instelling anders. Dan moet <span class=filename>.xsession</span> gewijzigd worden. Instructies voor KDM worden later in dit hoofdstuk beschreven.</p></div></div></div><div class=sect3><h4 id=x11-wm-kde-details>6.7.3. Meer KDE details<a class=anchor href=#x11-wm-kde-details></a></h4><div class=paragraph><p>Nadat KDE geïnstalleerd is op een systeem, kunnen de meeste dingen uitgezocht worden via de hulppagina’s of door de verschillende menu’s aan te wijzen en erop te klikken. Windows® en Mac® gebruikers voelen zich meestal helemaal thuis.</p></div><div class=paragraph><p>Het beste naslagwerk voor KDE is de on-line documentatie. KDE heeft zijn eigen web browser, Konqueror, tientallen handige applicaties en uitgebreide documentatie. De volgende paragrafen beschrijven de technische zaken die moeilijk proefondervindelijk te achterhalen zijn.</p></div><div class=sect4><h5 id=x11-wm-kde-kdm>6.7.3.1. De KDE beeldschermmanager<a class=anchor href=#x11-wm-kde-kdm></a></h5><div class=paragraph><p>Een beheerder van een multi-user systeem die een grafisch aanmeldscherm willen hebben voor zijn gebruikers kan hiervoor <a href=#x-xdm>XDM</a> gebruiken, zoals eerder beschreven. KDE biedt KDM als alternatief. Dat is ontworpen met een beter uiterlijk en heeft meer aanmeldopties. Gebruikers kunnen via een menu kiezen welke bureaubladomgeving (KDE, GNOME of een andere) zij na het aanmelden willen gebruiken.</p></div><div class=paragraph><p>Om KDM te starten, moeten verschillende bestanden gewijzigd worden, afhankelijk van de versie van KDE.</p></div><div class=paragraph><p>Voor KDE 3 dient de regel met <code>ttyv8</code> als volgt aangepast te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyv8 &#34;/usr/local/bin/kdm -nodaemon&#34; xterm on secure</pre></div></div><div class=paragraph><p>Voor KDE 4 dient <a href="https://man.freebsd.org/cgi/man.cgi?query=procfs&amp;sektion=5&amp;format=html">procfs(5)</a> te worden aangekoppeld en de volgende regel aan <span class=filename>/etc/rc.conf</span> te worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>kdm4_enable=&#34;YES&#34;</pre></div></div></div></div><div class=sect3><h4 id=x11-wm-xfce>6.7.4. Xfce<a class=anchor href=#x11-wm-xfce></a></h4><div class=sect4><h5 id=x11-wm-xfce-about>6.7.4.1. Over Xfce<a class=anchor href=#x11-wm-xfce-about></a></h5><div class=paragraph><p>Xfce is een bureaubladomgeving die gebaseerd is op de GTK+ toolkit die gebruikt wordt bij GNOME, maar is eenvoudiger en bedoeld voor gebruikers die een simpel en efficiënt bureaublad willen dat toch eenvoudig en makkelijk in te stellen is. Het ziet er bijna hetzelfde uit als CDE dat bij commerciële UNIX® systemen zit. Een aantal Xfce functies zijn:</p></div><div class=ulist><ul><li><p>Een eenvoudige, makkelijk te bedienen desktop;</p></li><li><p>Geheel in te stellen met de muis, met klikken en slepen, enzovoort;</p></li><li><p>Hoofdpaneel hetzelfde als CDE met menu’s, applets en applicaties</p></li><li><p>Geïntegreerde window manager, bestandsmanager, geluidsmanager, GNOME compliance module en meer zaken;</p></li><li><p>Thema’s (sinds het gebruik van GTK+);</p></li><li><p>Snel, licht en efficiënt: ideaal voor de oudere of langzamere machines of machines met beperkte hoeveelheid geheugen;</p></li></ul></div><div class=paragraph><p>Meer informatie over Xfce staat op de <a href=http://www.xfce.org/>Xfce website</a>.</p></div></div><div class=sect4><h5 id=x11-wm-xfce-install>6.7.4.2. Installeren van Xfce<a class=anchor href=#x11-wm-xfce-install></a></h5><div class=paragraph><p>Xfce is met een pakket te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r xfce4</span></code></pre></div></div><div class=paragraph><p>Of vanuit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11-wm/xfce4</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Nu moet de X server weten dat Xfce gestart moet worden als X de volgende keer start:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>echo</span> <span class=s2>&#34;/usr/local/bin/startxfce4&#34;</span> <span class=o>&gt;</span> ~/.xinitrc</code></pre></div></div><div class=paragraph><p>De volgende keer dat X start is Xfce het bureaublad. Wederom: als een beeldschermmanager als XDM gebruikt wordt, moet <span class=filename>.xsession</span> gemaakt worden zoals beschreven in de paragraaf over <a href=#x11-wm-gnome>GNOME</a>. Nu moet echter het command <span class=filename>/usr/local/bin/startxfce4</span> gebruikt. Het is ook mogelijk de beeldschermmanager in te stellen om bureaublad te kiezen bij het aanmelden, zoals is uitgelegd in de paragraaf over <a href=#x11-wm-kde-kdm>kdm</a>.</p></div></div></div></div></div></div><h1 id=common-tasks class=sect0>Deel II: Algemene taken<a class=anchor href=#common-tasks></a></h1><div class="openblock partintro"><div class=content><div class=paragraph><p>Na de inleiding gaat dit deel van het FreeBSD handboek over een aantal vaak gebruikte mogelijkheden van FreeBSD. De volgende hoofdstukken:</p></div><div class=ulist><ul><li><p>Geven een inleiding in populaire en handige desktop toepassingen: browsers, productieviteitsgereedschappen, documentviewers, etc;</p></li><li><p>Geven een inleiding in een aantal multimediatoepassingen die in FreeBSD beschikbaar zijn;</p></li><li><p>Geven uitleg over het proces waarmee een aangepaste kernel voor FreeBSD kan worden gemaakt om extra functionaliteit aan een systeen toe te voegen;</p></li><li><p>Beschrijven gedetailleerd het afdruksysteem, zowel voor met een desktop verbonden als met het netwerk verbinden printers;</p></li><li><p>Beschrijven hoe applicaties voor Linux® op FreeBSD kunnen draaien.</p></li></ul></div><div class=paragraph><p>In een aantal van de hoofdstukken wordt voorkennis aangeraden. Dit staat vermeld in de inleiding van ieder hoofdstuk.</p></div></div></div><div class=sect1><h2 id=desktop>Hoofdstuk 7. Bureaubladapplicaties<a class=anchor href=#desktop></a></h2><div class=sectionbody><div class=sect2><h3 id=desktop-synopsis>7.1. Overzicht<a class=anchor href=#desktop-synopsis></a></h3><div class=paragraph><p>FreeBSD kan een groot aantal bureaubladapplicaties draaien, zoals browsers en tekstverwerkers. De meeste hiervan zijn beschikbaar als pakketten of kunnen automatisch vanuit de Portscollectie gebouwd worden. Veel nieuwe gebruikers verwachten dit soort applicaties op hun bureaublad. Dit hoofdstuk laat zien hoe populaire bureaubladapplicaties moeiteloos geïnstalleerd kunnen worden vanuit een pakket of vanuit de Portscollectie.</p></div><div class=paragraph><p>Als programma’s vanuit ports geïnstalleerd worden, wordt hun broncode gecompileerd. Dit kan erg lang duren, afhankelijk van wat er gecompileerd wordt en de rekenkracht van een machine. Als compileren vanuit broncode te veel tijd kost, kunnen de meeste programma’s van de Portscollectie als een voorgebouwd pakket geïnstalleerd worden.</p></div><div class=paragraph><p>Omdat FreeBSD compatibel is met Linux®, zijn veel applicaties die voor Linux® zijn ontwikkeld beschikbaar een FreeBSD bureaublad. Het wordt sterk aanbevolen om <a href=./#linuxemu>Linux® binaire compatibiliteit</a> te lezen voordat Linux® applicaties geïnstalleerd worden. Veel ports die gebruik maken van Linux® compatibiliteit beginnen met "linux-". Dit is handig om te onthouden wanneer er naar een port gezocht wordt met bijvoorbeeld <a href="https://man.freebsd.org/cgi/man.cgi?query=whereis&amp;sektion=1&amp;format=html">whereis(1)</a>. In dit hoofdstuk wordt aangenomen dat Linux® binaire compatibiliteit is ingeschakeld voordat Linux® applicaties worden geïnstalleerd.</p></div><div class=paragraph><p>In dit hoofdstuk worden de volgende categoriën behandeld:</p></div><div class=ulist><ul><li><p>Browsers (zoals Firefox, Opera, Konqueror, Chromium)</p></li><li><p>Productiviteit (zoals KOffice, AbiWord, The GIMP, Apache OpenOffice, LibreOffice)</p></li><li><p>Documentviewers (zoals Acrobat Reader®, gv, Xpdf, GQview)</p></li><li><p>Financieel (zoals GnuCash, Gnumeric, Abacus)</p></li></ul></div><div class=paragraph><p>Er wordt aangenomen dat de lezer van dit hoofdstuk:</p></div><div class=ulist><ul><li><p>Weet hoe aanvullende software van derde partijen geïnstalleerd wordt (<a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></li><li><p>Weet hoe aanvullende Linux® software geïnstalleerd wordt (<a href=./#linuxemu>Linux® binaire compatibiliteit</a>).</p></li></ul></div><div class=paragraph><p>Meer informatie over een multimedia-omgeving staat in <a href=./#multimedia>Multimedia</a>. Installatie van email staat beschreven in <a href=./#mail>Elektronische mail</a>.</p></div></div><div class=sect2><h3 id=desktop-browsers>7.2. Browsers<a class=anchor href=#desktop-browsers></a></h3><div class=paragraph><p>FreeBSD wordt zonder een voorgeïnstalleerde browser geleverd. In plaats hiervan bevat de <a href=https://www.FreeBSD.org/ports/>www</a> map van de Portscollectie browsers om te installeren. Het is ook mogelijk voor de meeste ports een pakket te installeren als compileren niet gewenst is. Compileren kan soms lang duren.</p></div><div class=paragraph><p>KDE en GNOME bevatten reeds HTML-browsers. In <a href=./#x11-wm>Bureaubladomgevingen</a> staat meer informatie over de installatie van deze complete bureaubladen.</p></div><div class=paragraph><p>Lichtgewicht browsers uit de Portscollectie zijn onder andere <a class=package href=https://cgit.freebsd.org/ports/tree/www/dillo2/>www/dillo2</a>, <a class=package href=https://cgit.freebsd.org/ports/tree/www/links/>www/links</a> of <a class=package href=https://cgit.freebsd.org/ports/tree/www/w3m/>www/w3m</a>.</p></div><div class=paragraph><p>Dit gedeelte behandelt deze applicaties:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Applicatie</th><th class="tableblock halign-left valign-top">Bronnen</th><th class="tableblock halign-left valign-top">Ports</th><th class="tableblock halign-left valign-top">Grote afhankelijkheden</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Firefox</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>gemiddeld</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>zwaar</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gtk+</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Opera</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>licht</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD en Linux® versies beschikbaar. De Linux® versie is afhankelijk van de Linux® binaire compatibiliteit en linux-openmotif.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Konqueror</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>gemiddeld</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>zwaar</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>KDE bibliotheken</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Chromium</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>gemiddeld</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>gemiddeld</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gtk+</p></td></tr></tbody></table><div class=sect3><h4 id=_firefox>7.2.1. Firefox<a class=anchor href=#_firefox></a></h4><div class=paragraph><p>Firefox is een moderne, gratis, stabiele open-source browser die volledig geporteerd is naar FreeBSD: het heeft een motor voor HTML-weergave die zich zeer strikt aan de standaarden houdt, browsen met tabbladen, blokkeren van pop-ups, uitbreidingen, verbeterde veiligheid, en meer. Firefox is gebaseerd op de codebase van Mozilla.</p></div><div class=paragraph><p>Installeer het pakket door het volgende te typen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r firefox</span></code></pre></div></div><div class=paragraph><p>Dit zal de laatste uitgave van Firefox installeren, als u in plaats hiervan de Extended Support Release (ESR) van Firefox wilt draaien, gebruik dan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r firefox-esr</span></code></pre></div></div><div class=paragraph><p>De Portscollectie kan ook gebruikt worden als u liever vanuit de broncode installeert.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/firefox</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Voor Firefox ESR dient <code>firefox</code> in het vorige commando vervangen te worden door <code>firefox-esr</code>.</p></div></div><div class=sect3><h4 id=moz-java-plugin>7.2.2. Firefox en Java™ plugin<a class=anchor href=#moz-java-plugin></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In deze en de volgende twee secties wordt er vanuit gegaan dat Firefox reeds geïnstalleerd is.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Installeer OpenJDK 6 vanuit de Ports Collectie door het volgende typen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/java/openjdk6</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Installeer daarna de port <a class=package href=https://cgit.freebsd.org/ports/tree/java/icedtea-web/>java/icedtea-web</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/java/icedtea-web</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Zorg ervoor dat de standaard configuratieopties voor beide ports zijn geselecteerd.</p></div><div class=paragraph><p>Start de browser en voer <code>about:plugins</code> in de locatie balk en druk op <kbd>Enter</kbd>. Er zal een pagina gepresenteerd worden die de geïnstalleerde plugins toont; de Java™ plugin zal nu getoond moeten worden.</p></div><div class=paragraph><p>Als de browser de plugin niet kan vinden, dient elke gebruiker het volgende commando uit te voeren en de browser opnieuw te starten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>ln</span> <span class=nt>-s</span> /usr/local/lib/IcedTeaPlugin.so <span class=se>\</span>
  <span class=nv>$HOME</span>/.mozilla/plugins/</code></pre></div></div></div><div class=sect3><h4 id=moz-flash-plugin>7.2.3. Firefox en Adobe® Flash™ plugin<a class=anchor href=#moz-flash-plugin></a></h4><div class=paragraph><p>De Adobe® Flash™ plugin is niet beschikbaar voor FreeBSD. Er is echter wel een softwarelaag (wrapper) om de Linux®-versie van de plugin te draaien. Deze wrapper ondersteunt ook Adobe® Acrobat® plugin, RealPlayer® plugin en meer.</p></div><div class=paragraph><p>Afhankelijk van de versie van FreeBSD die u draait zijn er verschillende stappen nodig:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Op FreeBSD 7.X</p><div class=paragraph><p>Installeer de port <a class=package href=https://cgit.freebsd.org/ports/tree/www/nspluginwrapper/>www/nspluginwrapper</a>. Deze port heeft <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base-fc4/>emulators/linux_base-fc4</a> nodig, wat een grote port is.</p></div><div class=paragraph><p>De volgende stap is om de port <a class=package href=https://cgit.freebsd.org/ports/tree/www/linux-flashplugin9/>www/linux-flashplugin9</a> te installeren. Dit zal Flash™ 9.X installeren, van deze versie is bekend dat die correct werkt op FreeBSD 7.X.</p></div></li><li><p>Op FreeBSD 8.X of nieuwer</p><div class=paragraph><p>Installeer de port <a class=package href=https://cgit.freebsd.org/ports/tree/www/nspluginwrapper/>www/nspluginwrapper</a>. Deze port heeft <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base-f10/>emulators/linux_base-f10</a> nodig, wat een grote port is.</p></div><div class=paragraph><p>De volgende stap is om de Flash™ 11.X vanuit de port <a class=package href=https://cgit.freebsd.org/ports/tree/www/linux-f10-flashplugin11/>www/linux-f10-flashplugin11</a> te installeren.</p></div><div class=paragraph><p>Voor deze versie is het nodig om de volgende koppeling aan te maken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s /usr/local/lib/npapi/linux-f10-flashplugin/libflashplayer.so \</span>
  /usr/local/lib/browser_plugins/</code></pre></div></div><div class=paragraph><p>De <span class=filename>/usr/local/lib/browser_plugins</span> directory moet handmatig aangemaakt worden als deze nog niet op het systeem bestaat.</p></div></li></ol></div></div></div><div class=paragraph><p>Wanneer de juiste Flash™ port, afhankelijk van de versie van FreeBSD die u draait, is geïnstalleerd, moet de plugin door elke gebruiker worden geïnstalleerd met <code>nspluginwrapper</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% nspluginwrapper <span class=nt>-v</span> <span class=nt>-a</span> <span class=nt>-i</span></code></pre></div></div><div class=paragraph><p>Start dan de browser en voer op de adresbalk <code>about:plugins</code> in en druk op <kbd>Enter</kbd>. Een pagina met alle geïnstalleerde plugins wordt nu getoond.</p></div></div><div class=sect3><h4 id=moz-swfdec-flash-plugin>7.2.4. Firefox en Swfdec Flash™ plugin<a class=anchor href=#moz-swfdec-flash-plugin></a></h4><div class=paragraph><p>Swfdec is de bibliotheek om Flash™-animaties te decoderen en af te beelden. Swfdec-Mozilla is een plugin voor Firefox-browsers dat de Swfdec-bibliotheek gebruikt om SWF-bestanden af te spelen. Er wordt nog steeds veel aan ontwikkeld.</p></div><div class=paragraph><p>Als u het niet kunt of wilt compileren, kan het pakket vanaf het netwerk worden geïnstalleerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r swfdec-plugin</span></code></pre></div></div><div class=paragraph><p>Als het pakket niet beschikbaar is, kunt u het vanuit de Portscollectie compileren en installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/swfdec-plugin</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Herstart hierna uw browser om deze plugin effectief te maken.</p></div></div><div class=sect3><h4 id=_opera>7.2.5. Opera<a class=anchor href=#_opera></a></h4><div class=paragraph><p>Opera is een volledige en een standaard volgende browser. Hij wordt standaard geleverd met een ingebouwde email-client, een nieuwslezer, een IRC client, een RSS/ATOM feed lezer en nog veel meer. Ondanks dat is Opera relatief gezien niet zwaar en erg snel. Hij komt in twee smaken: een FreeBSD versie en een versie die draait onder Linux® emulatie.</p></div><div class=paragraph><p>De FreeBSD pakketversie van Opera wordt zo geïnstalleerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r opera</span></code></pre></div></div><div class=paragraph><p>Sommige FTP-sites hebben niet alle pakketten, maar Operakan worden nog altijd via de Portscollectie worden verkregen door te typen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/opera</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>De Linux® versie van Opera kan geïnstalleerd worden door bij de bovenstaande voorbeelden <code>linux-opera</code> te gebruiken in plaats van <code>opera</code>.</p></div><div class=paragraph><p>De Adobe® Flash™ plugin is niet beschikbaar voor FreeBSD. Er bestaat echter een Linux® versie van de plugin. Om deze versie te installeren moet de port <a class=package href=https://cgit.freebsd.org/ports/tree/www/linux-f10-flashplugin11/>www/linux-f10-flashplugin11</a> geïnstalleerd zijn, installeer daarna de port <a class=package href=https://cgit.freebsd.org/ports/tree/www/opera-linuxplugins/>www/opera-linuxplugins</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/linux-f10-flashplugin11</span>
<span class=c># make install clean</span>
<span class=c># cd /usr/ports/www/opera-linuxplugins</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>U kunt controleren of de plugin aanwezig is: start uw browser, geef <code>opera:plugins</code> in op de adresbalk en druk op <kbd>Enter</kbd>. Er zou een lijst moeten verschijnen met alle huidig beschikbare plugins.</p></div><div class=paragraph><p>Volg de <a href=#moz-java-plugin>instructies voor Firefox</a> om de Java™ plugin te installeren.</p></div></div><div class=sect3><h4 id=_konqueror>7.2.6. Konqueror<a class=anchor href=#_konqueror></a></h4><div class=paragraph><p>Konqueror is deel van KDE, maar kan ook buiten KDE gebruikt worden door <a class=package href=https://cgit.freebsd.org/ports/tree/x11/kdebase3/>x11/kdebase3</a> te installeren. Konqueror is meer dan een browser, het is ook een bestandsbeheerder en multimedia-viewer.</p></div><div class=paragraph><p>Er is ook een verzameling plugins beschikbaar voor Konqueror, beschikbaar in <a class=package href=https://cgit.freebsd.org/ports/tree/misc/konq-plugins/>misc/konq-plugins</a>.</p></div><div class=paragraph><p>Konqueror ondersteunt WebKit naast het eigen KHTML. WebKit wordt gebruikt door vele moderne browsers waaronder Chromium. Om WebKit met Konqueror op FreeBSD te gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/kwebkitpart</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Klik vervolgens in Konqueror op "Settings", "Configure Konqueror", en "Change KHTML to WebKit".</p></div><div class=paragraph><p>Konqueror ondersteunt ook Flash™; een "How To" gids om ondersteuning voor Flash™ in Konqueror te krijgen is beschikbaar op <a href=http://freebsd.kde.org/howtos/konqueror-flash.php>http://freebsd.kde.org/howtos/konqueror-flash.php</a>.</p></div></div><div class=sect3><h4 id=_chromium>7.2.7. Chromium<a class=anchor href=#_chromium></a></h4><div class=paragraph><p>Chromium is een open-source browserproject dat er op gericht is om een veiligere, snellere en stabielere surfervaring op te bouwen. Chromium biedt surfen met tabbladen, het blokkeren van pop-ups, uitbreidingen en nog veel meer. Chromium is het open-source project waar de browser Google Chrome op is gebaseerd.</p></div><div class=paragraph><p>Chromium kan als volgt als een pakket worden geïnstalleerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r chromium</span></code></pre></div></div><div class=paragraph><p>Als alternatief kan Chromium worden gecompileerd vanuit de broncode door de Portscollectie te gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/chromium</span>
<span class=c># make install clean</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Chromium wordt geïnstalleerd als <span class=filename>/usr/local/bin/chrome</span>, niet als <span class=filename>/usr/local/bin/chromium</span>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=chromium-java-plugin>7.2.8. Chromium en Java™ plugin<a class=anchor href=#chromium-java-plugin></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Deze sectie neemt aan dat Chromium al is geïnstalleerd.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Installeer OpenJDK 6 vanuit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/java/openjdk6</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Installeer vervolgens <a class=package href=https://cgit.freebsd.org/ports/tree/java/icedtea-web/>java/icedtea-web</a> vanuit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/java/icedtea-web</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Start Chromium en geef <code>about:plugins</code> op in de adresbalk. IcedTea-Web zou genoemd moeten worden als één van de geïnstalleerde plugins.</p></div><div class=paragraph><p>Als Chromium de plugin IcedTea-Web niet vermeldt, voer dan de volgende commando’s uit en herstart de browser:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir -p /usr/local/shared/chromium/plugins</span>
<span class=c># ln -s /usr/local/lib/IcedTeaPlugin.so \</span>
  /usr/local/shared/chromium/plugins/</code></pre></div></div></div><div class=sect3><h4 id=chromium-flash-plugin>7.2.9. Chromium en Adobe® Flash™ plugin<a class=anchor href=#chromium-flash-plugin></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Deze sectie neemt aan dat Chromium al is geïnstalleerd.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het configureren van Chromium en Adobe® Flash™ lijkt op de <a href=#moz-flash-plugin>instructies voor Firefox</a>. Raadpleeg die sectie voor gedetailleerdere instructies en het installeren van Adobe® Flash™ op FreeBSD. Er zou geen verdere configuratie nodig moeten zijn, aangezien Chromium sommige plugins van andere browsers kan gebruiken.</p></div></div></div><div class=sect2><h3 id=desktop-productivity>7.3. Productiviteit<a class=anchor href=#desktop-productivity></a></h3><div class=paragraph><p>Als het op productiviteit aankomt, zoeken nieuwe gebruikers vaak een goed kantoorpakket of een vriendelijke tekstverwerker. Hoewel sommige <a href=./#x11-wm>bureaubladomgevingen</a> zoals KDE reeds een kantoorpakket verschaffen, is er geen standaard produktiviteitspakket. FreeBSD kan alles verschaffen wat nodig is, ongeacht de bureaubladomgeving.</p></div><div class=paragraph><p>In dit gedeelte worden de onderstaande applicaties beschreven:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Applicatie</th><th class="tableblock halign-left valign-top">Bronnen</th><th class="tableblock halign-left valign-top">Ports</th><th class="tableblock halign-left valign-top">Afhankelijkheden</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KOffice</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>zwaar</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>KDE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>AbiWord</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>licht</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gtk+ of GNOME</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>The GIMP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>licht</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gtk+</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Apache OpenOffice</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>veel</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>erg zwaar</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>JDK™, Mozilla</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>LibreOffice</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>enigszins veel</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>zwaar</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gtk+, of KDE / GNOME, of JDK™</p></td></tr></tbody></table><div class=sect3><h4 id=_koffice>7.3.1. KOffice<a class=anchor href=#_koffice></a></h4><div class=paragraph><p>De KDE-gemeenschap heeft zijn bureaubladomgeving met een kantoorpakket geleverd dat buiten KDE gebruikt kan worden. Het bevat de vier standaardcomponenten uit andere kantoorpakketten. KWord is de tekstverwerker, KSpread is het spreadsheetprogramma, KPresenter beheert diapresentaties en Kontour voorziet in grafische mogelijkheden.</p></div><div class=paragraph><p>Voordat de nieuwste KOffice wordt geïnstalleert, moet er een recente versie van KDE geïnstalleerd zijn.</p></div><div class=paragraph><p>KOffice voor KDE als pakket installeren gaat met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r koffice-kde4</span></code></pre></div></div><div class=paragraph><p>Als het pakket niet beschikbaar is, kan de Portscollectie gebruiken worden. Om KOffice voor KDE4 te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/editors/koffice-kde4</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_abiword>7.3.2. AbiWord<a class=anchor href=#_abiword></a></h4><div class=paragraph><p>AbiWord is een vrij tekstverwerkingsprogramma, ongeveer gelijk aandoet als Microsoft® Word. Het is geschikt om verslagen, brieven, rapporten, memo’s, enzovoort mee te typen. Het programma is snel, bevat veel mogelijkheden en is gebruikersvriendelijk.</p></div><div class=paragraph><p>AbiWord kan veel bestandsformaten importeren en exporteren, waaronder enkele gesloten formaten, zoals Microsoft®'s <span class=filename>.doc</span>.</p></div><div class=paragraph><p>AbiWord is beschikbaar als pakket en te installeren met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r abiword</span></code></pre></div></div><div class=paragraph><p>Als het pakket niet beschikbaar is, kan het worden gecompileerd vanuit de Portscollectie. De Portscollectie is meer recent. Dat kan als volgt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/editors/abiword</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_the_gimp>7.3.3. The GIMP<a class=anchor href=#_the_gimp></a></h4><div class=paragraph><p>Voor het bewerken of retoucheren van afbeeldingen is The GIMP een zeer geavanceerd afbeeldingenmanipulatieprogramma. Het kan als eenvoudig tekenprogramma worden gebruikt of als kwalititeitspakket voor het retoucheren van foto’s. Het ondersteunt een groot aantal plugins en bevat een scripting interface. The GIMP kan een groot aantal bestandsformaten lezen en schrijven. Het ondersteunt interfaces met scanners en tabletten.</p></div><div class=paragraph><p>Het pakket is te installeren met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gimp</span></code></pre></div></div><div class=paragraph><p>Als een FTP-site dit pakket niet heeft, kan de Portscollectie gebruikt worden. De <a href=https://www.FreeBSD.org/ports/>graphics</a> map van de Portscollectie bevat ook The GIMP Manual. Die kan zo geïnstalleerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/graphics/gimp</span>
<span class=c># make install clean</span>
<span class=c># cd /usr/ports/graphics/gimp-manual-pdf</span>
<span class=c># make install clean</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De <a href=https://www.FreeBSD.org/ports/graphics.html>graphics</a> map van de Portscollectie bevat de ontwikkelversie van The GIMP in <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/gimp-devel/>graphics/gimp-devel</a>. Een HTML-versie van The GIMP Manual staan in <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/gimp-manual-html/>graphics/gimp-manual-html</a>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_apache_openoffice>7.3.4. Apache OpenOffice<a class=anchor href=#_apache_openoffice></a></h4><div class=paragraph><p>Op 1 juni 2011 doneerde Oracle Corporation de codebasis van OpenOffice.org aan de Apache Software Foundation. OpenOffice.org staat nu bekend als Apache OpenOffice en wordt ontwikkeld onder de vleugels van de Incubator van de Apache Software Foundation.</p></div><div class=paragraph><p>Apache OpenOffice bevat alle noodzakelijke applicaties in een compleet kantoorproductiviteitspakket: een tekstverwerker, een spreadsheet, een presentatiebeheerder en een tekenprogramma. De gebruikersinterface is vrijwel gelijk aan die van andere kantoorpakketten en het kan veel populaire bestandsformaten in- en uitvoeren. Het is beschikbaar in een aantal verschillende talen - internationalisatie is uitgebreid tot interfaces, spellingcontrole, en woordenboeken.</p></div><div class=paragraph><p>De tekstverwerker van Apache OpenOffice gebruikt een eigen XML-bestandsformaat voor overdraagbaarheid en flexibiliteit. Het spreadsheetprogramma bevat een macrotaal en kan gekoppeld worden aan externe databases. Apache OpenOffice is stabiel en draait zonder aanpassingen op Windows®, Solaris™, Linux, FreeBSD en Mac OS® X. Meer informatie over Apache OpenOffice staat op de <a href=http://incubator.apache.org/openofficeorg/>Apache OpenOffice website</a>. Voor specifieke FreeBSD informatie en om direct pakketten te downloaden is er de website van het <a href=http://porting.openoffice.org/freebsd/>FreeBSD Apache OpenOffice Porting Team</a>.</p></div><div class=paragraph><p>Om Apache OpenOffice te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r apache-openoffice</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Dit hoort te werken als er een -RELEASE versie van FreeBSD wordt gedraaid. In andere gevallen is het verstandig om te kijken op de website van het FreeBSD Apache OpenOffice Porting Team en het juiste pakket met <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> te downloaden en te installeren. Zowel de huidige release als de ontwikkelversie kunnen op die locatie gedownload worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als het pakket geïnstalleerd is, start dan met het volgende commando Apache OpenOffice:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% openoffice-X.Y.Z</code></pre></div></div><div class=paragraph><p>waarbij <em>X.Y.Z</em> het versienummer van de geïnstalleerde Apache OpenOffice is, bijvoorbeeld <em>3.4.0</em>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Tijdens de eerste keer starten worden er een aantal vragen gesteld en wordt de map <span class=filename>.openoffice.org</span> in de thuismap van de aangemelde gebruiker gemaakt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als de Apache OpenOffice pakketten niet beschikbaar zijn, kan het uit de ports gecompileerd worden. Hiervoor is veel schijfruimte en tijd nodig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/editors/openoffice-3</span>
<span class=c># make install clean</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Vervang om een gelokaliseerde versie te bouwen de voorgaande commandoregel door de volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make LOCALIZED_LANG=uw_taal install clean</span></code></pre></div></div><div class=paragraph><p>Vervang <em>taal</em> door de juiste ISO-taalcode. Een lijst met ondersteunde taalcodes is beschikbaar in het bestand <span class=filename>files/Makefile.localized</span> in de map van de port.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Start hierna Apache OpenOffice met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% openoffice-X.Y.Z</code></pre></div></div><div class=paragraph><p>waarbij <em>X.Y.Z</em> het versienummer van de geïnstalleerde Apache OpenOffice is, bijvoorbeeld <em>3.4.0</em>.</p></div></div><div class=sect3><h4 id=_libreoffice>7.3.5. LibreOffice<a class=anchor href=#_libreoffice></a></h4><div class=paragraph><p>LibreOffice is een gratis kantoorpakket ontwikkeld door <a href=http://www.documentfoundation.org/>The Document Foundation</a> en is compatibel met andere grote kantoorpakketten en is beschikbaar op meerdere platforms. Het is een afsplitsing van OpenOffice.org onder een nieuw merk en bevat alle verwachte toepassingen van een compleet kantoorpakket: een tekstverwerker, een spreadsheet, een presentatiebeheerder, een tekenprogramma, een databasebeheerprogramma, en een programma om wiskundige formules te bewerken. Het is beschikbaar in een aantal verschillende talen - internationalisatie heeft zich uitgebreid naar interfaces, spellingcheckers en woordenboeken.</p></div><div class=paragraph><p>De tekstverwerker van LibreOffice gebruikt een eigen XML-bestandsformaat voor verhoogde portabiliteit en flexibiliteit. Het spreadsheetprogramma bevat een macrotaal en kan met externe databases gebruikt worden. LibreOffice is reeds stabiel en draait op Windows®, Linux, FreeBSD, en Mac OS® X. Meer informatie over LibreOffice is te vinden op de <a href=http://www.libreoffice.org/>website van LibreOffice</a>.</p></div><div class=paragraph><p>Om LibreOffice als een pakket te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r libreoffice</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Dit zou moeten werken met een -RELEASE-versie van FreeBSD.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als het pakket is geïnstalleerd, dient de volgende opdracht gebruikt te worden om LibreOffice te draaien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% libreoffice</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Tijdens de eerste keer draaien worden u wat vragen gesteld en wordt er een map <span class=filename>.libreoffice</span> aangemaakt in uw thuismap.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als er geen pakket voor LibreOffice beschikbaar is, heeft u nog altijd de optie om de port te compileren. Denk er echter aan dat dit veel schijfruimte en redelijk veel tijd kost.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/editors/libreoffice</span>
<span class=c># make install clean</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als u een gelokaliseerde versie wilt bouwen, dient u de vorige opdracht door het volgende te vervangen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make LOCALIZED_LANG=uw_taal install clean</span></code></pre></div></div><div class=paragraph><p>U dient <em>uw_taal</em> te vervangen door de juiste ISO-taalcode. Een lijst met ondersteunde talen is beschikbaar in het doel <code>pre-fetch</code> van de <span class=filename>Makefile</span> van de port.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Wanneer dit is gedaan, kan LibreOffice gestart worden met deze opdracht:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% libreoffice</code></pre></div></div></div></div><div class=sect2><h3 id=desktop-viewers>7.4. Documentviewers<a class=anchor href=#desktop-viewers></a></h3><div class=paragraph><p>Sommige nieuwe documentformaten hebben aan populariteit gewonnen sinds de komst van UNIX®; het kan zijn dat de standaardviewers die ze vereisen niet in het basissysteem zitten. In dit gedeelte wordt aangegeven hoe zulke viewers geïnstalleerd kunnen worden.</p></div><div class=paragraph><p>Dit gedeelte behandelt de onderstaande applicaties:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Applicatie</th><th class="tableblock halign-left valign-top">Bronnen</th><th class="tableblock halign-left valign-top">Ports</th><th class="tableblock halign-left valign-top">Afhankelijkheden</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Acrobat Reader®</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>licht</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Linux® binaire compatibiliteit</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>gv</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>licht</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Xaw3d</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Xpdf</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>licht</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeType</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GQview</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>licht</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gtk+ of GNOME</p></td></tr></tbody></table><div class=sect3><h4 id=_acrobat_reader>7.4.1. Acrobat Reader®<a class=anchor href=#_acrobat_reader></a></h4><div class=paragraph><p>Documenten worden vaak als PDF-bestanden, "Portable Document Format", verspreid. Een van de aanbevolen viewers voor dit bestandstype is Acrobat Reader® dat Adobe voor Linux® heeft uitgegeven. Omdat FreeBSD Linux® binaries kan draaien, is het ook beschikbaar voor FreeBSD.</p></div><div class=paragraph><p>Om Acrobat Reader® 8 te installeren uit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/print/acroread8</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Vanwege de licentie is een pakket niet beschikbaar.</p></div></div><div class=sect3><h4 id=_gv>7.4.2. gv<a class=anchor href=#_gv></a></h4><div class=paragraph><p>gv is een PostScript® en PDF viewer. Het is gebaseerd op ghostview maar heeft een vriendelijker uiterlijk dankzij de Xaw3d bibliotheek. Het is snel en heeft mogelijkheden, zoals oriëntatie, papiergrootte, schalen en anti-aliassen. Bijna elke bewerking kan met het toetsenbord of de muis worden gedaan.</p></div><div class=paragraph><p>gv is als pakket te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gv</span></code></pre></div></div><div class=paragraph><p>Of uit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/print/gv</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_xpdf>7.4.3. Xpdf<a class=anchor href=#_xpdf></a></h4><div class=paragraph><p>Xpdf een efficiënte lichtgewicht PDF-viewer voor FreeBSD. Het heeft erg weinig bronnen nodig en is zeer stabiel. Het gebruikt de standaard X-fonts en is niet afhankelijk van Motif® of andere X-toolkits.</p></div><div class=paragraph><p>Xpdf is als pakket te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r xpdf</span></code></pre></div></div><div class=paragraph><p>Of uit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/graphics/xpdf</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Als de installatie voltooid is, kan Xpdf gestart worden en het menu kan met de rechtermuisknop geactiveerd worden.</p></div></div><div class=sect3><h4 id=_gqview>7.4.4. GQview<a class=anchor href=#_gqview></a></h4><div class=paragraph><p>GQview is een afbeeldingenbeheerder. Een bestand kan met één klik bekeken worden, er kan een externe editor opgestart worden er kunnen thumbnail-voorbeelden gemaakt worden en nog veel meer. Het bevat ook een diapresentatie-modus en enkele standaard bestandsoperaties. Er kunnen afbeeldingsverzamelingen beheerd worden en eenvoudig duplicaten gevonden worden. GQview kan het complete scherm gebruiken en ondersteunt meerdere talen.</p></div><div class=paragraph><p>GQview is als pakket te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gqview</span></code></pre></div></div><div class=paragraph><p>Of uit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/graphics/gqview</span>
<span class=c># make install clean</span></code></pre></div></div></div></div><div class=sect2><h3 id=desktop-finance>7.5. Financiën<a class=anchor href=#desktop-finance></a></h3><div class=paragraph><p>Om financiën via het FreeBSD bureaublad te beheren zijn er krachtige en gemakkelijk te gebruiken applicaties om te installeren. Sommige zijn compatibel met wijdverbreide bestandsformaten, zoals de formaten gebruikt door Quicken en Excel om documenten op te slaan.</p></div><div class=paragraph><p>Dit gedeelte behandelt deze programma’s:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Applicatie</th><th class="tableblock halign-left valign-top">Bronnen</th><th class="tableblock halign-left valign-top">Ports</th><th class="tableblock halign-left valign-top">Afhankelijkheden</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GnuCash</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>zwaar</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNOME</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Gnumeric</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>zwaar</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNOME</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Abacus</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>licht</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Tcl/Tk</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KMyMoney</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>weinig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>zwaar</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>KDE</p></td></tr></tbody></table><div class=sect3><h4 id=_gnucash>7.5.1. GnuCash<a class=anchor href=#_gnucash></a></h4><div class=paragraph><p>GnuCash is onderdeel van GNOME dat gebruikersvriendelijke en krachtige applicaties aan eindgebruikers wil leveren. Met GnuCash kunnen inkomsten en uitgaven, bankrekeningen en voorraden bijgehouden worden. Het bevat een intuïtieve interface terwijl het erg professioneel blijft.</p></div><div class=paragraph><p>GnuCash levert een slim kasboek, een hiërarchisch systeem van rekeningen, en veel toetsenbordversnellers en auto-invul mogelijkheden. Het kan een transactie splitsen in meer gedetailleerde stukken. GnuCash kan Quicken QIF-bestanden invoeren en samenvoegen. Het kan ook met de meeste internationale datum- en valutaformaten omgaan.</p></div><div class=paragraph><p>GnuCash is als pakket te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gnucash</span></code></pre></div></div><div class=paragraph><p>Of uit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/finance/gnucash</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_gnumeric>7.5.2. Gnumeric<a class=anchor href=#_gnumeric></a></h4><div class=paragraph><p>Gnumeric is een spreadsheetprogramma uit de GNOME bureaubladomgeving. Het maakt gebruikt van "auto-invullen" afhankelijk van het celformaat. Het kan bestanden in een aantal populaire formaten zoals Excel, Lotus 1-2-3 en Quattro Pro inlezen. Gnumeric ondersteunt grafieken door middel van het grafiekprogramma <a class=package href=https://cgit.freebsd.org/ports/tree/math/guppi/>math/guppi</a>. Het heeft een groot aantal ingebouwde functies en kent gebruikelijke celformaten als nummer, valuta, datum, tijd en veel meer.</p></div><div class=paragraph><p>Gnumeric is als pakket te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gnumeric</span></code></pre></div></div><div class=paragraph><p>Of uit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/math/gnumeric</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_abacus>7.5.3. Abacus<a class=anchor href=#_abacus></a></h4><div class=paragraph><p>Abacus is een kleine en gemakkelijk te gebruiken spreadsheetprogramma. Het bevat veel ingebouwde functies die nuttig zijn in verschillende domeinen zoals statistiek, financiën, en wiskunde. Het kan Excel-bestanden lezen en schrijven. Abacus kan PostScript® uitvoer produceren.</p></div><div class=paragraph><p>Abacus is als pakket te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r abacus</span></code></pre></div></div><div class=paragraph><p>Of uit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/deskutils/abacus</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_kmymoney>7.5.4. KMyMoney<a class=anchor href=#_kmymoney></a></h4><div class=paragraph><p>KMyMoney is een persoonlijke financiële beheerder gebouwd voor KDE. KMyMoney poogt om alle belangrijke eigenschappen die in commerciële persoonlijke financiële beheerders zitten te bieden en te integreren. Gebruiksgemak en degelijke dubbele accounting zijn eigenschappen die worden benadrukt. KMyMoney importeert vanuit standaard Quicken Interchange Format (QIF) bestanden, houdt investeringen bij, kan met meerdere munteenheden overweg, en biedt een waaier aan rapporten. Mogelijkheden om OFX te importeren zijn via een aparte plugin beschikbaar.</p></div><div class=paragraph><p>Om KMyMoney als een pakket te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r kmymoney2</span></code></pre></div></div><div class=paragraph><p>Als het pakket niet beschikbaar is, kan de Portscollectie gebruikt worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/finance/kmymoney2</span>
<span class=c># make install clean</span></code></pre></div></div></div></div><div class=sect2><h3 id=desktop-summary>7.6. Samenvatting<a class=anchor href=#desktop-summary></a></h3><div class=paragraph><p>Hoewel FreeBSD populair is bij ISP’s om zijn prestaties en stabiliteit, is het behoorlijk klaar voor dagelijks gebruik als een bureaublad. Met enkele duizenden applicaties als <a href=https://www.FreeBSD.org/applications/>pakketten</a> of <a href=https://www.FreeBSD.org/ports/>ports</a>, is een perfect bureaublad te bouwen dat aan alle noden voldoet.</p></div><div class=paragraph><p>Nu volgt nog een overzicht van alle bureaubladapplicaties die in dit hoofdstuk zijn behandeld:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Applicatie</th><th class="tableblock halign-left valign-top">Package</th><th class="tableblock halign-left valign-top">Port</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Opera</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>linux-opera</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/www/linux-opera/>www/linux-opera</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Firefox</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>firefox</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/www/firefox/>www/firefox</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Chromium</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>chromium</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/www/chromium/>www/chromium</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KOffice</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>koffice-kde4</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/editors/koffice-kde4/>editors/koffice-kde4</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>AbiWord</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>abiword</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/editors/abiword/>editors/abiword</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>The GIMP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gimp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/graphics/gimp/>graphics/gimp</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Apache OpenOffice</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>openoffice</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/editors/openoffice-3/>editors/openoffice-3</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>LibreOffice</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>libreoffice</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/editors/libreoffice/>editors/libreoffice</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Acrobat Reader®</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>acroread</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/print/acroread8/>print/acroread8</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>gv</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gv</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/print/gv/>print/gv</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Xpdf</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>xpdf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/graphics/xpdf/>graphics/xpdf</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GQview</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gqview</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/graphics/gqview/>graphics/gqview</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GnuCash</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gnucash</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/finance/gnucash/>finance/gnucash</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Gnumeric</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gnumeric</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/math/gnumeric/>math/gnumeric</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Abacus</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>abacus</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/deskutils/abacus/>deskutils/abacus</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KMyMoney</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>kmymoney2</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/finance/kmymoney2/>finance/kmymoney2</a></p></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=multimedia>Hoofdstuk 8. Multimedia<a class=anchor href=#multimedia></a></h2><div class=sectionbody><div class=sect2><h3 id=multimedia-synopsis>8.1. Overzicht<a class=anchor href=#multimedia-synopsis></a></h3><div class=paragraph><p>FreeBSD ondersteunt een breed bereik aan geluidskaarten, waardoor het mogelijk is van geluid van hoge kwaliteit op een computer te genieten. Hieronder vallen mogelijkheden om geluid op te nemen en af te spelen in de MPEG Audio Layer 3 (MP3), WAV en Ogg Vorbis formaten en vele andere formaten. De FreeBSD Portscollectie bevat ook programma’s waarmee opgenomen audio bewerkt kan worden, waarmee geluidseffecten toegevoegd kunnen worden en aangesloten MIDI apparaten bestuurd kunnen worden.</p></div><div class=paragraph><p>Met wat experimenteren kunnen met FreeBSD videobestanden en DVD’s afgespeeld worden. Er zijn minder programma’s om video te encoderen, te converteren en af te spelen dan er zijn voor audio. Op het moment van schrijven is er bijvoorbeeld geen goed hercoderingsprogramma in de FreeBSD Portscollectie beschikbaar wat gebruikt kan worden om tussen formaten onderling te converteren, zoals mogelijk is met <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sox/>audio/sox</a>. De software in dit landschap is echter sterk aan verandering onderhevig.</p></div><div class=paragraph><p>In dit hoofdstuk worden de stappen beschreven die uitgevoerd moeten worden om een geluidskaart in te stellen. Bij de installatie en instelling van X11 (<a href=./#x11>Het X Window systeem</a>) is al beschreven hoe videokaarten ingesteld kunnen worden, hoewel er nog wel een aantal mogelijkheden zijn om het afspelen te verbeteren.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe een systeem zo in te stellen dat een geluidskaart wordt herkend;</p></li><li><p>Hoe getest kan worden of een kaart werkt;</p></li><li><p>Hoe problemen op te lossen met betrekking tot geluidsinstellingen;</p></li><li><p>Hoe MP3’s en andere audio af te spelen en te maken;</p></li><li><p>Hoe video wordt ondersteund door de X server;</p></li><li><p>Welke video speler/encoderports goede resultaten geven;</p></li><li><p>Hoe DVD’s, <span class=filename>.mpg</span> en <span class=filename>.avi</span> bestanden af te spelen;</p></li><li><p>Hoe de inhoud van CD’s en DVD’s naar bestanden geript kan worden;</p></li><li><p>Hoe een TV-kaart in te stellen;</p></li><li><p>Hoe een scanner in te stellen.</p></li></ul></div><div class=paragraph><p>Er wordt aangenomen dat de lezer van dit hoofdstuk:</p></div><div class=ulist><ul><li><p>Weet hoe een nieuwe kernel in te stellen en te installeren (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Het proberen aan te koppelen van audio-CD’s met <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> resulteert in ieder geval in een foutmelding en in het ergste geval tot een <em>kernel panic</em>. Dat type media heeft een formaat dat afwijkt van het gebruikelijke ISO-bestandssysteem.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=sound-setup>8.2. Geluidskaart installeren<a class=anchor href=#sound-setup></a></h3><div class=sect3><h4 id=sound-device>8.2.1. Systeem instellen<a class=anchor href=#sound-device></a></h4><div class=paragraph><p>Alvorens te beginnen is het van belang te weten welk model een geluidskaart is, welke chip erop wordt gebruikt en of het een PCI of ISA kaart is. FreeBSD ondersteunt vele PCI en ISA kaarten. De ondersteunde audio-apparaten staan in een lijst in de <a href=https://www.FreeBSD.org/releases/12.0R/hardware/>Hardware Notes</a>. In de Hardware Notes staat ook beschreven welk stuurprogramma uw kaart ondersteunt.</p></div><div class=paragraph><p>Om een geluidsapparaat te gebruiken dient het juiste apparaatstuurprogramma geladen te worden. Dit kan op twee manieren. De meest eenvoudige manier is simpelweg een kernelmodule te laden voor de gewenste geluidskaart met <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>. Dit kan vanaf de commandoregel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload snd_emu10k1</span></code></pre></div></div><div class=paragraph><p>Of door als volgt de juiste regel toe te voegen aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>snd_emu10k1_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>De bovenstaande voorbeelden zijn voor een Creative SoundBlaster® Live! geluidskaart. De overige beschikbare laadbare geluidsmodules staan beschreven in <span class=filename>/boot/defaults/loader.conf</span>. Als niet compleet duidelijk is welk stuurprogramma gebruikt dient te worden, dan kan het met de module <span class=filename>snd_driver</span> geprobeerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload snd_driver</span></code></pre></div></div><div class=paragraph><p>Dit is een metastuurprogramma, dat in één keer de meest voorkomende apparaatstuurprogramma’s laadt. Hiermee kan het zoeken naar het juiste stuurprogramma versneld worden. Het is ook mogelijk om alle geluidsstuurprogramma’s te laden via de optie <span class=filename>/boot/loader.conf</span>.</p></div><div class=paragraph><p>Om uit te vinden welk stuurprogramma na het laden van het metastuurprogramma <span class=filename>snd_driver</span> wordt geladen kan de inhoud van het bestand <span class=filename>/dev/sndstat</span> nagekeken worden met <code>cat /dev/sndstat</code>.</p></div><div class=paragraph><p>Een tweede mogelijkheid is ondersteuning voor een geluidskaart statisch in de kernel te compileren. In de onderstaande paragrafen staat meer informatie over hoe op die manier ondersteuning voor hardware toegevoegd kan worden. Meer informatie over het hercompileren van een kernel staat in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div><div class=sect4><h5 id=_aangepaste_kernel_maken_met_geluidsondersteuning>8.2.1.1. Aangepaste kernel maken met geluidsondersteuning<a class=anchor href=#_aangepaste_kernel_maken_met_geluidsondersteuning></a></h5><div class=paragraph><p>Eerst moet het stuurprogramma voor het audioraamwerk <a href="https://man.freebsd.org/cgi/man.cgi?query=sound&amp;sektion=4&amp;format=html">sound(4)</a> aan de kernel toegevoegd worden. Daarvoor dient het volgende te worden opgenomen in het bestand met kernelinstellingen:</p></div><div class="literalblock programlisting"><div class=content><pre>device sound</pre></div></div><div class=paragraph><p>Daarna kan ondersteuning voor de specifieke geluidskaart toegevoegd worden. Daarvoor moet bekend zijn welk stuurprogramma de kaart ondersteunt. Dit kan opgezocht worden in de lijst met ondersteunde audio-apparaten in de <a href=https://www.FreeBSD.org/releases/12.0R/hardware/>Hardware Notes</a>, waar de correcte stuurprogramma’s voor geluidskaarten beschreven staan. Zo wordt een Creative SoundBlaster® Live! geluidskaart bijvoorbeeld ondersteund door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=snd_emu10k1&amp;sektion=4&amp;format=html">snd_emu10k1(4)</a>. Ondersteuning voor deze kaart kan als volgt worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>device snd_emu10k1</pre></div></div><div class=paragraph><p>In de hulppagina voor een stuurprogramma staat welke syntaxis gebruikt kan worden. De expliciete syntaxis voor de kernelinstellingen voor elk ondersteund geluidsstuurprogramma staat ook in <span class=filename>/usr/src/sys/conf/NOTES</span>.</p></div><div class=paragraph><p>Voor niet-PnP ISA-geluidskaarten kan het nodig zijn dat de kernel informatie gegeven moet worden over de instellingen van de kaart (IRQ, I/O poort, enzovoort), zoals dat geldt voor alle niet-PnP ISA-kaarten. Dit kan via het bestand <span class=filename>/boot/device.hints</span>. Bij het starten van een systeem leest de <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> dat bestand uit en geeft de instellingen door aan de kernel. Zo gebruikt een oude Creative SoundBlaster® 16 ISA niet-PnP-kaart het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=snd_sbc&amp;sektion=4&amp;format=html">snd_sbc(4)</a> samen met <code>snd_sb16</code> en dient de volgende regel toegevoegd te worden aan het kernelinstellingenbestand:</p></div><div class="literalblock programlisting"><div class=content><pre>device snd_sbc
device snd_sb16</pre></div></div><div class=paragraph><p>Daarnaast moet het volgende worden toegevoegd aan <span class=filename>/boot/device.hints</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hint.sbc.0.at=&#34;isa&#34;
hint.sbc.0.port=&#34;0x220&#34;
hint.sbc.0.irq=&#34;5&#34;
hint.sbc.0.drq=&#34;1&#34;
hint.sbc.0.flags=&#34;0x15&#34;</pre></div></div><div class=paragraph><p>In dit geval gebruikt de kaart I/O poort <code>0x220</code> en IRQ <code>5</code>.</p></div><div class=paragraph><p>De gebruikte syntaxis voor <span class=filename>/boot/device.hints</span> staat beschreven in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=sound&amp;sektion=4&amp;format=html">sound(4)</a> en de hulppagina voor het gevraagde stuurprogramma.</p></div><div class=paragraph><p>De bovenstaande instellingen zijn de standaardinstellingen. In sommige gevallen moeten IRQ of andere instellingen gewijzigd worden om een apparaat juist te laten werken. In <a href="https://man.freebsd.org/cgi/man.cgi?query=snd_sbc&amp;sektion=4&amp;format=html">snd_sbc(4)</a> staat meer informatie over deze kaart.</p></div></div></div><div class=sect3><h4 id=sound-testing>8.2.2. Geluidskaart testen<a class=anchor href=#sound-testing></a></h4><div class=paragraph><p>Na het herstarten met de aangepaste kernel of na het laden van de benodigde module, hoort de geluidskaart ongeveer als volgt te verschijnen in de systeemberichtbuffer (<a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>pcm0: &lt;Intel ICH3 <span class=o>(</span>82801CA<span class=o>)&gt;</span> port 0xdc80-0xdcbf,0xd800-0xd8ff irq 5 at device 31.5 on pci0
pcm0: <span class=o>[</span>GIANT-LOCKED]
pcm0: &lt;Cirrus Logic CS4205 AC97 Codec&gt;</code></pre></div></div><div class=paragraph><p>De status van de geluidskaart kan gecontroleerd worden via het bestand <span class=filename>/dev/sndstat</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat /dev/sndstat</span>
FreeBSD Audio Driver <span class=o>(</span>newpcm<span class=o>)</span>
Installed devices:
pcm0: &lt;Intel ICH3 <span class=o>(</span>82801CA<span class=o>)&gt;</span> at io 0xd800, 0xdc80 irq 5 bufsz 16384
kld snd_ich <span class=o>(</span>1p/2r/0v channels duplex default<span class=o>)</span></code></pre></div></div><div class=paragraph><p>De uitvoer kan per systeem wat verschillen. Als er geen apparaten <span class=filename>pcm</span> genoemd worden, dienen eerdere stappen herzien te worden. Bekijk nogmaals de instellingen van de kernel en bevestig dat het juiste apparaatstuurprogramma was gekozen. Veel voorkomende problemen staan beschreven in <a href=#troubleshooting>Bekende problemen</a>.</p></div><div class=paragraph><p>Als het goed is werkt de geluidskaart nu. Als pinnen voor audio-out van de CD-ROM- of DVD-ROM-drive juist zijn aangesloten op de geluidskaart, dan kan er een CD in de drive gestopt worden en kan deze met <a href="https://man.freebsd.org/cgi/man.cgi?query=cdcontrol&amp;sektion=1&amp;format=html">cdcontrol(1)</a> afgespeeld worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdcontrol <span class=nt>-f</span> /dev/acd0 play 1</code></pre></div></div><div class=paragraph><p>Applicaties als <a class=package href=https://cgit.freebsd.org/ports/tree/audio/workman/>audio/workman</a> kunnen een vriendelijker interface bieden. Wellicht is het handig om een applicatie als <a class=package href=https://cgit.freebsd.org/ports/tree/audio/mpg123/>audio/mpg123</a> te installeren om naar MP3 audiobestanden te luisteren.</p></div><div class=paragraph><p>Een snelle manier om de kaart te testen is het als volgt sturen van gegevens naar <span class=filename>/dev/dsp</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cat </span>bestandsnaam <span class=o>&gt;</span> /dev/dsp</code></pre></div></div><div class=paragraph><p><span class=filename>bestandsnaam</span> kan ieder bestand zijn. Deze commandoregel hoort wat ruis te maken, waardoor wordt bevestigd dat de geluidskaart echt werkt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De appparaat nodes <span class=filename>/dev/dsp*</span> worden automatisch aangemaakt wanneer dat nodig is. Als deze niet worden gebruikt, bestaan ze niet en zullen ze niet terugkomen in de terugkoppeling van <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Niveaus voor de geluidskaartmixer kunnen aangepast worden met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=mixer&amp;sektion=8&amp;format=html">mixer(8)</a>. Er staan meer details in <a href="https://man.freebsd.org/cgi/man.cgi?query=mixer&amp;sektion=8&amp;format=html">mixer(8)</a>.</p></div><div class=sect4><h5 id=troubleshooting>8.2.2.1. Bekende problemen<a class=anchor href=#troubleshooting></a></h5><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Fout</th><th class="tableblock halign-left valign-top">Oplossing</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sb_dspwr(XX) timed out</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De I/O poort is niet correct ingesteld.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bad irq XX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het IRQ is niet correct ingesteld. Zorg dat het ingestelde IRQ en het IRQ voor het geluid hetzelfde zijn.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>xxx: gus pcm not attached, out of memory</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Er is niet genoeg geheugen beschikbaar om het apparaat te gebruiken.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>xxx: can’t open /dev/dsp!</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Controleer <code>fstat | grep dsp</code> of een ander programma het apparaat geopend heeft. Bekende probleemgevallen zijn esound en KDE’s geluidsondersteuning.</p></td></tr></tbody></table><div class=paragraph><p>Een ander euvel is dat moderne grafische kaarten voor het gebruik van HDMI en dergelijken vaak zijn uitgerust met hun eigen geluidsstuurprogramma. Dit geluidsapparaat wordt soms opgesomd voor het eigenlijke geluidskaart en daardoor wordt deze niet gebruikt als het standaard afspeelapparaat. Om te zien of dit het geval is, kan dmesg worden gedraaid en gezocht worden naar <code>pcm</code>. De uitvoer ziet er ongeveer als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>...
hdac0: HDA Driver Revision: 20100226_0142
hdac1: HDA Driver Revision: 20100226_0142
hdac0: HDA Codec #0: NVidia (Unknown)
hdac0: HDA Codec #1: NVidia (Unknown)
hdac0: HDA Codec #2: NVidia (Unknown)
hdac0: HDA Codec #3: NVidia (Unknown)
pcm0: &lt;HDA NVidia (Unknown) PCM #0 DisplayPort&gt; at cad 0 nid 1 on hdac0
pcm1: &lt;HDA NVidia (Unknown) PCM #0 DisplayPort&gt; at cad 1 nid 1 on hdac0
pcm2: &lt;HDA NVidia (Unknown) PCM #0 DisplayPort&gt; at cad 2 nid 1 on hdac0
pcm3: &lt;HDA NVidia (Unknown) PCM #0 DisplayPort&gt; at cad 3 nid 1 on hdac0
hdac1: HDA Codec #2: Realtek ALC889
pcm4: &lt;HDA Realtek ALC889 PCM #0 Analog&gt; at cad 2 nid 1 on hdac1
pcm5: &lt;HDA Realtek ALC889 PCM #1 Analog&gt; at cad 2 nid 1 on hdac1
pcm6: &lt;HDA Realtek ALC889 PCM #2 Digital&gt; at cad 2 nid 1 on hdac1
pcm7: &lt;HDA Realtek ALC889 PCM #3 Digital&gt; at cad 2 nid 1 on hdac1
...</pre></div></div><div class=paragraph><p>Hier is de grafische kaart (<code>NVidia</code>) opgesomd voor de geluidskaart (<code>Realtek ALC889</code>). Om de geluidskaart als standaard afspeelapparaat te gebruiken, dient <code>hw.snd.default_unit</code> veranderd te worden in de eenheid dat voor afspelen gebruikt moet worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl hw.snd.default_unit=n</span></code></pre></div></div><div class=paragraph><p>Hier is <code>n</code> het nummer van het geluidsapparaat wat gebruikt dient te worden, in dit voorbeeld <code>4</code>. U kunt deze verandering permanent maken door de volgende regel aan <span class=filename>/etc/sysctl.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.snd.default_unit=4</pre></div></div></div></div><div class=sect3><h4 id=sound-multiple-sources>8.2.3. Meerdere geluidsbronnen gebruiken<a class=anchor href=#sound-multiple-sources></a></h4><div class=paragraph><p>Het is vaak wenselijk om meerdere geluidsbronnen tegelijkertijd af te kunnen spelen, zoals wanneer esound of artsd het delen van een geluidsapparaat met een andere applicatie niet ondersteunen.</p></div><div class=paragraph><p>Met FreeBSD kan dit met <em>Virtuele Geluidskanalen</em>, die aangezet kunnen worden met de faciliteit <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>. Met virtuele kanalen kunnen het afspelen van een geluidskaart gemultiplext worden door het geluid in de kernel te mixen.</p></div><div class=paragraph><p>Het aantal virtuele kanalen kan met drie sysctl knoppen als <code>root</code> als volgt ingesteld worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl dev.pcm.0.play.vchans=4</span>
<span class=c># sysctl dev.pcm.0.rec.vchans=4</span>
<span class=c># sysctl hw.snd.maxautovchans=4</span></code></pre></div></div><div class=paragraph><p>In het bovenstaande voorbeeld worden vier virtuele kanalen toegewezen, wat in het dagelijks gebruik voldoende is. Zowel <code>dev.pcm.0.play.vchans=4</code> als <code>dev.pcm.0.rec.vchans=4</code> zijn het aantal virtuele kanalen dat <span class=filename>pcm0</span> heeft voor afspelen en opnemen, en zijn instelbaar als een apparaat is aangesloten. In <code>hw.snd.maxautovchans</code> staat het aantal virtuele kanalen dat aan een nieuw audio-apparaat wordt gegeven als het wordt aangesloten met <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>. Omdat de module <span class=filename>pcm</span> onafhankelijk van de hardware stuurprogramma’s geladen kan worden, kan in <code>hw.snd.maxautovchans</code> opgeslagen worden hoeveel virtuele kanalen apparaten die later worden aangesloten krijgen. Voor meer informatie wordt naar <a href="https://man.freebsd.org/cgi/man.cgi?query=pcm&amp;sektion=4&amp;format=html">pcm(4)</a> verwezen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het aantal virtuele kanalen voor een apparaat kan niet gewijzigd worden als het in gebruik is. Sluit eerst alle programma’s die het apparaat gebruiken, zoals muziekspelers of geluidsdaemons.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het juiste <span class=filename>pcm</span> apparaat zal automatisch en transparant gealloceerd worden voor programma’s die <span class=filename>/dev/dsp0</span> aanroepen.</p></div></div><div class=sect3><h4 id=_standaardwaarden_voor_mixerkanalen_instellen>8.2.4. Standaardwaarden voor mixerkanalen instellen<a class=anchor href=#_standaardwaarden_voor_mixerkanalen_instellen></a></h4><div class=paragraph><p>De standaardwaarden voor de mixerkanalen zijn ingesteld in de broncode van het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=pcm&amp;sektion=4&amp;format=html">pcm(4)</a>. Er zijn vele applicaties en daemons waarmee waarden voor de mixer ingesteld en onthouden kunnen worden en iedere keer bij het starten weer kunnen worden ingesteld, maar dit is geen nette oplossing. Het is mogelijk om de standaardwaarden in te stellen op het niveau van het stuurprogramma - dit wordt bereikt door de gewenste waarden in te stellen in <span class=filename>/boot/device.hints</span>, bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>hint.pcm.0.vol=&#34;50&#34;</pre></div></div><div class=paragraph><p>Met de bovenstaande instelling wordt het volume van een kanaal standaard op 50 ingesteld bij het laden van de module <a href="https://man.freebsd.org/cgi/man.cgi?query=pcm&amp;sektion=4&amp;format=html">pcm(4)</a>.</p></div></div></div><div class=sect2><h3 id=sound-mp3>8.3. MP3 audio<a class=anchor href=#sound-mp3></a></h3><div class=paragraph><p>Met MP3 (MPEG Layer 3 Audio) kan geluid bijna in CD-kwaliteit weergegeven worden en dus is er een goede reden om dit vooral niet na te laten op een FreeBSD werkstation.</p></div><div class=sect3><h4 id=mp3-players>8.3.1. MP3 spelers<a class=anchor href=#mp3-players></a></h4><div class=paragraph><p>Verreweg de meest populaire X11 MP3 speler is XMMS (X Multimedia Systeem). In XMMS kunnen Winamp skins gebruikt worden, omdat de GUI vrijwel gelijk is aan die van Nullsoft’s Winamp. XMMS heeft ook een eigen plug-in ondersteuning.</p></div><div class=paragraph><p>XMMS kan geïnstalleerd worden via de <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/xmms/>multimedia/xmms</a> port of pakket.</p></div><div class=paragraph><p>De interface van XMMS is intuïtief met een afspeellijst, grafische equalizer en meer. Gebruikers die bekend zijn met Winamp vinden XMMS vast eenvoudig te gebruiken.</p></div><div class=paragraph><p>De port <a class=package href=https://cgit.freebsd.org/ports/tree/audio/mpg123/>audio/mpg123</a> is een alternatieve MP3-speler die gebruik maakt van de commandoregel.</p></div><div class=paragraph><p>mpg123 werkt door het geluidsapparaat en het MP3-bestand aan te geven op de commandoregel. Aangenomen dat uw audio-apparaat <span class=filename>/dev/dsp1.0</span> is en u het MP3-bestand <em>Foobar-GreatestHits.mp3</em> wilt afspelen, zou u het volgende opgeven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mpg123 -a /dev/dsp1.0 Foobar-GreatestHits.mp3</span>
High Performance MPEG 1.0/2.0/2.5 Audio Player <span class=k>for </span>Layer 1, 2 and 3.
Version 0.59r <span class=o>(</span>1999/Jun/15<span class=o>)</span><span class=nb>.</span> Written and copyrights by Michael Hipp.
Uses code from various people. See <span class=s1>&#39;README&#39;</span> <span class=k>for </span>more!
THIS SOFTWARE COMES WITH ABSOLUTELY NO WARRANTY! USE AT YOUR OWN RISK!

Playing MPEG stream from Foobar-GreatestHits.mp3 ...
MPEG 1.0 layer III, 128 kbit/s, 44100 Hz joint-stereo</code></pre></div></div></div><div class=sect3><h4 id=rip-cd>8.3.2. CD audio tracks rippen<a class=anchor href=#rip-cd></a></h4><div class=paragraph><p>Voordat een CD of een CD track naar MP3 ge-encodeerd kan worden moeten de audiogegevens naar de harde schijf geript worden. Dit gaat door de ruwe CDDA (CD Digital Audio) gegevens naar WAV-bestanden te kopiëren.</p></div><div class=paragraph><p>Het hulpprogramma <code>cdda2wav</code>, dat onderdeel is van de suite <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a>, kan gebruikt worden om audio-informatie en de daarbij behorende informatie van CD’s te rippen.</p></div><div class=paragraph><p>Als de audio CD in de drive zit, kan het volgende commando als <code>root</code> uitgevoerd worden om een hele CD naar individuele (per track) WAV-bestanden te rippen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdda2wav -D 0,1,0 -B</span></code></pre></div></div><div class=paragraph><p>cdda2wav ondersteunt ATAPI (IDE) CD-ROM-drives. Om van een IDE drive te rippen, dient de apparaatnaam aangegeven te worden in plaats van de SCSI eenheidsnummers. Om bijvoorbeeld track 7 van een IDE drive te rippen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdda2wav -D /dev/acd0 -t 7</span></code></pre></div></div><div class=paragraph><p>De optie <code>-D <em>0,1,0</em></code> geeft het SCSI apparaat <span class=filename>0,1,0</span> aan, dat overeenkomt met de uitvoer van <code>cdrecord -scanbus</code>.</p></div><div class=paragraph><p>Om individuele tracks te rippen kan gebruik gemaakt worden van de optie <code>-t</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdda2wav -D 0,1,0 -t 7</span></code></pre></div></div><div class=paragraph><p>In het bovenstaande voorbeeld wordt track 7 van de audio CD geript. Om een reeks tracks te rippen, bijvoorbeeld van 1 tot 7, kan een reeks opgegeven worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdda2wav -D 0,1,0 -t 1+7</span></code></pre></div></div><div class=paragraph><p>Ook het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a> kan gebruikt worden om audio tracks van ATAPI drives af te halen. Deze mogelijkheid wordt beschreven in <a href=./#duplicating-audiocds>Audio-CD’s dupliceren</a>.</p></div></div><div class=sect3><h4 id=mp3-encoding>8.3.3. MP3’s encoderen<a class=anchor href=#mp3-encoding></a></h4><div class=paragraph><p>Tegenwoordig is <em>de</em> MP3 encoder lame. Lame staat in <a class=package href=https://cgit.freebsd.org/ports/tree/audio/lame/>audio/lame</a> in de portsstructuur.</p></div><div class=paragraph><p>Met de geripte WAV-bestanden converteert het volgende commando <span class=filename>audio01.wav</span> naar <span class=filename>audio01.mp3</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lame -h -b 192 \</span>
<span class=nt>--tt</span> <span class=s2>&#34;Foo Titel&#34;</span> <span class=se>\</span>
<span class=nt>--ta</span> <span class=s2>&#34;FooBar Artiest&#34;</span> <span class=se>\</span>
<span class=nt>--tl</span> <span class=s2>&#34;FooBar Album&#34;</span> <span class=se>\</span>
<span class=nt>--ty</span> <span class=s2>&#34;2005&#34;</span> <span class=se>\</span>
<span class=nt>--tc</span> <span class=s2>&#34;Geript en encoded door Foo&#34;</span> <span class=se>\</span>
<span class=nt>--tg</span> <span class=s2>&#34;Genre&#34;</span> <span class=se>\</span>
audio01.wav audio01.mp3</code></pre></div></div><div class=paragraph><p>192 kbits lijkt de standaard bitrate voor MP3 te zijn. Het is ook mogelijk 128 of 160 of andere bitrates te gebruiken. Hoe hoger de bitrate, hoe meer schijfruimte de uiteindelijke MP3-bestanden gebruiken, maar ook de kwaliteit wordt dan hoger. Met de optie <code>-h</code> wordt de modus "hogere kwaliteit, maar iets langzamer" ingeschakeld. Met de opties vanaf <code>--t</code> worden de ID3 tags ingegeven, die meestal informatie over een nummer bevatten en onderdeel uitmaken van het MP3-bestand. In de hulppagina voor lame staan nog meer opties die gebruikt kunnen worden bij het encoderen beschreven.</p></div></div><div class=sect3><h4 id=mp3-decoding>8.3.4. MP3’s decoderen<a class=anchor href=#mp3-decoding></a></h4><div class=paragraph><p>Om een CD te kunnen branden van MP3’s, moeten ze omgezet worden naar een niet gecomprimeerd WAV-formaat. Zowel XMMS als mpg123 ondersteunen de uitvoer van MP3 naar een niet gecomprimeerd bestandsformaat.</p></div><div class=paragraph><p>Naar schijf schrijven met XMMS:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Start XMMS;</p></li><li><p>Klik rechts op het venster om het XMMS menu te zien;</p></li><li><p>Selecteer <code>Preference</code> onder <code>Options</code>;</p></li><li><p>Wijzig de Output Plugin naar "Disk Writer Plugin";</p></li><li><p>Klik <code>Configure</code>;</p></li><li><p>Voer een map in (of kies "browse") waar de ongecomprimeerde bestanden naar toe geschreven moeten worden;</p></li><li><p>Laad de MP3-bestanden zoals gewoonlijk in XMMS, met het volume op 100% en de EQ instellingen uitgeschakeld;</p></li><li><p>Klik <code>Play</code>. XMMS lijkt nu de MP3 af te spelen, maar er is geen muziek te horen. Nu wordt feitelijk de MP3 afgespeeld naar een bestand;</p></li><li><p>Zorg ervoor dat de standaard Output Plugin wordt teruggezet naar hoe de instellingen waren om weer naar MP3’s te kunnen luisteren.</p></li></ol></div></div></div><div class=paragraph><p>Schrijven naar stdout vanuit mpg123:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Voer <code>mpg123 -s audio01.mp3 > audio01.pcm</code> uit.</p></li></ol></div></div></div><div class=paragraph><p>XMMS schrijft een bestand in het WAV-formaat, terwijl mpg123 de MP3 converteert naar ruwe PCM audio data. Beide formaten kunnen gebruikt worden met cdrecord om audio CD’s te maken. Met <a href="https://man.freebsd.org/cgi/man.cgi?query=burncd&amp;sektion=8&amp;format=html">burncd(8)</a> moeten ruwe PCM-bestanden gebruikt worden. Als er WAV-bestanden worden gebruikt, is er een tikgeluid te horen bij het begin van iedere track. Dit is het geluid van de kop van ieder WAV-bestand. Met het hulpprogramma SoX kan de kop van WAV-bestanden verwijderd worden. Dit programma kan geïnstalleerd worden met de port of pakket <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sox/>audio/sox</a></p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sox <span class=nt>-t</span> wav <span class=nt>-r</span> 44100 <span class=nt>-s</span> <span class=nt>-w</span> <span class=nt>-c</span> 2 track.wav track.raw</code></pre></div></div><div class=paragraph><p>In <a href=./#creating-cds>Optische media (CD’s) aanmaken en gebruiken</a> staat meer informatie over het gebruiken van een CD-brander in FreeBSD.</p></div></div></div><div class=sect2><h3 id=video-playback>8.4. Video afspelen<a class=anchor href=#video-playback></a></h3><div class=paragraph><p>Video afspelen is een relatief nieuwe en zich snel ontwikkelende richting voor applicaties. In tegenstelling tot voor audio werkt alles hier niet zo soepel.</p></div><div class=paragraph><p>Voor er wordt begonnen is het van belang te weten welk model videokaart zich in een systeem bevindt en welke chip die gebruikt. Hoewel Xorg vele videokaarten ondersteunt, zijn er veel minder geschikt om goed video mee af te spelen. Er kan een lijst met ondersteunde extensies getoond worden voor X server met de gebruikte videokaart door het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=xdpyinfo&amp;sektion=1&amp;format=html">xdpyinfo(1)</a> uit te voeren terwijl X11 draait.</p></div><div class=paragraph><p>Het is verstandig een kort MPEG-bestand beschikbaar te hebben dat gebruikt kan worden als testbestand voor het evalueren van de spelers en hun opties. Omdat sommige DVD-spelers standaard zoeken naar DVD media in <span class=filename>/dev/dvd</span> of deze apparaatnaam standaard in de broncode hebben staan, is het wellicht verstandig om een symbolische link te maken naar de juiste apparaten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -sf /dev/acd0 /dev/dvd</span>
<span class=c># ln -sf /dev/acd0 /dev/rdvd</span></code></pre></div></div><div class=paragraph><p>Vanwege de werking van <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a>, blijven handmatig aangemaakte links niet bestaan als een systeem wordt herstart. Om automatisch symbolische links aan te laten maken als een systeem start, kunnen de volgende regels toegevoegd worden aan <span class=filename>/etc/devfs.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>link acd0 dvd
link acd0 rdvd</pre></div></div><div class=paragraph><p>Daarnaast zijn voor het decoderen van DVD, waarvoor bijzondere DVD-ROM functies aangeroepen worden, schrijfrechten op de DVD-apparaten nodig.</p></div><div class=paragraph><p>Om de gedeeld-geheugeninterface van X11 te verbeteren, wordt aangeraden dat een aantal variabelen van <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> worden verhoogd:</p></div><div class="literalblock programlisting"><div class=content><pre>kern.ipc.shmmax=67108864
kern.ipc.shmall=32768</pre></div></div><div class=sect3><h4 id=video-interface>8.4.1. Videomogelijkheden vaststellen<a class=anchor href=#video-interface></a></h4><div class=paragraph><p>Er zijn een aantal methoden om video weer te geven onder X11. Welke echt werkt, is voornamelijk afhankelijk van de gebruikte hardware. Iedere hieronder beschreven methode geeft andere resultaten op andere hardware. De laatste tijd krijgt het renderen van video in X11 veel aandacht en bij iedere versie van Xorg kan er een aanzienlijke verbetering zijn.</p></div><div class=paragraph><p>Een lijst van veel gebruikte video-interfaces:</p></div><div class="olist arabic"><ol class=arabic><li><p>X11: normale X11 uitvoer met gebruikmaking van gedeeld geheugen;</p></li><li><p>XVideo: een uitbreiding op de X11 interface die video in een door X11 getekend object ondersteunt;</p></li><li><p>SDL: de Simple Directmedia Layer;</p></li><li><p>DGA: de Direct Graphics Access;</p></li><li><p>SVGAlib: low level console grafische laag.</p></li></ol></div><div class=sect4><h5 id=video-interface-xvideo>8.4.1.1. XVideo<a class=anchor href=#video-interface-xvideo></a></h5><div class=paragraph><p>Xorg kent een uitbreiding <em>XVideo</em>, ook bekend als Xvideo, Xv of xv, waarmee video direct weergegeven kan worden in getekende objecten door een speciale versneller. Deze uitbreiding geeft een goede afspeelkwaliteit, zelfs op machines met mindere specificaties.</p></div><div class=paragraph><p>Of de uitbreiding actief is, kan gecontroleerd worden met het commando <code>xvinfo</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% xvinfo</code></pre></div></div><div class=paragraph><p>XVideo wordt ondersteund als de uitvoer er ongeveer als volgt uitziet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>X-Video Extension version 2.2
screen <span class=c>#0</span>
  Adaptor <span class=c>#0: &#34;Savage Streams Engine&#34;</span>
    number of ports: 1
    port base: 43
    operations supported: PutImage
    supported visuals:
      depth 16, visualID 0x22
      depth 16, visualID 0x23
    number of attributes: 5
      <span class=s2>&#34;XV_COLORKEY&#34;</span> <span class=o>(</span>range 0 to 16777215<span class=o>)</span>
              client settable attribute
              client gettable attribute <span class=o>(</span>current value is 2110<span class=o>)</span>
      <span class=s2>&#34;XV_BRIGHTNESS&#34;</span> <span class=o>(</span>range <span class=nt>-128</span> to 127<span class=o>)</span>
              client settable attribute
              client gettable attribute <span class=o>(</span>current value is 0<span class=o>)</span>
      <span class=s2>&#34;XV_CONTRAST&#34;</span> <span class=o>(</span>range 0 to 255<span class=o>)</span>
              client settable attribute
              client gettable attribute <span class=o>(</span>current value is 128<span class=o>)</span>
      <span class=s2>&#34;XV_SATURATION&#34;</span> <span class=o>(</span>range 0 to 255<span class=o>)</span>
              client settable attribute
              client gettable attribute <span class=o>(</span>current value is 128<span class=o>)</span>
      <span class=s2>&#34;XV_HUE&#34;</span> <span class=o>(</span>range <span class=nt>-180</span> to 180<span class=o>)</span>
              client settable attribute
              client gettable attribute <span class=o>(</span>current value is 0<span class=o>)</span>
    maximum XvImage size: 1024 x 1024
    Number of image formats: 7
      <span class=nb>id</span>: 0x32595559 <span class=o>(</span>YUY2<span class=o>)</span>
        guid: 59555932-0000-0010-8000-00aa00389b71
        bits per pixel: 16
        number of planes: 1
        <span class=nb>type</span>: YUV <span class=o>(</span>packed<span class=o>)</span>
      <span class=nb>id</span>: 0x32315659 <span class=o>(</span>YV12<span class=o>)</span>
        guid: 59563132-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        <span class=nb>type</span>: YUV <span class=o>(</span>planar<span class=o>)</span>
      <span class=nb>id</span>: 0x30323449 <span class=o>(</span>I420<span class=o>)</span>
        guid: 49343230-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        <span class=nb>type</span>: YUV <span class=o>(</span>planar<span class=o>)</span>
      <span class=nb>id</span>: 0x36315652 <span class=o>(</span>RV16<span class=o>)</span>
        guid: 52563135-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        <span class=nb>type</span>: RGB <span class=o>(</span>packed<span class=o>)</span>
        depth: 0
        red, green, blue masks: 0x1f, 0x3e0, 0x7c00
      <span class=nb>id</span>: 0x35315652 <span class=o>(</span>RV15<span class=o>)</span>
        guid: 52563136-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        <span class=nb>type</span>: RGB <span class=o>(</span>packed<span class=o>)</span>
        depth: 0
        red, green, blue masks: 0x1f, 0x7e0, 0xf800
      <span class=nb>id</span>: 0x31313259 <span class=o>(</span>Y211<span class=o>)</span>
        guid: 59323131-0000-0010-8000-00aa00389b71
        bits per pixel: 6
        number of planes: 3
        <span class=nb>type</span>: YUV <span class=o>(</span>packed<span class=o>)</span>
      <span class=nb>id</span>: 0x0
        guid: 00000000-0000-0000-0000-000000000000
        bits per pixel: 0
        number of planes: 0
        <span class=nb>type</span>: RGB <span class=o>(</span>packed<span class=o>)</span>
        depth: 1
        red, green, blue masks: 0x0, 0x0, 0x0</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige van de weergegeven formaten (YUV2, YUV12, enzovoort) zijn niet in iedere implementaties van XVideo beschikbaar en hun afwezigheid kan sommige spelers hinderen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als het resultaat er als hieronder uitziet, is er geen ondersteuning voor XVideo aanwezig op de videokaart in een systeem:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>X-Video Extension version 2.2
screen <span class=c>#0</span>
no adaptors present</code></pre></div></div><div class=paragraph><p>Als XVideo voor een kaart niet wordt ondersteund, dan betekent dat alleen dat het lastiger wordt om op een beeldscherm aan de vereisten voor het renderen van video te voldoen. Afhankelijk van de videokaart en de processor kan het toch nog mogelijk zijn om acceptabele prestaties neer te zetten. In <a href=#video-further-reading>Verder lezen</a> staan verwijzingen naar leesvoer over mogelijkheden voor het verbeteren van prestaties.</p></div></div><div class=sect4><h5 id=video-interface-SDL>8.4.1.2. Eenvoudige Directmedia Laag<a class=anchor href=#video-interface-SDL></a></h5><div class=paragraph><p>De Eenvoudige Directmedia Laag (Simple Directmedia Layer), SDL, is een porting-laag voor vele besturingssystemen waardoor cross-platform toepassingen kunnen worden ontwikkeld die efficiënt gebruik maken van geluid en beelden. De SDL laag biedt een abstractie op laag niveau naar de hardware die soms efficiënter kan zijn dan de X11 interface.</p></div><div class=paragraph><p>De SDL staat in <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl12/>devel/sdl12</a>.</p></div></div><div class=sect4><h5 id=video-interface-DGA>8.4.1.3. Directe Grafische Toegang<a class=anchor href=#video-interface-DGA></a></h5><div class=paragraph><p>Directe Grafische Toegang (Direct Graphics Access) is een X11 uitbreiding die een programma in staat stelt voorbij te gaan aan de X server en de framebuffer direct kan wijzigen. Omdat hij afhankelijk is van geheugenmapping op een laag niveau om dit delen uit te voeren, moeten programma’s die er gebruik van maken als <code>root</code> draaien.</p></div><div class=paragraph><p>De DGA uitbreiding kan getest en gebenchmarkt worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=dga&amp;sektion=1&amp;format=html">dga(1)</a>. Als <code>dga</code> draait, verandert het de kleuren op een scherm als er een toets wordt ingedrukt. Om te stoppen kan de toets <kbd>q</kbd> gebruikt worden.</p></div></div></div><div class=sect3><h4 id=video-ports>8.4.2. Ports en pakketten met video<a class=anchor href=#video-ports></a></h4><div class=paragraph><p>In dit onderdeel wordt de software die vanuit de FreeBSD Portscollectie beschikbaar is voor het afspelen van video beschreven. Het afspelen van video is een tak van softwareontwikkeling die erg in beweging is en de mogelijkheden van de verschillende applicaties verschillen zeer waarschijnlijk van wat hier is beschreven.</p></div><div class=paragraph><p>Als eerste is het belangrijk om te weten dat veel applicaties die met video te maken hebben en op FreeBSD draaien ontwikkeld zijn als Linux® applicaties. Veel van die applicaties zijn op het moment van schrijven van beta-kwaliteit. Problemen die te verwachten zijn bij het gebruik van de beschreven videopakketten op FreeBSD zijn:</p></div><div class="olist arabic"><ol class=arabic><li><p>Een applicatie kan geen bestanden afspelen die zijn gemaakt met een andere applicatie;</p></li><li><p>Een applicatie kan geen bestanden afspelen die met de applicatie zelf zijn gemaakt;</p></li><li><p>Dezelfde applicatie, op twee verschillende machines gebouwd, speelt hetzelfde bestand op twee machines anders af;</p></li><li><p>Een ogenschijnlijk triviale filter, zoals het herschalen van beeldgrootte, kan resulteren in vreselijk vervelende artefacten door fouten in de routine voor het herschalen;</p></li><li><p>Een applicatie dumpt zijn core regelmatig;</p></li><li><p>Documentatie wordt niet geïnstalleerd bij de port en staat op het web of in de map <span class=filename>work</span> van de port.</p></li></ol></div><div class=paragraph><p>Veel van deze applicaties kunnen ook "Linux-ismes" vertonen. Zo kunnen er bijvoorbeeld problemen ontstaan door de wijze waarop standaard bibliotheken zijn geïmplementeerd in de Linux® distributies of een aantal van de mogelijkheden van de Linux®-kernel, waarvan door de makers van de applicatie wordt aangenomen dat ze aanwezig zijn. Dit soort problemen zijn niet altijd zichtbaar en er wordt ook omheen gewerkt door de beheerders van ports, wat tot de volgende mogelijke problemen kan leiden:</p></div><div class="olist arabic"><ol class=arabic><li><p>Het gebruik van <span class=filename>/proc/cpuinfo</span> om processorkarakteristieken uit te lezen;</p></li><li><p>Het verkeerd gebruiken van threads, waardoor een programma hangt als het klaar is, in plaats van dat het echt eindigt;</p></li><li><p>Software die nog niet in de FreeBSD Portscollectie zit en vaak gebruikt wordt samen met een applicatie die daar wel onderdeel van uitmaakt.</p></li></ol></div><div class=paragraph><p>Tot nu toe is gebleken dat de ontwikkelaars van applicaties wel coöperatief waren met de beheerders van ports om zo het aantal work-arounds dat nodig was voor het overzetten tot een minimum te beperken.</p></div><div class=sect4><h5 id=video-mplayer>8.4.2.1. MPlayer<a class=anchor href=#video-mplayer></a></h5><div class=paragraph><p>MPlayer is een zich snel ontwikkelende videospeler. De doelen van het MPlayer-team zijn snelheid en flexibiliteit onder Linux® en andere Unices. Het project is gestart toen de oprichter van het team genoeg had van de slechte afspeelprestaties van de destijds beschikbare spelers. Er zijn mensen die zeggen dat het grafische ontwerp is opgeofferd voor het stroomlijnen van het ontwerp, maar het blijkt dat, als een gebruiker gewend is aan de commandoregelopties en de toetsencommando’s, de applicatie erg goed werkt.</p></div><div class=sect5><h6 id=video-mplayer-building>8.4.2.1.1. MPlayer bouwen<a class=anchor href=#video-mplayer-building></a></h6><div class=paragraph><p>MPlayer staat in <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/mplayer/>multimedia/mplayer</a>. MPlayer voert een aantal hardwarecontroles uit tijdens het bouwen, wat resulteert in een binair bestand dat niet van het ene naar het andere systeem verplaatst kan worden. Daarom is het van belang dat het uit de ports wordt gebouwd en niet als binair pakket wordt geïnstalleerd. Daarnaast staan er ook nog opties die vanaf de <code>make</code> commandoregel meegegeven kunnen worden beschreven in de <span class=filename>Makefile</span> en aan het begin van de build:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/multimedia/mplayer</span>
<span class=c># make</span>
N - O - T - E

Take a careful look into the Makefile <span class=k>in </span>order
to learn how to tune mplayer towards you personal preferences!
For example,
make WITH_GTK1
builds MPlayer with GTK1-GUI support.
If you want to use the GUI, you can either <span class=nb>install</span>
/usr/ports/multimedia/mplayer-skins
or download official skin collections from
http://www.mplayerhq.hu/homepage/dload.html</code></pre></div></div><div class=paragraph><p>De standaard portopties zijn voor de meeste gebruikers voldoende. Maar als bijvoorbeeld de XviD codec nodig is, dan moet de optie <code>WITH_XVID</code> op de commandoregel meegegeven worden. Het standaard DVD-apparaat kan ook gedefinieerd worden met de optie <code>WITH_DVD_DEVICE</code>, waarbij standaard <span class=filename>/dev/acd0</span> wordt gebruikt.</p></div><div class=paragraph><p>Op het moment van schrijven wordt de MPlayer port gebouwd met de HTML documentatie en twee uitvoerbare bestanden, <code>mplayer</code> en <code>mencoder</code>, wat een hulpmiddel is voor het opnieuw encoderen van video.</p></div><div class=paragraph><p>De HTML documentatie voor MPlayer is erg informatief. Als de lezer vindt dat er informatie over videohardware en interfaces in dit hoofdstuk mist, dan is de documentatie van MPlayer een zeer grondige aanvulling. Het is de moeite waard de tijd te nemen om de documentatie van MPlayer te lezen, als meer informatie over de ondersteuning van video in UNIX® welkom is.</p></div></div><div class=sect5><h6 id=video-mplayer-using>8.4.2.1.2. MPlayer gebruiken<a class=anchor href=#video-mplayer-using></a></h6><div class=paragraph><p>Iedere gebruiker van MPlayer dient een submap <span class=filename>.mplayer</span> in zijn thuismap te hebben. Die kan als volgt gemaakt worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cd</span> /usr/ports/multimedia/mplayer
% make install-user</code></pre></div></div><div class=paragraph><p>De commando-opties voor <code>mplayer</code> staan in de hulppagina. Nog meer details staan in de HTML documentatie. In dit onderdeel worden slechts een aantal gebruiksmogelijkheden beschreven.</p></div><div class=paragraph><p>Om een bestand als <span class=filename>testbestand.avi</span> af te spelen met een van de beschikbare video-interfaces, kan de optie <code>-vo</code> gebruikt worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mplayer <span class=nt>-vo</span> xv testbestand.avi</code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mplayer <span class=nt>-vo</span> sdl testbestand.avi</code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mplayer <span class=nt>-vo</span> x11 testbestand.avi</code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mplayer -vo dga testbestand.avi</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mplayer -vo &#39;sdl:dga&#39; testbestand.avi</span></code></pre></div></div><div class=paragraph><p>Het is de moeite waard alle bovenstaande opties uit te proberen omdat hun relatieve prestatie afhangt van vele factoren die aanzienlijk verschillen tussen hardware.</p></div><div class=paragraph><p>Om een DVD af te spelen dient <span class=filename>testbestand.avi</span> vervangen te worden door <code>dvd://<em>N</em> -dvd-device <em>APPARAAT</em></code> waar <em>N</em> het titelnummer is dat afgespeeld moeten worden en <span class=filename>APPARAAT</span> het apparaatknooppunt is voor de DVD-ROM. Om bijvoorbeeld titel 3 van <span class=filename>/dev/dvd</span> af te spelen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mplayer -vo xv dvd://3 -dvd-device /dev/dvd</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het standaard DVD-apparaat kan ingesteld worden bij het bouwen van de MPlayer port met de optie <code>WITH_DVD_DEVICE</code>. Standaard is dit apparaat <span class=filename>/dev/acd0</span>. Meer details staan in de <span class=filename>Makefile</span> van de port.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om te stoppen, pauzeren, verder te spoelen, enzovoort, kunnen de toetsendefinities gebruikt worden, die in te zien zijn door <code>mplayer -h</code> uit te voeren of de hulppagina te lezen.</p></div><div class=paragraph><p>Overige belangrijke opties voor het afspelen zijn: <code>-fs -zoom</code>, waarmee het volledige scherm wordt gebruikt, en <code>-framedrop</code>, die prestatieverhogend werkt.</p></div><div class=paragraph><p>Om ervoor te zorgen dat de commandoregels niet te lang worden, kan het bestand <span class=filename>.mplayer/config</span> met voorkeursinstellingen gemaakt worden:</p></div><div class="literalblock programlisting"><div class=content><pre>vo=xv
fs=yes
zoom=yes</pre></div></div><div class=paragraph><p>Tenslotte kan <code>mplayer</code> gebruikt worden om een DVD naar een bestand van het type <span class=filename>.vob</span> te rippen. Om de tweede titel van een DVD de dumpen kan het volgende commando gebruikt worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mplayer -dumpstream -dumpfile out.vob dvd://2 -dvd-device /dev/dvd</span></code></pre></div></div><div class=paragraph><p>Het uitvoerbestand <span class=filename>out.vob</span>, is van het type MPEG en kan bewerkt worden met andere in dit onderdeel besproken programma’s.</p></div></div><div class=sect5><h6 id=video-mencoder>8.4.2.1.3. <code>mencoder</code><a class=anchor href=#video-mencoder></a></h6><div class=paragraph><p>Voordat <code>mencoder</code> wordt gebruikt, is het verstandig de opties uit de HTML-documentatie te bekijken. Er is een hulppagina, maar die is niet echt bruikbaar zonder de HTML-documentatie. Er zijn ontelbare mogelijkheden om de kwaliteit te verhogen, de bitrate te verlagen en formaten te wijzigen en een aantal van die truuks maken het verschil tussen goede en slechte prestaties. Hieronder staan een aantal voorbeelden beschreven. Eerst een eenvoudige kopie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mencoder invoer.avi <span class=nt>-oac</span> copy <span class=nt>-ovc</span> copy <span class=nt>-o</span> uitvoer.avi</code></pre></div></div><div class=paragraph><p>Verkeerde combinaties van commandoregelopties kunnen resulteren in uitvoerbestanden die zelfs niet af te spelen zijn door <code>mplayer</code>. Daarom wordt aangeraden om het bij de optie <code>-dumpfile</code> in <code>mplayer</code> te houden als het alleen maar nodig is een bestand te rippen.</p></div><div class=paragraph><p>Om <span class=filename>invoer.avi</span> te converteren naar de MPEG4-codec met MPEG3-audio encodering (<a class=package href=https://cgit.freebsd.org/ports/tree/audio/lame/>audio/lame</a> is verplicht):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mencoder invoer.avi <span class=nt>-oac</span> mp3lame <span class=nt>-lameopts</span> <span class=nv>br</span><span class=o>=</span>192 <span class=se>\</span>
<span class=nt>-ovc</span> lavc <span class=nt>-lavcopts</span> <span class=nv>vcodec</span><span class=o>=</span>mpeg4:vhq <span class=nt>-o</span> utvoer.avi</code></pre></div></div><div class=paragraph><p>Hiermee wordt uitvoer gemaakt die af te spelen is met <code>mplayer</code> en <code>xine</code>.</p></div><div class=paragraph><p><span class=filename>invoer.avi</span> kan worden vervangen door <code>dvd://1 -dvd-device /dev/dvd</code> en als <code>root</code> gedraaid worden om een DVD-titel direct te hercoderen. Omdat het waarschijnlijk is dat de eerste experimenten niet direct tevredenstellend zijn, wordt aangeraden een titel eerst naar een bestand te dumpen en dat als werkbestand te gebruiken.</p></div></div></div><div class=sect4><h5 id=video-xine>8.4.2.2. xine videospeler<a class=anchor href=#video-xine></a></h5><div class=paragraph><p>De xine videospeler is een project met een brede scope, dat niet alleen tracht een allesomvattende video-oplossing te bieden, maar ook probeert een herbruikbare basisbibliotheek en een modulair uitvoerbaar bestand te maken dat uitgebreid kan worden met plug-ins. Het kan als pakket en port geïnstalleerd worden uit <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/xine/>multimedia/xine</a>.</p></div><div class=paragraph><p>De xine speler heeft nog wat ruwe randjes, maar is zeker goed van start gegaan. In de praktijk heeft xine een snelle CPU met een snelle videokaart of ondersteuning voor de XVideo extensie nodig. De GUI is bruikbaar, maar wat onhandig.</p></div><div class=paragraph><p>Op het moment van schrijven wordt er geen invoermodule bij xine geleverd waarmee CSS gecodeerde DVD’s afgespeeld kunnen worden. Er zijn er die door andere partijen zijn gebouwd die dat type modules wel hebben, maar die zijn niet beschikbaar in de FreeBSD Portscollectie.</p></div><div class=paragraph><p>Vergeleken met MPlayer, doet xine meer voor de gebruiker, maar tegelijkertijd neemt het wat van de fijnafstellingsmogelijkheden weg. De videospeler xine werkt het beste op XVideo-interfaces.</p></div><div class=paragraph><p>Standaard start de xine speler op in een grafische gebruikersinterface. Via het menu kan een specifiek bestand geopend worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% xine</code></pre></div></div><div class=paragraph><p>Het is ook mogelijk om zonder de GUI direct een bestand af te laten spelen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% xine <span class=nt>-g</span> <span class=nt>-p</span> mijnfilm.avi</code></pre></div></div></div><div class=sect4><h5 id=video-ports-transcode>8.4.2.3. transcode hulpprogramma’s<a class=anchor href=#video-ports-transcode></a></h5><div class=paragraph><p>De software transcode is geen speler, maar een verzameling hulpprogramma’s voor het hercoderen van video- en audiobestanden. Met transcode wordt het mogelijk om videobestanden samen te voegen, kapotte bestanden te repareren en commandoregelprogramma’s te gebruiken met <span class=filename>stdin/stdout</span> stream interfaces.</p></div><div class=paragraph><p>Tijdens het bouwen van de port <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/transcode/>multimedia/transcode</a> kan een groot aantal opties opgegeven worden en de volgende commandoregel wordt geadviseerd om transcode te bouwen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make WITH_OPTIMIZED_CFLAGS=yes WITH_LIBA52=yes WITH_LAME=yes WITH_OGG=yes \</span>
<span class=nv>WITH_MJPEG</span><span class=o>=</span><span class=nb>yes</span> <span class=nt>-DWITH_XVID</span><span class=o>=</span><span class=nb>yes</span></code></pre></div></div><div class=paragraph><p>De geadviseerde instellingen zijn toereikend voor de meeste gebruikers.</p></div><div class=paragraph><p>Om de mogelijkheden van <code>transcode</code> te illustreren volgt nu een voorbeeld van hoe een DivX-bestand om te zetten in een PAL MPEG-1-bestand (PAL VCD):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% transcode <span class=nt>-i</span> invoer.avi <span class=nt>-V</span> <span class=nt>--export_prof</span> vcd-pal <span class=nt>-o</span> uitvoer_vcd
% mplex <span class=nt>-f</span> 1 <span class=nt>-o</span> uitvoer_vcd.mpg uitvoer_vcd.m1v uitvoer_vcd.mpa</code></pre></div></div><div class=paragraph><p>Het resulterende MPEG-bestand, <span class=filename>uitvoer_vcd.mpg</span>, is klaar om afgespeeld te worden met MPlayer. Het kan ook op een CD-R gebrand worden om er een Video-CD mee te maken. In dat geval is het nodig om de programma’s <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/vcdimager/>multimedia/vcdimager</a> en <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrdao/>sysutils/cdrdao</a> te installeren.</p></div><div class=paragraph><p>Er is een hulppagina voor <code>transcode</code>, maar kijk ook op <a href=http://www.transcoding.org/cgi-bin/transcode>transcode wiki</a> voor meer informatie en voorbeelden.</p></div><div class=paragraph><p>Als de twee vergeleken worden, draait <code>transcode</code> aanzienlijk langzamer dan <code>mencoder</code>, maar is de kans wel groter dat er een bestand uit komt dat op de meeste spelers afgespeeld kan worden. MPEG-bestanden die met <code>transcode</code> zijn gemaakt, zijn bijvoorbeeld al afgespeeld op Windows Media® Player en Apple’s Quicktime®.</p></div></div></div><div class=sect3><h4 id=video-further-reading>8.4.3. Verder lezen<a class=anchor href=#video-further-reading></a></h4><div class=paragraph><p>De beschikbare videosoftware pakketten voor FreeBSD zijn fors in ontwikkeling. Het is goed mogelijk dat in de nabije toekomst de meeste problemen die hier aan de kaak zijn gesteld, zijn opgelost. Intussen kunnen zij die het hoogst haalbare uit de A/V mogelijkheden voor FreeBSD willen halen, dat het beste doen door wat beschikbaar is bij elkaar te scharrelen uit de beschikbare FAQ’s and tutorials en meerdere programma’s gebruiken. Het doel van deze paragraaf is de lezer wat richting te geven op dat vlak.</p></div><div class=paragraph><p>De <a href=http://www.mplayerhq.hu/DOCS/>MPlayer documentatie</a> is technisch erg informatief. Deze documenten kunnen het beste bekeken worden door iemand die veel kennis wil opdoen over video in UNIX®. Op de MPlayer mailinglijst wordt het niet op prijs gesteld als iemand de documentatie niet heeft gelezen, dus het is verstandig RTFM in gedachten te houden alvorens bug rapportages naar ze te mailen.</p></div><div class=paragraph><p>De <a href=http://dvd.sourceforge.net/xine-howto/en_GB/html/howto.html>xine HOWTO</a> bevat een hoofdstuk over het verbeteren van prestaties, dat op alle spelers van toepassing is.</p></div><div class=paragraph><p>Tenslotte zijn er nog een aantal veelbelovende applicaties die het proberen waard zijn:</p></div><div class=ulist><ul><li><p><a href=http://avifile.sourceforge.net/>Avifile</a> bestaat ook als port: <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/avifile/>multimedia/avifile</a>;</p></li><li><p><a href=http://www.dtek.chalmers.se/groups/dvd/>Ogle</a> is er ook als port: <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/ogle/>multimedia/ogle</a>;</p></li><li><p><a href=http://xtheater.sourceforge.net/>Xtheater</a>;</p></li><li><p><a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/dvdauthor/>multimedia/dvdauthor</a>, een open source pakket voor authoring van DVD content.</p></li></ul></div></div></div><div class=sect2><h3 id=tvcard>8.5. TV-kaarten installeren<a class=anchor href=#tvcard></a></h3><div class=sect3><h4 id=_inleiding>8.5.1. Inleiding<a class=anchor href=#_inleiding></a></h4><div class=paragraph><p>Met TV-kaarten is het mogelijk om naar (kabel)uitzendingen te kijken op een computer. Op de meeste kaarten kan composiet video aangeleverd worden via een RCA of S-video input en sommige kaarten hebben ook een FM tuner.</p></div><div class=paragraph><p>FreeBSD biedt ondersteuning voor PCI-gebaseerde TV-kaarten met een Brooktree Bt848/849/878/879 of een Conexant CN-878/Fusion 878a Video Capture Chip met het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=bktr&amp;sektion=4&amp;format=html">bktr(4)</a>. Het is van belang dat er op de kaart ook een ondersteunde tuner zit. Hiervoor kan <a href="https://man.freebsd.org/cgi/man.cgi?query=bktr&amp;sektion=4&amp;format=html">bktr(4)</a> geraadpleegd worden, waarin een lijst met ondersteunde tuners staat.</p></div></div><div class=sect3><h4 id=_stuurprogramma_toevoegen>8.5.2. Stuurprogramma toevoegen<a class=anchor href=#_stuurprogramma_toevoegen></a></h4><div class=paragraph><p>Voordat de kaart gebruikt kan worden, dient het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=bktr&amp;sektion=4&amp;format=html">bktr(4)</a> geladen te worden. Dit kan door de volgende regel aan <span class=filename>/boot/loader.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>bktr_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Daarnaast is het ook mogelijk om statisch ondersteuning voor de TV-kaart in de kernel te compileren. Dan dient de volgende regel toegevoegd te worden aan de kernelinstellingen:</p></div><div class="literalblock programlisting"><div class=content><pre>device	 bktr
device	iicbus
device	iicbb
device	smbus</pre></div></div><div class=paragraph><p>De extra stuurprogramma’s zijn nodig omdat de kaartcomponenten verbonden zijn via een I2C bus. Met deze instellingen kan een nieuwe kernel gebouwd en geïnstalleerd worden.</p></div><div class=paragraph><p>Als een systeem eenmaal ondersteuning biedt, hoort de TV-kaart ongeveer als volgt bij een herstart getoond te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>bktr0: &lt;BrookTree 848A&gt; mem 0xd7000000-0xd7000fff irq 10 at device 10.0 on pci0
iicbb0: &lt;I2C bit-banging driver&gt; on bti2c0
iicbus0: &lt;Philips I2C bus&gt; on iicbb0 master-only
iicbus1: &lt;Philips I2C bus&gt; on iicbb0 master-only
smbus0: &lt;System Management Bus&gt; on bti2c0
bktr0: Pinnacle/Miro TV, Philips SECAM tuner.</pre></div></div><div class=paragraph><p>Deze berichten kunnen afwijken, afhankelijk van de gebruikte hardware. Het is van belang te controleren of de tuner juist herkend wordt; er kunnen nog een aantal instellingen gemaakt worden voor parameters met <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> MIB’s en in het kernelinstellingenbestand. Om bijvoorbeeld het gebruik van een Philips SECAM tuner te forceren, kan de volgende regel aan het bestand met kernelinstellingen worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>options OVERRIDE_TUNER=6</pre></div></div><div class=paragraph><p>Dit kan ook via een instelling van <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl hw.bt848.tuner=6</span></code></pre></div></div><div class=paragraph><p>In de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=bktr&amp;sektion=4&amp;format=html">bktr(4)</a> en <span class=filename>/usr/src/sys/conf/NOTES</span> staan meer details over de beschikbare opties.</p></div></div><div class=sect3><h4 id=_handige_programmas>8.5.3. Handige programma’s<a class=anchor href=#_handige_programmas></a></h4><div class=paragraph><p>Om een TV-kaart te gebruiken, dient een van de volgende applicaties geïnstalleerd te worden:</p></div><div class=ulist><ul><li><p><a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/fxtv/>multimedia/fxtv</a> biedt TV-in-een-window en beeld/audio/videocapture mogelijkheden;</p></li><li><p><a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/xawtv/>multimedia/xawtv</a> is ook een TV applicatie met dezelfde mogelijkheden als fxtv;</p></li><li><p><a class=package href=https://cgit.freebsd.org/ports/tree/misc/alevt/>misc/alevt</a> decodeert Videotext/Teletext en kan deze weergeven;</p></li><li><p><a class=package href=https://cgit.freebsd.org/ports/tree/audio/xmradio/>audio/xmradio</a>, een applicatie om de FM-tuner die bij sommige TV-kaarten zit te gebruiken;</p></li><li><p><a class=package href=https://cgit.freebsd.org/ports/tree/audio/wmtune/>audio/wmtune</a>, een handige bureaubladapplicatie voor radiotuners.</p></li></ul></div><div class=paragraph><p>Er zijn nog meer applicaties beschikbaar in de Portscollectie.</p></div></div><div class=sect3><h4 id=_problemen_oplossen>8.5.4. Problemen oplossen<a class=anchor href=#_problemen_oplossen></a></h4><div class=paragraph><p>Bij problemen met een TV-kaart dient eerst gecontroleerd te worden of de videocapture chip en de tuner echt ondersteund worden door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=bktr&amp;sektion=4&amp;format=html">bktr(4)</a> en of de juiste instellingen worden gebruikt. Voor meer ondersteuning en vragen over een specifieke TV-kaart is het aan te raden de archieven van de <a href=https://lists.FreeBSD.org/subscription/freebsd-multimedia>FreeBSD multimedia mailinglijst</a> mailinglijst te raadplegen of er contact mee op te nemen.</p></div></div></div><div class=sect2><h3 id=mythtv>8.6. MythTV<a class=anchor href=#mythtv></a></h3><div class=paragraph><p>MythTV is een open-source PVR software project.</p></div><div class=paragraph><p>Het staat in de Linux®-wereld bekend als een complexe toepassing met veel afhankelijkheden, en daarom moeilijk om te installeren. De Portscollectie van FreeBSD versimpelt veel van het proces, maar sommige componenten moeten handmatig worden geïnstalleerd. Deze sectie is bedoeld om te helpen en te begeleiden in het installeren van MythTV.</p></div><div class=sect3><h4 id=_hardware>8.6.1. Hardware<a class=anchor href=#_hardware></a></h4><div class=paragraph><p>MythTV is ontworpen om V4L te gebruiken om invoerapparatuur voor video zoals encoders en tuners te benaderen. Momenteel werkt MythTV het beste met USB DVB-S/C/T kaarten die ondersteund worden door <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/webcamd/>multimedia/webcamd</a> omdat webcamd een gebruikerstoepassing levert voor V4L. Elke DVB-kaart die ondersteund wordt door webcamd zou met MythTV moeten werken, een lijst van kaarten waarvan hun werking bekend is kan <a href=http://wiki.freebsd.org/WebcamCompat>hier</a> gevonden worden. Er zijn ook stuurprogramma’s bekend voor Hauppauge-kaarten in de pakketten <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/pvr250/>multimedia/pvr250</a> en <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/pvrxxx/>multimedia/pvrxxx</a>, maar deze leveren een niet-standaard interface met hun stuurprogramma dat niet werkt met versies van MythTV nieuwer dan 0.23.</p></div><div class=paragraph><p><a href=http://wiki.freebsd.org/HTPC>HTPC</a> bevat een lijst van alle beschikbare stuurprogramma’s voor DVB.</p></div></div><div class=sect3><h4 id=_afhankelijkheden>8.6.2. Afhankelijkheden<a class=anchor href=#_afhankelijkheden></a></h4><div class=paragraph><p>Doordat MythTV flexibel en modulair is, staat het de gebruiker toe om de voorkant en de achterkant op verschillende machines te hebben.</p></div><div class=paragraph><p>Voor de voorkant is <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/mythtv-frontend/>multimedia/mythtv-frontend</a> nodig, alsook een X-server welke in <a class=package href=https://cgit.freebsd.org/ports/tree/x11/xorg/>x11/xorg</a> beschikbaar is. Idealiter beschikt de voorkant-computer ook over een videokaart die XvMC ondersteunt en optioneel over een afstandsbediening die compatibel is met LIRC.</p></div><div class=paragraph><p>Voor de achterkant is <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/mythtv/>multimedia/mythtv</a> nodig, alsook een MySQL™ database en optioneel een tuner en opslag voor opnames. Het MySQL™ pakket zou automatisch als een afhankelijkheid geïnstalleerd moeten worden tijdens de installatie van <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/mythtv/>multimedia/mythtv</a>.</p></div></div><div class=sect3><h4 id=_mythtv_installeren>8.6.3. MythTV installeren<a class=anchor href=#_mythtv_installeren></a></h4><div class=paragraph><p>Gebruik de volgende stappen om MythTV te installeren. Installeer als eerste MythTV van de FreeBSD Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/multimedia/mythtv</span>
<span class=c># make install</span></code></pre></div></div><div class=paragraph><p>Installeer de database voor MythTV:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mysql -uroot -p &lt; /usr/local/shared/mythtv/database/mc.sql</span></code></pre></div></div><div class=paragraph><p>Configureer de achterkant:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mythtv-setup</span></code></pre></div></div><div class=paragraph><p>Start de achterkant:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;mythbackend_enable=&#34;YES&#34;&#39; &gt;&gt; /etc/rc.conf</span>
<span class=c># service mythbackend start</span></code></pre></div></div></div></div><div class=sect2><h3 id=scanners>8.7. Scanners<a class=anchor href=#scanners></a></h3><div class=sect3><h4 id=_inleiding_2>8.7.1. Inleiding<a class=anchor href=#_inleiding_2></a></h4><div class=paragraph><p>In FreeBSD is toegang tot scanners mogelijk met SANE (Scanner Access Now Easy) API uit de FreeBSD Portscollectie. SANE gebruikt ook een aantal FreeBSD apparaatstuurprogramma’s om toegang te krijgen tot de hardware van de scanner.</p></div><div class=paragraph><p>FreeBSD ondersteunt SCSI en USB scanners. Het is van belang te controleren of een scanner door SANE wordt ondersteund voordat er instellingen worden gemaakt. SANE heeft een lijst met <a href=http://www.sane-project.org/sane-supported-devices.html>ondersteunde apparaten</a> waarin gekeken kan worden of een scanner wordt ondersteund en wat de status voor ondersteuning is.</p></div></div><div class=sect3><h4 id=_kernel_instellen>8.7.2. Kernel instellen<a class=anchor href=#_kernel_instellen></a></h4><div class=paragraph><p>Zoals hierboven al is aangegeven, worden zowel SCSI als USB-scanners ondersteund. Afhankelijk van de gebruikte scannerinterface zijn verschillende apparaatstuurprogramma’s nodig.</p></div><div class=sect4><h5 id=scanners-kernel-usb>8.7.2.1. USB-interface<a class=anchor href=#scanners-kernel-usb></a></h5><div class=paragraph><p>In de <span class=filename>GENERIC</span> kernel zitten standaard de apparaatstuurprogramma’s die nodig zijn voor ondersteuning van USB-scanners. In het geval wordt besloten tot het maken van een aangepaste kernel, dan dienen de volgende regels in het kernelinstellingenbestand te worden opgenomen:</p></div><div class="literalblock programlisting"><div class=content><pre>device usb
device uhci
device ohci
device uscanner
device ehci</pre></div></div><div class=paragraph><p>Na een herstart met de juiste kernel kan de USB-scanner aangesloten worden. Een regel die de detectie van uw scanner aangeeft zou in de berichtenbuffer van het systeem (<a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a>) moeten verschijnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ugen0.2: &lt;EPSON&gt; at usbus0</code></pre></div></div><div class=paragraph><p>Deze berichten geven aan dat de scanner <span class=filename>/dev/ugen0.2</span> als apparaatknooppunt gebruikt. Voor dit voorbeeld was een EPSON Perfection® 1650 USB-scanner gebruikt.</p></div></div><div class=sect4><h5 id=_scsi_interface>8.7.2.2. SCSI interface<a class=anchor href=#_scsi_interface></a></h5><div class=paragraph><p>Als een scanner een SCSI interface heeft, is het belangrijk te weten welk SCSI controllerbord gebruikt gaat worden. Afhankelijk van de gebruikte SCSI chipset, dient het bestand met kernelinstellingen aangepast te worden. De <span class=filename>GENERIC</span> kernel ondersteunt de meest voorkomende SCSI controllers. In het bestand <span class=filename>NOTES</span> is de juiste instelling te vinden die toegevoegd moet worden aan het bestand met kernelinstellingen. Naast het toevoegen van het juiste SCSI-adapter stuurprogramma, dienen ook de volgende regels opgenomen te worden in het kernelinstellingenbestand:</p></div><div class="literalblock programlisting"><div class=content><pre>device scbus
device pass</pre></div></div><div class=paragraph><p>Als de kernel juist gecompileerd en geïnstalleerd is, horen de apparaten tijdens het opstarten zichtbaar te zijn in de systeemberichtbuffer:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>pass2 at aic0 bus 0 target 2 lun 0
pass2: &lt;AGFA SNAPSCAN 600 1.10&gt; Fixed Scanner SCSI-2 device
pass2: 3.300MB/s transfers</code></pre></div></div><div class=paragraph><p>Als een scanner niet aan staat tijdens het opstarten, is het nog mogelijk handmatig detectie te forceren door de SCSI-bus te laten scannen met <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol rescan all</span>
Re-scan of bus 0 was successful
Re-scan of bus 1 was successful
Re-scan of bus 2 was successful
Re-scan of bus 3 was successful</code></pre></div></div><div class=paragraph><p>In het bovenstaande geval zal de scanner ongeveer als volgt verschijnen in de lijst met SCSI-apparaten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;IBM DDRS-34560 S97B&gt;              at scbus0 target 5 lun 0 <span class=o>(</span>pass0,da0<span class=o>)</span>
&lt;IBM DDRS-34560 S97B&gt;              at scbus0 target 6 lun 0 <span class=o>(</span>pass1,da1<span class=o>)</span>
&lt;AGFA SNAPSCAN 600 1.10&gt;           at scbus1 target 2 lun 0 <span class=o>(</span>pass3<span class=o>)</span>
&lt;PHILIPS CDD3610 CD-R/RW 1.00&gt;     at scbus2 target 0 lun 0 <span class=o>(</span>pass2,cd0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Meer details over SCSI-apparaten staan in de hulppagina’s voor <a href="https://man.freebsd.org/cgi/man.cgi?query=scsi&amp;sektion=4&amp;format=html">scsi(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a>.</p></div></div></div><div class=sect3><h4 id=_sane_instellen>8.7.3. SANE instellen<a class=anchor href=#_sane_instellen></a></h4><div class=paragraph><p>Het SANE systeem is opgesplitst in twee delen: de backends (<a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sane-backends/>graphics/sane-backends</a>) en de frontends (<a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sane-frontends/>graphics/sane-frontends</a>). Het deel met de backends zorgt voor de toegang tot de scanner zelf. In de lijst met door SANE <a href=http://www.sane-project.org/sane-supported-devices.html>ondersteunde apparaten</a> staat welk backend welke scanner(s) ondersteunt. Het is echt nodig het juiste backend vast te stellen, omdat het anders bijzonder lastig wordt een scanner aan de praat te krijgen. Het deel met frontends levert een grafische scaninterface (xscanimage).</p></div><div class=paragraph><p>De eerste stap is om de port of het pakket <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sane-backends/>graphics/sane-backends</a> te installeren. Daarna kan met het commando <code>sane-find-scanner</code> gecontroleerd worden welke scanner er door het SANE systeem is gedetecteerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sane-find-scanner -q</span>
found SCSI scanner <span class=s2>&#34;AGFA SNAPSCAN 600 1.10&#34;</span> at /dev/pass3</code></pre></div></div><div class=paragraph><p>In de uitvoer is te lezen welk type interface en welk apparaatknooppunt worden gebruikt om de scanner met een systeem te verbinden. Het merk en het model worden wellicht niet getoond, maar dat is ook niet echt van belang.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige USB-scanners verlangen dat er firmware wordt geladen. Dit wordt uitgelegd in de hulppagina van het backend. Het is ook van belang <a href="https://man.freebsd.org/cgi/man.cgi?query=sane-find-scanner&amp;sektion=1&amp;format=html">sane-find-scanner(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=linprocfs&amp;sektion=7&amp;format=html">linprocfs(7)</a> te lezen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Hierna kan gecontroleerd worden of de scanner ook te zien is voor een scanner-frontend. Er zit bij de SANE backends een standaard hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=sane&amp;sektion=1&amp;format=html">sane(1)</a>. Met dit commando kunnen de apparaten zichtbaar gemaakt worden en kan vanaf de commandoregel gescand worden. Met de optie <code>-L</code> kunnen de scannerapparaten getoond worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scanimage -L</span>
device <span class=sb>`</span>snapscan:/dev/pass3<span class=s1>&#39; is a AGFA SNAPSCAN 600 flatbed scanner</span></code></pre></div></div><div class=paragraph><p>Of, met bijvoorbeeld de USB-scanner die in <a href=#scanners-kernel-usb>USB-interface</a> wordt gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scanimage -L</span>
device <span class=s1>&#39;epson2:libusb:/dev/usb:/dev/ugen0.2&#39;</span> is a Epson GT-8200 flatbed scanner</code></pre></div></div><div class=paragraph><p>Deze uitvoer komt van een FreeBSD 8.X systeem, het item <code>'epson2:libusb:/dev/usb:/dev/ugen0.2'</code> geeft de naam van het backend (<code>epson2</code>) en het apparaatknooppunt (<code>/dev/ugen0.2</code>) dat door onze scanner wordt gebruikt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De afwezigheid van uitvoer of een bericht dat aangeeft dat er geen scanners zijn aangetroffen, betekent dat <a href="https://man.freebsd.org/cgi/man.cgi?query=sane&amp;sektion=1&amp;format=html">sane(1)</a> niet in staat is een scanner te identificeren. Als dit gebeurt, dient het instellingenbestand voor het backend aangepast te worden en dient daar de juiste instelling gemaakt te worden. De map <span class=filename>/usr/local/etc/sane.d/</span> bevat alle bestanden met instellingen voor de backends. Het is bekend dat dit identificatieprobleem optreedt bij bepaalde USB-scanners.</p></div><div class=paragraph><p>De USB-scanner die in <a href=#scanners-kernel-usb>USB-interface</a> wordt gebruikt, wordt in FreeBSD 8.X prima gedetecteerd en werkt daar, maar in eerdere versies van FreeBSD (waar <a href="https://man.freebsd.org/cgi/man.cgi?query=uscanner&amp;sektion=4&amp;format=html">uscanner(4)</a> wordt gebruikt) toont het de volgende informatie met <code>sane-find-scanner</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sane-find-scanner -q</span>
found USB scanner <span class=o>(</span>UNKNOWN vendor and product<span class=o>)</span> at device /dev/uscanner0</code></pre></div></div><div class=paragraph><p>De bovenstaande uitvoer geeft aan dat de scanner juist is gedetecteerd, dat het de USB-interface gebruikt en is aangesloten op het apparaatknooppunt <span class=filename>/dev/uscanner0</span>. Nu kan gecontroleerd worden of de scanner juist wordt geïdentificeerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scanimage -L</span>

No scanners were identified. If you were expecting something different,
check that the scanner is plugged <span class=k>in</span>, turned on and detected by the
sane-find-scanner tool <span class=o>(</span><span class=k>if </span>appropriate<span class=o>)</span><span class=nb>.</span> Please <span class=nb>read </span>the documentation
which came with this software <span class=o>(</span>README, FAQ, manpages<span class=o>)</span>.</code></pre></div></div><div class=paragraph><p>Omdat in het bovenstaande voorbeeld de scanner niet wordt geïdentificeerd, dient het bestand <span class=filename>/usr/local/etc/sane.d/epson2.conf</span> gewijzigd te worden. De gebruikte scanner is een EPSON Perfection® 1650, dus in dit geval dient voor de scanner het backend <code>epson2</code> gebruikt te worden. Het is van belang om het commentaar in de instellingenbestanden van de backends te lezen. Het aanpassen van regels is eenvoudig: plaats een commentaarkarakter voor alle regels voor andere interfaces dan die nodig zijn weg (in dit geval worden alle regels die beginnen met het woord <code>scsi</code> uitgeschakeld, omdat er een USB-interface wordt gebruiken), en dan kan onderaan het bestand een regel met de gebruikte interface en apparaatknooppunt geplaatst worden:</p></div><div class="literalblock programlisting"><div class=content><pre>usb /dev/uscanner0</pre></div></div><div class=paragraph><p>Het is aan te raden de opmerkingen te lezen in het bestand met instellingen voor het backend en ook de hulppagina, omdat daarin meer details en de correcte syntaxis te vinden zijn. Nu kan gecontroleerd worden of de scanner wèl juist wordt geïdentificeerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scanimage -L</span>
device <span class=sb>`</span>epson:/dev/uscanner0<span class=s1>&#39; is a Epson GT-8200 flatbed scanner</span></code></pre></div></div><div class=paragraph><p>De USB-scanner is geïdentificeerd. Het is niet belangrijk dat het merk en model niet overeenkomen met de scanner. Het belangrijkste is het veld <code>`epson:/dev/uscanner0'</code>, dat de juiste benamingen voor het backend en het apparaatknooppunt aangeeft.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als <code>scanimage -L</code> in staat is een scanner goed te zien, dan zijn de instellingen compleet. Er kan nu met het apparaat gescand worden.</p></div><div class=paragraph><p>Hoewel <a href="https://man.freebsd.org/cgi/man.cgi?query=sane&amp;sektion=1&amp;format=html">sane(1)</a> in staat is om vanaf de commandoregel te scannen, is het aan te raden beelden te scannen vanuit de grafische gebruikersinterface. SANE heeft een eenvoudige, maar efficiënte grafische interface: xscanimage (<a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sane-frontends/>graphics/sane-frontends</a>).</p></div><div class=paragraph><p>Xsane (<a class=package href=https://cgit.freebsd.org/ports/tree/graphics/xsane/>graphics/xsane</a>) is een ander populair grafisch scanfrontend, dat geavanceerde mogelijkheden biedt, zoals meerdere scanmodi (fotokopie, fax, enzovoort), kleurcorrectie, batchscannen, enzovoort. Beide applicaties zijn als plug-in voor GIMP te gebruiken.</p></div></div><div class=sect3><h4 id=_andere_gebruikers_toegang_tot_de_scanner_geven>8.7.4. Andere gebruikers toegang tot de scanner geven<a class=anchor href=#_andere_gebruikers_toegang_tot_de_scanner_geven></a></h4><div class=paragraph><p>Alle voorgaande taken zijn uitgevoerd met <code>root</code> rechten, maar het is wellicht ook nodig dat andere gebruikers de scanner kunnen gebruiken. Dan heeft een gebruiker lees- en schrijfrechten nodig op de apparaatknooppunt voor een scanner. Onze USB-scanner gebruikt bijvoorbeeld apparaatknooppunt <span class=filename>/dev/ugen0.2</span> wat in feite slechts een symbolische koppeling is naar het echte apparaatknooppunt genaamd <span class=filename>/dev/usb/0.2.0</span> (een blik op de inhoud van de map <span class=filename>/dev</span> bevestigt dit). Zowel de symbolische koppeling als het apparaatknooppunt zijn van respectievelijk de groepen <code>wheel</code> en <code>operator</code>. Door de gebruiker <code><em>joe</em></code> aan deze groepen toe te voegen kan hij de scanner zien, maar vanwege duidelijke veiligheidsredenen dient het toevoegen van een gebruiker aan elke groep met zorg te gebeuren, vooral aan de groep <code>wheel</code>. Een betere oplossing is om een specifieke groep aan te maken voor het gebruik van USB-apparaten en de scanner toegankelijk te maken voor leden van deze groep.</p></div><div class=paragraph><p>We zullen dus bijvoorbeeld een groep genaamd <code><em>usb</em></code> gebruiken. De eerste stap is het aanmaken van deze groep met behulp van het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupadd usb</span></code></pre></div></div><div class=paragraph><p>Hierna moeten we de symbolische koppeling <span class=filename>/dev/ugen0.2</span> aanmaken en het apparaatknooppunt <span class=filename>/dev/usb/0.2.0</span> met de juiste schrijfpermissies toegankelijk maken voor de groep <code>usb</code> (<code>0660</code> of <code>0664</code>), omdat standaard alleen de eigenaar van deze bestanden (<code>root</code>) ernaar kan schrijven. Dit alles wordt gedaan door de volgende regels aan <span class=filename>/etc/devfs.rules</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>[system=5]
add path ugen0.2 mode 0660 group usb
add path usb/0.2.0 mode 0666 group usb</pre></div></div><div class=paragraph><p>Nu dienen er alleen nog gebruikers aan de groep <code><em>usb</em></code> toegevoegd te worden om toegang tot de scanner toe te staan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod usb -m joe</span></code></pre></div></div><div class=paragraph><p>Lees voor meer details de handleidingpagina van <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>.</p></div></div></div></div></div><div class=sect1><h2 id=kernelconfig>Hoofdstuk 9. De FreeBSD-kernel instellen<a class=anchor href=#kernelconfig></a></h2><div class=sectionbody><div class=sect2><h3 id=kernelconfig-synopsis>9.1. Samenvatting<a class=anchor href=#kernelconfig-synopsis></a></h3><div class=paragraph><p>De kernel is de kern van het FreeBSD-besturingssysteem en is verantwoordelijk voor het geheugenbeheer, het opleggen van beveiligingsregels, het aansturen van het netwerk, de toegang tot schijven en nog veel meer. Hoewel steeds meer in FreeBSD dynamisch instelbaar wordt, is het af en toe nodig om de kernel opnieuw in te stellen en te compileren.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Waarom het nodig is om een aangepaste kernel te bouwen;</p></li><li><p>Hoe een nieuw kernelinstellingenbestand te schrijven of een bestaand kernelinstellingenbestand aan te passen;</p></li><li><p>Hoe het kernelinstellingenbestand te gebruiken om een nieuwe kernel aan te maken en te bouwen;</p></li><li><p>Hoe een nieuwe kernel te installeren;</p></li><li><p>Hoe problemen op te lossen als er iets verkeerd gaat.</p></li></ul></div><div class=paragraph><p>Alle opdrachten die in dit hoofdstuk als voorbeeld zijn gegeven moeten als <code>root</code> uitgevoerd worden om te slagen.</p></div></div><div class=sect2><h3 id=kernelconfig-custom-kernel>9.2. Redenen om een aangepaste kernel te bouwen<a class=anchor href=#kernelconfig-custom-kernel></a></h3><div class=paragraph><p>Traditioneel heeft FreeBSD zoals dat heet een "monolitische" kernel gehad. Dit betekent dat de kernel één groot programma was, een vaste lijst van apparaten ondersteunde en als het gewenst was om het gedrag van de kernel te veranderen, moest er een nieuwe kernel gecompileerd worden en moest daarna de computer opnieuw gestart worden met de nieuwe kernel.</p></div><div class=paragraph><p>Vandaag de dag beweegt FreeBSD zich snel naar een model waar veel van de functionaliteit van de kernel in modules zit die dynamisch in en uit de kernel kunnen worden geladen, naargelang dat noodzakelijk is. Dit stelt de kernel in staat om zich aan nieuwe hardware aan te passen die plotseling beschikbaar komt (zoals PCMCIA-kaarten in een laptop) of om nieuwe functionaliteit in zich op te nemen die niet noodzakelijk was toen de kernel oorspronkelijk werd gecompileerd. Dit staat bekend als een modulaire kernel.</p></div><div class=paragraph><p>Desondanks is het nog steeds nodig om enkele dingen van de kernel statisch in te stellen. In sommige gevallen komt dit doordat de functionaliteit zo diep geworteld zit in de kernel dat het niet dynamisch laadbaar gemaakt kan worden. In andere gevallen kan het simpelweg komen doordat nog niemand de tijd heeft genomen om een dynamisch laadbare kernelmodule voor die functionaliteit te schrijven.</p></div><div class=paragraph><p>Het bouwen van een aangepaste kernel is een van de meest belangrijke beproevingen die geavanceerde BSD-gebruikers moet doorstaan. Hoewel dit proces veel tijd in beslag neemt, levert het veel voordelen op voor een FreeBSD systeem. In tegenstelling tot de <span class=filename>GENERIC</span>-kernel, die vele typen hardware moet ondersteunen, ondersteunt een aangepaste kernel alleen de hardware van de computer waar hij voor gemaakt is. Dit biedt een aantal voordelen, zoals:</p></div><div class=ulist><ul><li><p>Een snellere opstarttijd. Aangezien de kernel alleen de hardware zoekt die zich in het systeem bevindt, kan de tijd die het systeem nodig heeft om op te starten aanzienlijk korter worden;</p></li><li><p>Minder geheugengebruik. Een aangepaste kernel gebruikt vaak minder geheugen dan de <span class=filename>GENERIC</span>-kernel door ongebruikte mogelijkheden en apparaatstuurprogramma’s weg te laten. Dit is van belang aangezien de kernelcode altijd in het fysieke geheugen aanwezig blijft, waardoor dit geheugen niet door applicaties gebruikt kan worden. Om deze reden is een aangepaste kernel geknipt voor een systeem met een kleine hoeveelheid RAM;</p></li><li><p>Aanvullende hardware-ondersteuning. Een aangepaste kernel kan ingebouwde ondersteuning bieden voor apparaten die zich niet in de <span class=filename>GENERIC</span>-kernel bevinden, zoals geluidskaarten.</p></li></ul></div></div><div class=sect2><h3 id=kernelconfig-devices>9.3. De systeemhardware vinden<a class=anchor href=#kernelconfig-devices></a></h3><div class=paragraph><p>Alvorens in de kernelconfiguratie te duiken, zou het verstandig zijn om een inventarisatie van de hardware van de machine te maken. In het geval dat FreeBSD niet het primaire besturingssysteem is, kan de inventarisatielijst eenvoudig worden gemaakt door de configuratie van het huidige besturingssysteem te bekijken. De Device Manager van Microsoft® bijvoorbeeld bevat normaliter belangrijke informatie over geïnstalleerde apparaten. De Device Manager bevindt zich in het controlepaneel.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige versies van Microsoft® Windows® hebben een icoon System dat een scherm weer zal geven waarmee Device Manager kan worden benaderd.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als er geen ander besturingssysteem op de machine staat, moet de beheerder deze informatie handmatig vinden. Eén manier is om de gereedschappen <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=man&amp;sektion=1&amp;format=html">man(1)</a> te gebruiken. De meeste apparaatstuurprogramma’s van FreeBSD hebben een handleiding, die de ondersteunde hardware noemen, en tijdens het opstarten wordt gevonden hardware getoond. De volgende regels geven bijvoorbeeld aan dat het stuurprogramma voor <span class=filename>psm</span> een muis heeft gevonden:</p></div><div class="literalblock programlisting"><div class=content><pre>psm: &lt;PS/2 Mouse&gt; irq 12 on atkbdc0
psm0: [GIANT-LOCKED]
psm0: [ITHREAD]
psm0: model Generic PS/2 mouse, device ID 0</pre></div></div><div class=paragraph><p>Dit stuurprogramma zal in het eigen kernelinstellingenbestand opgenomen moeten worden of worden geladen met <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a>.</p></div><div class=paragraph><p>Soms geven de gegevens van <code>dmesg</code> alleen de systeemboodschappen weer in plaats van de uitvoer van de opstartonderzoeken. In deze gevallen kan de uitvoer worden verkregen door het bestand <span class=filename>/var/run/dmesg.boot</span> te bekijken.</p></div><div class=paragraph><p>Een andere methode om hardware te vinden is door <a href="https://man.freebsd.org/cgi/man.cgi?query=pciconf&amp;sektion=8&amp;format=html">pciconf(8)</a> te gebruiken welke meer gedetailleerde uitvoer geeft. Bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>ath0@pci0:3:0:0:        class=0x20000 card=0x058a1014 chip=0x1014168c rev=0x01 hdr=0x00
    vendor     = &#39;Atheros Communications Inc.&#39;
    device     = &#39;AR5212 Atheros AR5212 802.11abg wireless&#39;
    class      = network
    subclass   = ethernet</pre></div></div><div class=paragraph><p>Dit beetje uitvoer, verkregen met <code>pciconf -lv</code> geeft aan dat het stuurprogramma <span class=filename>ath</span> een draadloos Ethernetapparaat heeft gevonden. Het gebruik van <code>man ath</code> zal de handleiding voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a> teruggeven.</p></div><div class=paragraph><p>Wanneer de vlag <code>-k</code> aan <a href="https://man.freebsd.org/cgi/man.cgi?query=man&amp;sektion=1&amp;format=html">man(1)</a> wordt gegeven kan deze nuttige informatie geven. Met het bovenstaande kan dit gedaan worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># man -k Atheros</span></code></pre></div></div><div class=paragraph><p>om een lijst handleidingen te krijgen die dat ene woord bevatten:</p></div><div class="literalblock programlisting"><div class=content><pre>ath(4)                   - Atheros IEEE 802.11 wireless network driver
ath_hal(4)               - Atheros Hardware Access Layer (HAL)</pre></div></div><div class=paragraph><p>Gewapend met een inventarisatielijst van de hardware zou het proces van het bouwen van een eigen kernel minder angstaanjagend moeten lijken.</p></div></div><div class=sect2><h3 id=kernelconfig-modules>9.4. Kernel stuurprogramma’s, subsystemen, en modules<a class=anchor href=#kernelconfig-modules></a></h3><div class=paragraph><p>Bekijk, voordat er een eigen kernel gebouwd wordt, de redenen om dit te doen. Als er de noodzaak is voor specifieke hardwareondersteuning, kan dit reeds beschikbaar zijn als een module.</p></div><div class=paragraph><p>Kernelmodules staan in de map <span class=filename>/boot/kernel</span> en kunnen dynamisch in de draaiende kernel worden geladen met <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>. De meeste, als niet alle, kernelstuurprogramma’s hebben een specifieke module en een handleiding. De laatste sectie merkte bijvoorbeeld het draadloze Ethernetstuurprogramma <span class=filename>ath</span> op. Van dit stuurprogramma staat de volgende informatie in de handleiding:</p></div><div class="literalblock programlisting"><div class=content><pre>Plaats de volgende regel in man:loader.conf[5] om
      het stuurprogramma tijdens het opstarten als een module te laden:

           if_ath_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Zoals aangegeven, zal het toevoegen van de regel <code>if_ath_load="YES"</code> aan <span class=filename>/boot/loader.conf</span> deze module dynamisch laden tijdens het opstarten.</p></div><div class=paragraph><p>In sommige gevallen is er geen geassocieerde module. Dit geldt het vaakst voor bepaalde subsystemen en zeer belangrijke stuurprogramma’s, het fast file system (FFS) bijvoorbeeld is een verplichte optie in de kernel, net zoals netwerkondersteuning (INET). Helaas is de enige manier om te zien of een stuurprogramma nodig is naar de module zelf zoeken.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Het is eenvoudig om ondersteuning voor een apparaat of optie te verwijderen en met een kapotte kernel opgezadeld te zitten. Als bijvoorbeeld het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ata&amp;sektion=4&amp;format=html">ata(4)</a> uit het kernelinstellingenbestand gehaald wordt, zal een systeem dat ATA schijfstuurprogramma’s gebruikt niet opstarten zonder de module aan <span class=filename>loader.conf</span> toe te voegen. Kijk bij twijfel of de module aanwezig is en laat ondersteuning dan gewoon in de kernel.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=kernelconfig-building>9.5. Bouwen en installeren van een aangepaste kernel<a class=anchor href=#kernelconfig-building></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is noodzakelijk om de volledige broncode van FreeBSD geïnstalleerd te hebben om de kernel te bouwen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Eerst wordt er een overzicht gegeven van de mappen waarin de kernel gebouwd wordt. Alle genoemde mappen staan onder de map <span class=filename>/usr/src/sys</span>, die ook toegankelijk is via de padnaam <span class=filename>/sys</span>. Er zijn hier een aantal mappen aanwezig die de verschillende delen van de kernel representeren, maar de meest belangrijke hiervan zijn <span class=filename>arch/conf</span>, waarin de kernelinstellingen bewerkt worden en <span class=filename>compile</span>, waarin de aangepaste kernel gebouwd wordt. <em>arch</em> representeert hier één van <span class=filename>i386</span>, <span class=filename>amd64</span>, <span class=filename>ia64</span>, <span class=filename>powerpc</span>, <span class=filename>sparc64</span> of <span class=filename>pc98</span> (een alternatieve ontwikkelingstak van PC-hardware die populair is in Japan). Alles binnen de map van een bepaalde architectuur is er alleen voor die architectuur. De rest van de code is machine-onafhankelijk en hetzelfde op alle platformen waarnaar FreeBSD eventueel overgezet kan worden. De indeling van de mapstructuur is logisch: alle ondersteunde apparaten, bestandssystemen en opties staan in een eigen submap.</p></div><div class=paragraph><p>Dit voorbeelden in dit hoofdstuk veronderstellen dat de i386-architectuur gebruikt wordt. Als dit voor de lezer anders is, moeten de bijhorende aanpassingen aan de padnamen worden gemaakt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als de map <span class=filename>/usr/src/</span> <em>niet</em> aanwezig is op een systeem (of als het leeg is), dan is de broncode niet geïnstalleerd. De eenvoudigste manier om de volledige broncode te installeren is <a href="https://man.freebsd.org/cgi/man.cgi?query=csup&amp;sektion=1&amp;format=html">csup(1)</a> te gebruiken zoals beschreven in <a href=./#synching>Broncode synchroniseren</a>. U dient tevens een symbolische link naar <span class=filename>/usr/src/sys/</span> aan te maken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s /usr/src/sys /sys</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Daarna kan vanuit de map <span class=filename>arch/conf</span> het instellingenbestand <span class=filename>GENERIC</span> naar de naam voor de aangepaste kernel gekopieerd worden. Bijvoorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/sys/i386/conf</span>
<span class=c># cp GENERIC MIJNKERNEL</span></code></pre></div></div><div class=paragraph><p>Traditioneel bestaat deze naam geheel uit hoofdletters en als er meerdere FreeBSD-machines worden beheerd met verschillende hardware is het een goed idee om het te vernoemen naar de hostnaam van de machine. Omwille van dit voorbeeld wordt het <span class=filename>MIJNKERNEL</span> genoemd.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Het kernelinstellingenbestand direct onder <span class=filename>/usr/src</span> opslaan kan een slecht idee zijn. In geval van problemen kan het verleidelijk zijn om <span class=filename>/usr/src</span> te verwijderen en opnieuw te beginnen. Nadat dit gedaan is kost het vaak maar enkele seconden om te realiseren dat het instellingenbestand voor de aangepaste kernel verwijderd is. Ook moet <span class=filename>GENERIC</span> niet gewijzigd worden, omdat het tijdens de volgende keer dat de <a href=./#updating-upgrading>broncodeboom bijgewerkt wordt</a>, overschreven kan worden waarbij de wijzigingen in de kernelinstellingen verloren gaan.</p></div><div class=paragraph><p>Het kan gewenst zijn om het kernelinstellingenbestand ergens anders op te slaan en een symbolische link naar het bestand in de map <span class=filename>i386</span> aan te maken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/sys/i386/conf</span>
<span class=c># mkdir /root/kernels</span>
<span class=c># cp GENERIC /root/kernels/MIJNKERNEL</span>
<span class=c># ln -s /root/kernels/MIJNKERNEL</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Nu moet <span class=filename>MIJNKERNEL</span> met de favoriete tekstverwerker bewerkt worden. Voor beginners is waarschijnlijk alleen de tekstverwerker vi beschikbaar, die te ingewikkeld is om hier te beschrijven, maar goed is beschreven in vele boeken in de <a href=./#bibliography>bibliografie</a>. FreeBSD biedt ook de eenvoudigere tekstverwerker ee, die voor een beginner de keuze bij uitstek is. De commentaarregels in het begin kunnen gewijzigd worden om de persoonlijke instellingen of de veranderingen die gemaakt zijn ten opzichte van <span class=filename>GENERIC</span> weer te geven.</p></div><div class=paragraph><p>Voor degenen die een kernel op SunOS™ of een andere BSD hebben gebouwd zal veel van dit bestand bekend voorkomen. Echter, voor degenen die van een ander besturingssysteem zoals DOS komen, kan het instellingenbestand <span class=filename>GENERIC</span> overdonderend overkomen, dus moeten de beschrijvingen in de sectie <a href=#kernelconfig-config>Het Instellingenbestand</a> zorgvuldig opgevolgd worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als de <a href=./#updating-upgrading>broncodeboom gesynchroniseerd</a> is met de nieuwste broncode van het FreeBSD-project, moet altijd <span class=filename>/usr/src/UPDATING</span> gelezen worden voordat enige bijwerkstappen worden genomen. Dit bestand beschrijft alle belangrijke zaken en gebieden binnen de broncodestructuur die speciale aandacht nodig hebben. <span class=filename>/usr/src/UPDATING</span> komt altijd overeen met de lokale versie van de FreeBSD-broncode en is daarom meer bijgewerkt met nieuwe informatie dan dit handboek.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Nu moet de broncode voor de kernel gecompileerd worden.</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Een kernel bouwen</strong></p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is noodzakelijk om de volledige broncode van FreeBSD geïnstalleerd te hebben om te kernel te bouwen.</p></div></td></tr></tbody></table></div><div class="olist arabic"><ol class=arabic><li><p>Ga naar de map <span class=filename>/usr/src</span>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span></code></pre></div></div></li><li><p>Compileer de kernel:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make buildkernel KERNCONF=MIJNKERNEL</span></code></pre></div></div></li><li><p>Installeer de nieuwe kernel:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% make installkernel <span class=nv>KERNCONF</span><span class=o>=</span>MIJNKERNEL</code></pre></div></div></li></ol></div></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Bij het bouwen van een aangepaste kernel worden standaard <em>alle</em> kernelmodules ook herbouwd. Om de kernel sneller bij te werken en alleen de aangepaste modules te bouwen kan <span class=filename>/etc/make.conf</span> aangepast worden voordat de kernel wordt gebouwd:</p></div><div class="literalblock programlisting"><div class=content><pre>MODULES_OVERRIDE = linux acpi sound/sound sound/driver/ds1 ntfs</pre></div></div><div class=paragraph><p>Met deze variabele wordt een lijst van te bouwen modules ingesteld die gebouwd moeten worden in plaats van allen.</p></div><div class="literalblock programlisting"><div class=content><pre>WITHOUT_MODULES = linux acpi sound ntfs</pre></div></div><div class=paragraph><p>Deze variabele stelt een lijst in van modules op het topniveau die moeten worden uitgesloten van het bouwproces. Andere variabelen die mogelijk ook nuttig zijn in het proces van het bouwen van een kernel staan beschreven in de handleiding voor <a href="https://man.freebsd.org/cgi/man.cgi?query=make.conf&amp;sektion=5&amp;format=html">make.conf(5)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De nieuwe kernel wordt naar de map <span class=filename>/boot/kernel</span> gekopieerd als <span class=filename>/boot/kernel/kernel</span> en de oude kernel wordt verplaatst naar <span class=filename>/boot/kernel.old/kernel</span>. Nu moet het systeem afgesloten worden en opnieuw worden opgestart om gebruik te maken van de nieuwe kernel. Er zijn wat instructies voor <a href=#kernelconfig-trouble>problemen oplossen</a> aan het einde van dit hoofdstuk, die erg nuttig kunnen zijn als er iets misgaat. Vergeet niet om het gedeelte te lezen waarin staat uitgelegd hoe te herstellen als de nieuwe kernel <a href=#kernelconfig-noboot>niet opstart</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Andere bestanden die te maken hebben met het opstartproces, zoals de boot <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> en instellingen worden opgeslagen in <span class=filename>/boot</span>. Modules van derde partijen of eigen modules kunnen in <span class=filename>/boot/kernel</span> opgeslagen worden, alhoewel gebruikers erop bedacht moeten zijn dat het erg belangrijk is dat de modules synchroon worden gehouden met de gecompileerde kernel. Modules die niet bedoeld zijn om met de gecompileerde kernel te draaien kunnen voor instabiliteit of onjuistheden zorgen.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=kernelconfig-config>9.6. Het instellingenbestand<a class=anchor href=#kernelconfig-config></a></h3><div class=paragraph><p>Het algemene formaat van een instellingenbestand is vrij eenvoudig. Elke regel bevat een sleutelwoord en één of meer argumenten. Omwille van de eenvoud bevatten de meeste regels maar één argument. Alles wat na een <code>#</code> komt, wordt als commentaar beschouwd en genegeerd. De volgende gedeelten beschrijven elk sleutelwoord, in het algemeen in dezelfde volgorde als <span class=filename>GENERIC</span>, alhoewel sommige samenhangende sleutelwoorden gegroepeerd zijn in een enkel gedeelte (zoals Netwerken) zelfs al staan ze verspreid in het bestand <span class=filename>GENERIC</span>. <a id=kernelconfig-options></a>Een uitputtende lijst van architectuurafhankelijke opties en apparaten staat in het bestand <span class=filename>NOTES</span>, dat in dezelfde map staat als het bestand <span class=filename>GENERIC</span>. Architectuuronafhankelijke opties staan in <span class=filename>/usr/src/sys/conf/NOTES</span>.</p></div><div class=paragraph><p>Een nieuwe directief <code>include</code> is beschikbaar om te gebruiken in instellingenbestanden. Hiermee kan een ander instellingenbestand logisch in het huidige worden opgenomen, waardoor het eenvoudig wordt om kleine veranderingen relatief aan een bestaand bestand te onderhouden. Als u bijvoorbeeld een <span class=filename>GENERIC</span> kernel nodig heeft met slechts een klein aantal aanvullende opties of stuurprogramma’s, hoeft u hiermee slechts een delta ten opzichte van GENERIC te onderhouden:</p></div><div class="literalblock programlisting"><div class=content><pre>include GENERIC
ident MIJNKERNEL

options		IPFIREWALL
options		DUMMYNET
options		IPFIREWALL_DEFAULT_TO_ACCEPT
options		IPDIVERT</pre></div></div><div class=paragraph><p>Veel beheerders zullen aanzienlijke voordelen in dit model zien vergeleken met de vroegere gewoonte om instellingenbestanden vanuit het niets te schrijven: het lokale instellingenbestand zal alleen lokale verschillen uitdrukken ten opzichte van een <span class=filename>GENERIC</span> kernel en wanneer upgrades worden uitgevoerd zullen nieuwe mogelijkheden die aan <span class=filename>GENERIC</span> zijn toegevoegd ook aan de lokale kernel worden toegevoegd tenzij dit expliciet verhinderd wordt met <code>nooptions</code> of <code>nodevice</code>. De rest van dit hoofdstuk behandelt de inhoud van een typisch instellingenbestand en de verschillende rollen die opties en apparaten spelen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Draai het volgende commando als <code>root</code> om een bestand te bouwen dat alle beschikbare opties bevat, wat normaliter voor testdoeleinden gedaan wordt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/sys/i386/conf &amp;&amp; make LINT</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Het volgende is een voorbeeld van het kernelinstellingenbestand <span class=filename>GENERIC</span> met aanvullend commentaar omwille van de helderheid. Dit voorbeeld is redelijk gelijk aan de versie in <span class=filename>/usr/src/sys/i386/conf/GENERIC</span>.</p></div><div class="literalblock programlisting"><div class=content><pre>machine   i386</pre></div></div><div class=paragraph><p>Dit is de architectuur van de machine. Het moet één van <code>amd64</code>, <code>i386</code>, <code>ia64</code>, <code>pc98</code>, <code>powerpc</code> of <code>sparc64</code> zijn.</p></div><div class="literalblock programlisting"><div class=content><pre>cpu   I486_CPU
cpu   I586_CPU
cpu   I686_CPU</pre></div></div><div class=paragraph><p>Bovenstaande optie geeft het type CPU aan dat in een systeem zit. De CPU-regel kan meerdere keren voorkomen (als bijvoorbeeld onbekend is of <code>I586_CPU</code> of <code>I686_CPU</code> gebruikt moet worden), maar voor een aangepaste kernel is het beter om alleen de aanwezige CPU aan te geven. Als er twijfel bestaat over het type CPU, kan het bestand <span class=filename>/var/run/dmesg.boot</span> worden bekeken voor de opstartberichten.</p></div><div class="literalblock programlisting"><div class=content><pre>ident   GENERIC</pre></div></div><div class=paragraph><p>Dit is de identificatie van de kernel. Dit moet veranderd worden in de naam van de kernel, dus <code>MIJNKERNEL</code> als de instructies van de voorgaande voorbeelden gevolgd zijn. De waarde in de string <code>ident</code> wordt afgebeeld wanneer de kernel opstart, dus is het handig om de nieuwe kernel een andere naam te geven als deze apart moet worden gehouden van de gebruikelijke kernel (als er bijvoorbeeld een experimentele kernel gebouwd wordt).</p></div><div class="literalblock programlisting"><div class=content><pre>#Om apparaatbindingen statisch in te compileren in plaats van via /boot/device.hints.
#hints    &#34;GENERIC.hints&#34;     # Standaardlocatie voor devices.</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=device.hints&amp;sektion=5&amp;format=html">device.hints(5)</a> wordt gebruikt om opties van de programma’s die de apparaten aansturen in te stellen. De standaardplaats die <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> controleert tijdens het opstarten is <span class=filename>/boot/device.hints</span>. Met de optie <code>hints</code> is het mogelijk om deze aanwijzingen statisch in de kernel te compileren, waardoor er geen noodzaak is om een bestand <span class=filename>device.hints</span> in <span class=filename>/boot</span> aan te maken.</p></div><div class="literalblock programlisting"><div class=content><pre>makeoptions        DEBUG=-g  # Bouw kernel met gdb(1) debugsymbolen.</pre></div></div><div class=paragraph><p>Het normale bouwproces van FreeBSD voegt debuginformatie toe wanneer de kernel met de optie <code>-g</code> gebouwd wordt, wat debuginformatie doorgeeft aan <a href="https://man.freebsd.org/cgi/man.cgi?query=gcc&amp;sektion=1&amp;format=html">gcc(1)</a>.</p></div><div class="literalblock programlisting"><div class=content><pre>options   SCHED_ULE    # ULE taakplanner</pre></div></div><div class=paragraph><p>De standaard taakplanner voor FreeBSD. Laat dit staan.</p></div><div class="literalblock programlisting"><div class=content><pre>options   PREEMPTION # Zet kernelthreadpreëmptie aan</pre></div></div><div class=paragraph><p>Sta toe dat threads in de kernel worden gepreëmpt door threads met een hogere prioriteit. Het help bij interactiviteit en staat toe dat interruptthreads eerder draaien in plaats van te moeten wachten.</p></div><div class="literalblock programlisting"><div class=content><pre>options   INET      # internetwerken</pre></div></div><div class=paragraph><p>Netwerkondersteuning. Laat dit aanstaan, zelfs als een verbinding met een netwerk niet gepland is. De meeste programma’s hebben tenminste een teruglusnetwerk nodig (dat wil zeggen het maken van netwerkverbindingen binnen de PC), dus dit is eigenlijk verplicht.</p></div><div class="literalblock programlisting"><div class=content><pre>options   INET6     # IPv6 communicatieprotocollen</pre></div></div><div class=paragraph><p>Dit zet de IPv6-communicatieprotocollen aan.</p></div><div class="literalblock programlisting"><div class=content><pre>options   FFS       # Berkeley Fast Bestandssysteem</pre></div></div><div class=paragraph><p>Dit is het basisbestandssysteem voor de harde schijf. Laat dit erin staan als er vanaf de harde schijf wordt opgestart.</p></div><div class="literalblock programlisting"><div class=content><pre>options   SOFTUPDATES   # Schakel FFS Softupdates ondersteuning in</pre></div></div><div class=paragraph><p>Deze optie zet softupdates in de kernel aan en helpt om de schijftoegang voor schrijven te verhogen. Zelfs als deze functionaliteit door de kernel geleverd wordt, moet die voor specifieke schijven worden aangezet. Bekijk de uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> om te zien of softupdates aanstaat voor de systeemschijven. Als de optie <code>soft-updates</code> niet zichtbaar is, dient deze geactiveerd te worden met behulp van <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> voor bestaande bestandssystemen of <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> voor nieuwe bestandssystemen.</p></div><div class="literalblock programlisting"><div class=content><pre>options   UFS_ACL   # Ondersteuning voor toegangscontrolelijsten</pre></div></div><div class=paragraph><p>Met deze optie wordt de ondersteuning voor toegangscontrolelijsten aangezet. Hiervoor zijn uitgebreide attributen en UFS2 nodig. Een en ander wordt in detail beschreven in <a href=./#fs-acl>Bestandssysteem toegangscontrolelijsten (ACLs)</a>. ACL’s staan standaard aan en moeten niet uitgezet worden in de kernel als ze al eerder op een bestandssysteem zijn gebruikt, omdat dit de toegangscontrolelijsten verwijdert en hierdoor de manier waarop bestanden beschermd worden op onvoorspelbare wijze verandert.</p></div><div class="literalblock programlisting"><div class=content><pre>options   UFS_DIRHASH   # Verbeter prestaties in grote mappen</pre></div></div><div class=paragraph><p>Deze optie bevat functionaliteit om schijfoperaties op grote mappen te versnellen, ten koste van extra geheugen. Deze staat normaalgesproken, zoals voor een grote server of interactief werkstation, aan en wordt uitgezet als FreeBSD op een kleiner systeem wordt gebruikt waar geheugen het belangrijkste en schijfsnelheid minder belangrijk is, zoals voor een firewall.</p></div><div class="literalblock programlisting"><div class=content><pre>options   MD_ROOT   # MD is een potentieel rootapparaat</pre></div></div><div class=paragraph><p>Deze optie zet ondersteuning aan voor een virtuële schijf die in het geheugen wordt geïmplementeerd en als rootapparaat wordt gebruikt.</p></div><div class="literalblock programlisting"><div class=content><pre>options   NFSCLIENT    # Netwerk Bestandssysteem Client
options   NFSSERVER    # Netwerk Bestandssysteem Server
options   NFS_ROOT     # NFS bruikbaar als /, NFSCLIENT nodig</pre></div></div><div class=paragraph><p>Het netwerkbestandssysteem. Dit kan weggelaten worden tenzij er gepland is om partities te aan te koppelen van een UNIX® bestandsserver over TCP/IP.</p></div><div class="literalblock programlisting"><div class=content><pre>options   MSDOSFS   # MSDOS Bestandssysteem</pre></div></div><div class=paragraph><p>Het MS-DOS® bestandssysteem. Dit kan veilig weggelaten worden, tenzij er gepland is om een DOS-geformatteerde partitie van de harde schijf tijdens het opstarten aan te koppelen. Het wordt automatisch geladen als er voor de eerste keer een DOS-partitie wordt aangekoppeld, zoals boven beschreven. Bovendien geeft de uitstekende software <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/mtools/>emulators/mtools</a> toegang tot DOS-floppies zonder dat ze aangekoppeld en afgekoppeld moeten worden en heeft het <code>MSDOSFS</code> helemaal niet nodig.</p></div><div class="literalblock programlisting"><div class=content><pre>options   CD9660    # ISO 9660 Bestandssysteem</pre></div></div><div class=paragraph><p>Het ISO 9960-bestandssysteem voor CD-ROMs. Commentarieer dit uit als er geen CD-ROM drive aanwezig is of als er slechts af en toe gegevens-CD-ROMs aangekoppeld worden (aangezien het dynamisch geladen wordt als er voor de eerste keer een gegevens-CD-ROM aangekoppeld wordt). Audio-CD’s hebben dit bestandssysteem niet nodig.</p></div><div class="literalblock programlisting"><div class=content><pre>options   PROCFS    # Procesbestandssysteem (vereist PSEUDOFS)</pre></div></div><div class=paragraph><p>Het procesbestandssysteem. Dit is een "als-of" bestandssysteem, aangekoppeld op <span class=filename>/proc</span>, dat programma’s als <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> in staat stelt om meer informatie over de draaiende processen te geven. Het is in de meeste omstandigheden niet nodig om <code>PROCFS</code> te gebruiken, omdat de meeste debug- en monitorgereedschappen zijn aangepast om zonder <code>PROCFS</code> te draaien: installaties koppelen dit bestandssysteem standaard niet aan.</p></div><div class="literalblock programlisting"><div class=content><pre>options   PSEUDOFS  # Pseudo-bestandssysteem raamwerk</pre></div></div><div class=paragraph><p>Kernels die <code>PROCFS</code> gebruiken moeten ook ondersteuning voor <code>PSEUDOFS</code> opnemen.</p></div><div class="literalblock programlisting"><div class=content><pre>options   GEOM_PART_GPT  # GUID Partitietabellen.</pre></div></div><div class=paragraph><p>Voegt ondersteuning voor <a href=http://en.wikipedia.org/wiki/GUID_Partition_Table>GUID Partitietabellen</a> toe. GPT biedt de mogelijkheid om een groot aantal partities per schijf te hebben, 128 is de standaardconfiguratie.</p></div><div class="literalblock programlisting"><div class=content><pre>options   COMPAT_43 # Compatibel met BSD 4.3 [ERIN HOUDEN!]</pre></div></div><div class=paragraph><p>Compatibiliteit met 4.3BSD. Laat dit aanstaan. Sommige programma’s gedragen zich vreemd als dit uitgecommentarieerd wordt.</p></div><div class="literalblock programlisting"><div class=content><pre>options   COMPAT_FREEBSD4     # Compatibel met FreeBSD 4</pre></div></div><div class=paragraph><p>Deze optie is nodig om ondersteuning te bieden aan applicaties die gecompileerd zijn op oudere versies van FreeBSD en gebruik maken van oudere systeemaanroep-interfaces. Het is aanbevolen dat deze optie gebruikt wordt op alle i386™ systemen die mogelijk oudere applicaties draaien. Voor platformen die pas in 5.X ondersteuning verwierven, zoals ia64 en sparc64, is deze optie niet nodig.</p></div><div class="literalblock programlisting"><div class=content><pre>options   COMPAT_FREEBSD5     # Compatibel met FreeBSD5</pre></div></div><div class=paragraph><p>Deze optie is vereist om ondersteuning te geven aan applicaties die gecompileerd zijn op FreeBSD 5.X die gebruik maken van de systeemaanroepinterfaces van FreeBSD 5.X.</p></div><div class="literalblock programlisting"><div class=content><pre>options   COMPAT_FREEBSD6     # Compatibel met FreeBSD5</pre></div></div><div class=paragraph><p>Deze optie is vereist om ondersteuning te geven aan applicaties die gecompileerd zijn op FreeBSD 6.X die gebruik maken van de systeemaanroepinterfaces van FreeBSD 6.X.</p></div><div class="literalblock programlisting"><div class=content><pre>options   COMPAT_FREEBSD7     # Compatibel met FreeBSD5</pre></div></div><div class=paragraph><p>Deze optie is vereist om ondersteuning te geven aan applicaties die gecompileerd zijn op FreeBSD 7.X die gebruik maken van de systeemaanroepinterfaces van FreeBSD 7.X.</p></div><div class="literalblock programlisting"><div class=content><pre>options   SCSI_DELAY=5000    # Vertraging (in ms) voordat SCSI wordt ondergezocht.</pre></div></div><div class=paragraph><p>Dit zorgt ervoor dat de kernel vijf seconden wacht voordat die elk SCSI-apparaat in het systeem onderzoekt. Als er alleen IDE-harde schijven zijn, kan deze optie genegeerd worden, anders kan geprobeerd worden dit getal te verlagen, om het opstarten te versnellen. Uiteraard moet deze waarde weer verhoogd worden als FreeBSD problemen heeft om de SCSI-apparaten te herkennen.</p></div><div class="literalblock programlisting"><div class=content><pre>options   KTRACE    # ktrace(1) ondersteuning</pre></div></div><div class=paragraph><p>Dit schakelt kernelondersteuning voor het volgen processen in, wat handig is tijdens debuggen.</p></div><div class="literalblock programlisting"><div class=content><pre>options   SYSVSHM   # SYSV-stijl gedeeld geheugen</pre></div></div><div class=paragraph><p>Deze optie biedt System V gedeeld geheugen. Meestal wordt dit wegens de XSHM-uitbreiding in X gebruikt, waar door vele grafische programma’s automatisch gebruik van wordt gemaakt voor extra snelheid. Als X gebruik wordt, is het raadzaam om dit op te nemen.</p></div><div class="literalblock programlisting"><div class=content><pre>options   SYSVMSG   # SYSV-stijl berichtwachtrijen</pre></div></div><div class=paragraph><p>Dit biedt ondersteuning voor System V berichten. Ook deze optie voegt slechts een paar honderd bytes aan de kernel toe.</p></div><div class="literalblock programlisting"><div class=content><pre>options   SYSVSEM   # SYSV-stijl semaforen</pre></div></div><div class=paragraph><p>Dit biedt ondersteuning voor System V semaforen. Het wordt minder vaak gebruikt, maar voegt slechts een paar honderd bytes aan de kernel toe.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De optie <code>-p</code> van het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=ipcs&amp;sektion=1&amp;format=html">ipcs(1)</a> geeft een lijst van alle processen die een van deze System V faciliteiten gebruikt.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>options   _KPOSIX_PRIORITY_SCHEDULING   # POSIX P1003_1B real-time extensies</pre></div></div><div class=paragraph><p>Dit biedt real-time-uitbreidingen die in de 1993 POSIX® zijn toegevoegd. Bepaalde applicaties in de Portscollectie gebruiken deze (zoals StarOffice™).</p></div><div class="literalblock programlisting"><div class=content><pre>options   KBD_INSTALL_CDEV    # installeer een CDEV-ingang in /dev</pre></div></div><div class=paragraph><p>Deze optie is nodig om apparaatknooppunten voor het toetsenbord aan te maken in <span class=filename>/dev</span>.</p></div><div class="literalblock programlisting"><div class=content><pre>options   ADAPTIVE_GIANT      # Giant mutex is adaptief.</pre></div></div><div class=paragraph><p>Giant is de naam van een wederzijds uitsluitingsmechanisme (een sleep mutex) dat een grote verzameling kernelbronnen beschermt. Vandaag de dag is dit een onacceptabele prestatie-bottleneck die actief door sloten wordt vervangen die individuele bronnen beschermen. De optie <code>ADAPTIVE_GIANT</code> zorgt ervoor dat Giant in de verzamelingen van mutexen wordt opgenomen waar actief wordt opgespind. Dit betekent dat wanneer een thread de Giant-mutex wil nemen, maar die reeds door een thread op een andere CPU genomen is, de eerste thread blijft draaien en wacht tot er een slot vrijkomt. Normaalgesproken zou de thread weer gaan slapen en wachten op de volgende kans om te draaien. Laat dit er in geval van twijfel instaan.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Merk op dat in FreeBSD 8.0-RELEASE en later alle mutexen standaard adaptief zijn, tenzij ze expliciet op niet-adaptief zijn gezet door met de optie <code>NO_ADAPTIVE_MUTEXES</code> te compileren. Een gevolg is dat Giant nu standaard adaptief is, en dat de optie <code>ADAPTIVE_GIANT</code> uit de kernelinstellingen is verwijderd.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>device    apic      # I/O APIC</pre></div></div><div class=paragraph><p>Het apic-apparaat zet de ondersteuning voor I/O-APIC voor het afleveren van interrupts aan. Het apic-apparaat kan zowel in UP- als in SMP-kernels gebruikt worden, maar is noodzakelijk voor SMP-kernels. Voeg <code>options SMP</code> toe om ondersteuning voor meerdere processoren op te nemen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het apic-apparaat bestaat alleen in de i386-architectuur, deze instelregel dient niet op andere architecturen gebruikt te worden.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>device    eisa</pre></div></div><div class=paragraph><p>Neem dit op voor een EISA-moederbord. Dit zet ondersteuning voor zelfdetectie en -instelling aan voor alle apparaten op de EISA-bus.</p></div><div class="literalblock programlisting"><div class=content><pre>device    pci</pre></div></div><div class=paragraph><p>Neem dit op voor een PCI-moederbord. Dit zet ondersteuning voor zelfdetectie van PCI-kaarten en gatewaying van PCI-naar-ISA-bus aan.</p></div><div class="literalblock programlisting"><div class=content><pre># Floppy drives
device	  fdc</pre></div></div><div class=paragraph><p>Dit is de controller voor de floppydrive.</p></div><div class="literalblock programlisting"><div class=content><pre># ATA- en ATAPI-apparaten
device	  ata</pre></div></div><div class=paragraph><p>Dit stuurprogramma biedt ondersteuning aan alle ATA- en ATAPI-apparaten. Er is slechts één <code>device ata</code>-regel nodig om de kernel alle PCI ATA/ATAPI-apparaten te laten ontdekken op moderne machines.</p></div><div class="literalblock programlisting"><div class=content><pre>device    atadisk   # ATA schijven</pre></div></div><div class=paragraph><p>Dit is samen met <code>device ata</code> nodig voor ATA schijven.</p></div><div class="literalblock programlisting"><div class=content><pre>device    ataraid   # ATA RAID schijven</pre></div></div><div class=paragraph><p>Dit is samen met <code>device ata</code> nodig voor ATA RAID-schijven.</p></div><div class="literalblock programlisting"><div class=content><pre>device	  atapicd   # ATAPI CD-ROM drives</pre></div></div><div class=paragraph><p>Dit is samen met <code>device ata</code> nodig voor ATAPI CD-ROM drives.</p></div><div class="literalblock programlisting"><div class=content><pre>device   atapifd    # ATAPI floppy drives</pre></div></div><div class=paragraph><p>Dit is samen met <code>device ata</code> nodig voor ATAPI floppydrives.</p></div><div class="literalblock programlisting"><div class=content><pre>device    atapist   # ATAPI tape drives</pre></div></div><div class=paragraph><p>Dit is samen met <code>device ata</code> nodig voor ATAPI tapedrives.</p></div><div class="literalblock programlisting"><div class=content><pre>options   ATA_STATIC_ID   # Statische apparaatnummering</pre></div></div><div class=paragraph><p>Dit zorgt ervoor dat de controller statisch nummert. Zonder deze optie worden nummers dynamisch toegewezen.</p></div><div class="literalblock programlisting"><div class=content><pre># SCSI Controllers
device          ahb        # EISA AHA1742 familie
device          ahc        # AHA2940 en onboard AIC7xxx apparaten
options         AHC_REG_PRETTY_PRINT    # Print registerbitvelden in
                                        # debuguitvoer.  Voegt ~128k
                                        # aan stuurprogramma toe.
device          ahd        # AHA39320/29320 en onboard AIC79xx apparaten
options         AHD_REG_PRETTY_PRINT    # Print registerbitvelden in
                                        # debuguitvoer.  Voegt ~215k
                                        # aan stuurprogramma toe.
device          amd        # AMD 53C974 (Teckram DC-390(T))
device          isp        # Qlogic familie
#device         ispfw      # Firmware voor QLogic HBAs- normaliter een module
device          mpt        # LSI-Logic MPT-Fusion
#device         ncr        # NCR/Symbios Logic
device          sym        # NCR/Symbios Logic (nieuwere chipsets + die van `ncr&#39;)
device          trm        # Tekram DC395U/UW/F DC315U adapters

device          adv        # Advansys SCSI adapters
device          adw        # Advansys wide SCSI adapters
device          aha        # Adaptec 154x SCSI adapters
device          aic        # Adaptec 15[012]x SCSI adapters, AIC-6[23]60.
device          bt         # Buslogic/Mylex MultiMaster SCSI adapters

device          ncv        # NCR 53C500
device          nsp        # Workbit Ninja SCSI-3
device          stg        # TMC 18C30/18C50</pre></div></div><div class=paragraph><p>SCSI controllers. Commentarieer de regels uit voor apparaten die niet in het systeem aanwezig zijn. Als het een systeem met alleen IDE apparaten betreft, kunnen ze allemaal weggelaten worden. De regels met <code>*_REG_PRETTY_PRINT</code> zijn debugopties voor hun respectievelijke stuurprogramma’s.</p></div><div class="literalblock programlisting"><div class=content><pre># SCSI randapparaten
device          scbus      # SCSI bus (nodig voor SCSI)
device          ch         # SCSI media changers
device          da         # Direct Access (schijven)
device          sa         # Sequential Access (tape, enzovoort)
device          cd         # CD
device          pass       # Passthrough apparaat (directe SCSI-toegang)
device          ses        # SCSI Omgevingsdiensten (en SAF-TE)</pre></div></div><div class=paragraph><p>SCSI-aanhangsels. Ook hier geldt dat apparaten die niet aanwezig zijn uitgecommentarieerd kunnen worden, of als alleen IDE-hardware aanwezig is, ze allemaal weggelaten kunnen worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het USB-stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> en enkele andere stuurprogramma’s gebruiken het SCSI-subsysteem, alhoewel ze geen echte SCSI-apparaten zijn. Daarom mag SCSI-ondersteuning niet verwijderd worden als dit soort stuurprogramma’s in de kernelinstellingen worden opgenomen.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre># RAID controllers met interfaces naar het SCSI subsysteem
device          amr        # AMI MegaRAID
device          arcmsr     # Areca SATA II RAID
device          asr        # DPT SmartRAID V, VI en Adaptec SCSI RAID
device          ciss       # Compaq Smart RAID 5*
device          dpt        # DPT Smartcache III, IV - Zie NOTES voor opties
device          hptmv      # Highpoint RocketRAID 182x
device          hptrr      # Highpoint RocketRAID 17xx, 22xx, 23xx, 25xx
device          iir        # Intel Integrated RAID
device          ips        # IBM (Adaptec) ServeRAID
device          mly        # Mylex AcceleRAID/eXtremeRAID
device          twa        # 3ware 9000 series PATA/SATA RAID

# RAID controllers
device          aac        # Adaptec FSA RAID
device          aacp       # SCSI passthrough voor aac (heeft CAM nodig)
device          ida        # Compaq Smart RAID
device          mfi        # LSI MegaRAID SAS
device          mlx        # Mylex DAC960 famile
device          pst        # Promise Supertrak SX6000
device          twe        # 3ware ATA RAID</pre></div></div><div class=paragraph><p>Ondersteunde RAID-controllers. Als een van deze niet aanwezig is, kan deze uitgecommentarieerd of verwijderd worden.</p></div><div class="literalblock programlisting"><div class=content><pre># atkbdc0 bestuurt het toetsenbord en de PS/2 muis
device    atkbdc    # AT toetsenbordcontroller</pre></div></div><div class=paragraph><p>De toetsenbordcontroller (<code>atkbdc</code>) biedt I/O-diensten aan voor het AT-toetsenbord en het PS/2-type van aanwijsapparaten. Deze controller is noodzakelijk voor het toetsenbordstuurprogramma (<code>atkbd</code>) en het PS/2-aanwijsapparaatstuurprogramma (<code>psm</code>).</p></div><div class="literalblock programlisting"><div class=content><pre>device    atkbd     # AT toetsenbord</pre></div></div><div class=paragraph><p>Het stuurprogramma <code>atkbd</code> biedt samen met de controller <code>atkbdc</code> toegang tot het AT84-toetsenbord of het uitgebreide AT-toetsenbord dat verbonden is met de controller voor het AT-toetsenbord.</p></div><div class="literalblock programlisting"><div class=content><pre>device    psm       # PS/2 muis</pre></div></div><div class=paragraph><p>Dit apparaat kan gebruikt worden als de muis in de PS/2-muispoort wordt geplugd.</p></div><div class="literalblock programlisting"><div class=content><pre>device    kbdmux    # toetsenbordmultiplexer</pre></div></div><div class=paragraph><p>Basisondersteuning voor multiplexing van toetsenborden. Als u niet van plan bent om meerdere toetsenborden op het systeem te gebruiken, kunt u deze regel veilig verwijderen.</p></div><div class="literalblock programlisting"><div class=content><pre>device    vga       # VGA videokaart stuurprogramma</pre></div></div><div class=paragraph><p>Het stuurprogramma voor de videokaart.</p></div><div class="literalblock programlisting"><div class=content><pre>device    splash    # Splash screen en screensaver ondersteuning</pre></div></div><div class=paragraph><p>Een splash-scherm tijdens het opstarten! Screensavers hebben deze optie ook nodig.</p></div><div class="literalblock programlisting"><div class=content><pre># syscons is het standaard consolestuurprogramma, lijkt op een SCO console
device	  sc</pre></div></div><div class=paragraph><p><code>sc</code> is het standaard consolestuurprogramma en lijkt op een SCO-console. Aangezien de meeste programma’s die met een volledig scherm werken de console via een terminaldatabase zoals <span class=filename>termcap</span> benaderen, moet het niet uitmaken of dit of <code>vt</code>, het <code>VT220</code>-compatibele consolestuurprogramma, gebruikt wordt. Wanneer er aangemeld wordt, dient de variabele <code>TERM</code> op <code>scoansi</code> gezet worden indien programma’s die met een volledig scherm werken problemen hebben om met dit console te draaien.</p></div><div class="literalblock programlisting"><div class=content><pre># Schakel dit in voor het pcvt (VT220 compatibele) consolestuurprogramma
#device     vt
#options    XSERVER     # ondersteuning voor X server op een vt console
#options    FAT_CURSOR  # begin met een blokcursor</pre></div></div><div class=paragraph><p>Dit is een VT220-compatibel consolestuurprogramma, achterwaarts compatibel met de VT100/102. Het werkt goed op enkele laptops die hardware-incompatibiliteiten hebben met <code>sc</code>. Ook dient de variabele <code>TERM</code> op <code>vt100</code> of <code>vt220</code> gezet te worden bij het aanmelden. Dit stuurprogramma kan ook nuttig zijn wanneer er verbinding wordt gemaakt met een groot aantal verschillende machines in een netwerk, waarbij de ingangen <span class=filename>termcap</span> of <span class=filename>terminfo</span> voor het apparaat <code>sc</code> vaak niet beschikbaar zijn. <code>vt100</code> is op bijna elk platform beschikbaar.</p></div><div class="literalblock programlisting"><div class=content><pre>device    agp</pre></div></div><div class=paragraph><p>Neem dit op als er een AGP-kaart in het systeem aanwezig is. Dit zet ondersteuning voor AGP aan, en ondersteuning voor AGP GART voor borden die deze mogelijkheden hebben.</p></div><div class="literalblock programlisting"><div class=content><pre># Ondersteuning voor energiebeheer (zie NOTES voor meer opties)
#device	  apm</pre></div></div><div class=paragraph><p>Ondersteuning voor geavanceerd energiebeheer (Advanced Power Management). Dit is nuttig voor laptops, alhoewel dit standaard uitgeschakeld is in <span class=filename>GENERIC</span>.</p></div><div class="literalblock programlisting"><div class=content><pre># Schakel suspend/resume ondersteuning voor de i8254 in.
device	  pmtimer</pre></div></div><div class=paragraph><p>Het stuurprogramma voor het timerapparaat voor energiebeheergebeurtenissen, zoals APM en ACPI.</p></div><div class="literalblock programlisting"><div class=content><pre># PCCARD (PCMCIA) ondersteuning.
# PCMCIA en cardbus bridge ondersteuning.
device    cbb       # cardbus (yenta) bridge
device    pccard    # PC Card (16-bit) bus
device    cardbus   # CardBus (32-bit) bus</pre></div></div><div class=paragraph><p>Ondersteuning voor PCMCIA. Dit is wenselijk voor laptopgebruikers.</p></div><div class="literalblock programlisting"><div class=content><pre># Serial (COM) poorten
device    sio       # 8250, 16[45]50-gebaseerde seriële poorten</pre></div></div><div class=paragraph><p>Dit zijn de seriële poorten waarnaar in de wereld van MS-DOS®/Windows® verwezen wordt als <span class=filename>COM</span>-poorten.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als er een intern modem op <span class=filename>COM4</span> en een seriële poort op <span class=filename>COM2</span> aanwezig is, moet het IRQ van het modem in 2 worden veranderd (om duistere technische redenen geldt dat IRQ2 = IRQ9) om er vanuit FreeBSD toegang toe te krijgen. Als er een multipoort seriële kaart aanwezig is, staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> meer informatie over de juiste waarden die aan <span class=filename>/boot/device.hints</span> toegevoegd moeten worden. Sommige videokaarten (vaak gebaseerd op S3 chips) gebruiken IO-adressen van de vorm <code>0x*2e8</code>, en omdat vele goedkope serieële kaarten de 16-bits IO-adresruimte niet volledig decoderen, botsen ze met deze kaarten waardoor de <span class=filename>COM4</span>-poort praktisch onbruikbaar is.</p></div><div class=paragraph><p>Elke serieële poort moet een uniek IRQ hebben (tenzij er gebruik wordt gemaakt van een van de multipoortkaarten waarbij gedeelde interrupts ondersteund worden), dus kunnen de standaard IRQ’s voor <span class=filename>COM3</span> en <span class=filename>COM4</span> niet gebruikt worden.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre># Parallelle poort
device    ppc</pre></div></div><div class=paragraph><p>Dit is de interface voor de parallelle poort op de ISA-bus.</p></div><div class="literalblock programlisting"><div class=content><pre>device    ppbus     # Parallelle poortbus (verplicht)</pre></div></div><div class=paragraph><p>Biedt ondersteuning voor de parallelle poortbus.</p></div><div class="literalblock programlisting"><div class=content><pre>device    lpt       # Printer</pre></div></div><div class=paragraph><p>Ondersteuning voor parallelle poort-printers.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Alle van de bovenstaande drie zijn noodzakelijk om ondersteuning voor parallelle printers aan te zetten.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>device    ppi       # Parallelle poort interface apparaat</pre></div></div><div class=paragraph><p>De algemene I/O ("geek-poort") + IEEE1284 I/O.</p></div><div class="literalblock programlisting"><div class=content><pre>#device   vpo       # scbus en da verplicht</pre></div></div><div class=paragraph><p>Dit is voor een Iomega Zipdrive. Hiervoor is ondersteuning voor <code>scbus</code> en <code>da</code> nodig. De beste prestaties worden gehaald met poorten in EPP 1.9-modus.</p></div><div class="literalblock programlisting"><div class=content><pre>#device   puc</pre></div></div><div class=paragraph><p>Dit dient uitgecommentarieerd te worden indien er een "domme" seriële of parallelle PCI-kaart aanwezig is die ondersteund wordt door het <a href="https://man.freebsd.org/cgi/man.cgi?query=puc&amp;sektion=4&amp;format=html">puc(4)</a> verbindingsstuurprogramma.</p></div><div class="literalblock programlisting"><div class=content><pre># PCI Ethernet NIC&#39;s.
device    de        # DEC/Intel DC21x4x (Tulip)
device    em        # Intel PRO/1000 adapter Gigabit Ethernet Card
device    ixgb      # Intel PRO/10GbE Ethernet Card
device    txp       # 3Com 3cR990 (Typhoon)
device    vx        # 3Com 3c590, 3c595 (Vortex)</pre></div></div><div class=paragraph><p>Verscheidene PCI-netwerkkaartstuurprogramma’s. Degenen die niet in het systeem aanwezig zijn kunnen uitgecommentarieerd of verwijderd worden.</p></div><div class="literalblock programlisting"><div class=content><pre># PCI Ethernet NIC&#39;s die de MII bus controller code gebruiken.
# NB: &#39;device miibus&#39; moet behouden blijven om deze NIC&#39;s te kunnen gebruiken!
device    miibus    # MII bus ondersteuning</pre></div></div><div class=paragraph><p>Ondersteuning voor MII-bus is noodzakelijk voor sommige PCI 10/100 Ethernet-NICs, namelijk voor diegenen die MII-geldige transceivers gebruiken of interfaces voor transceiverbesturing implementeren die als een MII werken. Door <code>device miibus</code> aan de kernelinstellingen toe te voegen wordt de ondersteuning voor de generieke miibus-API en voor alle PHY-stuurprogramma’s opgenomen, waaronder een generieke voor PHYs die niet specifiek door een individueel stuurprogramma worden behandeld.</p></div><div class="literalblock programlisting"><div class=content><pre>device    bce       # Broadcom BCM5706/BCM5708 Gigabit Ethernet
device    bfe       # Broadcom BCM440x 10/100 Ethernet
device    bge       # Broadcom BCM570xx Gigabit Ethernet
device    dc        # DEC/Intel 21143 en verschillende gelijkwerkenden
device    fxp       # Intel EtherExpress PRO/100B (82557, 82558)
device    lge       # Level 1 LXT1001 gigabit Ethernet
device    msk       # Marvell/SysKonnect Yukon II Gigabit Ethernet
device    nge       # NatSemi DP83820 gigabit Ethernet
device    nve       # nVidia MCP on-board Ethernet Networking
device    pcn       # AMD Am79C97x PCI 10/100 (voorrang op &#39;lnc&#39;)
device    re        # RealTek 8139C+/8169/8169S/8110S
device    rl        # RealTek 8129/8139
device    sf        # Adaptec AIC-6915 (Starfire)
device    sis       # Silicon Integrated Systems SiS 900/SiS 7016
device    sk        # SysKonnect SK-984x &amp; SK-982x gigabit Ethernet
device    ste       # Sundance ST201 (D-Link DFE-550TX)
device    stge      # Sundance/Tamarack TC9021 gigabit Ethernet
device    ti        # Alteon Networks Tigon I/II gigabit Ethernet
device    tl        # Texas Instruments ThunderLAN
device    tx        # SMC EtherPower II (83c170 EPIC)
device    ge        # VIA VT612x gigabit Ethernet
device    vr        # VIA Rhine, Rhine II
device    wb        # Winbond W89C840F
device    xl        # 3Com 3c90x (Boomerang, Cyclone)</pre></div></div><div class=paragraph><p>Stuurprogramma’s die gebruik maken van de MII bus-controllercode.</p></div><div class="literalblock programlisting"><div class=content><pre># ISA Ethernet NIC&#39;s.  Inclusief pccard NIC&#39;s.
device    cs        # Crystal Semiconductor CS89x0 NIC
# &#39;device ed&#39; heeft &#39;device miibus&#39; nodig
device    ed        # NE[12]000, SMC Ultra, 3c503, DS8390 kaarten
device    ex        # Intel EtherExpress Pro/10 en Pro/10+
device    ep        # Etherlink III-gebaseerde kaarten
device    fe        # Fujitsu MB8696x-gebaseerde kaarten
device    ie        # EtherExpress 8/16, 3C507, StarLAN 10, etc.
device    lnc       # NE2100, NE32-VL Lance Ethernet kaarten
device    sn        # SMC&#39;s 9000 serie Ethernet chips
device    xe        # Xircom pccard Ethernet

# ISA apparaten die de oude ISA shims gebruiken
#device   le</pre></div></div><div class=paragraph><p>ISA Ethernetstuurprogramma’s. In <span class=filename>/usr/src/sys/i386/conf/NOTES</span> staan details over welke kaarten door welk stuurprogramma ondersteund worden.</p></div><div class="literalblock programlisting"><div class=content><pre># Draadloze NIC kaarten
device    wlan      # 802.11 ondersteuning</pre></div></div><div class=paragraph><p>Generieke 802.11 ondersteuning. Deze regel is vereist voor draadloos netwerken.</p></div><div class="literalblock programlisting"><div class=content><pre>device          wlan_wep  # 802.11 WEP-ondersteuning
device          wlan_ccmp   # 802.11 CCMP-ondersteuning
device          wlan_tkip   # 802.11 TKIP-ondersteuning</pre></div></div><div class=paragraph><p>Crypto-ondersteuning voor 802.11-apparaten. Deze regels zijn nodig als u van plan bent om versleuteling en 802.11i-beveiligingsprotocollen te gebruiken.</p></div><div class="literalblock programlisting"><div class=content><pre>device          an              # Aironet 4500/4800 802.11 draadloze NIC&#39;s.
device          ath             # Atheros PCI/CardBus NICs
device          ath_hal         # Atheros HAL (Hardware Access Layer)
device          ath_rate_sample # SampleRate verzendsnelheidbeheer voor ath
device          awi        # BayStack 660 en anderen
device          ral        # Ralink Technologies RT2500 draadloze NICs.
device          wi         # WaveLAN/Intersil/Symbol 802.11 draadloze NIC&#39;s.
#device         wl         # Oudere niet-802.11 Wavelan draadloze NIC.</pre></div></div><div class=paragraph><p>Ondersteuning voor verscheidene draadloze kaarten.</p></div><div class="literalblock programlisting"><div class=content><pre># Pseudo-apparaten
device    loop      # Netwerk teruglussen</pre></div></div><div class=paragraph><p>Dit is het generieke teruglusapparaat voor TCP/IP. Als telnet of FTP op <code>localhost</code> (ook bekend als <code>127.0.0.1</code>) gebruikt wordt, loopt dat via dit apparaat. Dit is <em>verplicht</em>.</p></div><div class="literalblock programlisting"><div class=content><pre>device    random    # Entropy apparaat</pre></div></div><div class=paragraph><p>Cryptografisch veilige willekeurige getallengenerator.</p></div><div class="literalblock programlisting"><div class=content><pre>device    ether     # Ethernet ondersteuning</pre></div></div><div class=paragraph><p><code>ether</code> is allen noodzakelijk als er een Ethernetkaart aanwezig is. Het bevat code voor het generieke Ethernetprotocol.</p></div><div class="literalblock programlisting"><div class=content><pre>device    sl        # Kernel SLIP</pre></div></div><div class=paragraph><p><code>sl</code> dient voor SLIP-ondersteuning. Dit is bijna geheel overgenomen door PPP, wat eenvoudiger is op te zetten, beter geschikt is voor modem-naar-modem-verbindingen en krachtiger is.</p></div><div class="literalblock programlisting"><div class=content><pre>device    ppp       # Kernel PPP</pre></div></div><div class=paragraph><p>Dit dient voor PPP-ondersteuning van inbelverbindingen door de kernel. Er is ook een versie van PPP als gebruikersapplicatie geïmplementeerd die <code>tun</code> gebruikt en meer flexibiliteit en mogelijkheden biedt zoals demand-bellen.</p></div><div class="literalblock programlisting"><div class=content><pre>device    tun       # Packet tunnel.</pre></div></div><div class=paragraph><p>Dit wordt gebruikt door de gebruikers-PPP-software. In <a href=./#userppp>PPP</a> staat meer informatie.</p></div><div class="literalblock programlisting"><div class=content><pre>device    pty       # Pseudo-ttys (telnet, etc.)</pre></div></div><div class=paragraph><p>Dit is een "pseudo-terminal" of gesimuleerde aanmeldpoort. Die wordt gebruikt door binnenkomende sessies van <code>telnet</code> en <code>rlogin</code>, door xterm en voor sommige andere applicaties zoals Emacs.</p></div><div class="literalblock programlisting"><div class=content><pre>device    md        # Geheugenschijven</pre></div></div><div class=paragraph><p>Pseudo-apparaten die een schijf in het geheugen implementeren.</p></div><div class="literalblock programlisting"><div class=content><pre>device    gif       # IPv6 en IPv4 tunnelen</pre></div></div><div class=paragraph><p>Dit implementeert IPv6-over-IPv4-tunneling, IPv4-over-IPv6-tunneling, IPv4-over-IPv4-tunneling en IPv6-over-IPv6-tunneling. Het apparaat <code>gif</code> is "zelfklonend" en zal naar behoefte apparaatknooppunten aanmaken.</p></div><div class="literalblock programlisting"><div class=content><pre>device    faith     # IPv6-naar-IPv4-relay (vertaling)</pre></div></div><div class=paragraph><p>Dit pseudo-apparaat onderschept pakketten die ernaar verzonden worden en leidt ze om naar het IPv4/IPv6-vertaaldaemon.</p></div><div class="literalblock programlisting"><div class=content><pre># Het `bpf&#39; apparaat schakelt de Berkeley Pakketfilter in.
# Wees bewust van de administratieve consequenties die dit heeft!
# &#39;bpf&#39; is nodig bij gebruik van DHCP.
device    bpf       # Berkeley pakketfilter</pre></div></div><div class=paragraph><p>Dit is het Berkeley Pakketfilter. Dit pseudo-apparaat staat netwerkinterfaces toe om in luistermodus gezet te worden, zodat elk pakket op een uitzendnetwerk (bijvoorbeeld een Ethernet) onderschept wordt. Deze pakketten kunnen naar schijf onderschept en/of onderzocht worden met het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het apparaat <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> wordt ook gebruikt door <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a> om het IP-adres van de standaardrouter (gateway) te verkrijgen, enzovoorts. Als DHCP gebruikt wordt, dient dit ingeschakeld te blijven.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre># USB-ondersteuning
device          uhci          # UHCI PCI-&gt;USB interface
device          ohci          # OHCI PCI-&gt;USB interface
device          ehci          # EHCI PCI-&gt;USB interface (USB 2.0)
device          usb           # USB Bus (verplicht)
#device         udbp          # USB Double Bulk Pipe apparaten
device          ugen          # Generic
device          uhid          # Human Interface Devices
device          ukbd          # Toetsenbord
device          ulpt          # Printer
device          umass         # Schijven/Massaopslag - heeft scbus en da nodig
device          ums           # Muis
device          ural          # Ralink Technology RT2500USB draadloze NICs
device          urio          # Diamond Rio 500 MP3 speler
device          uscanner      # Scanners
# USB Ethernet, heeft mii nodig
device          aue           # ADMtek USB Ethernet
device          axe           # ASIX Electronics USB Ethernet
device          cdce          # Generic USB over Ethernet
device          cue           # CATC USB Ethernet
device          kue           # Kawasaki LSI USB Ethernet
device          rue           # RealTek RTL8150 USB Ethernet</pre></div></div><div class=paragraph><p>Ondersteuning voor verscheidene USB-apparaten.</p></div><div class="literalblock programlisting"><div class=content><pre># FireWire ondersteuning
device    firewire  # FireWire bus code
device    sbp       # SCSI over FireWire (scbus en da nodig)
device    fwe       # Ethernet over FireWire (niet-standaard!)</pre></div></div><div class=paragraph><p>Ondersteuning voor verscheidene Firewire-apparaten.</p></div><div class=paragraph><p>Meer informatie en aanvullende apparaten die door FreeBSD ondersteund worden staan in <span class=filename>/usr/src/sys/i386/conf/NOTES</span>.</p></div><div class=sect3><h4 id=_instellingen_bij_veel_geheugen_pae>9.6.1. Instellingen bij veel geheugen (PAE)<a class=anchor href=#_instellingen_bij_veel_geheugen_pae></a></h4><div class=paragraph><p>Sommige machines (PAE) hebben meer geheugen nodig dan limiet van 4 gigabyte op User+Kernel Virtual Adress (KVA) ruimte. Vanwege deze limiet voegde Intel ondersteuning toe voor toegang tot 36-bits fysieke adresruimte in de Pentium® Pro en nieuwere lijn van CPU’s.</p></div><div class=paragraph><p>De Physical Address Extension (PAE) mogelijkheden van de Intel® Pentium® Pro en nieuwere CPU’s staan geheugenhoeveelheden toe tot 64 gigabyte. FreeBSD biedt ondersteuning voor deze mogelijkheid via de kernelinsteloptie <code>PAE</code>, die beschikbaar is in alle recent uitgegeven versies van FreeBSD. Vanwege de beperkingen van de geheugenarchitectuur van Intel wordt er geen onderscheid gemaakt tussen geheugen boven of beneden 4 gigabytes. Geheugen dat boven de 4 gigabytes is toegewezen wordt gewoon bij het beschikbare gevoegd.</p></div><div class=paragraph><p>Om ondersteuning voor PAE in de kernel aan te zetten, dient de volgende regel aan het kernelinstellingenbestand te worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>options   PAE</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De ondersteuning voor PAE in FreeBSD is alleen beschikbaar voor Intel® IA-32-processoren. Ook dient opgemerkt te worden dat ondersteuning voor PAE nog niet wijdverbreid getest is en als betakwaliteit beschouwd dient te worden vergeleken met andere stabiele kenmerken van FreeBSD.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ondersteuning voor PAE in FreeBSD heeft enige beperkingen:</p></div><div class=ulist><ul><li><p>Een proces kan niet meer dan 4 gigabyte VM-ruimte krijgen;</p></li><li><p>Apparaatstuurprogramma’s die geen gebruik maken van de <a href="https://man.freebsd.org/cgi/man.cgi?query=bus_dma&amp;sektion=9&amp;format=html">bus_dma(9)</a>-interface zullen gegevenscorruptie veroorzaken in een kernel die PAE aan heeft staan en hun gebruik wordt afgeraden. Om deze reden wordt er de kernelinstellingenbestand voor de PAE-kernel geleverd met FreeBSD, dat alle stuurprogramma’s uitsluit waarvan niet bekend is dat ze werken in een kernel die PAE aan heeft staan;</p></li><li><p>Sommige systeeminstellingen bepalen het geheugenbronverbruik aan de hand van de hoeveelheid beschikbaar fysiek geheugen. Zulke instellingen kunnen onnodig veel toewijzen vanwege de grote hoeveelheid geheugen in een PAE systeem. Een voorbeeld hiervan is de sysctl <code>kern.maxvnodes</code>, die het maximum aantal vnodes dat in de kernel aanwezig mag zijn beheert. Het is aan te raden om deze en andere van dit soort instellingen aan te passen aan een redelijke waarde;</p></li><li><p>Het kan nodig zijn om de virtuele kerneladresruimte (KVA) te vergroten of om het aantal kernelbronnen dat veel gebruikt wordt (zie boven) te verminderen om zo uitputting van KVA te voorkomen. De kerneloptie <code>KVA_PAGES</code> kan gebruikt worden om de KVA-ruimte te vergroten.</p></li></ul></div><div class=paragraph><p>Om prestatie- en stabiliteitsredenen is het aan te raden om <a href="https://man.freebsd.org/cgi/man.cgi?query=tuning&amp;sektion=7&amp;format=html">tuning(7)</a> te raadplegen. <a href="https://man.freebsd.org/cgi/man.cgi?query=pae&amp;sektion=4&amp;format=html">pae(4)</a> bevat bijgewerkte informatie over de ondersteuning voor PAE in FreeBSD.</p></div></div></div><div class=sect2><h3 id=kernelconfig-trouble>9.7. Problemen oplossen<a class=anchor href=#kernelconfig-trouble></a></h3><div class=paragraph><p>Er zijn vier probleemcategoriën die op kunnen treden tijdens het bouwen van een aangepaste kernel:</p></div><div class=dlist><dl><dt class=hdlist1><code>config</code> faalt</dt><dd><p>Als het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a> faalt bij het verwerken van de kernelbeschrijving, is er waarschijnlijk ergens een eenvoudige fout gemaakt. Gelukkig geeft <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a> het nummer van de regel weer waarmee het problemen had, dus kan snel de regel gevonden worden waarin de fout zit. In het onderstaande voorbeeld dient gecontroleerd te worden of het sleutelwoord juist is ingevoerd door het met de kernel <span class=filename>GENERIC</span> of een andere referentie te vergelijken:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>config: line 17: syntax error</code></pre></div></div></dd><dt class=hdlist1><code>make</code> faalt</dt><dd><p>Als <code>make</code> faalt, duidt dit meestal op een fout in de kernelbeschrijving die niet erg genoeg is om door <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a> opgemerkt te worden. De instellingen dienen nogmaals nagekeken te worden. Als het probleem nog steeds niet is op te lossen, stuur dan een mail naar de <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD algemene vragen mailinglijst</a> met de kernelinstellingen. Dat leidt meestal snel tot een diagnose.</p></dd><dt class=hdlist1>De kernel start niet op<a id=kernelconfig-noboot></a></dt><dd><p>Als de nieuwe kernel niet opstart of de apparaten niet herkent is kalmte geboden. FreeBSD heeft een uitstekend mechanisme om van niet-compatibele kernels te herstellen. De gewenste kernel om mee op te starten kan vanuit de FreeBSD boot loader gekozen worden. Als het systeemopstartmenu verschijnt, kan deze gekozen worden. Selecteer de optie "Escape to a loader prompt", nummer zes. Typ op de prompt <code>boot kernel.old</code> of de naam van een andere kernel die correct opstart. Als de kernelinstellingen gewijzigd worden, is het altijd aan te raden om een kernel bij de hand te houden waarvan bekend is dat die juist werkt.</p><div class=paragraph><p>Nadat er met een goede kernel is opgestart, kan het instellingenbestand gecontroleerd worden en geprobeerd worden om de kernel nogmaals te bouwen. Een behulpzame bron is het bestand <span class=filename>/var/log/messages</span>, dat onder andere alle kernelberichten van alle keren dat er succesvol is opgestart vastlegt. Ook geeft <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> alle kernelberichten weer van de huidige opstartprocedure.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als er problemen zijn met het bouwen van een kernel, dient een <span class=filename>GENERIC</span>, of een andere kernel waarvan bekend is dat die werkt, bewaard te worden onder een andere naam die niet verwijderd wordt als de volgende kernel gebouwd wordt. Er kan niet op <span class=filename>kernel.old</span> vertrouwd worden omdat bij de installatie van een nieuwe kernel <span class=filename>kernel.old</span> overschreven wordt met de laatst geïnstalleerde kernel, die niet hoeft te werken. Ook dient de werkende kernel zo snel mogelijk naar de juiste plaats <span class=filename>/boot/kernel</span> verplaatst te worden, omdat anders commando’s als <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> eventueel onjuist werken. Hiervoor dient simpelweg de map met de goede kernel hernoemd te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mv /boot/kernel /boot/kernel.slecht</span>
<span class=c># mv /boot/kernel.goed /boot/kernel</span></code></pre></div></div></td></tr></tbody></table></div></dd><dt class=hdlist1>De kernel werkt, maar <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> werkt niet meer</dt><dd><p>Als er een andere versie van de kernel is geïnstalleerd dan degene waarmee de systeemgereedschappen gebouwd zijn, bijvoorbeeld een kernel voor -CURRENT op een -RELEASE-systeem, werken vele systeemstatuscommando’s als <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=vmstat&amp;sektion=8&amp;format=html">vmstat(8)</a> niet langer. De wereld moet opnieuw gecompileerd en geïnstalleerd worden en met dezelfde broncodestructuur als de kernel zijn gebouwd. Dit is een van de redenen waarom het normaliter geen goed idee is om een afwijkende versie van de kernel ten opzichte van de rest van de wereld te gebruiken.</p></dd></dl></div></div></div></div><div class=sect1><h2 id=printing>Hoofdstuk 10. Afdrukken<a class=anchor href=#printing></a></h2><div class=sectionbody><div class=sect2><h3 id=printing-synopsis>10.1. Overzicht<a class=anchor href=#printing-synopsis></a></h3><div class=paragraph><p>FreeBSD kan gebruikt worden om op een scala aan printers af te drukken, van de oudste matrixprinter tot de nieuwste laserprinters en alles er tussenin, waardoor op hoge kwaliteit afgedrukt kan worden vanuit de gebruikte programma’s.</p></div><div class=paragraph><p>FreeBSD kan ook ingesteld worden als printserver in een netwerk. Dan kan FreeBSD afdrukopdrachten ontvangen van uiteenlopende computers, waaronder FreeBSD computers, Windows® en Mac OS® hosts. FreeBSD zorgt ervoor dat er één afdrukopdracht per keer wordt afgedrukt, houdt statistieken bij van gebruikers en computers die de meeste afdrukken maken, drukt "voorbladen" af, zodat duidelijk is van wie de afdruk is en nog veel meer.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe het FreeBSD afdrukwachtrijsysteem moet worden ingesteld;</p></li><li><p>Hoe afdrukfilters kunnen worden geïnstalleerd, om bepaalde afdrukopdrachten op een andere manier af te handelen, zoals het omzetten van documenten naar formaten die een printer begrijpt;</p></li><li><p>Hoe voorbladen kunnen worden afgedrukt;</p></li><li><p>Hoe er op printers die op andere computers zijn aangesloten kan worden afgedrukt;</p></li><li><p>Hoe er op printers die direct op het netwerk zijn aangesloten kan worden afgedrukt;</p></li><li><p>Hoe afdrukbeperkingen kunnen worden opgelegd, zoals het beperken van de grootte van de afdrukopdracht, en bepaalde gebruikers verbieden af te drukken;</p></li><li><p>Hoe afdrukstatistieken kunnen worden bijgehouden en het printergebruik in de gaten kan worden gehouden;</p></li><li><p>Hoe problemen met afdrukken kunnen worden opgelost.</p></li></ul></div><div class=paragraph><p>Aangeraden voorkennis:</p></div><div class=ulist><ul><li><p>Hoe een nieuwe kernel wordt ingesteld, gebouwd en geïnstalleerd (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li></ul></div></div><div class=sect2><h3 id=printing-intro-spooler>10.2. Inleiding<a class=anchor href=#printing-intro-spooler></a></h3><div class=paragraph><p>Om printers onder FreeBSD te kunnen gebruiken moeten ze kunnen werken met het Berkeley lijnafdrukwachtrijsysteem, ook wel bekend als het wachtrijsysteem LPD of simpelweg LPD. Dit is het standaard afdruksysteem onder FreeBSD. Dit hoofdstuk introduceert LPD en begeleidt bij het instellen.</p></div><div class=paragraph><p>Als de gebruiker al bekend is met LPD of een ander afdrukwachtrijsysteem, dan kan verder worden lezen vanaf <a href=#printing-intro-setup>Standaardinstallatie</a>.</p></div><div class=paragraph><p>LPD regelt alles met betrekking tot de printer van een host. Het is verantwoordelijk voor een aantal zaken:</p></div><div class=ulist><ul><li><p>Het regelt de toegang tot aangesloten printers en printers die op andere hosts op het netwerk zijn aangesloten;</p></li><li><p>Het geeft gebruikers de mogelijkheid bestanden aan te bieden die afgedrukt moeten worden; deze aangeboden bestanden worden <em>afdrukopdrachten</em> genoemd;</p></li><li><p>Het voorkomt dat gebruikers tegelijkertijd een printer benaderen door een <em>wachtrij</em> bij te houden voor elke printer;</p></li><li><p>Het kan <em>voorbladen</em> afdrukken (in het Engels ook wel bekend als <em>banner</em>, of <em>burst</em> pagina’s) zodat gebruikers hun afdruk tussen andere afdrukken makkelijk terug kunnen vinden;</p></li><li><p>Het handelt de communicatie af voor printers die op een seriële poort zijn aangesloten;</p></li><li><p>Het kan afdrukopdrachten over een netwerk versturen naar een LPD wachtrij op een andere host;</p></li><li><p>Het kan speciale filters aanroepen die afdrukopdrachten converteren voor verschillende printertalen of afdrukmogelijkheden;</p></li><li><p>Het houdt statistieken bij van het printergebruik.</p></li></ul></div><div class=paragraph><p>Middels een instellingenbestand (<span class=filename>/etc/printcap</span>) en door speciale filters beschikbaar te stellen, kan het LPD systeem alle, of enkele van bovenstaande taken uitvoeren op een grote verscheidenheid aan afdrukhardware.</p></div><div class=sect3><h4 id=printing-intro-why>10.2.1. Waarom het wachtrijsysteem gebruikt zou moeten worden<a class=anchor href=#printing-intro-why></a></h4><div class=paragraph><p>Het wachtrijsysteem biedt nog steeds voordelen op een systeem met een enkele gebruiker en dient gebruikt te worden omdat:</p></div><div class=ulist><ul><li><p>LPD afdrukopdrachten in de achtergrond afhandelt. Dan is het niet nodig te wachten tot de gegevens naar de printer zijn verzonden;</p></li><li><p>LPD op eenvoudige wijze een afdrukopdracht door een filter kan afdrukken om kopteksten met datum/tijd toe te voegen of een speciaal bestandsformaat (zoals een TeX DVI-bestand) om te zetten naar een formaat dat de printer begrijpt. Deze handelingen hoeven dan niet handmatig uitgevoerd te worden;</p></li><li><p>Veel gratis en commerciële software met een afdrukfunctie verwacht dat er een wachtrijsysteem aanwezig is op een systeem om afdrukopdrachten naar te sturen. Door een wachtrijsysteem op te zetten, wordt toekomstig te installeren of reeds geïstalleerde software op eenvoudige wijze ondersteund.</p></li></ul></div></div></div><div class=sect2><h3 id=printing-intro-setup>10.3. Standaardinstallatie<a class=anchor href=#printing-intro-setup></a></h3><div class=paragraph><p>Om printers met het LPD wachtrijsysteem te kunnen gebruiken, dienen zowel de printerhardware als de LPD software geïnstalleerd te worden. Dit document beschrijft deze installatie in twee stappen:</p></div><div class=ulist><ul><li><p>In het onderdeel <a href=#printing-simple>Eenvoudige printerinstallatie</a> staat hoe een printer moet worden aangesloten, hoe LPD er mee kan communiceren en hoe tekstbestanden afgedrukt kunnen worden.</p></li><li><p>In <a href=#printing-advanced>Geavanceerde printerinstallatie</a> staat beschreven hoe een scala aan bestandsformaten afgedrukt kan worden, hoe voorbladen kunnen worden afgedrukt en hoe statistieken van de printer kunnen worden bijgehouden.</p></li></ul></div><div class=sect3><h4 id=printing-simple>10.3.1. Eenvoudige printerinstallatie<a class=anchor href=#printing-simple></a></h4><div class=paragraph><p>Nu wordt toegelicht hoe de printerhardware en de LPD software ingesteld moeten worden om een printer te kunnen gebruiken. Het behandelt de basis:</p></div><div class=ulist><ul><li><p><a href=#printing-hardware>Hardware-instellingen</a> geeft een aantal aanwijzingen voor het aansluiten van een printer op een poort van een computer.</p></li><li><p><a href=#printing-software>Software-instellingen</a> toont hoe het instellingenbestand (<span class=filename>/etc/printcap</span>) voor het LPD-systeem moet worden opgezet.</p></li></ul></div><div class=paragraph><p>Hoe een printer geïnstalleerd moet worden die via een netwerkprotocol gegevens ontvangt, in plaats van een seriële of parallelle poort, staat in <a href=#printing-advanced-network-net-if>Printers met netwerkinterfaces</a>.</p></div><div class=paragraph><p>Hoewel dit onderdeel "Eenvoudige printerinstallatie" heet, is het redelijk complex. De printer met de computer en het LPD-systeem laten samenwerken is het moeilijkste. De geavanceerde opties, zoals voorbladen en statistieken, zijn relatief makkelijk als de printer eenmaal werkt.</p></div><div class=sect4><h5 id=printing-hardware>10.3.1.1. Hardware-instellingen<a class=anchor href=#printing-hardware></a></h5><div class=paragraph><p>Hier worden de verschillende manieren waarop een printer op een computer kan worden aangesloten beschreven. Het bespreekt de soorten poorten en kabels en de kernelinstellingen die nodig kunnen zijn om FreeBSD met een printer te laten communiceren.</p></div><div class=paragraph><p>Als een printer al is aangesloten en succesvol is gebruikt onder een ander besturingssysteem, dan kan waarschijnlijk verder gelezen worden in <a href=#printing-software>Software-instellingen</a>.</p></div><div class=sect5><h6 id=printing-ports>10.3.1.1.1. Poorten en kabels<a class=anchor href=#printing-ports></a></h6><div class=paragraph><p>De printers die tegenwoordig voor PC’s verkocht worden hebben eigenlijk altijd een van de volgende drie poorten:</p></div><div class=ulist><ul><li><p><em>Seriële</em> poort, ook bekend als RS-232- of COM-poorten, gebruiken een seriële poort op een computer om gegevens naar een printer te sturen. Seriële poorten zijn heel gebruikelijk in de computerindustrie en kabels zijn eenvoudig verkrijgbaar en makkelijk te maken. Seriële poorten hebben soms speciale kabels nodig en vereisen soms het instellen van ingewikkelde communicatieparameters. De meeste seriële poorten hebben een maximale doorvoersnelheid van 115.200 bps waardoor het afdrukken van grote grafische afdrukopdrachten erg onpraktisch wordt.</p></li><li><p><em>Parallelle</em> poorten gebruiken een parallelle poort op een computer om gegevens naar een printer te sturen. Parallelle poorten zijn gebruikelijk in de PC-markt en zijn sneller dan RS-232 serieel. Kabels zijn goed verkrijgbaar, maar moeilijker handmatig te vervaardigen. Meestal zijn er geen communicatieparameters bij parallelle poorten, wat het instellen erg eenvoudig maakt.</p><div class=paragraph><p>Parallelle poorten staan ook wel bekend als "Centronics" poorten, genoemd naar het soort aansluiting op de printer.</p></div></li><li><p>USB poorten, genoemd naar de Universal Serial Bus, kunnen zelfs op nog hogere snelheid werken dan parallelle of RS-232 seriële poorten. De kabels zijn eenvoudig en goedkoop. USB is voor afdrukken superieur aan RS-232 Serieel en Parallel, maar wordt op UNIX®-systemen niet altijd goed ondersteund. Een van de manieren om dit te omzeilen is de aanschaf van een printer met zowel een USB als een parallelle poort, zoals veel printers die hebben.</p></li></ul></div><div class=paragraph><p>Over het algemeen kunnen parallelle poorten meestal in één richting communiceren (van computer naar printer), terwijl seriële en USB poorten in twee richtingen kunnen communiceren. Nieuwere parallelle poorten (EPP en ECP) en printers kunnen onder FreeBSD in beide richtingen communiceren, mits een IEEE-1284 gekeurde kabel wordt gebruikt.</p></div><div class=paragraph><p>Tweewegcommunicatie met een printer over een parallelle poort verloopt meestal op een van de volgende twee manieren. De eerste manier is door gebruik te maken van een op maat gemaakt stuurprogramma voor FreeBSD dat de taal spreekt die door de printer wordt gebruikt. Dit geldt meestal voor inkjet printers en er kan dan gebruikt gemaakt worden van rapportagemogelijkheden over bijvoorbeeld inktniveaus en andere statusinformatie. De tweede methode wordt gebruikt als een printer PostScript® ondersteunt.</p></div><div class=paragraph><p>PostScript®-taken zijn eigenlijk programma’s die naar de printer worden gestuurd. Het hoeft zelfs niet in een afdruk te resulteren; het resultaat van de opdracht kan direct weer naar de computer worden gestuurd. PostScript® gebruikt ook tweewegcommunicatie om een computer op de hoogte te stellen van opgetreden fouten, zoals fouten in het PostScript®-programma of vastgelopen papier. Gebruikers kunnen dit soort informatie handig vinden. De beste manier om bij een PostScript®-printer effectief bij te houden wat het printergebruik is, vraagt om tweewegcommunicatie: de printer wordt gevraagd om het totaal aantal afgedrukt pagina’s, de afdrukopdracht wordt verzonden en vervolgens wordt nogmaals om het totaal aantal afgedrukte pagina’s gevraagd. Het verschil van deze getallen geeft het aantal afgedrukte pagina’s van de afdrukopdracht van de betreffende gebruiker.</p></div></div><div class=sect5><h6 id=printing-parallel>10.3.1.1.2. Parallelle poorten<a class=anchor href=#printing-parallel></a></h6><div class=paragraph><p>Om een printer met een parallelle poort aan te sluiten, moet een Centronics kabel de printer met de computer verbinden. De instructies die geleverd zijn bij de printer, de computer of beide, moeten voldoende zijn om dit te verduidelijken.</p></div><div class=paragraph><p>Onthoud op welke parallelle poort de printer is aangesloten. De eerste parallelle poort heet onder FreeBSD <span class=filename>ppc0</span>, de tweede <span class=filename>ppc1</span>, enzovoort. De benaming voor de printer gaat analoog: <span class=filename>/dev/lpt0</span> voor de printer op de eerste parallelle poort enzovoort.</p></div></div><div class=sect5><h6 id=printing-serial>10.3.1.1.3. Seriële poorten<a class=anchor href=#printing-serial></a></h6><div class=paragraph><p>Gebruik de juiste seriële kabel om een printer met een seriële poort op een computer aan te sluiten. De instructies die geleverd zijn bij de printer, de computer of beide, moeten voldoende zijn om dit te verduidelijken.</p></div><div class=paragraph><p>Als onduidelijk is wat de "juiste seriële kabel" is, kan een van onderstaande opties geprobeerd worden:</p></div><div class=ulist><ul><li><p>Een <em>modem</em>kabel verbindt elke pin van de stekker aan het ene eind direct met de corresponderende pin van de stekker aan het andere eind. Dit type kabel heet ook wel een "DTE-naar-DCE"-kabel.</p></li><li><p>Een <em>null-modem</em> kabel verbindt enkele pinnetjes direct, verwisselt andere (bijvoorbeeld van verstuur gegevens naar ontvang gegevens) en sluit sommige draden kort in de stekker. Dit type kabel heet ook wel een "DTE-to-DTE"-kabel.</p></li><li><p>Een <em>seriële printer</em>kabel, nodig bij sommige ongebruikelijke printers, is als een null-modem kabel, maar stuurt sommige signalen naar hun tegenhangers in plaats van ze intern kort te sluiten.</p></li></ul></div><div class=paragraph><p>Het is ook nodig de communicatieparameters voor de printer in te stellen, meestal via het bedieningspaneel of middels DIP-schakelaars op de printer. Selecteer de hoogste <code>bps</code> (bits per seconde, soms <em>baud</em>) die zowel door de computer als de printer wordt ondersteund. Kies 7 of 8 data bits. Geen, even of oneven pariteit en 1 of 2 stop bits. Selecteer ook het flow-control protocol: ofwel geen, ofwel XON/XOFF (ook bekend als "in-band" of "software") flow-control. Onthoud deze instellingen voor de hier op volgende software-instellingen.</p></div></div></div><div class=sect4><h5 id=printing-software>10.3.1.2. Software-instellingen<a class=anchor href=#printing-software></a></h5><div class=paragraph><p>Nu wordt beschreven welke software-instellingen nodig zijn om onder FreeBSD af te drukken met behulp van het wachtrijsysteem LPD.</p></div><div class=paragraph><p>Een overzicht van de te doorlopen stappen:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Maak, indien nodig, de kernel geschikt voor de poort die door de printer wordt gebruikt. In <a href=#printing-kernel>Kernelinstellingen</a> is te lezen hoe dit gedaan kan worden.</p></li><li><p>Stel de communicatievorm voor de parallelle poort in, als gebruik wordt gemaakt van een parallelle printer. In <a href=#printing-parallel-port-mode>Communicatietype instellen voor een parallelle poort</a> staan de details.</p></li><li><p>Test of het besturingssysteem gegevens naar de printer kan sturen. In <a href=#printing-testing>Printercommunicatie controleren</a> staat een aantal suggesties.</p></li><li><p>Stel LPD in voor de printer door <span class=filename>/etc/printcap</span> aan te passen. Dat wordt later in het hoofdstuk beschreven.</p></li></ol></div></div></div><div class=sect5><h6 id=printing-kernel>10.3.1.2.1. Kernelinstellingen<a class=anchor href=#printing-kernel></a></h6><div class=paragraph><p>Het besturingssysteem is gecompileerd om met een beperkte verzameling apparaten te kunnen werken. De seriële en parallelle poorten zijn onderdeel van deze verzameling. Daarom kan het nodig zijn om ondersteuning voor een extra seriële of parallelle poort toe te voegen als een kernel hier nog niet voor is ingesteld.</p></div><div class=paragraph><p>Om te achterhalen of de huidige kernel een seriële poort ondersteunt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># grep sioN /var/run/dmesg.boot</span></code></pre></div></div><div class=paragraph><p>Hier is <em>N</em> het aantal seriële poorten, beginnende bij nul. Als de uitvoer op het volgende lijkt, dan wordt de poort door de kernel ondersteund:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sio2 at port 0x3e8-0x3ef irq 5 on isa
sio2: <span class=nb>type </span>16550A</code></pre></div></div><div class=paragraph><p>Om te achterhalen of de kernel een parallelle poort ondersteunt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># grep ppcN /var/run/dmesg.boot</span></code></pre></div></div><div class=paragraph><p>Hier is <em>N</em> het aantal parallelle poorten beginnende bij nul. Als de uitvoer er ongeveer als volgt uit ziet, dan wordt de poort door de kernel ondersteund:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset <span class=o>(</span>ECP/EPP/PS2/NIBBLE<span class=o>)</span> <span class=k>in </span>COMPATIBLE mode
ppc0: FIFO with 16/16/8 bytes threshold</code></pre></div></div><div class=paragraph><p>Het kan nodig zijn een kernel aan te passen om het besturingssysteem in staat te stellen een parallelle of seriële poort die voor een printer wordt gebruikt te herkennen en te gebruiken.</p></div><div class=paragraph><p>In het onderdeel over kernelinstellingen staat meer informatie om ondersteuning voor een seriële poort toe te voegen. Lees de betreffende <em>en</em> de volgende sectie om ondersteuning voor een parallelle poort toe te voegen.</p></div></div></div><div class=sect4><h5 id=printing-parallel-port-mode>10.3.1.3. Communicatietype instellen voor een parallelle poort<a class=anchor href=#printing-parallel-port-mode></a></h5><div class=paragraph><p>Wanneer een parallelle poort wordt gebruikt, kan worden aangegeven of FreeBSD voor de printer interrupt-gestuurde of "polled" communicatie moet gebruiken. Het generieke printerapparaatstuurprogramma (<a href="https://man.freebsd.org/cgi/man.cgi?query=lpt&amp;sektion=4&amp;format=html">lpt(4)</a>) onder FreeBSD gebruikt het systeem <a href="https://man.freebsd.org/cgi/man.cgi?query=ppbus&amp;sektion=4&amp;format=html">ppbus(4)</a>. Dit bestuurt de chipset van de poort met het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ppc&amp;sektion=4&amp;format=html">ppc(4)</a>.</p></div><div class=ulist><ul><li><p>De <em>interrupt-gestuurde</em> methode is standaard in de GENERIC kernel. In dit geval gebruikt het besturingssysteem een IRQ om te bepalen of de printer klaar is om gegevens te ontvangen.</p></li><li><p>Bij de <em>polled</em> methode vraagt het besturingssysteem met vaste intervallen aan de printer of deze klaar is om gegevens te ontvangen. Als de printer antwoordt met "klaar", stuurt de kernel meer gegevens.</p></li></ul></div><div class=paragraph><p>De interrupt-gestuurde methode is meestal iets sneller, maar gebruikt een kostbaar IRQ-nummer. Van sommige HP printers wordt beweerd dat ze niet goed werken in interruptmodus, schijnbaar door een (nog niet begrepen) timing-probleem. Deze printers moeten gebruik maken van de polled methode. Gebruik de methode die werkt. Sommige printers werken met beide methodes, maar zijn tergend langzaam in de interrupt modus.</p></div><div class=paragraph><p>Het communicatietype kan op twee manieren worden ingesteld: door de kernel in te stellen of door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8&amp;format=html">lptcontrol(8)</a>.</p></div><div class=paragraph><p><em>Het communicatietype instellen door de kernel aan te passen:</em></p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Pas het kernelinstellingenbestand aan. Zoek naar een <code>ppc0</code> ingang. Gebruik <code>ppc1</code> voor het opzetten van een tweede parallelle poort. Gebruik <code>ppc2</code> voor de derde poort, enzovoort.</p><div class=ulist><ul><li><p>Als u gebruik wilt maken van de interrupt gestuurde modus, bewerk dan de regel hieronder:</p><div class="literalblock programlisting"><div class=content><pre>hint.ppc.0.irq=&#34;N&#34;</pre></div></div><div class=paragraph><p>Het kernelinstellingenbestand moet ook het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ppc&amp;sektion=4&amp;format=html">ppc(4)</a> bevatten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>device ppc</code></pre></div></div></li><li><p>Om gebruik te maken van polled modus verwijder dan het volgende regel uit <span class=filename>/boot/device.hints</span>:</p><div class="literalblock programlisting"><div class=content><pre>hint.ppc.0.irq=&#34;N&#34;</pre></div></div><div class=paragraph><p>In sommige gevallen is het onder FreeBSD niet voldoende om een poort in polled modus te zetten. In veel gevallen komt dat door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a>. Dit is in staat om apparaten te testen en aan te sluiten en kan zodoende het communicatietype van de printer wijzigen. Raadpleeg de instellingen voor <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a> om dit probleem te verhelpen.</p></div></li></ul></div></li><li><p>Sla het bestand op. Maak en installeer de nieuwe kernel en herstart de computer. In <a href=./#kernelconfig>De FreeBSD-kernel instellen</a> staan meer details.</p></li></ol></div></div></div><div class=paragraph><p><em>Communicatietype instellen met</em> <a href="https://man.freebsd.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8&amp;format=html">lptcontrol(8)</a>:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Typ:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptcontrol -i -d /dev/lptN</span></code></pre></div></div><div class=paragraph><p>om <code>lptN</code> op interrupt-gestuurde modus in te stellen.</p></div></li><li><p>Typ:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptcontrol -p -d /dev/lptN</span></code></pre></div></div><div class=paragraph><p>om <code>lptN</code> op polled modus in te stellen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptcontrol -p -d /dev/lptN</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Zet deze commando’s in het bestand <span class=filename>/etc/rc.local</span> zodat het communicatietype juist wordt ingesteld bij het opstarten. In <a href="https://man.freebsd.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8&amp;format=html">lptcontrol(8)</a> staat meer informatie.</p></div></div><div class=sect4><h5 id=printing-testing>10.3.1.4. Printercommunicatie controleren<a class=anchor href=#printing-testing></a></h5><div class=paragraph><p>Voor het instellen van het wachtrijsysteem, is het verstandig te controleren of het besturingssysteem gegevens naar een printer kan versturen. Het is een stuk makkelijker om problemen met printercommunicatie en het wachtrijsysteem apart op te lossen.</p></div><div class=paragraph><p>De printer wordt getest door er tekst naar toe te sturen. Voor printers die direct tekens kunnen afdrukken is het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> handig: het genereert alle 96 afdrukbare ASCII-tekens op 96 regels.</p></div><div class=paragraph><p>Voor PostScript® (of andere op taal gebaseerde) printers, is een meer geavanceerde test nodig. Een eenvoudig PostScript®-programma zoals het volgende volstaat:</p></div><div class="literalblock programlisting"><div class=content><pre>%!PS
100 100 moveto 300 300 lineto stroke
310 310 moveto /Helvetica findfont 12 scalefont setfont
(Werkt dit?) show
showpage</pre></div></div><div class=paragraph><p>Bovenstaande PostScript®-code kan in een bestand worden opgeslagen en in de voorbeelden in de volgende paragrafen gebruikt worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als in dit document wordt gesproken over een printertaal, wordt uitgegaan van een taal als PostScript® en niet PCL van HP. Hoewel PCL zeer functioneel is, kan het direct platte tekst afdrukken door gebruik te maken van escape-tekens. PostScript® kan niet direct platte tekst afdrukken. Voor dat soort printertalen zijn speciale aanpassingen nodig.</p></div></td></tr></tbody></table></div><div class=sect5><h6 id=printing-checking-parallel>10.3.1.4.1. Parallelle printer controleren<a class=anchor href=#printing-checking-parallel></a></h6><div class=paragraph><p>In deze sectie wordt beschreven hoe te controleren of FreeBSD kan communiceren met een printer die op een parallelle poort is aangesloten.</p></div><div class=paragraph><p><em>Voer de volgende stappen uit om een printer op een parallelle poort te testen:</em></p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p><a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> naar <code>root</code>.</p></li><li><p>Stuur gegevens naar de printer.</p><div class=ulist><ul><li><p>Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> als de printer platte tekst af kan drukken:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptest &gt; /dev/lptN</span></code></pre></div></div><div class=paragraph><p>Hier is <em>N</em> het nummer van de parallelle poort, beginnende bij nul.</p></div></li><li><p>Als de printer PostScript® of een andere printertaal begrijpt, stuur dan een klein programma naar de printer:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat &gt; /dev/lptN</span></code></pre></div></div><div class=paragraph><p>Geef het programma regel voor regel <em>heel nauwkeurig</em> in. Een regel kan niet worden gewijzigd als er op <code>RETURN</code> of <code>ENTER</code> is gedrukt. Geef na het afronden van de invoer voor het programma het einde-van-invoer-teken. Dit is meestal <code>CONTROL+D</code>.</p></div><div class=paragraph><p>Het programma kan ook in een bestand worden opgeslagen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat bestand &gt; /dev/lptN</span></code></pre></div></div><div class=paragraph><p>Hier is <em>bestand</em> de naam van het bestand waarin het programma is opgeslagen dat naar een printer gestuurd kan worden.</p></div></li></ul></div></li></ol></div></div></div><div class=paragraph><p>Nu moet er iets worden afgedrukt. Tekst die er niet goed uitziet is geen probleem. Dit wordt later gerepareerd.</p></div></div><div class=sect5><h6 id=printing-checking-serial>10.3.1.4.2. Seriële printer controleren<a class=anchor href=#printing-checking-serial></a></h6><div class=paragraph><p>In deze sectie wordt beschreven hoe te controleren of FreeBSD kan communiceren met een printer die op een seriële poort is aangesloten.</p></div><div class=paragraph><p><em>Voer de volgende stappen uit om een printer op de seriële poort te testen:</em></p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p><a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> naar <code>root</code>.</p></li><li><p>Voeg de volgende regel toe aan <span class=filename>/etc/remote</span>:</p><div class="literalblock programlisting"><div class=content><pre>printer:dv=/dev/poort:br#bps-snelheid:pa=pariteit</pre></div></div><div class=paragraph><p>Hier is <em>poort</em> de apparaatingave voor de seriële poort (<code>ttyu0</code>, <code>ttyu1</code>, enzovoort), <em>bps-snelheid</em> is het aantal bits per seconde waarop de printer communiceert en <em>pariteit</em> is de pariteit die door de printer wordt vereist (<code>even</code>, <code>odd</code>, <code>none</code> of <code>zero</code>).</p></div><div class=paragraph><p>Hier volgt een voorbeeldregel voor een printer verbonden met een seriële lijn op de derde seriële poort op 19200 bps, zonder pariteit:</p></div><div class="literalblock programlisting"><div class=content><pre>printer:dv=/dev/ttyu2:br#19200:pa=none</pre></div></div></li><li><p>Maak verbinding met de printer met <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tip printer</span></code></pre></div></div><div class=paragraph><p>Als dit niet werkt, pas dan <span class=filename>/etc/remote</span> opnieuw aan en probeer gebruik te maken van <span class=filename>/dev/cuaaN</span> in plaats van <span class=filename>/dev/ttyuN</span>.</p></div></li><li><p>Stuur gegevens naar de printer.</p><div class=ulist><ul><li><p>Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> als de printer platte tekst af kan drukken:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nv>$lptest</span></code></pre></div></div></li><li><p>Als de printer PostScript® of een andere printertaal begrijpt, stuur dan een klein programma naar de printer. Geef het programma regel voor regel <em>heel nauwkeurig</em> in. Backspace of andere speciale toetsen kunnen een speciale betekenis hebben voor de printer. Het kan ook nodig zijn een speciaal einde-van-invoer-teken te geven zodat de printer weet dat het gehele programma ontvangen is. Druk voor PostScript®-printers <code>CONTROL+D</code>.</p><div class=paragraph><p>Het programma kan ook in een bestand worden opgeslagen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=o>&gt;</span>bestand</code></pre></div></div><div class=paragraph><p>Hier is <em>bestand</em> de naam van het bestand waarin het programma is opgeslagen. Nadat <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a> het bestand heeft verstuurd kan het juiste einde-van-invoer-teken ingegeven worden.</p></div></li></ul></div></li></ol></div></div></div><div class=paragraph><p>Nu moet er iets worden afgedrukt. Tekst die er niet goed uitziet is geen probleem. Dit wordt later gerepareerd.</p></div></div></div><div class=sect4><h5 id=printing-printcap>10.3.1.5. De wachtrij aanzetten: <span class=filename>/etc/printcap</span><a class=anchor href=#printing-printcap></a></h5><div class=paragraph><p>Op dit punt moet de printer zijn aangesloten, de kernel ingesteld zijn om met de printer te communiceren (indien nodig) en is het mogelijk eenvoudige gegevens naar de printer te sturen. Nu kan LPD ingesteld worden zodat de toegang tot de printer wordt geregeld.</p></div><div class=paragraph><p>LPD wordt ingesteld door het bestand <span class=filename>/etc/printcap</span> aan te passen. Het wachtrijsysteem LPD leest dit bestand iedere keer dat het systeem wordt aangeroepen zodat wijzigingen direct van toepassing zijn.</p></div><div class=paragraph><p>De opmaak van het bestand <a href="https://man.freebsd.org/cgi/man.cgi?query=printcap&amp;sektion=5&amp;format=html">printcap(5)</a> is voor de hand liggend. Met een willekeurige tekstverwerker kunnen wijzigen in <span class=filename>/etc/printcap</span> aangebracht worden. De opmaak is identiek aan die van andere bestanden die voor dergelijke instellingen worden gebruik, zoals <span class=filename>/usr/shared/misc/termcap</span> en <span class=filename>/etc/remote</span>. In <a href="https://man.freebsd.org/cgi/man.cgi?query=cgetent&amp;sektion=3&amp;format=html">cgetent(3)</a> staat een uitgebreid overzicht van dit formaat.</p></div><div class=paragraph><p>De vereenvoudigde instellingen bestaan uit de volgende stappen:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Kies een naam (en een paar handige aliassen) voor de printer en voeg ze toe aan <span class=filename>/etc/printcap</span>. In <a href=#printing-naming>Printernaamgeving</a> staat meer informatie over het toekennen van een naam aan een printer.</p></li><li><p>Het afdrukken van voorbladen (standaard) kan uitgezet worden met de optie <code>sh</code>. In <a href=#printing-no-header-pages>Voorbladen onderdrukken</a> staat meer informatie.</p></li><li><p>Maak een wachtrijmap aan en specificeer de locatie door middel van de optie <code>sd</code>. In <a href=#printing-spooldir>Wachtrijmap aanmaken</a> staat meer informatie.</p></li><li><p>Bepaal welke ingave in <span class=filename>/dev</span> voor de printer wordt gebruikt en geef dit in <span class=filename>/etc/printcap</span> aan door gebruik te maken van de optie <code>lp</code>. In <a href=#printing-device>Printerapparaat identificeren</a> staat meer informatie. Als de printer is aangesloten op een seriële poort moeten de communicatieparameters worden ingesteld met de optie <code>ms#</code>. Dit wordt beschreven in <a href=#printing-commparam>Communicatieparameters voor het wachtrijsysteem instellen</a>.</p></li><li><p>Installeer een filter voor platte tekst. In <a href=#printing-textfilter>Tekstfilter installeren</a> staan details.</p></li><li><p>Test de instellingen door iets met <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> af te drukken. Details staan in <a href=#printing-trying>Printer uitproberen</a> en <a href=#printing-troubleshooting>Problemen oplossen</a>.</p></li></ol></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Op taal gebaseerde printers, zoals PostScript®-printers, kunnen niet direct platte tekst afdrukken. De vereenvoudigde instellingen, zoals hierboven beschreven en hieronder verder beschreven, gaan er van uit dat alleen bestanden naar een printer worden gestuurd die de printer begrijpt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Gebruikers verwachten vaak dat ze platte tekst naar printers op een systeem kunnen sturen. Programma’s die LPD gebruiken om af te drukken gaan hier ook vaak van uit. Als een dergelijke printer wordt geïnstalleerd en het moet mogelijk zijn zowel afdrukopdrachten in de printertaal als in platte tekst naar een printer te sturen, dan is het zeer aan te raden een extra stap in deze vereenvoudigde opzet in te voegen: installeer een conversieprogramma dat automatisch platte tekst omzet in PostScript® (of een andere printertaal). In <a href=#printing-advanced-if-conversion>Platte tekst op PostScript®-printers afdrukken</a> staat hoe dit in zijn werk gaat.</p></div><div class=sect5><h6 id=printing-naming>10.3.1.5.1. Printernaamgeving<a class=anchor href=#printing-naming></a></h6><div class=paragraph><p>De eerste (makkelijke) stap is het kiezen van een naam voor een printer. Het maakt niet uit of een naam functioneel of grappig is, aangezien ook een aantal aliassen aan een printer toegekend kunnen worden.</p></div><div class=paragraph><p>Ten minste één van de printers die in <span class=filename>/etc/printcap</span> worden genoemd moet het alias <code>lp</code> hebben. Dit is de standaardnaam voor de printer. Als gebruikers de omgevingsvariabele <code>PRINTER</code> niet ingesteld hebben en ook geen printernaam specificeren als ze LPD gebruiken, dan wordt standaard de printer <code>lp</code> gebruikt.</p></div><div class=paragraph><p>Het is verder gebruikelijk om het laatste alias zo te kiezen dat het een volledige beschrijving van de printer is, inclusief merk en model.</p></div><div class=paragraph><p>Als een naam en een aantal aliassen zijn gekozen, kunnen ze aan <span class=filename>/etc/printcap</span> worden toegevoegd. De naam van een printer wordt in de meest linker kolom geplaatst. Scheid ieder alias met een verticale streep en plaats een dubbele punt achter het laatste alias.</p></div><div class=paragraph><p>In het volgende voorbeeld is de beginsituatie een uitgekleed <span class=filename>/etc/printcap</span> waarin twee printers worden gedefinieerd (een Diablo 630 lijnprinter en een Panasonic KX-P4455 PostScript®-laserprinter):</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host rose
#
rattan|line|diablo|lp|Diablo 630 Line Printer:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:</pre></div></div><div class=paragraph><p>In dit voorbeeld heet de eerste printer <code>rattan</code> en heeft de volgende aliassen: <code>line</code>, <code>diablo</code>, <code>lp</code> en <code>Diablo 630 Line Printer</code>. Omdat deze printer het alias <code>lp</code> heeft, is het de standaard printer. De tweede printer heet <code>bamboo</code> en heeft de aliassen <code>ps</code>, <code>PS</code>, <code>S</code>, <code>panasonic</code> en <code>Panasonic KX-P4455 PostScript v51.4</code>.</p></div></div><div class=sect5><h6 id=printing-no-header-pages>10.3.1.5.2. Voorbladen onderdrukken<a class=anchor href=#printing-no-header-pages></a></h6><div class=paragraph><p>Het wachtrijsysteem LPD drukt standaard een <em>voorblad</em> af voor elke afdrukopdracht. Het voorblad bevat de gebruikersnaam van de gebruiker die de afdrukopdracht gaf, de computer waar de opdracht is gegeven en, in mooie grote letters, de naam van de afdrukopdracht. Het nadeel hiervan is dat al deze extra tekst het debuggen van de eenvoudige printerinstallatie bemoeilijkt. Daarom wordt het afdrukken van voorbladen onderdrukt.</p></div><div class=paragraph><p>Om voorbladen te onderdrukken, wordt de optie <code>sh</code> toegevoegd voor de relevante printer in <span class=filename>/etc/printcap</span>. Hieronder staat een voorbeeld van <span class=filename>/etc/printcap</span> met de optie <code>sh</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host rose - nergens worden voorbladen afgedrukt
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:</pre></div></div><div class=paragraph><p>Het juiste formaat is gebruikt: de eerste regel begint in de meest linker kolom, volgende regels springen in. Elke regel eindigt met een backslash, behalve de laatste.</p></div></div><div class=sect5><h6 id=printing-spooldir>10.3.1.5.3. Wachtrijmap aanmaken<a class=anchor href=#printing-spooldir></a></h6><div class=paragraph><p>De volgende stap in deze eenvoudige opzet is het aanmaken van een <em>wachtrijmap</em>. Dit is een map waar afdrukopdrachten geplaatst worden totdat ze worden afgedrukt. Ook wordt er een aantal bestanden geplaatst die nodig zijn voor het functioneren van het wachtrijsysteem.</p></div><div class=paragraph><p>Vanwege het veranderlijke karakter van wachtrijmappen is het gebruikelijk om deze mappen onder <span class=filename>/var/spool</span> te plaatsen. Het is niet nodig om een reservekopie van de inhoud van deze mappen te maken. Ze kunnen eenvoudigweg opnieuw worden aangemaakt met <a href="https://man.freebsd.org/cgi/man.cgi?query=mkdir&amp;sektion=1&amp;format=html">mkdir(1)</a>.</p></div><div class=paragraph><p>Het is ook gebruikelijk om de naam van de map overeen te laten komen met die van de printer, zoals onder is weergegeven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/spool/printernaam</span></code></pre></div></div><div class=paragraph><p>Als er veel printers zijn aangesloten op een netwerk, is het beter de wachtrijmappen aan te maken in een enkele map die speciaal wordt gebruikt voor afdrukken met LPD. In dit voorbeeld wordt dat gedaan voor de printers <code>rattan</code> en <code>bamboo</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/spool/lpd</span>
<span class=c># mkdir /var/spool/lpd/rattan</span>
<span class=c># mkdir /var/spool/lpd/bamboo</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als de afdrukopdrachten privé moeten blijven, dan is het belangrijk de wachtrijmap niet algemeen toegankelijk te maken. Wachtrijmappen moeten eigendom zijn van gebruiker <code>daemon</code> en groep <code>daemon</code>. Uitsluitend deze gebruiker en groep moeten de map kunnen lezen, schrijven en doorzoeken. We doen dit voor onze voorbeeldprinters:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chown daemon:daemon /var/spool/lpd/rattan</span>
<span class=c># chown daemon:daemon /var/spool/lpd/bamboo</span>
<span class=c># chmod 770 /var/spool/lpd/rattan</span>
<span class=c># chmod 770 /var/spool/lpd/bamboo</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Tenslotte moet LPD verteld worden dat deze mappen bestaan. Dit kan met het bestand <span class=filename>/etc/printcap</span>. De locatie van de wachtrijmap wordt opgegeven met de optie <code>sd</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host rose - wachtrijmappen toegevoegd
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:</pre></div></div><div class=paragraph><p>De naam van de printer staat in de eerste kolom, maar alle andere regels die de printer beschrijven worden ingesprongen en elke regel eindigt met een backslash.</p></div><div class=paragraph><p>Als geen wachtrijmap wordt opgegeven met <code>sd</code>, dan wordt standaard <span class=filename>/var/spool/lpd</span> gebruikt.</p></div></div><div class=sect5><h6 id=printing-device>10.3.1.5.4. Printerapparaat identificeren<a class=anchor href=#printing-device></a></h6><div class=paragraph><p>In de sectie <a href=#printing-hardware>Hardware-instellingen</a> is bepaald welke poort en ingang in de map <span class=filename>/dev</span> door FreeBSD worden gebruikt om met een printer te communiceren. Nu moet LPD dit ook weten. Als het wachtrijsysteem een afdrukopdracht krijgt, opent het het relevante apparaat namens het filterprogramma (dat verantwoordelijk is voor het sturen van gegevens naar een printer).</p></div><div class=paragraph><p>Geef de locatie van de ingang in <span class=filename>/dev</span> op in <span class=filename>/etc/printcap</span> door gebruik te maken van de optie <code>lp</code>.</p></div><div class=paragraph><p>In het huidige voorbeeld wordt aangenomen dat <code>rattan</code> op de eerste parallelle poort is aangesloten en <code>bamboo</code> op de zesde seriële poort. Hier volgen de toevoegingen voor <span class=filename>/etc/printcap</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host rose - bepaald welke apparaten te gebruiken
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyu5:</pre></div></div><div class=paragraph><p>Als voor een printer de optie <code>lp</code> niet wordt gebruikt in <span class=filename>/etc/printcap</span>, dan gebruikt LPD standaard <span class=filename>/dev/lp</span>. Momenteel bestaat <span class=filename>/dev/lp</span> niet in FreeBSD.</p></div><div class=paragraph><p>Als de te installeren printer is aangesloten op een parallelle poort, dan staan verdere instructies in <a href=#printing-textfilter>Tekstfilter installeren</a>. In andere gevallen kunnen de instructies in de volgende paragraaf gevold worden.</p></div></div><div class=sect5><h6 id=printing-commparam>10.3.1.5.5. Communicatieparameters voor het wachtrijsysteem instellen<a class=anchor href=#printing-commparam></a></h6><div class=paragraph><p>Voor printers die zijn aangesloten op een seriële poort kan LPD de bps-snelheid, pariteit en andere seriële communicatie parameters instellen voor het filterprogramma dat gegevens naar een printer stuurt. Dit is gunstig omdat:</p></div><div class=ulist><ul><li><p>De verschillende communicatieparameters uitgeprobeerd kunnen worden door <span class=filename>/etc/printcap</span> aan te passen. Het is niet nodig het filterprogramma opnieuw te compileren;</p></li><li><p>Het wachtrijsysteem kan hetzelfde filter gebruiken voor verschillende printers die mogelijk verschillende seriële communicatie-instellingen hebben.</p></li></ul></div><div class=paragraph><p>Met de volgende opties in <span class=filename>/etc/printcap</span> kunnen seriële communicatieparameters worden ingesteld voor het apparaat waar <code>lp</code> naar verwijst:</p></div><div class=dlist><dl><dt class=hdlist1><code>br#bps-snelheid</code></dt><dd><p>Stelt de communicatiesnelheid van het apparaat in op <em>bps-snelheid</em>, waarbij <em>bps-snelheid</em> de waarde 50, 75, 110, 134, 150, 200, 300, 600, 1200, 1800, 2400, 4800, 9600, 19200, 38400, 57600 of 115200 bits-per-seconde kan aannemen.</p></dd><dt class=hdlist1><code>ms#stty-modus</code></dt><dd><p>Bepaalt de opties voor het geval het printerapparaat een terminal is. In <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a> staat uitleg over de beschikbare opties.</p></dd></dl></div><div class=paragraph><p>Als LPD het apparaat opent dat met <code>lp</code> is opgegeven, worden de eigenschappen van het apparaat bepaald door de optie <code>ms#</code>. Met name van belang zijn de modi <code>parenb</code>, <code>parodd</code>, <code>cs5</code>, <code>cs6</code>, <code>cs7</code>, <code>cs8</code>, <code>cstopb</code>, <code>crtscts</code> en <code>ixon</code>. Deze worden uitgelegd in <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a>.</p></div><div class=paragraph><p>Nu wordt de voorbeeldprinter op de zesde seriële poort aangepast. De bps-snelheid wordt ingesteld op 38400. Als modus wordt gekozen: geen pariteit met <code>-parenb</code>, 8-bit tekens met <code>cs8</code>, geen modemcontrole met <code>clocal</code> en hardware flow-control met <code>crtscts</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyu5:ms#-parenb cs8 clocal crtscts:</pre></div></div></div><div class=sect5><h6 id=printing-textfilter>10.3.1.5.6. Tekstfilter installeren<a class=anchor href=#printing-textfilter></a></h6><div class=paragraph><p>Nu kan LPD verteld worden welke tekstfilters gebruikt moeten worden bij het versturen van afdrukopdrachten. Een <em>tekstfilter</em> is een programma dat LPD aanroept als het een afdrukopdracht krijgt. Wanneer LPD het tekstfilter aanroept, wordt de standaard invoer van het filter gekoppeld aan de afdrukopdracht en de standaard uitvoer aan het printerapparaat dat door de optie <code>lp</code> is opgegeven. Er wordt aangenomen dat het filter van standaard invoer leest, vervolgens de nodige handelingen uitvoert en het resultaat naar de standaard uitvoer schrijft, zodat het afgedrukt wordt. In <a href=#printing-advanced-filters>Filters</a> staat meer informatie over het tekstfilter.</p></div><div class=paragraph><p>Voor deze eenvoudige printerinstallatie kan het tekstfilter een klein shellscript zijn dat <code>/bin/cat</code> aanroept om de afdrukopdracht naar de printer te sturen. FreeBSD wordt geleverd met een ander filter, <span class=filename>lpf</span>, dat backspaces en onderlijnde tekst afhandelt voor printers die hier niet mee overweg kunnen. Natuurlijk kan elk filter gebruikt worden dat gewenst is. Het filter <code>lpf</code> wordt uitgebreid beschreven in <a href=#printing-advanced-lpf>lpf: een tekstfilter</a>.</p></div><div class=paragraph><p>Nu wordt eerst het shellscript <span class=filename>/usr/local/libexec/if-simple</span> gemaakt dat als simpel tekstfilter dient. Plaats de volgende tekst in het bestand met een tekstverwerker naar keuze:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# if-simple - Eenvoudig tekstfilter voor lpd
# Geïnstalleerd in /usr/local/libexec/if-simple
#
# Kopieert eenvoudigweg stdin naar stdout.
# Filterargumenten worden genegeerd.

/bin/cat &amp;&amp; exit 0
exit 2</pre></div></div><div class=paragraph><p>Zorg dat het bestand uitvoerbaar is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 555 /usr/local/libexec/if-simple</span></code></pre></div></div><div class=paragraph><p>Zorg dat LPD het filter gebruikt door dit aan te geven met de optie <code>if</code> in <span class=filename>/etc/printcap</span>. Nu volgt hoe dit te doen voor de twee printers uit het voorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host rose - met tekstfilter
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\ :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyu5:ms#-parenb cs8 clocal crtscts:\
        :if=/usr/local/libexec/if-simple:</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Een kopie van het script <span class=filename>if-simple</span> staat in de map <span class=filename>/usr/shared/examples/printing</span>.</p></div></td></tr></tbody></table></div></div><div class=sect5><h6 id=_lpd_aanzetten>10.3.1.5.7. LPD aanzetten<a class=anchor href=#_lpd_aanzetten></a></h6><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=lpd&amp;sektion=8&amp;format=html">lpd(8)</a> wordt gestart vanuit <span class=filename>/etc/rc</span> door de variabele <code>lpd_enable</code>. Standaard staat deze variabele op <code>NO</code>. Als dit nog niet is gedaan, voeg dan de volgende regel toe aan <span class=filename>/etc/rc.conf</span> en herstart de computer:</p></div><div class="literalblock programlisting"><div class=content><pre>lpd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Of voer het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=lpd&amp;sektion=8&amp;format=html">lpd(8)</a> uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lpd</span></code></pre></div></div></div><div class=sect5><h6 id=printing-trying>10.3.1.5.8. Printer uitproberen<a class=anchor href=#printing-trying></a></h6><div class=paragraph><p>Nu volgt het laatste onderdeel van de eenvoudige LPD installatie. Helaas zijn felicitaties nog niet gepast. De printer moet worden getest en eventuele problemen moeten worden opgelost. Om de installatie te testen kan iets afgedrukt worden. Afdrukken gaat met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>. Dit stuurt een opdracht naar een printer.</p></div><div class=paragraph><p>Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> is te combineren met het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> uit <a href=#printing-testing>Printercommunicatie controleren </a>om tekst te genereren.</p></div><div class=paragraph><p><em>Om de eenvoudige installatie van LPD te testen:</em></p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptest 20 5 | lpr -Pprinternaam</span></code></pre></div></div><div class=paragraph><p>Hier is <em>printernaam</em> de naam van een printer (of een alias) die in <span class=filename>/etc/printcap</span> wordt genoemd. De standaard printer kan worden getest door bij het aanroepen van <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> de optie <code>-P</code> weg te laten. Nogmaals: test een PostScript®-printer door een PostScript®-programma naar een printer te sturen en maak geen gebruik van <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a>. Dit kan door het programma in een bestand op te slaan en de volgende commandoregel uit te voeren: <code>lpr bestand</code>.</p></div><div class=paragraph><p>Voor een PostScript®-printer moet het resultaat van het programma verschijnen. Als gebruik wordt gemaakt van <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> ziet het resultaat er ongeveer zo uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>!</span><span class=s2>&#34;#</span><span class=nv>$%</span><span class=s2>&amp;&#39;()*+,-./01234
&#34;</span><span class=c>#$%&amp;&#39;()*+,-./012345</span>
<span class=c>#$%&amp;&#39;()*+,-./0123456</span>
<span class=nv>$%</span>&amp;<span class=s1>&#39;()*+,-./01234567
%&amp;&#39;</span><span class=o>()</span><span class=k>*</span>+,-./012345678</code></pre></div></div><div class=paragraph><p>Om de printer uitvoeriger te testen kunnen grotere programma’s geprobeerd worden (voor taalgebaseerde printers) of kan <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> aangeroepen worden met andere argumenten. Bijvoorbeeld: <code>lptest 80 60</code>, drukt 60 regels af met elk 80 karakters.</p></div><div class=paragraph><p>Als de printer niet werkt, lees dan verder in <a href=#printing-troubleshooting>Problemen oplossen</a>.</p></div></div></div></div></div><div class=sect2><h3 id=printing-advanced>10.4. Geavanceerde printerinstallatie<a class=anchor href=#printing-advanced></a></h3><div class=paragraph><p>Deze sectie behandelt het gebruik van filters om speciaal opgemaakte tekst en voorbladen af te drukken, via het netwerk af te drukken en printergebruik te beperken en statistieken bij te houden.</p></div><div class=sect3><h4 id=printing-advanced-filter-intro>10.4.1. Filters<a class=anchor href=#printing-advanced-filter-intro></a></h4><div class=paragraph><p>Hoewel LPD veel van het afdrukwerk afhandelt (netwerkverkeer, wachtrijafhandeling, toegangscontrole, enzovoort), wordt het <em>echte</em> werk door de filters gedaan. Filters zijn programma’s die met een printer communiceren en inspelen op printerspecifieke eigenschappen. In de eenvoudige printeropzet is een filter geïnstalleerd voor platte tekst, een zeer eenvoudig filter dat met de meeste printers zou moeten werken (<a href=#printing-textfilter>Tekstfilter installeren</a>).</p></div><div class=paragraph><p>Om echter gebruik te maken van formaatomzetting, printeradministratie, printerspecifieke aanpassingen, enzovoort, is het nodig te weten hoe filters werken. Uiteindelijk is het de verantwoordelijkheid van het filter om deze zaken af te handelen. Het slechte nieuws is dat <em>de beheerder</em> in het merendeel van de gevallen het filter moet aanleveren. Het goede nieuws is dat veel filters algemeen beschikbaar zijn en als ze dat niet zijn, zijn ze vaak makkelijk te schrijven.</p></div><div class=paragraph><p>FreeBSD heeft een ingebouwd filter, <span class=filename>/usr/libexec/lpr/lpf</span>, die met veel printers werkt die platte tekst kunnen afdrukken. Het filter regelt backspace en tabs in bestanden en administreert printergebruik, maar dat is zo’n beetje alles wat dit filter doet. Er zijn ook diverse filters en filtercomponenten in de FreeBSD Portscollectie.</p></div><div class=paragraph><p>Hieronder wordt het volgende beschreven:</p></div><div class=ulist><ul><li><p>In <a href=#printing-advanced-filters>Hoe filters werken</a> staat een overzicht van de rol die een filter speelt in het afdrukproces. Lees dat onderdeel om een indruk te krijgen wat er "onder de motorkap" gebeurt als LPD filters gebruikt. Deze kennis helpt mogelijke problemen te voorkomen of op te lossen als meerdere filters worden geïnstalleerd voor printers.</p></li><li><p>LPD gaat er van uit dat elke printer standaard platte tekst af kan drukken. Dit geeft problemen voor PostScript® (of andere op taal gebaseerde) printers die niet in staat zijn direct platte tekst af te drukken. In <a href=#printing-advanced-if-conversion>Platte tekst op PostScript®-printers afdrukken</a> staat wat er kan worden gedaan om dit probleem te verhelpen. Lees verder in dit onderdeel als het om PostScript®-printers gaat.</p></li><li><p>Voor veel programma’s is PostScript® een populair uitvoerformaat. Sommige mensen schrijven PostScript® code zelfs direct. PostScript®-printers zijn echter kostbaar. In <a href=#printing-advanced-ps>PostScript® simuleren op niet-PostScript®-printers</a> staat hoe de tekstfilter van een printer aangepast moet worden zodat die PostScript® accepteert en afdrukt op een <em>niet-PostScript®</em>-printer. Dit onderdeel is van toepassing voor niet-PostScript®-printers.</p></li><li><p>In <a href=#printing-advanced-convfilters>Conversiefilters</a> wordt een methode beschreven om de conversie van bepaalde bestandsformaten te automatiseren, zoals van grafische of tekstopmaakprogramma’s, naar formaten die een printer kan begrijpen. Na het lezen van dit onderdeel is een beheerder in staat om een printer zodanig in te stellen dat gebruikers <code>lpr -t</code> kunnen invoeren om troff-gegevens af te drukken, <code>lpr -d</code> om TeX DVI-gegevens af te drukken of <code>lpr -v</code> om rasterplaatjes af te drukken, enzovoorts. Het wordt aangeraden deze sectie te lezen.</p></li><li><p>In <a href=#printing-advanced-of>Uitvoerfilters</a> wordt een niet vaak gebruikte functionaliteit van LPD behandeld: uitvoerfilters. Tenzij voorbladen worden afgedrukt (<a href=#printing-advanced-header-pages>Voorbladen</a>), kan deze sectie waarschijnlijk overgeslagen worden.</p></li><li><p><a href=#printing-advanced-lpf>lpf: een tekstfilter</a> beschrijft <code>lpf</code>, een redelijk complete, eenvoudige tekstfilter voor lijnprinters (en laserprinters die zich als lijnprinters voordoen) dat wordt geleverd bij FreeBSD. Voor een snelle manier om printeradministratie aan de praat te krijgen voor platte tekst of voor printers waar rook uit komt bij het zien van backspace karakters, is het serieus te overwegen gebruik te maken van <code>lpf</code>.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Een kopie van de scripts die hieronder worden beschreven, staan in de map <span class=filename>/usr/shared/examples/printing</span>.</p></div></td></tr></tbody></table></div><div class=sect4><h5 id=printing-advanced-filters>10.4.1.1. Hoe filters werken<a class=anchor href=#printing-advanced-filters></a></h5><div class=paragraph><p>Zoals eerder genoemd, is een filter een programma dat wordt uitgevoerd door LPD voor het afhandelen van het apparaatafhankelijke deel van de communicatie met een printer.</p></div><div class=paragraph><p>Als LPD een bestand wil afdrukken uit een afdrukopdracht, start het een filterprogramma. Het koppelt de standaard invoer van de filter aan het af te drukken bestand, de standaard uitvoer aan de printer en de standaard foutmelding aan het logboekbestand voor foutmeldingen (zoals opgegeven via de optie <code>lf</code> in <span class=filename>/etc/printcap</span> of standaard <span class=filename>/dev/console</span>).</p></div><div class=paragraph><p>Welk filter LPD start en de argumenten van het filter hangen af van wat er in het bestand <span class=filename>/etc/printcap</span> wordt opgegeven en de argumenten die de gebruiker geeft op de commandoregel van <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>. Als een gebruiker bijvoorbeeld <code>lpr -t</code> ingeeft, start LPD het filter troff, zoals wordt opgegeven via de optie <code>tf</code> voor de betreffende printer. Als een gebruiker platte tekst wilt afdrukken, dan wordt het filter <code>if</code> gestart (dit klopt bijna: zie <a href=#printing-advanced-of>Uitvoerfilters</a> voor de details).</p></div><div class=paragraph><p>Er zijn drie soorten filters die in <span class=filename>/etc/printcap</span> kunnen worden opgegeven:</p></div><div class=ulist><ul><li><p>Het tekstfilter, dat in de LPD documentatie verwarrend genoeg <em>input filter</em> wordt genoemd, verwerkt het afdrukken van gewone tekst. Beschouw het als het standaardfilter. LPD verwacht dat elke printer standaard platte tekst kan afdrukken en het is de taak van het tekstfilter om er voor te zorgen dat backspaces, tabs en andere speciale karakters de printer niet in de war sturen. In een omgeving waar moet worden bijgehouden hoeveel er wordt afgedrukt, moet het tekstfilter ook administreren hoeveel pagina’s er zijn afgedrukt. Dit gaat meestal door het aantal afgedrukte regels te tellen en dit te vergelijken met het aantal regels per pagina dat door de printer wordt ondersteund. Het tekstfilter wordt aangeroepen met de volgende lijst argumenten:</p><div class=paragraph><p><code>filter-name</code> [ -c ] -w <em>width</em> -l <em>length</em> -i <em>indent</em> -n <em>login</em> -h <em>host</em> <em>acct-file</em></p></div><div class=paragraph><p>met</p></div><div class=dlist><dl><dt class=hdlist1><code>-c</code></dt><dd><p>wordt gebruikt als de afdrukopdracht is gegeven met <code>lpr -l</code></p></dd><dt class=hdlist1><em>width</em></dt><dd><p>is de waarde van de optie <code>pw</code> (<em>page width</em>: paginabreedte), zoals opgegeven in <span class=filename>/etc/printcap</span>, standaard 132</p></dd><dt class=hdlist1><em>length</em></dt><dd><p>is de waarde van de optie <code>pl</code> (<em>page length</em>: paginalengte), standaard 66</p></dd><dt class=hdlist1><em>indent</em></dt><dd><p>geeft aan hoeveel wordt ingesprongen door <code>lpr -i</code>, standaard 0</p></dd><dt class=hdlist1><em>login</em></dt><dd><p>de gebruikersnaam van de gebruiker die de afdrukopdracht gaf</p></dd><dt class=hdlist1><em>host</em></dt><dd><p>de hostnaam waar de afdrukopdracht gegeven is</p></dd><dt class=hdlist1><em>acct-file</em></dt><dd><p>de naam van het administratiebestand zoals opgegeven via de optie <code>af</code>.</p></dd></dl></div></li><li><p>Een <em>conversiefilter</em> converteert een specifiek bestandsformaat naar een formaat dat een printer begrijpt. Bijvoorbeeld: ditroff typesettinggegevens kunnen niet direct worden afgedrukt, maar er bestaat wel een conversiefilter om ditroff-gegevens te converteren naar een formaat dat een printer kan verteren en afdrukken. Dit wordt in <a href=#printing-advanced-convfilters>Conversiefilters</a> beschreven. Conversiefilters zijn ook nodig om printergebruik te administreren, mocht dat nodig zijn. Conversiefilters worden met de volgende argumenten aangeroepen:</p><div class=paragraph><p><code>filter-name</code> -x <em>pixel-width</em> -y <em>pixel-height</em> -n <em>login</em> -h <em>host</em> <em>acct-file</em></p></div><div class=paragraph><p>Hier is <em>pixel-width</em> de waarde van de optie <code>px</code> (standaard 0) en <em>pixel-height</em> is de waarde van de optie <code>py</code> (standaard 0).</p></div></li><li><p>Het <em>uitvoerfilter</em> wordt alleen gebruikt als er geen tekstfilter is of als er voorbladen worden afgedrukt. De ervaring leert dat uitvoerfilters zelden worden gebruikt. In sectie <a href=#printing-advanced-of>Uitvoerfilters</a> worden ze beschreven. Er zijn slechts twee argumenten die aan een uitvoerfilter worden meegegeven:</p><div class=paragraph><p><code>filter-name</code> -w <em>width</em> -l <em>length</em></p></div><div class=paragraph><p>Deze zijn identiek aan de argumenten <code>-w</code> en <code>-l</code> van het tekstfilter.</p></div></li></ul></div><div class=paragraph><p>Filters moeten <em>afsluiten</em> met de volgende waarde:</p></div><div class=dlist><dl><dt class=hdlist1>exit 0</dt><dd><p>Als het filter een bestand succesvol heeft afgedrukt.</p></dd><dt class=hdlist1>exit 1</dt><dd><p>Als het filter niet geslaagd is om een bestand af te drukken, maar wil dat LPD het nogmaals probeert. LPD herstart het filter als die afsluit met deze status.</p></dd><dt class=hdlist1>exit 2</dt><dd><p>Als het filter niet geslaagd is om een bestand af te drukken, maar niet wil dat LPD het nogmaals probeert. LPD verwijdert het bestand uit de wachtrij.</p></dd></dl></div><div class=paragraph><p>Het tekstfilter dat bij FreeBSD wordt geleverd, <span class=filename>/usr/libexec/lpr/lpf</span>, benut de argumenten voor paginabreedte en -lengte om te bepalen wanneer een nieuwe pagina moet worden begonnen en om het printergebruik bij te houden. Het gebruikt de argumenten voor login, host en administratiebestand om accountingregels aan te maken.</p></div><div class=paragraph><p>Controleer bij het zoeken naar filters of ze LPD-compatibel zijn. Zo ja, dan ondersteunen ze de argumenten zoals hierboven beschreven. Zorg bij het zelf schrijven van filters voor algemeen gebruik dat ze dezelfde argumenten en exitcodes ondersteunen.</p></div></div><div class=sect4><h5 id=printing-advanced-if-conversion>10.4.1.2. Platte tekst op PostScript®-printers afdrukken<a class=anchor href=#printing-advanced-if-conversion></a></h5><div class=paragraph><p>Als een computer en PostScript® (of andere op taal gebaseerde) printer maar één gebruiker hebben die belooft nooit platte tekst naar de printer te sturen of programma’s te gebruiken die dat doen, dan is dit onderdeel overbodig.</p></div><div class=paragraph><p>Als gebruikers zowel PostScript® als platte tekst naar een printer willen sturen, dan is het aan te raden de printerinstellingen hierop aan te passen. Hiervoor moet het tekstfilter bij elke nieuwe opdracht bepalen of het om platte tekst of PostScript® gaat. Alle PostScript®-opdrachten beginnen met <code>%!</code> (raadpleeg de printerhandleiding voor andere printertalen). Als dit de eerste twee karakters zijn van een opdracht is het PostScript® en kan de rest van een opdracht direct doorgestuurd worden. Is dit niet het geval, dan moet de filter de tekst omzetten in PostScript® en het resultaat afdrukken.</p></div><div class=paragraph><p>Hoe gaat dat werken?</p></div><div class=paragraph><p>Voor seriële printers kan het meest eenvoudig <code>lprps</code> geïnstalleerd worden. <code>lprps</code> is een PostScript®-afdrukfilter die tweewegcommunicatie met een printer heeft. Het werkt het statusbestand van een printer bij met uitgebreide informatie afkomstig van een printer, zodat gebruikers en beheerders precies kunnen zien wat de status van een printer is (zoals: <code>toner bijna op</code> of <code>papier vastgelopen</code>). Maar belangrijker, het omvat het programma <code>psif</code> dat bepaalt of een binnenkomende opdracht platte tekst is en <code>textps</code> (dat ook geleverd wordt met <code>lprps</code>) om opdrachten om te zetten naar PostScript®. Vervolgens wordt een opdracht met <code>lprps</code> naar een printer gestuurd.</p></div><div class=paragraph><p><code>lprps</code> is onderdeel van de FreeBSD Portscollectie (zie <a href=./#ports>De Portscollectie</a>). U kunt één van de ports <a class=package href=https://cgit.freebsd.org/ports/tree/print/lprps-a4/>print/lprps-a4</a> of <a class=package href=https://cgit.freebsd.org/ports/tree/print-lprps-letter/>print-lprps-letter</a> installeren afhankelijk van de gebruikte papiermaat. Nadat <code>lprps</code> is geïnstalleerd moet de installatielocatie ervan aan <code>psif</code> worden doorgeven dat onderdeel is van <code>lprps</code>. Als <code>lprps</code> is geïnstalleerd via de Portscollectie, gebruik dan het volgende voor de seriële PostScript®-printer in <span class=filename>/etc/printcap</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>:if=/usr/local/libexec/psif:</pre></div></div><div class=paragraph><p>Ook moet de optie <code>rw</code> worden opgeven, die LPD vertelt om een printer in lezen/schrijvenmodus te openen.</p></div><div class=paragraph><p>Als een parallelle PostScript®-printer wordt ingesteld (en dus geen tweewegcommunicatie toegepast kan worden met de printer, zoals vereist door <code>lprps</code>), dan kan het volgende shellscript gebruikt worden als tekstfilter:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  psif - Druk PostScript(R) of platte tekst af op een PostScript(R)
#  printer. Script versie; NIET de versie die wordt geleverd bij lprps
#  Geïnstalleerd in /usr/local/libexec/psif
#

IFS=&#34;&#34; read -r first_line
first_two_chars=`expr &#34;$first_line&#34; : &#39;\(..\)&#39;`

if [ &#34;$first_two_chars&#34; = &#34;%!&#34; ]; then
    #
    #  PostScript(R) opdracht, afdrukken.
    #
    echo &#34;$first_line&#34; &amp;&amp; cat &amp;&amp; printf &#34;\004&#34; &amp;&amp; exit 0
    exit 2
else
    #
    #  Platte tekst, converteren en dan afdrukken.
    #
    ( echo &#34;$first_line&#34;; cat ) | /usr/local/bin/textps &amp;&amp; printf &#34;\004&#34; &amp;&amp; exit 0
    exit 2
fi</pre></div></div><div class=paragraph><p>In bovenstaand script is <code>textps</code> een programma dat geïnstalleerd is om platte tekst om te zetten naar PostScript®. Elk tekst-naar-PostScript® programma volstaat. De FreeBSD Portscollectie (zie <a href=./#ports>De Portscollectie</a>) bevat een uitgebreid tekst-naar-PostScript®-programma, <code>a2ps</code>, dat wellicht handig is om te gebruiken.</p></div></div><div class=sect4><h5 id=printing-advanced-ps>10.4.1.3. PostScript® simuleren op niet-PostScript®-printers<a class=anchor href=#printing-advanced-ps></a></h5><div class=paragraph><p>PostScript® is <em>de facto</em> de standaard voor op hoge kwaliteit typesetten en afdrukken. PostScript® is echter een <em>dure</em> standaard. Gelukkig heeft Aladdin Enterprises een gratis PostScript®-kloon, Ghostscript, die werkt onder FreeBSD. Ghostscript kan de meeste PostScript®-bestanden lezen en de pagina’s op verschillende soorten apparaten weergeven, waaronder veel niet-PostScript®-printers. Door Ghostscript te installeren en een printer gebruik te laten maken van een speciaal tekstfilter voor uw printer, kan uw niet-PostScript®-printer zich gedragen als een echte PostScript®-printer.</p></div><div class=paragraph><p>Ghostscript is beschikbaar via de FreeBSD Portscollectie, vele versies zijn beschikbaar, de meest gebruikte versie is <a class=package href=https://cgit.freebsd.org/ports/tree/print/ghostscript-gpl/>print/ghostscript-gpl</a>.</p></div><div class=paragraph><p>Om PostScript® te simuleren moet een tekstfilter detecteren of het een PostScript®-bestand aan het afdrukken is. Zo niet, dan stuurt het filter het bestand direct naar een printer, anders gebruikt het filter Ghostscript om het bestand om te zetten naar een formaat dat door een printer wordt begrepen.</p></div><div class=paragraph><p>Een voorbeeld: het volgende script is een tekstfilter voor Hewlett Packard DeskJet 500 printers. Voor andere printers moet het argument <code>-sDEVICE</code> voor het commando <code>gs</code> (Ghostscript) vervangen worden. (Met <code>gs -h</code> wordt een lijst met apparaten getoond worden die de huidige installatie van Ghostscript ondersteunt.)</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  ifhp - Druk Ghostscript-gesimuleerd PostScript(R) af op een DeskJet
#  500.  Geïnstalleerd in /usr/local/libexec/ifhp

#
#  Behandel LF als CR+LF (om een &#34;trapeffect&#34; op HP/PCL
#  printer te voorkomen):
#
printf &#34;\033&amp;k2G&#34; || exit 2

#
#  Lees de eerste twee karakters van het bestand
#
IFS=&#34;&#34; read -r first_line
first_two_chars=`expr &#34;$first_line&#34; : &#39;\(..\)&#39;`

if [ &#34;$first_two_chars&#34; = &#34;%!&#34; ]; then
    #
    #  Het is PostScript(R). Gebruik Ghostscript om te converteren
    #  en druk het af.
    #
    /usr/local/bin/gs -dSAFER -dNOPAUSE -q -sDEVICE=djet500 \
        -sOutputFile=- - &amp;&amp; exit 0
else
    #
    #  Platte tekst of HP/PCL, dus direct afdrukken;  druk een
    #  pagina-einde af om de laatste pagina te ejecteren.
    #
    echo &#34;$first_line&#34; &amp;&amp; cat &amp;&amp; printf &#34;\033&amp;l0H&#34; &amp;&amp;
exit 0
fi

exit 2</pre></div></div><div class=paragraph><p>Tot slot moet LPD op de hoogte gebracht worden van het filter via de optie <code>if</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>:if=/usr/local/libexec/ifhp:</pre></div></div><div class=paragraph><p>Dat is alles. Nu kan <code>lpr platte.tekst</code> en <code>lpr watdanook.ps</code> ingevoerd worden en beiden worden juist afgedrukt.</p></div></div><div class=sect4><h5 id=printing-advanced-convfilters>10.4.1.4. Conversiefilters<a class=anchor href=#printing-advanced-convfilters></a></h5><div class=paragraph><p>Na de eenvoudige installatie, zoals beschreven in <a href=#printing-simple>Eenvoudige printerinstallatie</a>, te hebben voltooid, is het waarschijnlijk wenselijk om conversiefilters te installeren voor favoriete bestandsformaten (naast platte ASCII-tekst).</p></div><div class=sect5><h6 id=_waarom_conversiefilters_installeren>10.4.1.4.1. Waarom conversiefilters installeren?<a class=anchor href=#_waarom_conversiefilters_installeren></a></h6><div class=paragraph><p>Conversiefilters maken het afdrukken van verschillende bestanden eenvoudig. Stel dat veel gebruik gemaakt wordt van het tekstverwerkingsprogramma TeX en een PostScript® printer. Elke keer als door TeX een DVI-bestand wordt gegenereerd, kan dat niet direct afgedrukt worden. Het DVI-bestand moet omgezet worden naar PostScript®. De te geven opdrachten zijn de volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% dvips zeewieranalyse.dvi
% lpr zeewieranalyse.ps</code></pre></div></div><div class=paragraph><p>Na installatie van een conversiefilter voor DVI-bestanden kan deze handmatige conversie overgeslagen worden door LPD de conversie te laten uitvoeren. Elke keer als een DVI-bestand wordt afgedrukt, hoeft alleen de volgende opdracht gegeven te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-d</span> zeewieranalyse.dvi</code></pre></div></div><div class=paragraph><p>LPD voert de DVI-bestandsconversie uit door <code>-d</code> te geven. In <a href=#printing-lpr-options-format>Opties voor opmaak en conversie</a> staat een lijst van conversie-opties.</p></div><div class=paragraph><p>Voor elke conversie-optie moet een <em>conversiefilter</em> geïnstalleerd worden en moet in <span class=filename>/etc/printcap</span> de locatie worden opgegeven. Een conversiefilter is als het tekstfilter voor de eenvoudige printerinstallatie (<a href=#printing-textfilter>Tekstfilter installeren</a>), behalve dat in plaats van platte tekst af te drukken, het conversiefilter het bestand converteert naar een formaat dat een printer begrijpt.</p></div></div><div class=sect5><h6 id=_welke_conversiefilters_installeren>10.4.1.4.2. Welke conversiefilters installeren?<a class=anchor href=#_welke_conversiefilters_installeren></a></h6><div class=paragraph><p>Installeer de conversiefilters die nodig zijn. Als veel DVI-bestanden worden afgedrukt, dan is het handig een DVI-filter te installeren. Als veel troff wordt afgedrukt, dan is het waarschijnlijk handig een troff-filter te installeren.</p></div><div class=paragraph><p>De volgende tabel geeft een samenvatting van filters waarmee LPD kan werken, hoe ze in <span class=filename>/etc/printcap</span> kunnen worden aangeroepen en hoe ze met <code>lpr</code> kunnen worden aangeroepen:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Bestandsformaat</th><th class="tableblock halign-left valign-top">/etc/printcap optie</th><th class="tableblock halign-left valign-top">lpr optie</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>cifplot</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-c</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DVI</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>df</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-d</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>plot</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-g</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ditroff</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>nf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-n</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>FORTRAN-tekst</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>rf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-f</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>troff</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>tf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-f</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>raster</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>vf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-v</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>platte tekst</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>if</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>geen, <code>-p</code>, of <code>-l</code></p></td></tr></tbody></table><div class=paragraph><p>In het voorbeeld waarbij <code>lpr -d</code> wordt gebruikt, moet voor de printer een optie <code>df</code> gedefinieerd staan in <span class=filename>/etc/printcap</span>.</p></div><div class=paragraph><p>Ondanks wat anderen mogelijk beweren, zijn formaten als FORTRAN-tekst en plot waarschijnlijk verouderd. Dit biedt de mogelijkheid een nieuwe betekenis te geven aan deze opties door zelf een filter te installeren. Stel dat direct Printerleaf-bestanden afgedrukt moeten worden (bestanden van het bureaubladpublicatieprogramma Interleaf), maar nooit plotbestanden worden afgedrukt. Dan kan een Printerleaf-conversiefilter geïnstalleerd worden onder de optie <code>gf</code> en gebruikers kunnen geïnstrueerd worden om <code>lpr -g</code> te gebruiken om Printerleaf-bestanden af te drukken.</p></div></div><div class=sect5><h6 id=_conversiefilters_installeren>10.4.1.4.3. Conversiefilters installeren<a class=anchor href=#_conversiefilters_installeren></a></h6><div class=paragraph><p>Aangezien conversiefilters programma’s zijn die niet onder de FreeBSD-basisinstallatie vallen, kunnen ze het best onder <span class=filename>/usr/local</span> geplaatst worden. De map <span class=filename>/usr/local/libexec</span> is een veelgebruikte locatie, omdat hier programma’s te vinden zijn die alleen door LPD gebruikt worden. Gewone gebruikers hoeven ze nooit te gebruiken.</p></div><div class=paragraph><p>Om een conversiefilter te activeren, moet de bestandslocatie onder de juiste optie voor de betreffende printer in <span class=filename>/etc/printcap</span> opgegeven worden.</p></div><div class=paragraph><p>In het onderstaande voorbeeld wordt het DVI-conversiefilter toegevoegd onder de sectie van de printer <code>bamboo</code>. Hieronder staat opnieuw het voorbeeldbestand <span class=filename>/etc/printcap</span>, nu met de nieuwe optie <code>df</code> voor de printer <code>bamboo</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host rose - df-filter voor bamboo toegevoegd
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyu5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Het DVI-filter is een shellscript met de naam <span class=filename>/usr/local/libexec/psdf</span>. Het script ziet er als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  psdf - DVI naar PostScript afdrukfilter
#  Geïnstalleerd in /usr/local/libexec/psdf
#
# Aangeroepen door lpd wanneer een gebruiker lpr -d uitvoert
#
exec /usr/local/bin/dvips -f | /usr/local/libexec/lprps &#34;$@&#34;</pre></div></div><div class=paragraph><p>Dit script roept <code>dvips</code> in filtermodus aan (het <code>-f</code> argument) op de standaard uitvoer, de af te drukken opdracht. Vervolgens start het PostScript® afdrukfilter <code>lprps</code> (zie <a href=#printing-advanced-if-conversion>Platte tekst op PostScript®-printers afdrukken</a>) met de argumenten die LPD aan het script doorgeeft. <code>lprps</code> gebruikt deze argumenten om de afgedrukte pagina’s te administreren.</p></div></div><div class=sect5><h6 id=_meer_voorbeelden_van_conversiefilters>10.4.1.4.4. Meer voorbeelden van conversiefilters<a class=anchor href=#_meer_voorbeelden_van_conversiefilters></a></h6><div class=paragraph><p>Er is geen vaste procedure om conversiefilters te installeren, er worden in deze sectie wat werkende voorbeelden gegeven. Gebruik deze als hulp bij het zelf maken van filters. Gebruik ze zonder aanpassingen indien mogelijk.</p></div><div class=paragraph><p>Dit voorbeeldscript is een raster (eigenlijk een GIF-bestand) conversiefilter voor een HP LaserJet III-Si printer:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  hpvf - Converteer GIF-bestanden naar HP/PCL, druk vervolgens af
#  Geïnstalleerd in /usr/local/libexec/hpvf

PATH=/usr/X11R6/bin:$PATH; export PATH
giftopnm | ppmtopgm | pgmtopbm | pbmtolj -resolution 300 \
    &amp;&amp; exit 0 \
    || exit 2</pre></div></div><div class=paragraph><p>Het script converteert achtereenvolgens het GIF-bestand naar een PNM-bestand (portable anymap), een PGM-bestand (portable graymap), een PBM-bestand (portable bitmap) en tenslotte naar LaserJet/PCL formaat.</p></div><div class=paragraph><p>Een <span class=filename>/etc/printcap</span> bestand dat bovenstaand filter gebruikt ziet er als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host orchid
#
teak|hp|laserjet|HP LaserJet 3Si:\
        :lp=/dev/lpt0:sh:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/hpif:\
        :vf=/usr/local/libexec/hpvf:</pre></div></div><div class=paragraph><p>Het volgende script is een conversiefilter voor troff-gegevens afkomstig van het groff-typesettingsysteem voor de PostScript®-printer <code>bamboo</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  pstf - Converteert groff&#39;s troffgegevens naar PS, drukt vervolgens af.
#  Geïnstalleerd in /usr/local/libexec/pstf
#
exec grops | /usr/local/libexec/lprps &#34;$@&#34;</pre></div></div><div class=paragraph><p>Bovenstaande script maakt eveneens gebruik van <code>lprps</code> om de communicatie met een printer af te handelen. Als een printer op een parallelle poort is aangesloten, ziet het er als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  pstf - Converteert groff&#39;s troff naar PS, drukt vervolgens af.
#  Geïnstalleerd in /usr/local/libexec/pstf
#
exec grops</pre></div></div><div class=paragraph><p>Dat is alles. In <span class=filename>/etc/printcap</span> moet het volgende toegevoegd worden om het filter beschikbaar te maken:</p></div><div class="literalblock programlisting"><div class=content><pre>:tf=/usr/local/libexec/pstf:</pre></div></div><div class=paragraph><p>Hieronder een voorbeeld waarvan FORTRAN-programmeurs waarschijnlijk tranen in hun ogen krijgen: een FORTRAN-tekstfilter voor een willekeurige printer die in staat is platte tekst af te drukken. Het filter wordt actief gemaakt voor <code>teak</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# hprf - FORTRAN tekstfilter voor LaserJet 3si:
# Geïnstalleerd in /usr/local/libexec/hprf
#

printf &#34;\033&amp;k2G&#34; &amp;&amp; fpr &amp;&amp; printf &#34;\033&amp;l0H&#34; &amp;&amp;
 exit 0
exit 2</pre></div></div><div class=paragraph><p>De onderstaande regel wordt toegevoegd aan <span class=filename>/etc/printcap</span> voor de printer <code>teak</code> om het filter beschikbaar te maken:</p></div><div class="literalblock programlisting"><div class=content><pre>:rf=/usr/local/libexec/hprf:</pre></div></div><div class=paragraph><p>Het laatste voorbeeld is wellicht complexer. Er wordt een DVI-filter toegevoegd voor de eerder genoemde LaserJet printer <code>teak</code>. Eerst het makkelijke gedeelte: in <span class=filename>/etc/printcap</span> wordt de locatie van het DVI-filter opgegeven:</p></div><div class="literalblock programlisting"><div class=content><pre>:df=/usr/local/libexec/hpdf:</pre></div></div><div class=paragraph><p>Nu het moeilijke gedeelte: het schrijven van het filter. Daarvoor is een DVI-naar-LaserJet/PCL conversieprogramma nodig. De FreeBSD Portscollectie (zie <a href=./#ports>Portscollectie</a>) heeft er een: <a class=package href=https://cgit.freebsd.org/ports/tree/print/dvi2xx/>print/dvi2xx</a>. Door deze port te installeren komt het programma dat nodig is beschikbaar, <code>dvilj2p</code>, waarmee DVI geconverteerd kan worden naar LaserJet IIp-, LaserJet III- en LaserJet 2000-formaten.</p></div><div class=paragraph><p>Het hulpprogramma <code>dvilj2p</code> maakt het filter <code>hpdf</code> redelijk complex, omdat <code>dvilj2p</code> niet van de standaard invoer kan lezen. Het wil werken met een bestandsnaam. Nog lastiger is dat de bestandsnaam moet eindigen op <span class=filename>.dvi</span>, zodat moeilijk gebruik gemaakt kan worden van <span class=filename>/dev/fd/0</span> als standaard. Dit probleem kan omzeild worden door een (symbolische) koppeling aan te maken van een tijdelijk bestand (eindigend op <span class=filename>.dvi</span>) naar <span class=filename>/dev/fd/0</span>. Hiermee wordt <code>dvilj2p</code> gedwongen van de standaard invoer te lezen.</p></div><div class=paragraph><p>De enige andere hobbel die genomen moet worden, is dat <span class=filename>/tmp</span> niet gebruikt kan worden als tijdelijke koppeling. Symbolische koppelingen zijn eigendom van de gebruiker en groep <code>bin</code>. Het filter wordt uitgevoerd door de gebruiker <code>daemon</code>. De map <span class=filename>/tmp</span> heeft het sticky-bit aan staan. Het filter kan de koppeling wel aanmaken, maar het is niet mogelijk de koppeling te verwijderen als de opdracht is uitgevoerd, omdat de koppeling eigendom is van een andere gebruiker.</p></div><div class=paragraph><p>In plaats hiervan maakt het filter een symbolische koppeling aan in de huidige werkmap, de wachtrijmap (zoals opgegeven in de optie <code>sd</code> in <span class=filename>/etc/printcap</span>). Dit is een perfecte plaats voor filters om hun werk te doen, zeker gezien er (soms) meer vrije schijfruimte is in de wachtrijmap dan onder <span class=filename>/tmp</span>.</p></div><div class=paragraph><p>Dit is het uiteindelijke filter:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  hpdf - Druk DVI-gegevens af op een HP/PCL printer
#  Geïnstalleerd in /usr/local/libexec/hpdf

PATH=/usr/local/bin:$PATH; export PATH

#
#  Definieer een functie om tijdelijke bestanden op te ruimen. Deze
#  staan in de huidige map; de wachtrijmap voor de printer.
#
cleanup() {
   rm -f hpdf$$.dvi
}

#
#  Definieer een functie om fatale fouten te verwerken: geef de
#  opgegeven boodschap weer en sluit af met 2. Afsluiten met 2 vertelt
#  LPD niet nog eens te proberen de afdrukopdracht af te drukken.
#
fatal() {
    echo &#34;$@&#34; 1&gt;&amp;2
    cleanup
    exit 2
}

#
#  Als de gebruiker de opdracht annuleert, stuurt LPD een SIGINT, dus
#  ondervang SIGINT (en enkele andere signalen) om onze rommel op te
#  ruimen.
#
trap cleanup 1 2 15

#
#  Voor de zekerheid bestaande tijdelijke bestanden opruimen
#
cleanup

#
#  Koppel het DVI-invoerbestand aan de standaard invoer (het af te
#  drukken bestand).
#
ln -s /dev/fd/0 hpdf$$.dvi || fatal &#34;Cannot symlink /dev/fd/0&#34;

#
#  Maak LF = CR+LF
#
printf &#34;\033&amp;k2G&#34; || fatal &#34;Cannot initialize printer&#34;

#
#  Converteer en druk af.  De retourneerwaarde van dvilj2p lijkt niet
#  betrouwbaar, dus negeren we het.
#
dvilj2p -M1 -q -e- dfhp$$.dvi

#
#  Opruimen en afsluiten
#
cleanup
exit 0</pre></div></div></div><div class=sect5><h6 id=printing-advanced-autoconv>10.4.1.4.5. Automatische conversie: een alternatief voor conversiefilters<a class=anchor href=#printing-advanced-autoconv></a></h6><div class=paragraph><p>Al deze conversiefilters bieden vele mogelijkheden voor afdrukomgevingen, maar dwingen de gebruiker aan te geven (op de <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> commandoregel) welk filter gebruikt moet worden. Als gebruikers niet zo vaardig zijn in het gebruik van computers, wordt het al snel vervelend steeds aan te moeten geven welk filter gebruikt moet worden. Vervelender is echter wanneer een gebruiker een verkeerd filter gebruikt voor een bepaald bestandsformaat. Het resultaat kan zijn dat een printer honderden pagina’s papier uitspuugt.</p></div><div class=paragraph><p>In plaats van het installeren van conversiefilters, is het te proberen om het (standaard) tekstfilter het bestandstype van het af te drukken bestand te laten detecteren en dan automatisch het juiste conversiefilter aan te laten roepen. Programma’s als <code>file</code> kunnen hierbij handig zijn. Voor <em>sommige</em> bestandsformaten kan het moeilijk zijn de verschillen te ontdekken en voor deze bestanden kan alsnog een conversiefilter beschikbaar worden gesteld.</p></div><div class=paragraph><p>De FreeBSD Portscollectie heeft een tekstfilter dat automatisch converteert genaamd <code>apsfilter</code> (<a class=package href=https://cgit.freebsd.org/ports/tree/print/apsfilter/>print/apsfilter</a>). Het detecteert platte tekst, PostScript® en DVI-bestanden, voert de juiste conversie uit en druk de bestanden af.</p></div></div></div><div class=sect4><h5 id=printing-advanced-of>10.4.1.5. Uitvoerfilters<a class=anchor href=#printing-advanced-of></a></h5><div class=paragraph><p>Het wachtrijsysteem LPD ondersteunt een ander type filter waar nog geen aandacht aan is besteed: een uitvoerfilter. Een uitvoerfilter is bedoeld om alleen platte tekst af te drukken, net als een tekstfilter, maar met veel vereenvoudigingen. Wanneer een uitvoerfilter wordt gebruikt, maar geen tekstfilter, dan:</p></div><div class=ulist><ul><li><p>start LPD een uitvoerfilter voor de gehele opdracht, in plaats van voor elk bestand in de opdracht;</p></li><li><p>biedt LPD het uitvoerfilter niet de voorziening van het identificeren van het begin of eind van de bestanden in de afdrukopdracht;</p></li><li><p>stuurt LPD de gebruikersnaam en de hostnaam niet door aan het filter. Het is dus niet bedoeld om een afdrukadministratie bij te houden. In feite zijn er maar twee argumenten:</p><div class=paragraph><p><code>filter-name</code> -w_width_ -l_length_</p></div><div class=paragraph><p>Hierbij is <em>width</em> afkomstig van de optie <code>pw</code> en <em>length</em> afkomstig van de optie <code>pl</code> voor de betreffende printer.</p></div></li></ul></div><div class=paragraph><p>De eenvoud van een uitvoerfilter is verleidelijk. Als elk bestand in een afdrukopdracht op een nieuwe pagina moet beginnen, is een uitvoerfilter <em>niet geschikt</em>. In dat geval dient een tekstfilter (ook wel invoerfilter) gebruikt te worden (zie <a href=#printing-textfilter>Tekstfilter installeren</a>. Verder is een uitvoerfilter eigenlijk <em>veel ingewikkelder</em>, omdat de te verwerken bytestroom gecontroleerd moet worden op speciale tekens en steeds signalen naar zichzelf moet sturen in opdracht van LPD.</p></div><div class=paragraph><p>Een uitvoerfilter is <em>noodzakelijk</em> als voorbladen gewenst zijn en het nodig is om escape-reeksen of andere initialisatietekens te sturen voor het afdrukken van het voorblad. Maar het is tevens <em>nutteloos</em> als het voorblad voor rekening van de afkomstige gebruiker moet komen, aangezien LPD geen gebruiker of hostinformatie naar het uitvoerfilter stuurt.</p></div><div class=paragraph><p>Op een enkele printer staat LPD het gebruik van zowel een uitvoerfilter als van een tekst of andere filter toe. In deze gevallen start LPD het uitvoerfilter alleen voor het afdrukken van het voorblad (zie <a href=#printing-advanced-header-pages>Voorbladen</a>). LPD verwacht vervolgens van het uitvoerfilter dat deze <em>zichzelf stopt</em> door twee bytes naar het filter te sturen: ASCII 031 gevolgd door ASCII 001. Als een uitvoerfilter deze twee bytes ziet (031, 001), moet die stoppen door een <code>SIGSTOP</code> naar zichzelf te sturen. Als LPD klaar is met het uitvoeren van alle andere filters, dan herstart deze het uitvoerfilter door er een <code>SIGCONT</code> naar toe te sturen.</p></div><div class=paragraph><p>Als er wel een uitvoerfilter, maar <em>geen</em> tekstfilter is en LPD is niet bezig met het verwerken van een opdracht met platte tekst, dan gebruikt LPD het uitvoerfilter voor het afdrukken van de opdracht. Zoals eerder vermeld, drukt het uitvoerfilter elk bestand van de opdracht achter elkaar af zonder pagina-einden of andere signalen voor paginavoortgang. Dit is waarschijnlijk <em>niet</em> gewenst. In bijna alle gevallen is een tekstfilter nodig.</p></div><div class=paragraph><p>Het programma <code>lpf</code>, dat eerder geïntoduceerd is als tekstfilter, kan ook worden uitgevoerd als uitvoerfilter. Als een ad-hoc uitvoerfilter nodig is, maar het schrijven van de bytedetectie en signaalverzending code niet wenselijk is, dan is <code>lpf</code> het proberen waard. <code>lpf</code> kan ook opgenomen worden in een shellscript om initialisatiecode af te handelen die eventueel nodig is voor een printer.</p></div></div><div class=sect4><h5 id=printing-advanced-lpf>10.4.1.6. <code>lpf</code>: een tekstfilter<a class=anchor href=#printing-advanced-lpf></a></h5><div class=paragraph><p>Het programma <span class=filename>/usr/libexec/lpr/lpf</span> uit de gecompileerde FreeBSD-distributie is een tekstfilter (invoerfilter) die uitvoer kan inspringen (een opdracht gegeven met <code>lpr -i</code>), karakters onveranderd kan doorlaten (een opdracht gegeven met <code>lpr -l</code>), de printpositie voor backspaces en tabs in de opdracht kan aanpassen en afgedrukte pagina’s kan administreren. Het kan ook functioneren als uitvoerfilter.</p></div><div class=paragraph><p>Het filter <code>lpf</code> is geschikt voor vele afdrukomgevingen. Hoewel het zelf niet in staat is initialisatiesequenties naar een printer te sturen, is het vrij eenvoudig om een shellscript te schrijven dat de initialisatie doet en vervolgens <code>lpf</code> aanroept.</p></div><div class=paragraph><p>Als <code>lpf</code> afgedrukte pagina’s moet administreren, is het nodig om de juiste waarden in te vullen voor de opties <code>pw</code> en <code>pl</code> in het bestand <span class=filename>/etc/printcap</span>. Deze waarden worden gebruikt om te bepalen hoeveel tekst er op een pagina past en hoeveel pagina’s er in een afdrukopdracht zijn afgedrukt. Zie <a href=#printing-advanced-acct>Printergebruik administreren</a> voor meer informatie.</p></div></div></div><div class=sect3><h4 id=printing-advanced-header-pages>10.4.2. Voorbladen<a class=anchor href=#printing-advanced-header-pages></a></h4><div class=paragraph><p>Als er <em>veel</em> gebruikers zijn die allemaal verschillende printers gebruiken, dan is het te overwegen gebruik te maken van <em>voorbladen</em> als noodzakelijk kwaad.</p></div><div class=paragraph><p>Voorbladen, in het Engels ook wel bekend als <em>banner</em> of <em>burst</em> pagina’s, identificeren wie een bepaalde opdracht heeft afgedrukt. Ze worden meestal bedrukt met grote, dikgedrukte letters, eventueel met een decoratieve rand, zodat ze in een stapel afdrukken opvallen tussen de afgedrukte documenten. Ze maken het gebruikers mogelijk hun afdrukopdracht snel te vinden. Het nadeel van het gebruik van voorbladen is dat er een extra blad moet worden afgedrukt voor elke opdracht, waarmee hun nut niet langer duurt dan een paar minuten. Uiteindelijk belanden ze in een papierbak of afvalberg. Voorbladen gaan vooraf aan elke opdracht, niet aan elk bestand in een opdracht, waardoor de verspilling beperkt blijft.</p></div><div class=paragraph><p>Het LPD-systeem kan automatisch voorbladen afdrukken <em>als</em> een printer direct platte tekst kan afdrukken. In geval van een PostScript®-printer, is het nodig een extern programma aan te roepen om een voorblad te genereren (zie <a href=#printing-advanced-header-pages-ps>Voorbladen op PostScript®-printers</a>.</p></div><div class=sect4><h5 id=printing-advanced-header-pages-enabling>10.4.2.1. Voorbladen afdrukken<a class=anchor href=#printing-advanced-header-pages-enabling></a></h5><div class=paragraph><p>In de sectie <a href=#printing-simple>Eenvoudige printerinstallatie</a> is het afdrukken van voorbladen uitgeschakeld door de optie <code>sh</code> ("suppress header") in het bestand <span class=filename>/etc/printcap</span> op te geven. Om wel voorbladen af te drukken, hoeft alleen de optie <code>sh</code> verwijderd te worden.</p></div><div class=paragraph><p>Dit klinkt wat al te makkelijk, of niet?</p></div><div class=paragraph><p>Dat klopt. Het <em>kan</em> nodig zijn een uitvoerfilter op te geven die initialisatiestrings naar een printer stuurt. Hier is een voorbeeld uitvoerfilter voor HP PCL-compatible printers:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  hpof - Uitvoerfilter voor HP PCL-compatible printers
#  Geïnstalleerd in /usr/local/libexec/hpof

printf &#34;\033&amp;k2G&#34; || exit 2
exec /usr/libexec/lpr/lpf</pre></div></div><div class=paragraph><p>Geef de locatie van het uitvoerfilter op met de optie <code>of</code>. Zie <a href=#printing-advanced-of>Uitvoerfilters</a> voor meer informatie.</p></div><div class=paragraph><p>Hier is een voorbeeldbestand <span class=filename>/etc/printcap</span> voor de printer <code>teak</code> die eerder is geïntroduceerd;. Het afdrukken van voorbladen is geactiveerd en bovenstaande uitvoerfilter is toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host orchid
#
teak|hp|laserjet|HP LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/hpif:\
        :vf=/usr/local/libexec/hpvf:\
        :of=/usr/local/libexec/hpof:</pre></div></div><div class=paragraph><p>Als gebruikers nu een opdracht sturen naar <code>teak</code>, wordt er bij elke opdracht een voorblad afgedrukt. Als gebruikers liever willen zoeken naar hun afdrukken, dan kunnen ze de voorbladen onderdrukken door de opdracht te geven met het commando <code>lpr -h</code>. Zie <a href=#printing-lpr-options-misc>Voorbladopties</a> voor meer opties voor <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>LPD drukt een karakter voor pagina-einde af na elk voorblad. Als een printer een ander teken of sequentie gebruikt voor het beëindigen van een pagina, dan kan dit opgeven worden met de optie <code>ff</code> in <span class=filename>/etc/printcap</span>.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=printing-advanced-header-pages-controlling>10.4.2.2. Voorbladen beheren<a class=anchor href=#printing-advanced-header-pages-controlling></a></h5><div class=paragraph><p>Door het afdrukken van voorbladen aan te zetten, produceert LPD een <em>lang voorblad</em> waarop in grote letters de gebruiker, host en opdracht te lezen zijn. Hier volgt een voorbeeld (<code>kelly</code> heeft de opdracht "outline" afgedrukt vanaf host <code>rose</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>      k                   ll       ll
      k                    l        l
      k                    l        l
      k   k     eeee       l        l     y    y
      k  k     e    e      l        l     y    y
      k k      eeeeee      l        l     y    y
      kk k     e           l        l     y    y
      k   k    e    e      l        l     y   yy
      k    k    eeee      lll      lll     yyy y
                                               y
                                          y    y
                                           yyyy

                                   ll
                          t         l        i
                          t         l
       oooo    u    u   ttttt       l       ii     n nnn     eeee
      o    o   u    u     t         l        i     nn   n   e    e
      o    o   u    u     t         l        i     n    n   eeeeee
      o    o   u    u     t         l        i     n    n   e
      o    o   u   uu     t  t      l        i     n    n   e    e
       oooo     uuu u      tt      lll      iii    n    n    eeee

      r rrr     oooo     ssss     eeee
      rr   r   o    o   s    s   e    e
      r        o    o    ss      eeeeee
      r        o    o      ss    e
      r        o    o   s    s   e    e
      r         oooo     ssss     eeee

                                              Job:  outline
                                              Date: Sun Sep 17 11:04:58 1995</code></pre></div></div><div class=paragraph><p>LPD geeft een paginabegin na deze tekst, zodat de opdracht op een nieuwe pagina begint (tenzij de optie <code>sf</code> (<em>suppress form feeds</em>, "onderdruk paginabegin") is toegevoegd bij de desbetreffende printer in <span class=filename>/etc/printcap</span>).</p></div><div class=paragraph><p>Als dit wenselijk is, kan LPD ook een <em>korte tekst</em> op het voorblad afdrukken; geef hiervoor de optie <code>sb</code> (<em>short banner</em>, "kort voorblad") op in het bestand <span class=filename>/etc/printcap</span>. Het voorblad ziet er dan als volgt uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>rose:kelly  Job: outline  Date: Sun Sep 17 11:07:51 1995</code></pre></div></div><div class=paragraph><p>Standaard drukt LPD het voorblad als eerste af en vervolgens de opdracht. Om dat om te keren, moet de optie <code>hl</code> (<em>header last</em>, "voorblad laatst") in <span class=filename>/etc/printcap</span> worden opgeven.</p></div></div><div class=sect4><h5 id=printing-advanced-header-pages-accounting>10.4.2.3. Voorbladen administreren<a class=anchor href=#printing-advanced-header-pages-accounting></a></h5><div class=paragraph><p>Het gebruik van LPD’s ingebouwde voorbladen dwingt een bepaald paradigma af wat betreft het administreren van printergebruik: voorbladen moeten <em>gratis</em> zijn.</p></div><div class=paragraph><p>Waarom?</p></div><div class=paragraph><p>Omdat het uitvoerfilter het enige externe programma is dat controle heeft als het voorblad afgedrukt wordt dat het gebruik zou kunnen administreren. Het heeft echter geen beschikking over informatie over <em>gebruiker of host</em> of een administratiebestand. Het heeft dus geen idee wie voor het gebruik moet worden belast. Het volstaat ook niet om gewoon "het aantal pagina’s met één op te hogen" door het tekstfilter of een van de conversiefilters (dat wel beschikt over gebruiker- en hostinformatie) te veranderen, omdat gebruikers het afdrukken van een voorblad kunnen onderdrukken met <code>lpr -h</code>. Ze worden dan aangeslagen voor voorbladen die niet zijn afgedrukt. Milieubewuste gebruikers gebruiken vast <code>lpr -h</code>, maar dit kan niet worden afgedwongen.</p></div><div class=paragraph><p>Het is <em>ook niet voldoende</em> om elk filter zijn eigen voorblad te laten genereren (om zo het gebruik te kunnen administreren). Als gebruikers het afdrukken van voorbladen willen onderdrukken met <code>lpr -h</code>, krijgen ze toch een voorblad en worden er ook voor belast, aangezien LPD geen kennis over de optie <code>-h</code> doorgeeft aan de filters.</p></div><div class=paragraph><p>Wat zijn dan de mogelijkheden?</p></div><div class=ulist><ul><li><p>Accepteer het paradigma van LPD en maak voorbladen gratis;</p></li><li><p>Installeer een alternatief voor LPD, zoals LPRng. In <a href=#printing-lpd-alternatives>Alternatieven voor het standaard wachtrijsysteem</a> staat meer over andere afdruksoftware die in plaats van LPD geïnstalleerd kan worden;</p></li><li><p>Schrijf een <em>slim</em> uitvoerfilter. Gewoonlijk is een uitvoerfilter bedoeld om niet meer te doen dan het initialiseren van een printer of wat eenvoudige karakterconversie. Het is geschikt voor voorbladen en opdrachten met platte tekst (als er een tekstfilter is). Maar als er een tekstfilter is voor opdrachten met platte tekst, dan start LPD het uitvoerfilter alleen voor voorbladen. Het uitvoerfilter kan dan het voorblad dat LPD genereert analyseren om te bepalen welke gebruiker en host belast moeten worden voor het afdrukken van het voorblad. Het enige probleem is dat het uitvoerfilter nog steeds niet weet in welk bestand het gebruik moet worden bijgehouden (de naam van het bestand opgegeven in de <code>af</code> wordt niet meegegeven), maar als een bekend bestand gebruikt wordt, kan dit in het uitvoerfilter worden opgeven. Om het parsen af te handelen kan gebruik gemaakt worden van de optie <code>sh</code> (<em>short header</em>, "kort voorblad") in <span class=filename>/etc/printcap</span>. Dit kan echter wat omslachtig zijn en gebruikers waarderen zeker de meer gulle systeembeheerder die voorbladen gratis maakt.</p></li></ul></div></div><div class=sect4><h5 id=printing-advanced-header-pages-ps>10.4.2.4. Voorbladen op PostScript®-printers<a class=anchor href=#printing-advanced-header-pages-ps></a></h5><div class=paragraph><p>Zoals hierboven beschreven, kan LPD een voorblad in platte tekst genereren, dat geschikt is voor de meeste printers. Natuurlijk kan PostScript® platte tekst niet direct afdrukken, zodat de voorbladfunctie van LPD nutteloos is.</p></div><div class=paragraph><p>Een voor de hand liggende manier om voorbladen te krijgen, is elk conversiefilter en tekstfilter zijn eigen voorblad te laten genereren. De filters moeten gebruik maken van de argumenten gebruiker en host om een geschikt voorblad te genereren. Het nadeel van deze methode is dat gebruikers altijd een voorblad krijgen, ook wanneer zij een opdracht geven met <code>lpr -h</code>.</p></div><div class=paragraph><p>Deze methode wordt nader beschreven. Het volgende script heeft drie argumenten (gebruikersnaam, hostnaam en de naam van de opdracht) en maakt een eenvoudig PostScript®-voorblad:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  make-ps-header - genereer een PostScript-voorblad op stdout
#  Geïnstalleerd in /usr/local/libexec/make-ps-header
#

#
#  Dit zijn PostScript-eenheden (72 in een inch). Pas dit aan voor A4
#  of het gebruikte formaat:
#
page_width=612
page_height=792
border=72

#
#  Controleer argumenten
#
if [ $# -ne 3 ]; then
    echo &#34;Usage: `basename $0` &lt;user&gt; &lt;host&gt; &lt;job&gt;&#34; 1&gt;&amp;2
    exit 1
fi

#
#  Bewaar deze, voornamelijk voor de leesbaarheid in de PostScript(R)-code.
#
user=$1
host=$2
job=$3
date=`date`

#
#  Stuur de PostScript(R)-code naar stdout.
#
exec cat &lt;&lt;EOF
%!PS

%
%  Vermijd conflicten met de opdracht van de gebruiker die volgt.
%
save

%
%  Maak een dikke, onaangename border in de marge van het papier.
%
$border $border moveto
$page_width $border 2 mul sub 0 rlineto
0 $page_height $border 2 mul sub rlineto
currentscreen 3 -1 roll pop 100 3 1 roll setscreen
$border 2 mul $page_width sub 0 rlineto closepath
0.8 setgray 10 setlinewidth stroke 0 setgray

%
%  Toon de gebruikersnaam duidelijk, groot en prominent
%
/Helvetica-Bold findfont 64 scalefont setfont
$page_width ($user) stringwidth pop sub 2 div $page_height 200 sub moveto
($user) show

%
%  Nu volgen de saaie bijzonderheden
%
/Helvetica findfont 14 scalefont setfont
/y 200 def
[ (Job:) (Host:) (Date:) ] {
200 y moveto show /y y 18 sub def }
forall

/Helvetica-Bold findfont 14 scalefont setfont
/y 200 def
[ ($job) ($host) ($date) ] {
        270 y moveto show /y y 18 sub def
} forall

%
% Dat is alles
%
restore
showpage
EOF</pre></div></div><div class=paragraph><p>Nu kan zowel het conversiefilter als het tekstfilter dit script aanroepen om eerst een voorblad te genereren en vervolgens de opdracht van de gebruiker af te drukken. Hier volgt het eerder gebruikte DVI-conversieprogramma, aangepast om een voorblad te maken:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  psdf - DVI naar PostScript printfilter
#  Geïnstalleerd in /usr/local/libexec/psdf
#
#  Aangeroepen door lpd, wanneer de gebruiker lpr -d uitvoert
#

orig_args=&#34;$@&#34;

fail() {
    echo &#34;$@&#34; 1&gt;&amp;2
    exit 2
}

while getopts &#34;x:y:n:h:&#34; option; do
    case $option in
        x|y)  ;; # Ignore
        n)    login=$OPTARG ;;
        h)    host=$OPTARG ;;
        *)    echo &#34;LPD started `basename $0` wrong.&#34; 1&gt;&amp;2
              exit 2
              ;;
    esac
done

[ &#34;$login&#34; ] || fail &#34;No login name&#34;
[ &#34;$host&#34; ] || fail &#34;No host name&#34;

( /usr/local/libexec/make-ps-header $login $host &#34;DVI File&#34;
  /usr/local/bin/dvips -f ) | eval /usr/local/libexec/lprps $orig_args</pre></div></div><div class=paragraph><p>Merk op hoe het filter eerst de argumentenlijst moet nagaan om te bepalen wat de gebruikers- en hostnaam zijn. Dit is gelijk voor de andere conversiefilters. Het tekstfilter heeft echter een andere verzameling argumenten (zie <a href=#printing-advanced-filters>Hoe filters werken</a>).</p></div><div class=paragraph><p>Zoals eerder is beschreven, is het in bovenstaande opzet, hoewel deze simpel is, niet mogelijk "voorbladen te onderdrukken" (de optie <code>-h</code> in <code>lpr</code>). Als gebruikers een boom willen sparen (of een paar centen bij betaalde voorbladen) dan is dit dus niet mogelijk, aangezien elk filter een voorblad afdrukt voor iedere opdracht.</p></div><div class=paragraph><p>Om gebruikers in staat te stellen per opdracht voorbladen te onderdrukken, moet gebruik gemaakt worden van de truc uit <a href=#printing-advanced-header-pages-accounting>Voorbladen administreren</a>: schrijf een uitvoerfilter dat het door LPD gegenereerde voorblad inleest en een PostScript®-versie genereert. Als de gebruiker de opdracht geeft met <code>lpr -h</code>, dan genereert LPD geen voorblad en het uitvoerfilter ook niet. Anders leest het uitvoerfilter de tekst van LPD in en stuurt een geschikt voorblad in PostScript® naar de printer.</p></div><div class=paragraph><p>Voor een PostScript®-printer op een seriële lijn kan gebruik gemaakt worden van <code>lprps</code>, dat met een uitvoerfilter wordt geleverd en het bovenstaande kan doen. Voorbladen worden door <code>psof</code> niet geteld.</p></div></div></div><div class=sect3><h4 id=printing-advanced-network-printers>10.4.3. Afdrukken via het netwerk<a class=anchor href=#printing-advanced-network-printers></a></h4><div class=paragraph><p>FreeBSD ondersteunt afdrukken via het netwerk: het sturen van opdrachten naar printers op afstand. Afdrukken via een netwerk betekent over het algemeen twee verschillende dingen:</p></div><div class=ulist><ul><li><p>Het benaderen van een printer aangesloten op een andere computer. Een printer met een conventionele seriële of parallelle verbinding wordt op een bepaalde computer geïnstalleerd. Vervolgens wordt LPD zodanig ingesteld dat afdrukken vanaf andere computers in het netwerk mogelijk is. In <a href=#printing-advanced-network-rm>Printers geïnstalleerd op andere hosts</a> staat hoe dit te doen.</p></li><li><p>Het benaderen van een printer die direct is aangesloten op een netwerk. Een printer heeft een netwerkinterface naast (of in plaats van) een gewone seriële of parallelle poort. Zo een printer kan als volgt werken:</p><div class=ulist><ul><li><p>Het begrijpt het LPD protocol en kan zelfs opdrachten van andere hosts in de wachtrij plaatsen. In dit geval werkt een printer als een gewone host die LPD heeft draaien. Volg de procedure in <a href=#printing-advanced-network-rm>Printers geïnstalleerd op andere hosts</a> om een dergelijke printer te installeren</p></li><li><p>Het kan zijn dat een printer een netwerkverbinding ondersteunt. In dit geval kan een printer worden "aangesloten" op een bepaalde host op het netwerk door deze host verantwoordelijk te maken voor het plaatsen van opdrachten in een wachtrij en het versturen van opdrachten naar de printer. In <a href=#printing-advanced-network-net-if>Printers met netwerkinterfaces</a> staan enkele suggesties om zulke printers te installeren.</p></li></ul></div></li></ul></div><div class=sect4><h5 id=printing-advanced-network-rm>10.4.3.1. Printers geïnstalleerd op andere hosts<a class=anchor href=#printing-advanced-network-rm></a></h5><div class=paragraph><p>Het wachtrijsysteem LPD heeft een ingebouwde mogelijkheid om opdrachten naar andere hosts te sturen die ook LPD draaien (of een systeem dat compatibel is met LPD). Deze eigenschap maakt het mogelijk om een printer op een host te installeren en deze toegankelijk te maken voor andere hosts. Het werkt ook met printers die over een netwerkinterface beschikken en het LPD-protocol begrijpen.</p></div><div class=paragraph><p>Om dit soort afdrukken op afstand mogelijk te maken, moet een printer eerst op een host geïnstalleerd worden, de <em>printerhost</em>, door de printerinstallatie te volgen als beschreven in <a href=#printing-simple>Eenvoudige printerinstallatie</a>. Stel desgewenst de printer in voor geavanceerde taken volgens <a href=#printing-advanced>Geavanceerde printerinstallatie</a>. Test de printer en controleer of deze werkt met eventueel speciaal ingestelde opties voor LPD. De <em>lokale host</em> moet geautoriseerd zijn om de LPD-dienst op de <em>verre host</em> te gebruiken (zie <a href=#printing-advanced-restricting-remote>Opdrachten van hosts op afstand beperken</a>).</p></div><div class=paragraph><p>Als een printer een netwerkinterface heeft die compatibel is met LPD, dan is de <em>printerhost</em> in onderstaande beschrijving de printer zelf en de <em>printernaam</em> is de naam die voor de printer is ingesteld. Meer informatie staat in de documentatie bij de printer en/of de printernetwerkinterface.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Bij een HP LaserJet voert de printernaam <code>text</code> automatisch de CRLF-conversie uit. Het is dan niet nodig het script <span class=filename>hpif</span> te gebruiken.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Op hosts die toegang moeten krijgen tot de printer, moet in <span class=filename>/etc/printcap</span> een regel worden toegevoegd met het volgende:</p></div><div class="olist arabic"><ol class=arabic><li><p>Geef de regel een willekeurige naam. Om het eenvoudig te houden kunnen wellicht het beste dezelfde namen en aliassen worden gebruikt als op de printerhost;</p></li><li><p>Laat de optie <code>lp</code> expliciet leeg (<code>:lp=:</code>);</p></li><li><p>Maak een wachtrijmap aan en geef de locatie op met de optie <code>sd</code>. LPD slaat hier afdrukopdrachten op alvorens ze naar de printerhost te sturen;</p></li><li><p>Geef de naam van de printerhost op met de optie <code>rm</code>;</p></li><li><p>Geef de naam van de printer op de <em>printerhost</em> op met de optie <code>rp</code>.</p></li></ol></div><div class=paragraph><p>Dit is het. Conversiefilters, paginadimensies, enzovoort, hoeven niet in <span class=filename>/etc/printcap</span> opgegeven te worden.</p></div><div class=paragraph><p>Hier volgt een voorbeeld. De host <code>rose</code> heeft twee printers: <code>bamboo</code> en <code>rattan</code>. Gebruikers op de host <code>orchid</code> krijgen toegang tot deze printers. Hier volgt <span class=filename>/etc/printcap</span> voor <code>orchid</code> (uit <a href=#printing-advanced-header-pages-enabling>Voorbladen afdrukken</a>). Er stond in het bestand al een regel voor de printer <code>teak</code>. Voor de twee printers op de host <code>rose</code> zijn twee regels toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host orchid - printers (op afstand) op rose toegevoegd
#

#
#  teak is lokaal; het is direct aangesloten op orchid:
#
teak|hp|laserjet|HP LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/ifhp:\
        :vf=/usr/local/libexec/vfhp:\
        :of=/usr/local/libexec/ofhp:

#
#  rattan is aangesloten op rose; stuur opdrachten voor rattan naar rose:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=/var/spool/lpd/rattan:

#
#  bamboo is ook aangesloten op rose:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=/var/spool/lpd/bamboo:</pre></div></div><div class=paragraph><p>Op <code>orchid</code> moeten wachtrijmappen worden aangemaakt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir -p /var/spool/lpd/rattan /var/spool/lpd/bamboo</span>
<span class=c># chmod 770 /var/spool/lpd/rattan /var/spool/lpd/bamboo</span>
<span class=c># chown daemon:daemon /var/spool/lpd/rattan /var/spool/lpd/bamboo</span></code></pre></div></div><div class=paragraph><p>Nu kunnen gebruikers op <code>orchid</code> afdrukken op <code>rattan</code> en <code>bamboo</code>. Een gebruiker op <code>orchid</code> geeft bijvoorbeeld de volgende invoer:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-P</span> bamboo <span class=nt>-d</span> sushi-review.dvi</code></pre></div></div><div class=paragraph><p>Dan kopieert LPD op <code>orchid</code> de opdracht naar de wachtrijmap <span class=filename>/var/spool/lpd/bamboo</span> en ziet dat het een DVI-opdracht is. Zodra de host <code>rose</code> ruimte heeft in zijn wachtrijmap <code>bamboo</code>, sturen de twee LPD’s het bestand naar <code>rose</code>. Het bestand wacht in de wachtrij van <code>rose</code> totdat het succesvol is afgedrukt. Het wordt geconverteerd naar PostScript® (aangezien <code>bamboo</code> een PostScript®-printer is) op <code>rose</code>.</p></div></div><div class=sect4><h5 id=printing-advanced-network-net-if>10.4.3.2. Printers met netwerkinterfaces<a class=anchor href=#printing-advanced-network-net-if></a></h5><div class=paragraph><p>Netwerkkaarten voor printers zijn er in twee versies: een versie die een wachtrij nabootst (de duurdere versies), of versies die alleen de mogelijkheid geven om er informatie naar te sturen alsof het een seriële of parallelle poort is (de goedkopere versies). In <a href=#printing-advanced-network-rm>Printers geïnstalleerd op andere hosts</a> wordt het voor de duurdere beschreven.</p></div><div class=paragraph><p>Het formaat van <span class=filename>/etc/printcap</span> maakt het mogelijk om op te geven welke seriële, of parallelle poort gebruikt moet worden en (in geval van een seriële poort) de baud-snelheid, of er communicatie moet worden toegepast, vertragingen voor tabs, conversies voor nieuwe regelkarakters en meer. Er is geen mogelijkheid om een verbinding met een printer op te geven die op een TCP/IP of andere netwerkpoort luistert.</p></div><div class=paragraph><p>Om informatie naar een netwerkprinter te sturen, is het nodig een programma te ontwikkelen dat door tekst- en conversiefilters kan worden aangeroepen. Hier volgt een voorbeeld: het script <code>netprint</code> stuurt alle informatie van de standaard invoer naar een netwerkprinter. Als eerste argument wordt de hostnaam van de printer opgegeven en als tweede argument het poortnummer waarmee de verbinding moet worden opgezet. Er wordt alleen eenrichtingcommunicatie ondersteund (FreeBSD naar printer). Veel netwerkprinters ondersteunen tweewegcommunicatie. Het kan wenselijk zijn hiervan gebruik te maken (om printerstatus op te vragen, statistieken bij te houden, enzovoort).</p></div><div class="literalblock programlisting"><div class=content><pre>#!/usr/bin/perl
#
#  netprint - Tekstfilter voor printer aangesloten op het netwerk
#  Geïnstalleerd in /usr/local/libexec/netprint
#
$#ARGV eq 1 || die &#34;Usage: $0 &lt;printer-hostname&gt; &lt;port-number&gt;&#34;;

$printer_host = $ARGV[0];
$printer_port = $ARGV[1];

require &#39;sys/socket.ph&#39;;

($ignore, $ignore, $protocol) = getprotobyname(&#39;tcp&#39;);
($ignore, $ignore, $ignore, $ignore, $address)
    = gethostbyname($printer_host);

$sockaddr = pack(&#39;S n a4 x8&#39;, &amp;AF_INET, $printer_port, $address);

socket(PRINTER, &amp;PF_INET, &amp;SOCK_STREAM, $protocol)
    || die &#34;Can&#39;t create TCP/IP stream socket: $!&#34;;
connect(PRINTER, $sockaddr) || die &#34;Can&#39;t contact $printer_host: $!&#34;;
while (&lt;STDIN&gt;) { print PRINTER; }
exit 0;</pre></div></div><div class=paragraph><p>Dit script kan vervolgens in verschillende filters gebruikt worden. Stel dat een Diablo 750-N matrixprinter op het netwerk is aangesloten. Op poort 5100 accepteert de printer informatie om af te drukken. De hostnaam van de printer is <code>scrivener</code>. Hier volgt het tekstfilter voor de printer:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  diablo-if-net - Tekstfilter voor Diablo printer &#39;scrivener&#39; luistert
#  op poort 5100. Geïnstalleerd in /usr/local/libexec/diablo-if-net
#
exec /usr/libexec/lpr/lpf &#34;$@&#34; | /usr/local/libexec/netprint scrivener 5100</pre></div></div></div></div><div class=sect3><h4 id=printing-advanced-restricting>10.4.4. Printergebruik beperken<a class=anchor href=#printing-advanced-restricting></a></h4><div class=paragraph><p>Nu volgt informatie over het beperken van printergebruik. Het LPD-systeem maakt het mogelijk te bepalen wie er toegang heeft tot een printer, zowel lokaal als op afstand, of meerdere kopieën afgedrukt mogen worden, hoe lang opdrachten mogen zijn en hoe lang wachtrijen mogen worden.</p></div><div class=sect4><h5 id=printing-advanced-restricting-copies>10.4.4.1. Meerdere kopieën beperken<a class=anchor href=#printing-advanced-restricting-copies></a></h5><div class=paragraph><p>Het LPD systeem maakt het heel makkelijk voor gebruikers om meerdere afdrukken van een bestand te maken. Gebruikers kunnen opdrachten afdrukken met bijvoorbeeld <code>lpr -#5</code> en krijgen dan vijf kopieën van elk bestand in de opdracht. De systeembeheerder kan beslissen of dit wenselijk is.</p></div><div class=paragraph><p>Wanneer meerdere kopieën onwenselijk zijn, kan de optie <code>-<mark></mark></code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> worden uitgeschakeld door de optie <code>sc</code> in <span class=filename>/etc/printcap</span> op te nemen. Als gebruikers opdrachten versturen met de optie <code>-</code>, zien ze het volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>lpr: multiple copies are not allowed</code></pre></div></div><div class=paragraph><p>Als het mogelijk is van andere hosts af te drukken (zie <a href=#printing-advanced-network-rm>Printers geïnstalleerd op andere hosts</a>), moet de optie <code>sc</code> ook in <span class=filename>/etc/printcap</span> van de andere hosts aanwezig zijn. Anders kunnen gebruikers nog steeds multi-kopie opdrachten van andere hosts sturen.</p></div><div class=paragraph><p>Hier volgt een voorbeeld. Hieronder staat <span class=filename>/etc/printcap</span> voor de host <code>rose</code>. De printer <code>rattan</code> is redelijk krachtig, dus meerdere kopieën zijn toegestaan. De laserprinter <code>bamboo</code> is wat gevoeliger, dus meerdere kopieë zijn uitgeschakeld door de optie <code>sc</code> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host rose - beperk meerdere kopieën op bamboo
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:\
        :lp=/dev/ttyu5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Nu moet ook de optie <code>sc</code> worden toegevoegd in <span class=filename>/etc/printcap</span> van host <code>orchid</code> (tegelijk worden meerdere kopieën voor de printer <code>teak</code> uitgeschakeld):</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host orchid - geen meerdere kopieën voor lokale
#  printer teak of printer op afstand bamboo
teak|hp|laserjet|HP LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:sc:\
        :if=/usr/local/libexec/ifhp:\
        :vf=/usr/local/libexec/vfhp:\
        :of=/usr/local/libexec/ofhp:

rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=/var/spool/lpd/rattan:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=/var/spool/lpd/bamboo:sc:</pre></div></div><div class=paragraph><p>Door de optie <code>sc</code> te gebruiken, wordt het gebruik van <code>lpr -#i</code> voorkomen, maar dat weerhoudt gebruikers er nog steeds niet van om <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> meerdere keren te aanroepen of meerdere keren hetzelfde bestand te versturen in een opdracht:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr voorverkoop.teken voorverkoop.teken voorverkoop.teken voorverkoop.teken voorverkoop.teken</code></pre></div></div><div class=paragraph><p>Er zijn vele manieren om dit misbruik te voorkomen (onder andere door het te negeren), welke vrij zijn om te verkennen.</p></div></div><div class=sect4><h5 id=printing-advanced-restricting-access>10.4.4.2. Printertoegang beperken<a class=anchor href=#printing-advanced-restricting-access></a></h5><div class=paragraph><p>Door gebruik te maken van het UNIX® groepmechanisme en de optie <code>rg</code> in <span class=filename>/etc/printcap</span> kan geregeld worden wie er op welke printer kan afdrukken. De gebruikers die toegang hebben tot een printer moeten in een groep worden geplaatst en deze groep moet in de optie <code>rg</code> worden genoemd.</p></div><div class=paragraph><p>Als gebruikers buiten de groep (inclusief <code>root</code>) naar de beheerde printer proberen te printen, worden ze begroet met het volgende bericht:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>lpr: Not a member of the restricted group</code></pre></div></div><div class=paragraph><p>Net als met de optie <code>sc</code> (<em>suppress multiple copies</em>: onderdruk meerdere kopieën) moet <code>rg</code>, indien wenselijk, ook op andere hosts worden opgegeven die ook toegang hebben tot printers (zie <a href=#printing-advanced-network-rm>Printers geïnstalleerd op andere hosts</a>).</p></div><div class=paragraph><p>In het volgende voorbeeld heeft iedereen toegang tot de printer <code>rattan</code>, maar alleen gebruikers in de groep <code>artists</code> kunnen gebruik maken van <code>bamboo</code>. Hier volgt het bekende <span class=filename>/etc/printcap</span> voor de host <code>rose</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host rose - beperkte toegang voor groep bamboo
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:\
        :lp=/dev/ttyu5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>De andere voorbeeldbestanden <span class=filename>/etc/printcap</span> (voor de host <code>orchid</code>) worden niet aangepast. Natuurlijk kan iedereen op <code>orchid</code> afdrukken op <code>bamboo</code>. Het kan zijn dat er sowieso alleen bepaalde gebruikers op <code>orchid</code> zijn toegestaan en dat deze gebruikers toegang mogen hebben tot de printer. Of wellicht niet.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er kan per printer slechts één groep worden opgegeven.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=printing-advanced-restricting-sizes>10.4.4.3. Grootte van afdrukopdrachten bepalen<a class=anchor href=#printing-advanced-restricting-sizes></a></h5><div class=paragraph><p>Als veel gebruikers toegang hebben tot printers kan het nodig zijn een limiet op te geven voor de grootte van de bestanden die gebruikers naar een printer kunnen sturen. Er is immers slechts beperkte ruimte op het bestandssysteem en er moet ook voldoende ruimte zijn voor opdrachten van andere gebruikers.</p></div><div class=paragraph><p>LPD heeft de mogelijkheid om met de optie <code>mx</code> een limiet op te geven voor het maximum aantal bytes van een bestand in een afdrukopdracht. De eenheden worden opgegeven in <code>BUFSIZ</code> blokken, die 1024 bytes groot zijn. Een nul voor deze optie betekent geen limiet aan de bestandsgrootte. Als de optie wordt weggelaten, wordt een standaardlimiet van 1000 blokken gebruikt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De limiet heeft betrekking op de <em>bestanden</em> in een opdracht, <em>niet</em> op de totale grootte van een opdracht.</p></div></td></tr></tbody></table></div><div class=paragraph><p>LPD weigert een bestand dat groter is dan de opgegeven limiet niet. In plaats daarvan plaatst het zo veel mogelijk van het bestand op de wachtrij, om dit vervolgens af te drukken. De rest wordt genegeerd. Of dit gedrag wenselijk is, is onderwerp van debat.</p></div><div class=paragraph><p>Nu worden limieten voor de voorbeeldprinters <code>rattan</code> en <code>bamboo</code> opgegeven. Aangezien de PostScript®-bestanden van die <code>artists</code> nogal groot kunnen worden, krijgen ze een limiet van vijf megabyte opgelegd. Er wordt geen limiet opgelegd voor de platte tekst printer:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host rose
#

#
#  Geen limiet op opdrachtgrootte:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:mx#0:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

#
#  Limiet van vijf megabyte:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:mx#5000:\
        :lp=/dev/ttyu5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Ook hier zijn de limieten alleen van toepassing op lokale gebruikers. Als toegang tot deze printers van andere hosts mogelijk is, worden deze gebruikers niet beperkt. Het is daarom nodig de optie <code>mx</code> ook in de <span class=filename>/etc/printcap</span> van de betreffende hosts op te geven. In <a href=#printing-advanced-network-rm>Printers geïnstalleerd op andere hosts</a> staat meer informatie over afdrukken op andere hosts.</p></div><div class=paragraph><p>Er is een andere gespecialiseerde manier om opdrachtgrootte voor printers op afstand te beperken (zie <a href=#printing-advanced-restricting-remote>Opdrachten van hosts op afstand beperken</a>.</p></div></div><div class=sect4><h5 id=printing-advanced-restricting-remote>10.4.4.4. Opdrachten van hosts op afstand beperken<a class=anchor href=#printing-advanced-restricting-remote></a></h5><div class=paragraph><p>Het wachtrijsysteem LPD beschikt over verschillende methoden om afdrukopdrachten van hosts op afstand te beperken:</p></div><div class=dlist><dl><dt class=hdlist1>Hostbeperkingen</dt><dd><p>Met de bestanden <span class=filename>/etc/hosts.equiv</span> en <span class=filename>/etc/hosts.lpd</span> kan worden ingesteld van welke hosts op afstand een lokale LPD-opdracht wordt geaccepteerd. LPD controleert of een inkomend verzoek afkomstig is van een host die wordt genoemd in een van deze bestanden. Zo niet, dan weigert LPD het verzoek.</p><div class=paragraph><p>Het formaat van deze bestanden is eenvoudig: één host per regel. <span class=filename>/etc/hosts.equiv</span> wordt ook gebruikt door het protocol <a href="https://man.freebsd.org/cgi/man.cgi?query=ruserok&amp;sektion=3&amp;format=html">ruserok(3)</a> en heeft invloed op programma’s als <a href="https://man.freebsd.org/cgi/man.cgi?query=rsh&amp;sektion=1&amp;format=html">rsh(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=rcp&amp;sektion=1&amp;format=html">rcp(1)</a>. Voorzichtigheid is dus geboden.</p></div><div class=paragraph><p>Als voorbeeld volgt hier <span class=filename>/etc/hosts.lpd</span> voor de host <code>rose</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>orchid
violet
madrigal.fishbaum.de</pre></div></div><div class=paragraph><p>Dit betekent dat <code>rose</code> verzoeken accepteert van de hosts <code>orchid</code>, <code>violet</code> en <code>madrigal.fishbaum.de</code>. Voor iedere andere host die verbinding probeert te maken met LPD op <code>rose</code>, wordt de opdracht geweigerd.</p></div></dd><dt class=hdlist1>Omvangbeperkingen</dt><dd><p>De hoeveelheid vrije ruimte die over moet blijven op een bestandssysteem waar een wachtrij zich bevindt kan ook worden ingesteld. Hiervoor moet een bestand met de naam <span class=filename>minfree</span> in de wachtrijmap worden aangemaakt. In dit bestand kan een getal worden gezet dat het aantal schijfblokken (512 bytes) aan vrije ruimte aangeeft dat beschikbaar moet blijven wil een opdracht worden geaccepteerd.</p><div class=paragraph><p>Hiermee kan worden gegarandeerd dat gebruikers op afstand een bestandssysteem niet vol kunnen schrijven. Ook kan hierdoor een soort voorrang worden gegeven aan lokale gebruikers: zij kunnen nog opdrachten plaatsen als de vrije schijfruimte al lang beneden de opgegeven limiet uit <span class=filename>minfree</span> is gekomen.</p></div><div class=paragraph><p>Als voorbeeld wordt een bestand <span class=filename>minfree</span> voor de printer <code>bamboo</code> toegevoegd. In <span class=filename>/etc/printcap</span> staat de juiste wachtrijmap:</p></div><div class="literalblock programlisting"><div class=content><pre>bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:mx#5000:\
        :lp=/dev/ttyu5:ms#-parenb cs8 clocal crtscts:rw:mx#5000:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>De wachtrijmap wordt opgegeven met de optie <code>sd</code>. Er wordt een limiet van drie megabyte ingesteld (wat gelijk staat aan 6144 schijfblokken) voor de hoeveelheid vrije schijfruimte die op het bestandssysteem beschikbaar moet zijn voordat LPD een opdracht op afstand accepteert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo 6144 &gt; /var/spool/lpd/bamboo/minfree</span></code></pre></div></div></dd><dt class=hdlist1>Gebruikersbeperkingen</dt><dd><p>Met de optie <code>rs</code> in <span class=filename>/etc/printcap</span> kan worden geregeld welke gebruikers op afstand kunnen afdrukken op lokale printers. Als <code>rs</code> voorkomt voor een lokale printer accepteert LPD opdrachten van hosts op afstand <em>als</em> de gebruiker die de opdracht wil plaatsen ook een account heeft met dezelfde gebruikersnaam op de lokale host. Anders weigert LPD de opdracht.</p><div class=paragraph><p>Deze optie is met name nuttig in een omgeving waar (bijvoorbeeld) verschillende afdelingen een netwerk delen en gebruikers de grenzen van de afdeling overschrijden. Door ze een account te geven op een systeem kunnen ze de aangesloten printers gebruiken vanaf het systeem van hun eigen afdeling. Wanneer ze <em>alleen</em> gebruik mogen maken van de printers en niet van overige diensten op de computer, kunnen "tokenaccounts" worden aangemaakt, zonder thuismap en met een nutteloze shell als <span class=filename>/usr/bin/false</span>.</p></div></dd></dl></div></div></div><div class=sect3><h4 id=printing-advanced-acct>10.4.5. Printergebruik administreren<a class=anchor href=#printing-advanced-acct></a></h4><div class=paragraph><p>Het kan nodig zijn om afdrukken te doorbelasten. Inkt en papier kosten geld en er zijn onderhoudskosten. Printers zitten vol met bewegende delen en hebben de neiging kapot te gaan. Nu is er gekeken naar de printers, het gebruikerspatroon en de onderhoudskosten en op basis hiervan is een prijs vastgesteld per pagina (of per centimeter, per meter, of per wat dan ook). Hoe wordt nu een administratie bijgehouden van gemaakte afdrukken?</p></div><div class=paragraph><p>Het slechte nieuws is dat het wachtrijsysteem LPD hierbij niet echt helpt. Het administreren van afdrukken is erg afhankelijk van het type printer, het afdrukformaat en de wensen die een systeembeheerder heeft ten aanzien van het doorbelasten van printergebruik.</p></div><div class=paragraph><p>Om het administreren te implementeren, is het nodig om aanpassingen te maken in de tekstfilter (om platte tekst opdrachten te belasten) en de conversiefilters (om opdrachten in andere bestandsformaten te belasten), om pagina’s te tellen, of de printer te vragen hoeveel pagina’s er zijn afgedrukt. Het volstaat niet om het eenvoudige uitvoerfilter te gebruiken, aangezien dit niet in staat is het gebruik te administreren. Zie <a href=#printing-advanced-filter-intro>Filters</a>.</p></div><div class=paragraph><p>In het algemeen zijn er twee manieren om gebruik te administreren:</p></div><div class=ulist><ul><li><p><em>Periodiek administreren</em> is de meer gebruikelijke manier, omdat het waarschijnlijk makkelijker is. Als iemand een opdracht afdrukt, schrijft het filter de gebruiker, host en het aantal pagina’s in een administratiebestand. Elke maand, semester, jaar, of een andere gewenste periode kunnen de administratiebestanden verzameld worden om het aantal afgedrukte pagina’s op te tellen en het gebruik in rekening te brengen. De logboekbestanden kunnen vervolgens geschoond worden, zodat met een schone lei de volgende periode begonnen kan worden.</p></li><li><p><em>Directe administratie</em> is minder gebruikelijk, waarschijnlijk omdat het moeilijker is. Met deze methode zorgen de filters ervoor dat gebruikers voor hun printergebruik worden afgerekend op het moment dat ze er gebruik van maken. Net als schijfquota is de administratie onmiddellijk. Hiermee wordt voorkomen dat gebruikers kunnen afdrukken wanneer ze over hun limiet zijn gegaan. Ook biedt dit de mogelijkheid voor gebruikers om hun afdrukquotum te controleren, of aan te passen. Deze methode vereist databasecode om gebruikers en hun quota bij te houden.</p></li></ul></div><div class=paragraph><p>Het wachtrijsysteem LPD ondersteunt beide methoden op eenvoudige wijze. Aangezien de filters (meestal) moeten worden aangeleverd, moet ook de code voor de administratie worden geleverd. Er is echter een voordeel: er is grote flexibiliteit in de administratiemethode. Zo kan bijvoorbeeld gekozen worden tussen periodieke of directe administratie. Er kan gekozen worden welke informatie opgeslagen wordt: gebruikersnamen, hostnamen, type opdracht, aantal afgedrukte pagina’s, hoe lang het afdrukken duurde, enzovoort. Dit alles kan worden gedaan door de filters aan te passen.</p></div><div class=sect4><h5 id=_kort_door_de_bocht_printeradministratie>10.4.5.1. Kort door de bocht printeradministratie<a class=anchor href=#_kort_door_de_bocht_printeradministratie></a></h5><div class=paragraph><p>FreeBSD wordt met twee programma’s geleverd waarmee periodieke administratie direct kan worden opgezet. Het zijn het tekstfilter <code>lpf</code>, beschreven in <a href=#printing-advanced-lpf>lpf: een tekstfilter</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a>, een programma dat posten uit administratiebestanden verzamelt en optelt.</p></div><div class=paragraph><p>Zoals beschreven in de sectie over filters (<a href=#printing-advanced-filters>Filters</a>), roept LPD de tekst- en conversiefilters aan met de naam van het administratiebestand als argument. De filters kunnen dit argument gebruiken om te bepalen in welk bestand de gegevens voor de administratie moeten worden weggeschreven. De naam van dit bestand is afkomstig van de optie <code>af</code> uit <span class=filename>/etc/printcap</span>. Als er geen absoluut pad wordt opgegeven, dan is de locatie relatief aan de wachtrijmap.</p></div><div class=paragraph><p>LPD start <code>lpf</code> met paginabreedte en -lengte argumenten (afkomstig uit de opties <code>pw</code> en <code>pl</code>). Het filter <code>lpf</code> gebruikt deze argumenten om te bepalen hoeveel papier er gebruikt zal worden. Nadat het bestand naar de printer is gestuurd, schrijft het een post in het administratiebestand. De posten zien er als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>2.00 rose:andy
3.00 rose:kelly
3.00 orchid:mary
5.00 orchid:mary
2.00 orchid:zhang</pre></div></div><div class=paragraph><p>Aangezien <code>lpf</code> geen ingebouwde logica voor bestandslocking kent, moet voor elke printer een apart administratiebestand gebruikt worden. Twee <code>lpf</code>s kunnen elkaars posten corrumperen als ze tegelijk in hetzelfde bestand schrijven. De optie <code>af=acct</code> in <span class=filename>/etc/printcap</span> biedt een makkelijke manier om er zeker van te zijn dat aparte bestanden worden gebruikt. Dan bevindt elk administratiebestand zich in de wachtrijmap van de betreffende printer en krijgt de naam <span class=filename>acct</span> krijgen</p></div><div class=paragraph><p>Wanneer het tijd is om met gebruikers af te rekenen voor hun afdrukken, kan het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> gedraaid worden. Ga naar de wachtrijmap van de printer waarvoor betaald moet worden en typ <code>pac</code>. Er verschijnt een dollar-centrische samenvatting zoals het volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  Login               pages/feet   runs    price
orchid:kelly                5.00    1   <span class=nv>$ </span> 0.10
orchid:mary                31.00    3   <span class=nv>$ </span> 0.62
orchid:zhang                9.00    1   <span class=nv>$ </span> 0.18
rose:andy                   2.00    1   <span class=nv>$ </span> 0.04
rose:kelly                177.00  104   <span class=nv>$ </span> 3.54
rose:mary                  87.00   32   <span class=nv>$ </span> 1.74
rose:root                  26.00   12   <span class=nv>$ </span> 0.52

total                     337.00  154   <span class=nv>$ </span> 6.74</code></pre></div></div><div class=paragraph><p>Dit zijn de argumenten die <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> verwacht:</p></div><div class=dlist><dl><dt class=hdlist1><code>-P <em>printer</em></code></dt><dd><p>De <em>printer</em> waarvoor een samenvatting moet worden gegenereerd. Deze optie werkt alleen als er een absoluut pad is gegeven in de optie <code>af</code> in <span class=filename>/etc/printcap</span>.</p></dd><dt class=hdlist1><code>-c</code></dt><dd><p>Sorteer de uitvoer op kosten, in plaats van alfabetisch op gebruikersnaam.</p></dd><dt class=hdlist1><code>-m</code></dt><dd><p>Negeer de hostnamen in het administratiebestand. Met deze optie is de gebruiker <code>smith</code> op host <code>alpha</code> dezelfde gebruiker als <code>smith</code> op host <code>gamma</code>. Zonder deze optie zijn het verschillende gebruikers.</p></dd><dt class=hdlist1><code>-p <em>prijs</em></code></dt><dd><p>Bereken de prijs met <em>prijs</em> dollar per pagina of per voet, in plaats van de prijs uit de optie <code>pc</code> in <span class=filename>/etc/printcap</span> of twee cent (de standaard). De <em>prijs</em> kan worden opgegeven als een decimaal getal.</p></dd><dt class=hdlist1><code>-r</code></dt><dd><p>Keer de sorteervolgorde om.</p></dd><dt class=hdlist1><code>-s</code></dt><dd><p>Maak een bestand met een samenvatting van de administratie en leeg het administratiebestand.</p></dd><dt class=hdlist1><em>namen…​</em></dt><dd><p>Druk de administratiegegevens alleen af voor gebruikersnamen <em>namen</em>.</p></dd></dl></div><div class=paragraph><p>In de standaard samenvatting die <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> genereert, is het aantal pagina’s te zien dat iedere gebruiker vanaf een bepaalde host heeft afgedrukt. Wanneer de hostnaam niet van belang is (bijvoorbeeld omdat gebruikers iedere host kunnen gebruiken), gebruik dan <code>pac -m</code> om de volgende samenvatting te genereren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  Login               pages/feet   runs    price
andy                        2.00    1   <span class=nv>$ </span> 0.04
kelly                     182.00  105   <span class=nv>$ </span> 3.64
mary                      118.00   35   <span class=nv>$ </span> 2.36
root                       26.00   12   <span class=nv>$ </span> 0.52
zhang                       9.00    1   <span class=nv>$ </span> 0.18

total                     337.00  154   <span class=nv>$ </span> 6.74</code></pre></div></div><div class=paragraph><p>Om het verschuldigde bedrag te berekenen gebruikt <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> de optie <code>pc</code> uit <span class=filename>/etc/printcap</span> (standaard aantal van 200 of 2 cent per pagina). Specificeer, in honderden centen, de prijs per pagina of per voet die berekent moet worden. Deze waarde kan worden aangepast door <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> aan te roepen met de optie <code>-p</code>. De eenheden van de optie <code>-p</code> zijn echter in dollars, niet in honderden centen. Bijvoorbeeld,</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pac -p1.50</span></code></pre></div></div><div class=paragraph><p>zorgt ervoor dat elke pagina 1,50 dollar kost. U kunt echt grote winsten maken met deze optie.</p></div><div class=paragraph><p>Tenslotte kan met <code>pac -s</code> de samenvatting worden opgeslagen in een bestand dat dezelfde naam krijgt als het administratiebestand van de printer, maar dan met <code>_sum</code> toegevoegd aan de naam. Vervolgens wordt het administratiebestand geleegd. Als <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> opnieuw wordt aangeroepen, herleest <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> het samenvattingsbestand om de startwaarden te bepalen en telt daar de informatie bij op van het standaard administratiebestand.</p></div></div><div class=sect4><h5 id=_hoe_kan_het_aantal_afgedrukte_paginas_worden_geteld>10.4.5.2. Hoe kan het aantal afgedrukte pagina’s worden geteld?<a class=anchor href=#_hoe_kan_het_aantal_afgedrukte_paginas_worden_geteld></a></h5><div class=paragraph><p>Om ook maar de minste nauwkeurigheid bij het administreren te verkrijgen, is het nodig te weten hoeveel papier een afdrukopdracht gebruikt. Dit is het centrale probleem van het bijhouden van printerstatistieken.</p></div><div class=paragraph><p>Voor opdrachten met platte tekst is het probleem niet zo moeilijk op te lossen: het aantal regels in een opdracht wordt geteld en vergeleken met het aantal regels per pagina dat door een printer wordt ondersteund. Hierbij moet niet worden vergeten dat backspaces in het bestand regels overschrijven en dat lange logische regels worden afgedrukt als meerdere fysieke regels.</p></div><div class=paragraph><p>Het tekstfilter <code>lpf</code> (geïntroduceerd in <a href=#printing-advanced-lpf>lpf: een tekstfilter</a>) houdt met deze zaken rekening bij het administreren. Als het nodig is een tekstfilter te schrijven dat ook het printergebruik moet bijhouden, dan is het nuttig de broncode van <code>lpf</code> te bestuderen.</p></div><div class=paragraph><p>Hoe worden andere bestandsformaten dan verwerkt?</p></div><div class=paragraph><p>Voor een DVI-naar-LaserJet, of DVI-naar-PostScript® conversie kan het filter de diagnostische uitvoer van <code>dvilj</code> of <code>dvips</code> bekijken om te bepalen hoeveel pagina’s er zijn geconverteerd. Voor andere formaten kan hetzelfde worden gedaan met behulp van de betreffende conversieprogramma’s.</p></div><div class=paragraph><p>Deze methoden hebben echter als nadeel dat een printer eventueel niet alle pagina’s ook daadwerkelijk afdrukt. Zo kan het papier vast komen te zitten, de toner opraken of de printer ontploffen, terwijl de gebruiker toch moet betalen.</p></div><div class=paragraph><p>Dus, wat kan hieraan worden gedaan?</p></div><div class=paragraph><p>Er is slechts één <em>betrouwbare</em> manier om <em>nauwkeurig</em> te administreren. Dat is met behulp van een printer die kan vertellen hoeveel papier er is gebruikt. Deze moet vervolgens worden aangesloten met een seriële lijn, of een netwerkverbinding. Bijna alle PostScript®-printers hebben deze mogelijkheid, andere modellen en merken mogelijk ook (bijvoorbeeld Imagen netwerklaserprinters). De filters dienen voor deze printers aangepast te worden om het papierverbruik na elke opdracht te achterhalen en de administratieve informatie <em>alleen</em> op deze waarde te baseren. Er is geen noodzaak om foutgevoelig regels te tellen of bestanden te analyseren.</p></div><div class=paragraph><p>Natuurlijk kan een beheerder ook vrijgevig zijn en alle afdrukken gratis maken.</p></div></div></div></div><div class=sect2><h3 id=printing-using>10.5. Printers gebruiken<a class=anchor href=#printing-using></a></h3><div class=paragraph><p>Hieronder wordt beschreven hoe printers die onder FreeBSD geïnstalleerd zijn gebruikt moeten worden. Nu volgt een overzicht van de commando’s op gebruikersniveau:</p></div><div class=dlist><dl><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a></dt><dd><p>Druk opdrachten af</p></dd><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a></dt><dd><p>Controleer printerwachtrijen</p></dd><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a></dt><dd><p>Verwijder opdrachten uit de wachtrij van een printer</p></dd></dl></div><div class=paragraph><p>Er is ook een administratief commando, <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a>, beschreven in <a href=#printing-lpc>Printers beheren</a>, dat gebruikt wordt om printers en hun wachtrijen in te stellen.</p></div><div class=paragraph><p>Alledrie de commando’s <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> accepteren een optie <code>-P<em>printernaam</em></code> om aan te geven op welke printer uit <span class=filename>/etc/printcap</span> een opdracht van toepassing is. Dit biedt de mogelijkheid opdrachten te versturen, verwijderen en controleren voor verschillende printers. Als <code>-P</code> niet wordt gebruikt, werken deze commando’s op de printer gedefinieerd in de omgevingsvariabele <code>PRINTER</code>. Tot slot, wanneer de omgevingsvariabele <code>PRINTER</code> niet is gedefinieerd, wordt standaard verwezen naar de printer met de naam <code>lp</code>.</p></div><div class=sect3><h4 id=printing-lpr>10.5.1. Opdrachten afdrukken<a class=anchor href=#printing-lpr></a></h4><div class=paragraph><p>Om bestanden af te drukken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr bestandsnaam ...</code></pre></div></div><div class=paragraph><p>Dit drukt elk van de opgegeven bestanden af op de standaard printer. Als geen bestanden worden opgegeven, drukt <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> de standaard invoer af. De volgende opdracht drukt bijvoorbeeld een paar belangrijke systeembestanden af:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr /etc/host.conf /etc/hosts.equiv</code></pre></div></div><div class=paragraph><p>Om een specifieke printer te selecteren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-P</span> printernaam bestandsnaam ...</code></pre></div></div><div class=paragraph><p>Dit voorbeeld drukt een lange opgave van de huidige map af op de printer <code>rattan</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>ls</span> <span class=nt>-l</span> | lpr <span class=nt>-P</span> rattan</code></pre></div></div><div class=paragraph><p>Omdat er geen bestanden worden meegegeven aan het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>, drukt <code>lpr</code> de gegevens af die het van de standaard invoer leest: de uitvoer van het commando <code>ls -l</code>.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> accepteert ook een breed scala aan opties om de vorm aan te passen, bestandsconversies toe te passen, meerdere kopieën af te drukken, enzovoort. Meer informatie staat in <a href=#printing-lpr-options>Afdrukopties</a>.</p></div></div><div class=sect3><h4 id=printing-lpq>10.5.2. Opdrachten controleren<a class=anchor href=#printing-lpq></a></h4><div class=paragraph><p>Als <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> wordt gebruikt om af te drukken, dan worden de gegevens die afdrukt moet worden in een pakketje samengevoegd dat een "afdrukopdracht" wordt genoemd en naar het wachtrijsysteem LPD gestuurd. Elke printer heeft een wachtrij met opdrachten van alle gebruikers. Een printer drukt deze opdrachten op volgorde van binnenkomst af.</p></div><div class=paragraph><p>De wachtrij voor de standaardprinter kan worden weergegeven met <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a>. Voor een specifieke printer moet de optie <code>-P</code> meegegeven worden. Het volgende commando toont de wachtrij van printer <code>bamboo</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpq <span class=nt>-P</span> bamboo</code></pre></div></div><div class=paragraph><p>Hieronder volgt een voorbeeld van de uitvoer van het commando <code>lpq</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>bamboo is ready and printing
Rank   Owner    Job  Files                              Total Size
active kelly    9    /etc/host.conf, /etc/hosts.equiv   88 bytes
2nd    kelly    10   <span class=o>(</span>standard input<span class=o>)</span>                   1635 bytes
3rd    mary     11   ...                                78519 bytes</code></pre></div></div><div class=paragraph><p>Dit laat drie opdrachten zien in de wachtrij voor <code>bamboo</code>. De eerste opdracht, gegeven door gebruiker <code>kelly</code>, heeft opdrachtnummer 9 gekregen. Elke opdracht voor een printer krijgt een uniek opdrachtnummer. Dit nummer kan in de meeste gevallen genegeerd worden, maar is nodig om een opdracht te annuleren. In <a href=#printing-lprm>Opdrachten verwijderen</a> staan meer details.</p></div><div class=paragraph><p>Opdrachtnummer negen bestaat uit twee bestanden; meerdere bestanden opgegeven naar <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>, worden als één enkele opdracht behandeld. Het is de actieve opdracht (<code>active</code> onder de kolom "Rank"), wat betekent dat de printer deze opdracht momenteel aan het afdrukken is. De tweede opdracht bestaat uit gegevens doorgegeven aan <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> als standaard invoer. De derde opdracht is afkomstig van gebruiker <code>mary</code>. Het is een veel grotere opdracht. De bestandsnaam van het bestand dat ze probeert af te drukken is te lang voor het overzicht, daarom toont <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> drie puntjes.</p></div><div class=paragraph><p>De allereerste regel uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> is ook handig: die vertelt wat de printer momenteel aan het doen is; dat wil zeggen, wat LPD denkt dat de printer aan het doen is.</p></div><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> ondersteunt ook een optie <code>-l</code> om een gedetailleerd, lang overzicht te geven. Hieronder volgt voorbeelduitvoer van <code>lpq -l</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>waiting <span class=k>for </span>bamboo to become ready <span class=o>(</span>offline ?<span class=o>)</span>
kelly: 1st				 <span class=o>[</span>job 009rose]
       /etc/host.conf                    73 bytes
       /etc/hosts.equiv                  15 bytes

kelly: 2nd				 <span class=o>[</span>job 010rose]
       <span class=o>(</span>standard input<span class=o>)</span>                  1635 bytes

mary: 3rd                                <span class=o>[</span>job 011rose]
      /home/orchid/mary/research/venus/alpha-regio/mapping 78519 bytes</code></pre></div></div></div><div class=sect3><h4 id=printing-lprm>10.5.3. Opdrachten verwijderen<a class=anchor href=#printing-lprm></a></h4><div class=paragraph><p>Een gebruiker die van gedachten verandert over een af te drukken opdracht, kan een opdracht uit een wachtrij halen met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a>. Vaak kan met <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> zelfs een actieve opdracht worden verwijderd, maar een deel of alles van de opdracht kan desondanks toch worden afgedrukt.</p></div><div class=paragraph><p>Om een opdracht van de standaardprinter te verwijderen dient eerst met <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> het opdrachtnummer gevonden te worden. Typ vervolgens:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lprm opdrachtnummer</code></pre></div></div><div class=paragraph><p>Om een opdracht van een specifieke printer te verwijderen, moet de optie <code>-P</code> worden toegevoegd. Het volgende commando verwijdert opdrachtnummer 10 uit de wachtrij van printer <code>bamboo</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lprm <span class=nt>-P</span> bamboo 10</code></pre></div></div><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> heeft een aantal snelkoppelingen:</p></div><div class=dlist><dl><dt class=hdlist1>lprm -</dt><dd><p>Verwijder alle opdrachten (voor de standaardprinter) van de huidige gebruiker.</p></dd><dt class=hdlist1>lprm <em>gebruiker</em></dt><dd><p>Verwijder alle opdrachten (voor de standaardprinter) die van <em>gebruiker</em> zijn. De supergebruiker kan opdrachten van andere gebruikers verwijderen. Andere gebruikers kunnen alleen hun eigen opdrachten verwijderen.</p></dd><dt class=hdlist1>lprm</dt><dd><p>Zonder een opdrachtnummer, gebruikersnaam of <code>-</code> op de opdrachtregel, verwijdert <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> de huidige actieve opdracht van de huidige gebruiker op de standaard printer. Alleen de supergebruiker kan iedere actieve opdracht verwijderen.</p></dd></dl></div><div class=paragraph><p>Gebruik de optie <code>-P</code> met bovenstaande snelkoppelingen om een specifieke printer in plaats van de standaard printer te selecteren. Het volgende voorbeeld verwijdert alle opdrachten van de huidige gebruiker uit de wachtrij van printer <code>rattan</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lprm <span class=nt>-P</span> rattan -</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als in een netwerkomgeving wordt gewerkt, staat <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> alleen toe opdrachten te verwijderen vanaf hosts waarvan de afdrukopdrachten zijn gegeven, ook als dezelfde printer vanaf andere hosts bereikbaar is. Het volgende voorbeeld demonstreert dit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-P</span> rattan mijnbestand
% rlogin orchid
% lpq <span class=nt>-P</span> rattan
Rank   Owner	  Job  Files                          Total Size
active seeyan	  12	...                           49123 bytes
2nd    kelly      13   myfile                         12 bytes
% lprm <span class=nt>-P</span> rattan 13
rose: Permission denied
% <span class=nb>logout</span>
% lprm <span class=nt>-P</span> rattan 13
dfA013rose dequeued
cfA013rose dequeued</code></pre></div></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=printing-lpr-options>10.5.4. Meer dan platte tekst: afdrukopties<a class=anchor href=#printing-lpr-options></a></h4><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> ondersteunt een aantal opties voor de opmaak van platte tekst, het converteren van grafische en andere bestandsformaten, het afdrukken van meerdere kopieën, afwikkeling van een opdracht en meer. In deze sectie worden die opties beschreven.</p></div><div class=sect4><h5 id=printing-lpr-options-format>10.5.4.1. Opties voor opmaak en conversie<a class=anchor href=#printing-lpr-options-format></a></h5><div class=paragraph><p>De volgende opties voor <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> zorgen voor de opmaak van de bestanden in de opdracht. Gebruik deze opties als de opdracht geen platte tekst bevat of als platte tekst opgemaakt dient te worden met behulp van <a href="https://man.freebsd.org/cgi/man.cgi?query=pr&amp;sektion=1&amp;format=html">pr(1)</a>.</p></div><div class=paragraph><p>Het volgende commando drukt bijvoorbeeld een DVI-bestand af (van het TeX typesettingsysteem) met de naam <span class=filename>visrapport.dvi</span> op de printer <code>bamboo</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-P</span> bamboo <span class=nt>-d</span> visrapport.dvi</code></pre></div></div><div class=paragraph><p>Deze opties zijn van toepassing op alle bestanden in de opdracht. Het is dus niet mogelijk om bijvoorbeeld DVI- en ditroff-bestanden in een opdracht samen te voegen. In plaats hiervan moeten deze bestanden als aparte opdrachten worden gegeven, elk met een andere conversie-optie.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Al deze opties, behalve <code>-p</code> en <code>-T</code>, vereisen dat er conversiefilters zijn geïnstalleerd voor een printer. De optie <code>-d</code> vereist bijvoorbeeld het DVI-conversiefilter. In <a href=#printing-advanced-convfilters>Conversiefilters</a> staan de details beschreven.</p></div></td></tr></tbody></table></div><div class=dlist><dl><dt class=hdlist1><code>-c</code></dt><dd><p>Afdrukken van cifplot-bestanden.</p></dd><dt class=hdlist1><code>-d</code></dt><dd><p>Afdrukken van DVI-bestanden.</p></dd><dt class=hdlist1><code>-f</code></dt><dd><p>Afdrukken van FORTRAN tekstbestanden.</p></dd><dt class=hdlist1><code>-g</code></dt><dd><p>Afdrukken van plotgegevens.</p></dd><dt class=hdlist1><code>-i <em>aantal</em></code></dt><dd><p>De uitvoer wordt <em>aantal</em> kolommen ingesprongen. Als <em>nummer</em> wordt weggelaten, wordt acht kolommen ingesprongen. Deze optie werkt alleen met bepaalde conversiefilters.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Plaats geen spatie tussen de <code>-i</code> en het nummer.</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1><code>-l</code></dt><dd><p>Drukt letterlijke tekstgegevens af, inclusief controlekarakters.</p></dd><dt class=hdlist1><code>-n</code></dt><dd><p>Afdrukken van ditroff (apparaatonafhankelijke troff) gegevens.</p></dd><dt class=hdlist1>-p</dt><dd><p>Opmaak van platte tekst met <a href="https://man.freebsd.org/cgi/man.cgi?query=pr&amp;sektion=1&amp;format=html">pr(1)</a> alvorens af te drukken. Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=pr&amp;sektion=1&amp;format=html">pr(1)</a> voor meer informatie.</p></dd><dt class=hdlist1><code>-T <em>titel</em></code></dt><dd><p>Gebruik <em>titel</em> op de <a href="https://man.freebsd.org/cgi/man.cgi?query=pr&amp;sektion=1&amp;format=html">pr(1)</a> koptekst in plaats van de bestandsnaam. Deze optie heeft alleen effect in combinatie met de optie <code>-p</code>.</p></dd><dt class=hdlist1><code>-t</code></dt><dd><p>Afdrukken van troffgegevens.</p></dd><dt class=hdlist1><code>-v</code></dt><dd><p>Afdrukken van rastergegevens.</p></dd></dl></div><div class=paragraph><p>In het volgende voorbeeld wordt een mooi opgemaakte versie van de handleiding <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> afgedrukt op de standaardprinter:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% zcat /usr/shared/man/man1/ls.1.gz | troff <span class=nt>-t</span> <span class=nt>-man</span> | lpr <span class=nt>-t</span></code></pre></div></div><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=zcat&amp;sektion=1&amp;format=html">zcat(1)</a> pakt de broncode van de <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> handleiding uit en geeft het door aan het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=troff&amp;sektion=1&amp;format=html">troff(1)</a>, dat de broncode opmaakt, er GNU troff van maakt en dit doorstuurt naar <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>, dat de opdracht naar de LPD wachtrij stuurt. Omdat de optie <code>-t</code> meegeven wordt aan <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>, converteert het wachtrijsysteem de GNU troff uitvoer naar een formaat dat de standaardprinter begrijpt als de opdracht wordt afgedrukt.</p></div></div><div class=sect4><h5 id=printing-lpr-options-job-handling>10.5.4.2. Opties voor opdrachtafhandeling<a class=anchor href=#printing-lpr-options-job-handling></a></h5><div class=paragraph><p>De volgende opties voor <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> geven LPD aan de opdracht speciaal te behandelen:</p></div><div class=dlist><dl><dt class=hdlist1>-# <em>kopieën</em></dt><dd><p>Produceer een aantal van <em>kopieën</em> kopieën van elk bestand in de opdracht, in plaats van één kopie. Een beheerder kan deze optie uitschakelen om slijtage van de printer te voorkomen en gebruik van een kopieerapparaat aan te moedigen. Zie <a href=#printing-advanced-restricting-copies>Meerdere kopieën beperken</a>.</p><div class=paragraph><p>Dit voorbeeld drukt drie kopieën af van <span class=filename>parser.c</span> gevolgd door drie kopieën van <span class=filename>parser.h</span> op de standaardprinter:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr -#3 parser.c parser.h</code></pre></div></div></dd><dt class=hdlist1>-m</dt><dd><p>Stuur een email na voltooiing van de afdrukopdracht. Met deze optie stuurt het LPD-systeem een email als een opdracht is afgehandeld. In dit bericht vertelt het of de opdracht succesvol is uitgevoerd of dat er een fout was met (vaak) de aard van de fout.</p></dd><dt class=hdlist1>-s</dt><dd><p>Kopieer de bestanden niet naar de wachtrijmap, maar maak in plaats hiervan een symbolische link.</p><div class=paragraph><p>Bij het afdrukken van een grote opdracht is het handig van deze optie gebruik te maken. Het spaart ruimte in de wachtrijmap (het kan zijn dat de opdracht de vrije ruimte verbruikt in het bestandssysteem waarin de wachtrijmap zich bevindt). Het bespaart ook tijd, omdat LPD niet elke byte van de opdracht naar de wachtrijmap hoeft te kopieëren.</p></div><div class=paragraph><p>Er is echter een nadeel: aangezien LPD het originele bestand nodig heeft, is het niet mogelijk dit te wijzigen, of te verwijderen totdat het is afgedrukt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Bij het afdrukken op een printer in een netwerk, moet LPD een bestand uiteindelijk toch kopieëren van een lokale host naar een netwerkhost. De optie <code>-s</code> bespaart dus ruimte in een lokale wachtrijmap, niet in die van een host in een netwerk. Het blijft echter nuttig.</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1>-r</dt><dd><p>Verwijder bestanden in een opdracht na ze naar een wachtrij gekopieerd te hebben of na ze te hebben afgedrukt als de optie <code>-s</code> is gebruikt. Wees voorzichtig met deze optie!</p></dd></dl></div></div><div class=sect4><h5 id=printing-lpr-options-misc>10.5.4.3. Voorbladopties<a class=anchor href=#printing-lpr-options-misc></a></h5><div class=paragraph><p>Deze opties voor <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> passen de tekst aan die gewoonlijk op het voorblad van een opdracht verschijnt. Deze opties hebben geen effect als het afdrukken van voorbladen wordt onderdrukt op een gebruikte printer. Zie <a href=#printing-advanced-header-pages>Voorbladen</a> voor meer informatie over het opzetten van voorbladen.</p></div><div class=dlist><dl><dt class=hdlist1>-C <em>tekst</em></dt><dd><p>Vervang de hostnaam op het voorblad door <em>tekst</em>. De hostnaam is gewoonlijk de naam van de host waarvan de opdracht is verstuurd.</p></dd><dt class=hdlist1>-J <em>tekst</em></dt><dd><p>Vervang de naam van de opdracht op het voorblad door <em>tekst</em>. De naam van de opdracht is standaard de naam van het eerste bestand in de opdracht of <span class=filename>stdin</span> als de standaard uitvoer wordt afgedrukt.</p></dd><dt class=hdlist1>-h</dt><dd><p>Druk geen voorblad af.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Bij sommige installaties kan het zijn dat deze optie geen effect heeft door de manier waarop de voorbladen worden gegenereerd. Zie <a href=#printing-advanced-header-pages>Voorbladen</a> voor de details.</p></div></td></tr></tbody></table></div></dd></dl></div></div></div><div class=sect3><h4 id=printing-lpc>10.5.5. Printers beheren<a class=anchor href=#printing-lpc></a></h4><div class=paragraph><p>De beheerder van de printers in een netwerk heeft deze moeten installeren, opzetten en testen. Met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> kan een beheerder op nog meer manieren communiceren met printers. Met <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> is het mogelijk om:</p></div><div class=ulist><ul><li><p>Printers te starten en te stoppen;</p></li><li><p>Wachtrijen aan en uit te zetten;</p></li><li><p>De volgorde van opdrachten in elke wachtrij aan te passen.</p></li></ul></div><div class=paragraph><p>Ten eerste een opmerking over terminologie: als een printer is <em>gestopt</em>, drukt die niets uit een wachtrij af. Gebruikers kunnen nog steeds opdrachten geven, maar opdrachten wachten in een wachtrij totdat de bijbehorende printer is <em>gestart</em> of als de wachtrij vrij is.</p></div><div class=paragraph><p>Als een wachtrij is <em>uitgeschakeld</em>, kan geen enkele gebruiker (behalve <code>root</code>) opdrachten naar een printer versturen. Een <em>ingeschakelde</em> wachtrij accepteert opdrachten. Een printer met een uitgeschakelde wachtrij kan worden <em>gestart</em> en drukt dan alle afdrukopdrachten in de wachtrij af tot deze leeg is.</p></div><div class=paragraph><p>In het algemeen is het nodig <code>root</code>-rechten te hebben om het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> te gebruiken. Gewone gebruikers kunnen het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> gebruiken om een printerstatus op te vragen en om een vastgelopen printer te herstarten.</p></div><div class=paragraph><p>Nu volgt een samenvatting van de <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> commando’s. De meeste commando’s accepteren een argument <em>printernaam</em>, om aan te geven op welke printer te werken. Om op alle printers te werken die in <span class=filename>/etc/printcap</span> genoemd worden, kan <code>all</code> worden gebruikt als <em>printernaam</em>.</p></div><div class=dlist><dl><dt class=hdlist1><code>abort printernaam</code></dt><dd><p>Annuleer de huidige opdracht en stop de printer. Gebruikers kunnen nog steeds opdrachten versturen als de wachtrij is ingeschakeld.</p></dd><dt class=hdlist1><code>clean printernaam</code></dt><dd><p>Verwijder oude bestanden uit de wachtrijmap van de betreffende printer. Het kan wel eens gebeuren dat de bestanden waaruit een opdracht bestaat niet juist worden verwijderd door LPD. Dit gebeurt bijvoorbeeld wanneer er fouten zijn opgetreden tijdens het afdrukken of tijdens grote administratieve activiteit. Dit commando vindt en verwijdert bestanden die niet in de wachtrijmap thuishoren.</p></dd><dt class=hdlist1><code>disable printernaam</code></dt><dd><p>Nieuwe opdrachten kunnen niet meer in de wachtrij worden geplaatst. Als de printer nog draait, drukt die de opdrachten die zich nog in de wachtrij bevinden af. De supergebruiker (<code>root</code>) kan altijd opdrachten versturen, ook naar een uitgeschakelde wachtrij.</p><div class=paragraph><p>Dit commando is handig bij het testen van een nieuwe printer of een filterinstallatie: schakel de wachtrij uit en verstuur als <code>root</code> opdrachten. Andere gebruikers kunnen geen opdrachten versturen totdat het testen is voltooid en de wachtrij weer is ingeschakeld met het commando <code>enable</code>.</p></div></dd><dt class=hdlist1><code>down printernaam boodschap</code></dt><dd><p>Schakel een printer uit. Equivalent aan <code>disable</code> gevolgd door <code>stop</code>. De <em>boodschap</em> verschijnt als de status van de printer als een gebruiker de wachtrij van de printer controleert met <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> of de status met <code>lpc status</code>.</p></dd><dt class=hdlist1><code>enable printernaam</code></dt><dd><p>Schakel de wachtrij van een printer in. Gebruikers kunnen opdrachten versturen, maar de printer drukt ze pas af als deze is gestart.</p></dd><dt class=hdlist1><code>help commandonaam</code></dt><dd><p>Geef hulp over het commando <em>commandonaam</em>. Zonder <em>commandonaam</em>, wordt een samenvatting van de beschikbare commando’s getoond.</p></dd><dt class=hdlist1><code>restart printernaam</code></dt><dd><p>Start de printer. Gewone gebruikers kunnen dit commando gebruiken als door een uitzonderlijke omstandigheid LPD hangt, maar ze kunnen een printer niet starten die gestopt is met een van de commando’s <code>stop</code> of <code>down</code>. Het commando <code>restart</code> is equivalent aan <code>abort</code> gevolgd door <code>start</code>.</p></dd><dt class=hdlist1><code>start printernaam</code></dt><dd><p>Start de printer. De printer drukt opdrachten in zijn wachtrij af.</p></dd><dt class=hdlist1><code>stop printernaam</code></dt><dd><p>Stop de printer. De printer maakt de huidige opdracht af en drukt opdrachten in de wachtrij niet af. Gebruikers kunnen nog steeds opdrachten versturen naar een ingeschakelde wachtrij, ook al is de printer gestopt.</p></dd><dt class=hdlist1><code>topq printernaam opdracht-of-gebruikersnaam</code></dt><dd><p>Herschik de wachtrij voor <em>printernaam</em> door de opdrachten met de opgegeven <em>opdracht</em> nummers of opdrachten van <em>gebruikersnaam</em> bovenaan de wachtrij te plaatsen. Voor dit commando is het niet mogelijk <code>all</code> te gebruiken als <em>printernaam</em>.</p></dd><dt class=hdlist1><code>up printernaam</code></dt><dd><p>Schakel een printer in. Het omgekeerde van het commando <code>down</code>. Equivalent aan <code>start</code> gevolgd door <code>enable</code>.</p></dd></dl></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> accepteert bovenstaande commando’s op de opdrachtregel. Als er geen commando’s worden gegeven, schakelt <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> over op een interactieve modus, waar opdrachten gegeven kunnen worden totdat het commando <code>exit</code>, <code>quit</code> of einde-van-bestand wordt gegeven.</p></div></div></div><div class=sect2><h3 id=printing-lpd-alternatives>10.6. Alternatieven voor het standaard wachtrijsysteem<a class=anchor href=#printing-lpd-alternatives></a></h3><div class=paragraph><p>Na het lezen van deze handleiding, heeft de lezer zo’n beetje alles gelezen wat er te leren valt over het wachtrijsysteem LPD zoals het te vinden is in FreeBSD. Er zijn veel tekortkomingen te onderkennen, wat vanzelf leidt tot de vraag: "Welke andere wachtrijsystemen zijn er beschikbaar (en werken onder FreeBSD)?"</p></div><div class=dlist><dl><dt class=hdlist1>LPRng</dt><dd><p>LPRng, dat "LPR: the Next Generation" betekent, is een compleet herschreven PLP. Patrick Powell en Justin Mason (de voornaamste beheerder van PLP) hebben samengewerkt om LPRng te maken. De thuispagina voor LPRng is <a href=http://www.lprng.org/>http://www.lprng.org/</a>.</p></dd><dt class=hdlist1>CUPS</dt><dd><p>CUPS, het Common UNIX Printing System, voorziet in een overzetbare printlaag voor UNIX®-achtige besturingssystemen. Het is ontwikkeld door Easy Software Product, om een standaard afdrukoplossing voor alle UNIX®-producenten en gebruikers te promoten.</p><div class=paragraph><p>CUPS gebruikt het Internet Printing Protocol (IPP) als basis voor het beheren van afdrukopdrachten en wachtrijen. De protocollen Line Printer Daemon (LPD), Server Message Block (SMB) en AppSocket (ook bekend als JetDirect) worden ook ondersteund met minder functionaliteit. CUPS biedt bladeren naar netwerkprinters en PostScript® Printer Description (PPD) gebaseerde afdrukopties om echt printen onder UNIX® te ondersteunen.</p></div><div class=paragraph><p>De thuispagina voor CUPS is <a href=http://www.cups.org/>http://www.cups.org/</a>.</p></div></dd><dt class=hdlist1>HPLIP</dt><dd><p>HPLIP, het HP Linux® Imaging and Printing systeem, is een suite van programma’s ontwikkeld door HP dat printen, scannen en faxen voor toepassingen van HP ondersteunt. Deze suite van programma’s maakt gebruikt van het printsysteem CUPS als een backend voor sommige van de printmogelijkheden.</p><div class=paragraph><p>De thuispagina voor HPLIP is <a href=http://hplipopensource.com/hplip-web/index.html>http://hplipopensource.com/hplip-web/index.html</a>.</p></div></dd></dl></div></div><div class=sect2><h3 id=printing-troubleshooting>10.7. Problemen oplossen<a class=anchor href=#printing-troubleshooting></a></h3><div class=paragraph><p>Na het uitvoeren van een simpele test met <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> is mogelijk een van onderstaande resultaten verkregen, in plaats van de juiste uitvoer:</p></div><div class=dlist><dl><dt class=hdlist1>Het werkte na enige tijd of er kwam geen volle pagina.</dt><dd><p>De printer drukte bovenstaande af, maar wachtte enige tijd zonder iets te doen. Het was zelfs nodig om een PRINT REMAINING, of FORM FEED-knop op te printer in te drukken om enig resultaat te krijgen.</p><div class=paragraph><p>Als dit het geval is, dan stond de printer waarschijnlijk te wachten of er nog meer gegevens van de opdracht zouden komen, alvorens iets af te drukken. Om dit probleem op te lossen, kan het tekstfilter worden aangepast zodat deze een FORM FEED-karakter (of wat er ook nodig is) naar de printer stuurt. Dit is meestal voldoende om een printer zover te krijgen om tekst af te drukken die zich nog in de interne buffer bevindt. Het is ook nuttig om er zeker van te zijn dat elke afdrukopdracht eindigt op een hele pagina, zodat de volgende opdracht niet ergens midden op de laatste pagina van de vorige opdracht begint.</p></div><div class=paragraph><p>De volgende vervanging voor het shellscript <span class=filename>/usr/local/libexec/if-simple</span> drukt een form feed af nadat de opdracht naar een printer is gestuurd:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# if-simple - Eenvoudige tekst invoerfilter voor lpd
# Geïinstalleerd in /usr/local/libexec/if-simple
#
# Kopieert eenvoudig stdin naar stdout.  Negeer alle filterargumenten.
# Schrijft een form feed karakter (\f) na het afdrukken van de opdracht.

/bin/cat &amp;&amp; printf &#34;\f&#34; &amp;&amp; exit 0
exit 2</pre></div></div></dd><dt class=hdlist1>De opdracht produceerde een getrapt effect.</dt><dd><p>Het resultaat ziet er als volgt uit:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>!</span><span class=s2>&#34;#</span><span class=nv>$%</span><span class=s2>&amp;&#39;()*+,-./01234
                &#34;</span><span class=c>#$%&amp;&#39;()*+,-./012345</span>
                                 <span class=c>#$%&amp;&#39;()*+,-./0123456</span></code></pre></div></div><div class=paragraph><p>Dit krijgen slachtoffers van het <em>trapeffect</em> te zien. Het wordt veroorzaakt door conflicterende interpretaties van de karakters die een regeleinde aangeven. UNIX®-achtige besturingssystemen gebruiken een enkel karakter: ASCII-code 10, de line feed (LF). MS-DOS®, OS/2® en andere besturingssystemen gebruiken twee karakters: ASCII-code 10 <em>en</em> ASCII-code 13 (de carriage return, CR). Veel printers gebruiken de MS-DOS®-conventie voor het representeren van regeleinden.</p></div><div class=paragraph><p>Als onder FreeBSD wordt afgedrukt, bevat de tekst alleen het line feed-karakter. Na het zien van een line feed-karakter vervolgt de printer zijn werk op de volgende regel, maar behoudt dezelfde horizontale positie op de pagina voor het afdrukken van het volgende teken. Hier is de carriage return voor bedoeld: om het volgende karakter af te drukken aan de linkerkant van de pagina.</p></div><div class=paragraph><p>Dit is wat FreeBSD wil dat de printer doet:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Printer ontvangt CR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Printer drukt CR af</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Printer ontvangt LF</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Printer drukt CR + LF af</p></td></tr></tbody></table><div class=paragraph><p>Hier volgen een aantal manieren om dit te bereiken:</p></div><div class=ulist><ul><li><p>Gebruik de instellingentoetsen of het bedieningspaneel van de printer om de interpretatie van deze karakters aan te passen. Controleer de handleiding van de printer om uit te vinden hoe dit moet.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als een systeem in een ander besturingssysteem dan FreeBSD wordt opgestart, kan het nodig zijn een printer <em>opnieuw</em> in te stellen, zodat die een interpretatie voor CR- en LF-karakters gebruikt die bij dat andere besturingssysteem horen. Het kan de voorkeur genieten een van onderstaande oplossingen te gebruiken.</p></div></td></tr></tbody></table></div></li><li><p>Zorg dat het seriële lijnstuurprogramma van FreeBSD automatisch LF naar CR+LF converteert. Dit werkt natuurlijk <em>alleen</em> voor printers op een seriële poort. Gebruik de optie <code>ms#</code> en zet de modus <code>onlcr</code> in het bestand <span class=filename>/etc/printcap</span> voor de printer om deze functionaliteit in te schakelen.</p></li><li><p>Stuur een <em>escape-code</em> naar een printer om tijdelijk LF-karakters anders te behandelen. Raadpleeg hiervoor de handleiding van de printer om escape-codes te achterhalen die de printer ondersteunt. Als de juiste escape-code is gevonden, moet de tekstfilter worden aangepast zodat deze eerst de code stuurt en vervolgens de afdrukopdracht.</p><div class=paragraph><p>Hier volgt een eenvoudig tekstfilter voor printers die HP PCL-escape-codes begrijpen. Dit filter zorgt dat een printer LF-karakters behandelt als LF en CR, vervolgens verstuurt het de opdracht en tot slot een form feed om de laatste pagina in de opdracht uit te voeren. Het zou met alle HP printers moeten werken.</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# hpif - Eenvoudig tekst invoerfilter voor lpd voor HP PCL-printers
# Geïnstalleerd in /usr/local/libexec/hpif
#
# Kopieert eenvoudig stdin naar stdout.  Negeert alle filterargumenten.
# Vertelt de printer om LF te zien als CR+LF.
# Werpt de pagina uit na voltooiing.

printf &#34;\033&amp;k2G&#34; &amp;&amp; cat &amp;&amp; printf &#34;\033&amp;l0H&#34; &amp;&amp; exit 0
exit 2</pre></div></div><div class=paragraph><p>Nu volgt een voorbeeldbestand <span class=filename>/etc/printcap</span> voor host <code>orchid</code>. Er is een printer aangesloten op de eerste parallelle poort; een HP LaserJet 3Si, genaamd <code>teak</code>. Die gebruikt bovenstaand script als tekstfilter:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap voor host orchid
#
teak|hp|laserjet|HP LaserJet 3Si:\
        :lp=/dev/lpt0:sh:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/hpif:</pre></div></div></li></ul></div></dd><dt class=hdlist1>De regels zijn over elkaar afgedrukt.</dt><dd><p>De printer is nooit een regel opgeschoven. Alle regels tekst lopen over elkaar en zijn op dezelfde regel afgedrukt.</p><div class=paragraph><p>Dit probleem is het "omgekeerde" van het trapeffect, zoals boven beschreven, en is veel zeldzamer. Ergens worden de LF-karakters die FreeBSD gebruikt om een regel te eindigen gezien als CR-karakters om de afdruklocatie te verplaatsen naar de linkerkant van het papier, zonder óók een regel naar beneden te gaan.</p></div><div class=paragraph><p>Gebruik de instellingentoetsen, of het bedieningspaneel van de printer om de volgende interpretatie van LF en CR af te dwingen:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Printer ontvangt</th><th class="tableblock halign-left valign-top">Printer drukt af</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>LF</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CR + LF</p></td></tr></tbody></table></dd><dt class=hdlist1>De printer is karakters kwijt.</dt><dd><p>Tijdens het afdrukken heeft de printer een paar karakters per regel niet afgedrukt. Het kan zijn dat het probleem erger werd naarmate de printer zijn werk deed, steeds meer karakters verliezend.</p><div class=paragraph><p>Het probleem is dat de printer de snelheid waarmee de computer gegevens over een seriële lijn stuurt niet bij kan houden (dit probleem zou zich niet voor moeten doen met printers op een parallelle poort). Er zijn twee manieren om dit probleem te verhelpen:</p></div><div class=ulist><ul><li><p>Als de printer XON/XOFF flow-control ondersteunt, zorg dan dat FreeBSD dit gebruikt door de modus <code>ixon</code> in de optie <code>ms#</code> te specificeren.</p></li><li><p>Als de printer de Request to Send / Clear to Send hardware-handshake ondersteunt, (ook bekend als <code>RTS/CTS</code>), specificeer dan de modus <code>crtscts</code> in de optie <code>ms#</code>. Zorg dat de bedrading van de kabel die printer met de computer verbindt juist is voor hardware flow-control.</p></li></ul></div></dd><dt class=hdlist1>Er werd onzin afgedrukt.</dt><dd><p>Het lijkt alsof de printer willekeurige onzin afdrukte en niet de gewenste tekst.</p><div class=paragraph><p>Dit is meestal een ander symptoom van verkeerde communicatieparameters voor een seriële printer. Controleer de bps-snelheid in de optie <code>br</code> en de instelling voor pariteit in de optie <code>ms#</code>. Wees er zeker van dat de printer dezelfde instellingen gebruikt als in het bestand <span class=filename>/etc/printcap</span> worden opgegeven.</p></div></dd><dt class=hdlist1>Er gebeurde niets.</dt><dd><p>Als er niets gebeurde, ligt het probleem waarschijnlijk bij FreeBSD en niet bij de hardware. Voeg de optie logboekbestand (<code>lf</code>) toe in <span class=filename>/etc/printcap</span> voor de betreffende printer. Hier is bijvoorbeeld de definitie voor <code>rattan</code> met de optie <code>lf</code>:</p><div class="literalblock programlisting"><div class=content><pre>rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:\
        :lf=/var/log/rattan.log</pre></div></div><div class=paragraph><p>Probeer vervolgens nogmaals af te drukken. Controleer het logboekbestand (in dit voorbeeld <span class=filename>/var/log/rattan.log</span>) op mogelijke foutmeldingen. Probeer op basis van deze melding het probleem te verhelpen.</p></div><div class=paragraph><p>Als er geen optie <code>lf</code> is opgegeven, gebruikt LPD <span class=filename>/dev/console</span> als standaard.</p></div></dd></dl></div></div></div></div><div class=sect1><h2 id=linuxemu>Hoofdstuk 11. Linux® binaire compatibiliteit<a class=anchor href=#linuxemu></a></h2><div class=sectionbody><div class=sect2><h3 id=linuxemu-synopsis>11.1. Overzicht<a class=anchor href=#linuxemu-synopsis></a></h3><div class=paragraph><p>FreeBSD levert binaire compatibiliteit met verscheidene andere UNIX® achtige besturingssystemen, waaronder Linux®. Op dit moment kan de vraag gesteld worden waarom FreeBSD nu precies Linux®-binairen moet kunnen draaien. Het antwoord is dat veel bedrijven en ontwikkelaars alleen ontwikkelen voor Linux®, omdat dat het nieuwste "hebbeding" is in de wereld van computers. Dat laat FreeBSD gebruikers al zeurend achter bij diezelfde bedrijven en ontwikkelaars om originele FreeBSD versies van hun applicaties. Het probleem is dat veel van deze bedrijven zich niet goed realiseren hoeveel mensen hun product zouden gebruiken als er ook FreeBSD versies van waren en de meesten blijven alleen voor Linux® ontwikkelen. Dus wat moet een FreeBSD gebruiker doen? Hier komt de Linux® binaire compatibiliteit van FreeBSD om de hoek kijken.</p></div><div class=paragraph><p>In een notendop stelt de compatibiliteit FreeBSD in staat om rond de 90% van alle Linux® applicaties zonder wijzigingen te draaien. Dit omvat applicaties zoals StarOffice™, de Linux® versie van <a href="https://man.freebsd.org/cgi/man.cgi?query=getenv&amp;sektion=3&amp;format=html">getenv(3)</a>, Adobe® Acrobat®, RealPlayer®, Oracle®, WordPerfect®, Doom, Quake en meer. Er wordt zelfs gemeld dat in sommige gevallen Linux®-binairen beter presteren op FreeBSD dan op Linux®.</p></div><div class=paragraph><p>Er zijn echter enkele Linux®-specifieke besturingssysteemeigenschappen die niet door FreeBSD ondersteund worden. Linux®-binairen werken niet op FreeBSD als ze overvloedig gebruik maken van i386™ specifieke aanroepen, zoals het aanzetten van de virtuele 8086 modus.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe Linux® binaire compatibiliteit op een systeem aan te zetten;</p></li><li><p>Hoe aanvullende Linux® gedeelde bibliotheken te installeren;</p></li><li><p>Hoe Linux® applicaties op een FreeBSD systeem te installeren;</p></li><li><p>De implementatiedetails van Linux® compatibiliteit in FreeBSD.</p></li></ul></div><div class=paragraph><p>Aangeraden voorkennis:</p></div><div class=ulist><ul><li><p>Hoe extra software van derden te installeren (<a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></li></ul></div></div><div class=sect2><h3 id=linuxemu-lbc-install>11.2. Installatie<a class=anchor href=#linuxemu-lbc-install></a></h3><div class=paragraph><p>Linux® binaire compatibiliteit staat standaard niet aan. De gemakkelijkste manier om deze functionaliteit aan te zetten is door het <code>linux</code> KLD object ("Kernel LoaDable object") te laden. Deze module kan geladen worden door het volgende commando als <code>root</code> uit te voeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload linux</span></code></pre></div></div><div class=paragraph><p>Als Linux® compatibiliteit altijd aan moet staan, dan moet de volgende regel aan <span class=filename>/etc/rc.conf</span> toegevoegd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>linux_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Met <a href="https://man.freebsd.org/cgi/man.cgi?query=kldstat&amp;sektion=8&amp;format=html">kldstat(8)</a> kan gecontroleerd worden of de KLD geladen is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kldstat
Id Refs Address    Size     Name
 1    2 0xc0100000 16bd8    kernel
 7    1 0xc24db000 d000     linux.ko</code></pre></div></div><div class=paragraph><p>Als het om enige reden ongewenst of onmogelijk is de KLD te laden, dan kan de Linux® binaire compatibiliteit statisch in de kernel gecompileerd worden door <code>options COMPAT_LINUX</code> aan het kernelinstellingenbestand toe te voegen. Daarna kan de nieuwe kernel zoals beschreven in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a> geïnstalleerd worden.</p></div><div class=sect3><h4 id=_linux_runtime_bibliotheken_installeren>11.2.1. Linux® runtime bibliotheken installeren<a class=anchor href=#_linux_runtime_bibliotheken_installeren></a></h4><div class=paragraph><p>Dit kan op twee manieren gedaan worden: door de <a href=#linuxemu-libs-port>linux_base</a> port te gebruiken of door ze <a href=#linuxemu-libs-manually>handmatig</a> te installeren.</p></div><div class=sect4><h5 id=linuxemu-libs-port>11.2.1.1. Installeren uit de linux_base port<a class=anchor href=#linuxemu-libs-port></a></h5><div class=paragraph><p>Dit is verreweg de gemakkelijkste weg om te bewandelen om de runtime bibliotheken te installeren. Het is net als het installeren van andere ports uit de <a href=./#ports>Portscollectie</a>. Dit kan met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/emulators/linux_base-f10</span>
<span class=c># make install distclean</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Op FreeBSD-systemen vóór FreeBSD 8.0 dient u de port <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base-fc4/>emulators/linux_base-fc4</a> in plaats van <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base-f10/>emulators/linux_base-f10</a> te gebruiken.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Nu is er werkende Linux® binaire compatibiliteit. Sommige programma’s kunnen klagen over onjuiste kleine versies van de systeembibliotheken. Over het algemeen schijnt dit echter geen probleem te zijn.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er kunnen verschillende versies van de <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base/>emulators/linux_base</a> port beschikbaar zijn, overeenkomend met verschillende versies van verscheidene Linux® distributies. Het is verstandig de port te installeren die het meest voldoet aan de eisen van de Linux® applicaties die geïnstalleerd gaan worden.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=linuxemu-libs-manually>11.2.1.2. Bibliotheken handmatig installeren<a class=anchor href=#linuxemu-libs-manually></a></h5><div class=paragraph><p>Als de Portscollectie niet is geïnstalleerd, kunnen de bibliotheken met de hand geïnstalleerd worden. Om alles te laten werken moeten de Linux® gedeelde bibliotheken waarvan het programma afhankelijk is en de runtime linker geïnstalleerd worden. Ook moet een "shadow root" map aangemaakt worden, <span class=filename>/compat/linux</span>, voor Linux® bibliotheken op een FreeBSD systeem. Elke gedeelde bibliotheek die wordt geopend door Linux® programma’s die op FreeBSD draaien, kijken eerst in deze boomstructuur. Dus als een Linux® programma bijvoorbeeld <span class=filename>/lib/libc.so</span> laadt, probeert FreeBSD eerst <span class=filename>/compat/linux/lib/libc.so</span> te openen, en als die niet bestaat, probeert het <span class=filename>/lib/libc.so</span> proberen. Gedeelde bibliotheken moeten in de schaduwmapstructuur geïnstalleerd worden in plaats van in de paden die het Linux® <code>ld.so</code> rapporteert.</p></div><div class=paragraph><p>In het algemeen geldt dat alleen de eerste paar keer dat een Linux® binary wordt geïnstalleerd op een FreeBSD systeem naar de gedeelde bibliotheken gezocht wordt waar Linux®-binairen van afhankelijk zijn. Na een tijd is de verzameling van Linux® gedeelde bibliotheken op een systeem voldoende groot om nieuw geïmporteerde Linux®-binairen te kunnen draaien zonder enig extra werk.</p></div></div><div class=sect4><h5 id=_extra_gedeelde_bibliotheken_installeren>11.2.1.3. Extra gedeelde bibliotheken installeren<a class=anchor href=#_extra_gedeelde_bibliotheken_installeren></a></h5><div class=paragraph><p>Wat als de <span class=filename>linux_base</span> port is geïnstalleerd en een applicatie nog steeds klaagt over ontbrekende gedeelde bibliotheken? Op zich zijn er twee mogelijkheden (voor het opvolgen van deze instructies zijn <code>root</code> rechten op een FreeBSD systeem vereist).</p></div><div class=paragraph><p>Als er toegang is tot een Linux® systeem kan gekeken worden welke gedeelde bibliotheken de applicatie nodig heeft en kunnen ze gekopieerd worden naar het FreeBSD systeem. Dit wordt toegelicht in het volgende voorbeeld:</p></div><div class=paragraph><p>Stel dat FTP gebruikt is om de Linux® binary van Doom op te halen en die op een Linux® systeem staat waar toegang tot is. Dan kan met <code>ldd linuxdoom</code> gecontroleerd worden welke gedeelde bibliotheken er nodig zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ldd linuxdoom
libXt.so.3 <span class=o>(</span>DLL Jump 3.1<span class=o>)</span> <span class=o>=&gt;</span> /usr/X11/lib/libXt.so.3.1.0
libX11.so.3 <span class=o>(</span>DLL Jump 3.1<span class=o>)</span> <span class=o>=&gt;</span> /usr/X11/lib/libX11.so.3.1.0
libc.so.4 <span class=o>(</span>DLL Jump 4.5pl26<span class=o>)</span> <span class=o>=&gt;</span> /lib/libc.so.4.6.29</code></pre></div></div><div class=paragraph><p>Alle bestanden uit de laatste kolom zijn nodig en moeten onder <span class=filename>/compat/linux</span> komen te staat en de namen uit de eerste kolom moeten er als symbolische links naar verwijzen. Dit betekent dat uiteindelijk deze bestanden op een FreeBSD systeem staan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/compat/linux/usr/X11/lib/libXt.so.3.1.0
/compat/linux/usr/X11/lib/libXt.so.3 -&gt; libXt.so.3.1.0
/compat/linux/usr/X11/lib/libX11.so.3.1.0
/compat/linux/usr/X11/lib/libX11.so.3 -&gt; libX11.so.3.1.0
/compat/linux/lib/libc.so.4.6.29
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.29</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als er al een Linux® gedeelde bibliotheek met een groot revisienummer overeenstemmend met de eerste kolom van de <code>ldd</code> uitvoer is, dan hoeft het bestand uit de laatste kolom niet naar een systeem gekopieerd te worden. Het bestand dat er al staat moet werken. Het is aan te raden om de gedeelde bibliotheek sowieso te kopiëren als het een nieuwere versie is. De oude kan verwijderd worden, zolang de symbolische link maar naar de nieuwe wijst. Dus als deze bibliotheken op een systeem staan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/compat/linux/lib/libc.so.4.6.27
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.27</code></pre></div></div><div class=paragraph><p>en een nieuwe binary zegt een latere versie nodig te hebben volgens de uitvoer van <code>ldd</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>libc.so.4 <span class=o>(</span>DLL Jump 4.5pl26<span class=o>)</span> -&gt; libc.so.4.6.29</code></pre></div></div><div class=paragraph><p>Als slechts één of twee versies verouderd zijn in het laatste cijfer, dan hoeft <span class=filename>/lib/libc.so.4.6.29</span> niet gekopieerd te worden, omdat het programma goed moet werken met de ietwat oudere versie. Als er echter behoefte aan is, kan besloten worden om <span class=filename>libc.so</span> sowieso te verplaatsen, en dat resulteert in:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/compat/linux/lib/libc.so.4.6.29
/compat/linux/libc.so.4 -&gt; lbic.so.4.6.29</code></pre></div></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het symbolische linkmechanisme is <em>alleen</em> nodig voor Linux®-binairen. De FreeBSD runtime linker zorgt zelf voor het kijken naar passende grote revisienummers en daar hoeft geen zorg over te bestaan.</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=_linux_elf_binairen_installeren>11.2.2. Linux® ELF-binairen installeren<a class=anchor href=#_linux_elf_binairen_installeren></a></h4><div class=paragraph><p>ELF-binairen hebben soms een extra stap van "branding" nodig. Als er ongemerkte ELF-binairen worden gedraaid, ontstaat er een foutmelding zoals de volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ./mijn-linux-elf-binary
ELF binary <span class=nb>type </span>not known
Abort</code></pre></div></div><div class=paragraph><p>Om de FreeBSD kernel te helpen FreeBSD ELF-binairen en Linux® binairen uit elkaar te houden, kan <a href="https://man.freebsd.org/cgi/man.cgi?query=brandelf&amp;sektion=1&amp;format=html">brandelf(1)</a> gebruikt worden.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% brandelf <span class=nt>-t</span> Linux mijn-linux-elf-binary</code></pre></div></div><div class=paragraph><p>De GNU gereedschapskist plaatst nu automatisch de juiste merkinformatie in ELF-binairen , dus deze stap zou steeds overbodiger moeten worden in de toekomst.</p></div></div><div class=sect3><h4 id=_een_willekeurige_toepassing_gebaseerd_op_linux_rpm_installeren>11.2.3. Een willekeurige toepassing gebaseerd op Linux RPM installeren<a class=anchor href=#_een_willekeurige_toepassing_gebaseerd_op_linux_rpm_installeren></a></h4><div class=paragraph><p>FreeBSD heeft zijn eigen pakketdatabase die wordt gebruikt om alle ports te volgen (ook Linux® ports). De Linux® RPM-database wordt dus niet gebruikt (noch ondersteund).</p></div><div class=paragraph><p>Als u echter een willekeurige toepassing die op Linux® RPM is gebaseerd moet installeren kan dit bereikt worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /compat/linux</span>
<span class=c># rpm2cpio -q &lt; /pad/naar/linux.archief.rpm | cpio -id</span></code></pre></div></div><div class=paragraph><p>Draai daarna brandelf op de geïnstalleerde ELF-binairen (niet de bibliotheken!). Een schone deïnstallatie is niet mogelijk, maar het kan helpen met testen.</p></div></div><div class=sect3><h4 id=_de_hostnaamresolver_instellen>11.2.4. De hostnaamresolver instellen<a class=anchor href=#_de_hostnaamresolver_instellen></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>resolv+: <span class=s2>&#34;bind&#34;</span> is an invalid keyword resolv+:
<span class=s2>&#34;hosts&#34;</span> is an invalid keyword</code></pre></div></div><div class=paragraph><p>Als DNS niet werkt of de bovenstaande melding ontstaat, dan moet <span class=filename>/compat/linux/etc/host.conf</span> ingesteld worden met daarin:</p></div><div class="literalblock programlisting"><div class=content><pre>order hosts, bind
multi on</pre></div></div><div class=paragraph><p>De volgorde geeft aan dat <span class=filename>/etc/hosts</span> als eerste doorzocht wordt en DNS als tweede. Als <span class=filename>/compat/linux/etc/host.conf</span> niet geïnstalleerd is, vinden Linux® applicaties <span class=filename>/etc/host.conf</span> van FreeBSD en klagen ze over de incompatibele FreeBSD syntaxis. <code>bind</code> moet verwijderd worden als er geen naamserver is ingesteld die gebruik maakt van <span class=filename>/etc/resolv.conf</span>.</p></div></div></div><div class=sect2><h3 id=linuxemu-mathematica>11.3. Mathematica® installeren<a class=anchor href=#linuxemu-mathematica></a></h3><div class=paragraph><p>Dit document beschrijft het installatieproces van de Linux® versie van Mathematica® 5.X op een FreeBSD systeem.</p></div><div class=paragraph><p>De Linux® versie van Mathematica® of Mathematica® for Students kan direct bij Wolfram besteld worden op <a href=http://www.wolfram.com/>http://www.wolfram.com/</a>.</p></div><div class=sect3><h4 id=_de_mathematica_installer_draaien>11.3.1. De Mathematica® Installer draaien<a class=anchor href=#_de_mathematica_installer_draaien></a></h4><div class=paragraph><p>Ten eerste dient FreeBSD te weten dat de Linux-binairen van Mathematica® de Linux ABI gebruiken. De gemakkelijkste manier om dit te doen is om het standaard ELF-merk op Linux te zetten voor alle ongemerkte binairen met het commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.fallback_elf_brand=3</span></code></pre></div></div><div class=paragraph><p>Dit laat FreeBSD aannemen dat alle ongemerkte ELF-binairen de Linux ABI gebruiken en dus zou de installer rechtstreeks van de CD-ROM moeten kunnen draaien.</p></div><div class=paragraph><p>Kopieer nu het bestand <span class=filename>MathInstaller</span> naar de harde schijf:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /cdrom</span>
<span class=c># cp /cdrom/Unix/Installers/Linux/MathInstaller /localdir/</span></code></pre></div></div><div class=paragraph><p>Vervang binnen dit bestand <code>/bin/sh</code> op de eerste regel door <code>/compat/linux/bin/sh</code>. Dit zorgt ervoor dat de installer door de Linux-versie van <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a> wordt uitgevoerd. Vervang vervolgens met een tekstverwerker of het onderstaande script in de volgende sectie alle voorkomens van <code>Linux)</code> door <code>FreeBSD)</code>. Dit zorgt ervoor dat de Mathematica® installer, dat <code>uname -s</code> gebruikt om het besturingssysteem te bepalen, om FreeBSD als een Linux-achtig besturingssysteem te behandelen. Het aanroepen van <code>MathInstaller</code> zal nu Mathematica® installeren.</p></div></div><div class=sect3><h4 id=_de_mathematica_executables_wijzigen>11.3.2. De Mathematica®-executables wijzigen<a class=anchor href=#_de_mathematica_executables_wijzigen></a></h4><div class=paragraph><p>De shellscripts die Mathematica® aanmaakte tijdens de installatie moeten gewijzigd worden voordat u ze kunt gebruiken. Als u <span class=filename>/usr/local/bin</span> kiest als de map om Mathematica®-executables in te plaatsen, zult u in deze map symbolische links naar bestanden genaamd <span class=filename>math</span>, <span class=filename>mathematica</span>, <span class=filename>Mathematica</span>, en <span class=filename>MathKernel</span> aantreffen. Vervang met een tekstverwerker of het volgende shellscript in elk van deze <code>Linux)</code> door <code>FreeBSD</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
cd /usr/local/bin
for i in math mathematica Mathematica MathKernel
  do sed &#39;s/Linux)/FreeBSD)/g&#39; $i &gt; $i.tmp
  sed &#39;s/\/bin\/sh/\/compat\/linux\/bin\/sh/g&#39; $i.tmp &gt; $i
  rm $i.tmp
  chmod a+x $i
done</pre></div></div></div><div class=sect3><h4 id=_mathematica_wachtwoord_opvragen>11.3.3. Mathematica® wachtwoord opvragen<a class=anchor href=#_mathematica_wachtwoord_opvragen></a></h4><div class=paragraph><p>Wanneer u Mathematica® voor de eerste keer start, zal u om een wachtwoord gevraagd worden. Als u nog geen wachtwoord van Wolfram heeft verkregen, draait u het programma <code>mathinfo</code> in de installatiemap om uw "machine-ID" te verkrijgen. Dit machine-ID is alleen op het MAC-adres van uw eerste Ethernetkaart gebaseerd, zodat u uw kopie van Mathematica® niet op andere machines kunt draaien.</p></div><div class=paragraph><p>Bij een registratie bij Wolfram, per email, telefoon of fax, wordt het "machine ID" opgegeven en zij reageren met een overeenkomstig wachtwoord dat uit groepen getallen bestaat.</p></div></div><div class=sect3><h4 id=_het_mathematica_frontend_over_een_netwerk_draaien>11.3.4. Het Mathematica® frontend over een netwerk draaien<a class=anchor href=#_het_mathematica_frontend_over_een_netwerk_draaien></a></h4><div class=paragraph><p>Mathematica® gebruikt enkele speciale lettertypen om tekens af te beelden die niet aanwezig zijn in een standaard lettertypeverzameling (integralen, sommen, Griekse letters, enzovoort). Het X-protocol vereist dat deze lettertypen <em>lokaal</em> worden geïnstalleerd. Dit betekent dat deze lettertypen gekopieerd moeten worden vanaf de CD-ROM of vanaf een host met Mathematica® erop naar de lokale machine. Deze lettertypen worden meestal opgeslagen in <span class=filename>/cdrom/Unix/Files/SystemFiles/Fonts</span> op de CD-ROM of in <span class=filename>/usr/local/mathematica/SystemFiles/Fonts</span> op de harde schijf. De eigenlijke lettertypen staan in de submap <span class=filename>Type1</span> en <span class=filename>X</span>. Er zijn verschillende manieren om ze te installeren, zoals hieronder staat beschreven.</p></div><div class=paragraph><p>De eerste manier is om ze te kopiëren in één van de bestaande lettertypenmappen in <span class=filename>/usr/X11R6/lib/X11/fonts</span>. Hiertoe dient <span class=filename>fonts.dir</span> bewerkt te worden door de namen van de lettertypen eraan toe te voegen het aantal lettertypen op de eerste regel te veranderen. Als alternatief kan ook eenvoudig <a href="https://man.freebsd.org/cgi/man.cgi?query=mkfontdir&amp;sektion=1&amp;format=html">mkfontdir(1)</a> in de map gedraaid worden waar de lettertypen heen zijn gekopieerd.</p></div><div class=paragraph><p>De tweede manier om dit te doen is door de mappen naar <span class=filename>/usr/X11R6/lib/X11/fonts</span> te kopiëren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/X11R6/lib/X11/fonts</span>
<span class=c># mkdir X</span>
<span class=c># mkdir MathType1</span>
<span class=c># cd /cdrom/Unix/Files/SystemFiles/Fonts</span>
<span class=c># cp X/* /usr/X11R6/lib/X11/fonts/X</span>
<span class=c># cp Type1/* /usr/X11R6/lib/X11/fonts/MathType1</span>
<span class=c># cd /usr/X11R6/lib/X11/fonts/X</span>
<span class=c># mkfontdir</span>
<span class=c># cd ../MathType1</span>
<span class=c># mkfontdir</span></code></pre></div></div><div class=paragraph><p>Voeg nu de nieuwe lettertypenmappen toe aan het lettertypenpad:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># xset fp+ /usr/X11R6/lib/X11/fonts/X</span>
<span class=c># xset fp+ /usr/X11R6/lib/X11/fonts/MathType1</span>
<span class=c># xset fp rehash</span></code></pre></div></div><div class=paragraph><p>Als de Xorg server gebruikt wordt, kunnen deze lettertypenmappen automatisch geladen worden door ze aan <span class=filename>xorg.conf</span> toe te voegen.</p></div><div class=paragraph><p>Als er nog <em>geen</em> map <span class=filename>/usr/X11R6/lib/X11/fonts/Type1</span> bestaat, kan de naam van de map <span class=filename>MathType1</span> in het bovenstaande voorbeeld veranderd worden naar <span class=filename>Type1</span>.</p></div></div></div><div class=sect2><h3 id=linuxemu-maple>11.4. Maple™ installeren<a class=anchor href=#linuxemu-maple></a></h3><div class=paragraph><p>Maple™ is een commercieel wiskundeprogramma vergelijkbaar met Mathematica®. De software is te koop op <a href=http://www.maplesoft.com/>http://www.maplesoft.com/</a> en kan daar ook geregistreerd worden voor een licentiebestand. Om deze software op FreeBSD te installeren kunnen de volgende eenvoudige stappen gevolgd worden:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Voer het <span class=filename>INSTALL></span> shellscript uit van de productdistributie. Kies de "RedHat" optie als daarom wordt gevraagd door het installatieprogramma. Een typische installatiemap zou <span class=filename>/usr/local/maple</span> zijn.</p></li><li><p>Bestel, als dat nog niet gedaan is, een licentie voor Maple™ van Maple Waterloo Software (<a href=http://register.maplesoft.com/>http://register.maplesoft.com/</a>) en kopieer deze naar <span class=filename>/usr/local/maple/license/license.dat</span>.</p></li><li><p>Installeer de FLEXlm licentiebeheerder met het installatieshellscript <span class=filename>INSTALL_LIC</span>, dat geleverd wordt bij Maple™. Stel de primaire hostnaam voor de machine in voor de licentieserver.</p></li><li><p>Patch het bestand <span class=filename>/usr/local/maple/bin/maple.system.type</span> met het volgende:</p><div class="literalblock programlisting"><div class=content><pre>   ----- knip ------------------
*** maple.system.type.orig      Sun Jul  8 16:35:33 2001
--- maple.system.type   Sun Jul  8 16:35:51 2001
***************
*** 72,77 ****
--- 72,78 ----
          # the IBM RS/6000 AIX case
          MAPLE_BIN=&#34;bin.IBM_RISC_UNIX&#34;
          ;;
+     &#34;FreeBSD&#34;|\
      &#34;Linux&#34;)
          # the Linux/x86 case
        # We have two Linux implementations, one for Red Hat and
   ----- knip einde van patch -----</pre></div></div><div class=paragraph><p>Achter <code>"FreeBSD"|</code> mogen geen verdere witvelden staan.</p></div><div class=paragraph><p>Deze patch instrueert Maple™ om "FreeBSD" als een Linux® systeem te herkennen. Het shellscript <span class=filename>bin/maple</span> roept het shellscript <span class=filename>bin/maple.system.type</span> aan, dat op zijn beurt <code>uname -a</code> aanroept om achter de naam van het besturingssysteem te komen. Afhankelijk van de naam van het besturingssysteem zoekt het uit welke binairen het moet gebruiken.</p></div></li><li><p>Start de licentieserver.</p><div class=paragraph><p>Het volgende script, geïnstalleerd als <span class=filename>/usr/local/etc/rc.d/lmgrd</span>, is een gemakkelijke manier om <code>lmgrd</code> op te starten:</p></div><div class="literalblock programlisting"><div class=content><pre>   ----- knip ------------

#! /bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/X11R6/bin
PATH=${PATH}:/usr/local/maple/bin:/usr/local/maple/FLEXlm/UNIX/LINUX
export PATH

LICENSE_FILE=/usr/local/maple/license/license.dat
LOG=/var/log/lmgrd.log

case &#34;$1&#34; in
start)
	lmgrd -c ${LICENSE_FILE} 2&gt;&gt; ${LOG} 1&gt;&amp;2
	echo -n &#34; lmgrd&#34;
	;;
stop)
	lmgrd -c ${LICENSE_FILE} -x lmdown 2&gt;&gt; ${LOG} 1&gt;&amp;2
	;;
*)
	echo &#34;Usage: `basename $0` {start|stop}&#34; 1&gt;&amp;2
	exit 64
	;;
esac

exit 0
   ----- knip ------------</pre></div></div></li><li><p>Maple™ testen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cd</span> /usr/local/maple/bin
% ./xmaple</code></pre></div></div><div class=paragraph><p>Nu hoort het programma te draaien. Het is belangrijk om Maplesoft te schrijven om ze te laten weten dat een echte FreeBSD versie gewenst is!</p></div></li></ol></div></div></div><div class=sect3><h4 id=_gemeenschappelijke_verborgen_gevaren>11.4.1. Gemeenschappelijke verborgen gevaren<a class=anchor href=#_gemeenschappelijke_verborgen_gevaren></a></h4><div class=ulist><ul><li><p>De FLEXlm licentiebeheerder kan een lastig programma zijn om mee te werken. Aanvullende documentatie staat op <a href=http://www.globetrotter.com/>http://www.globetrotter.com/</a>.</p></li><li><p><code>lmgrd</code> staat er bekend om erg kieskeurig over het licentiebestand te zijn en core te dumpen als er een probleem is. Een correct licentiebestand ziet er zo uit:</p><div class="literalblock programlisting"><div class=content><pre># =======================================================
# License File for UNIX Installations (&#34;Pointer File&#34;)
# =======================================================
SERVER chillig ANY
#USE_SERVER
VENDOR maplelmg

FEATURE Maple maplelmg 2000.0831 permanent 1 XXXXXXXXXXXX \
         PLATFORMS=i86_r ISSUER=&#34;Waterloo Maple Inc.&#34; \
         ISSUED=11-may-2000 NOTICE=&#34; Technische Universitat Wien&#34; \
         SN=XXXXXXXXX</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het serienummer en de sleutel zijn vervangen door "X"'en. <code>chillig</code> is de hostnaam.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het bewerken van het licentiebestand lukt zolang de regel "FEATURE" niet verandert (die beschermd is door de licentiesleutel).</p></div></li></ul></div></div></div><div class=sect2><h3 id=linuxemu-matlab>11.5. MATLAB® installeren<a class=anchor href=#linuxemu-matlab></a></h3><div class=paragraph><p>Dit document beschrijft het installatieproces van de Linux® versie van MATLAB® 6.5 op een FreeBSD systeem. Het werkt best goed, met uitzondering van de Java Virtual Machine™ (zie <a href=#matlab-jre>De Java™ runtime-omgeving linken</a>).</p></div><div class=paragraph><p>De Linux® versie van MATLAB® kan besteld worden bij The MathWorks op <a href=http://www.mathworks.com>http://www.mathworks.com</a>. Er dient ook een licentiebestand of instructies hoe dat te maken te zijn. Het is belangrijk om Maplesoft te schrijven om ze te laten weten dat een echte FreeBSD versie gewenst is!</p></div><div class=sect3><h4 id=_matlab_installeren>11.5.1. MATLAB® installeren<a class=anchor href=#_matlab_installeren></a></h4><div class=paragraph><p>Om MATLAB® te installeren:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Laad de installatie-CD-ROM en koppel die aan. Start het installatiescript als <code>root</code>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /compat/linux/bin/sh /cdrom/install</span></code></pre></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Het is een grafisch installatieprogramma. Als er foutmeldingen verschijnen dat het programma geen scherm kan openen, kan <code>setenv HOME ~GEBRUIKER</code> uitgevoerd worden, waar <em>GEBRUIKER</em> de gebruiker is waarmee <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> is gedaan.</p></div></td></tr></tbody></table></div></li><li><p>Als om de MATLAB® rootmap wordt gevraagd, dient <code>/compat/linux/usr/local/matlab</code> opgegeven te worden.</p><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Voer op de commandoregel het volgende uit om de rest van het installatieproces gemakkelijk te houden: <code>set MATLAB=/compat/linux/usr/local/matlab</code>.</p></div></td></tr></tbody></table></div></li><li><p>Wijzig het licentiebestand zoals aangegeven tijdens het verkrijgen van de licentie voor MATLAB®.</p><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Dit bestand kan van tevoren gemaakt worden met een tekstverwerker en door het te kopiëren naar <span class=filename>$MATLAB/license.dat</span> voordat het installatieprogramma vraagt om het te bewerken.</p></div></td></tr></tbody></table></div></li><li><p>Maak het installatieproces af.</p></li></ol></div></div></div><div class=paragraph><p>Nu is de installatie van MATLAB® compleet. De volgende stappen "lijmen" het aan het FreeBSD systeem.</p></div></div><div class=sect3><h4 id=_licentiebeheerder_starten>11.5.2. Licentiebeheerder starten<a class=anchor href=#_licentiebeheerder_starten></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Maak symbolische links voor de scriptbestanden van de licentiebeheerder:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s $MATLAB/etc/lmboot /usr/local/etc/lmboot_TMW</span>
<span class=c># ln -s $MATLAB/etc/lmdown /usr/local/etc/lmdown_TMW</span></code></pre></div></div></li><li><p>Maak een opstartbestand in <span class=filename>/usr/local/etc/rc.d/flexlm</span>. Onderstaand voorbeeld is een gewijzigde versie van het meegeleverde <span class=filename>$MATLAB/etc/rc.lm.glnx86</span>. De wijzigingen omvatten bestandslocaties en het starten van de licentiebeheerder onder Linux®-emulatie.</p><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
case &#34;$1&#34; in
  start)
        if [ -f /usr/local/etc/lmboot_TMW ]; then
              /compat/linux/bin/sh /usr/local/etc/lmboot_TMW -u gebruikersnaam &amp;&amp; echo &#39;MATLAB_lmgrd&#39;
        fi
        ;;
  stop)
	if [ -f /usr/local/etc/lmdown_TMW ]; then
            /compat/linux/bin/sh /usr/local/etc/lmdown_TMW  &gt; /dev/null 2&gt;&amp;1
	fi
        ;;
  *)
	echo &#34;Usage: $0 {start|stop}&#34;
	exit 1
	;;
esac

exit 0</pre></div></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Het bestand moet uitvoerbaar zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod +x /usr/local/etc/rc.d/flexlm</span></code></pre></div></div><div class=paragraph><p>Ook moet bovenstaande <em>gebruikersnaam</em> vervangen worden door een geldige gebruikersnaam op het systeem (maar niet door <code>root</code>).</p></div></td></tr></tbody></table></div></li><li><p>Start de licentiebeheerder op met het commando:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service flexlm start</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=matlab-jre>11.5.3. De Java™ runtime-omgeving linken<a class=anchor href=#matlab-jre></a></h4><div class=paragraph><p>Verander de Java™ Runtime Environment Link naar een die werkt op FreeBSD:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd $MATLAB/sys/java/jre/glnx86</span>
<span class=c># unlink jre; ln -s ./jre1.1.8 ./jre</span></code></pre></div></div></div><div class=sect3><h4 id=_matlab_opstartscript_maken>11.5.4. MATLAB® opstartscript maken<a class=anchor href=#_matlab_opstartscript_maken></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Plaats het volgende startscript in <span class=filename>/usr/local/bin/matlab</span>:</p><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
/compat/linux/bin/sh /compat/linux/usr/local/matlab/bin/matlab &#34;$@&#34;</pre></div></div></li><li><p>Geef vervolgens het commando <code>chmod +x /usr/local/bin/matlab</code>.</p></li></ol></div></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Afhankelijk van de versie van <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base/>emulators/linux_base</a>, kunnen er fouten optreden als dit script draait. Om dat te voorkomen, dient in <span class=filename>/compat/linux/usr/local/matlab/bin/matlab</span> de regel:</p></div><div class="literalblock programlisting"><div class=content><pre>if [ `expr &#34;$lscmd&#34; : &#39;.*-&gt;.*&#39;` -ne 0 ]; then</pre></div></div><div class=paragraph><p>(in versie 13.0.1 staat dit op regel 410) veranderd te worden in:</p></div><div class="literalblock programlisting"><div class=content><pre>if test -L $newbase; then</pre></div></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_matlab_afsluitscript_maken>11.5.5. MATLAB® afsluitscript maken<a class=anchor href=#_matlab_afsluitscript_maken></a></h4><div class=paragraph><p>Het volgende is nodig om een probleem op te lossen dat samenhangt met het onjuist afsluiten van MATLAB®.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Maak het bestand <span class=filename>$MATLAB/toolbox/local/finish.m</span> dat alleen de volgende regel bevat:</p><div class="literalblock programlisting"><div class=content><pre>! $MATLAB/bin/finish.sh</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>$MATLAB$</code> is hier letterlijk bedoeld.</p></div></td></tr></tbody></table></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>In dezelfde map staan de bestanden <span class=filename>finishsav.m</span> en <span class=filename>finishdlg.m</span>, die de mogelijkheid geven om de werkomgeving te bewaren vóór het afsluiten. Als één van deze scripts gebruikt wordt, dient de bovenstaande regel direct na het commando <code>save</code> ingevoegd te worden.</p></div></td></tr></tbody></table></div></li><li><p>Maak het bestand <span class=filename>$MATLAB/bin/finish.sh</span>, dat het volgende bevat:</p><div class="literalblock programlisting"><div class=content><pre>#!/compat/linux/bin/sh
(sleep 5; killall -1 matlab_helper) &amp;
exit 0</pre></div></div></li><li><p>Maak het bestand uitvoerbaar:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod +x $MATLAB/bin/finish.sh</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=matlab-using>11.5.6. MATLAB® gebruiken<a class=anchor href=#matlab-using></a></h4><div class=paragraph><p>Nu kan met <code>matlab</code> het programma gestart worden.</p></div></div></div><div class=sect2><h3 id=linuxemu-oracle>11.6. Oracle® installeren<a class=anchor href=#linuxemu-oracle></a></h3><div class=sect3><h4 id=_voorwoord>11.6.1. Voorwoord<a class=anchor href=#_voorwoord></a></h4><div class=paragraph><p>Hieronder wordt het installatieproces van Oracle® 8.0.5 en Oracle® 8.0.5.1 Enterprise Edition voor Linux® op een FreeBSD-machine beschreven.</p></div></div><div class=sect3><h4 id=_de_linux_omgeving_installeren>11.6.2. De Linux®-omgeving installeren<a class=anchor href=#_de_linux_omgeving_installeren></a></h4><div class=paragraph><p>Uit de Portscollectie dienen <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base/>emulators/linux_base</a> en <a class=package href=https://cgit.freebsd.org/ports/tree/devel/linux_devtools/>devel/linux_devtools</a> geïnstalleerd te zijn. Als er problemen zijn met deze ports, kan het zijn dat de pakketten of oudere versies uit de Portscollectie gebruikt moeten worden.</p></div><div class=paragraph><p>Om de intelligente agent te draaien, moet ook het Red Hat Tcl package geïnstalleerd worden: <span class=filename>tcl-8.0.3-20.i386.rpm</span>. Het algemene commando om pakketten te installeren met de officiële RPM port (<a class=package href=https://cgit.freebsd.org/ports/tree/archivers/rpm/>archivers/rpm</a>) is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rpm -i --ignoreos --root /compat/linux --dbpath /var/lib/rpm package</span></code></pre></div></div><div class=paragraph><p>De installatie van het <em>package</em> hoort foutloos te verlopen.</p></div></div><div class=sect3><h4 id=_de_oracle_omgeving_creëren>11.6.3. De Oracle®-omgeving creëren<a class=anchor href=#_de_oracle_omgeving_creëren></a></h4><div class=paragraph><p>Voordat Oracle® geïnstalleerd kan worden, moet een juiste omgeving opgezet worden. Dit document beschrijft alleen welke <em>speciale</em> dingen gedaan moeten worden om Oracle® voor Linux® op FreeBSD te draaien, en niet wat beschreven staat in de Oracle® installatiehandleiding.</p></div><div class=sect4><h5 id=linuxemu-kernel-tuning>11.6.3.1. Kerneloptimalisatie<a class=anchor href=#linuxemu-kernel-tuning></a></h5><div class=paragraph><p>Zoals beschreven staat in de Oracle® installatiehandleiding moet de maximale grootte van het gedeelde geheugen ingesteld worden. Op FreeBSD moet <code>SHMMAX</code> niet gebruikt worden. <code>SHMMAX</code> wordt slechts uit <code>SHMMAXPGS</code> en <code>PGSIZE</code> berekend. Daarom dient <code>SHMMAXPGS</code> gedefinieerd te worden. Alle andere opties kunnen gebruikt worden zoals in de handleiding staat beschreven. Bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>options SHMMAXPGS=10000
options SHMMNI=100
options SHMSEG=10
options SEMMNS=200
options SEMMNI=70
options SEMMSL=61</pre></div></div><div class=paragraph><p>Deze opties kunnen naargelang het gebruik van Oracle® ingesteld worden.</p></div><div class=paragraph><p>Ook de volgende opties dienen in het kernelinstellingenbestand te staan:</p></div><div class="literalblock programlisting"><div class=content><pre>options SYSVSHM #SysV gedeeld geheugen
options SYSVSEM #SysV semaforen
options SYSVMSG #SysV interprocescommunicatie</pre></div></div></div><div class=sect4><h5 id=linuxemu-oracle-account>11.6.3.2. Oracle® account<a class=anchor href=#linuxemu-oracle-account></a></h5><div class=paragraph><p>Creeër een <code>oracle</code> account op dezelfde manier als elk ander account. Het <code>oracle</code> account is alleen bijzonder in het opzicht dat het een Linux® shell moet hebben. Dat kan door <code>/compat/linux/bin/bash</code> toe te voegen aan <span class=filename>/etc/shells</span> en de shell voor het <code>oracle</code> account in te stellen op <span class=filename>/compat/linux/bin/bash</span>.</p></div></div><div class=sect4><h5 id=linuxemu-environment>11.6.3.3. Omgeving<a class=anchor href=#linuxemu-environment></a></h5><div class=paragraph><p>Naast de normale Oracle® variabelen als <code>ORACLE_HOME</code> en <code>ORACLE_SID</code> moeten de volgende omgevingsvariabelen ingesteld worden:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Variabele</th><th class="tableblock halign-left valign-top">Waarde</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LD_LIBRARY_PATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>$ORACLE_HOME/lib</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CLASSPATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>$ORACLE_HOME/jdbc/lib/classes111.zip</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>/compat/linux/bin; /compat/linux/sbin; /compat/linux/usr/bin; /compat/linux/usr/sbin; /bin; /sbin; /usr/bin; /usr/sbin; /usr/local/bin; $ORACLE_HOME/bin</code></p></td></tr></tbody></table><div class=paragraph><p>Het is aan te raden om alle omgevingsvariabelen in <span class=filename>.profile</span> in te stellen. Een volledig voorbeeld is:</p></div><div class="literalblock programlisting"><div class=content><pre>ORACLE_BASE=/oracle; export ORACLE_BASE
ORACLE_HOME=/oracle; export ORACLE_HOME
LD_LIBRARY_PATH=$ORACLE_HOME/lib
export LD_LIBRARY_PATH
ORACLE_SID=ORCL; export ORACLE_SID
ORACLE_TERM=386x; export ORACLE_TERM
CLASSPATH=$ORACLE_HOME/jdbc/lib/classes111.zip
export CLASSPATH
PATH=/compat/linux/bin:/compat/linux/sbin:/compat/linux/usr/bin
PATH=$PATH:/compat/linux/usr/sbin:/bin:/sbin:/usr/bin:/usr/sbin
PATH=$PATH:/usr/local/bin:$ORACLE_HOME/bin
export PATH</pre></div></div></div></div><div class=sect3><h4 id=_oracle_installeren>11.6.4. Oracle® installeren<a class=anchor href=#_oracle_installeren></a></h4><div class=paragraph><p>Wegens een kleine inconsistentie in de Linux® emulator moet de map <span class=filename>.oracle</span> aangemaakt worden in <span class=filename>/var/tmp</span> voordat het installatieprogramma wordt gestart. De gebruiker <code>oracle</code> moet de eigenaar van deze map zijn. Nu hoort Oracle® zonder problemen te installeren. Bij problemen dienen eerst de Oracle® distributie en/of de instellingen gecontroleerd te worden! Nadat Oracle® is geïnstalleerd, moeten de patches uit de volgende twee secties geïnstalleerd worden.</p></div><div class=paragraph><p>Een veelvoorkomend probleem is dat de adapter voor het TCP-protocol niet goed is geïnstalleerd. De consequentie daarvan is dat er geen TCP-listeners gestart kunnen worden. De volgende acties helpen om dit probleem op te lossen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd $ORACLE_HOME/network/lib</span>
<span class=c># make -f ins_network.mk ntcontab.o</span>
<span class=c># cd $ORACLE_HOME/lib</span>
<span class=c># ar r libnetwork.a ntcontab.o</span>
<span class=c># cd $ORACLE_HOME/network/lib</span>
<span class=c># make -f ins_network.mk install</span></code></pre></div></div><div class=paragraph><p>Hierna dient <span class=filename>root.sh</span> nogmaals te draaien!</p></div><div class=sect4><h5 id=linuxemu-patch-root>11.6.4.1. <span class=filename>root.sh</span> patchen<a class=anchor href=#linuxemu-patch-root></a></h5><div class=paragraph><p>Als Oracle® geïnstalleerd wordt, worden sommige acties die als <code>root</code> moeten worden uitgevoerd geregistreerd in een shellscript met de naam <span class=filename>root.sh</span>. Dit script komt in de map <span class=filename>orainst</span> te staan. De volgende patch dient uitgevoerd te worden op <span class=filename>root.sh</span> om het de juiste locatie van <code>chown</code> te laten gebruiken of als alternatief kan het script onder een originele Linux® shell gedraaid worden</p></div><div class="literalblock programlisting"><div class=content><pre>*** orainst/root.sh.orig Tue Oct 6 21:57:33 1998
--- orainst/root.sh Mon Dec 28 15:58:53 1998
***************
*** 31,37 ****
# This is the default value for CHOWN
# It will redefined later in this script for those ports
# which have it conditionally defined in ss_install.h
! CHOWN=/bin/chown
#
# Define variables to be used in this script
--- 31,37 ----
# This is the default value for CHOWN
# It will redefined later in this script for those ports
# which have it conditionally defined in ss_install.h
! CHOWN=/usr/sbin/chown
#
# Define variables to be used in this script</pre></div></div><div class=paragraph><p>Als Oracle® niet vanaf een CD-ROM wordt geïnstalleerd, kan de broncode van <span class=filename>root.sh</span> aangepast worden. Die heet <span class=filename>rthd.sh</span> en staat in de map <span class=filename>orainst</span> in de broncodestructuur.</p></div></div><div class=sect4><h5 id=linuxemu-patch-tcl>11.6.4.2. genclntsh patchen<a class=anchor href=#linuxemu-patch-tcl></a></h5><div class=paragraph><p>Het script <code>genclntsh</code> wordt gebruikt om éán enkele gedeelde bibliotheek voor de cliënt aan te maken. Het wordt gebruikt tijdens het maken van de demonstraties. Met de volgende patch wordt de definitie van <code>PATH</code> uitgecommentarieerd:</p></div><div class="literalblock programlisting"><div class=content><pre>*** bin/genclntsh.orig Wed Sep 30 07:37:19 1998
--- bin/genclntsh Tue Dec 22 15:36:49 1998
***************
*** 32,38 ****
#
# Explicit path to ensure that we&#39;re using the correct commands
#PATH=/usr/bin:/usr/ccs/bin export PATH
! PATH=/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin export PATH
#
# each product MUST provide a $PRODUCT/admin/shrept.lst
--- 32,38 ----
#
# Explicit path to ensure that we&#39;re using the correct commands
#PATH=/usr/bin:/usr/ccs/bin export PATH
! #PATH=/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin export PATH
#
# each product MUST provide a $PRODUCT/admin/shrept.lst</pre></div></div></div></div><div class=sect3><h4 id=_oracle_draaien>11.6.5. Oracle® draaien<a class=anchor href=#_oracle_draaien></a></h4><div class=paragraph><p>Als de instructies worden gevolgd, draait Oracle® als op Linux® zelf.</p></div></div></div><div class=sect2><h3 id=linuxemu-advanced>11.7. Gevorderde onderwerpen<a class=anchor href=#linuxemu-advanced></a></h3><div class=paragraph><p>Hier wordt beschreven hoe de Linux® binaire compatibiliteit werkt. Het meeste van wat nu volgt is sterk gebaseerd op een e-mailbericht van Terry Lambert <a href=mailto:tlambert@primenet.com>tlambert@primenet.com</a> aan <a href=https://lists.FreeBSD.org/subscription/freebsd-chat>FreeBSD babbel mailinglijst</a> (Message ID: <code>&lt;<a href=mailto:199906020108.SAA07001@usr09.primenet.com>199906020108.SAA07001@usr09.primenet.com</a>></code>).</p></div><div class=sect3><h4 id=_hoe_werkt_het>11.7.1. Hoe werkt het?<a class=anchor href=#_hoe_werkt_het></a></h4><div class=paragraph><p>FreeBSD heeft een abstractie met de naam "execution class loader". Dit is een wig in de systeemaanroep <a href="https://man.freebsd.org/cgi/man.cgi?query=execve&amp;sektion=2&amp;format=html">execve(2)</a>.</p></div><div class=paragraph><p>Wat er gebeurt is dat FreeBSD een lijst van loaders heeft, in plaats van een enkele loader die terugvalt op de <code>#!</code> loader voor het draaien van elke shellinterpreter of shellscript.</p></div><div class=paragraph><p>Vroeger onderzocht de enige loader op het UNIX® platform het magische getal (in het algemeen de eerste 4 of 8 bytes van het bestand) om te zien of het een binary was die het systeem kende en als dat het geval was laadde het de binaire loader.</p></div><div class=paragraph><p>Als het niet het binaire type voor het systeem was, faalde de aanroep naar <a href="https://man.freebsd.org/cgi/man.cgi?query=execve&amp;sektion=2&amp;format=html">execve(2)</a> en probeerde de shell het als shellopdrachten uit te voeren.</p></div><div class=paragraph><p>Deze aanname was een standaard voor "wat de huidige shell ook is."</p></div><div class=paragraph><p>Later werd er een hack gemaakt voor <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a> om de eerste twee tekens te onderzoeken en als die bestonden uit <code>:\n</code> voerde het in plaats hiervan de <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a> shell uit (het idee is dat SCO de hack als eerste maakte).</p></div><div class=paragraph><p>Wat FreeBSD nu doet is door een lijst van loaders gaan met een generieke <code>#!</code> loader die kennis heeft van interpreters in de zin van de karakters die volgen op de volgende witruimte tot de laatste, met uiteindelijk een terugval op <span class=filename>/bin/sh</span>.</p></div><div class=paragraph><p>Voor Linux® ABI-ondersteuning ziet FreeBSD het magische getal als een ELF-binary (het maakt op dit punt geen onderscheid tussen FreeBSD, Solaris™, Linux® of elk ander besturingssysteem dat een ELF-beeldtype heeft).</p></div><div class=paragraph><p>De ELF loader zoekt naar een gespecialiseerd <em>merk</em>, dat een commentaargedeelte in het ELF-beeld is en dat niet aanwezig is in SVR4/Solaris™ ELF-binairen.</p></div><div class=paragraph><p>Om Linux®-binairen werkend te krijgen, moeten ze <em>gemerkt</em> worden als het type <code>Linux</code> met <a href="https://man.freebsd.org/cgi/man.cgi?query=brandelf&amp;sektion=1&amp;format=html">brandelf(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># brandelf -t Linux bestand</span></code></pre></div></div><div class=paragraph><p>Als dit gedaan is, ziet de ELF loader het <code>Linux</code>-merk in het bestand.</p></div><div class=paragraph><p>Als de ELF loader het <code>Linux</code>-merk tegenkomt, verplaatst de loader een pointer in de <code>proc</code>-structuur. Alle systeemaanroepen worden met deze pointer geïndexeerd (in een traditioneel UNIX® systeem is dit de <code>sysent[]</code>-structuurarray, die de systeemaanroepen bevat). Ook wordt het proces gemerkt voor speciale behandeling door de valstrikvector van de signaal-trampolinecode samen met nog meer (kleine) aanpassingen die door de Linux® kernelmodule worden afgehandeld.</p></div><div class=paragraph><p>De Linux® kernelmodule bevat naast andere dingen een lijst van <code>sysent[]</code>-ingangen waarvan de adressen in de kernelmodule staan.</p></div><div class=paragraph><p>Als een systeemaanroep door de Linux®-binary wordt aangeroepen, verwijdert de valstrikcode de referentie aan de functiepointer van de systeemaanroep en geeft die de ingangspunten van de systeemaanroep van Linux® en niet van FreeBSD.</p></div><div class=paragraph><p>Verder <em>reroot</em> de Linux®-modus dynamisch lookups. Dit is wat de optie <code>union</code> (<em>niet</em> het <code>unionfs</code> bestandssysteemtype!) voor het aankoppelen van bestandssystemen effectief doet. Eerst wordt een poging gedaan om het bestand in de map <span class=filename>/compat/linux/origineel-pad</span> op te zoeken en <em>vervolgens</em> alleen als dat mislukt, wordt het bestand in <span class=filename>/origineel-pad</span> opgezocht. Dit zorgt ervoor dat binairen die andere binairen nodig hebben kunnen draaien (zo kan bijvoorbeeld de Linux®-gereedschapskist geheel onder Linux® ABI-ondersteuning draaien). Dit betekent ook dat Linux®-binairen FreeBSD-binairen kunnen laden en draaien als er geen overeenkomende Linux®-binairen zijn en dat er een <a href="https://man.freebsd.org/cgi/man.cgi?query=uname&amp;sektion=1&amp;format=html">uname(1)</a>-opdracht in de mappenstructuur <span class=filename>/compat/linux</span> gezet kan worden om er zeker van te zijn dat Linux®-binairen niet kunnen weten dat ze niet op Linux® draaien.</p></div><div class=paragraph><p>Effectief bevindt er zich een Linux®-kernel in de FreeBSD-kernel. De verschillende onderliggende functies die alle functies implementeren die de kernel aanbiedt, zijn dezelfde tabelingangen voor de systeemaanroepen van FreeBSD als van Linux®: bestandssysteembewerkingen, bewerkingen op het virtuële geheugen, signaalaflevering, System V IPC, enzovoort. Het enige verschil is dat FreeBSD-binairen de <em>lijm</em> functies voor FreeBSD krijgen en dat de Linux®-binairen de <em>lijm</em>-functies voor Linux® krijgen (de meeste oudere besturingssystemen hadden alleen hun eigen <em>lijm</em>-functies: adressen van functies die in een statische globale <code>sysent[]</code> structuurarray werden opgeslagen, in plaats van adressen van functies waarvan dynamisch een geïnitialiseerde pointer wordt verwijderd in de <code>proc</code>-structuur van het proces dat de aanroep doet).</p></div><div class=paragraph><p>Welke is de eigenlijke FreeBSD ABI? Dat maakt niet uit. Eigenlijk is het enige verschil dat (op dit moment; dit kan eenvoudig veranderen in een toekomstige uitgave, en dat gebeurt waarschijnlijk na deze uitgave) de <em>lijm</em>-functies van FreeBSD statisch gelinkt zijn in de kernel en dat de <em>lijm</em>-functies van Linux® zowel statisch gelinkt kunnen worden als dat ze door een kernelmodule worden benaderd.</p></div><div class=paragraph><p>Maar is dit nu echt emulatie? Nee. Het is een ABI-implementatie, geen emulatie. Er is geen emulator (of simulator, om de volgende vraag voor te zijn) bij betrokken.</p></div><div class=paragraph><p>Dus waarom wordt het dan soms "Linux®-emulatie" genoemd? Om het moeilijk te maken om FreeBSD te verkopen! Serieus, het is zo omdat de historische implementatie in een tijd werd gedaan toen er echt geen ander woord was om te beschrijven wat er aan de hand was, om te zeggen dat FreeBSD Linux®-binairen draaide was niet waar als de code niet in de kernel gecompileerd werd of als een module geladen werd en er moest een woord zijn voor hetgeen geladen werd. Vandaar "de Linux®-emulator".</p></div></div></div></div></div><h1 id=system-administration class=sect0>Deel III: Systeembeheer<a class=anchor href=#system-administration></a></h1><div class="openblock partintro"><div class=content><div class=paragraph><p>De verdere hoofdstukken van het FreeBSD handboek beslaan alle aspecten van het FreeBSD systeembeheer. Ieder hoofdstuk begint met een omschrijving van wat de leerstof in een hoofdstuk is en wat de verwachte voorkennis is.</p></div><div class=paragraph><p>De hoofdstukken zijn ook ontworpen om gelezen te worden als de specifieke informatie nodig is. Ze hoeven niet in een bepaalde volgorde gelezen te worden en ze hoeven ook niet gelezen te zijn voordat een gebruiker met FreeBSD aan de slag kan.</p></div></div></div><div class=sect1><h2 id=config-tuning>Hoofdstuk 12. Instellingen en optimalisatie<a class=anchor href=#config-tuning></a></h2><div class=sectionbody><div class=sect2><h3 id=config-synopsis>12.1. Overzicht<a class=anchor href=#config-synopsis></a></h3><div class=paragraph><p>Systeeminstellingen zijn een belangrijk aspect van FreeBSD. Correcte instellingen helpen moeilijkheden bij toekomstige upgrades te voorkomen. In dit hoofdstuk wordt het instellen van FreeBSD beschreven, alsmede een aantal prestatiebevorderende maatregelen waarmee een FreeBSD systeem geoptimaliseerd kan worden.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe efficiënt om te gaan met bestandssystemen en wisselpartities;</p></li><li><p>De grondbeginselen van het <span class=filename>rc.conf</span> instellingensysteem en van het opstarten van toepassingen (diensten) met <span class=filename>/usr/local/etc/rc.d</span>;</p></li><li><p>Hoe een netwerkkaart ingesteld en getest wordt;</p></li><li><p>Hoe virtuele hosts op netwerkapparatuur ingesteld worden;</p></li><li><p>Hoe de instellingenbestanden in <span class=filename>/etc</span> gebruikt worden;</p></li><li><p>Hoe FreeBSD geoptimaliseerd kan worden met <code>sysctl</code>-variabelen;</p></li><li><p>Hoe schijfprestaties te verbeteren en hoe kernelbeperkingen gewijzigd kunnen worden.</p></li></ul></div><div class=paragraph><p>Veronderstelde voorkennis:</p></div><div class=ulist><ul><li><p>De grondbeginselen van UNIX® en FreeBSD (<a href=./#basics>UNIX® beginselen</a>) begrijpen;</p></li><li><p>Bekend zijn met de grondbeginselen van kernelinstellingen en compilatie (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li></ul></div></div><div class=sect2><h3 id=configtuning-initial>12.2. Initiële instellingen<a class=anchor href=#configtuning-initial></a></h3><div class=sect3><h4 id=_partitioneren>12.2.1. Partitioneren<a class=anchor href=#_partitioneren></a></h4><div class=sect4><h5 id=_basispartities>12.2.1.1. Basispartities<a class=anchor href=#_basispartities></a></h5><div class=paragraph><p>Bij het aanmaken van bestandssystemen met <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> is het van belang dat op een harde schijf de gegevensoverdracht het snelst is aan de buitenste sporen en het langzaamst aan de binnenste. Kleinere en veelgebruikte bestandssystemen kunnen daarom het beste aan de buitenkant van de schijf geplaatst worden, terwijl grotere partities als <span class=filename>/usr</span> meer naar de binnenkant van de schijf geplaatst kunnen worden. Het is een goed idee om partities aan te maken in deze of gelijksoortige volgorde: root, swap, <span class=filename>/var</span>, <span class=filename>/usr</span>.</p></div><div class=paragraph><p>De grootte van de partitie <span class=filename>/var</span> hangt af van de wijze waarop de machine gebruikt gaat worden. Het bestandssysteem <span class=filename>/var</span> wordt gebruikt voor onder meer postbussen, logbestanden en printergegevens en -wachtrijen. Postbussen en logbestanden kunnen onverwacht groot worden, afhankelijk van het aantal systeemgebruikers en de bewaarduur van logbestanden. De meeste gebruikers zullen zelden meer dan ongeveer een gigabyte aan vrije schijfruimte op <span class=filename>/var</span> nodig hebben.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er zijn een aantal gevallen waar een grote hoeveelheid ruimte in <span class=filename>/var/tmp</span> nodig is. Wanneer er nieuwe software wordt geïnstalleerd met <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> pakken de pakketprogramma’s een tijdelijke kopie van de pakketten uit in <span class=filename>/var/tmp</span>. Grote softwarepakketten, zoals Firefox, OpenOffice of LibreOffice kunnen lastig zijn om te installeren wanneer er onvoldoende vrije schijfruimte beschikbaar is onder <span class=filename>/var/tmp</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De partitie <span class=filename>/usr</span> bevat veel van de benodigde systeembestanden, waaronder de <a href="https://man.freebsd.org/cgi/man.cgi?query=ports&amp;sektion=7&amp;format=html">ports(7)</a> collectie (aanbevolen) en de broncode (optioneel). Beide zijn optioneel tijdens de installatie, maar we raden voor deze partitie tenminste 2 gigabyte aan.</p></div><div class=paragraph><p>Het is verstandig rekening te houden met de vereiste schijfruimte bij het kiezen van partitiegroottes. Als in een partitie onvoldoende vrije schijfruimte is, terwijl een andere vrijwel niet gebruikt wordt, is dat een vervelend en niet optimaal oplosbaar probleem.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a>'s <code>Auto-defaults</code> partitiekeuze kan in de ervaring van sommige gebruikers mogelijk te kleine <span class=filename>/var</span> en <span class=filename>/</span> partities opleveren. Partitioneren moet verstandig en niet te zuinig gebeuren.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=swap-design>12.2.1.2. Wisselpartities (swap)<a class=anchor href=#swap-design></a></h5><div class=paragraph><p>De vuistregel is dat het wisselbestand ongeveer het dubbele van de grootte van het systeemgeheugen (RAM) moet zijn. Als de machine bijvoorbeeld 128 megabytes geheugen heeft, kan het beste een wisselbestand van (tenminste) 256 megabytes gebruikt worden. Minder dan 256 megabytes swap is in dit geval af te raden. Systemen met weinig geheugen kunnen overigens beter functioneren met meer swap. Ook is het verstandig rekening te houden met eventuele geheugenuitbreiding in de toekomst. Bovendien zijn de VM paging-algoritmen van de kernel zo afgestemd dat ze het beste presteren bij een wisselbestand van tenminste tweemaal de grootte van het geheugen. Een te kleine swap kan dus inefficiënties in de VM-code tot gevolg hebben en mogelijk problemen veroorzaken als het systeemgeheugen uitgebreid wordt.</p></div><div class=paragraph><p>Op grotere systemen met meerdere SCSI-schijven (of meerdere IDE-schijven op verschillende controllers) is het aan te raden om op elke schijf een wisselpartitie in te stellen (dit kan tot en met vier schijven), elk met ongeveer dezelfde grootte. De kernel kan met arbitraire groottes werken, maar interne datastructuren schalen tot viermaal de grootste swappartitie. De kernel kan de beschikbare ruimte voor het wisselbestand het meest optimaal indelen als de partities ongeveer even groot zijn. Een grote swap is prima, ook als ze zelden gebruikt wordt. Zo kan het gemakkelijker zijn om een (uit de hand gelopen) proces dat het systeem grotendeels bezet houdt te beëindigen, voordat er opnieuw opgestart moet worden.</p></div></div><div class=sect4><h5 id=_waarom_partitioneren>12.2.1.3. Waarom partitioneren?<a class=anchor href=#_waarom_partitioneren></a></h5><div class=paragraph><p>Waarom niet één enkele grote partitie gebruiken? Er zijn verscheidene redenen waarom dit niet zo’n goed idee is. De verschillende partities hebben hun eigen karakteristieke operationele gedrag en vereisten. Door ze te scheiden zijn er betere mogelijkheden om het systeem te optimaliseren. Vanaf de <span class=filename>/</span> en <span class=filename>/usr</span> partities wordt bijvoorbeeld vooral gelezen en er wordt weinig naar geschreven, terwijl er in <span class=filename>/var</span> en <span class=filename>/var/tmp</span> zowel veel gelezen als geschreven wordt.</p></div><div class=paragraph><p>Door een systeem goed te partitioneren wordt vermeden dat fragmentatie die optreedt in de kleinere partities met veel schrijfactiviteit doorsijpelt naar partities die vooral lees-intensief zijn. Door schrijf-intensieve partities aan het begin van de schijf te plaatsen, zijn de prestaties wat betreft invoer/uitvoer het beste daar waar het het meest nodig is. Ofschoon er natuurlijk ook de best mogelijke in/uit prestaties wenselijk zijn in de grotere partities, weegt het plaatsen van deze bestandssystemen aan het begin van de schijf niet tegen de voordelen van het plaatsen van <span class=filename>/var</span> aan het begin van de schijf (na root en swap) voor de totale snelheid van het systeem. Tenslotte zijn er veiligheidsoverwegingen. Een compacte en nette rootpartitie die vrijwel alleen-lezen is, heeft een betere kans om een nare crash te overleven.</p></div></div></div></div><div class=sect2><h3 id=configtuning-core-configuration>12.3. Hoofdinstellingen<a class=anchor href=#configtuning-core-configuration></a></h3><div class=paragraph><p>De voornaamste lokatie voor systeeminstellingen is <span class=filename>/etc/rc.conf</span>. Dit bestand bevat een scala aan instellingen, die gebruikt wordt om het systeem in te stellen bij het opstarten. De naam impliceert dit al. Het is informatie voor de <span class=filename>rc*</span> bestanden (rc staat voor "resource configuration" of broninstellingen).</p></div><div class=paragraph><p>De systeembeheerder wordt geacht regels toe te voegen aan <span class=filename>rc.conf</span> om de standaardinstellingen uit <span class=filename>/etc/defaults/rc.conf</span> aan te passen. Het standaardbestand moet niet letterlijk gekopiëerd worden naar <span class=filename>/etc</span>. Het bevat standaardwaardes en is niet bedoeld als voorbeeld. Alle wijzigingen die specifiek zijn voor een systeem horen in <span class=filename>/etc/rc.conf</span> thuis.</p></div><div class=paragraph><p>In een clusterscenario is het nuttig om systeemspecifieke instellingen te scheiden van algemene instellingen die voor het hele cluster gelden. Hiervoor kunnen een aantal strategieën worden gebruikt. De aanbevolen benadering is om systeem-specifieke instellingen in <span class=filename>/etc/rc.conf.local</span> te plaatsen. Een voorbeeld:</p></div><div class=ulist><ul><li><p><span class=filename>/etc/rc.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>sshd_enable=&#34;YES&#34;
keyrate=&#34;fast&#34;
defaultrouter=&#34;10.1.1.254&#34;</pre></div></div></li><li><p><span class=filename>/etc/rc.conf.local</span>:</p><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;node1.example.org&#34;
ifconfig_fxp0=&#34;inet 10.1.1.1/8&#34;</pre></div></div></li></ul></div><div class=paragraph><p><span class=filename>rc.conf</span> kan vervolgens naar elk systeem gedistribueerd worden met <code>rsync</code> of een gelijksoortig programma, terwijl <span class=filename>rc.conf.local</span> uniek blijft.</p></div><div class=paragraph><p>Het actualiseren van het systeem met <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> of <code>make world</code> overschrijft <span class=filename>rc.conf</span> niet, zodat de bestaande systeeminstellingen niet verloren gaan.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Het instellingenbestand <span class=filename>/etc/rc.conf</span> wordt gelezen door <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a>. Dit stelt systeembeheerders in staat om een zekere hoeveelheid logica aan dit bestand toe te voegen, dat kan helpen in het creëren van zeer ingewikkelde configuratiescenario’s. Bekijk <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> voor meer informatie over dit onderwerp.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=configtuning-appconfig>12.4. Toepassingen instellen<a class=anchor href=#configtuning-appconfig></a></h3><div class=paragraph><p>Geïnstalleerde toepassingen hebben meestal hun eigen instellingenbestanden, met hun eigen syntaxis, etc. Het is van belang deze bestanden apart te houden van het basissysteem, zodat ze makkelijk gelokaliseerd kunnen worden en beheerd kunnen worden met de hulpmiddelen voor pakketbeheer.</p></div><div class=paragraph><p>Deze bestanden worden meestal geïnstalleerd in <span class=filename>/usr/local/etc</span>. Als een toepassing een uitgebreide verzameling bestanden voor instellingen heeft, wordt er een submap voor aangemaakt.</p></div><div class=paragraph><p>Bij de installatie van een port of pakket, worden normaliter ook voorbeeldbestanden met instellingen geïnstalleerd. Deze zijn doorgaans te herkennen aan een toevoegsel <span class=filename>.default</span>. Als er geen bestaande instellingenbestanden voor de toepassing zijn, kunnen ze gemaakt worden door de <span class=filename>.default</span>-bestanden te kopiëren.</p></div><div class=paragraph><p>Een voorbeeld is de map <span class=filename>/usr/local/etc/apache</span>:</p></div><div class=literalblock><div class=content><pre>-rw-r--r--  1 root  wheel   2184 May 20  1998 access.conf
-rw-r--r--  1 root  wheel   2184 May 20  1998 access.conf.default
-rw-r--r--  1 root  wheel   9555 May 20  1998 httpd.conf
-rw-r--r--  1 root  wheel   9555 May 20  1998 httpd.conf.default
-rw-r--r--  1 root  wheel  12205 May 20  1998 magic
-rw-r--r--  1 root  wheel  12205 May 20  1998 magic.default
-rw-r--r--  1 root  wheel   2700 May 20  1998 mime.types
-rw-r--r--  1 root  wheel   2700 May 20  1998 mime.types.default
-rw-r--r--  1 root  wheel   7980 May 20  1998 srm.conf
-rw-r--r--  1 root  wheel   7933 May 20  1998 srm.conf.default</pre></div></div><div class=paragraph><p>Aan de grootte van de bestanden is te zien dat alleen <span class=filename>srm.conf</span> gewijzigd is. Als later de port Apache wordt vernieuwd, wordt dit bestand niet overschreven.</p></div></div><div class=sect2><h3 id=configtuning-starting-services>12.5. Diensten starten<a class=anchor href=#configtuning-starting-services></a></h3><div class=paragraph><p>Veel gebruikers kiezen ervoor om software van derden te installeren op FreeBSD vanuit de Portscollectie. In veel gevallen is het noodzakelijk om de software dusdanig in te stellen dat het opstart tijdens het opstarten van de computer. Diensten zoals <a class=package href=https://cgit.freebsd.org/ports/tree/mail/postfix/>mail/postfix</a> of <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache22/>www/apache22</a> zijn slechts twee voorbeelden van softwarepakketten die gestart kunnen worden tijdens de systeemstart. In deze paragraaf wordt toegelicht hoe software van derde partijen kan worden gestart.</p></div><div class=paragraph><p>In FreeBSD worden de meeste diensten, zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a>, door de opstartscripts van het systeem gestart. Deze scripts kunnen verschillen tussen FreeBSD en leverancierversies, echter het meest belangrijke aspect om in gedachten te houden is dat hun opstartinstellingen verwerkt kunnen worden door simpele opstartscripts.</p></div><div class=sect3><h4 id=_uitgebreide_applicatieinstellingen>12.5.1. Uitgebreide applicatieinstellingen<a class=anchor href=#_uitgebreide_applicatieinstellingen></a></h4><div class=paragraph><p>Nu FreeBSD <span class=filename>rc.d</span> heeft, zijn de instellingen van applicaties die mee moeten opstarten versimpeld en rijker aan mogelijkheden. Door gebruik te maken van de sleutelwoorden die in de paragraaf <a href=#configtuning-rcd><span class=filename>rc.d</span></a> behandeld worden, kunnen applicaties nu starten na andere diensten. DNS kan bijvoorbeeld extra opties meekrijgen van <span class=filename>/etc/rc.conf</span> in plaats van hard ingestelde opties in het opstartscript. Een basisscript ziet er ongeveer als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# PROVIDE: utility
# REQUIRE: DAEMON
# KEYWORD: shutdown

. /etc/rc.subr

name=utility
rcvar=utility_enable

command=&#34;/usr/local/sbin/utility&#34;

load_rc_config $name

#
# VERANDER DE STANDAARDWAARDEN HIER NIET
# STEL ZE IN HET BESTAND /etc/rc.conf IN
#
utility_enable=${utility_enable-&#34;NO&#34;}
pidfile=${utility_pidfile-&#34;/var/run/utility.pid&#34;}

run_rc_command &#34;$1&#34;</pre></div></div><div class=paragraph><p>Dit script zorgt ervoor dat utility wordt gestart na de pseudodienst <code>DAEMON</code>. Het biedt ook de mogelijkheid voor het instellingen en volgen van het PID of het proces-ID bestand.</p></div><div class=paragraph><p>Voor deze applicatie kan dan de volgende regel in <span class=filename>/etc/rc.conf</span> geplaatst worden:</p></div><div class="literalblock programlisting"><div class=content><pre>utility_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Deze methode maakt het volgende mogelijk: makkelijker commandoregelopties manipuleren, importeren van standaardfuncties uit <span class=filename>/etc/rc.subr</span>, compatibiliteit met het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=rcorder&amp;sektion=8&amp;format=html">rcorder(8)</a> en het levert makkelijkere configuratie via <span class=filename>rc.conf</span>.</p></div></div><div class=sect3><h4 id=_diensten_met_diensten_starten>12.5.2. Diensten met diensten starten<a class=anchor href=#_diensten_met_diensten_starten></a></h4><div class=paragraph><p>Andere diensten, zoals POP3-server daemons, IMAP, enzovoort, kunnen gestart worden door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a>. Daaraan is voorafgegaan dat die dienst uit de Portscollectie is geïstalleerd en dat er een regel met instellingen is toegevoegd aan <span class=filename>/etc/inetd.conf</span> of één van de bestaande niet-actieve regels is geactiveerd. Werken met inetd en zijn instellingen wordt uitgebreid toegelicht in de paragraaf over <a href=./#network-inetd>inetd</a>.</p></div><div class=paragraph><p>In sommige gevallen is het handiger om <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> te gebruiken om diensten te starten. Deze aanpak heeft een aantal voordelen omdat <code>cron</code> start als de eigenaar van <span class=filename>crontab</span>. Dit stelt reguliere gebruikers in staat om sommige applicaties te starten en te onderhouden.</p></div><div class=paragraph><p><code>cron</code> levert een unieke optie: in plaats van een tijdsspecificatie kan <code>@reboot</code> gebruikt worden. Dit zorgt ervoor dat de taak gestart wordt als <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> gestart wordt, meestal tijdens een systeemstart.</p></div></div></div><div class=sect2><h3 id=configtuning-cron>12.6. <code>cron</code> instellen<a class=anchor href=#configtuning-cron></a></h3><div class=paragraph><p>Een zeer nuttig hulpprogramma in FreeBSD is <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a>. De daemon <code>cron</code> draait op de achtergrond en controleert voortdurend <span class=filename>/etc/crontab</span>. Ook controleert <code>cron</code> de map <span class=filename>/var/cron/tabs</span>, op zoek naar nieuwe <span class=filename>crontab</span> bestanden. Deze <span class=filename>crontab</span> bestanden bevatten informatie over specifieke taken die <code>cron</code> moet verrichten op gezette tijden.</p></div><div class=paragraph><p><code>cron</code> gebruikt twee verschillende soorten instellingenbestanden: de systeemcrontab en gebruikerscrontabs. Deze formaten verschillen alleen in het zesde en verdere velden. In de systeemcrontab zal <code>cron</code> het commando draaien als de gebruiker die in het zesde veld is opgegeven. In een gebruikerscrontab draaien alle commando’s onder de gebruiker die de crontab heeft aangemaakt, dus is het zesde veld het laatste veld; dit is een belangrijk beveiligingsaspect. Het laatste veld is altijd het commando dat gedraaid wordt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Gebruikerscrontabs geven individuele gebruikers de mogelijkheid om bepaalde terugkerende taken automatisch te laten uitvoeren zonder dat <code>root</code>-rechten noodig zijn. Commando’s in de crontab van een gebruiker worden uitgevoerd met de rechten van de eigenaar.</p></div><div class=paragraph><p><code>root</code> kan ook een gebruikerscrontab aanleggen net als elke andere gebruiker. Dit is niet dezelfde als <span class=filename>/etc/crontab</span>, de systeemcrontab. Omdat de systeemcrontab in de praktijk de commando’s als root uitvoert, is het doorgaans niet nodig om een gebruikerscrontab voor <code>root</code> te maken.</p></div></td></tr></tbody></table></div><div class=paragraph><p><span class=filename>/etc/crontab</span> (de systeemcrontab) ziet er uit als volgt:</p></div><div class="literalblock programlisting"><div class=content><pre># /etc/crontab - root&#39;s crontab for FreeBSD
#
# $FreeBSD: src/etc/crontab,v 1.32 2002/11/22 16:13:39 tom Exp $
#<i class=conum data-value=1></i><b>(1)</b>
#
SHELL=/bin/sh
PATH=/etc:/bin:/sbin:/usr/bin:/usr/sbin <i class=conum data-value=2></i><b>(2)</b>
HOME=/var/log
#
#
#minuut uur     mdag    maand   wdag    wie     commando <i class=conum data-value=3></i><b>(3)</b>
#
#
*/5     *       *       *       *       root    /usr/libexec/atrun <i class=conum data-value=4></i><b>(4)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Zoals in de meeste instellingenbestanden van FreeBSD zijn regels die met het karakter <code>#</code> beginnen commentaar. Commentaar wordt gebruikt als uitleg en geheugensteun. Commentaar dient niet vermengd te worden met commando’s, anders wordt het commentaar opgevat als deel van het commando. Blanco regels worden genegeerd.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Eerst worden omgevingsvariabelen gedefiniëerd. Hoervoor wordt het is-gelijk karakter (<code>=</code>) gebruikt. In het bovenstaande voorbeeld wordt het gebruikt voor de variabelen <code>SHELL</code>, <code>PATH</code> en <code>HOME</code>. Als de regel <code>SHELL</code> ontbreekt, gebruikt <code>cron</code> standaard <code>sh</code> als shell. Voor de omgevingsvariabele <code>PATH</code> bestaat geen standaardwaarde. Als <code>PATH</code> ontbreekt moeten absolute paden gebruikt worden. Als <code>HOME</code> ontbreekt, gebruikt <code>cron</code> de thuismap van de gebruiker die <code>cron</code> aanroept.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>In deze commentaarregel staan de zeven velden van een crontabdefinitie. Dit zijn <code>minuut</code>, <code>uur</code>, <code>mdag</code>, <code>maand</code>, <code>wdag</code>, <code>wie</code> en <code>commando</code>. De betekenissen liggen voor de hand: <code>minuut</code> is het aantal minuten van het tijdstip waarop het commando moet worden uitgevoerd; <code>uur</code> geeft het uur aan; <code>mdag</code> staat voor de dag van de maand; <code>maand</code> staat voor het maandnummer en <code>wdag</code> geeft de dag van de week aan. Het veld <code>wie</code> is bijzonder en bestaat alleen in <span class=filename>/etc/crontab</span>. Het geeft aan als welke gebruiker het commando uitgevoerd moet worden. Het laatste veld bevat het uit te voeren commando.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>In deze regel worden aan de hierboven besproken opties waarden toegekend. Er wordt gebruik gemaakt van <code><strong>/5</strong></code><strong> en <code></code></strong> karakters. Deze betekenen "eerst-laatst" en kunnen gezien worden als <em>telkens</em>. In deze regel staat dus dat <code>atrun</code> elke vijf minuten moet worden uitgevoerd door <code>root</code>, ongeacht welke dag of maand het is. Meer informatie over <code>atrun</code> staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=atrun&amp;sektion=8&amp;format=html">atrun(8)</a>.Commando’s kunnen een willekeurig aantal opties of argumenten meekrijgen. Als commando’s echter meerdere regels nodig hebben moeten deze regels afgebroken worden met een backslash "\" karakter, om aan te geven dat ze op de volgende regel vervolgd worden.</td></tr></tbody></table></div><div class=paragraph><p>Dit is de basisopzet voor elk <span class=filename>crontab</span> bestand. De enige uitzondering is de aanwezigheid van veld zes, waar de gebruikersnaam wordt aangegeven. Dit veld bestaat alleen in de systeemversie van <span class=filename>/etc/crontab</span>. Voor <span class=filename>crontab</span>-bestanden van individuele gebruikers moet dit veld worden weggelaten.</p></div><div class=sect3><h4 id=configtuning-installcrontab>12.6.1. Een crontab installeren<a class=anchor href=#configtuning-installcrontab></a></h4><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>De onderstaande procedure moet niet gebruikt worden om de systeemcrontab <span class=filename>/etc/crontab</span> te wijzigen of te installeren. Er kan een gewone editor gebruikt worden. <code>cron</code> ziet dat het bestand veranderd is en begint direct met het gebruiken van de nieuwe versie. <a href=https://docs.freebsd.org/en/books/faq/#ROOT-NOT-FOUND-CRON-ERRORS>Deze FAQ vraag</a> geeft verdere uitleg.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om een nieuwe <span class=filename>crontab</span> te installeren moet eerst een bestand in het juiste formaat gemaakt worden en daarna moet het geiuml;nstalleerd worden met commando <code>crontab</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># crontab crontabbestand</span></code></pre></div></div><div class=paragraph><p>In dit voorbeeld is <span class=filename>crontabbestand</span> de naam van een eerder gemaakt <span class=filename>crontab</span>-bestand.</p></div><div class=paragraph><p>Er bestaat ook een optie om een lijst van geïnstalleerde <span class=filename>crontab</span>-bestanden op te vragen, namelijk de optie <code>-l</code> van <code>crontab</code>.</p></div><div class=paragraph><p>Gebruikers die hun eigen crontabbestand willen schrijven zonder het gebruik van een sjabloon, kunnen gebruik maken van <code>crontab -e</code>. Dit opent de <code>EDITOR</code> met een leeg bestand. Als het bestand wordt opgeslagen en de editor wordt afgesloten, wordt het bestand automatisch als <span class=filename>crontab</span> geïnstalleerd.</p></div><div class=paragraph><p>Een gebruikers <span class=filename>crontab</span> kan verwijderd worden door de met <code>crontab</code> de optie <code>-r</code> te gebruiken.</p></div></div></div><div class=sect2><h3 id=configtuning-rcd>12.7. Gebruik van rc met FreeBSD<a class=anchor href=#configtuning-rcd></a></h3><div class=paragraph><p>Sinds 2002 gebruikt FreeBSD het NetBSD <span class=filename>rc.d</span> systeem bij het opstarten van het systeem. Veel van de bestanden in <span class=filename>/etc/rc.d</span> zijn scripts voor basisdiensten die werken met de opties <code>start</code>, <code>stop</code> en <code>restart</code>, analoog aan hoe diensten die via een port of pakket zijn geïnstalleerd gestart worden met de scripts in <span class=filename>/usr/local/etc/rc.d</span>. <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> kan bijvoorbeeld als volgt herstart worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service restart</span></code></pre></div></div><div class=paragraph><p>Deze procedure is vrijwel gelijk voor andere diensten. Uiteraard worden diensten meestal automatisch tijdens het opstarten van de computer gestart zoals in <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> staat. Om de Network Address Translation daemon bij het opstarten te laten starten is de volgende regel in <span class=filename>/etc/rc.conf</span> bijvoorbeeld voldoende:</p></div><div class="literalblock programlisting"><div class=content><pre>natd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Als er reeds een <code>natd_enable="NO"</code> regel is, kan <code>NO</code> gewoon in <code>YES</code> veranderd worden. De rc scripts starten, voor zover nodig, automatisch andere afhankelijke diensten.</p></div><div class=paragraph><p>Omdat het <span class=filename>rc.d</span> systeem in eerste instantie bedoeld is om diensten te starten en stoppen bij het opstarten en afsluiten van het systeem, werken de standaardopties <code>start</code>, <code>stop</code> en <code>restart</code> alleen als de juiste variabelen in <span class=filename>/etc/rc.conf</span> zijn ingesteld. Het commando <code>sshd restart</code> alleen dan als <code>sshd_enable</code> de waarde <code>YES</code> heeft in <span class=filename>/etc/rc.conf</span>. Als er een dienst gestart, gestopt of herstart moet worden, ongeacht de definities in <span class=filename>/etc/rc.conf</span>, moet het commando voorafgegaan worden door "one". Dus om <code>sshd</code> te herstarten ongeacht de instellingen in <span class=filename>/etc/rc.conf</span>, voldoet het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sshd onerestart</span></code></pre></div></div><div class=paragraph><p>Het is eenvoudig te controleren of een dienst is ingeschakeld is in <span class=filename>/etc/rc.conf</span> door het bijpassende <span class=filename>rc.d</span>-script uit te voeren met de optie <code>rcvar</code>. Voor <code>sshd</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sshd rcvar</span>
<span class=c># sshd</span>
<span class=nv>$sshd_enable</span><span class=o>=</span>YES</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De tweede regel (<code># sshd</code>) is de uitvoer van <code>sshd</code>, geen <code>root</code>-console.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De optie <code>status</code> wordt gebruikt om vast te stellen of een dienst gestart is. Om bijvoorbeeld te controleren of <code>sshd</code> gestart is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sshd status</span>
sshd is running as pid 433.</code></pre></div></div><div class=paragraph><p>In sommige gevallen is het ook mogelijk om een dienst te herstarten met de optie <code>reload</code>. Dan wordt er getracht een signaal te sturen aan een individuele dienst, waarbij de dienst de bestanden met instellingen opnieuw in moet lezen. Meestal komt dit neer op het verzenden van het signaal <code>SIGHUP</code>. Deze optie wordt niet door alle diensten ondersteund.</p></div><div class=paragraph><p>Het rc.d-systeem wordt niet alleen gebruikt voor netwerkdiensten, maar ook voor het merendeel van de systeemstart. In dit kader is bijvoorbeeld het bestand <span class=filename>bgfsck</span> interessant. Als dit script wordt uitgevoerd, wordt de volgende boodschap getoond:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Starting background file system checks <span class=k>in </span>60 seconds.</code></pre></div></div><div class=paragraph><p>Dit script wordt dus gebruikt voor bestandssysteemcontrole in de achtergrond, hetgeen alleen tijdens de systeemstart gebeurt.</p></div><div class=paragraph><p>Veel systeemdiensten zijn afhankelijk van andere diensten om correct te kunnen functioneren. Zo starten NIS en andere RPC-gebaseerde diensten niet als de dienst <code>rpcbind</code> (portmapper) nog niet draait. Om dit te stroomlijnen wordt informatie over afhankelijkheden en andere metagegevens ingevoegd in het commentaar bovenaan het opstartscript. Deze commentaarregels worden vervolgens tijdens de systeemstart met <a href="https://man.freebsd.org/cgi/man.cgi?query=rcorder&amp;sektion=8&amp;format=html">rcorder(8)</a> verwerkt om zo vast te stellen in welke volgorde de systeemdiensten gestart moeten worden.</p></div><div class=paragraph><p>De volgende woorden moeten in alle opstartscripts staan (ze zijn benodigd door <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.subr&amp;sektion=8&amp;format=html">rc.subr(8)</a> om het opstartscript te activeren):</p></div><div class=ulist><ul><li><p><code>PROVIDE</code>: geeft aan in welke diensten dit bestand voorziet.</p></li><li><p><code>REQUIRE</code>: geeft aan welke andere diensten vereist zijn voor deze dienst. Dit script wordt uitgevoerd <em>na</em> de aangegeven diensten.</p></li><li><p><code>BEFORE</code>: geeft diensten aan die afhankelijk zijn van deze dienst. Dit bestand wordt uitgevoerd <em>vóór</em> de aangegeven diensten.</p></li></ul></div><div class=paragraph><p>Met deze methode kan een systeembeheerder gemakkelijk systeemdiensten besturen, zonder gedoe met "runlevels" zoals bij sommige andere UNIX® systemen.</p></div><div class=paragraph><p>Meer informatie over het <span class=filename>rc.d</span>-systeem staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.subr&amp;sektion=8&amp;format=html">rc.subr(8)</a>. Als u geïnteresseerd bent in het schrijven van uw eigen <span class=filename>rc.d</span>-script of om de huidige scripts te verbeteren is wellicht <a href=https://docs.freebsd.org/en/articles/rc-scripting/>dit artikel</a> interessant.</p></div></div><div class=sect2><h3 id=config-network-setup>12.8. Netwerkkaarten instellen<a class=anchor href=#config-network-setup></a></h3><div class=paragraph><p>Het is tegenwoordig nauwelijks voorstelbaar dat een computer geen netwerkverbinding heeft. Het toevoegen en instellen van een netwerkkaart is een gebruikelijke taak voor een FreeBSD-beheerder.</p></div><div class=sect3><h4 id=_het_juiste_stuurprogramma_vinden>12.8.1. Het juiste stuurprogramma vinden<a class=anchor href=#_het_juiste_stuurprogramma_vinden></a></h4><div class=paragraph><p>Voor het zoeken begint, moet duidelijk zijn om welke kaart het gaat, welke chip erop zit en of het een PCI- of ISA-kaart is. FreeBSD ondersteunt vele kaarten. Op de Hardware Compatibiliteitslijst voor de betreffende uitgave staan de kaarten die ondersteund worden.</p></div><div class=paragraph><p>Als duidelijk is dat een kaart ondersteund wordt, moet vastgesteld worden wat het geschikte stuurprogramma is. In het bestand <span class=filename>/usr/src/sys/conf/NOTES</span> staat een lijst van stuurprogramma’s voor netwerkinterfaces met wat informatie over de ondersteunde chipsets of kaarten. In geval van twijfel biedt de hulppagina voor het stuurprogramma (<code>man</code>) vaak uitkomst. In het algemeen bevat deze meer informatie over de ondersteunde hardware en mogelijke problemen die kunnen optreden.</p></div><div class=paragraph><p>Als een veelgebruikte kaart gebruikt wordt, hoeft meestal niet ver gezocht te worden. Stuurprogramma’s voor veelvoorkomende netwerkinterfaces zijn al aanwezig in de algemene kernel <span class=filename>GENERIC</span>. In dat geval wordt zo’n kaart al gevonden bij het opstarten, bijvoorbeeld met het volgende bericht:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>dc0: &lt;82c169 PNIC 10/100BaseTX&gt; port 0xa000-0xa0ff mem 0xd3800000-0xd38
000ff irq 15 at device 11.0 on pci0
miibus0: &lt;MII bus&gt; on dc0
bmtphy0: &lt;BCM5201 10/100baseTX PHY&gt; PHY 1 on miibus0
bmtphy0:  10baseT, 10baseT-FDX, 100baseTX, 100baseTX-FDX, auto
dc0: Ethernet address: 00:a0:cc:da:da:da
dc0: <span class=o>[</span>ITHREAD]
dc1: &lt;82c169 PNIC 10/100BaseTX&gt; port 0x9800-0x98ff mem 0xd3000000-0xd30
000ff irq 11 at device 12.0 on pci0
miibus1: &lt;MII bus&gt; on dc1
bmtphy1: &lt;BCM5201 10/100baseTX PHY&gt; PHY 1 on miibus1
bmtphy1:  10baseT, 10baseT-FDX, 100baseTX, 100baseTX-FDX, auto
dc1: Ethernet address: 00:a0:cc:da:da:db
dc1: <span class=o>[</span>ITHREAD]</code></pre></div></div><div class=paragraph><p>In dit voorbeeld zitten er twee kaarten in het systeem die het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=dc&amp;sektion=4&amp;format=html">dc(4)</a> gebruiken.</p></div><div class=paragraph><p>Als het stuurprogramma voor een NIC geen onderdeel is van de kernel <span class=filename>GENERIC</span>, dan dient het juiste stuurprogramma voor die NIC geladen te worden. Dit kan op twee manieren:</p></div><div class=ulist><ul><li><p>De meest eenvoudige manier is het laden van een kernelmodule voor een netwerkkaart met <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> of automatisch tijdens het opstarten van het systeem door de benodigde regel toe te voegen aan <span class=filename>/boot/loader.conf</span>. Niet alle NIC-stuurprogramma’s zijn als module beschikbaar. Zo zijn er bijvoorbeeld geen modules beschikbaar voor ISA-kaarten.</p></li><li><p>Ondersteuning voor een kaart kan ook in de kernel gecompileerd worden. In <span class=filename>/usr/src/sys/conf/NOTES</span>, <span class=filename>/usr/src/sys/arch/conf/NOTES</span> en de hulppagina van het stuurprogramma is na te lezen wat er in het kernelinstellingenbestand moet staan. In <a href=./#kernelconfig>De FreeBSD-kernel instellen</a> staat meer informatie over het compileren van een eigen kernel. Als een netwerkkaart al bij het opstarten wordt herkend door de kernel <span class=filename>GENERIC</span>, is er geen reden om een andere kernel te bouwen.</p></li></ul></div><div class=sect4><h5 id=config-network-ndis>12.8.1.1. Gebruik maken van Windows® NDIS-stuurprogramma’s<a class=anchor href=#config-network-ndis></a></h5><div class=paragraph><p>Helaas zijn er nog steeds veel leveranciers die geen schema’s leveren voor stuurprogramma’s aan de open-source gemeenschap, omdat ze deze informatie beschouwen als handelsgeheimen. Als gevolg daarvan hebben de ontwikkelaars van FreeBSD en andere projecten twee keuzes: zelf de stuurprogramma’s ontwikkelen door een langdurig en pijnlijk proces van de huidige stuurprogramma’s te ontcijferen, of door gebruik te maken van de huidige binaire bestanden voor het Microsoft® Windows® platform. De meeste ontwikkelaars, inclusief diegeen die gekoppeld zijn aan FreeBSD, hebben voor het laatste gekozen.</p></div><div class=paragraph><p>Dankzij de bijdragen van Bill Paul (wpaul) is er "native" ondersteuning voor de Network Driver Interface Specification (NDIS). De FreeBSD NDISulator (ook wel bekend als Project Evil) neemt een binair Windows® stuurprogramma en doet net alsof deze in een Windows® systeem draait. Omdat het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ndis&amp;sektion=4&amp;format=html">ndis(4)</a> een Windows® binary gebruikt; draait het alleen op i386™- en amd64-systemen. PCI, CardBus, PCMCIA (PC-Card) en USB-apparaten worden ondersteund.</p></div><div class=paragraph><p>Om de NDISulator te gebruiken zijn drie dingen nodig:</p></div><div class="olist arabic"><ol class=arabic><li><p>De bronbestanden van de kernel</p></li><li><p>Een Windows® XP stuurprogramma (met de extensie <span class=filename>.SYS</span>)</p></li><li><p>Een instellingenbestand van het Windows® XP stuurprogramma (met de extensie <span class=filename>.INF</span>)</p></li></ol></div><div class=paragraph><p>Lokaliseer de bestanden voor uw specifieke kaart. Over het algemeen kunnen deze gevonden worden op de bijgeleverde CD’s of op de website van de leverancier. In de volgende voorbeelden maken we gebruik van <span class=filename>W32DRIVER.SYS</span> en <span class=filename>W32DRIVER.INF</span>.</p></div><div class=paragraph><p>De bit-breedte van het stuurprogramma moet overeenkomen met die van het stuurprogramma. Gebruik voor FreeBSD/i386 een 32-bits Windows® stuurprogramma. Voor FreeBSD/amd64 is een 64-bits Windows® stuurprogramma nodig.</p></div><div class=paragraph><p>De volgende stap is het compileren van het binaire stuurprogramma in een laadbare kernelmodule. Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=ndisgen&amp;sektion=8&amp;format=html">ndisgen(8)</a> als <code>root</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ndisgen /pad/naar/W32DRIVER.INF</span>
/pad/naar/W32DRIVER.SYS</code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ndisgen&amp;sektion=8&amp;format=html">ndisgen(8)</a> is interactief en vraagt om extra informatie als het dat nodig heeft. Een nieuwe kernel-module wordt in de huidige map geschreven. Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> om de nieuwe module te laden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload ./W32DRIVER_SYS.ko</span></code></pre></div></div><div class=paragraph><p>Naast de gegenereerde kernelmodule, moeten ook de modules <span class=filename>ndis.ko</span> en <span class=filename>if_ndis.ko</span> geladen worden. Dit zou automatisch moeten gebeuren als er een module geladen wordt dit afhankelijk is van <a href="https://man.freebsd.org/cgi/man.cgi?query=ndis&amp;sektion=4&amp;format=html">ndis(4)</a>. Als ze handmatig ingeladen moeten worden gebruik dan de volgende commando’s:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload ndis</span>
<span class=c># kldload if_ndis</span></code></pre></div></div><div class=paragraph><p>Het eerste commando laadt de stuurprogrammawrapper voor de NDIS miniport, de tweede laadt de daadwerkelijke netwerkinterface.</p></div><div class=paragraph><p>Controleer nu <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> om te zien of er ergens fouten voorkomen. Als alles goed gegaan is ziet u ongeveer het volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ndis0: &lt;Wireless-G PCI Adapter&gt; mem 0xf4100000-0xf4101fff irq 3 at device 8.0 on pci1
ndis0: NDIS API version: 5.0
ndis0: Ethernet address: 0a:b1:2c:d3:4e:f5
ndis0: 11b rates: 1Mbps 2Mbps 5.5Mbps 11Mbps
ndis0: 11g rates: 6Mbps 9Mbps 12Mbps 18Mbps 36Mbps 48Mbps 54Mbps</code></pre></div></div><div class=paragraph><p>Vanaf dit moment kan de <span class=filename>ndis0</span> net zo gebruikt worden als elke andere netwerkkaart (bv. <span class=filename>dc0</span>).</p></div><div class=paragraph><p>Het systeem kan geconfigureerd worden zodat de NDIS-modules automatisch gestart worden tijdens het opstarten van het systeem, net zoals bij andere modules. Kopieer eerst de gegenereerde module <span class=filename>W32DRIVER_SYS.ko</span> naar de map <span class=filename>/boot/modules</span>. Voeg daarna de volgende regel toe aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>W32DRIVER_SYS_load=&#34;YES&#34;</pre></div></div></div></div><div class=sect3><h4 id=_de_netwerkkaart_instellen>12.8.2. De netwerkkaart instellen<a class=anchor href=#_de_netwerkkaart_instellen></a></h4><div class=paragraph><p>Nadat een geschikt stuurprogramma geladen is, moet de kaart nog ingesteld worden. Mogelijk is dit al gebeurd door sysinstall tijdens de installatie.</p></div><div class=paragraph><p>Om de instellen van de netwerkkaarten weer te geven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ifconfig
dc0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>80008&lt;VLAN_MTU,LINKSTATE&gt;
        ether 00:a0:cc:da:da:da
        inet 192.168.1.3 netmask 0xffffff00 broadcast 192.168.1.255
        media: Ethernet autoselect <span class=o>(</span>100baseTX &lt;full-duplex&gt;<span class=o>)</span>
        status: active
dc1: <span class=nv>flags</span><span class=o>=</span>8802&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>80008&lt;VLAN_MTU,LINKSTATE&gt;
        ether 00:a0:cc:da:da:db
        inet 10.0.0.1 netmask 0xffffff00 broadcast 10.0.0.255
        media: Ethernet 10baseT/UTP
        status: no carrier
lo0: <span class=nv>flags</span><span class=o>=</span>8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; metric 0 mtu 16384
        <span class=nv>options</span><span class=o>=</span>3&lt;RXCSUM,TXCSUM&gt;
        inet6 fe80::1%lo0 prefixlen 64 scopeid 0x4
        inet6 ::1 prefixlen 128
        nd6 <span class=nv>options</span><span class=o>=</span>3&lt;PERFORMNUD,ACCEPT_RTADV&gt;</code></pre></div></div><div class=paragraph><p>In dit voorbeeld werden de volgende apparaten weergegeven:</p></div><div class=ulist><ul><li><p><span class=filename>dc0</span>: de eerste Ethernet-interface;</p></li><li><p><span class=filename>dc1</span>: de tweede Ethernet-interface;</p></li><li><p><span class=filename>lo0</span>: het loopback-apparaat;</p></li></ul></div><div class=paragraph><p>FreeBSD gebruikt de naam van het stuurprogramma gevolgd door een nummer voor de volgorde waarop de kaarten gedetecteerd zijn bij het opstarten. <span class=filename>sis2</span> is de derde netwerkkaart in het systeem die het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=sis&amp;sektion=4&amp;format=html">sis(4)</a> gebruikt.</p></div><div class=paragraph><p>In het vorige voorbeeld is het apparaat <span class=filename>dc0</span> volledig operationeel. Dit blijkt uit de volgende indicatoren:</p></div><div class="olist arabic"><ol class=arabic><li><p><code>UP</code> betekent dat de kaart ingesteld is en klaar is voor gebruik;</p></li><li><p>De kaart heeft een Internet (<code>inet</code>) adres (in dit geval <code>192.168.1.3</code>);</p></li><li><p>Het heeft een geldig subnetmasker (<code>netmask</code>; <code>0xffffff00</code> is hetzelfde als <code>255.255.255.0</code>);</p></li><li><p>Het heeft een geldig broadcastadres (in dit geval <code>192.168.1.255</code>);</p></li><li><p>Het MAC-adres van de kaart (<code>ether</code>) is <code>00:a0:cc:da:da:da</code>;</p></li><li><p>De fysieke mediaselectie staat in autoselectiemodus (<code>media: Ethernet autoselect (100baseTX full-duplex)</code>). <span class=filename>dc1</span> is ingesteld om met <code>10baseT/UTP</code>-media te werken. Meer informatie over de mogelijke mediatypes staan in de hulppagina’s voor het betreffende stuurprogramma.</p></li><li><p>De status van de verbinding (<code>status</code>) is <code>active</code>, dat wil zeggen dat de drager is gevonden. Bij <span class=filename>dc1</span> staat echter <code>status: no carrier</code>. Dit is normaal als er geen Ethernetkabel in de kaart gestoken is.</p></li></ol></div><div class=paragraph><p>Als de uitvoer <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> er ongeveer zoals hieronder uitziet, dan is de netwerkkaart nog niet ingesteld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>dc0: <span class=nv>flags</span><span class=o>=</span>8843&lt;BROADCAST,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>80008&lt;VLAN_MTU,LINKSTATE&gt;
        ether 00:a0:cc:da:da:da
        media: Ethernet autoselect <span class=o>(</span>100baseTX &lt;full-duplex&gt;<span class=o>)</span>
        status: active</code></pre></div></div><div class=paragraph><p>Om de kaart in te stellen zijn <code>root</code>-rechten nodig. De netwerkkaart kan vanaf de console worden ingesteld met <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a>, maar dan moet dat na elke herstart herhaald worden. Daarom wordt het vrijwel altijd in <span class=filename>/etc/rc.conf</span> gezet.</p></div><div class=paragraph><p>In <span class=filename>/etc/rc.conf</span> moet voor elke netwerkkaart in een systeem een regel toegevoegd worden. In het huidige voorbeeld zou dat het volgende kunnen zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_dc0=&#34;inet 192.168.1.3 netmask 255.255.255.0&#34;
ifconfig_dc1=&#34;inet 10.0.0.1 netmask 255.255.255.0 media 10baseT/UTP&#34;</pre></div></div><div class=paragraph><p><span class=filename>dc0</span>, <span class=filename>dc1</span>, enzovoort, moeten vervangen worden door de correcte stuurprogramma’s voor de netwerkkaarten, zo ook de IP-adressen. In de handleiding van het stuurprogramma en van <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> staan meer details over de mogelijke opties en in <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> staat meer informatie over <span class=filename>/etc/rc.conf</span>.</p></div><div class=paragraph><p>Als het netwerk al is ingesteld tijdens het installeren van FreeBSD staan er al enkele regels met betrekking tot de netwerkkaart(en) in <span class=filename>/etc/rc.conf</span>. Het is dus handig <span class=filename>/etc/rc.conf</span> te controleren voordat er regels toegevoegd worden.</p></div><div class=paragraph><p>Ook <span class=filename>/etc/hosts</span> moet worden gewijzigd om de namen en IP adressen van verschillende machines op het lokale netwerk, als ze er nog niet in staan. Meer informatie staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts&amp;sektion=5&amp;format=html">hosts(5)</a> en <span class=filename>/usr/shared/examples/etc/hosts</span>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als internettoegang nodig is met dit apparaat, kan het zijn dat de default gateway en de naamserver handmatig moeten worden ingesteld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;defaultrouter=&#34;your_default_router&#34;&#39; &gt;&gt; /etc/rc.conf</span>
<span class=c># echo &#39;nameserver your_DNS_server&#39; &gt;&gt; /etc/resolv.conf</span></code></pre></div></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_testen_en_problemen_oplossen>12.8.3. Testen en problemen oplossen<a class=anchor href=#_testen_en_problemen_oplossen></a></h4><div class=paragraph><p>Als de veranderingen in <span class=filename>/etc/rc.conf</span> zijn gemaakt, moet het systeem opnieuw gestarten worden (of moeten nauwkeurig alle daemons gestart of herstart worden). Veranderingen aan de interface(s) worden dan toegepast en dan kan er controleerd worden of herstarten goed werkt zonder foutmeldingen. Als alternatief kan ook het netwerk systeem herstart worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif restart</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als er ook een default gateway ingesteld is in het <span class=filename>/etc/rc.conf</span> bestand, moet ook onderstaand command worden gegeven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service routing restart</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Zodra het netwerk systeem is herstart, moeten de netwerk interfaces opnieuw getest worden.</p></div><div class=sect4><h5 id=_testen_van_de_netwerkkaart>12.8.3.1. Testen van de netwerkkaart<a class=anchor href=#_testen_van_de_netwerkkaart></a></h5><div class=paragraph><p>Om te controleren of een ethernet kaart goed geconfigureerd is, moeten er twee dingen gedaan worden. Allereerst, ping de interface zelf, en daarna een andere machine op het LAN.</p></div><div class=paragraph><p>Test eerst de lokale interface:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ping <span class=nt>-c5</span> 192.168.1.3
PING 192.168.1.3 <span class=o>(</span>192.168.1.3<span class=o>)</span>: 56 data bytes
64 bytes from 192.168.1.3: <span class=nv>icmp_seq</span><span class=o>=</span>0 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.082 ms
64 bytes from 192.168.1.3: <span class=nv>icmp_seq</span><span class=o>=</span>1 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.074 ms
64 bytes from 192.168.1.3: <span class=nv>icmp_seq</span><span class=o>=</span>2 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.076 ms
64 bytes from 192.168.1.3: <span class=nv>icmp_seq</span><span class=o>=</span>3 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.108 ms
64 bytes from 192.168.1.3: <span class=nv>icmp_seq</span><span class=o>=</span>4 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.076 ms

<span class=nt>---</span> 192.168.1.3 ping statistics <span class=nt>---</span>
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev <span class=o>=</span> 0.074/0.083/0.108/0.013 ms</code></pre></div></div><div class=paragraph><p>Nu kan er een andere machine op het LAN gepinged worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ping <span class=nt>-c5</span> 192.168.1.2
PING 192.168.1.2 <span class=o>(</span>192.168.1.2<span class=o>)</span>: 56 data bytes
64 bytes from 192.168.1.2: <span class=nv>icmp_seq</span><span class=o>=</span>0 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.726 ms
64 bytes from 192.168.1.2: <span class=nv>icmp_seq</span><span class=o>=</span>1 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.766 ms
64 bytes from 192.168.1.2: <span class=nv>icmp_seq</span><span class=o>=</span>2 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.700 ms
64 bytes from 192.168.1.2: <span class=nv>icmp_seq</span><span class=o>=</span>3 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.747 ms
64 bytes from 192.168.1.2: <span class=nv>icmp_seq</span><span class=o>=</span>4 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.704 ms

<span class=nt>---</span> 192.168.1.2 ping statistics <span class=nt>---</span>
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev <span class=o>=</span> 0.700/0.729/0.766/0.025 ms</code></pre></div></div><div class=paragraph><p>Dit kan ook worden geprobeerd met de machine naam in plaats van met <code>192.168.1.2</code> als dit geconfigureerd is in <span class=filename>/etc/hosts</span>.</p></div></div><div class=sect4><h5 id=_problemen_oplossen_2>12.8.3.2. Problemen oplossen<a class=anchor href=#_problemen_oplossen_2></a></h5><div class=paragraph><p>Het testen en zoeken van problemen is altijd een pijnpunt, welke verminderd kan worden door een aantal simpele dingen eerst te controleren. Is de netwerkkabel ingestoken? Zijn de netwerk instellingen correct opgegeven? Is de firewall goed geconfigureerd? Is de netwerkkaart ondersteund door FreeBSD? Controleer altijd de hardware notities voordat er een probleem rapport wordt verstuurd. Update naar de laatste -STABLE versie, en controleer de mailing lijsten en misschien zelfs het internet.</p></div><div class=paragraph><p>Als de kaart werkt, maar de prestaties zijn slecht, dan kan het de moeite waard zijn om <a href="https://man.freebsd.org/cgi/man.cgi?query=tuning&amp;sektion=7&amp;format=html">tuning(7)</a> door te nemen. Incorrecte netwerkinstellingen kunnen ook tot langzame verbindingen leiden.</p></div><div class=paragraph><p>Soms kunnen enkele <code>device timeouts</code> optreden. Met sommige kaarten is dit normaal gedrag. Maar als dit continu gebeurt of storend is, is het verstandig uit te zoeken of er geen sprake is van een hardwareconfict tussen de netwerkkaart en een ander apparaat. Ook dient nogmaals de bekabeling gecontroleerd te worden. Misschien zit er niets anders op dan een andere netwerkkaart te gebruiken.</p></div><div class=paragraph><p>Het is ook mogelijk dat er <code>watchdog timeout</code> foutmeldingen optreden. Als eerste moet dan de netwerkkabel gecontroleerd worden. Veel kaarten hebben een PCI-slot nodig dat Bus Mastering ondersteunt. Sommige oudere moederborden hebben maar één PCI-slot waarmee dit kan (meestal slot 0). In de documentatie van de netwerkkaart en het moederbord is na te gaan of dit het probleem is.</p></div><div class=paragraph><p><code>No route to host</code> meldingen treden op als het systeem niet in staat is om een pakket naar de eindbestemming te routeren. Dit kan gebeuren als er geen standaardroute aangegeven is of als er een kabel niet verbonden is. De uitvoer van <code>netstat -rn</code> moet gecontroleerd worden of er een geldige route is naar de bestemming. Mocht dit niet het geval zijn, dan staat er meer informatie in <a href=./#advanced-networking>Netwerken voor gevorderden</a>.</p></div><div class=paragraph><p><code>ping: sendto: Permission denied</code> foutmeldingen worden vaak veroorzaakt door een verkeerd ingestelde firewall. Als de kernel <code>ipfw</code> activeert bij het opstarten zonder dat er firewallregels zijn gedefiniëerd, is het standaardbeleid om alle verkeer te weigeren, zelfs pings! In <a href=./#firewalls>Firewalls</a> staat meer informatie.</p></div><div class=paragraph><p>Er kan ook sprake zijn van onvoldoende prestaties doordat de instelling van de mediaselectie niet optimaal is. In dergelijke gevallen is het mogelijk om de mediaselectie niet als <code>autoselect</code> in te stellen, maar expliciet aan te geven wat de mediaselectie moet zijn, bijvoorbeeld 10baseT/UTP voor twisted pair. Hoewel dit voor de meeste hardware helpt, kan het zijn dat de problemen blijven. Dan moeten nogmaals de netwerkinstellingen gecontroleerd worden en geeft de <a href="https://man.freebsd.org/cgi/man.cgi?query=tuning&amp;sektion=7&amp;format=html">tuning(7)</a> handleiding wellicht meer informatie.</p></div></div></div></div><div class=sect2><h3 id=configtuning-virtual-hosts>12.9. Virtuele hosts<a class=anchor href=#configtuning-virtual-hosts></a></h3><div class=paragraph><p>FreeBSD wordt veel gebruikt voor virtuele sitehosting, waarbij één fysieke server er op het netwerk uitziet alsof het meerdere servers zijn. Dit kan bereikt worden door meerdere IP-adressen toe te kennen aan dezelfde interface.</p></div><div class=paragraph><p>Een bepaalde netwerkinterface heeft een "echt" adres en kan daarnaast een willekeurig aantal "alias"-adressen hebben. Normaliter worden dergelijke aliassen toegevoegd door aliasregels toe te voegen aan <span class=filename>/etc/rc.conf</span>.</p></div><div class=paragraph><p>Een aliasregel voor de interface <span class=filename>fxp0</span> ziet er zo uit:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0_alias0=&#34;inet xxx.xxx.xxx.xxx netmask xxx.xxx.xxx.xxx&#34;</pre></div></div><div class=paragraph><p>De aliasregels moeten beginnen met <code>alias0</code> en moete elkaar dan opvolgen (bijvoorbeeld <code>_alias1,</code>, <code>_alias2</code>, enzovoort). Het instelproces stopt als er een nummer ontbreekt.</p></div><div class=paragraph><p>Het is belangrijk dat aliassen het juiste netmasker hebben. Dit is eenvoudig: Een bepaalde interface moet altijd één adres hebben dat het netmasker van het netwerk correct representeert. Elk ander adres binnen dit netwerk op deze interface (alias) moet een netmasker van allemaal <code>1</code>'en (bits) hebben (getoond als <code>255.255.255.255</code> of <code>0xffffffff</code>).</p></div><div class=paragraph><p>Een voorbeeld. Stel de interface <span class=filename>fxp0</span> is verbonden met twee netwerken, het netwerk <code>10.1.1.0</code> met masker <code>255.255.255.0</code> en het netwerk <code>202.0.75.16</code> met netmasker <code>255.255.255.240</code>. Het systeem moet ook de adressen <code>10.1.1.1</code> tot en met <code>10.1.1.5</code> en <code>202.0.75.17</code> tot en met <code>202.0.75.20</code> krijgen. Zoals hierboven vermeld, heeft alleen het eerste adres in een netwerkreeks (in dit geval <code>10.0.1.1</code> en <code>202.0.75.17</code>) een geldig netmasker. Alle overige (<code>10.1.1.2</code> tot en met <code>10.1.1.5</code> en <code>202.0.75.18</code> tot en met <code>202.0.75.20</code>) moeten ingesteld worden met het netmasker <code>255.255.255.255</code>.</p></div><div class=paragraph><p>De volgende regels voor <span class=filename>/etc/rc.conf</span> stellen een adapter in voor het bovenstaande scenario:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;inet 10.1.1.1 netmask 255.255.255.0&#34;
ifconfig_fxp0_alias0=&#34;inet 10.1.1.2 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias1=&#34;inet 10.1.1.3 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias2=&#34;inet 10.1.1.4 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias3=&#34;inet 10.1.1.5 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias4=&#34;inet 202.0.75.17 netmask 255.255.255.240&#34;
ifconfig_fxp0_alias5=&#34;inet 202.0.75.18 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias6=&#34;inet 202.0.75.19 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias7=&#34;inet 202.0.75.20 netmask 255.255.255.255&#34;</pre></div></div></div><div class=sect2><h3 id=configtuning-syslog>12.10. De systeemlogger syslogd configureren<a class=anchor href=#configtuning-syslog></a></h3><div class=paragraph><p>Systeemlogging is een belangrijk aspect van systeembeheer. Het wordt zowel gebruikt voor het opsporen van hardware-problemen als voor software-problemen in het systeem. Het speelt ook zeer belangrijke rol bij het controleren van de beveiliging en het reageren op incidenten. Systeem-daemons die niet in een terminal beheerd worden, loggen gewoonlijk informatie naar een systeemlogfaciliteit of een ander logbestand.</p></div><div class=paragraph><p>Deze sectie beschrijft hoe de FreeBSD systeemlogger, <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a>, te configureren en te gebruiken, en behandelt logrotatie en logbeheer met <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a>. De focus ligt bij het opzetten en gebruiken van <code>syslogd</code> op een lokale machine. Meer geavanceerdere opstellingen die een aparte loghost gebruiken staan in <a href=./#network-syslogd>Hosts op afstand loggen met syslogd</a>.</p></div><div class=sect3><h4 id=_syslogd_gebruiken>12.10.1. syslogd gebruiken<a class=anchor href=#_syslogd_gebruiken></a></h4><div class=paragraph><p>In de standaardconfiguratie van FreeBSD wordt <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> gestart tijdens het opstarten. Dit wordt bepaald door de variabele <code>syslogd_enable</code> in <span class=filename>/etc/rc.conf</span>. Er zijn vele toepassingsargumenten die het gedrag van <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> beïnvloeden. Gebruik <code>syslogd_flags</code> in <span class=filename>/etc/rc.conf</span> om ze te veranderen. Bekijk <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> voor meer informatie over de argumenten, en <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a>, <a href=#configtuning-core-configuration>Hoofdinstellingen</a> en <a href=#configtuning-rcd>Gebruik van rc met FreeBSD</a> voor meer informatie over <span class=filename>/etc/rc.conf</span> en het deelsysteem <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>.</p></div></div><div class=sect3><h4 id=_syslogd_configureren>12.10.2. syslogd configureren<a class=anchor href=#_syslogd_configureren></a></h4><div class=paragraph><p>Het configuratiebestand, standaard <span class=filename>/etc/syslog.conf</span>, bepaalt wat <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> doet met de logregels nadat ze eenmaal ontvangen zijn. Er zijn verschillende parameters om de afhandeling van binnenkomende gebeurtenissen te beheren, waarvan de twee basaalste <em>faciliteit</em> en <em>niveau</em> zijn. De faciliteit beschrijft welk deelsysteem het bericht genereerde, zoals de kernel of een daemon, het niveau beschrijft de ernst van de opgetreden gebeurtenis. Dit maakt het mogelijk om het bericht naar verschillende logbestanden te loggen, of het weg te gooien, afhankelijk van de faciliteit en het niveau. Het is ook mogelijk om actie te nemen afhankelijk van de toepassing dat het bericht verstuurde, en in het geval van loggen op afstand, ook de hostnaam van de machine dat het logbericht genereerde.</p></div><div class=paragraph><p>Het configureren van <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> is vrij rechttoe-rechtaan. Het configuratiebestand bevat één regel per actie, de syntaxis van elke regel is een selecteerderveld gevolgd door een actieveld. De syntaxis van het selecteerderveld is <em>faciliteit.niveau</em> dat overeenkomt met logberichten van <em>faciliteit</em> op niveau <em>niveau</em> of hoger. Het is ook mogelijk om een optionele vergelijkingsvlag voor het niveau toe te voegen om meer precies te specificeren wat er gelogd wordt. Er kunnen meerdere selecteerdervelden worden gebruikt voor dezelfde actie, ze worden gescheiden door een puntkomma (<code>;</code>). Het gebruik van <code>*</code> zal met alles overeenkomen. Het actieveld bepaalt waar het logbericht naar toe wordt gezonden, zoals een bestand of een loghost op afstand. Als voorbeeld is hier de standaard <span class=filename>syslog.conf</span> van FreeBSD:</p></div><div class="literalblock programlisting"><div class=content><pre># $FreeBSD$
#
#       Spaces ARE valid field separators in this file. However,
#       other *nix-like systems still insist on using tabs as field
#       separators. If you are sharing this file between systems, you
#       may want to use only tabs as field separators here.
#       Consult the man:syslog.conf[5] manpage.
*.err;kern.warning;auth.notice;mail.crit                /dev/console <i class=conum data-value=1></i><b>(1)</b>
*.notice;authpriv.none;kern.debug;lpr.info;mail.crit;news.err   /var/log/messages
security.*                                      /var/log/security
auth.info;authpriv.info                         /var/log/auth.log
mail.info                                       /var/log/maillog <i class=conum data-value=2></i><b>(2)</b>
lpr.info                                        /var/log/lpd-errs
ftp.info                                        /var/log/xferlog
cron.*                                          /var/log/cron
*.=debug                                        /var/log/debug.log <i class=conum data-value=3></i><b>(3)</b>
*.emerg                                         *
# uncomment this to log all writes to /dev/console to /var/log/console.log
#console.info                                   /var/log/console.log
# uncomment this to enable logging of all log messages to /var/log/all.log
# touch /var/log/all.log and chmod it to mode 600 before it will work
#*.*                                            /var/log/all.log
# uncomment this to enable logging to a remote loghost named loghost
#*.*                                            @loghost
# uncomment these if you&#39;re running inn
# news.crit                                     /var/log/news/news.crit
# news.err                                      /var/log/news/news.err
# news.notice                                   /var/log/news/news.notice
!ppp <i class=conum data-value=4></i><b>(4)</b>
*.*                                             /var/log/ppp.log
!*</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Komt overeen met alle berichten met een <code>err</code> of hoger, alsook met <code>kern.warning</code>, <code>auth.notice</code> en <code>mail.crit</code>, en stuur deze logberichten naar de console ( <span class=filename>/dev/console</span>).</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Komt overeen met alle berichten van de faciliteit <code>mail</code> op niveau <code>info</code> of hoger, en logt de berichten in <span class=filename>/var/log/maillog</span>.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Deze regel gebruikt een vergelijkingsvlag, <code>=</code> om alleen met de berichten op niveau <code>debug</code> overeen te komen en ze op te slaan in <span class=filename>/var/log/debug.log</span>.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Hier volgt een gebruiksvoorbeeld van een <em>programmaspecificatie</em>. Dit zorgt ervoor dat de regels alleen geldig zijn voor het programma in de programmaspecificatie. In dit geval zorgen deze en de volgende regel ervoor dat alle berichten van <code>ppp</code>, maar niet van andere programma’s, in <span class=filename>/var/log/ppp.log</span> terechtkomen.</td></tr></tbody></table></div><div class=paragraph><p>Dit voorbeeld toont dat er vele niveaus en deelsystemen zijn. De niveaus zijn, in volgorde van meest naar minst kritisch: <code>emerg</code>, <code>alert</code>, <code>crit</code>, <code>err</code>, <code>warning</code>, <code>notice</code>, <code>info</code> en <code>debug</code>.</p></div><div class=paragraph><p>De faciliteiten zijn, in geen specifieke volgorde: <code>auth</code>, <code>authpriv</code>, <code>console</code>, <code>cron</code>, <code>daemon</code>, <code>ftp</code>, <code>kern</code>, <code>lpr</code>, <code>mail</code>, <code>mark</code>, <code>news</code>, <code>security</code>, <code>syslog</code>, <code>user</code>, <code>uucp</code> en <code>local0</code> tot en met <code>local7</code>. Let erop dat andere besturingssystemen andere faciliteiten kunnen hebben.</p></div><div class=paragraph><p>Met deze kennis is het eenvoudig om een nieuwe regel aan <span class=filename>/etc/syslog.conf</span> toe te voegen om alles van de verschillende daemons op niveau <code>notice</code> en hoger naar <span class=filename>/var/log/daemon.log</span> te loggen:</p></div><div class="literalblock programlisting"><div class=content><pre>daemon.notice                                        /var/log/daemon.log</pre></div></div><div class=paragraph><p>Bekijk <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> voor meer informatie over de verschillende niveaus en faciliteiten. Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog.conf&amp;sektion=5&amp;format=html">syslog.conf(5)</a> en <a href=./#network-syslogd>Hosts op afstand loggen met syslogd</a> voor meer informatie over <span class=filename>syslog.conf</span>, de syntaxis, en geavanceerdere gebruiksvoorbeelden.</p></div></div><div class=sect3><h4 id=_logbeheer_en_rotatie_met_newsyslog>12.10.3. Logbeheer en -rotatie met newsyslog<a class=anchor href=#_logbeheer_en_rotatie_met_newsyslog></a></h4><div class=paragraph><p>Logbestanden hebben de neiging om snel te groeien en gestadig opgehoopt te raken. Dit leidt tot bestanden die vol zitten met minder direct bruikbare informatie en de harde schijf volmaken. Logbeheer kan gebruikt worden om dit te beheersen. In FreeBSD wordt <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a> gebruikt om logbestanden te beheren. Dit programma wordt gebruikt om periodiek logbestanden te roteren en te comprimeren en om optioneel ontbrekende logbestanden aan te maken en programma’s te signaleren dat logbestanden zijn verplaatst. De logbestanden hoeven niet per sé van syslog afkomstig te zijn; <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a> werkt met elke log van elk programma. Het is belangrijk om op te merken dat <code>newsyslog</code> normaliter vanuit <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> wordt gedraaid en niet een systeem-daemon is. In de standaardconfiguratie wordt het elk uur gedraaid.</p></div><div class=sect4><h5 id=_newsyslog_configureren>12.10.3.1. newsyslog configureren<a class=anchor href=#_newsyslog_configureren></a></h5><div class=paragraph><p>Om te weten wat het moet doen leest <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a> zijn configuratiebestand, standaard is dit <span class=filename>/etc/newsyslog.conf</span>. Dit configuratiebestand bevat één regel voor elk bestand dat <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a> beheert. Elke regel noemt de eigenaar van het bestand, rechten, en wanneer dat bestand te roteren, alsook optionele vlaggen die de logrotatie beïnvloeden (zoals compressie) en naar welke programma’s een signaal te sturen wanner de log is geroteerd. Als voorbeeld is hier de standaard configuratie in FreeBSD:</p></div><div class="literalblock programlisting"><div class=content><pre># configuration file for newsyslog
# $FreeBSD$
#
# Entries which do not specify the &#39;/pid_file&#39; field will cause the
# syslogd process to be signalled when that log file is rotated.  This
# action is only appropriate for log files which are written to by the
# syslogd process (ie, files listed in /etc/syslog.conf).  If there
# is no process which needs to be signalled when a given log file is
# rotated, then the entry for that file should include the &#39;N&#39; flag.
#
# The &#39;flags&#39; field is one or more of the letters: BCDGJNUXZ or a &#39;-&#39;.
#
# Note: some sites will want to select more restrictive protections than the
# defaults.  In particular, it may be desirable to switch many of the 644
# entries to 640 or 600.  For example, some sites will consider the
# contents of maillog, messages, and lpd-errs to be confidential.  In the
# future, these defaults may change to more conservative ones.
#
# logfilename          [owner:group]    mode count size when  flags [/pid_file] [sig_num]
/var/log/all.log                        600  7     *    @T00  J
/var/log/amd.log                        644  7     100  *     J
/var/log/auth.log                       600  7     100  @0101T JC
/var/log/console.log                    600  5     100  *     J
/var/log/cron                           600  3     100  *     JC
/var/log/daily.log                      640  7     *    @T00  JN
/var/log/debug.log                      600  7     100  *     JC
/var/log/init.log                       644  3     100  *     J
/var/log/kerberos.log                   600  7     100  *     J
/var/log/lpd-errs                       644  7     100  *     JC
/var/log/maillog                        640  7     *    @T00  JC
/var/log/messages                       644  5     100  @0101T JC
/var/log/monthly.log                    640  12    *    $M1D0 JN
/var/log/pflog                          600  3     100  *     JB    /var/run/pflogd.pid
/var/log/ppp.log        root:network    640  3     100  *     JC
/var/log/security                       600  10    100  *     JC
/var/log/sendmail.st                    640  10    *    168   B
/var/log/utx.log                        644  3     *    @01T05 B
/var/log/weekly.log                     640  5     1    $W6D0 JN
/var/log/xferlog                        600  7     100  *     JC</pre></div></div><div class=paragraph><p>Elke regel begint met de naam van het bestand dat geroteerd moet worden, optioneel gevolgd door een eigenaar en groep voor zowel de geroteerde als nieuw aangemaakte bestanden. Het volgende veld, <code>mode</code> is de modus van de bestanden en <code>count</code> geeft aan hoeveel geroteerde logbestanden bewaard moeten worden. De velden <code>size</code> en <code>when</code> vertellen <code>newyslog</code> wanneer het bestand geroteerd moet worden. Een logbestand wordt geroteerd wanneer òfwel de grootte meer is dan de waarde in het veld <code>size</code>, òfwel wanneer de tijd in het veld <code>when</code> is verstreken. <code>*</code> geeft aan dat dit veld genegeerd wordt. Het veld <em>flags</em> geeft <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a> verdere instructies, zoals hoe het geroteerde bestand te comprimeren of om het logbestand aan te maken als het ontbreekt. De laatste twee velden zijn optioneel en specificeren het PID-bestand van een proces en een naar dat proces te verzenden signaalnummer wanneer het bestand wordt geroteerd. Raadpleeg <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog.conf&amp;sektion=5&amp;format=html">newsyslog.conf(5)</a> voor meer informatie over alle velden, geldige vlaggen en hoe de rotatietijd te specificeren. Herinner dat <code>newsyslog</code> wordt gedraaid vanuit <code>cron</code> en niet vaker bestanden kan roteren dan dat het gedraaid wordt vanuit <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a>.</p></div></div></div></div><div class=sect2><h3 id=configtuning-configfiles>12.11. Instellingenbestanden<a class=anchor href=#configtuning-configfiles></a></h3><div class=sect3><h4 id=_etc_layout>12.11.1. <span class=filename>/etc</span> layout<a class=anchor href=#_etc_layout></a></h4><div class=paragraph><p>Instellingengegevens wordt in een aantal mappen bewaard. Daar zijn onder andere:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Generieke systeeminstellingenbestanden, specifiek voor het systeem.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/defaults</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De standaardversies van systeeminstellingenbestanden.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Extra <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> instellingenbestanden of instellingenbestanden voor andere MTAs.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/ppp</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Instellingen voor zowel gebruiker- als kernel-ppp programma’s.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/namedb</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Standaardlocatie voor <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a> gegevens. Normaal gesproken bevinden zich hier <span class=filename>named.conf</span> en zonebestanden.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/local/etc</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Instellingenbestanden voor geïnstalleerde software. Kan submappen hebben waarin bij elkaar horende instellingengegevens van een applicatie gegroepeerd zijn.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/local/etc/rc.d</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Start- en stopscripts voor geïnstalleerde diensten.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/db</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Automatisch gemaakte systeemspecifieke databasebestanden, zoals de pakketdatabase, de <a href="https://man.freebsd.org/cgi/man.cgi?query=locate&amp;sektion=1&amp;format=html">locate(1)</a> database, enzovoort.</p></td></tr></tbody></table></div><div class=sect3><h4 id=_hostnamen>12.11.2. Hostnamen<a class=anchor href=#_hostnamen></a></h4><div class=sect4><h5 id=_etcresolv_conf>12.11.2.1. <span class=filename>/etc/resolv.conf</span><a class=anchor href=#_etcresolv_conf></a></h5><div class=paragraph><p>In <span class=filename>/etc/resolv.conf</span> wordt voorgeschreven op welke wijze FreeBSD het Domain Name System (DNS) moet gebruiken.</p></div><div class=paragraph><p>De meest voorkomende termen in <span class=filename>resolv.conf</span> zijn:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>nameserver</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het IP-adres van een naamserver die ondervraagd moet worden voor naam/IP-conversie. De servers worden in volgorde geprobeerd en het maximale aantal is drie.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>search</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Zoeklijst voor het opzoeken van hostnamen. Meestal wordt deze bepaald door het domein waarop de lokale hostnaam zich bevindt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>domain</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De lokale domeinnaam.</p></td></tr></tbody></table><div class=paragraph><p>Een typisch <span class=filename>resolv.conf</span> bestand:</p></div><div class="literalblock programlisting"><div class=content><pre>search example.com
nameserver 147.11.1.11
nameserver 147.11.100.30</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>search</code> en <code>domain</code> dienen niet tegelijk gebruikt te worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als DHCP wordt gebruikt: <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a> overschrijft meestal <span class=filename>resolv.conf</span> met informatie ontvangen van de DHCP-server.</p></div></div><div class=sect4><h5 id=_etchosts>12.11.2.2. <span class=filename>/etc/hosts</span><a class=anchor href=#_etchosts></a></h5><div class=paragraph><p><span class=filename>/etc/hosts</span> is een eenvoudige tekstdatabase uit de dagen van het oude Internet. Het werkt samen met DNS en NIS om namen en IP adressen over en weer te vertalen. Lokale computers, verbonden via een LAN, kunnen hier het beste in opgenomen worden om zo op simpele wijze naam/IP conversie voor een LAN te hebben, zonder noodzaak voor een <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a> server. Ook kunnen naamaliassen toegekend worden (vergelijkbaar met CNAMES bij DNS). Op soortgelijke wijze kan <span class=filename>/etc/hosts</span> gebruikt worden als een (zeer beperkte) lokale DNS cache.</p></div><div class="literalblock programlisting"><div class=content><pre># $FreeBSD$
#
# Host Database
# Dit bestand hoort de adressen en aliassen te bevatten
# voor de lokale hosts die dit bestand gebruiken.
# Bij gebruik van DNS of NIS hoeft dit bestand helemaal niet gebruikt
# te worden.  Zie /etc/nsswitch.conf voor de volgorde van resolutie.
#
#
::1                      localhost localhost.my.domain myname.my.domain
127.0.0.1                localhost localhost.my.domain myname.my.domain

#
# Verzonnen netwerk.
#10.0.0.2                myname.my.domain myname
#10.0.0.3                myfriend.my.domain myfriend
#
# Volgens RFC 1918 mogen de volgende IP netwerken gebruikt worden
# als private netwerken die niet met Internet verbonden zijn:
#
#        10.0.0.0        -   10.255.255.255
#        172.16.0.0      -   172.31.255.255
#        192.168.0.0     -   192.168.255.255
#
# Als er toch verbinding moet zijn met Internet, zijn echte
# officieel toegewezen nummers nodig.  Probeer ECHT GEEN eigen
# netwerknummers te verzinnen, maar vraag ze op bij de provider
# (als die er is) of bij de Internet Registry (ftp naar
# rs.internic.net, map `/templates&#39;).
#</pre></div></div><div class=paragraph><p><span class=filename>/etc/hosts</span> heeft als formaat:</p></div><div class="literalblock programlisting"><div class=content><pre>[Internet address] [official hostname] [alias1] [alias2] ...</pre></div></div><div class=paragraph><p>Bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>10.0.0.1 myRealHostname.example.com myRealHostname foobar1 foobar2</pre></div></div><div class=paragraph><p>In <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts&amp;sektion=5&amp;format=html">hosts(5)</a> staat meer informatie.</p></div></div></div><div class=sect3><h4 id=configtuning-sysctlconf>12.11.3. <span class=filename>sysctl.conf</span><a class=anchor href=#configtuning-sysctlconf></a></h4><div class=paragraph><p><span class=filename>sysctl.conf</span> lijkt veel op <span class=filename>rc.conf</span>. Waardetoekenning heeft weer de vorm <code>variable=value</code>. De ingestelde <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>-waarden worden doorgevoerd op het moment dat het systeem naar multi-user modus gaat. Niet alle variabelen kunnen in deze modus gewijzigd worden.</p></div><div class=paragraph><p>Om te voorkomen dat er logregels geplaatst worden als processen crashen en om te voorkomen dat andere gebruikers kunnen zien welke processen er gestart zijn door een andere gebruiker, kunnen de volgende instellingen worden gezet in <span class=filename>sysctl.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>#Log exits met fatale signalen niet (bv. sig 11)
kern.logsigexit=0

# Voorkom dat gebruikers informatie zien over processen die
# worden gedraaid onder een ander UID.
security.bsd.see_other_uids=0</pre></div></div></div></div><div class=sect2><h3 id=configtuning-sysctl>12.12. Optimaliseren met sysctl<a class=anchor href=#configtuning-sysctl></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> is een interface waarmee veranderingen gemaakt kunnen worden aan een draaiend FreeBSD-systeem. Er zijn onder meer vele geavanceerde opties voor de TCP/IP-stack en het virtuele geheugensysteem, waarmee een ervaren systeembeheerder de systeemprestaties drastisch kan verbeteren. Met <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> kunnen meer dan vijfhonderd systeemvariabelen opgevraagd en ingesteld worden.</p></div><div class=paragraph><p>In essentie heeft <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> twee functies: het lezen en wijzigen van systeeminstellingen.</p></div><div class=paragraph><p>Om alle leesbare variabelen te tonen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sysctl <span class=nt>-a</span></code></pre></div></div><div class=paragraph><p>Om een bepaalde variabele op te vragen, bijvoorbeeld <code>kern.maxproc</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sysctl kern.maxproc
kern.maxproc: 1044</code></pre></div></div><div class=paragraph><p>Om een bepaalde variabele toe te kennen (te wijzigen), is de syntaxis <em>variable</em>=<em>value</em>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.maxfiles=5000</span>
kern.maxfiles: 2088 -&gt; 5000</code></pre></div></div><div class=paragraph><p>Waarden van sysctl-variabelen zijn doorgaans strings (tekst), getallen of booleans (<code>1</code> als waar, <code>0</code> als onwaar).</p></div><div class=paragraph><p>Om automatisch variabelen in te stellen als de machine start, kunnen ze toegevoegd worden aan <span class=filename>/etc/sysctl.conf</span>. Meer informatie staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl.conf&amp;sektion=5&amp;format=html">sysctl.conf(5)</a> en <a href=#configtuning-sysctlconf><span class=filename>sysctl.conf</span></a>.</p></div><div class=sect3><h4 id=sysctl-readonly>12.12.1. <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> alleen-lezen<a class=anchor href=#sysctl-readonly></a></h4><div class=paragraph><p>In sommige gevallen is het wenselijk om <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>-waarden die alleen-lezen zijn toch te wijzigen. Hoewel dit soms onontkoombaar is, kan het alleen bij een (her)start gedaan worden.</p></div><div class=paragraph><p>Op sommige laptops is bijvoorbeeld het apparaat <a href="https://man.freebsd.org/cgi/man.cgi?query=cardbus&amp;sektion=4&amp;format=html">cardbus(4)</a> niet in staat om geheugenregio’s af te tasten, met als gevolg foutmeldingen als:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>cbb0: Could not map register memory
device_probe_and_attach: cbb0 attach returned 12</code></pre></div></div><div class=paragraph><p>In dergelijke gevallen moeten er meestal enkele <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>-instellingen gewijzigd worden die alleen-lezen zijn en een standaardwaarde hebben. Dit kan bereikt worden door <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> "OIDs" in de lokale <span class=filename>/boot/loader.conf</span> te zetten. Standaardinstellingen staan in <span class=filename>/boot/defaults/loader.conf</span>.</p></div><div class=paragraph><p>Om het bovenstaande probleem op te lossen moet in <span class=filename>/boot/loader.conf</span><code>hw.pci.allow_unsupported_io_range=1</code> ingesteld worden. Dan werkt <a href="https://man.freebsd.org/cgi/man.cgi?query=cardbus&amp;sektion=4&amp;format=html">cardbus(4)</a> wel goed.</p></div></div></div><div class=sect2><h3 id=configtuning-disk>12.13. Harde schijven optimaliseren<a class=anchor href=#configtuning-disk></a></h3><div class=sect3><h4 id=_sysctl_variabelen>12.13.1. Sysctl-variabelen<a class=anchor href=#_sysctl_variabelen></a></h4><div class=sect4><h5 id=_vfs_vmiodirenable>12.13.1.1. <code>vfs.vmiodirenable</code><a class=anchor href=#_vfs_vmiodirenable></a></h5><div class=paragraph><p>De sysctl-variabele <code>vfs.vmiodirenable</code> kan de waarde 0 (uit) of 1 (aan) hebben. De standaardwaarde is 1. Deze variabele bepaalt hoe mappen door het systeem in een cache bewaard worden. De meeste mappen zijn klein en gebruiken slechts een klein fragment (typisch 1 K) in het bestandssysteem en nog minder (typisch 512 bytes) in de buffercache. Als deze variabele uit staat (op 0) bewaart de buffercache slechts een bepaald aantal mappen in de cache, ook al is er een overvloed aan geheugen beschikbaar. Wanneer deze aan staat (op 1), wordt de VM paginacache gebruikt, waardoor voor het cachen van mappen al het geheugen kan worden gebruikt. Het is echter wel zo dat het minimale in-core geheugen dat gebruikt wordt om een map te cachen in dat geval de fysieke paginagrootte is (typisch 4 K) in plaats van 512 bytes. Het is aan te raden deze optie aan te laten staan als gebruik gemaakt wordt van diensten die met grote aantallen bestanden werken, zoals webcaches, grote mailsystemen en newsservers. Als deze optie aan blijft staan, verlaagt die de prestaties niet, ook al kost het meer geheugen. Door experimenteren is dit voor een systeem na te gaan.</p></div></div><div class=sect4><h5 id=_vfs_write_behind>12.13.1.2. <code>vfs.write_behind</code><a class=anchor href=#_vfs_write_behind></a></h5><div class=paragraph><p>De sysctl-variabele <code>vfs.write_behind</code> staat standaard aan (<code>1</code>). Dit betekent dat het bestandssysteem gegevens naar het medium gaat schrijven op het moment dat er een volledig cluster aan gegevens verzameld is. Dit is meestal het geval bij het schrijven van grote sequentiële bestanden. Het idee is om te voorkomen dat de buffercache verzadigd raakt met vuile buffers zonder dat dit bijdraagt aan de I/O-prestaties. Dit kan echter processen ophouden en onder sommige omstandigheden is het wellicht beter deze sysctl uit te zetten.</p></div></div><div class=sect4><h5 id=_vfs_hirunningspace>12.13.1.3. <code>vfs.hirunningspace</code><a class=anchor href=#_vfs_hirunningspace></a></h5><div class=paragraph><p>De sysctl-variabele <code>vfs.hirunningspace</code> bepaalt hoeveel nog te schrijven gegevens er in het complete systeem op elk moment in de wachtrij naar schijfcontrollers mag staan. De standaardwaarde is meestal voldoende, maar op machines met veel schijven, is het beter deze te verhogen naar vier of vijf <em>megabyte</em>. Het instellen van een te hoge waarde (groter dan de schrijfdrempel van de buffercache) kan leiden tot zeer slechte prestaties bij clustering. Stel deze waarde niet arbitrair hoog in! Hogere schrijfwaarden kunnen vertraging veroorzaken in het lezen, als dit tegelijk plaatsvindt.</p></div><div class=paragraph><p>Er zijn verscheidene andere sysctl’s voor buffercache en VM-pagecache. Het wordt afgeraden deze te wijzigen. Het VM-systeem is zeer goed in staat zichzelf automatisch te optimaliseren.</p></div></div><div class=sect4><h5 id=_vm_swap_idle_enabled>12.13.1.4. <code>vm.swap_idle_enabled</code><a class=anchor href=#_vm_swap_idle_enabled></a></h5><div class=paragraph><p>De sysctl-variabele <code>vm.swap_idle_enabled</code> is nuttig in grote meergebruikersystemen met veel gebruikers die af- en aanmelden en veel onbenutte processen. Dergelijke systemen hebben de neiging om voortdurend de vrije geheugenreserves onder druk te zetten. Het is mogelijk om de prioriteit van geheugenpagina’s die verband houden met onbenutte processen sneller te laten dalen dan met het normale pageout-algoritme, door deze sysctl aan te zetten en via <code>vm.swap_idle_threshold1</code> en <code>vm.swap_idle_threshold2</code> de swapout hysterese (in seconden onbenut) af te stemmen. Deze optie dient alleen gebruikt te worden als ze echt nodig is, want de andere kant van de medaille is dat dit eerder pre-page geheugen inhoudt in plaats van later, waardoor het meer wisselbestand- en schijfbandbreedte kost. In een klein systeem heeft deze optie een voorspelbaar effect, maar in grote systemen waar al sprake is van een matige paging kan deze optie het mogelijk maken voor het VM-systeem om hele processen gemakkelijk in en uit het geheugen te halen.</p></div></div><div class=sect4><h5 id=_hw_ata_wc>12.13.1.5. <code>hw.ata.wc</code><a class=anchor href=#_hw_ata_wc></a></h5><div class=paragraph><p>Ten tijde van FreeBSD 4.3 is er geflirt met het uitzetten van IDE-schrijfcaching. Hierdoor neemt de bandbraadte naar IDE-schijven af, maar het werd als noodzakelijk beschouwd vanwege ernstige problemen met gegevensinconsistentie die door harde schijfproducenten geëintroduceerd waren. Het probleem is dat IDE-schijven niet de waarheid vertellen over wanneer een schrijfactie klaar is. Door IDE-schrijfcaching wordt data niet alleen ongeordend geschreven, maar soms kan zelfs het schrijven van sommige blokken voortdurend uitgesteld worden als er sprake is van een hoge schijfbelasting. Een crash of stroomstoring kan dan ernstige corruptie aan het bestandssysteem veroorzaken. Daarom werd de standaardinstelling van FreeBSD voor alle zekerheid gewijzigd. Helaas was het resultaat een groot verlies aan prestaties en na die uitgave is de standaardwaarde weer terug veranderd. Met de sysctl-variabele <code>hw.ata.wc</code> kan gecontroleerd worden of schrijfcaching aan of uit staat. Als schrijfcaching uit staat, kan het die weer aangezet worden door <code>hw.ata.wc</code> op 1 te zetten. Aangezien dit een kernelvariabele is, moet deze ingesteld worden vanuit de bootloader tijdens het opstarten. Nadat de kernel eenmaal opgestart is, heeft het wijzigen van deze sysctl geen effect.</p></div><div class=paragraph><p>Meer informatie staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=ata&amp;sektion=4&amp;format=html">ata(4)</a>.</p></div></div><div class=sect4><h5 id=_scsi_delay_kern_cam_scsi_delay>12.13.1.6. <code>SCSI_DELAY</code> (<code>kern.cam.scsi_delay</code>)<a class=anchor href=#_scsi_delay_kern_cam_scsi_delay></a></h5><div class=paragraph><p>De kernelinstelling <code>SCSI_DELAY</code> kan gebruikt worden om de opstarttijd te versnellen. De standaardwaarde is nogal hoog en kan <code>15</code> seconden vertraging veroorzaken. Met modernere SCSI-systemen is <code>5</code> seconden al voldoende (zeker met moderne schijven). De <code>kern.cam.scsi_delay</code> opstart variabele moet hier gebruikt worden. De variabele en kernelconfiguratie-optie accepteren waarden uitgedrukt in <em>milliseconden</em> en <em>niet</em> in <em>seconden</em>.</p></div></div></div><div class=sect3><h4 id=soft-updates>12.13.2. Softupdates<a class=anchor href=#soft-updates></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> kan gebruikt worden om een bestandsysteem nauwkeurig af te stellen. Het heeft veel opties, maar nu wordt alleen het aan- en uitzetten van softupdates besproken. Dat gaat als volgt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tunefs -n enable /filesystem</span>
<span class=c># tunefs -n disable /filesystem</span></code></pre></div></div><div class=paragraph><p>Een bestandssysteem kan niet met <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> gewijzigd worden als het aangekoppeld is. Softupdates aanzetten wordt dus in het algemeen gedaan vanuit enkelegebruikermodus, voordat partities aangekoppeld zijn.</p></div><div class=paragraph><p>Softupdates zorgen voor een drastische verbetering van de prestaties met betrekking tot metagegevens, met name het aanmaken en verwijderen van bestanden, door gebruik van een geheugencache. Het wordt dan ook aangeraden om op alle bestandssystemen softupdates te gebruiken. Er zijn twee nadelen aan softupdates: softupdates garanderen een consistent bestandssysteem in geval van een crash, maar het kan makkelijk enkele seconden (zelfs een minuut) achter liggen met het daadwerkelijk bijwerken op de fysieke harde schijf. Als een systeem crasht gaat wellicht meer werk verloren dan anders het geval zou zijn. Daarnaast vertragen softupdates het vrijgeven van bestandssysteemblokken. Als een bestandssysteem (zoals de rootpartitie) bijna vol is, dan kan het verrichten van een grote update, zoals <code>make installworld</code>, ertoe leiden dat het bestandssysteem ruimtegebrek krijgt en dat daardoor de operatie mislukt.</p></div><div class=sect4><h5 id=_meer_over_softupdates>12.13.2.1. Meer over softupdates<a class=anchor href=#_meer_over_softupdates></a></h5><div class=paragraph><p>Er zijn traditioneel twee methodes om de metagegevens van een bestandssysteem terug naar de schijf te schrijven. Het bijwerken van metagegevens houdt het bijwerken van van niet-inhoudelijke gegevens zoals inodes of mappen in.</p></div><div class=paragraph><p>Historisch gezien was het gebruikelijk om updates aan metagegevens synchroon weg te schrijven. Als een map bijvoorbeeld gewijzigd was, wachtte het systeem totdat de verandering daadwerkelijk naar de schijf geschreven was. De gegevensbuffers (de inhoud van een bestand) werden doorgeschoven naar de buffercache en op een later moment asynchroon op de schijf opgeslagen. Het voordeel van deze benadering is dat ze altijd veilig is. Als het systeem faalt tijdens het bijwerken, zijn de metagegevens nog altijd consistent. Een bestand kan volledig gecreëerd zijn of helemaal niet. Als de gegevensblokken van een bestand nog niet van de buffercache naar de schijf geschreven zijn ten tijde van de crash, is <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> in staat om dit te herkennen en het bestandssysteem te repareren door de lengte van het bestand nul te maken. Deze implementatie is ook helder en eenvoudig. Het nadeel is echter dat het wijzigen van metagegevens een traag proces is. Een <code>rm -r</code> benadert bijvoorbeeld alle bestanden in een map sequentiëel, maar elke mapverandering (verwijderen van een bestand) wordt synchroon naar de schijf geschreven. Dit omvat ook het bijwerken van de map zelf, van de inodetabel en mogelijk ook van indirecte blokken die voor het bestand in kwestie zijn gealloceerd. Gelijksoortige processen spelen zich af bij een commando als <code>tar -x</code>, waarbij een grote bestandshiëearchie wordt uitgepakt.</p></div><div class=paragraph><p>De tweede mogelijkheid is om het bijwerken van metagegevens asynchroon weg te schrijven. Dit is standaard in Linux®/ext2fs en als een *BSD UFS-bestandssysteem met <code>mount -o async</code> aangekoppeld is, is de werking hetzelfde. Alle bijwerkingen aan metagegevens worden eenvoudigweg doorgegeven aan de buffercache en vermengd met inhoudelijke updates van de bestandsgegevens. Het voordeel is een grote winst aan snelheid, omdat er niet telkens gewacht hoeft te worden op het bijwerken van metagegevens tot deze daadwerkelijk naar de schijf geschreven zijn. De implementatie is ook in dit geval helder en eenvoudig. Het grote nadeel is uiteraard dat er geen enkele garantie is voor de consistentie van het bestandssysteem. Als het systeem faalt tijdens een operatie waarbij veel metagegevens worden bijgewerkt (bijvoorbeeld door een stroomstoring of iemand drukt op de resetknop), blijft het bestandssysteem in een onvoorspelbare toestand achter. Er is geen mogelijkheid om de toestand van het bestandssysteem te onderzoeken als het systeem weer opstart, want de gegevensblokken van een bestand kunnen al weggeschreven zijn geweest terwijl het wegschrijven van bijwerkingen aan de inodetabel of de bijhorende map nog niet plaats heeft gevonden. Het is zelfs onmogelijk om een <code>fsck</code> te implementeren die de overgebleven chaos kan opruimen: de benodigde informatie is gewoon niet volledig aanwezig op de schijf. Als een bestandssysteem op deze manier onherstelbaar beschadigd is, is de enige optie <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> te gebruiken en vervolgens te herstellen van een back-up.</p></div><div class=paragraph><p>De gebruikelijke oplossing voor dit probleem is het implementeren van <em>dirty region logging</em>, ook wel <em>journaling</em> genoemd, hoewel deze term niet consistent gebruikt wordt en soms ook wordt gebruikt voor andere vormen van transactielogging. Het bijwerken van metagegevens wordt nog steeds synchroon geschreven, maar slechts naar een klein gebied van de schijf. Later worden ze dan naar de juiste locatie verplaatst. Omdat het loggebied klein is, hoeven de koppen van de schijf zelfs tijdens schrijfintensieve operaties nog maar over een kleine fysieke afstand te bewegen en door deze snellere respons zijn dit soort operaties sneller dan op de traditionele manier. De extra complexiteit van de implementatie is nogal beperkt, dus het risico van introductie van extra bugs valt mee. Een nadeel is dat alle metagegevens tweemaal geschreven worden (eerst naar het loggebied en later nog eens naar de definitieve locatie). Dus bij normaal gebruik kan er sprake zijn van wat men wel noemt een "performance pessimization". Anderzijds kunnen in geval van een crash alle nog uitstaande metagegevensoperaties snel worden teruggedraaid of vanuit het loggebied alsnog worden afgemaakt wanneer de machine weer opstart. Het bestandssysteem start dan snel op.</p></div><div class=paragraph><p>Kirk McKusick, de vader van het Berkeley FFS, loste dit probleem op met softupdates, wat betekent dat alle uitstaande acties voor het bijwerken van metagegevens in het geheugen bewaard worden en dan geordend naar de schijf geschreven worden. Dit heeft het gevolg dat in geval van intensieve operaties met betrekking tot metagegevens, latere bijwerkingen aan een item eerdere bewerkingen opvangen ("catch") als deze nog in het geheugen zitten en nog niet weggeschreven waren. Dus alle operaties, op bijvoorbeeld een map, worden in het algemeen eerst in het geheugen uitgevoerd voordat er wordt bijgewerkt naar schijf. De gegevensblokken worden geordend conform hun positie, zodat ze nooit weggeschreven worden voordat hun metagegevens geschreven zijn. Als het systeem een crash ondervindt, veroorzaakt dat impliciet het terugdraaien van uitstaande operaties ("log rewind"): alle operaties die nog niet weggeschreven waren lijken nooit gebeurd te zijn. Zo wordt een consistent bestandssysteem in stand gehouden dat eruit ziet alsof het 30 tot 60 seconden eerder was. Het gebruikte algoritme garandeert dat alle bronnen die in gebruik zijn als zodanig gemarkeerd worden in hun daarvoor geschikte bitmaps: blokken en inodes. Na een crash is de enige allocatiefout die kan optreden dat bronnen gemarkeerd kunnen zijn als in gebruik ("used"), terwijl ze feitelijk alweer beschikbaar ("free") zijn. <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> herkent deze situatie en stelt dergelijke vrij te maken bronnen opnieuw beschikbaar. Het is volkomen veilig om na een crash te negeren dat het bestandssysteem niet schoon is en het tot aankoppelen te dwingen met <code>mount -f</code>. Om niet langer gebruikte bronnen vrij te maken moet later <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> uitgevoerd worden. Dit is dan ook het idee achter <em>background fsck</em>: op het moment dat het systeem aan het opstarten is, wordt er alleen een <em>snapshot</em> van het systeem bewaard. <code>fsck</code> kan later uitgevoerd worden. Alle bestandssystemen kunnen "dirty" aangekoppeld worden en het systeem kan gewoon verder opstarten naar meergebruikermodus. Vervolgens zijn er <code>fsck</code>s gepland die in de achtergrond draaien voor elk bestandssysteem dat niet schoon is en waarmee bezette bronnen vrijgegeven worden. Bestandssystemen die geen gebruik maken van softupdates moeten echter nog steeds gebruik maken van de normale <code>fsck</code> in de voorgrond.</p></div><div class=paragraph><p>Het voordeel van softupdates is dat operaties op metagegevens bijna net zo snel zijn als asynchrone updates (dat wil zeggen sneller dan met <em>logging</em>, waarbij de metagegevens keer op keer geschreven worden). Nadelen zijn de complexiteit van de code (wat een groter risico op bugs impliceert in een gebied dat bijzonder gevoelig is voor verlies van gebruikersgegevens) en een groter geheugenverbruik. Tevens moet de gebruiker wennen aan enkele eigenaardigheden. Na een crash lijkt de toestand van het bestandssysteem wat "ouder". In situaties waar de standaard synchrone benadering een aantal lege bestanden zou hebben achtergelaten na <code>fsck</code>, is het met softupdates juist zo dat dergelijke bestanden er helemaal niet zijn, omdat de metagegevens of de bestandsinhoud nooit naar de schijf zijn geschreven. Schijfruimte wordt pas vrijgegeven als de bijwerkingen aan metagegevens en inhoudelijke bestandsgegevens weggeschreven zijn, wat mogelijk pas enige tijd na het uitvoeren van <code>rm</code> plaatsvindt. Dit kan problemen veroorzaken als er grote hoeveelheden gegevens naar een bestandssysteem geschreven worden dat onvoldoende vrije ruimte heeft om alle bestanden twee keer te kunnen bevatten (bijvoorbeeld in <span class=filename>/tmp</span>).</p></div></div></div></div><div class=sect2><h3 id=configtuning-kernel-limits>12.14. Fijnafstemming van kernellimieten<a class=anchor href=#configtuning-kernel-limits></a></h3><div class=sect3><h4 id=file-process-limits>12.14.1. Bestandsproceslimieten<a class=anchor href=#file-process-limits></a></h4><div class=sect4><h5 id=kern-maxfiles>12.14.1.1. <code>kern.maxfiles</code><a class=anchor href=#kern-maxfiles></a></h5><div class=paragraph><p><code>kern.maxfiles</code> kan worden verhoogd of verlaagd, afhankelijk van de systeembehoeften. Deze variabele geeft het maximale aantal bestandsdescriptors op een systeem. Als de bestandsdescriptortabel vol is, toont de systeembuffer meerdere malen <code>file: table is full</code>, hetgeen achteraf te zien is met <code>dmesg</code>.</p></div><div class=paragraph><p>Elk geopend bestand, socket of fifo heeft een bestandsdescriptor. Een grote produktieserver kan makkelijk enige duizenden bestandsdescriptors nodig hebben, afhankelijk van het soort en aantal diensten die tegelijk draaien.</p></div><div class=paragraph><p>In oudere versies van FreeBSD werd de standaard waarde van <code>kern.maxfiles</code> afgeleid van de optie <code>maxusers</code> in het kernelconfiguratiebestand. <code>kern.maxfiles</code> groeit evenredig met de waarde van <code>maxusers</code>. Als een aangepaste kernel wordt gebouwd, is het een goed idee om deze kerneloptie in te stellen afhankelijk van het gebruikt van een systeem (maar niet te laag). Hoewel een produktieserver misschien niet 256 gelijktijdige gebruikers heeft, kunnen de benodigde systeembronnen het beste vergeleken worden met een grootschalige webserver.</p></div><div class=paragraph><p>De optie <code>maxusers</code> stelt de grootte van een aantal belangrijke systeemtabellen in. Dit aantal moet ruwweg gelijk zijn aan het aantal gebruikers dat verwacht wordt gelijktijdig van de machine gebruik te maken.</p></div><div class=paragraph><p>Vanaf FreeBSD 4.5 wordt <code>kern.maxusers</code> automatisch ingesteld tijdens het opstarten gebaseerd op de hoeveelheid beschikbare geheugen in het systeem en kan worden vastgesteld tijdens het draaien door te kijken naar de alleen-lezen sysctl <code>kern.maxusers</code>. Sommige configuraties hebben grotere of kleinere waarden nodig van <code>kern.maxusers</code>, deze kunnen worden gezet als een opstartvariabele. Waardes van 64, 128 en 256 zijn daarin niet ongewoon. We raden aan om niet boven de 256 te gaan tenzij er heel veel bestandsdescriptors benodigd zijn; veel van de aanpasbaare waarden die standaard worden bepaald door <code>kern.maxusers</code> kunnen individueel worden overschreven tijdens het opstarten en/of tijdens het draaien van het systeem in <span class=filename>/boot/loader.conf</span> (zie de handleiding <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> of <span class=filename>/boot/defaults/loader.conf</span> voor een paar aanwijzingen) of zoals elders beschreven in dit document.</p></div><div class=paragraph><p>Voor oudere versies stelt het systeem deze waarde zelf in als deze uitdrukkelijk op <code>0</code> is gezet. Als het gewenst is om deze waarde zelf aan te geven, wordt aangeraden om <code>maxusers</code> minstens op 4 te zetten, met name als het X Window systeem in gebruik is of als er software gecompileerd wordt. De reden hiervoor is dat de belangrijkste tabel die door <code>maxusers</code> ingesteld wordt, het maximum aantal processen is, dat ingesteld wordt op <code>20 + 16 * maxusers</code>, dus als <code>maxusers</code> op 1 ingesteld wordt, zijn er maar 36 gelijktijdige processen mogelijk, inclusief de ongeveer achttien processen die door het systeem tijdens het opstarten start en de ongeveer vijftien processen die waarschijnlijk aangemaakt worden door het opstarten van het X Window systeem. Zelfs een eenvoudige taak als het afbeelden van een hulppagina start negen processen op om de pagina te filteren, te decomprimeren en af te beelden. Als <code>maxusers</code> op 64 ingesteld wordt, zijn er 1044 gelijktijdige processen mogelijk, wat genoeg moet zijn voor bijna alle soorten gebruik. Als echter de gevreesde fout verschijnt als er geprobeerd wordt om een programma op te starten of als er een server gedraaid wordt met een groot aantal gelijktijdige gebruikers, zoals <code>ftp.FreeBSD.org</code>, kan het getal altijd verhoogd worden en kan de kernel opnieuw gebouwd worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>maxusers</code> stelt <em>geen</em> grens aan het aantal gebruikers dat zich op de machine kan aanmelden. Het stelt gewoon verschillende tabelgroottes in op redelijke waardes, uitgaande van het maximum aantal gebruikers dat waarschijnlijk de machine gebruikt en van het aantal processen dat elk van deze gebruikers zal draaien. Een sleutelwoord dat <em>wel</em> het aantal gelijktijdige aanmeldingen op afstand en X-terminalvensters begrensd is <a href=./#kernelconfig-ptys><code>pseudo-device pty 16</code></a>. In FreeBSD 5.X kan dit getal genegeerd worden omdat daar het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=pty&amp;sektion=4&amp;format=html">pty(4)</a> "auto-cloning" is. Er kan eenvoudig gebruik worden gemaakt van de regel <code>device pty</code> in het instellingenbestand.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_kern_ipc_somaxconn>12.14.1.2. <code>kern.ipc.somaxconn</code><a class=anchor href=#_kern_ipc_somaxconn></a></h5><div class=paragraph><p>De sysctl-variabele <code>kern.ipc.somaxconn</code> beparkt de grootte van de luisterwachtrij voor het accepteren van nieuwe TCP-verbindingen. De standaardwaarde van <code>128</code> is meestal te laag voor robuuste behandeling van nieuwe verbindingen in een zwaarbeladen webserveromgeving. Voor zulke omgevingen wordt aangeraden deze waarde te verhogen tot <code>1024</code> of hoger. De dienstdaemon beperkt misschien zelf de luisterwachtrij (bijvoorbeeld <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> of Apache), maar heeft vaak een mogelijkheid in een configuratiebestand de wachtrijgrootte aan te passen. Grote luisterwachtrijen zijn ook beter in het ontwijken van Ontzegging van Dienst () aanvallen.</p></div></div></div><div class=sect3><h4 id=nmbclusters>12.14.2. Netwerkbeperkingen<a class=anchor href=#nmbclusters></a></h4><div class=paragraph><p>De kerneloptie <code>NMBCLUSTERS</code> bepaalt het aantal netwerk-Mbufs dat beschikbaar is voor een systeem. Een veel bezochte server met een laag aantal Mbufs beperkt de mogelijkheden van FreeBSD. Elk cluster staat voor ongeveer 2 K geheugen, dus een waarde van 1024 stelt 2 megabyte aan kernelgeheugen voor, dat is gereserveerd voor netwerkbuffers. Een simpele berekening geeft aan hoeveel er nodig is. Stel dat een webserver met een maximum van 1000 simultane verbindingen voor elke verbinding 16 K aan ontvangstnetwerkbuffers en 16 K aan zendbuffers kost, dan is ongeveer 32 MB aan netbuffers nodig voor de webserver. Een goede vuistregel is te vermeniguldigen met twee, dus 2x32 MB / 2 KB = 64 MB / 2 kB = 32768. Voor machines met veel geheugen wordt 4096 tot 32768 aangeraden. Er moet in geen geval een arbitrair hoge waarde voor deze sysctl opgegeven worden, want dat kan leiden tot een crash tijdens het opstarten. Met de optie <code>-m</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=netstat&amp;sektion=1&amp;format=html">netstat(1)</a> kan het clustergebruik van het netwerk bekeken worden.</p></div><div class=paragraph><p>De loaderparameter <code>kern.ipc.nmbclusters</code> moet gebruikt worden om dit tijdens het opstarten toe te passen. Alleen voor oudere versies van FreeBSD is het nodig om de kerneloptie <code>NMBCLUSTERS</code> te gebruiken.</p></div><div class=paragraph><p>Voor drukke servers die extensief gebruik maken van de systeemaanroep <a href="https://man.freebsd.org/cgi/man.cgi?query=sendfile&amp;sektion=2&amp;format=html">sendfile(2)</a>, kan het nodig zijn het aantal <a href="https://man.freebsd.org/cgi/man.cgi?query=sendfile&amp;sektion=2&amp;format=html">sendfile(2)</a>-buffers te verhogen via de kerneloptie <code>NSFBUFS</code> of door de waarde in te stellen in <span class=filename>/boot/loader.conf</span> (in <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> staan details). Als er in de procestabel processen staan met een status <code>sfbufa</code> is dat een algemene indicator dat deze parameter aangepast moet worden. De sysctl-variabele <code>kern.ipc.nsfbufs</code> is alleen-lezen en laat zien op welke waarde deze kernelvariabele is ingesteld. Deze parameter schaalt engiszins met de variabele <code>kern.maxusers</code>, maar het kan nodig zijn om deze bij te stellen.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Zelfs als een socket als non-blocking gemarkeerd is, dan nog kan het aanroepen van <a href="https://man.freebsd.org/cgi/man.cgi?query=sendfile&amp;sektion=2&amp;format=html">sendfile(2)</a> op de non-blocking socket ertoe leiden dat er toch blokkade optreedt totdat er voldoende <code>struct sf_buf</code>'s vrijgemaakt zijn.</p></div></td></tr></tbody></table></div><div class=sect4><h5 id=_net_inet_ip_portrange>12.14.2.1. <code>net.inet.ip.portrange.*</code><a class=anchor href=#_net_inet_ip_portrange></a></h5><div class=paragraph><p>De sysctl-variabelen <code>net.inet.ip.portrange.*</code> bepalen welke reeks poortnummers automatisch gebonden wordt aan TCP- en UDP-sockets. Er zijn drie gebieden: een laag gebied, een (standaard) middengebied en een hoog gebied. De meeste netwerkprogramma’s gebruiken het standaardbereik, wat begrensd wordt door <code>net.inet.ip.portrange.first</code> en <code>net.inet.ip.portrange.last</code> met standaardwaarden van respectievelijk 1024 en 5000. Gebonden poortreeksen worden gebruikt voor uitgaande verbindingen en het is onder bepaalde omstandigheden mogelijk dat poorten op raken. Dit gebeurt meestal in het geval van een zwaar belaste webproxy. Poortbereik is niet van belang als vooral diensten draaien die zich bezighouden met inkomende verbindingen, zoals een normale webserver, of als het aantal uitgaande verbindingen beperkt is, zoals bij een mailrelay. Voor situaties waarin een tekort aan poorten dreigt, wordt aangeraden om <code>net.inet.ip.portrange.last</code> bescheiden op te hogen. Een waarde van <code>10000</code>, <code>20000</code> of <code>30000</code> is redelijk. Er moet ook rekening met effecten op firewalls gehouden worden als de poortreeks gewijzigd wordt. Sommige firewalls kunnen grote poortreeksen blokkeren, meestal de lagere poorten, en verwachten dat andere systemen hogere poorten gebruiken voor uitgaande verbindingen. Om deze reden wordt het niet aanbevolen om <code>net.inet.ip.portrange.first</code> te verlagen.</p></div></div><div class=sect4><h5 id=_tcp_bandbreedtevertragingsproduct_tcp_bandwidth_delay_product>12.14.2.2. TCP Bandbreedtevertragingsproduct (TCP Bandwidth Delay Product)<a class=anchor href=#_tcp_bandbreedtevertragingsproduct_tcp_bandwidth_delay_product></a></h5><div class=paragraph><p>De TCP-bandbreedtevertragingsproductlimitatie lijkt op TCP/Vegas in NetBSD. Het kan aangezet worden door de sysctl-variabele <code>net.inet.tcp.inflight.enable</code> de waarde <code>1</code> te geven. Het systeem tracht dan het bandbreedtevertragingssprodukt te berekenen voor elke verbinding en beperkt dan de hoeveelheid gegevens in de wachtrij naar het netwerk tot de hoeveelheid die vereist is om maximale doorvoer te kunnen handhaven.</p></div><div class=paragraph><p>Dit is nuttig bij gebruik van modems, Gigabit Ethernet of zelfs bij WAN-verbindingen met hoge snelheid (of elke andere verbinding met een groot bandbreedtevertragingsprodukt), in het bijzonder als ook windowschaling of een groot verzendwindow gebruikt wordt. Als deze optie aangezet wordt, dient ook <code>net.inet.tcp.inflight.debug</code> de waarde <code>0</code> te krijgen (geen debugging) en voor produktiegebruik kan het instellen van <code>net.inet.tcp.inflight.min</code> naar minstens <code>6144</code> voordeel opleveren. Het instellen van hoge minima kan effectief het beperken van bandbreedte ondermijnen, afhankelijk van de verbinding. De mogelijkheid tot limitering zorgt ervoor dat de hoeveelheid gegevens die opgebouwd wordt, in tussentijdse route- en switchwachtrijen verlaagd kan worden en tevens kan de hoeveelheid gegevens die opgebouwd wordt in de interfacewachtrij van de lokale host verlaagd worden. Met minder pakketten in wachtrijen kunnen interactieve verbindingen opereren met lagere <em>Round Trip</em> tijden, met name over langzame modems. Deze optie gaat alleen over datatransmissie (upload / serverkant) en heeft geen effect gegevensontvangst (download / cliëntkant).</p></div><div class=paragraph><p>Aanpassen van <code>net.inet.tcp.inflight.stab</code> wordt <em>niet</em> aangeraden. Deze parameter krijgt standaard een waarde van 20, wat 2 maximale pakketten opgeteld bij de bandbreedtevensterberekening representeert. Het extra venster is nodig om het algoritme stabiel te houden en om de reactietijd bij veranderende omstandigheden te verbeteren, maar het kan ook leiden tot langere pingtijden over langzame verbindingen (zonder het inflight-algoritme kan dit echter nog erger zijn). In dergelijke gevallen kan deze parameter misschien verlaagd worden naar 15, 10 of 5 en misschien moet voor het gewenste effect ook <code>net.inet.tcp.inflight.min</code> verlaagd worden (bijvoorbeeld naar 3500). Het verlagen van deze parameters moet pas in laatste instantie overwogen worden.</p></div></div></div><div class=sect3><h4 id=_virtueel_geheugen>12.14.3. Virtueel Geheugen<a class=anchor href=#_virtueel_geheugen></a></h4><div class=sect4><h5 id=_kern_maxvnodes>12.14.3.1. <code>kern.maxvnodes</code><a class=anchor href=#_kern_maxvnodes></a></h5><div class=paragraph><p>Een vnode is de interne representatie van een bestand of een map. Het verlagen van het aantal beschikbare vnodes voor het besturingssysteem leidt dus tot een daling van schijf-I/O. Normaliter wordt dit door het besturingssysteem afgehandeld en hoeft de instelling niet gewijzigd te worden. Im sommige gevallen kan schijf-I/O de beperkende factor zijn en kan het systeem alle beschikbare vnodes in gebruik hebben. Dan dient deze instelling gewijzigd te worden. De hoeveelheid inactief en beschikbaar RAM dient meegenomen te worden in de beslissing.</p></div><div class=paragraph><p>Het huidige aantal gebruikte vnodes kan als volgt bekeken worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl vfs.numvnodes</span>
vfs.numvnodes: 91349</code></pre></div></div><div class=paragraph><p>Om het maximale aantal vnodes weer te geven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.maxvnodes</span>
kern.maxvnodes: 100000</code></pre></div></div><div class=paragraph><p>Als het huidige aantal gebruikte vnodes dicht bij het maximale aantal ligt, is het verstandig om <code>kern.maxvnodes</code> op te hogen met 1.000. Ook <code>vfs.numvnodes</code> dient in de gaten gehouden te worden. Als de waarde weer tot aan het maximum stijgt, dan moet <code>kern.maxvnodes</code> verder opgehoogd worden. Er dient een verschuiving op te treden in het door <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> gerapporteerde geheugengebruik. Er hoort meer geheugen actief te zijn.</p></div></div></div></div><div class=sect2><h3 id=adding-swap-space>12.15. Wisselbestandruimte toevoegen<a class=anchor href=#adding-swap-space></a></h3><div class=paragraph><p>Hoe goed er ook gepland wordt, soms draait een systeem gewoon niet zoals verwacht. Een oorzaak hiervoor kan een tekort aan wisselbestandruimte zijn. Als blijkt dat er meer wisselbestandruimte nodig is, kan dat eenvoudig. Er zijn drie manieren om de totale ruimte beschikbaar als wisselbestand te vergroten: een nieuwe harde schijf toevoegen, swappen over NFS of een wisselbestand maken op een bestaande (UFS of andere) partitie.</p></div><div class=paragraph><p>Kijk voor informatie over het beveiligen van het wisselbestand, welke opties hiervoor bestaan, en waarom dit gedaan zou moeten worden in <a href=./#swap-encrypting>Het versleutelen van de wisselbestand ruimte</a> van het handboek.</p></div><div class=sect3><h4 id=new-drive-swap>12.15.1. Swap op een nieuwe of bestaande harde schijf<a class=anchor href=#new-drive-swap></a></h4><div class=paragraph><p>Een nieuwe harde schijf voor swap toevoegen geeft betere prestaties dan een partitie aan een bestaande schijf toevoegen. Het aanmaken van partities en harde schijven wordt uitgelegd in <a href=./#disks-adding>Schijven toevoegen</a>. <a href=#configtuning-initial>Initiële instellingen</a> bespreekt de overwegingen van partitie-indelingen en de grootte van swap-partities.</p></div><div class=paragraph><p>Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=swapon&amp;sektion=8&amp;format=html">swapon(8)</a> om een swap-partitie aan het systeem toe te voegen, bijvoorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># swapon /dev/ada1s1b</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Het is mogelijk om elke partitie te gebruiken die momenteel niet aangekoppeld is, zelfs als deze al gegevens bevat. Het gebruik van <a href="https://man.freebsd.org/cgi/man.cgi?query=swapon&amp;sektion=8&amp;format=html">swapon(8)</a> op een partitie die gegevens bevat zal deze gegevens overschrijven en vernietigen. Zorg ervoor dat de partitie die als swap toegevoegd wordt echt de bedoelde partitie is voordat <a href="https://man.freebsd.org/cgi/man.cgi?query=swapon&amp;sektion=8&amp;format=html">swapon(8)</a> gebruikt wordt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Voeg een regel toe aan <span class=filename>/etc/fstab</span> voor de partitie om deze swap-partitie automatisch toe te voegen tijdens het opstarten:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ada1s1b	none	swap	sw	0	0</pre></div></div><div class=paragraph><p>Raadpleeg <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> voor een uitleg over de regels in <span class=filename>/etc/fstab</span>.</p></div></div><div class=sect3><h4 id=nfs-swap>12.15.2. Swappen over NFS<a class=anchor href=#nfs-swap></a></h4><div class=paragraph><p>In het algemeen wordt swappen over NFS niet aangeraden behalve als het onmogelijk is om naar een lokale schijf te swappen. NFS-swappen wordt gelimiteerd door de hoeveelheid beschikbare bandbreedte en belast het de NFS-server.</p></div></div><div class=sect3><h4 id=create-swapfile>12.15.3. Wisselbestanden<a class=anchor href=#create-swapfile></a></h4><div class=paragraph><p>Het is mogelijk om een bestand aan te maken van een bepaalde grootte en dit als swap te gebruiken. In dit voorbeeld wordt een bestand van 64 MB gebruikt, <span class=filename>/usr/swap0</span>. Uiteraard kan een willekeurige naam gebruikt worden.</p></div><div class=exampleblock><div class=title>Voorbeeld 6. Een wisselbestand aanmaken op FreeBSD</div><div class=content><div class="olist arabic"><ol class=arabic><li><p>De kernel <span class=filename>GENERIC</span> bevat reeds het stuurprogramma voor geheugenschijven (<a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>) dat nodig is voor deze bewerking. Zorg ervoor dat tijdens het bouwen van een eigen kernel de volgende regel in uw configuratiebestand zit:</p><div class="literalblock programlisting"><div class=content><pre>device md</pre></div></div><div class=paragraph><p>Kijk voor meer informatie over het bouwen van een eigen kernel in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div></li><li><p>Het wisselbestand <span class=filename>/usr/swap0</span> aanmaken:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/usr/swap0 bs=1024k count=64</span></code></pre></div></div></li><li><p>De correcte rechten op <span class=filename>/usr/swap0</span> instellen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 0600 /usr/swap0</span></code></pre></div></div></li><li><p>Het wisselbestand opnemen in <span class=filename>/etc/rc.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>swapfile=&#34;/usr/swap0&#34;   # Instellen op naam van wisselbestand als hulpwisselbestand gewenst is</pre></div></div></li><li><p>De machine moet herstart worden of om het wisselbestand direct in te schakelen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /usr/swap0 -u 0  swapon /dev/md0</span></code></pre></div></div></li></ol></div></div></div></div></div><div class=sect2><h3 id=acpi-overview>12.16. Energie- en bronnenbeheer<a class=anchor href=#acpi-overview></a></h3><div class=paragraph><p>Het is belangrijk om hardwarebronnen op een efficiënte wijze te benutten. Voordat ACPI geïntroduceerd werd was het lastig en onflexibel om het energieverbruik en de thermische eigenschappen van een systeem te beheersen. De hardware werd beheerst de BIOS en dus had de gebruiker minder controle en zichtbaarheid in de energiebeheerinstellingen. Enige gelimiteerde configuratie was mogelijk via <em>Advanced Power Management (APM)</em>. Energie- en bronnenbeheer is een belangrijk onderdeel van moderne machines. Het besturingssysteem moet bijvoorbeeld systeemlimieten in de gaten houdt (en mogelijk een SMS sturen of iets dergelijks) als de systeemtemperatuur onverwacht toeneemt.</p></div><div class=paragraph><p>In dit deel van het FreeBSD handboek wordt uitgebreide informatie verschaft over ACPI. Aan het einde worden referenties geleverd naar meer leesmateriaal.</p></div><div class=sect3><h4 id=acpi-intro>12.16.1. Wat is ACPI?<a class=anchor href=#acpi-intro></a></h4><div class=paragraph><p>Advanced Configuration and Power Interface (ACPI) is een standaard die door een alliantie van producenten geschreven is, met als doel te voorzien in een standaardinterface voor hardwarebronnen- en energiebeheer. Een belangrijk element is dat het meer flexibiliteit en beheersmogelijkheden biedt aan het besturingssysteem (OS). Moderne systemen hebben de limieten van de huidige PNP-interfaces verder opgerekt dan wenselijk en misschien wel mogelijk was. ACPI is de directe opvolger van APM (Advanced Power Management). Centraal is het verleggen van hardwarebeheer en -monitoring naar de OS-laag in plaats van de zeer beperkte BIOS-laag.</p></div></div><div class=sect3><h4 id=acpi-old-spec>12.16.2. Tekortkomingen van APM<a class=anchor href=#acpi-old-spec></a></h4><div class=paragraph><p>Met de <em>Advanced Power Management (APM)</em> faciliteit kan het energieverbruik van een systeem geregeld worden op basis van de systeemactiviteit. Het APM-BIOS wordt geleverd door de systeemproducent of -verkoper en het is specifiek voor dat betreffende hardwareplatform. Een APM-stuurprogramma in het besturingssysteem regelt vervolgens de toegang tot de <em>APM Software Interface</em>, die het besturen van vermogensniveau mogelijk maakt. APM dient nog steeds gebruikt te worden met systemen die gefabriceerd zijn voor het jaar 2000.</p></div><div class=paragraph><p>Er zijn vier hoofdproblemen met APM te onderscheiden: ten eerste wordt het energiebeheer verricht door een BIOS (afhankelijk van producent) en het besturingssysteem heeft daar geen kennis van. De gebruiker die idle-time waarden instelt voor een harde schijf in het APM-BIOS is hier een voorbeeld van. Dan zal het BIOS de harde schijf langzamer kunnen laten draaien zonder dat het besturingssysteem de noodzaak ziet of het goedkeurt. Ten tweede: de APM-logica is ingebed in de BIOS, waardoor het buiten het besturingssysteem om opereert. Dit houdt in dat gebruikers problemen met hun APM-BIOS alleen kunnen verhelpen door een nieuw BIOS in het ROM te flashen, wat een gevaarlijke en mogelijk onherstelbare operatie is. Ten derde is APM een producent-specifieke technologie, in de zin dat er altijd een hoge mate van duplicatie zal zijn van al dan niet geslaagde pogingen om het wiel opnieuw uit te vinden en uiteraard ook van bugs. Er is geen enkele garantie dat het wegnemen van een bug door een producent ook een zelfde bug wegneemt bij een concurrent. Tenslotte is het van belang te weten dat de APM-BIOS in het algemeen gewoon te weing geheugen kon gebruiken om een ingewikkeld energiebeheer te kunnen implementeren. Laat staan dat deze goed aanpasbaar was aan veranderlijke doelstellingen voor de betreffende machine.</p></div><div class=paragraph><p><em>Plug-n-play BIOS (PNPBIOS)</em> was in veel situaties onbetrouwbaar. PNPBIOS is 16-bitstechnologie, dus het besturingssysteem moet 16-bit emulatie gebruiken om met PNPBIOS-methoden te kunnen samenwerken.</p></div><div class=paragraph><p>Het FreeBSD-stuurprogramma APM is gedocumenteerd in <a href="https://man.freebsd.org/cgi/man.cgi?query=apm&amp;sektion=4&amp;format=html">apm(4)</a>.</p></div></div><div class=sect3><h4 id=acpi-config>12.16.3. ACPI instellen<a class=anchor href=#acpi-config></a></h4><div class=paragraph><p>Het stuurprogramma <span class=filename>acpi.ko</span> wordt standaard geladen bij het opstarten door de <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> en hoeft <em>niet</em> gecompileerd te worden. De redenatie is dat er met modules gemakkelijker gewerkt kan worden, bijvoorbeeld een andere <span class=filename>acpi.ko</span> gebruiken zonder dat er een nieuwe kernel gebouwd moet worden. Dit heeft het voordeel dat testen eenvoudiger is. Een andere reden is dat het opstarten van ACPI nadat een systeem eenmaal volledig opgestart is meestal niet goed werkt. Mocht er hinder ondervonden worden, dan kan ACPI beter uitgeschakeld worden. Dit stuurprogramma kan niet gestopt worden als het eenmaal geladen is, omdat de systeembus het gebruikt voor allerlei interacties met hardware. ACPI kan uitgezet worden door het instellen van <code>hint.acpi.0.disabled="1"</code> in <span class=filename>/boot/loader.conf</span> of in de <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> prompt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>ACPI en APM kunnen niet samenleven en moeten afzonderlijk en exclusief gebruikt worden. De laatste die gestart wordt bepaalt of het stuurprogramma de ander wel of niet ziet.</p></div></td></tr></tbody></table></div><div class=paragraph><p>In haar eenvoudigste vorm kan ACPI gebruikt worden om het systeem in slaapmodus te zetten met <a href="https://man.freebsd.org/cgi/man.cgi?query=acpiconf&amp;sektion=8&amp;format=html">acpiconf(8)</a> met de vlag <code>-s</code> en een optie <code>1-5</code>. De meeste gebruikers hebben alleen <code>1</code> of <code>3</code> nodig. De optie <code>5</code> verricht een "soft-off", wat hetzelfde is als:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># halt -p</span></code></pre></div></div><div class=paragraph><p>Andere opties zijn mogelijk via <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>. Zie de handleidingen van <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=acpiconf&amp;sektion=8&amp;format=html">acpiconf(8)</a> voor meer informatie.</p></div></div></div><div class=sect2><h3 id=ACPI-debug>12.17. FreeBSD ACPI gebruiken en debuggen<a class=anchor href=#ACPI-debug></a></h3><div class=paragraph><p>ACPI is een totaal nieuwe manier om apparaten te ontdekken, om energieverbruik te beheren en om een gestandaardiseerde toegang te bieden tot allerlei apparaten die eerder via het BIOS beheerd werden. Er wordt voortdurend vooruitgang geboekt om ACPI op alle systemen te laten werken, maar bugs in de <em>ACPIMachine Language</em> (AML) bytecode van sommige moederborden, onvolledigheden in de subsystemen van de kernel van FreeBSD en bugs in de Intel® ACPI-CA interpreter blijven opduiken.</p></div><div class=paragraph><p>Deze tekst is bedoeld om u te helpen met het bijstaan van de FreeBSD ACPI beheerders met het vinden van de hoofdoorzaken van problemen die u opmerkt en met het debuggen en het vinden van een oplossing.</p></div><div class=sect3><h4 id=ACPI-submitdebug>12.17.1. Debuginformatie aanleveren<a class=anchor href=#ACPI-submitdebug></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voordat een probleem wordt gemeld, moet het zeker zijn dat de laatste BIOS versie draait en indien beschikbaar de geïntregeerde controller firmware versie.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Diegenen die meteen een probleem willen indienen, sturen de volgende informatie naar <a href=mailto:freebsd-acpi@FreeBSD.org></a><a href=mailto:freebsd-acpi@FreeBSD.org>freebsd-acpi@FreeBSD.org</a>:</p></div><div class=ulist><ul><li><p>Omschrijving van het foutieve gedrag, inclusief systeemtype en -model en alles wat de fout kan veroorzaken. Als het een nieuw fenomeen is, dan dient ook zo accuraat mogelijk aangegeven te worden wanneer de fout het eerst optrad.</p></li><li><p>De uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> van <code>boot -v</code>, inclusief foutmeldingen die gegenereerd worden als de fout optreedt.</p></li><li><p>De uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> van <code>boot -v</code> met ACPI uitgeschakeld, indien het uitzetten van ACPI het probleem oplost.</p></li><li><p>Uitvoer van <code>sysctl hw.acpi</code>. Dit is tevens een goede manier om uit te vinden welke ACPI-mogelijkheden een systeem heeft.</p></li><li><p>Een URL waar de <em>ACPISource Language</em> (ASL) gevonden kan worden. De ASL dient <em>niet</em> rechtstreeks naar de lijst gezonden te worden, omdat deze nogal groot kan zijn. Een kopie van een ASL kan gemaakt worden met het volgende commando:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># acpidump -dt &gt; naam-systeem.asl</span></code></pre></div></div><div class=paragraph><p>(Vervang uw aanmeldnaam door <span class=filename>$NAME</span> en producent/model door <span class=filename>$SYSTEM</span>. Bijvoorbeeld: <span class=filename>njl-FooCo6000.asl</span>)</p></div></li></ul></div><div class=paragraph><p>De meeste FreeBSD-programmeurs lezen de <a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT mailinglijst</a>, maar problemen gaan bij voorkeur ook naar <a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI mailinglijst</a> zodat ze zeker gezien worden. Het kan enige tijd duren voordat er antwoord komt, omdat deze mensen elders ook nog volledige banen hebben. Als de bug niet meteen duidelijk is, komt er waarschijnlijk en verzoek om een PR in te dienen via <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a>. Als er een PR moet worden opgesteld, dan dient alle hierboven gevraagde informatie vermeld te worden. Dit helpt om het probleem te kunnen volgen en oplossen. Het sturen van een PR zonder eerst <a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI mailinglijst</a> te mailen is niet wenselijk, aangezien men PRs gebruikt als herinnering van bestaande problemen, niet als rapportagesysteem. Mogelijk is een probleem al eens door iemand anders gemeld.</p></div></div><div class=sect3><h4 id=ACPI-background>12.17.2. Achtergrond<a class=anchor href=#ACPI-background></a></h4><div class=paragraph><p>ACPI is aanwezig op alle moderne computers die voldoen aan de ia32 (x86), ia64 (Itanium) of amd64 (AMD) architecturen. De volledige standaard heeft vele mogelijkheden zoals CPU-prestatiebeheer, energiebeheer, thermische zones, diverse batterijsystemen, ingebedde controllers en busnummering. De meeste systemen implementeren minder dan de volledige standaard. Een desktopsysteem implementeert bijvoorbeeld meestal alleen busnummering, terwijl laptops mogelijk ook koeling- en batterijbeheer ondersteunen. Laptops hebben ook suspend en resume (slapen en wakker worden) met hun eigen aanverwante comlexiteit.</p></div><div class=paragraph><p>Een ACPI-compliant systeem heeft verscheidene componenten. Het BIOS- en chipsetverkopers bieden verscheidene vaste tabellen aan zoals FADT in het geheugen die zaken als de APIC-afbeelding (gebruikt voor SMP), configuratieregisters, en eenvoudige configuratiewaarden specificeren. Ook wordt er een tabel van bytecode (de <em>Differentiated System Description Table</em> of DSDT) geleverd die een op een boomstructuur lijkende namespace biedt voor apparaten en methoden.</p></div><div class=paragraph><p>Het stuurprogramma ACPI moet de voorgedefinieerde tabellen verwerken, een interpreter voor de bytecode implementeren en apparaatstuurprogramma’s en de kernel aanpassen om informatie van het ACPI-subsysteem te accepteren. Intel® heeft een interpreter beschikbaar gesteld (ACPI-CA) die door FreeBSD en ook door Linux® en NetBSD gebruikt wordt. De ACPI-CA-broncode staat in <span class=filename>src/sys/contrib/dev/acpica</span>. De lijmcode die ACPI-CA laat werken met FreeBSD staat in <span class=filename>src/sys/dev/acpica/Osd</span>. Stuurprogramma’s die verscheidene ACPI-apparaten implementeren staan in <span class=filename>src/sys/dev/acpica</span>.</p></div></div><div class=sect3><h4 id=ACPI-comprob>12.17.3. Algemene problemen<a class=anchor href=#ACPI-comprob></a></h4><div class=paragraph><p>Wil ACPI goed werken, dan moeten alle onderdelen goed werken. Hieronder staan enkele algemene problemen in volgorde van hoe vaak ze optreden en enkele mogelijke oplossingen of manieren om de problemen te vermijden.</p></div><div class=sect4><h5 id=_muisproblemen>12.17.3.1. Muisproblemen<a class=anchor href=#_muisproblemen></a></h5><div class=paragraph><p>Soms doet een muis het niet bij het opstarten uit de slaapstand. Een bekend lapmiddel is het toevoegen van <code>hint.psm.0.flags="0x3000"</code> aan <span class=filename>/boot/loader.conf</span>. Als dat niet werkt, dan wordt aangeraden een bugrapport in te sturen, zoals eerder is beschreven.</p></div></div><div class=sect4><h5 id=_suspendresume>12.17.3.2. Suspend/resume<a class=anchor href=#_suspendresume></a></h5><div class=paragraph><p>ACPI heeft drie slaapstanden waarbij het geheugen (RAM) wordt ingezet. Dit zijn de STR-toestanden <code>S1</code>-<code>S3</code>, en nog een slaap-met-gebruik-van-harde-schijf toestand (<code>STD</code>) die <code>S4</code> heet. <code>S5</code> is "zacht uit" en is de normale status van een systeem als het is aangesloten maar niet is aangezet. <code>S4</code> kan feitelijk op twee manieren geïmplementeerd worden: <code>S4</code>BIOS is een slaapstand naar schijf met behulp van het BIOS en <code>S4</code>OS wordt volledig door het besturingssysteem geïmplenteerd.</p></div><div class=paragraph><p>als eerste dienen de <code>sysctl hw.acpi</code> items die iets met de slaapstand te maken hebben gecontroleerd te worden. Hieronder staan de resultaten voor een Thinkpad:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>hw.acpi.supported_sleep_state: S3 S4 S5
hw.acpi.s4bios: 0</code></pre></div></div><div class=paragraph><p>Dit betekent dat hier <code>acpiconf -s</code> gebruikt kan worden om <code>S3</code>, <code>S4</code>OS en <code>S5</code> te testen. Als <code>s4bios</code> gelijk was aan (<code>1</code>), dan zou er <code>S4</code>BIOS ondersteuning zijn in plaats van <code>S4</code>OS.</p></div><div class=paragraph><p>Als suspend/resume getest moet worden, dient, indien ondersteund, bij <code>S1</code> begonnen te worden. Deze toestand heeft de grootste kans om te werken, omdat deze niet veel stuurprogrammaondersteuning vereist. Niemand heeft nog <code>S2</code> geïmplementeerd, maar het is ongeveer hetzelfde als <code>S1</code>. Daarna wordt <code>S3</code> getest. Dit is het diepste STR-niveau en heeft uitgebreide ondersteuning van stuurprogramma’s nodig om hardware goed opnieuw te kunnen starten. Mochten er blokkades optreden, dan kan naar de <a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI mailinglijst</a> lijst gemaild worden. Er kan echter geen snelle oplossing verwacht worden, omdat er nog de nodige stuurprogramma’s/hardware liggen om getest en bewerkt te worden.</p></div><div class=paragraph><p>Een veelvoorkomend probleem met suspend/resume is dat veel apparaatstuurprogramma’s hun firmware, registers of apparaatgeheugen niet fatsoenlijk opslaan, herstellen, of herinitialiseren. Een eerste poging om het probleem te vinden omvat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl debug.bootverbose=1</span>
<span class=c># sysctl debug.acpi.suspend_bounce=1</span>
<span class=c># acpiconf -s 3</span></code></pre></div></div><div class=paragraph><p>Deze test emuleert de suspend/resume-cyclus van alle apparaten zonder daadwerkelijk naar de toestand <code>S3</code> te gaan. In sommige gevallen kunt u zo eenvoudig problemen vaststellen (bijvoorbeeld het verliezen van de firmware-toestand, timeout van de apparaatwaakhond, en steeds opnieuw iets proberen). Merk op dat het systeem niet werkelijk naar de toestand <code>S3</code> gaat, wat inhoudt dat apparaten geen spanning verliezen waardoor velen prima zullen werken zelfs als de suspend/resume-methoden geheel ontbreken, dit in tegenstelling tot de echte toestand <code>S3</code>.</p></div><div class=paragraph><p>Moeilijkere gevallen vereisen aanvullende hardware, dat is een serieële poort/kabel voor de serieële console of een Firewire poort/kabel voor <a href="https://man.freebsd.org/cgi/man.cgi?query=dcons&amp;sektion=4&amp;format=html">dcons(4)</a>, en vaardigheden in het debuggen van de kernel.</p></div><div class=paragraph><p>Om een probleem te kunnen isoleren helpt het om zoveel mogelijk stuurprogramma’s uit de kernel te halen. Als dit werkt, kan er teruggewerkt worden naar het stuurprogramma dat schuldig is aan het falen. Meestal vertonen binaire stuurprogramma’s als <span class=filename>nvidia.ko</span>, X11 beeldschermstuurprogramma’s en USB de meeste problemen, terwijl bijvoorbeeld Ethernet-interfaces meestal meteen goed werken. Als de stuurprogramma’s zonder problemen geladen en verwijderd kunnen worden, dan is dit te automatiseren door de juiste commando’s in <span class=filename>/etc/rc.suspend</span> en <span class=filename>/etc/rc.resume</span> te zetten. Er staat een voorbeeld (achter commentaartekens) voor het laden en verwijderen van een stuurprogramma. Als het beeldscherm er na wakker worden vreemd uitziet, kan geprobeerd worden <code>hw.acpi.reset_video</code> op nul te zetten. Met langere of kortere waarden voor <code>hw.acpi.sleep_delay</code> kan bekeken worden of dat helpt.</p></div><div class=paragraph><p>In geval van problemen is het ook een optie om een recente Linux® distibutie met ondersteuning voor ACPI support te starten en daarvan de suspend/resume ondersteuning op dezelfde hardware uit te proberen. Als het werkt met Linux®, dan is het waarschijnlijk een FreeBSD stuurprogrammaprobleem en als het mogelijk is uit te vinden over welk stuurprogramma het gaat, kan dat bijdragen aan het oplossen van het probleem. ACPI houdt zich in het algemeen niet bezig met andere stuurprogramma’s zoals geluid, ATA, enzovoort. Als er dus een echt probleem met een stuurprogramma is, dan is waarchijnlijk uiteindelijk ook nodig naar de <a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT mailinglijst</a> lijst te posten en naar de beheerder van het stuurprogramma. Voor degenen met moed is het vooral aan te raden een paar <a href="https://man.freebsd.org/cgi/man.cgi?query=printf&amp;sektion=3&amp;format=html">printf(3)</a>s in problematische stukken van een stuurprogramma te plaatsen voor debugging om na te gaan waar de resumefunctie precies hangt.</p></div><div class=paragraph><p>Tot slot kan geprobeerd worden om ACPI uit te zetten en in plaats daarvan APM aan te zetten. Als suspend/resume werkt met APM, is het wellicht verstandig het daarbij te houden, vooral met wat oudere apparatuur (voor 2000). Producenten hebben nogal wat tijd nodig gehad om ACPI ondersteuning goed te krijgen en voor oudere hardware is het waarschijnlijker dat er BIOS-problemen zijn met ACPI.</p></div></div><div class=sect4><h5 id=_systeem_hangt_tijdelijk_of_permanent>12.17.3.3. Systeem hangt (tijdelijk of permanent)<a class=anchor href=#_systeem_hangt_tijdelijk_of_permanent></a></h5><div class=paragraph><p>Meestal is het hangen van het systeem het gevolg van verloren interrupts of een interruptstorm. Chipsets kunnen een heleboel problemen hebben, afhankelijk van hoe het BIOS interrupts instelt voor het opstarten, of de APIC (MADT) tabel correct is en de routering van het <em>System Control Interrupt</em> (SCI).</p></div><div class=paragraph><p>Interruptstorms kunnen onderscheiden worden van verloren geraakte interrupts door de uitvoer van <code>vmstat -i</code> te controleren en de regel met <code>acpi0</code> goed te lezen. Als de teller in toenemende mate hoger staat dan enkele per seconde, dan is sprake van een interruptstorm. Als het systeem lijkt te hangen, is het wellicht nog mogelijk door te dringen tot de DDB (<span class=keyseq><kbd>CTRL</kbd>+<kbd>ALT</kbd>+<kbd>ESC</kbd></span>) en <code>show interrupts</code> uit te voeren.</p></div><div class=paragraph><p>De beste hoop in geval van interruptproblemen is om APIC-ondersteuning uit te zetten met <code>hint.apic.0.disabled="1"</code> in <span class=filename>loader.conf</span>.</p></div></div><div class=sect4><h5 id=_panics>12.17.3.4. Panics<a class=anchor href=#_panics></a></h5><div class=paragraph><p>Panics zijn relatief zeldzaam met ACPI en krijgen de hoogste prioriteit bij het oplossen. Eerst moeten de verschillende gebeurtenissen waarmee de panic (als mogelijk) te reproduceren is geïsoleerd worden en moet een backtrace gemaakt worden. <code>options DDB</code> dient aangezet te worden en er dient een seriële console (<a href=./#serialconsole-ddb>De debugger DDB gebruiken via de seriële verbinding</a>) of een <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> partitie te komen. In DDB is een backtrace te maken met <code>tr</code>. Als de backtrace handmatig opgeschreven moet worden, is het belangrijk dat in ieder geval de bovenste en onderste vijf (5) regels van de backtrace genoteerd worden.</p></div><div class=paragraph><p>Daarna dient getracht te worden het systeem te starten zonder ACPI. Als dat werkt, is het ACPI-subsysteem geïsoleerd en kunnen de verschillende <code>debug.acpi.disable</code>-waarden uitgeprobeerd worden. In <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a> staan enkele voorbeelden.</p></div></div><div class=sect4><h5 id=_systeem_slaat_aan_na_slaapstand_of_stop>12.17.3.5. Systeem slaat aan na slaapstand of stop<a class=anchor href=#_systeem_slaat_aan_na_slaapstand_of_stop></a></h5><div class=paragraph><p><code>hw.acpi.disable_on_poweroff="0"</code> kan uitgezet worden in <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a>. Hierdoor schakelt ACPI bepaalde gebeurtenissen tijdens het afsluitproces niet uit. Om dezelfde redenen moeten sommige systemen deze waarde altijd op <code>1</code> (standaard) hebben staan. In het algemeen lost dit een probleem op waarbij een systeem spontaan weer opkomt nadat het in slaapstand is gezet of geheel gestopt is.</p></div></div><div class=sect4><h5 id=_overige_problemen>12.17.3.6. Overige problemen<a class=anchor href=#_overige_problemen></a></h5><div class=paragraph><p>Als er nog andere problemen zijn met ACPI (met een docking station of apparaten niet gedetecteerd, enzovoort), dan kan een mail met beschijving naar de mailinglijst gezonden worden. Sommige zaken kunnen echter gerelateerd zijn aan delen van het ACPI-subsysteem die nog niet af zijn, dus het kan in sommige gevallen een tijd duren. Gebruikers moeten soms geduld en de bereidheid om eventuele patches uit te proberen hebben.</p></div></div></div><div class=sect3><h4 id=ACPI-aslanddump>12.17.4. ASL, <code>acpidump</code> en IASL<a class=anchor href=#ACPI-aslanddump></a></h4><div class=paragraph><p>Het grootste probleem is dat BIOS-producenten vaak incorrecte (of gewoon foutieve) bytecode leveren. Dit blijkt doorgaans uit kernelboodschappen als:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ACPI-1287: <span class=k>***</span> Error: Method execution failed <span class=o>[</span><span class=se>\\</span>_SB_.PCI0.LPC0.FIGD._STA] <span class=se>\\</span>
<span class=o>(</span>Node 0xc3f6d160<span class=o>)</span>, AE_NOT_FOUND</code></pre></div></div><div class=paragraph><p>Vaak kunnen dergelijke problemen geoplost worden door de BIOS bij te werken tot de laatste revisie. De meeste consoleberichten zijn onschuldig, maar als er andere problemen zijn, zoals batterijstatus die niet werkt, dan ligt het voor de hand te zoeken naar problemen in de AML-code. De bytecode die AML genoemd wordt, wordt gecompileerd van een broncodetaal ASL. Deze staat weer in een tabel DSDT. Met <a href="https://man.freebsd.org/cgi/man.cgi?query=acpidump&amp;sektion=8&amp;format=html">acpidump(8)</a> kan een kopie van de ASL gemaakt worden. Dan moeten zowel de opties <code>-t</code> (laat inhoud van vaste tabellen zien) als <code>-d</code> (disassembleer AML naar ASL) gebruikt worden. In <a href=#ACPI-submitdebug>Debuginformatie aanleveren</a> staat een voorbeeld.</p></div><div class=paragraph><p>De eenvoudigste eerste controle is de ASL-code opnieuw compileren en kijken of er foutmeldingen optreden. Waarschuwingen kunnen doorgaans genegeerd worden, maar fouten zijn bugs die er meestal toe leiden dat ACPI niet correct werkt. Om ASL te hercompileren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># iasl eigen.asl</span></code></pre></div></div></div><div class=sect3><h4 id=ACPI-fixasl>12.17.5. ASL repareren<a class=anchor href=#ACPI-fixasl></a></h4><div class=paragraph><p>Op langere termijn is het de bedoeling dat voor vrijwel elke machine ACPI werkt zonder enig ingrijpen van de gebruiker. Op dit moment wordt er echter nog gewerkt aan oplossingen voor veel voorkomende vergissingen die BIOS-producenten maken. De Microsoft® interpreter (<span class=filename>acpi.sys</span> en <span class=filename>acpiec.sys</span>) controleert niet strikt of het BIOS volledig aan de standaard voldoet, waardoor het voorkomt dat BIOS-makers die alleen testen onder Windows® bepaalde fouten in hun ASL nooit correct repareren. FreeBSD hoopt door te gaan met de identificatie en documentatie van welk niet-standaard gedrag precies wordt toegelaten door Microsoft®'s interpreter en te dit te repliceren zodat FreeBSD kan werken zonder dat gebruikers zich gedwongen zien om de ASL te repareren. Als een tijdelijke oplossing en om te helpen met het in kaart brengen van bepaald gedrag, kan de ASL handmatig gerepareerd worden. Mocht dit lukken, dan wordt erop aangedrongen een <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> van de oude en de nieuwe ASL te mailen, zodat het foutieve gedrag mogelijk in ACPI-CA kan worden verwerkt, waardoor andere gebruikers niet meer handmatig met hun ASL aan de gang hoeven.</p></div><div class=paragraph><p>Hieronder staat een lijst algemene foutmeldingen, hun oorzaken en hoe ze op te lossen:</p></div><div class=sect4><h5 id=_os_afhankelijkheden>12.17.5.1. _OS afhankelijkheden<a class=anchor href=#_os_afhankelijkheden></a></h5><div class=paragraph><p>Sommige AMLs gaan ervan uit dat de wereld enkel bestaat uit Windows® versies. FreeBSD kan zich voordoen als elk OS om te kijken of dit problemen oplost. Een gemakkelijke manier om dit te doen is <code>hw.acpi.osname="Windows 2001"</code> in te stellen in <span class=filename>/boot/loader.conf</span> of andere gelijksoortige strings die in een ASL staan.</p></div></div><div class=sect4><h5 id=_ontbrekende_return_opdrachten>12.17.5.2. Ontbrekende return-opdrachten<a class=anchor href=#_ontbrekende_return_opdrachten></a></h5><div class=paragraph><p>Sommige methoden hebben geen specifieke returnwaarde, zoals wel vereist wordt door de standaard. Hoewel ACPI-CA hier niets mee doet, heeft FreeBSD de mogelijkheid tot impliciete returns. Er kunnen ook expliciete return-opdrachten toegevoegd worden waar vereist, als het bekend is welke waarden teruggevoerd moeten worden. Om <code>iasl</code> te dwingen tot compilatie van ASL kan de schakeloptie <code>-f</code> gebruikt worden.</p></div></div><div class=sect4><h5 id=_de_standaard_aml_aanpassen>12.17.5.3. De standaard AML aanpassen<a class=anchor href=#_de_standaard_aml_aanpassen></a></h5><div class=paragraph><p>Nadat <span class=filename>eigen.asl</span> aangepast is, kan deze als volgt gecompileerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># iasl eigen.asl</span></code></pre></div></div><div class=paragraph><p>Met de optie <code>-f</code> is af te dwingen dat de AML gemaakt wordt, zelfs als er compileerfouten optreden. Sommige fouten (zoals ontbrekende return-opdrachten) worden automatisch opgelost door de interpreter.</p></div><div class=paragraph><p><span class=filename>DSDT.aml</span> is de standaardnaam voor het bestand dat door <code>iasl</code> wordt geproduceerd. Dit is in plaats van de foutieve versie uit het BIOS (die nog steeds aanwezig is in het flashgeneugen) te laden door <span class=filename>/boot/loader.conf</span> als volgt te wijzigen:</p></div><div class="literalblock programlisting"><div class=content><pre>acpi_dsdt_load=&#34;YES&#34;
acpi_dsdt_name=&#34;/boot/DSDT.aml&#34;</pre></div></div><div class=paragraph><p><span class=filename>DSDT.aml</span> moet in de map <span class=filename>/boot</span> staan.</p></div></div></div><div class=sect3><h4 id=ACPI-debugoutput>12.17.6. Debuguitvoer van ACPI verkrijgen<a class=anchor href=#ACPI-debugoutput></a></h4><div class=paragraph><p>Het stuurprogramma ACPI heeft een zeer flexibele debugfaciliteit. Er kan zowel een verzameling van subsystemen aangegeven worden als het niveau van uitvoerigheid. De te debuggen subsystemen worden aangegeven als lagen ("layers") en zijn opgedeeld in ACPI-CA-componenten (ACPI_ALL_COMPONENTS) en ACPI-hardware-ondersteuning (ACPI_ALL_DRIVERS). De uitvoerigheid van debuguitvoer wordt aangegeven als het niveau ("level") en gaat van CPI_LV_ERROR (alleen fouten rapporteren) tot ACPI_LV_VERBOSE (alles). Het niveau is een bitmasker en dus kunnen er meerdere opties tegelijk ingeschakeld worden (gescheiden door spaties). In de praktijk wordt wellicht een seriële console gebruikt om de uitvoer te loggen als deze zo omvangrijk is dat de console berichtbuffer vol loopt (misschien wel meerdere keren). Een complete lijst van de individuele lagen en niveaus staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a>.</p></div><div class=paragraph><p>Debuguitvoer staat standaard niet aan. Door <code>options ACPI_DEBUG</code> toe te voegen aan het bestand met kernelinstellingen als ACPI als de kernel is gebouwd, wordt het ingeschakeld. Door <code>ACPI_DEBUG=1</code> toe te voegen aan <span class=filename>/etc/make.conf</span> wordt het systeembreed ingeschakeld. Als ACPI als module wordt gebruikt (de normale situatie), dan hoeft slechts de module <span class=filename>acpi.ko</span> opnieuw gecompileerd te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /sys/modules/acpi/acpi</span>
 make clean
make <span class=nv>ACPI_DEBUG</span><span class=o>=</span>1</code></pre></div></div><div class=paragraph><p><span class=filename>acpi.ko</span> moet in <span class=filename>/boot/kernel</span> komen te staan en de gewenste debuglaag en het gewenste niveau van uitvoerigheid dienen toegevoegd te worden aan <span class=filename>loader.conf</span>. Hieronder een voorbeeld waarmee debuguitvoer wordt aangezet voor alle ACPI-CA-componenten en alle ACPI-hardware-stuurprogramma’s (CPU, LID, enzovoort. Het niveau van uitvoerigheid is het laagst mogelijke. Er worden alleen fouten gemeld.</p></div><div class="literalblock programlisting"><div class=content><pre>debug.acpi.layer=&#34;ACPI_ALL_COMPONENTS ACPI_ALL_DRIVERS&#34;
debug.acpi.level=&#34;ACPI_LV_ERROR&#34;</pre></div></div><div class=paragraph><p>Als de gezochte informatie wordt veroorzaakt door een specifieke gebeurtenis (bijvoorbeeld in en uit slaapstand gaan), dan kunnen wijzigingen aan <span class=filename>loader.conf</span> achterwege blijven en in plaats daarvan kan <code>sysctl</code> gebruikt worden om laag en niveau in te stellen na het opstarten en zo het systeem voor te bereiden op die specifieke gebeurtenis. De <code>sysctl</code>s hebben dezelfde namen als de parameters in <span class=filename>loader.conf</span>.</p></div></div><div class=sect3><h4 id=ACPI-References>12.17.7. Verwijzingen<a class=anchor href=#ACPI-References></a></h4><div class=paragraph><p>Meer informatie over ACPI staat op de volgende locaties:</p></div><div class=ulist><ul><li><p>De <a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI mailinglijst</a></p></li><li><p>De ACPI mailinglijst archieven <a href=http://lists.freebsd.org/pipermail/freebsd-acpi/>http://lists.freebsd.org/pipermail/freebsd-acpi/</a></p></li><li><p>De oude ACPI mailinglijst archieven <a href=http://home.jp.FreeBSD.org/mail-list/acpi-jp/>http://home.jp.FreeBSD.org/mail-list/acpi-jp/</a></p></li><li><p>De <a href=https://uefi.org/specifications#ACPI>ACPI specificatie</a></p></li><li><p>FreeBSD Handleidingen: <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi_thermal&amp;sektion=4&amp;format=html">acpi_thermal(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=acpidump&amp;sektion=8&amp;format=html">acpidump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=iasl&amp;sektion=8&amp;format=html">iasl(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=acpidb&amp;sektion=8&amp;format=html">acpidb(8)</a></p></li><li><p><a href=http://www.cpqlinux.com/acpi-howto.html#fix_broken_dsdt>DSDT debugging informatie</a>. (Gebruikt Compaq als voorbeeld, maar van algemeen nut).</p></li></ul></div></div></div></div></div><div class=sect1><h2 id=boot>Hoofdstuk 13. Het FreeBSD opstartproces<a class=anchor href=#boot></a></h2><div class=sectionbody><div class=sect2><h3 id=boot-synopsis>13.1. Overzicht<a class=anchor href=#boot-synopsis></a></h3><div class=paragraph><p>Het proces van het starten van de computer en het laden van het besturingssysteem wordt het "bootstrapproces" of simpelweg "booten" genoemd. Het FreeBSD opstartproces levert een grote mate van flexibiliteit doordat gewijzigd kan worden wat er gebeurt als het systeem start en geeft de mogelijkheid om te kiezen uit verschillende geïnstalleerde besturingssystemen op dezelfde computer of zelfs verschillende versies van hetzelfde besturingssysteem of geïnstalleerde kernel.</p></div><div class=paragraph><p>Dit hoofdstuk geeft gedetailleerde informatie over instellingen die gebruikt kunnen worden en hoe het FreeBSD opstartproces veranderd kan worden. Dit omvat alles wat er gebeurt totdat de FreeBSD kernel wordt geladen, gezocht heeft naar apparaten en <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> start. Dit vindt plaats als tijdens het booten de tekstkleur verandert van helder wit naar grijs.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Wat de onderdelen zijn van het FreeBSD bootstrap-systeem en hoe zij onderling communiceren;</p></li><li><p>De opties die meegegeven kunnen worden aan de componenten in de bootstrap om het proces te sturen;</p></li><li><p>Meer over <a href="https://man.freebsd.org/cgi/man.cgi?query=device.hints&amp;sektion=5&amp;format=html">device.hints(5)</a>;</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=title>Alleen voor x86</div><div class=paragraph><p>Dit hoofdstuk beschrijft alleen het opstartproces van FreeBSD dat draait op een Intel x86 systeem.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=boot-introduction>13.2. Het bootprobleem<a class=anchor href=#boot-introduction></a></h3><div class=paragraph><p>Het aanzetten van een computer en het starten van het besturingssysteem zorgt voor een interessant dilemma. Vast staat dat een computer niet weet wat hij moet doen totdat het besturingssysteem gestart is. Daar valt ook het starten van programma’s op schijf onder. Dus als een computer geen programma van schijf kan starten zonder besturingssysteem en het besturingssysteem staat op schijf, hoe wordt het besturingssysteem dan gestart?</p></div><div class=paragraph><p>Dit is een gelijksoortig probleem als dat in het boek De avonturen van Baron von Münchausen. Iemand is in een put gevallen en heeft zichzelf eruit gehaald door zijn laarsriempjes (bootstraps) vast te pakken en zich op te trekken. In het begin van het computertijdperk is de term <em>bootstrap</em> gegeven aan het mechanisme dat het besturingssysteem laadt. Later werd dit afgekort tot "booten".</p></div><div class=paragraph><p>Op x86 machines is het Basis Input/Output Systeem (BIOS) verantwoordelijk voor het laden van het besturingssysteem. Om dit te doen zoekt het BIOS op de harde schijf naar het Master Boot Record (MBR), dat op een vaste plek op de schijf staat. Het BIOS heeft voldoende kennis om het MBR te starten en gaat er vanuit dat de MBR de rest van de taken uitvoert die nodig zijn om het besturingssysteem te kunnen laden, mogelijk met hulp van het BIOS.</p></div><div class=paragraph><p>Aan de code binnen de MBR wordt meestal gerefereerd als een <em>bootmanager</em>, in het bijzonder als die interactie heeft met een gebruiker. In dit geval heeft de bootmanager meestal meer code in de eerste <em>track</em> van een schijf binnen het bestandssysteem van een besturingssysteem. Een bootmanager wordt soms ook <em>boot loader</em> genoemd, maar FreeBSD gebruikt die term voor een later stadium van het starten. Populaire bootmanagers zijn onder andere boot0 (ook bekend als Boot Easy, de standaard FreeBSD bootmanager), Grub, GAG en LILO (alleen boot0 past binnen de MBR.)</p></div><div class=paragraph><p>Als er maar één besturingssysteem en een schijf geïnstalleerd is, voldoet een standaard PC MBR. Dit MBR zoekt naar de eerste opstartbare (alias actieve) slice op schijf en start de code op deze slice om de rest van het besturingssysteem te laden. De MBR die standaard door <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> wordt geïnstalleerd is zo’n MBR. Die is gebaseerd op <span class=filename>/boot/mbr</span>.</p></div><div class=paragraph><p>Indien er meerdere besturingssystemen op schijven staan, kan er een andere bootmanager geïnstalleerd worden, een die een lijst toont met verschillende besturingssystemen en de mogelijkheid geeft om er één te kiezen dat opgestart moet worden. In de volgende paragrafen worden er twee beschreven.</p></div><div class=paragraph><p>Het resterende deel van het FreeBSD bootstrap-systeem is verdeeld in drie fases. De eerste fase wordt gestart door het MBR, dat net voldoende informatie heeft om de computer in een bepaalde toestand te zetten en de tweede fase te starten. De tweede fase kan net iets meer doen voordat hij de derde fase start. De derde fase voltooit het laden van het besturingssysteem. Dit proces is verdeeld in drie fases omdat de PC-standaarden grenzen stellen aan de grootte van programma’s die gedraaid kunnen worden in de eerste twee fases van dit proces. Door deze taken aan elkaar te koppelen krijgt FreeBSD een flexibeler laadgedeelte.</p></div><div class=paragraph><p>Daarna wordt de kernel gestart en begint met het zoeken naar en initialiseren van apparaten. Zodra het kernel-opstartproces klaar is, geeft de kernel de controle over aan het gebruikerproces <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a>, dat controleert of de schijven een bruikbare status hebben. Dan start <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> de instellingen op gebruikersniveau die de bestandssystemen mount, de netwerkkaarten instelt voor communicatie met het netwerk en in het algemeen worden de processen gestart die moeten draaien op een FreeBSD systeem bij het opstarten.</p></div></div><div class=sect2><h3 id=boot-blocks>13.3. De bootmanager en opstartstadia<a class=anchor href=#boot-blocks></a></h3><div class=sect3><h4 id=boot-boot0>13.3.1. De bootmanager<a class=anchor href=#boot-boot0></a></h4><div class=paragraph><p>De code in de MBR of bootmanager wordt soms ook wel <em>stage zero</em> van het opstartproces genoemd. In dit onderdeel worden twee eerder genoemde bootmanagers beschreven: boot0 en LILO.</p></div><div class=paragraph><p><strong>De boot0 bootmanager:</strong> De MBR die standaard door de FreeBSD installer of <a href="https://man.freebsd.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8&amp;format=html">boot0cfg(8)</a> wordt geïnstalleerd is gebaseerd op <span class=filename>/boot/boot0</span>. Het programma boot0 is erg eenvoudig, omdat maar 446 bytes lang mag zijn vanwege de slicetabel en de <code>0x55AA</code> identificatie aan het einde van de MBR. Als de FreeBSD MBR is geïnstalleerd en er staan andere besturingssystemen op een harde schijf, dan is bij het opstarten een scherm te zien dat er ongeveer zo uitziet:</p></div><div id=boot-boot0-example class=exampleblock><div class=title>Voorbeeld 7. <span class=filename>boot0</span> schermafbeelding</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>F1 DOS
F2 FreeBSD
F3 Linux
F4 ??
F5 Drive 1

Default: F2</code></pre></div></div></div></div><div class=paragraph><p>Andere besturingssystemen, Windows® in het bijzonder, staan er om bekend dat zij bestaande MBRs overschrijven met die van zichzelf. Als dit is gebeurd of als het bestaande MBR vervangen moet worden door het FreeBSD MBR:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fdisk -B -b /boot/boot0 apparaat</span></code></pre></div></div><div class=paragraph><p>Waar <em>apparaat</em> het apparaat is waar de computer van boot, zoals <span class=filename>ad0</span> voor de eerste IDE-schijf <span class=filename>ad2</span> voor de eerste IDE-schijf op de tweede IDE-controller, <span class=filename>da0</span> voor de eerste SCSI-schijf, enzovoort. Als het wenselijk is een aangepaste instelling te gebruiken voor de MBR, dan kan <a href="https://man.freebsd.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8&amp;format=html">boot0cfg(8)</a> gebruikt worden.</p></div><div class=paragraph><p><strong>De LILO bootmanager:</strong> Start, om deze bootmanager te installeren zodat er ook FreeBSD mee gestart kan worden, eerst Linux® en voeg het volgende toe aan het bestaande instellingenbestand <span class=filename>/etc/lilo.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>other=/dev/hdXY
table=/dev/hdX
loader=/boot/chain.b
label=FreeBSD</pre></div></div><div class=paragraph><p>Geef in de bovenstaande regels de primaire partitie en schijf van FreeBSD op met Linux® instellingen, waarbij <em>X</em> vervangen wordt door de Linux® schijfletter en <em>Y</em> door het primaire partitienummer van Linux®. Wijzig bij gebruik van een SCSI-schijf <em>/dev/hd</em> in iets als <em>/dev/sd</em>. De regel <code>loader=/boot/chain.b</code> kan achterwege blijven als de besturingssystemen op dezelfde schijf staan. Voer daarna <code>/sbin/lilo -v</code> uit om de wijzigingen vast te leggen. Controleer het vastleggen door controle van de schermberichten.</p></div></div><div class=sect3><h4 id=boot-boot1>13.3.2. Fase één <span class=filename>/boot/boot1</span> en fase twee <span class=filename>/boot/boot2</span><a class=anchor href=#boot-boot1></a></h4><div class=paragraph><p>Conceptueel zijn de eerste en tweede fase onderdeel van hetzelfde programma op hetzelfde stukje schijf. Door ruimtebeperkingen zijn ze in twee stukken gesplitst. Ze worden echter altijd samen geïnstalleerd. Ze worden gekopieerd uit het gecombineerde bestand <span class=filename>/boot/boot</span> door het installatieprogramma of bsdlabel (zie verderop).</p></div><div class=paragraph><p>Ze staan buiten bestandssystemen in de eerste track van de opstartslice, beginnend bij de eerste sector. Dit is waar <a href=#boot-boot0>boot0</a> en iedere andere bootmanager een programma verwacht om door te gaan met het opstartproces. Het aantal gebruikte sectoren kan eenvoudig bepaald worden uit de grootte van <span class=filename>/boot/boot</span>.</p></div><div class=paragraph><p><span class=filename>boot1</span> is erg simpel omdat dit slechts 512 bytes groot kan zijn en net genoeg weet over het FreeBSD <em>bsdlabel</em>, dat informatie bevat over de slice om <span class=filename>boot2</span> te vinden en te starten.</p></div><div class=paragraph><p><span class=filename>boot2</span> is iets verfijnder en begrijpt het FreeBSD bestandssysteem genoeg om er bestanden op te vinden en geeft een simpele interface om de kernel of loader te kiezen die gestart moet worden.</p></div><div class=paragraph><p><span class=filename>boot2</span> start meestal de <a href=#boot-loader>loader</a>, doordat deze veel slimmer is en gebruikersvriendelijke opstartinstellingen heeft. Voorheen was het zijn taak direct de kernel te starten.</p></div><div id=boot-boot2-example class=exampleblock><div class=title>Voorbeeld 8. <span class=filename>boot2</span> schermafbeelding</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>&gt;&gt;</span> FreeBSD/i386 BOOT
Default: 0:ad<span class=o>(</span>0,a<span class=o>)</span>/boot/loader
boot:</code></pre></div></div></div></div><div class=paragraph><p>Als ooit eens de geïnstalleerde <span class=filename>boot1</span> en <span class=filename>boot2</span> vervangen moeten worden kan dat met <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># bsdlabel -B schijfslice</span></code></pre></div></div><div class=paragraph><p>In het voorbeeld hierboven is <em>schijfslice</em> de schijf en slice waarvan opgestart wordt, zoals <span class=filename>ad0s1</span> voor de eerste slice op de eerste IDE-schijf.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Gevaarlijk toegewijde modus</div><div class=paragraph><p>Als alleen een schijfnaam als <span class=filename>ad0</span> gebruikt wordt in <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> wordt er een gevaarlijk toegewijde schijf zonder slices gemaakt. Dit is niet aan te raden en daarom wordt aangeraden voor het uivoeren van <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> de commandoregel nog een keer te controleren voordat er op <kbd>Return</kbd> wordt gedrukt.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=boot-loader>13.3.3. Fase drie, <span class=filename>/boot/loader</span><a class=anchor href=#boot-loader></a></h4><div class=paragraph><p>De loader is de laatse fase van de drietraps-bootstrap en deze bevindt zich op het bestandssysteem, meestal als <span class=filename>/boot/loader</span>.</p></div><div class=paragraph><p>De loader is bedoeld als een gebruikersvriendelijke manier voor de instelling, door gebruik te maken van een makkelijke commandoverzameling, gesteund door een krachtige vertaler met een wat complexere commandoverzameling.</p></div><div class=sect4><h5 id=boot-loader-flow>13.3.3.1. Loader programmaverloop<a class=anchor href=#boot-loader-flow></a></h5><div class=paragraph><p>Tijdens de start zoekt de loader naar een console en schijven en kijkt van welke schijf er opgestart wordt. Variabelen worden hiernaar gezet en er wordt een vertaler gestart zodat gebruikercommando’s interactief of via een script kunnen worden doorgegeven.</p></div><div class=paragraph><p>Dan leest de loader <span class=filename>/boot/loader.rc</span>, die dan standaard <span class=filename>/boot/defaults/loader.conf</span> leest. Deze plaatst redelijke standaarden in variabelen en leest <span class=filename>/boot/loader.conf</span> voor lokale wijzigingen op deze variabelen. <span class=filename>loader.rc</span> reageert op deze variabelen door de geselecteerde modules en kernel te laden.</p></div><div class=paragraph><p>Als laatste wordt standaard door de loader 10 seconden gewacht op toetsinvoer en als dit niet wordt onderbroken laadt loader de kernel. Als het wel wordt onderbroken krijgt de gebruiker een prompt aangeboden die een eenvoudige commandoverzameling begrijpt. Hier kan de gebruiker variabelen wijzigen, alle modules stoppen en/of starten en uiteindelijk opstarten of herstarten.</p></div></div><div class=sect4><h5 id=boot-loader-commands>13.3.3.2. Ingebouwde loadercommando’s<a class=anchor href=#boot-loader-commands></a></h5><div class=paragraph><p>Hieronder worden de meest gebruikte loadercommando’s besproken. Een volledige omschrijving van alle beschikbare commando’s staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a>.</p></div><div class=dlist><dl><dt class=hdlist1>autoboot <em>seconden</em></dt><dd><p>Gaat door met het opstarten van de kernel als deze niet wordt onderbroken binnen de opgegeven tijd in seconden. Er wordt een aftelproces getoond dat standaard op 10 seconden staat.</p></dd><dt class=hdlist1>boot [-opties] [kernelnaam]</dt><dd><p>Start direct de kernel op met de opgegeven opties en naam, indien meegegeven. Het opgeven van een kernelnaam op de opdrachtregel is alleen van toepassing nadat een <em>unload</em>-commando is gegeven, anders wordt de kernel die hiervoor was geladen gebruikt.</p></dd><dt class=hdlist1>boot-conf</dt><dd><p>Doorloopt hetzelfde automatische instellen van modules gebaseerd op variabelen zoals ook gebeurt bij het opstarten. Dit is alleen zinnig als eerst <code>unload</code> is gebruikt en enkele variabelen zijn gewijzigd, meestal <code>kernel</code>.</p></dd><dt class=hdlist1>help [onderwerp]</dt><dd><p>Toont documentatie uit <span class=filename>/boot/loader.help</span>. Als het opgegeven onderwerp <code>index</code> is, wordt een lijst met beschikbare onderwerpen getoond.</p></dd><dt class=hdlist1>include <em>bestandsnaam</em> …​</dt><dd><p>Verwerkt het bestand met de opgegeven naam. Het bestand wordt ingelezen en regel voor regel vertaald. Iedere foutmelding stopt direct het include-commando.</p></dd><dt class=hdlist1>load [-t type] <em>bestandsnaam</em></dt><dd><p>Laadt de kernel, kernel-module of bestand van opgegeven type en naam. Ieder argument achter de bestandsnaam wordt doorgegeven aan het bestand.</p></dd><dt class=hdlist1>ls [-l] [padnaam]</dt><dd><p>Toont de lijst bestanden in het opgegeven pad of van de rootmap als geen pad wordt opgegeven. Als <code>-l</code> wordt meegegeven wordt ook de bestandsgrootte weergegeven.</p></dd><dt class=hdlist1>lsdev [-v]</dt><dd><p>Toont de lijst met alle apparaten waarvan het mogelijk is om modules te kunnen laden. Als <code>-v</code> wordt meegegeven worden meer details getoond.</p></dd><dt class=hdlist1>lsmod [-v]</dt><dd><p>Toont geladen modules. Als <code>-v</code> wordt meegegeven worden meer details getoont.</p></dd><dt class=hdlist1>more <em>bestandsnaam</em></dt><dd><p>Toont de inhoud van het opgegeven bestand met een pauze na iedere <code>LINES</code> regels.</p></dd><dt class=hdlist1>reboot</dt><dd><p>Herstart het systeem onmiddelijk.</p></dd><dt class=hdlist1>set <em>variabele</em></dt><dd><p>Vult de omgevingsvariabele van de loader.</p></dd><dt class=hdlist1>unload</dt><dd><p>Verwijdert alle geladen modules.</p></dd></dl></div></div><div class=sect4><h5 id=boot-loader-examples>13.3.3.3. Loader voorbeelden<a class=anchor href=#boot-loader-examples></a></h5><div class=paragraph><p>Hier zijn wat practische voorbeelden van het gebruik van loader:</p></div><div class=ulist><ul><li><p>De kernel opstarten in single-user modus:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> boot <span class=nt>-s</span></code></pre></div></div></li><li><p>De gebruikelijke kernel en modules ontladen om daarna de oude (of een andere) kernel te laden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>unload
load kernel.old</code></pre></div></div><div class=paragraph><p><span class=filename>kernel.GENERIC</span> kan gebruikt worden als de algemene kernel die meegeleverd is bij de installatieschijf of <span class=filename>kernel.old</span> om de vorige geïnstalleerde kernel te gebruiken (als bijvoorbeeld de kernel is vervangen).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Zo worden de bekende modules geladen met een andere kernel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>unload
<span class=nb>set </span><span class=nv>kernel</span><span class=o>=</span><span class=s2>&#34;kernel.old&#34;</span>
boot-conf</code></pre></div></div></td></tr></tbody></table></div></li><li><p>Voor het laden van een kernelinstellingenscript (een script dat dingen doet die anders met de hand ingegeven zouden worden):</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> load <span class=nt>-t</span> userconfig_script /boot/kernel.conf</code></pre></div></div></li></ul></div></div><div class=sect4><h5 id=boot-splash>13.3.3.4. Splash-schermen tijdens het opstarten<a class=anchor href=#boot-splash></a></h5><div class=paragraph><p>Het splash-scherm creëert een visueel aantrekkelijker scherm in vergelijking met de originele opstartberichten. Dit scherm zal worden afgebeeld totdat een aanmeldprompt op de console verschijnt of een X-schermbeheerder een aanmeldprompt aanbiedt.</p></div><div class=paragraph><p>Er zijn twee basisomgevingen beschikbaar in FreeBSD. De eerste is de verouderde standaardomgeving met de opdrachtregel op de virtuële console. Nadat het systeem klaar is met opstarten, wordt er een aanmeldprompt op de console gepresenteerd. De tweede omgeving is de grafische omgeving van het X11 Bureaublad. Nadat <a href=./#x-install>X11</a> en één van de grafische <a href=./#x11-wm>bureaubladomgevingen</a>, zoals GNOME, KDE, of XFce zijn geïnstalleerd, kan het X11-bureaublad worden gestart door <code>startx</code> te gebruiken.</p></div><div class=paragraph><p>Sommige gebruikers verkiezen het grafische aanmeldscherm van X11 boven de traditionele op tekst gebaseerde aanmeldprompt. Schermbeheerders zoals XDM voor Xorg, gdm voor GNOME, en kdm voor KDE (en anderen van de Portscollectie) bieden een grafisch aanmeldscherm in plaats van de aanmeldprompt op het console. Na succesvol aanmelden bieden ze de gebruiker een grafisch bureaublad.</p></div><div class=paragraph><p>In de opdrachtregelomgeving zou het splash-scherm alle berichten over aftasten tijdens het opstarten en het starten van taken verbergen voordat het de aanmeldprompt laat zien. In een X11-omgeving zouden gebruikers een visueel overzichtelijkere opstartervaring krijgen dat meer lijkt op wat een gebruiker van een (Microsoft® Windows® of niet-Unix-systeem) zou ervaren.</p></div><div class=sect5><h6 id=boot-splash-function>13.3.3.4.1. Splash-schermfuncties<a class=anchor href=#boot-splash-function></a></h6><div class=paragraph><p>De splash-schermfunctie ondersteunt 256-kleuren-bitmaps ( <span class=filename>.bmp</span>), ZSoft PCX ( <span class=filename>.pcx</span>) en TheDraw (<span class=filename>.bin</span>) bestanden. Verder moeten de splash-afbeeldingsbestanden een resolutie van 320 bij 200 pixels of minder hebben om op de standaard VGA-adapters te werken.</p></div><div class=paragraph><p>Activeer de VESA-ondersteuning die in FreeBSD zit om grotere afbeeldingen, tot de maximale resolutie van 1024 bij 768 pixels, te gebruiken. Dit kan worden aangezet door de VESA-module tijdens het opstarten van het systeem te laden, of door de kernelconfiguratieoptie <code>VESA</code> toe te voegen en een eigen kernel te bouwen (zie <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>). De ondersteuning voor VESA geeft gebruikers de mogelijkheid om een splash-schermafbeelding af te beelden dat het hele scherm vult.</p></div><div class=paragraph><p>Zolang het splash-scherm wordt afgebeeld tijdens het opstartproces, kan het ten alle tijden worden uitgezet door op een toetsenbordtoets te drukken.</p></div><div class=paragraph><p>Het splash-scherm is standaard ook een schermbeveiliging buiten X11. Na een periode van inactiviteit zal het scherm in het splash-scherm veranderen en herhaald door stappen van het veranderen van de intensiteit van de afbeelding lopen, van helder tot zeer donker. Dit standaardgedrag van het splash-scherm (schermbeveiliging) kan overruled worden door een regel met <code>saver=</code> toe te voegen aan <span class=filename>/etc/rc.conf</span>. De optie <code>saver=</code> heeft verschillende ingebouwde schermbeveiligingen om uit te kiezen, de volledige lijst staat in de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=splash&amp;sektion=4&amp;format=html">splash(4)</a>. De standaard schermbeveiliging heet "warp". Merk op dat de optie <code>saver=</code> die in <span class=filename>/etc/rc.conf</span> is gespecificeerd alleen betrekking heeft op virtuele consoles. Het heeft geen effect op X11-schermbeheerders.</p></div><div class=paragraph><p>Enkele meldingen van de bootloader, inclusief de opties van het opstartmenu en een getimede wachtende aftelprompt worden afgebeeld tijdens het opstarten, zelfs als het splash-scherm aanstaat.</p></div><div class=paragraph><p>Voorbeelden van splash-schermen kunnen gedownload worden van de galerij op <a href=http://artwork.freebsdgr.org/node/3/>http://artwork.freebsdgr.org/</a>. Door de port <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/bsd-splash-changer/>sysutils/bsd-splash-changer</a> te installeren, kunnen de splash-afbeeldingen willekeurig elke keer dat er wordt opgestart uit een verzameling worden gekozen.</p></div></div><div class=sect5><h6 id=boot-splash-enable>13.3.3.4.2. De splash-schermfunctie aanzetten<a class=anchor href=#boot-splash-enable></a></h6><div class=paragraph><p>Het splash-schermbestand (<span class=filename>.bmp</span>, <span class=filename>.pcx</span> of <span class=filename>.bin</span>) moet op de rootpartitie staan, bijvoorbeeld in de map <span class=filename>/boot</span>.</p></div><div class=paragraph><p>Bewerk voor de standaardresolutie van het opstartscherm (256 kleuren, 320 bij 200 pixels, of minder) <span class=filename>/boot/loader.conf</span> zodat het volgende erin staat:</p></div><div class="literalblock programlisting"><div class=content><pre>splash_bmp_load=&#34;YES&#34;
bitmap_load=&#34;YES&#34;
bitmap_name=&#34;/boot/splash.bmp&#34;</pre></div></div><div class=paragraph><p>Bewerk <span class=filename>/boot/loader.conf</span> voor grotere videoresoluties (tot maximaal 1024 bij 768 pixels) zodat dit bestand het volgende bevat:</p></div><div class="literalblock programlisting"><div class=content><pre>vesa_load=&#34;YES&#34;
splash_bmp_load=&#34;YES&#34;
bitmap_load=&#34;YES&#34;
bitmap_name=&#34;/boot/splash.bmp&#34;</pre></div></div><div class=paragraph><p>Het bovenstaande neemt aan dat <span class=filename>/boot/splash.bmp</span> voor het splash-scherm wordt gebruikt. Wanneer een PCX-bestand gewenst is, dienen de volgende opdrachten gebruikt te worden, en afhankelijk van de resolutie de regel <code>vesa_load="YES"</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>splash_pcx_load=&#34;YES&#34;
bitmap_load=&#34;YES&#34;
bitmap_name=&#34;/boot/splash.pcx&#34;</pre></div></div><div class=paragraph><p>In versie 8.3 is een andere mogelijkheid het gebruik van ASCII-kunst in <a href=https://en.wikipedia.org/wiki/TheDraw>TheDraw</a> formaat.</p></div><div class="literalblock programlisting"><div class=content><pre>splash_txt=&#34;YES&#34;
bitmap_load=&#34;YES&#34;
bitmap_name=&#34;/boot/splash.bin&#34;</pre></div></div><div class=paragraph><p>De bestandsnaam is niet beperkt tot "splash" zoals in het bovenstaande voorbeeld. Het kan van alles zijn zolang het een van de bovenstaande types is, zoals <span class=filename>splash_640x400.bmp</span> of <span class=filename>bluewave.pcx</span>.</p></div><div class=paragraph><p>Enkele andere interessante opties voor <span class=filename>loader.conf</span>:</p></div><div class=dlist><dl><dt class=hdlist1><code>beastie_disable="YES"</code></dt><dd><p>Dit zal het menu met opstartopties niet weergeven, maar de getimede wachtende aftelprompt zal nog steeds aanwezig zijn. Zelfs zonder dat het menu met opstartopties wordt afgebeeld, zal het invoeren van een optie in de getimede wachtende aftelprompt de actie van de overeenkomstige opstartoptie uitvoeren.</p></dd><dt class=hdlist1><code>loader_logo="beastie"</code></dt><dd><p>Dit zal de standaardwoorden "FreeBSD", welke rechts van het menu met opstartopties worden afgebeeld vervangen door het gekleurde beastie-logo zoals vroegere uitgaven die hadden.</p></dd></dl></div><div class=paragraph><p>Raadpleeg voor meer informatie de handleidingpagina’s <a href="https://man.freebsd.org/cgi/man.cgi?query=splash&amp;sektion=4&amp;format=html">splash(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a>, en <a href="https://man.freebsd.org/cgi/man.cgi?query=vga&amp;sektion=4&amp;format=html">vga(4)</a>.</p></div></div></div></div></div><div class=sect2><h3 id=boot-kernel>13.4. Interactie met de kernel tijdens opstarten<a class=anchor href=#boot-kernel></a></h3><div class=paragraph><p>Zodra de kernel is geladen door de <a href=#boot-loader>loader</a> (zoals gewoonlijk) of door <a href=#boot-boot1>boot2</a> (zonder de loader), wordt er als ze er zijn gekeken naar de opstartvlaggen en wordt het gedrag zo nodig aangepast.</p></div><div class=sect3><h4 id=boot-kernel-bootflags>13.4.1. Opstartvlaggen kernel<a class=anchor href=#boot-kernel-bootflags></a></h4><div class=paragraph><p>De meest voorkomende opstartvlaggen:</p></div><div class=dlist><dl><dt class=hdlist1><code>-a</code></dt><dd><p>Vraag tijdens de opstart van de kernel om het apparaat dat gemount moet worden als root bestandssysteem.</p></dd><dt class=hdlist1><code>-C</code></dt><dd><p>Boot van cd-rom.</p></dd><dt class=hdlist1><code>-c</code></dt><dd><p>Start UserConfig om instellingen te maken voor de kernel tijdens het opstarten.</p></dd><dt class=hdlist1><code>-s</code></dt><dd><p>Start naar single-user modus.</p></dd><dt class=hdlist1><code>-v</code></dt><dd><p>Geef meer tekst en uitleg tijdens het opstarten van de kernel.</p></dd></dl></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In <a href="https://man.freebsd.org/cgi/man.cgi?query=boot&amp;sektion=8&amp;format=html">boot(8)</a> staan alle bootvlaggen beschreven.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=device-hints>13.5. Device hints<a class=anchor href=#device-hints></a></h3><div class=paragraph><p>Tijdens het opstarten van het systeem leest de boot <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> het bestand <a href="https://man.freebsd.org/cgi/man.cgi?query=device.hints&amp;sektion=5&amp;format=html">device.hints(5)</a>. Dit bestand slaat opstartinformatie voor de kernel op in variabelen, ook wel "device hints". Deze "device hints" worden door stuurprogramma’s gebruikt voor instelling van apparaten.</p></div><div class=paragraph><p>Device hints kunnen ook bij het <a href=#boot-loader>" Fase drie, <span class=filename>/boot/loader</span>"</a> prompt ingevoerd worden. Variabelen kunnen toegevoegd worden met behulp van <code>set</code>, verwijderd worden met <code>unset</code> en bekeken worden met <code>show</code>. Variabelen uit <span class=filename>/boot/device.hints</span> kunnen hier ook herroepen worden. Device hints die ingevoerd zijn bij de boot loader zijn niet permanent en zijn bij de volgende boot niet meer aanwezig.</p></div><div class=paragraph><p>Zodra het systeem opgestart is, kan <a href="https://man.freebsd.org/cgi/man.cgi?query=kenv&amp;sektion=1&amp;format=html">kenv(1)</a> gebruikt worden om alle variabelen te bekijken.</p></div><div class=paragraph><p>De schrijfwijze voor <span class=filename>/boot/device.hints</span> is één variabele per regel. Het standaard hekje "#" wordt gebruikt voor commentaar. Regels worden als volgt opgebouwd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> hint.driver.unit.keyword<span class=o>=</span><span class=s2>&#34;waarde&#34;</span></code></pre></div></div><div class=paragraph><p>De syntaxis voor de Fase 3 bootloader is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> <span class=nb>set </span>hint.driver.unit.keyword<span class=o>=</span>waarde</code></pre></div></div><div class=paragraph><p><code>driver</code> is de naam van het apparaatstuurprogramma, <code>unit</code> is het apparaatnummer van het stuurprogramma en <code>keyword</code> is het hint-sleutelwoord. Dit sleutelwoord kan uit de volgende opties bestaan:</p></div><div class=ulist><ul><li><p><code>at</code>: beschrijft de bus waarop het apparaat is aangesloten.</p></li><li><p><code>port</code>: beschrijft het startadres van de I/O die gebruikt wordt.</p></li><li><p><code>irq</code>: beschrijft het interrupt request nummer dat gebruikt wordt.</p></li><li><p><code>drq</code>: beschrijft het DMA kanaalnummer.</p></li><li><p><code>maddr</code>: beschrijft het fysieke geheugenadres dat gebruikt wordt door het apparaat.</p></li><li><p><code>flags</code>: zet verschillende vlagbits voor het apparaat.</p></li><li><p><code>disabled</code>: is <code>1</code> als het apparaat is uitgezet.</p></li></ul></div><div class=paragraph><p>Apparaatstuurprogramma’s kunnen hints die hier niet genoemd zijn accepteren (of eisen). Zie hiervoor de betreffende handleiding: <a href="https://man.freebsd.org/cgi/man.cgi?query=device.hints&amp;sektion=5&amp;format=html">device.hints(5)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=kenv&amp;sektion=1&amp;format=html">kenv(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a>.</p></div></div><div class=sect2><h3 id=boot-init>13.6. Init: start van procesbesturing<a class=anchor href=#boot-init></a></h3><div class=paragraph><p>Als de kernel klaar is met opstarten geeft die de besturing over aan het gebruikerproces <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a>, te vinden in <span class=filename>/sbin/init</span> of de padnaam die staat is in de variabele <code>init_path</code> in <code>loader</code>.</p></div><div class=sect3><h4 id=boot-autoreboot>13.6.1. Automatische herstart<a class=anchor href=#boot-autoreboot></a></h4><div class=paragraph><p>De automatische herstart ("Automatic Reboot Sequence") controleert of de beschikbare bestandssystemen betrouwbaar zijn. Als dat niet zo is en <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> kan de fouten niet repareren, dan brengt <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> het systeem terug naar <a href=#boot-singleuser>Single-user modus</a> voor de systeembeheerder, die het probleem dan directer kan aanpakken.</p></div></div><div class=sect3><h4 id=boot-singleuser>13.6.2. Single-user modus<a class=anchor href=#boot-singleuser></a></h4><div class=paragraph><p>Deze modus kan bereikt worden vanuit de <a href=#boot-autoreboot>Automatische herstart</a> of door de gebruiker die opstart met de optie <code>-s</code> of door de variabele <code>boot_single</code> aan te zetten in de <code>loader</code>.</p></div><div class=paragraph><p>Het kan ook door <a href="https://man.freebsd.org/cgi/man.cgi?query=shutdown&amp;sektion=8&amp;format=html">shutdown(8)</a> te starten zonder de optie reboot (<code>-r</code>) of halt (<code>-h</code>), vanuit <a href=#boot-multiuser>Multi-user modus</a>.</p></div><div class=paragraph><p>Als het systeem <code>console</code> op <code>insecure</code> staat in <span class=filename>/etc/ttys</span>, dan vraagt het systeem om het <code>root</code> wachtwoord voordat de single-user modus wordt gestart.</p></div><div id=boot-insecure-console class=exampleblock><div class=title>Voorbeeld 9. Onveilige console in <span class=filename>/etc/ttys</span></div><div class=content><div class="literalblock programlisting"><div class=content><pre># name  getty                           type    status          comments
#
# Als de console op &#34;insecure&#34; staat vraagt init om het root wachtwoord
# voor het naar single-user modus gaan.
console none                            unknown off insecure</pre></div></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Met een <code>insecure</code> console wordt bedoeld dat de fysieke beveiliging van het console niet goed is en dat alleen personen die het <code>root</code> wachtwoord kennen naar single-user modus mogen gaan. Het betekent niet dat het console onveilig wordt ingesteld. Als het veilig moet, wordt er dus voor <code>insecure</code> gekozen en niet voor <code>secure</code>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=boot-multiuser>13.6.3. Multi-user modus<a class=anchor href=#boot-multiuser></a></h4><div class=paragraph><p>Als <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> vindt dat het bestandssysteem in orde is of zodra de gebruiker klaar is in <a href=#boot-singleuser>Single-user modus</a>, gaat het systeem over naar multi-user modus, waarin het de resource configuration (broninstellingen) van het systeem start.</p></div><div class=sect4><h5 id=boot-rc>13.6.3.1. Bronconfiguratie (rc)<a class=anchor href=#boot-rc></a></h5><div class=paragraph><p>Het broninstellingensysteem leest de standaard instellingen in vanuit <span class=filename>/etc/defaults/rc.conf</span> en specifieke systeemdetails uit <span class=filename>/etc/rc.conf</span> en gaat daarna door met het mounten van de bestandssystemen voor het systeem die genoemd worden in <span class=filename>/etc/fstab</span>, start netwerkdiensten, start andere systeemdaemons en start als laatste de opstartscripts van lokaal geïnstalleerde packages.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> is een goede referentie voor het broninstellingensysteem. Dat zijn de scripts zelf natuurlijk ook.</p></div></div></div></div><div class=sect2><h3 id=boot-shutdown>13.7. Afsluitvolgorde<a class=anchor href=#boot-shutdown></a></h3><div class=paragraph><p>Bij een gecontroleerde shutdown met <a href="https://man.freebsd.org/cgi/man.cgi?query=shutdown&amp;sektion=8&amp;format=html">shutdown(8)</a> probeert <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> om het script <span class=filename>/etc/rc.shutdown</span> te starten en daarna aan alle processen het <code>TERM</code> signaal te sturen en eventueel het <code>KILL</code> signaal aan alle processen die niet op tijd zijn gestopt.</p></div><div class=paragraph><p>Om een FreeBSD machine uit te zetten die energiebeheer ondersteund, kan het commando <code>shutdown -p now</code> gegeven worden om gelijk de stroom af te schakelen. Als er herstart moet worden dan kan <code>shutdown -r now</code> gebruikt worden. De gebruiker die dit uitvoert moet wel <code>root</code> zijn of lid van de <code>operator</code> groep om <a href="https://man.freebsd.org/cgi/man.cgi?query=shutdown&amp;sektion=8&amp;format=html">shutdown(8)</a> te mogen gebruiken. <a href="https://man.freebsd.org/cgi/man.cgi?query=halt&amp;sektion=8&amp;format=html">halt(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=reboot&amp;sektion=8&amp;format=html">reboot(8)</a> kunnen ook gebruikt worden. Meer informatie is in de betreffende handleidingpagina’s te vinden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voor energiebeheer is <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a> ondersteuning in de kernel nodig of via een module die ingeladen moet worden.</p></div></td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=users>Hoofdstuk 14. Gebruikers- en basisaccountbeheer<a class=anchor href=#users></a></h2><div class=sectionbody><div class=sect2><h3 id=users-synopsis>14.1. Overzicht<a class=anchor href=#users-synopsis></a></h3><div class=paragraph><p>Met FreeBSD is het mogelijk een computer met meerdere gebruikers tegelijkertijd te gebruiken. Natuurlijk kan er op een zeker moment maar één gebruiker achter het scherm en toetsenbord zitten , maar er kan een groot aantal gebruikers zijn aangemeld via het netwerk om dingen met de computer te doen. Om een systeem te gebruiken moet een gebruiker een account hebben.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>De verschillen tussen de gebruikersaccounts op een FreeBSD systeem;</p></li><li><p>Hoe gebruikersaccounts toe te voegen;</p></li><li><p>Hoe gebruikersaccounts te verwijderen;</p></li><li><p>Hoe eigenschappen van accounts te wijzigen, zoals de volledige naam van de gebruiker of de voorkeursshell;</p></li><li><p>Hoe op een per account basis limieten in te stellen om het bronnengebruik van bijvoorbeeld geheugen en processortijd te reguleren voor accounts en accountgroepen;</p></li><li><p>Hoe groepen te gebruiken om accountbeheer te vereenvoudigen.</p></li></ul></div><div class=paragraph><p>Aangeraden voorkennis:</p></div><div class=ulist><ul><li><p>Basisbegrip van UNIX® en FreeBSD (<a href=./#basics>UNIX® beginselen</a>).</p></li></ul></div></div><div class=sect2><h3 id=users-introduction>14.2. Inleiding<a class=anchor href=#users-introduction></a></h3><div class=paragraph><p>Via accounts wordt alle toegang tot een systeem gegeven en alle processen worden door gebruikers gedraaid. Dus gebruikers en accountbeheer zijn van integraal belang op FreeBSD systemen.</p></div><div class=paragraph><p>Elke account op een FreeBSD systeem heeft een aantal informatievelden waarmee de account geïdentificeerd kan worden.</p></div><div class=dlist><dl><dt class=hdlist1>Gebruikersnaam</dt><dd><p>De gebruikersnaam, zoals die ingevoerd wordt bij het prompt <code>login:</code>. Gebruikersnamen moeten uniek zijn op een computer. Er mogen geen twee gebruikers zijn met dezelfde gebruikersnaam. Er horen een aantal regels bij het maken van geldige gebruikersnamen, die in <a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=5&amp;format=html">passwd(5)</a> staan beschreven. Gebruikersnamen bestaan gewoonlijk uit acht of minder karakters (geen hoofdletters).</p></dd><dt class=hdlist1>Wachtwoord</dt><dd><p>Bij ieder account hoort een wachtwoord. Het wachtwoord kan leeg zijn. Er is dan geen wachtwoord nodig om toegang te krijgen tot een systeem. Dit is meestal een slecht idee. Ieder account hoort een wachtwoord te hebben.</p></dd><dt class=hdlist1>Gebruikers ID (UID)</dt><dd><p>Het UID is een nummer, traditioneel van 0 tot 65535 , dat wordt gebruikt om een gebruiker op een systeem uniek te identificeren. Intern gebruikt FreeBSD het UID om gebruikers te identificeren. Voor alle FreeBSD commando’s waarin een gebruikersnaam wordt opgegeven, wordt eerst geconverteerd naar het UID voordat ermee gewerkt wordt. Dit betekent dat er verschillende accounts kunnen zijn met andere gebruikersnamen maar met hetzelfde UID. Wat FreeBSD betreft zijn al die accounts één gebruiker. Het is onwaarschijnlijk dat het ooit nodig is deze eigenschap te gebruiken.</p></dd><dt class=hdlist1>Groep ID (GID)</dt><dd><p>Het GID is een nummer, traditioneel van 0 tot 65535 , gebruikt om de primaire groep waartoe een gebruiker behoort, uniek te identificeren. Groepen zijn een methode waarmee toegang tot bronnen beheerst kan worden, gebaseerd op het GID van een gebruiker in plaats van op een UID. Hiermee kan het aantal instellingen in bepaalde bestanden aanzienlijk verkleind worden. Een gebruiker kan lid zijn van meer dan één groep.</p></dd><dt class=hdlist1>Aanmeldklasse</dt><dd><p>Aanmeldklassen zijn een uitbreiding op het groepenmechanisme waarmee additionele flexibiliteit wordt geboden bij het aanpassen van een systeem op verschillende gebruikers.</p></dd><dt class=hdlist1>Wijzigingstijd wachtwoord</dt><dd><p>Standaard dwingt FreeBSD gebruikers niet tot het periodiek wijzigen van hun wachtwoord. Dit kan wel per gebruiker afgedwongen worden, zodat sommige of alle gebruikers hun wachtwoord na een bepaalde periode moeten wijzigen.</p></dd><dt class=hdlist1>Verloopdatum account</dt><dd><p>Standaard verlopen accounts op FreeBSD niet. Als er accounts gemaakt worden waarvan bekend is dat ze maar een beperkte tijd nodig zijn, bijvoorbeeld op een school waar accounts bestaan voor studenten, dan kan er aangegeven worden wanneer een account verloopt. Nadat de verloopdatum is verstreken kan de account niet meer gebruikt worden om aan te melden op een systeem, hoewel de mappen en bestanden van de account nog wel blijven bestaan.</p></dd><dt class=hdlist1>Volledige gebruikersnaam</dt><dd><p>De gebruikersnaam identificeert de account uniek voor FreeBSD, maar die geeft niet zonder meer de echte naam van de gebruiker weer. Deze informatie kan aan de account gekoppeld worden.</p></dd><dt class=hdlist1>Thuismap</dt><dd><p>De thuismap is het volledige pad naar een map op een systeem waar de gebruiker start als die aanmeldt op een systeem. Het is de gewoonte dat alle thuismappen voor gebruikers onder <span class=filename>/home/gebruikersnaam</span> of <span class=filename>/usr/home/gebruikersnaam</span> staan. Gebruikers slaan hun persoonlijke bestanden op in hun thuismap en in mappen die daaronder worden gemaakt.</p></dd><dt class=hdlist1>Gebruikersshell</dt><dd><p>De shell biedt een standaardomgeving waarmee gebruikers met een systeem werken. Er zijn vele shells en ervaren gebruikers hebben hun eigen voorkeuren, die hun weerslag kunnen hebben in hun accountinstellingen.</p></dd></dl></div><div class=paragraph><p>Er zijn drie hoofdtypen accounts: de <a href=#users-superuser>Superuser</a>, <a href=#users-system>systeemgebruikers</a> en <a href=#users-user>gebruikersaccounts</a>. De Superuser account, die meestal <code>root</code> heet, wordt gebruikt om een systeem te beheren zonder beperkingen. Systeemgebruikers kunnen diensten draaien. Tenslotte kunnen gebruikersaccounts gebruikt worden door echte personen, die aanmelden, email lezen, enzovoort.</p></div></div><div class=sect2><h3 id=users-superuser>14.3. Het superuser-account<a class=anchor href=#users-superuser></a></h3><div class=paragraph><p>De superuser account, die meestal <code>root</code> heet, is al ingesteld om gebruikt te worden voor systeembeheer en hoort niet gebruikt te worden voor dagelijkse werkzaamheden, zoals het sturen en ontvangen van email, het verkennen van het systeem of programmeren.</p></div><div class=paragraph><p>Dit omdat de Superuser, anders dan gewone gebruikersaccounts, zonder beperkingen kan opereren en misbruik van een Superuser account kan resulteren in spectaculaire problemen. Gebruikersaccounts kunnen niet per ongeluk een systeem vernielen, dus het is aan te raden om wanneer maar mogelijk gewone gebruikersaccounts te gebruiken, tenzij de extra privileges noodzakelijk zijn.</p></div><div class=paragraph><p>Commando’s die als superuser worden uitgevoerd dienen altijd twee of drie keer gecontroleerd te worden voordat ze worden uitgevoerd, omdat een extra spatie of een missend karakter kan leiden tot niet terug te draaien dataverlies.</p></div><div class=paragraph><p>Als het niet al geregeld is, is het dus na het lezen van dit hoofdstuk aan te raden als eerste een gebruikersaccount zonder bijzondere rechten te maken voor de dagelijkse bezigheden. Dit geldt zowel als het gaat over een machine voor één gebruiker als wanneer het gaat over een machine voor meerdere gebruikers. Later in dit hoofdstuk wordt beschreven hoe additionele accounts gemaakt kunnen worden en hoe er tussen de normale gebruiker en de Superuser gewisseld kan worden.</p></div></div><div class=sect2><h3 id=users-system>14.4. Systeemaccounts<a class=anchor href=#users-system></a></h3><div class=paragraph><p>Systeemgebruikers draaien diensten, zoals DNS, mailservers, webservers, enzovoort. De reden hiervoor is beveiliging. Als alle diensten als Superuser zouden draaien, dan zouden ze zonder beperkingen kunnen opereren.</p></div><div class=paragraph><p>Voorbeelden van systeemgebruikers zijn <code>daemon</code>, <code>operator</code>, <code>bind</code> (voor de Domain Name Service), <code>news</code> en <code>www</code>.</p></div><div class=paragraph><p><code>nobody</code> is de generieke systeemgebruiker zonder bijzondere privileges. Het is wel belangrijk om ervan bewust te zijn dat hoe meer diensten <code>nobody</code> gebruiken, hoe meer bestanden en processen er bij die gebruiker horen en dat de gebruiker daardoor meer privileges kan krijgen.</p></div></div><div class=sect2><h3 id=users-user>14.5. Gebruikersaccounts<a class=anchor href=#users-user></a></h3><div class=paragraph><p>Gebruikersaccounts zijn het primaire middel dat echte gebruikers gebruiken om toegang te krijgen tot een systeem en die account schermen de gebruiker en de omgeving af, waardoor die gebruikers het systeem of andere gebruikers niet kunnen beschadigen en waardoor gebruikers hun omgeving kunnen aanpassen zonder invloed te hebben op anderen.</p></div><div class=paragraph><p>Iedereen die toegang heeft tot een systeem hoort een unieke gebruikersaccount te hebben. Hierdoor is het mogelijk uit te vinden wie wat aan het doen is, te voorkomen dat mensen elkaars instellingen kunnen verpesten of elkaars email kunnen lezen, enzovoort.</p></div><div class=paragraph><p>Iedere gebruiker kan zijn eigen omgeving instellen op een systeem, door andere shells, editors, toetsenbordinstellingen en taal te kiezen.</p></div></div><div class=sect2><h3 id=users-modifying>14.6. Accounts wijzigen<a class=anchor href=#users-modifying></a></h3><div class=paragraph><p>Er zijn vele commando’s beschikbaar in de UNIX® omgeving om gebruikersaccounts te manipuleren. De meest gebruikte commando’s worden hieronder beschreven, gevolgd door meer gedetailleerde voorbeelden van gebruik.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Commando</th><th class="tableblock halign-left valign-top">Samenvatting</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het aanbevolen commandoregelprogramma voor het aanmaken van nieuwe gebruikers.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=rmuser&amp;sektion=8&amp;format=html">rmuser(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het aanbevolen commandoregelprogramma voor het verwijderen van gebruikers.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een flexibel hulpprogramma voor het wijzigen van informatie in de gebruikersdatabase.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=1&amp;format=html">passwd(1)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een eenvoudig commandoregelprogramma voor het wijzigen van wachtwoorden van gebruikers.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een krachtig en flexibel hulpprogramma voor het wijzigen van alle aspecten van gebruikersaccounts.</p></td></tr></tbody></table><div class=sect3><h4 id=users-adduser>14.6.1. <code>adduser</code><a class=anchor href=#users-adduser></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a> is een eenvoudig programma voor het aanmaken van nieuwe gebruikers. Er worden regels mee toegevoegd aan de systeembestanden <span class=filename>passwd</span> en <span class=filename>group</span>. Het maakt ook een thuismap voor de nieuwe gebruiker, kopieert de standaard instellingenbestanden ("dotfiles") uit <span class=filename>/usr/shared/skel</span> en kan, optioneel, de nieuwe gebruiker een welkomstbericht mailen.</p></div><div class=exampleblock><div class=title>Voorbeeld 10. Een gebruiker toevoegen aan FreeBSD</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># adduser</span>
Username: jru
Full name: J. Random User
Uid <span class=o>(</span>Leave empty <span class=k>for </span>default<span class=o>)</span>:
Login group <span class=o>[</span>jru]:
Login group is jru. Invite jru into other <span class=nb>groups</span>? <span class=o>[]</span>: wheel
Login class <span class=o>[</span>default]:
Shell <span class=o>(</span>sh csh tcsh zsh nologin<span class=o>)</span> <span class=o>[</span>sh]: zsh
Home directory <span class=o>[</span>/home/jru]:
Home directory permissions <span class=o>(</span>Leave empty <span class=k>for </span>default<span class=o>)</span>:
Use password-based authentication? <span class=o>[</span><span class=nb>yes</span><span class=o>]</span>:
Use an empty password? <span class=o>(</span><span class=nb>yes</span>/no<span class=o>)</span> <span class=o>[</span>no]:
Use a random password? <span class=o>(</span><span class=nb>yes</span>/no<span class=o>)</span> <span class=o>[</span>no]:
Enter password:
Enter password again:
Lock out the account after creation? <span class=o>[</span>no]:
Username   : jru
Password   : <span class=k>****</span>
Full Name  : J. Random User
Uid        : 1001
Class      :
Groups     : jru wheel
Home       : /home/jru
Shell      : /usr/local/bin/zsh
Locked     : no
OK? <span class=o>(</span><span class=nb>yes</span>/no<span class=o>)</span>: <span class=nb>yes
</span>adduser: INFO: Successfully added <span class=o>(</span>jru<span class=o>)</span> to the user database.
Add another user? <span class=o>(</span><span class=nb>yes</span>/no<span class=o>)</span>: no
Goodbye!
<span class=c>#</span></code></pre></div></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het wachtwoord wat ingegeven wordt, wordt niet getoond, er worden ook geen sterretjes getoond. Zorg ervoor dat het wachtwoord correct ingevuld wordt.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=users-rmuser>14.6.2. <code>rmuser</code><a class=anchor href=#users-rmuser></a></h4><div class=paragraph><p>Met <a href="https://man.freebsd.org/cgi/man.cgi?query=rmuser&amp;sektion=8&amp;format=html">rmuser(8)</a> kan een gebruiker volledig van een systeem verwijderd worden. <a href="https://man.freebsd.org/cgi/man.cgi?query=rmuser&amp;sektion=8&amp;format=html">rmuser(8)</a> voert de volgende stappen uit:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Verwijdert de <a href="https://man.freebsd.org/cgi/man.cgi?query=crontab&amp;sektion=1&amp;format=html">crontab(1)</a> van de gebruiker (als die bestaat).</p></li><li><p>Verwijdert bestaande <a href="https://man.freebsd.org/cgi/man.cgi?query=at&amp;sektion=1&amp;format=html">at(1)</a> taken van de gebruiker.</p></li><li><p>Stopt alle processen van de gebruiker.</p></li><li><p>Verwijdert de gebruiker uit het lokale wachtwoordbestand van een systeem.</p></li><li><p>Verwijdert de thuismap van de gebruiker (als de gebruiker daar eigenaar van is).</p></li><li><p>Verwijdert de inkomende email voor de gebruiker uit <span class=filename>/var/mail</span>.</p></li><li><p>Verwijdert alle bestanden waar de gebruiker eigenaar van is uit opslaggebieden voor tijdelijke bestanden als <span class=filename>/tmp</span>.</p></li><li><p>Als laatste wordt de gebruikersnaam uit alle groepen in <span class=filename>/etc/group</span> waar die lid van was verwijderd.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als een groep leeg raakt en de groepsnaam is hetzelfde als de gebruikersnaam, dan wordt de groep verwijderd. Dit is het tegenovergestelde van wat <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a> met een unieke groep per gebruiker.</p></div></td></tr></tbody></table></div></li></ol></div></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=rmuser&amp;sektion=8&amp;format=html">rmuser(8)</a> kan niet gebruikt worden om superuser accounts te verwijderen, omdat dat vrijwel altijd leidt tot vreselijke verwoesting.</p></div><div class=paragraph><p>Standaard wordt een interactieve modus gebruikt, die ervoor zorgt dat alle stappen bewust worden genomen.</p></div><div class=exampleblock><div class=title>Voorbeeld 11. Interactief accounts verwijderen met <code>rmuser</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rmuser jru</span>
Matching password entry:
jru:<span class=k>*</span>:1001:1001::0:0:J. Random User:/home/jru:/usr/local/bin/zsh
Is this the entry you wish to remove? y
Remove user<span class=s1>&#39;s home directory (/home/jru)? y
Updating password file, updating databases, done.
Updating group file: trusted (removing group jru -- personal group is empty) done.
Removing user&#39;</span>s incoming mail file /var/mail/jru: <span class=k>done</span><span class=nb>.</span>
Removing files belonging to jru from /tmp: <span class=k>done</span><span class=nb>.</span>
Removing files belonging to jru from /var/tmp: <span class=k>done</span><span class=nb>.</span>
Removing files belonging to jru from /var/tmp/vi.recover: <span class=k>done</span><span class=nb>.</span>
<span class=c>#</span></code></pre></div></div></div></div></div><div class=sect3><h4 id=users-chpass>14.6.3. <code>chpass</code><a class=anchor href=#users-chpass></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a> wijzigt informatie in de gebruikersdatabase, zoals wachtwoorden, shells en persoonlijke informatie.</p></div><div class=paragraph><p>Alleen systeembeheerders, zoals de Superuser, mogen de informatie en wachtwoorden voor andere gebruikers wijzigen met <a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a>.</p></div><div class=paragraph><p>Als er geen opties worden meegegeven, buiten de optionele gebruikersnaam, dan toont <a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a> een editor waarin de gebruikersinformatie wordt weergegeven. Als de gebruiker de editor verlaat, dan wordt de gebruikersdatabase bijgewerkt met de nieuwe informatie.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er zal om uw wachtwoord gevraagd worden na het verlaten van de tekstverwerker, als de huidige gebruiker niet de superuser is.</p></div></td></tr></tbody></table></div><div class=exampleblock><div class=title>Voorbeeld 12. Interactieve <code>chpass</code> door superuser</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c>#Informatie in de gebruikersdatabase wijzigen voor jru.</span>
Login: jru
Password: <span class=k>*</span>
Uid <span class=o>[</span><span class=c>#]: 1001</span>
Gid <span class=o>[</span><span class=c># or name]: 1001</span>
Change <span class=o>[</span>month day year]:
Expire <span class=o>[</span>month day year]:
Class:
Home directory: /home/jru
Shell: /usr/local/bin/zsh
Full Name: J. Random User
Office Location:
Office Phone:
Home Phone:
Other information:</code></pre></div></div></div></div><div class=paragraph><p>Een normale gebruiker kan slechts een deel van de bovenstaande informatie wijzen en alleen voor zijn eigen account.</p></div><div class=exampleblock><div class=title>Voorbeeld 13. Interactieve <code>chpass</code> door een gewone gebruiker</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c>#Informatie in de gebruikersdatabase wijzigen voor jru.</span>
Shell: /usr/local/bin/zsh
Full Name: J. Random User
Office Location:
Office Phone:
Home Phone:
Other information:</code></pre></div></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=chfn&amp;sektion=1&amp;format=html">chfn(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=chsh&amp;sektion=1&amp;format=html">chsh(1)</a> zijn gewoon links naar <a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a>. Dat geldt ook voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ypchpass&amp;sektion=1&amp;format=html">ypchpass(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=ypchfn&amp;sektion=1&amp;format=html">ypchfn(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=ypchsh&amp;sektion=1&amp;format=html">ypchsh(1)</a>. Ondersteuning voor NIS gaat automatisch; er hoeft dus geen <code>yp</code> voor het commando aangegeven te worden. NIS wordt behandeld in <a href=./#network-servers>Netwerkdiensten</a>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=users-passwd>14.6.4. <code>passwd</code><a class=anchor href=#users-passwd></a></h4><div class=paragraph><p>Met <a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=1&amp;format=html">passwd(1)</a> wijzigt een gebruiker gewoonlijk zijn eigen wachtwoord of dat van een andere gebruiker als het door de Superuser wordt uitgevoerd.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Om onbedoelde of ongeautoriseerde wijzigen te voorkomen moet het originele wachtwoord worden ingegeven voordat een nieuw wachtwoord kan worden ingesteld.</p></div></td></tr></tbody></table></div><div class=exampleblock><div class=title>Voorbeeld 14. Wachtwoord wijzigen</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% passwd
Changing <span class=nb>local </span>password <span class=k>for </span>jru.
Old password:
New password:
Retype new password:
passwd: updating the database...
passwd: <span class=k>done</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Voorbeeld 15. Als superuser het wachtwoord van een andere gebruiker wijzigen</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># passwd jru</span>
Changing <span class=nb>local </span>password <span class=k>for </span>jru.
New password:
Retype new password:
passwd: updating the database...
passwd: <span class=k>done</span></code></pre></div></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Net als bij <a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a> is <a href="https://man.freebsd.org/cgi/man.cgi?query=yppasswd&amp;sektion=1&amp;format=html">yppasswd(1)</a> gewoon een link naar <a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=1&amp;format=html">passwd(1)</a>, dus NIS werkt met beide commando’s.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=users-pw>14.6.5. <code>pw</code><a class=anchor href=#users-pw></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> is een commandoregelhulpprogramma om gebruikers en groepen te maken, verwijderen, aan te passen en weer te geven. Het werkt als een voorkant voor de systeembestanden met gebruikers en groepen. <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> heeft een zeer krachtige set commandoregelopties, waardoor het erg geschikt is om in shell scripts gebruikt te worden. Nieuwe gebruikers vinden het wellicht gecompliceerder dan de andere commando’s die hier beschreven worden.</p></div></div></div><div class=sect2><h3 id=users-limiting>14.7. Gebruikers beperken<a class=anchor href=#users-limiting></a></h3><div class=paragraph><p>Bij het hebben van gebruikers komt wellicht ook de gedachte aan het beperken van de mogelijkheden op een systeem. FreeBSD biedt een aantal mogelijkheden waarmee een beheerder de hoeveelheid systeembronnen die een gebruiker kan aanwenden kan beperken. Die beperkingen zijn onderverdeeld in twee onderdelen: schijfquota en andere beperkingen voor bronnen.</p></div><div class=paragraph><p>Schijfquota beperken het schijfgebruik voor gebruikers en ze bieden een mogelijkheid om dat gebruik snel te controleren zonder het iedere keer te hoeven berekenen. Quota worden besproken in <a href=./#quotas>Bestandssysteemquota</a>.</p></div><div class=paragraph><p>De overige beperking van bronnen omvat het beperken van het gebruik van CPU, geheugen en andere bronnen die gebruikers tot hun beschikking hebben. Die worden ingesteld in aanmeldklassen en worden hieronder beschreven.</p></div><div class=paragraph><p>Aanmeldklassen worden ingesteld in <span class=filename>/etc/login.conf</span>. De precieze semantiek wordt niet behandeld in dit handboek, maar die staat beschreven in <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a>. Hier is het voldoende aan te geven dat iedere gebruiker wordt toegewezen aan een aanmeldklasse (standaard <code>default</code>) en dat iedere aanmeldklasse verbonden is met een groep aanmeldmogelijkheden (login capability). Een aanmeldmogelijkheid is een <code>naam=waarde</code> paar, waar <em>naam</em> een bekende eigenschap is en <em>waarde</em> een arbitraire string is die wordt verwerkt afhankelijk van de naam. Het instellen van aanmeldklassen en -mogelijkheden is een redelijk eenvoudig proces en wordt ook beschreven in <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Een systeem leest de instellingen uit normaal gesproken <span class=filename>/etc/login.conf</span> niet direct, maar leest het databasebestand <span class=filename>/etc/login.conf.db</span> welke snellere opzoekmogelijkheden biedt. <span class=filename>/etc/login.conf.db</span> kan met het volgende commando gemaakt worden uit <span class=filename>/etc/login.conf</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Beperkingen van bronnen verschillen van standaard aanmeldmogelijkheden op twee manieren. Ten eerste is er voor iedere beperking een zachte en een harde limiet. Een zachte (huidige) limiet kan door een gebruiker of applicatie aangepast worden, maar mag niet hoger zijn dan de harde limiet. De laatste kan door een gebruiker verlaagd worden, maar nooit verhoogd. Deze verschillen worden veroorzaakt door de specifieke behandeling van de beperkingen, niet door de implementatie van het aanmeldmogelijkheden raamwerk, dat wil zeggen dat ze niet <em>echt</em> bijzondere aanmeldmogelijkheden zijn.</p></div><div class=paragraph><p>Hieronder worden de meest gebruikte beperkingen op bronnen beschreven. De overige mogelijkheden, samen met alle andere aanmeldmogelijkheden, staat beschreven in <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a>.</p></div><div class=dlist><dl><dt class=hdlist1><code>coredumpsize</code></dt><dd><p>De limiet op de grootte van een corebestand dat wordt gemaakt door een programma is, om verschillende redenen, ondergeschikt aan andere beperkingen op het gebied van schijfgebruik (bijvoorbeeld <code>filesize</code> of schijfquota). Desalniettemin wordt deze instelling vaak gebruikt als een minder zware methode voor het beheersen van het gebruik van schijfruimte. Omdat gebruikers niet hun eigen corebestanden maken en ze vaak niet verwijderen, kan deze instelling helpen te voorkomen dat een schijf vol loopt in het geval een groot programma (bijvoorbeeld emacs) zou crashen.</p></dd><dt class=hdlist1><code>cputime</code></dt><dd><p>Dit is de maximale hoeveelheid processortijd die een proces van een gebruiker mag gebruiken. Processen die meer bronnen gebruiken worden afgeschoten door de kernel.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Dit is een beperking op de CPU <em>tijd</em> die wordt gebruikt, niet op een percentage van de CPU, zoals wordt getoond in sommige velden door <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a>. Een limiet op de laatste is op het moment van schrijven niet mogelijk en zou ook redelijk waardeloos zijn: een compiler - waarschijnlijk een legitieme taak - kan makkelijk gedurende enige tijd bij 100% van een CPU gebruiken.</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1><code>filesize</code></dt><dd><p>Dit is de maximale grootte voor een bestand waar een gebruiker eigenaar van kan zijn. Anders dan bij <a href=./#quotas>schijfquota</a> is deze limiet van toepassing op individuele bestanden en niet op alle bestanden samen waarvan een gebruiker eigenaar is.</p></dd><dt class=hdlist1><code>maxproc</code></dt><dd><p>Dit is het maximale aantal processen dat een gebruiker mag draaien. Hieronder vallen zowel processen die op de voorgrond draaien als op de achtergrond. Om duidelijke reden kan deze waarde niet groter zijn dan de ingestelde systeemlimiet voor <code>kern.maxproc</code> met <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>. Het te laag zetten van deze instelling kan de productiviteit van een gebruiker schaden: vaak is het zinvol om meerdere keren aangemeld te zijn of om pipelines uit te voeren. Sommige taken, zoals het compileren van een groot programma, brengen ook meerdere processen voort (bijvoorbeeld <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=cc&amp;sektion=1&amp;format=html">cc(1)</a> en andere tussentijdse preprocessors).</p></dd><dt class=hdlist1><code>memorylocked</code></dt><dd><p>Dit is de maximale hoeveelheid geheugen die een proces mag claimen om te locken in het hoofdgeheugen (zie bijvoorbeeld <a href="https://man.freebsd.org/cgi/man.cgi?query=mlock&amp;sektion=2&amp;format=html">mlock(2)</a>). Sommige systeemkritische programma’s, zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a>, locken in het hoofdgeheugen, zodat in het geval dat ze uitgewisseld moeten worden, ze niet bijdragen aan dit uitwisselen indien er problemen zijn.</p></dd><dt class=hdlist1><code>memoryuse</code></dt><dd><p>Dit is de maximale hoeveelheid geheugen die een proces op enig moment mag gebruiken. Hieronder vallen zowel hoofdgeheugen als het gebruik van het wisselbestand. Deze limiet vangt niet al het geheugengebruik af, maar het is een prima begin.</p></dd><dt class=hdlist1><code>openfiles</code></dt><dd><p>Dit is het maximale aantal bestanden dat een proces open mag hebben. In FreeBSD representeren bestanden ook sockets en IPC kanalen. Deze limiet mag dus niet te laag gezet worden. De limiet voor het systeem staat ingesteld in <code>kern.maxfiles</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>.</p></dd><dt class=hdlist1><code>sbsize</code></dt><dd><p>Dit is de limiet op de hoeveelheid netwerkgeheugen, en dus mbufs, die een gebruiker ter beschikking staan. Deze waarde komt voort uit het antwoord op een DoS aanval waarmee veel sockets werden gemaakt, maar het kan in het algemeen gebruikt worden om de hoeveelheid netwerkcommunicatie te limiteren.</p></dd><dt class=hdlist1><code>stacksize</code></dt><dd><p>Dit is de maximale grootte voor een stack van een proces. Deze instelling alleen is niet genoeg om de hoeveelheid geheugen die een programma mag gebruiken te beperken. Daarom moet deze limiet samen met andere limieten gebruikt worden.</p></dd></dl></div><div class=paragraph><p>Er zijn nog een aantal dingen belangrijk bij het instellen bronbeperkingen. Hierna worden een aantal algemene tips, suggesties en commentaren gegeven.</p></div><div class=ulist><ul><li><p>Processen die bij het opstarten van een systeem gestart worden vanuit <span class=filename>/etc/rc</span> worden toegewezen aan de aanmeldklasse <code>daemon</code>.</p></li><li><p>Hoewel de <span class=filename>/etc/login.conf</span> die bij een systeem zit een goede bron is voor redelijke waardes voor de meeste limieten, kan alleen de beheerder van een machine de echt juiste waarden kennen. Het te hoog instellen van een limiet kan een systeem kwetsbaar maken voor misbruik, terwijl het te laag instellen van limieten de productiviteit te veel kan hinderen.</p></li><li><p>Gebruikers van het X Window systeem (X11) horen waarschijnlijk meer bronnen toegewezen te krijgen dan andere gebruikers. X11 gebruikt zelf al meer bronnen, maar het moedigt gebruikers ook aan om meerdere programma’s tegelijkertijd te draaien.</p></li><li><p>Het is belangrijk niet te vergeten dat veel limieten betrekking hebben op individuele processen en niet op een hele gebruiker. Het instellen van bijvoorbeeld <code>openfiles</code> op 50, betekent dat ieder proces dat een gebruiker draait 50 open bestanden mag hebben. Het totale aantal bestanden dat een gebruiker dus open kan hebben is het product van de waarde van <code>openfiles</code> en de waarde van <code>maxproc</code>. Dit geldt ook voor het gebruik van geheugen.</p></li></ul></div><div class=paragraph><p>Meer informatie over bronbeperkingen en aanmeldklassen in het algemeen staan in de relevante hulppagina’s: <a href="https://man.freebsd.org/cgi/man.cgi?query=cap.mkdb&amp;sektion=1&amp;format=html">cap.mkdb(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=getrlimit&amp;sektion=2&amp;format=html">getrlimit(2)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a>.</p></div></div><div class=sect2><h3 id=users-groups>14.8. Groepen<a class=anchor href=#users-groups></a></h3><div class=paragraph><p>Een groep is eenvoudigweg een lijst gebruikers. Groepen kunnen geïdentificeerd worden aan de hand van hun naam en GID (Groep ID). In FreeBSD (en de meeste andere UNIX® achtige systemen), worden besluiten door de kernel over of een proces iets wel of niet mag doen genomen op basis van het bijbehorende gebruikers ID en een lijst van groepen waar dat bij hoort. Anders dan bij een gebruikers ID, heeft een proces een lijst met bijbehorende groepen. Sommige programma’s refereren wel eens aan het "groep ID" van een gebruiker of een proces. Meestal is dit gewoon de eerste groep in de hiervoor genoemde lijst.</p></div><div class=paragraph><p>De vertaling van groep ID naar groepsnaam staat in <span class=filename>/etc/group</span>. Dit is een tekstbestand met vier velden die door het karakter <code>:</code> (dubbele punt) worden gescheiden. Het eerste veld is de groepsnaam, het tweede veld is het versleutelde wachtwoord, het derde het groep ID, het vierde een door komma’s gescheiden lijst van leden van de groep. Het bestand kan zonder gevaar met de hand aangepast worden (aangenomen dat er geen fouten in de syntaxis worden gemaakt, natuurlijk). Een volledige beschrijving van de syntaxis staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=group&amp;sektion=5&amp;format=html">group(5)</a>.</p></div><div class=paragraph><p>Als het onwenselijk is om <span class=filename>/etc/group</span> met de hand aan te passen, dan kan <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> gebruikt worden voor het toevoegen en wijzigen van groepen. Om bijvoorbeeld een groep met de naam <code>teamtwo</code> toe te voegen en daarna het bestaan van die groep te bevestigen:</p></div><div class=exampleblock><div class=title>Voorbeeld 16. Groepen toevoegen met <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupadd teamtwo</span>
<span class=c># pw groupshow teamtwo</span>
teamtwo:<span class=k>*</span>:1100:</code></pre></div></div></div></div><div class=paragraph><p>Het getal <code>1100</code> hierboven is het groep ID van de groep <code>teamtwo</code>. Met de huidige instelling heeft <code>teamtwo</code> geen leden en is die redelijk waardeloos. Dat kan veranderen door <code>jru</code> aan de groep <code>teamtwo</code> toe te voegen.</p></div><div class=exampleblock><div class=title>Voorbeeld 17. De lijst van groepsleden instellen met <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod teamtwo -M jru</span>
<span class=c># pw groupshow teamtwo</span>
teamtwo:<span class=k>*</span>:1100:jru</code></pre></div></div></div></div><div class=paragraph><p>Het argument voor de optie <code>-M</code> is een door komma’s gescheiden lijst van gebruikers die in de aangegeven groep moeten komen. In de voorgaande paragrafen is al aangegeven dat het wachtwoordbestand ook voor iedere gebruiker een groep bevat. Een gebruiker wordt automatisch toegevoegd aan de groepenlijst door een systeem. De gebruiker wordt niet als lid getoond van die groep bij het gebruik van de optie <code>groupshow</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>, maar wordt wel getoond als de informatie wordt opgevraagd via <a href="https://man.freebsd.org/cgi/man.cgi?query=id&amp;sektion=1&amp;format=html">id(1)</a> of met een soortgelijk programma. Met andere woorden: <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> wijzigt alleen het bestand <span class=filename>/etc/group</span> en probeert nooit extra informatie te lezen uit <span class=filename>/etc/passwd</span>.</p></div><div class=exampleblock><div class=title>Voorbeeld 18. Een nieuw lid aan een groep toevoegen met <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod teamtwo -m db</span>
<span class=c># pw groupshow teamtwo</span>
teamtwo:<span class=k>*</span>:1100:jru,db</code></pre></div></div></div></div><div class=paragraph><p>Het argument voor de optie <code>-m</code> is een door komma’s gescheiden lijst van gebruikers die aan de groep worden toegevoegd. In tegenstelling tot het vorige voorbeeld, worden deze gebruikers aan de groep toegevoegd en vervangen ze de lijst van gebruikers in de groep niet.</p></div><div class=exampleblock><div class=title>Voorbeeld 19. <a href="https://man.freebsd.org/cgi/man.cgi?query=id&amp;sektion=1&amp;format=html">id(1)</a> gebruiken om groepslidmaatschap te bepalen</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>id </span>jru
<span class=nv>uid</span><span class=o>=</span>1001<span class=o>(</span>jru<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1001<span class=o>(</span>jru<span class=o>)</span> <span class=nb>groups</span><span class=o>=</span>1001<span class=o>(</span>jru<span class=o>)</span>, 1100<span class=o>(</span>teamtwo<span class=o>)</span></code></pre></div></div></div></div><div class=paragraph><p>Hierboven is te zien dat <code>jru</code> lid is van de groepen <code>jru</code> en <code>teamtwo</code>.</p></div><div class=paragraph><p>Meer informatie over <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> staat in de hulppagina en meer informatie over de opmaak van <span class=filename>/etc/group</span> staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=group&amp;sektion=5&amp;format=html">group(5)</a>.</p></div></div></div></div><div class=sect1><h2 id=security>Hoofdstuk 15. Beveiliging<a class=anchor href=#security></a></h2><div class=sectionbody><div class=sect2><h3 id=security-synopsis>15.1. Overzicht<a class=anchor href=#security-synopsis></a></h3><div class=paragraph><p>Dit hoofdstuk biedt een basisinleiding in systeembeveiligingsconcepten, een aantal goede basisregels en een paar gevorderde onderwerpen binnen FreeBSD. Veel van de onderwerpen die worden behandeld kunnen ook worden toegepast op systemen en Internet in het algemeen. Het Internet is niet langer een "vriendelijke" omgeving waar iedereen een goede buur wil zijn. Het beveiligen van een systeem is onontbeerlijk als gegevens, intellectueel eigendom, tijd en wat dan ook uit de handen van hackers en dergelijke gehouden moeten worden.</p></div><div class=paragraph><p>FreeBSD biedt veel hulpmiddelen en mechanismen om te zorgen voor de integriteit en veiligheid van een systeem en netwerk.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Van basis systeembeveiligingsconcepten in relatie tot FreeBSD.</p></li><li><p>Meer over verschillende versleutelingsmechanismen die beschikbaar zijn in FreeBSD zoals DES en MD5.</p></li><li><p>Hoe eenmalige wachtwoordautenticatie opgezet kan worden.</p></li><li><p>Hoe TCP Wrappers in te stellen voor gebruik met inetd.</p></li><li><p>Hoe Kerberos5 op FreeBSD opgezet kan worden.</p></li><li><p>Hoe IPsec wordt ingesteld en hoe een VPN op te zetten tussen FreeBSD en Microsoft® Windows® machines.</p></li><li><p>Hoe OpenSSH, FreeBSD’s SSH implementatie, in te stellen en te gebruiken.</p></li><li><p>Wat bestandssysteem-ACLs zijn en hoe die te gebruiken;</p></li><li><p>Hoe het hulpprogramma Portaudit gebruikt kan worden om softwarepakketten uit de Portscollectie te auditen.</p></li><li><p>Hoe om te gaan met publicaties van FreeBSD beveiligingswaarschuwingen.</p></li><li><p>Iets van procesaccounting en hoe dat is in te schakelen in FreeBSD.</p></li></ul></div><div class=paragraph><p>Er wordt aangenomen dat de lezer van dit hoofdstuk:</p></div><div class=ulist><ul><li><p>Basisbegrip heeft van FreeBSD en Internetconcepten.</p></li></ul></div><div class=paragraph><p>In dit boek worden nog meer onderwerpen met betrekking tot beveiliging beschreven. Zo wordt bijvoorbeeld Verplichte Toegangscontrole (Mandatory Access Control) besproken in <a href=./#mac>Mandatory Access Control</a> en Internet Firewalls in <a href=./#firewalls>Firewalls</a>.</p></div></div><div class=sect2><h3 id=security-intro>15.2. Introductie<a class=anchor href=#security-intro></a></h3><div class=paragraph><p>Beveiliging is een taak die begint en eindigt bij de systeembeheerder. Hoewel alle BSD UNIX® meergebruikerssystemen enige inherente beveiliging kennen, is het bouwen en onderhouden van additionele beveiligingsmechanismen om de gebruikers "eerlijk" te houden waarschijnlijk een van de zwaarste taken voor de systeembeheerder. Machines zijn zo veilig als ze gemaakt worden en beveiligingsoverwegingen staan altijd op gespannen voet met de wens om gebruiksvriendelijkheid. UNIX® systemen zijn in het algemeen in staat tot het tegelijkertijd uitvoeren van een enorm aantal processen en veel van die processen acteren als server - daarmee wordt bedoeld dat externe entiteiten er verbindingen mee kunnen maken en ertegen kunnen praten. Nu de minicomputers en mainframes van gisteren de desktops van vandaag zijn en computers onderdeel zijn van netwerken en internetwerken, wordt beveiliging nog belangrijker.</p></div><div class=paragraph><p>Systeembeveiliging heeft ook te maken met het omgaan met verschillende vormen van aanvallen, zoals een poging om een systeem te crashen of op een andere manier onstabiel te maken, zonder te proberen de <code>root</code> account aan te vallen ("break root"). Aandachtspunten voor beveiliging kunnen opgesplitst worden in categorieën:</p></div><div class="olist arabic"><ol class=arabic><li><p>Ontzeggen van dienst aanvallen ("Denial of Service").</p></li><li><p>Gebruikersaccounts compromitteren.</p></li><li><p><code>root</code> compromitteren via toegankelijke servers.</p></li><li><p><code>root</code> compromitteren via gebruikersaccounts.</p></li><li><p>Achterdeur creëren ("Backdoor").</p></li></ol></div><div class=paragraph><p>Een ontzegging van dienst (DoS) aanval is een techniek die de machine middelen ontneemt. In het algemeen zijn DoS aanvallen brute kracht mechanismen die proberen de machine te crashen of op een andere manier onbruikbaar te maken door de machine of de netwerkcode te overvragen. Sommige DoS aanvallen proberen misbruik te maken van bugs in de netwerkcode om een machine met een enkel pakket te crashen. Zoiets kan alleen gerepareerd worden door een aanpassing aan de kernel te maken. Aanvallen op servers kunnen vaak hersteld worden door op de juiste wijze opties in stellen om de belasting van servers te limiteren in ongunstige omstandigheden. Omgaan met brute kracht aanvallen is lastiger. Zo is een aanval met gefingeerde pakketten ("spoofed-packet") vrijwel niet te stoppen, behalve dan door het systeem van Internet los te koppelen. Misschien gaat de machine er niet door plat, maar het kan wel een volledige Internetverbinding verzadigen.</p></div><div class=paragraph><p>Een gecompromitteerde gebruikersaccount komt nog veel vaker voor dan een DoS aanval. Veel systeembeheerders draaien nog steeds standaard telnetd, rlogind, rshd en ftpd servers op hun machines. Deze servers communiceren standaard niet over beveiligde verbindingen. Het resultaat is dat als er een redelijk grote gebruikersgroep is, er altijd wel van een of meer van de gebruikers die van afstand op dat systeem aanmelden (wat toch de meest normale en makkelijke manier is om op een systeem aan te melden) het wachtwoord is afgeluisterd ("sniffed"). Een oplettende systeembeheerder analyseert zijn logboekbestanden om te zoeken naar verdachte bronadressen, zelfs als het om succesvolle aanmeldpogingen gaat.</p></div><div class=paragraph><p>Uitgangspunt moet altijd zijn dat als een aanvaller toegang heeft tot een gebruikersaccount, de aanvaller de <code>root</code> account kan compromitteren. In werkelijkheid is het wel zo dat voor een systeem dat goed beveiligd is en goed wordt onderhouden, toegang tot een gebruikersaccount niet automatisch betekent dat de aanvaller ook <code>root</code> privileges kan krijgen. Het is van belang dit onderscheid te maken, omdat een aanvaller zonder toegang tot <code>root</code> in het algemeen zijn sporen niet kan wissen en op z’n best wat kan rommelen met bestanden van de gebruiker of de machine kan crashen. Gecompromitteerde gebruikersaccounts zijn vrij normaal omdat gebruikers normaliter niet de voorzorgsmaatregelen nemen die systeembeheerders nemen.</p></div><div class=paragraph><p>Systeembeheerders moeten onthouden dat er in potentie heel veel manieren zijn om toegang tot <code>root</code> te krijgen. Een aanvaller zou het <code>root</code> wachtwoord kunnen kennen, een bug kunnen ontdekken in een dienst die onder <code>root</code> draait en daar via een netwerkverbinding op in kunnen breken of een aanvaller zou een probleem kennen met een suid-root programma dat de aanvaller in staat stelt <code>root</code> te worden als hij eenmaal toegang heeft tot een gebruikersaccount. Als een aanvaller een manier heeft gevonden om <code>root</code> te worden op een machine, dan hoeft hij misschien geen achterdeur ("backdoor") te installeren. Veel bekende manieren die zijn gevonden om <code>root</code> te worden, en weer zijn afgesloten, vereisen veel werk van de aanvaller om zijn rommel achter zich op te ruimen, dus de meeste aanvallers installeren een achterdeur. Een achterdeur biedt de aanvaller een manier om makkelijk opnieuw <code>root</code> toegang tot het systeem te krijgen, maar dit geeft de slimme systeembeheerder ook een makkelijke manier om de inbraak te ontdekken. Het onmogelijk maken een achterdeur te installeren zou best wel eens nadelig kunnen zijn voor beveiliging, omdat hiermee nog niet het gat gedicht is waardoor er in eerste instantie is ingebroken.</p></div><div class=paragraph><p>Beveiligingsmaatregelen moeten altijd geïmplementeerd worden in een meerlagenmodel en worden als volgt gecategoriseerd:</p></div><div class="olist arabic"><ol class=arabic><li><p>Beveiligen van <code>root</code> en medewerkersaccounts.</p></li><li><p>Beveiligen van <code>root</code> - servers onder <code>root</code> en suid-/sgid-binaire bestanden.</p></li><li><p>Beveiligen van gebruikersaccounts.</p></li><li><p>Beveiligen van het wachtwoordbestand.</p></li><li><p>Beveiligen van de kern van de kernel, ruwe apparaten en bestandssystemen.</p></li><li><p>Snel detecteren van ongeoorloofde wijzigingen aan het systeem.</p></li><li><p>Paranoia.</p></li></ol></div><div class=paragraph><p>In het volgende onderdeel van dit hoofdstuk gaan we dieper in op de bovenstaande punten.</p></div></div><div class=sect2><h3 id=securing-freebsd>15.3. FreeBSD beveiligen<a class=anchor href=#securing-freebsd></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=title>Commando versus protocol</div><div class=paragraph><p>In dit hele document gebruiken we vette tekst om te verwijzen naar een commando of applicatie en een <code>monospaced</code> lettertype om te verwijzen naar specifieke commando’s. Protocollen staan vermeld in een normaal lettertype. Dit typografische onderscheid is zinvol omdat bijvoorbeeld ssh zowel een protocol als een commando is.</p></div></td></tr></tbody></table></div><div class=paragraph><p>In de volgende onderdelen behandelen we de methodes uit de <a href=#security-intro>vorige paragraaf</a> om een FreeBSD-systeem te beveiligen.</p></div><div class=sect3><h4 id=securing-root-and-staff>15.3.1. Beveiligen van <code>root</code> en medewerkersaccounts.<a class=anchor href=#securing-root-and-staff></a></h4><div class=paragraph><p>Om te beginnen: doe geen moeite om medewerkersaccounts te beveiligen als de <code>root</code> account niet beveiligd is. Op de meeste systemen heeft de <code>root</code> account een wachtwoord. Als eerste moet aangenomen worden dat dit wachtwoord <em>altijd</em> gecompromitteerd is. Dit betekent niet dat het wachtwoord verwijderd moet worden. Het wachtwoord is namelijk bijna altijd nodig voor toegang via het console van de machine. Het betekent wel dat het niet mogelijk gemaakt moet worden om het wachtwoord te gebruiken buiten het console om en mogelijk zelfs niet via het <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> commando. Pty’s moeten bijvoorbeeld gemarkeerd staan als onveilig ("insecure") in het bestand <span class=filename>/etc/ttys</span> zodat direct aanmelden met <code>root</code> via <code>telnet</code> of <code>rlogin</code> niet wordt toegestaan. Als andere aanmelddiensten zoals sshd gebruikt worden, dan hoort direct aanmelden via <code>root</code> uitgeschakeld staat. Dit kan door het bestand <span class=filename>/etc/ssh/sshd_config</span> te bewerken en ervoor te zorgen dat <code>PermitRootLogin</code> op <code>no</code> staat. Dit moet gebeuren voor iedere methode van toegang - diensten zoals FTP worden vaak over het hoofd gezien. Het direct aanmelden van <code>root</code> hoort alleen te mogen via het systeemconsole.</p></div><div class=paragraph><p>Natuurlijk moet een systeembeheerder de mogelijkheid hebben om <code>root</code> te worden. Daarvoor kunnen een paar gaatjes geprikt worden. Maar dan moet ervoor gezorgd worden dat er voor deze gaatjes extra aanmelden met een wachtwoord nodig is. Eén manier om <code>root</code> toegankelijk te maken is door het toevoegen van de juiste medewerkersaccounts aan de <code>wheel</code> groep (in <span class=filename>/etc/group</span>). De medewerkers die lid zijn van de groep <code>wheel</code> mogen <code>su</code>-en naar <code>root</code>. Maak medewerkers nooit "native" lid van de groep <code>wheel</code> door ze in de groep <code>wheel</code> te plaatsen in <span class=filename>/etc/group</span>. Medewerkersaccounts horen lid te zijn van de groep <code>staff</code> en horen dan pas toegevoegd te worden aan de groep <code>wheel</code> in het bestand <span class=filename>/etc/group</span>. Alleen medewerkers die ook echt toegang tot <code>root</code> nodig hebben horen in de groep <code>wheel</code> geplaatst te worden. Het is ook mogelijk, door een autenticatiemethode als Kerberos te gebruiken, om het bestand <span class=filename>.k5login</span> van Kerberos in de <code>root</code> account te gebruiken om een <a href="https://man.freebsd.org/cgi/man.cgi?query=ksu&amp;sektion=1&amp;format=html">ksu(1)</a> naar <code>root</code> toe te staan zonder ook maar iemand lid te maken van de groep <code>wheel</code>. Dit is misschien wel een betere oplossing, omdat het <code>wheel</code>-mechanisme het nog steeds mogelijk maakt voor een inbreker <code>root</code> te breken als de inbreker een wachtwoordbestand te pakken heeft gekregen en toegang kan krijgen tot één van de medewerkersaccounts. Hoewel het instellen van het <code>wheel</code>-mechanisme beter is dan niets, is het niet per se de meest veilige optie.</p></div><div class=paragraph><p>Om een account volledig op slot te zetten, dient het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> gebruikt te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw lock staff</span></code></pre></div></div><div class=paragraph><p>Dit voorkomt dat de gebruiker zich aanmeldt via enig mechanisme, inclusief <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a>.</p></div><div class=paragraph><p>Een andere manier om toegang tot accounts te blokkeren is om het versleutelde wachtwoord door een enkel “*”-karakter te vervangen. Dit karakter zal nooit overeenkomen met het versleutelde wachtwoord en dus gebruikerstoegang blokkeren. Het volgende medewerkersaccount bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>foobar:R9DT/Fa1/LV9U:1000:1000::0:0:Foo Bar:/home/foobar:/usr/local/bin/tcsh</pre></div></div><div class=paragraph><p>zou veranderd moeten worden in:</p></div><div class="literalblock programlisting"><div class=content><pre>foobar:*:1000:1000::0:0:Foo Bar:/home/foobar:/usr/local/bin/tcsh</pre></div></div><div class=paragraph><p>Dit voorkomt dat de gebruiker <code>foobar</code> zich aanmeldt met conventionele methoden. Deze methode om toegang te beperken werkt niet op sites die Kerberos gebruiken of in situaties waarin de gebruiker met <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> sleutels heeft geïnstalleerd.</p></div><div class=paragraph><p>Deze beveiligingsmechanismen hebben ook als uitgangspunt dat vanaf een zwaarder beveiligde machine wordt aangemeld op een minder beveiligd systeem. Als een hoofdserver bijvoorbeeld allerlei servers draait, zou het werkstation er geen moeten draaien. Om een werkstation redelijk veilig te laten zijn, dienen er zo min mogelijk servers op te draaien, bij voorkeur zelfs geen en er zou een schermbeveiliging met wachtwoordbeveiliging op moeten draaien. Maar als een aanvaller fysieke toegang heeft tot een werkstation, dan kan hij elke beveiliging die erop is aangebracht omzeilen. Dit probleem dient echt overwogen te worden, net als het feit dat de meeste aanvallen van een afstand plaatsvinden, via het netwerk, door mensen die geen fysieke toegang hebben tot werkstations of servers.</p></div><div class=paragraph><p>Het gebruik van iets als Kerberos geeft de mogelijkheid om het wachtwoord van de account van een medewerker buiten gebruik te stellen of te wijzigen op één plaats, waarbij het meteen actief is op alle machines waarop die medewerker een account heeft. Als de account van een medewerker gecompromitteerd raakt, moet vooral de mogelijkheid om per direct het wachtwoord voor machines te kunnen aanpassen niet onderschat worden. Met afzonderlijke wachtwoorden kan het veranderen van wachtwoorden op N systemen een puinhoop worden. Met Kerberos kunnen ook wachtwoordrestricties opgelegd worden: het is niet alleen mogelijk om een Kerberos "ticket" na een bepaalde tijd te laten verlopen, maar het Kerberos systeem kan afdwingen dat de gebruiker na een bepaalde tijd een nieuw wachtwoord kiest (na bijvoorbeeld een maand).</p></div></div><div class=sect3><h4 id=_beveiligen_van_root_servers_onder_root_en_suid_sgid_binaire_bestanden>15.3.2. Beveiligen van <code>root</code> - servers onder <code>root</code> en suid-/sgid-binaire bestanden<a class=anchor href=#_beveiligen_van_root_servers_onder_root_en_suid_sgid_binaire_bestanden></a></h4><div class=paragraph><p>Een voorzichtige systeembeheerder draait alleen die servers die nodig zijn, niets meer, niets minder. Bedenk dat servers van derde partijen vaak de meeste neiging hebben tot het vertonen van bugs. Zo staat bijvoorbeeld het draaien van een oude versie van imapd of popper gelijk aan het weggeven van de <code>root</code> account aan de hele wereld. Draai nooit een server die niet zorgvuldig is onderzocht. Veel servers hoeven niet te draaien als <code>root</code>. Zo kunnen de ntalk, comsat en finger daemons bijvoorbeeld draaien in speciale gebruikerszandbakken ("<em>sandboxes</em>"). Een zandbak is niet perfect, tenzij er heel veel moeite gedaan wordt, maar de meerlagenbenadering blijft bestaan: als iemand via een server die in een zandbak draait weet in te breken, dan moeten ze eerst nog uit de zandbak komen. Hoe groter het aantal lagen is waar een inbreker doorheen moet, hoe kleiner de kans op succes is. <code>root</code> gaten zijn historisch gezien aanwezig geweest in vrijwel iedere server die ooit als <code>root</code> gedraaid heeft, inclusief de basisservers van een systeem. Op een machine waarop mensen alleen aanmelden via sshd en nooit via telnetd of rshd of rlogind dienen die servers uitgeschakeld te worden!</p></div><div class=paragraph><p>FreeBSD draait ntalkd, comsat en finger tegenwoordig standaard in een zandbak. Een ander programma dat misschien beter in een zandbak kan draaien is <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a>. In <span class=filename>/etc/defaults/rc.conf</span> staat als commentaar welke parameters er nodig zijn om named in een zandbak te draaien. Afhankelijk van of het een nieuwe systeeminstallatie of het bijwerken van een bestaand systeem betreft, worden de speciale gebruikersaccounts die bij die zandbakken horen misschien niet geïnstalleerd. Een voorzichtige systeembeheerder onderzoekt en implementeert zandbakken voor servers waar dat ook maar mogelijk is.</p></div><div class=paragraph><p>Er zijn een aantal diensten die vooral niet in een zandbak draaien: sendmail, popper, imapd, ftpd en andere. Voor sommige servers zijn alternatieven, maar dat kost misschien meer tijd dan er te besteden is (gemak dient de mens). Het kan voorkomen dat deze servers als <code>root</code> moeten draaien en dat er vertrouwd moet worden op andere mechanismen om een inbraak via die servers te detecteren.</p></div><div class=paragraph><p>De andere grote mogelijkheid voor <code>root</code> gaten in een systeem zijn de suid-root en sgid-binaire bestanden die geïnstalleerd zijn op een systeem. Veel van die bestanden, zoals rlogin, staan in <span class=filename>/bin</span>, <span class=filename>/sbin</span>, <span class=filename>/usr/bin</span> of <span class=filename>/usr/sbin</span>. Hoewel het niet 100% veilig is, mag aangenomen worden dat de suid- en sgid-binaire bestanden van een standaardsysteem redelijk veilig zijn. Toch worden er nog wel eens <code>root</code> gaten gevonden in deze bestanden. Zo is er in 1998 een <code>root</code> gat gevonden in <code>Xlib</code> waardoor xterm (die normaliter suid is) kwetsbaar bleek. Een voorzichtige systeembeheerder kiest voor "better to be safe than sorry" door de suid-bestanden die alleen medewerkers hoeven uit te voeren aan een speciale groep toe te wijzen en de suid-bestanden die niemand gebruikt te lozen (<code>chmod 000</code>). Een server zonder monitor heeft normaal gezien xterm niet nodig. Sgid-bestanden kunnen bijna net zo gevaarlijk zijn. Als een inbreker een sgid-kmem stuk kan krijgen, dan kan hij wellicht <span class=filename>/dev/kmem</span> lezen en dus het gecodeerde wachtwoordbestand, waardoor mogelijk ieder account met een wachtwoord besmet is. Een inbreker toegang tot de groep <code>kmem</code> kan krijgen, zou bijvoorbeeld mee kunnen kijken met de toetsaanslagen die ingegeven worden via de pty’s, inclusief die pty’s die gebruikt worden door gebruikers die via beveiligde methodes aanmelden. Een inbreker die toegang krijgt tot de groep <code>tty</code> kan naar bijna alle tty’s van gebruikers schrijven. Als een gebruiker een terminalprogramma of een terminalemulator met een toetsenbordsimulatieoptie draait, dan kan de inbreker in potentie een gegevensstroom genereren die ervoor zorgt dat de terminal van de gebruiker een commando echot, dat dan wordt uitgevoerd door die gebruiker.</p></div></div><div class=sect3><h4 id=secure-users>15.3.3. Beveiligen van gebruikersaccounts<a class=anchor href=#secure-users></a></h4><div class=paragraph><p>Gebruikersaccounts zijn gewoonlijk het meest lastig om te beveiligen. Hoewel er allerlei draconische maatregelen genomen kunnen worden met betrekking tot de medewerkers en hun wachtwoorden "weggesterd" kunnen worden, gaat dat waarschijnlijk niet lukken met de gewone gebruikersaccounts. Als er toch voldoende vrijheid is, dan prijst de beheerder zich gelukkig en is het misschien toch mogelijk de accounts voldoende te beveiligen. Als die vrijheid er niet is, dan moeten die accounts gewoon netter gemonitord worden. Het gebruik van ssh en Kerberos voor gebruikersaccounts is problematischer vanwege het extra beheer en de ondersteuning, maar nog steeds een prima oplossing in vergelijking met een versleuteld wachtwoordbestand.</p></div></div><div class=sect3><h4 id=_beveiligen_van_het_wachtwoordbestand>15.3.4. Beveiligen van het wachtwoordbestand<a class=anchor href=#_beveiligen_van_het_wachtwoordbestand></a></h4><div class=paragraph><p>De enige echte oplossing is zoveel mogelijk wachtwoorden wegsterren en ssh of Kerberos gebruiken voor toegang tot die accounts. Hoewel een gecodeerd wachtwoordbestand (<span class=filename>/etc/spwd.db</span>) alleen gelezen kan worden door <code>root</code>, is het wel mogelijk dat een inbreker leestoegang krijgt tot dat bestand zonder dat de aanvaller root-schrijftoegang krijgt.</p></div><div class=paragraph><p>Beveiligingsscripts moeten altijd controleren op en rapporteren over wijzigingen in het wachtwoordbestand (zie ook <a href=#security-integrity>Bestandsintegriteit Controleren</a> hieronder).</p></div></div><div class=sect3><h4 id=_beveiligen_van_de_kern_van_de_kernel_ruwe_apparaten_en_bestandssystemen>15.3.5. Beveiligen van de kern van de kernel, ruwe apparaten en bestandssystemen<a class=anchor href=#_beveiligen_van_de_kern_van_de_kernel_ruwe_apparaten_en_bestandssystemen></a></h4><div class=paragraph><p>Als een aanvaller toegang krijgt tot <code>root</code> dan kan hij ongeveer alles, maar er zijn een paar slimmigheidjes. Zo hebben bijvoorbeeld de meeste moderne kernels een ingebouwd pakketsnuffelstuurprogramma ("packet sniffing"). Bij FreeBSD is dat het <span class=filename>bpf</span> apparaat. Een inbreker zal in het algemeen proberen een pakketsnuffelaar te draaien op een gecompromitteerde machine. De inbreker hoeft deze mogelijkheid niet te hebben en bij de meeste systemen is het niet verplicht het <span class=filename>bpf</span> apparaat mee te compileren.</p></div><div class=paragraph><p>Maar zelfs als het <span class=filename>bpf</span> apparaat is uitgeschakeld, dan zijn er nog <span class=filename>/dev/mem</span> en <span class=filename>/dev/kmem</span>. De inbreker kan namelijk nog schrijven naar ruwe schrijfapparaten. En er is ook nog een optie in de kernel die modulelader ("module loader") heet, <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>. Een ondernemende inbreker kan een KLD-module gebruiken om zijn eigen <span class=filename>bpf</span>-apparaat of een ander snuffelapparaat te installeren in een draaiende kernel. Om deze problemen te voorkomen, moet de kernel op een hoger veiligheidsniveau draaien, ten minste securelevel 1.</p></div><div class=paragraph><p>Het veiligheidsniveau van de kernel kan op een aantal manieren worden ingesteld. De eenvoudigste manier om het veiligheidsniveau van een draaiende kernel te verhogen is met <code>sysctl</code> op de kernelvariabele <code>kern.securelevel</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.securelevel=1</span></code></pre></div></div><div class=paragraph><p>Standaard start de kernel van FreeBSD op met een veiligheidsniveau van -1. Het veiligheidsniveau blijft -1 tenzij het is veranderd, òfwel door de beheerder òfwel door <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> vanwege een instelling in de opstartscripts. Het veiligheidsniveau kan tijdens het opstarten van het systeem verhoogd worden door de variabele <code>kern_securelevel_enable</code> op <code>YES</code> te zetten in het bestand <span class=filename>/etc/rc.conf</span>, en de waarde van de variabele <code>kern_securelevel</code> op het gewenste veiligheidsniveau in te stellen.</p></div><div class=paragraph><p>Het standaard veiligheidsniveau van een FreeBSD-systeem direct nadat de opstartscripts zijn uitgevoerd is -1. Dit wordt "onveilige modus" genoemd omdat de onveranderlijke bestandsvlag uitgezet kan worden, er van/naar alle apparaten mag worden gelezen en geschreven, enzovoorts.</p></div><div class=paragraph><p>Als eenmaal het veiligheidsniveau op 1 of een hogere waarde is ingesteld, worden de alleen-toevoegen en onveranderlijke bestanden gehonoreerd, deze kunnen niet worden uitgezet, en wordt toegang tot rauwe apparaten ontzegd. Hogere niveaus beperken nog meer bewerkingen. Lees, voor een volledige beschrijving van het effect van de verschillende veiligheidsniveaus, de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=security&amp;sektion=7&amp;format=html">security(7)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het ophogen van het veiligheidsniveau naar 1 of hoger kan enkele problemen met X11 (toegang tot <span class=filename>/dev/io</span> zal worden geblokkeerd), of met de installatie van FreeBSD wanneer die vanaf de broncode is gebouwd (het gedeelte <code>installword</code> van het proces moet tijdelijk de alleen-toevoegen en onveranderlijke vlaggen van sommige bestanden uitzetten), en met enkele andere gevallen veroorzaken. Soms, zoals het geval is met X11, is het mogelijk om dit te omzeilen door <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=1&amp;format=html">xdm(1)</a> behoorlijk vroeg in het opstartproces te starten, wanneer het veiligheidsniveau nog laag genoeg is. Omzeilmethoden zoals deze zijn misschien niet voor alle veiligheidsniveaus of voor alle beperkingen die ze opleggen mogelijk. Wat vooruit plannen is een goed idee. Het is belangrijk om de beperkingen die door elk veiligheidsniveau worden opgelegd te begrijpen omdat ze het gebruiksgemak van het systeem sterk verminderen. Het vergemakkelijkt ook het kiezen van eens standaardinstelling en voorkomt allerlei verassingen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als het veiligheidsniveau van de kernel naar 1 of hoger wordt verhoogd, kan het nuttig zijn om de vlag <code>schg</code> aan te zetten voor kritieke opstartprogramma’s, mappen, en scriptbestanden (i.e., alles dat gedraaid wordt tot het punt waar het veiligheidsniveau wordt ingesteld). Dit kan overdreven zijn, en het bijwerken van het systeem is veel moeilijker wanneer het op een hoog veiligheidsniveau werkt. Een minder beperkend compromis is om het systeem op een hoger veiligheidsniveau te draaien maar het aanzetten van de vlag <code>schg</code> voor elk systeembestand en -map onder de zon over te slaan. Een andere mogelijkheid is om <span class=filename>/</span> en <span class=filename>/usr</span> simpelweg als alleen-lezen aan te koppelen. Het dient opgemerkt te worden dat het te draconisch zijn over wat is toegestaan het belangrijke detecteren van een inbraak kan verhinderen.</p></div></div><div class=sect3><h4 id=security-integrity>15.3.6. Bestandsintegriteit controleren: binaire bestanden, instellingenbestanden, enzovoort<a class=anchor href=#security-integrity></a></h4><div class=paragraph><p>Als puntje bij paaltje komt kan de kern van een systeem maar tot een bepaald punt beveiligd worden zonder dat het minder prettig werken wordt. Zo werk het zetten van de <code>schg</code> bit met <code>chflags</code> op de meeste bestanden in <span class=filename>/</span> en <span class=filename>/usr</span> waarschijnlijk averechts, omdat, hoewel de bestanden beschermd zijn, ook het venster waarin detectie plaats kan vinden is gesloten. De laatste laag van beveiliging is waarschijnlijk de meest belangrijke: detectie. Alle overige beveiliging is vrijwel waardeloos (of nog erger: geeft een vals gevoel van beveiliging) als een mogelijke inbraak niet gedetecteerd kan worden. Een belangrijk doel van het meerlagenmodel is het vertragen van een aanvaller, nog meer dan hem te stoppen, om hem op heterdaad te kunnen betrappen.</p></div><div class=paragraph><p>De beste manier om te zoeken naar een inbraak is zoeken naar gewijzigde, ontbrekende of onverwachte bestanden. De beste manier om te zoeken naar gewijzigde bestanden is vanaf een ander (vaak gecentraliseerd) systeem met beperkte toegang. Met zelfgeschreven scripts op dat extra beveiligde systeem met beperkte toegang is een beheerder vrijwel onzichtbaar voor mogelijke aanvallers en dat is belangrijk. Om het nut te maximaliseren moeten in het algemeen dat systeem met beperkte toegang best veel rechten gegeven worden op de andere machines in het netwerk, vaak via een alleen-lezen NFS-export van de andere machines naar het systeem met beperkte toegang of door ssh sleutelparen in te stellen om het systeem met beperkte toegang een ssh verbinding te laten maken met de andere machines. Buiten het netwerkverkeer, is NFS de minst zichtbare methode. Hierdoor kunnen de bestandssystemen op alle cliëntmachines vrijwel ongezien gemonitord worden. Als de server met beperkte toegang verbonden is met de cliëntmachines via een switch, dan is de NFS-methode vaak de beste keus. Als de server met beperkte toegang met de andere machines is verbonden via een hub of door meerdere routers, dan is de NFS-methode wellicht niet veilig genoeg (vanuit een netwerk standpunt) en kan beter ssh gebruikt worden, ondanks de audit-sporen die ssh achterlaat.</p></div><div class=paragraph><p>Als de machine met beperkte toegang eenmaal minstens leestoegang heeft tot een cliëntsysteem dat het moet gaan monitoren, dan moeten scripts gemaakt worden om dat monitoren ook echt uit te voeren. Uitgaande van een NFS-koppeling, kunnen de scripts gebruik maken van eenvoudige systeem hulpprogramma’s als <a href="https://man.freebsd.org/cgi/man.cgi?query=find&amp;sektion=1&amp;format=html">find(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=md5&amp;sektion=1&amp;format=html">md5(1)</a>. We adviseren minstens één keer per dag een md5 te maken van alle bestanden op de cliëntmachine en van instellingenbestanden als in <span class=filename>/etc</span> en <span class=filename>/usr/local/etc</span> zelfs vaker. Als er verschillen worden aangetroffen ten opzichte van de basis md5 informatie op het systeem met beperkte toegang, dan hoort het script te gillen om een beheerder die het moet gaan uitzoeken. Een goed beveiligingsscript controleert ook op onverwachte suid-bestanden en op nieuwe en verwijderde bestanden op systeempartities als <span class=filename>/</span> en <span class=filename>/usr</span>.</p></div><div class=paragraph><p>Als ssh in plaats van NFS wordt gebruikt, dan is het schrijven van het script lastiger. Dan moeten de scripts met <code>scp</code> naar de cliënt verplaatst worden om ze uit te voeren, waardoor ze zichtbaar worden. Voor de veiligheid dienen ook de binaire bestanden die het script gebruikt, zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=find&amp;sektion=1&amp;format=html">find(1)</a>, gekopieerd te worden. De ssh-cliënt op de cliënt zou al gecompromitteerd kunnen zijn. Het is misschien noodzakelijk ssh te gebruiken over onveilige verbindingen, maar dat maakt alles een stuk lastiger.</p></div><div class=paragraph><p>Een goed beveiligingsscript voert ook controles uit op de instellingenbestanden van gebruikers en medewerkers: <span class=filename>.rhosts</span>, <span class=filename>.shosts</span>, <span class=filename>.ssh/authorized_keys</span>, enzovoort. Dat zijn bestanden die buiten het bereik van de <code>MD5</code>-controle vallen.</p></div><div class=paragraph><p>Als gebruikers veel schijfruimte hebben, dan kan het te lang duren om alle bestanden op deze partitie te controleren. In dat geval is het verstandig de koppelvlaggen zo in te stellen dat suid-binaire bestanden op die partities niet zijn toegestaan. Zie daarvoor de optie <code>nosuid</code> (zie <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>). Die partities moeten wel toch nog minstens eens per week doorzocht worden, omdat het doel van deze beveiligingslaag het ontdekken van een inbraakpoging is, of die nu succesvol is of niet.</p></div><div class=paragraph><p>Procesverantwoording (zie <a href="https://man.freebsd.org/cgi/man.cgi?query=accton&amp;sektion=8&amp;format=html">accton(8)</a>) kost relatief gezien weinig en kan bijdragen aan een evaluatie mechanisme voor na inbraken. Het is erg handig om uit te zoeken hoe iemand precies heeft ingebroken op het systeem, mits het bestand nog onbeschadigd is na de inbraak.</p></div><div class=paragraph><p>Tenslotte horen beveiligingsscripts de logboekbestanden te verwerken en de logboekbestanden zelf horen zo veilig mogelijk tot stand te komen. "remote syslog" kan erg zinvol zijn. Een aanvaller zal proberen zijn sporen uit te wissen en logboekbestanden zijn van groot belang voor een systeembeheerder als het gaat om uitzoeken wanneer en hoe er is ingebroken. Een manier om logboekbestanden veilig te stellen is door het systeemconsole via een seriële poort aan te sluiten op een veilige machine en zo informatie te verzamelen.</p></div></div><div class=sect3><h4 id=_paranoia>15.3.7. Paranoia<a class=anchor href=#_paranoia></a></h4><div class=paragraph><p>Een beetje paranoia is niet verkeerd. Eigenlijk kan de systeembeheerder zoveel beveiligingsopties inschakelen als hij wil, als deze maar geen impact hebben op het gebruiksgemak en de beveiligingsopties die <em>wel</em> impact hebben op het gebruiksgemak kunnen ingeschakeld worden als daar zorgvuldig mee wordt omgegaan. Nog belangrijker is misschien dat er een juiste combinatie wordt gevonden. Als de aanbevelingen uit dit document woord voor woord worden opgevolgd, dan worden daarmee de methodes aan een toekomstige aanvaller verraden, die ook toegang heeft tot dit document.</p></div></div><div class=sect3><h4 id=_ontzeggen_van_dienst_aanvallen>15.3.8. Ontzeggen van Dienst aanvallen<a class=anchor href=#_ontzeggen_van_dienst_aanvallen></a></h4><div class=paragraph><p>In deze paragraaf worden Ontzeggen van Dienst aanvallen ("Denial of Service" of DoS) behandeld. Een DoS-aanval wordt meestal uitgevoerd als pakketaanval. Hoewel er weinig gedaan kan worden tegen de huidige aanvallen met gefingeerde pakketten die een netwerk kunnen verzadigen, kan de schade geminimaliseerd worden door ervoor te zorgen dat servers er niet door plat gaan door:</p></div><div class="olist arabic"><ol class=arabic><li><p>Limiteren van server forks.</p></li><li><p>Limiteren van springplank ("springboard") aanvallen (ICMP response aanvallen, ping broadcast, etc.).</p></li><li><p>De Kernel Route Cache overloaden.</p></li></ol></div><div class=paragraph><p>Een veelvoorkomende DoS-aanval is om een server aan te vallen door het zoveel kindprocessen aan te laten maken dat het hostsysteem uiteindelijk geen bestandsdescriptors, geheugen enzovoort meer heeft en het dan opgeeft. inetd (zie <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a>) kent een aantal instellingen om dit type aanval af te zwakken. Hoewel het mogelijk is ervoor te zorgen dat een machine niet plat gaat, is het in het algemeen niet mogelijk te voorkomen dat de dienstverlening door de aanval wordt verstoord. Meer is te lezen in de handleiding van inetd en het advies is in het bijzonder aandacht aan de <code>-c</code>, <code>-C</code> en <code>-R</code> opties te besteden. Aanvallen met gefingeerde IP adressen omzeilen de <code>-C</code> optie naar inetd, dus in het algemeen moet een combinatie van opties gebruikt worden. Sommige op zichzelf staande servers hebben parameters waarmee het aantal forks gelimiteerd kan worden.</p></div><div class=paragraph><p>Sendmail heeft de optie <code>-OMaxDaemonChildren</code> die veel beter blijkt te werken dan het gebruik van de opties van Sendmail waarmee de werklast gelimiteerd kan worden. De parameter <code>MaxDaemonChildren</code> moet zodanig ingesteld worden dat als sendmail start; deze hoog genoeg is om de te verwachten belasting aan te kunnen, maar niet zo hoog is dat de computer het aantal instanties van Sendmails niet aankan zonder plat te gaan. Het is ook verstandig om Sendmail in de wachtrijmodus (<code>-ODeliveryMode=queued</code>) te draaien en de daemon (<code>sendmail -bd</code>) los te koppelen van de verwerking van de wachtrij (<code>sendmail -q15m</code>). Als de verwerking van wachtrij real-time moet, kunnen de tussenpozen voor verwerking verkort worden door deze bijvoorbeeld op <code>-q1m</code> in te stellen, maar dan is een redelijke instelling van <code>MaxDaemonChildren</code> van belang om <em>die</em> Sendmail te beschermen tegen trapsgewijze fouten.</p></div><div class=paragraph><p>Syslogd kan direct aangevallen worden en het is sterk aan te raden de <code>-s</code> optie te gebruiken waar dat ook maar mogelijk is en anders de <code>-a</code> optie.</p></div><div class=paragraph><p>Er dient voorzichtig omgesprongen te worden met diensten die terugverbinden zoals TCP Wrapper’s reverse-identd die direct aangevallen kan worden. In het algemeen is het hierom onverstandig gebruik te maken van de reverse-ident optie van TCP Wrapper.</p></div><div class=paragraph><p>Het is een goed idee om interne diensten af te schermen voor toegang van buitenaf door ze te firewallen op de routers aan de rand van een netwerk ("border routers"). Dit heeft als achtergrond dat verzadigingsaanvallen voorkomen van buiten het LAN voorkomen kunnen worden. Daarmee wordt geen aanval op <code>root</code> via het netwerk en die diensten daaraan voorkomen. Er dient altijd een exclusieve firewall te zijn, dat wil zeggen "firewall alles <em>behalve</em> poorten A, B, C, D en M-Z". Zo worden alle lage poorten gefirewalled behalve die voor specifieke diensten als named (als er een primary is voor een zone), ntalkd, sendmail en andere diensten die vanaf Internet toegankelijk moeten zijn. Als de firewall andersom wordt ingesteld, als een inclusieve of tolerante firewall, dan is de kans groot dat er wordt vergeten een aantal diensten af te "sluiten" of dat er een nieuwe interne dienst wordt toegevoegd en de firewall niet wordt bijgewerkt. Er kan nog steeds voor gekozen worden de hoge poorten open te zetten, zodat een tolerante situatie ontstaat, zonder de lage poorten open te stellen. FreeBSD biedt ook de mogelijkheid een reeks poortnummers die gebruikt worden voor dynamische verbindingen in te stellen via de verscheidene <code>net.inet.ip.portrange``sysctl`s (`sysctl -a | fgrep portrange</code>), waardoor ook de complexiteit van de firewall instellingen kan vereenvoudigen. Zo kan bijvoorbeeld een normaal begin tot eindbereik ingesteld worden van 4000 tot 5000 en een hoog poortbereik van 49152 tot 65535. Daarna kan alles onder 4000 op de firewall geblokkeerd worden (met uitzondering van bepaalde poorten die vanaf Internet bereikbaar moeten zijn natuurlijk).</p></div><div class=paragraph><p>Een andere veelvoorkomende DoS-aanval is de springplankaanval: een server zo aanvallen dat de respons van die server de server zelf, het lokale netwerk of een andere machine overbelast. De meest voorkomende aanval van dit type is de <em>ICMP ping broadcast aanval</em>. De aanvaller fingeert ping-pakketten die naar het broadcast-adres van het LAN worden gezonden met als bron het IP-adres van de machine die hij eigenlijk aan wil vallen. Als de routers aan de rand van het netwerk niet zijn ingesteld om een ping-pakketten aan een broadcast-adres te blokkeren, dan kan het LAN genoeg antwoorden produceren om de verbinding van het slachtoffer (het gefingeerde bronadres) te verzadigen, zeker als de aanvaller hetzelfde doet met tientallen andere netwerken. Broadcastaanvallen met een volume van meer dan 120 megabit zijn al voorgekomen. Een tweede springplankaanval is er een tegen het ICMP-foutmeldingssysteem. Door een pakket te maken waarop een ICMP-foutmelding komt, kan een aanvaller de inkomende verbinding van een server verzadigen en de uitgaande verbinding laten verzadigen met ICMP-foutmeldingen. Dit type aanval kan een server ook laten crashen door te zorgen dat het geheugen ervan vol zit, zeker als de server de ICMP-antwoorden niet zo snel kwijt kan als dat het ze genereert. Gebruik de sysctl-variabele <code>net.inet.icmp.icmplim</code> om deze aanvallen te beperken. De laatste belangrijke klasse springplankaanvallen hangt samen met een aantal interne diensten van inetd zoals de UDP-echodienst. Een aanvaller fingeert eenvoudigweg een UDP-pakket met als bronadres de echopoort van Server A en als bestemming de echopoort van Server B, waar Server A en B allebei op een LAN staan. Die twee servers gaan dat pakket dan heen en weer kaatsen. Een aanvaller kan beide servers overbelasten door een aantal van deze pakketten te injecteren. Soortgelijke problemen kunnen ontstaan met de poort chargen. Een competente systeembeheerder zal al deze interne inetd testdiensten uitschakelen.</p></div><div class=paragraph><p>Gefingeerde pakketten kunnen ook gebruikt worden om de kernel route cache te overbelasten. Raadpleeg daarvoor de <code>net.inet.ip.rtexpire</code>, <code>rtminexpire</code> en <code>rtmaxcache``sysctl</code> parameters. Een aanval met gefingeerde pakketten met een willekeurig bron-IP zorgt ervoor dat de kernel een tijdelijke gecachede route maakt in de routetabel, die uitgelezen kan worden met <code>netstat -rna | fgrep W3</code>. Deze routes hebben een levensduur van ongeveer 1600 seconden. Als de kernel merkt dat de gecachede routetabel te groot is geworden, dan wordt <code>rtexpire</code> dynamisch verkleind, maar deze waarde wordt nooit lager dan <code>rtminexpire</code>. Er zijn twee problemen:</p></div><div class="olist arabic"><ol class=arabic><li><p>De kernel reageert niet snel genoeg als een laag belaste server wordt aangevallen.</p></li><li><p><code>rtminexpire</code> is niet laag genoeg om de kernel de aanval te laten overleven.</p></li></ol></div><div class=paragraph><p>Als servers verbonden zijn met het Internet via een E3 of sneller, dan is het verstandig om handmatig <code>rtexpire</code> en <code>rtminexpire</code> aan te passen via <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>. Als de een van de parameters op nul wordt gezet, dan crasht de machine. Het instellen van beide waarden op 2 seconden is voldoende om de routetabel tegen een aanval te beschermen.</p></div></div><div class=sect3><h4 id=_aandachtspunten_voor_toegang_met_kerberos_en_ssh>15.3.9. Aandachtspunten voor toegang met Kerberos en SSH<a class=anchor href=#_aandachtspunten_voor_toegang_met_kerberos_en_ssh></a></h4><div class=paragraph><p>Er zijn een aantal aandachtspunten die in acht genomen moeten worden als Kerberos of ssh gebruikt worden. Kerberos 5 is een prima autenticatieprotocol, maar er zitten bugs in de Kerberos-versies van telnet en rlogin waardoor ze niet geschikt zijn voor binair verkeer. Kerberos codeert standaard de sessie niet, tenzij de optie <code>-x</code> wordt gebruikt. ssh codeert standaard wel alles.</p></div><div class=paragraph><p>Ssh werkt prima, maar het stuurt coderingssleutels standaard door. Dit betekent dat als gegeven een veilig werkstation met sleutels die toegang geven tot de rest van het systeem en ssh wordt gebruikt om verbinding te maken met een onveilige machine, die sleutels gebruikt kunnen worden. De sleutels zelf zijn niet bekend, maar ssh stelt een doorstuurpoort in zolang als een gebruikers aangemeld blijft. Als de aanvaller `root`toegang heeft op de onveilige machine, dan kan hij die poort gebruiken om toegang te krijgen tot alle machines waar de sleutels van de gebruiker toegang toe geven.</p></div><div class=paragraph><p>Het advies is ssh in combinatie met Kerberos te gebruiken voor het aanmelden door medewerkers wanneer dat ook maar mogelijk is. Ssh kan gecompileerd worden met Kerberos-ondersteuning. Dit vermindert de kans op blootstelling van ssh-sleutels en beschermt tegelijkertijd de wachtwoorden met Kerberos. Ssh-sleutels zouden alleen gebruikt moeten worden voor geautomatiseerde taken vanaf veilige machines (iets waar Kerberos ongeschikt voor is). Het advies is om het doorsturen van sleutels uit te schakelen in de ssh-instellingen of om de <code>from=IP/DOMAIN</code> optie te gebruiken die ssh in staat stelt het bestand <span class=filename>authorized_keys</span> te gebruiken om de sleutel alleen bruikbaar te maken voor entiteiten die zich aanmelden vanaf vooraf aangewezen machines.</p></div></div></div><div class=sect2><h3 id=crypt>15.4. DES, Blowfish, MD5, SHA256, SHA512 en crypt<a class=anchor href=#crypt></a></h3><div class=paragraph><p>Iedere gebruiker op een UNIX® systeem heeft een wachtwoord bij zijn account. Het lijkt voor de hand liggend dat deze wachtwoorden alleen bekend horen te zijn bij de gebruiker en het eigenlijke besturingssysteem. Om deze wachtwoorden geheim te houden, zijn ze gecodeerd in een "eenweg hash" ("one-way hash"), wat betekent dat ze eenvoudig gecodeerd kunnen worden maar niet gedecodeerd. Met andere woorden, wat net gesteld werd is helemaal niet waar: het besturingssysteem kent het <em>echte</em> wachtwoord niet. De enige manier om een wachtwoord in "platte tekst" te verkrijgen, is door er met brute kracht naar te zoeken in alle mogelijke wachtwoorden.</p></div><div class=paragraph><p>Helaas was DES, de Data Encryption Standard, de enige manier om wachtwoorden veilig te coderen toen UNIX® ontstond. Dit was geen probleem voor gebruikers in de VS, maar omdat de broncode van DES niet geëxporteerd mocht worden moest FreeBSD een manier vinden om zowel te gehoorzamen aan de wetten van de Verenigde Staten als aansluiting te houden bij alle andere varianten van UNIX® die nog steeds DES gebruikten.</p></div><div class=paragraph><p>De oplossing werd gevonden in het splitsen van de coderingsbibliotheken zodat gebruikers in de Verenigde Staten de DES-bibliotheken konden installeren en gebruiken en internationale gebruikers een coderingsmethode konden gebruiken die geëxporteerd mocht worden. Zo is het gekomen dat FreeBSD MD5 is gaan gebruiken als coderingsmethode. Van MD5 wordt aangenomen dat het veiliger is dan DES, dus de mogelijkheid om DES te installeren is vooral beschikbaar om aansluiting te kunnen houden.</p></div><div class=sect3><h4 id=_het_crypt_mechanisme_herkennen>15.4.1. Het crypt-mechanisme herkennen<a class=anchor href=#_het_crypt_mechanisme_herkennen></a></h4><div class=paragraph><p>Op dit moment ondersteunt de bibliotheek DES, MD5, Blowfish, SHA256 en SHA512 hashfuncties. Standaard gebruikt FreeBSD 9.1 en nieuwer SHA512 om wachtwoorden te coderen. Oudere versies gebruiken standaard MD5.</p></div><div class=paragraph><p>Het is vrij makkelijk om uit te vinden welke coderingsmethode FreeBSD op een bepaald moment gebruikt. De gecodeerde wachtwoorden in <span class=filename>/etc/master.passwd</span> bekijken is een manier. Wachtwoorden die gecodeerd zijn met MD5 zijn langer dan wanneer ze gecodeerd zijn met DES-hash. Daarnaast beginnen ze met de karakters <code>$1$</code>. Wachtwoorden die beginnen met <code>$2a$</code> zijn gecodeerd met de Blowfish hashfunctie. DES-wachtwoordstrings hebben geen bijzondere kenmerken, maar ze zijn korter dan MD5 wachtwoorden en gecodeerd in een 64-karakter alfabet waar geen <code>$</code> karakter in zit. Een relatief korte string die niet begint met een dollar teken is dus waarschijnlijk een DES-wachtwoord. Zowel SHA256 als SHA512 beginnen met de tekens <code>$6$</code>.</p></div><div class=paragraph><p>Het wachtwoordformaat voor nieuwe wachtwoorden wordt ingesteld met de <code>passwd_format</code> aanmeldinstelling in <span class=filename>/etc/login.conf</span> waar <code>des</code>, <code>md5</code>, <code>blf</code>, <code>sha256</code> of <code>sha512</code> in mag staan. Zie de <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a> handleiding voor meer informatie over aanmeldinstellingen.</p></div></div></div><div class=sect2><h3 id=one-time-passwords>15.5. Eenmalige wachtwoorden<a class=anchor href=#one-time-passwords></a></h3><div class=paragraph><p>Standaard biedt FreeBSD ondersteuning voor OPIE (Eenmalige Wachtwoorden in Alles - "One-time Passwords In Everything"), wat standaard een MD5-hash gebruikt.</p></div><div class=paragraph><p>Hier worden drie verschillende soorten wachtwoorden besproken. De eerste is het normale UNIX® of Kerberos wachtwoord. Dit heet het "UNIX® wachtwoord". Het tweede type is een eenmalig wachtwoord dat wordt gemaakt met het OPIE-programma <a href="https://man.freebsd.org/cgi/man.cgi?query=opiekey&amp;sektion=1&amp;format=html">opiekey(1)</a> en dat wordt geaccepteerd door <a href="https://man.freebsd.org/cgi/man.cgi?query=opiepasswd&amp;sektion=1&amp;format=html">opiepasswd(1)</a> en de aanmeldprocedure. Dit heet het "eenmalige wachtwoord". Het laatste type wachtwoord is het wachtwoord dat wordt opgegeven aan het programma <code>opiekey</code> (en soms aan het programma <code>opiepasswd</code>) dat gebruikt wordt om eenmalige wachtwoorden te maken. Dit type heet "geheim wachtwoord" of gewoon een "wachtwoord" zonder toevoeging.</p></div><div class=paragraph><p>Het geheime wachtwoord heeft niets te maken met het UNIX® wachtwoord; ze kunnen hetzelfde zijn, dat wordt afgeraden. OPIE geheime wachtwoorden kennen niet de beperking van 8 karakters zoals de oude UNIX® wachtwoorden. Ze mogen onbeperkt lang zijn. Wachtwoorden van een zes of zeven woorden lange zin zijn niet ongewoon. Voor het overgrote deel werkt het OPIE-systeem volledig onafhankelijk van het UNIX® wachtwoordsysteem.</p></div><div class=paragraph><p>Buiten het wachtwoord zijn er nog twee stukjes gegevens die van belang zijn voor OPIE. Het eerste wordt "zaad" ("seed") of "sleutel" ("key") genoemd en bestaat uit twee letters en vijf cijfers. Het tweede stukje gegevens heet de "iteratieteller", een nummer tussen 1 en 100. OPIE maakt een eenmalig wachtwoord door het zaad en het geheime wachtwoord aaneen te schakelen en daarop het door de iteratieteller aangegeven keren MD5-hash toe te passen. Daarna wordt het resultaat omgezet in zes korte Engelse woorden. Deze zes woorden zijn een eenmalige wachtwoord. Het autenticatiesysteem (hoofdzakelijk PAM) houdt bij welk eenmalig wachtwoord het laatst is gebruikt en de gebruiker wordt geautenticeerd als de hash van het door de gebruiker ingegeven wachtwoord gelijk is aan het vorige wachtwoord. Omdat er een eenweg hash wordt gebruikt, is het onmogelijk om toekomstige eenmalige wachtwoorden te maken als iemand toch een eenmalig wachtwoord heeft afgevangen. De iteratieteller wordt verlaagd na iedere succesvolle aanmelding om de gebruiker en het aanmeldprogramma synchroon te houden. Als de iteratieteller op 1 staat, moet OPIE opnieuw ingesteld worden.</p></div><div class=paragraph><p>Er zijn enkele programma’s bij ieder systeem betrokken die hieronder worden besproken. Het programma <code>opiekey</code> heeft een iteratieteller, zaad en een geheim wachtwoord nodig en maakt dan een eenmalig wachtwoord of een lijst van opeenvolgende eenmalige wachtwoorden. Het programma <code>opiepasswd</code> wordt gebruikt om OPIE te initialiseren en om wachtwoorden, iteratietellers en zaad te wijzigen. Het accepteert zowel wachtwoordzinnen als een iteratieteller, zaad en een eenmalig wachtwoord. Het programma <code>opieinfo</code> bekijkt de relevante bestanden waarin de eigenschappen staan (<span class=filename>/etc/opiekeys</span>) en toont de huidige iteratieteller en zaad van de gebruiker die het commando uitvoert.</p></div><div class=paragraph><p>Nu worden vier verschillende acties besproken. Bij de eerste wordt <code>opiepasswd</code> gebruikt in een beveiligde verbinding om voor het eerst eenmalige wachtwoorden in te stellen of om een wachtwoord of zaad aan te passen. Bij de tweede wordt <code>opiepasswd</code> gebruikt over een onbeveiligde verbinding samen met <code>opiekey</code> over een beveiligde verbinding om hetzelfde te bereiken. In een derde scenario wordt <code>opiekey</code> gebruikt om aan te melden over een onveilige verbinding. Het vierde scenario behandelt het gebruik van <code>opiekey</code> om een aantal sleutels aan te maken die opgeschreven of afgedrukt kunnen worden, zodat ze meegenomen kunnen worden naar een plaats van waar geen enkele veilige verbinding opgezet kan worden.</p></div><div class=sect3><h4 id=_veilige_verbinding_initialiseren>15.5.1. Veilige verbinding initialiseren<a class=anchor href=#_veilige_verbinding_initialiseren></a></h4><div class=paragraph><p>Gebruik het commando <code>opiepasswd</code> om OPIE voor de eerste keer te initialiseren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiepasswd <span class=nt>-c</span>
<span class=o>[</span>grimreaper] ~ <span class=nv>$ </span>opiepasswd <span class=nt>-f</span> <span class=nt>-c</span>
Adding unfurl:
Only use this method from the console<span class=p>;</span> NEVER from remote. If you are using
telnet, xterm, or a dial-in, <span class=nb>type</span> ^C now or <span class=nb>exit </span>with no password.
Then run opiepasswd without the <span class=nt>-c</span> parameter.
Using MD5 to compute responses.
Enter new secret pass phrase:
Again new secret pass phrase:

ID unfurl OTP key is 499 to4268
MOS MALL GOAT ARM AVID COED</code></pre></div></div><div class=paragraph><p>Als <code>Enter new secret pass phrase:</code> of <code>Enter secret password:</code> op het scherm verschijnt, dient een wachtwoord of wachtwoordzin ingevoerd te worden. Dit is dus niet het aanmeldwachtwoord is, maar dit wordt gebruikt om eenmalige wachtwoorden te maken. De "ID" regel geeft de parameters van het verzoek weer: de aanmeldnaam, de iteratieteller en zaad. Bij het aanmelden kent het systeem deze parameters en worden deze weergegeven zodat ze niet onthouden hoeven te worden. Op de laatste regel staat het eenmalige wachtwoord dat overeenkomt met die parameters en het geheime wachtwoord. Als de gebruiker direct opnieuw zou aanmelden, zou hij dat eenmalige wachtwoord moeten gebruiken.</p></div></div><div class=sect3><h4 id=_onveilige_verbinding_initialiseren>15.5.2. Onveilige verbinding initialiseren<a class=anchor href=#_onveilige_verbinding_initialiseren></a></h4><div class=paragraph><p>Om een wachtwoord te initialiseren of te wijzigen over een onveilige verbinding, moet er al ergens een veilige verbinding bestaan waar de gebruiker <code>opiekey</code> kan uitvoeren. Dit kan een shellprompt zijn op een machine die vertrouwd wordt. De gebruiker moet ook een iteratieteller verzinnen (100 is wellicht een prima getal) en een eigen zaad bedenken of er een laten fabriceren. Over de onveilige verbinding (naar de machine die de gebruiker wil initialiseren) wordt het commando <code>opiepasswd</code> gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiepasswd

Updating unfurl:
You need the response from an OTP generator.
Old secret pass phrase:
	otp-md5 498 to4268 ext
	Response: GAME GAG WELT OUT DOWN CHAT
New secret pass phrase:
	otp-md5 499 to4269
	Response: LINE PAP MILK NELL BUOY TROY

ID mark OTP key is 499 gr4269
LINE PAP MILK NELL BUOY TROY</code></pre></div></div><div class=paragraph><p>Druk op <kbd>Return</kbd> om het standaardzaad te accepteren. Voor een toegangswachtwoord wordt ingevoerd, dient eerst gewisseld te worden naar de veilige verbinding en dienen dezelfde parameters ingegeven te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiekey 498 to4268
Using the MD5 algorithm to compute response.
Reminder: Don<span class=s1>&#39;t use opiekey from telnet or dial-in sessions.
Enter secret pass phrase:
GAME GAG WELT OUT DOWN CHAT</span></code></pre></div></div><div class=paragraph><p>In de onveilige verbinding wordt nu het eenmalige wachtwoord in het relevante programma gekopieerd.</p></div></div><div class=sect3><h4 id=_een_enkel_eenmalig_wachtwoord_maken>15.5.3. Een enkel eenmalig wachtwoord maken<a class=anchor href=#_een_enkel_eenmalig_wachtwoord_maken></a></h4><div class=paragraph><p>Als OPIE eenmaal is ingesteld staat er bij het aanmelden iets als het volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% telnet example.com
Trying 10.0.0.1...
Connected to example.com
Escape character is <span class=s1>&#39;^]&#39;</span><span class=nb>.</span>

FreeBSD/i386 <span class=o>(</span>example.com<span class=o>)</span> <span class=o>(</span>ttypa<span class=o>)</span>

login: &lt;gebruikersnaam&gt;
otp-md5 498 gr4269 ext
Password:</code></pre></div></div><div class=paragraph><p>NB: de OPIE-prompt heeft een handige optie (die hier niet te zien is): als er op <kbd>Return</kbd> wordt gedrukt bij de wachtwoordregel, wordt de echo aangezet, zodat de invoer zichtbaar is. Dit is erg handig als er met de hand een wachtwoord wordt ingegeven, zoals wanneer het wordt ingevoerd vanaf een afdruk.</p></div><div class=paragraph><p>Nu moet het eenmalige wachtwoord gemaakt worden om het aanmeldprompt mee te antwoorden. Dit moet gedaan worden op een vertrouwd systeem waarop <code>opiekey</code> beschikbaar is. Er zijn ook versies voor MS-DOS®, Windows® en Mac OS®. Voor het commando moet zowel de iteratieteller als het zaad ingeven worden op de commandoregel. Deze kan zo overgenomen worden vanaf het aanmeldprompt op de machine waarop de gebruiker zich wil aanmelden.</p></div><div class=paragraph><p>Op het vertrouwde systeem:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiekey 498 to4268
Using the MD5 algorithm to compute response.
Reminder: Don<span class=s1>&#39;t use opiekey from telnet or dial-in sessions.
Enter secret pass phrase:
GAME GAG WELT OUT DOWN CHAT</span></code></pre></div></div><div class=paragraph><p>Nu het eenmalige wachtwoord er is, kan het aanmelden doorgang vinden.</p></div></div><div class=sect3><h4 id=_meerdere_eenmalige_wachtwoorden_maken>15.5.4. Meerdere eenmalige wachtwoorden maken<a class=anchor href=#_meerdere_eenmalige_wachtwoorden_maken></a></h4><div class=paragraph><p>Soms moet een gebruiker ergens naar toe gaan waar er geen toegang is tot een vertrouwde machine of een beveiligde verbinding. In dat geval is het mogelijk om met het commando <code>opiekey</code> een aantal eenmalige wachtwoorden te maken om uit te printen en mee te nemen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiekey <span class=nt>-n</span> 5 30 zz99999
Using the MD5 algorithm to compute response.
Reminder: Don<span class=s1>&#39;t use opiekey from telnet or dial-in sessions.
Enter secret pass phrase: &lt;geheim wachtwoord&gt;
26: JOAN BORE FOSS DES NAY QUIT
27: LATE BIAS SLAY FOLK MUCH TRIG
28: SALT TIN ANTI LOON NEAL USE
29: RIO ODIN GO BYE FURY TIC
30: GREW JIVE SAN GIRD BOIL PHI</span></code></pre></div></div><div class=paragraph><p>Met <code>-n 5</code> worden vijf opeenvolgende sleutels aangevraagd, <code>30</code> geeft aan wat het laatste iteratiegetal moet zijn. Deze wachtwoorden worden weergegeven in <em>omgekeerde</em> volgorde voor gebruik. Als de gebruiker echt paranoïde bent kan hij ze opschrijven of hij kan er ook voor kiezen ze af te drukken met <code>lpr</code>. Op iedere regel staat dus de iteratieteller en het eenmalige wachtwoord, maar misschien is het toch handig om ze na gebruik af te strepen.</p></div></div><div class=sect3><h4 id=_gebruik_van_unix_wachtwoorden_beperken>15.5.5. Gebruik van UNIX® wachtwoorden beperken<a class=anchor href=#_gebruik_van_unix_wachtwoorden_beperken></a></h4><div class=paragraph><p>Met OPIE kan paal en perk gesteld worden aan het gebruik van UNIX® wachtwoorden op basis van het IP-adres van een aanmeldsessie. Dat kan met het bestand <span class=filename>/etc/opieaccess</span> dat standaard aanwezig is. Bij <a href="https://man.freebsd.org/cgi/man.cgi?query=opieaccess&amp;sektion=5&amp;format=html">opieaccess(5)</a> staat meer informatie over dit bestand en welke beveiligingsoverwegingen bestaan bij het gebruik.</p></div><div class=paragraph><p>Hieronder een voorbeeld voor een <span class=filename>opieaccess</span> bestand:</p></div><div class="literalblock programlisting"><div class=content><pre>permit 192.168.0.0 255.255.0.0</pre></div></div><div class=paragraph><p>In deze regel (<code>permit Internet</code>) staat dat gebruikers met een bron IP adres (wat gefingeerd kan worden) dat past binnen de aangegeven waarde en masker altijd UNIX® wachtwoorden mogen gebruiken.</p></div><div class=paragraph><p>Als geen van de regels uit <span class=filename>opieaccess</span> van toepassing is, worden standaard pogingen zonder OPIE geweigerd.</p></div></div></div><div class=sect2><h3 id=tcpwrappers>15.6. TCP Wrappers<a class=anchor href=#tcpwrappers></a></h3><div class=paragraph><p>Iedereen die bekend is met <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> heeft waarschijnlijk wel eens van TCP Wrappers gehoord. Maar slechts weinigen lijken volledig te begrijpen hoe ze in een netwerkomgeving toegepast kunnen worden. Het schijnt dat iedereen een firewall wil hebben om netwerkverbindingen af te handelen. Ondanks dat een firewall veel kan, zijn er toch dingen die het niet kan, zoals tekst terugsturen naar de bron van een verbinding. De TCP Wrappers software kan dat en nog veel meer. In dit onderdeel worden de mogelijkheden van TCP Wrappers besproken en, waar dat van toepassing is, worden ook voorbeelden voor implementatie gegeven.</p></div><div class=paragraph><p>De TCP Wrappers software vergroot de mogelijkheden van inetd door de mogelijkheid al zijn serverdaemons te controleren. Met deze methode is het mogelijk om te loggen, berichten te zenden naar verbindingen, een daemon toe te staan alleen interne verbindingen te accepteren, etc. Hoewel een aantal van deze mogelijkheden ook ingesteld kunnen worden met een firewall, geeft deze manier niet alleen een extra laag beveiliging, maar gaat dit ook verder dan wat een firewall kan bieden.</p></div><div class=paragraph><p>De toegevoegde waarde van TCP Wrappers is niet dat het een goede firewall vervangt. TCP Wrappers kunnen samen met een firewall en andere beveiligingsinstellingen gebruikt worden om een extra laag van beveiliging voor het systeem te bieden.</p></div><div class=paragraph><p>Omdat dit een uitbreiding is op de instellingen van inetd, wordt aangenomen dat de lezer het onderdeel <a href=./#network-inetd>inetd configuratie</a> heeft gelezen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Hoewel programma’s die onder <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> draaien niet echt "daemons" zijn, heten ze traditioneel wel zo. Deze term wordt hier dus ook gebruikt.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_voor_het_eerst_instellen>15.6.1. Voor het eerst instellen<a class=anchor href=#_voor_het_eerst_instellen></a></h4><div class=paragraph><p>De enige voorwaarde voor het gebruiken van TCP Wrappers in FreeBSD is ervoor te zorgen dat de server inetd gestart wordt vanuit <span class=filename>rc.conf</span> met de optie <code>-Ww</code>; dit is de standaardinstelling. Er wordt vanuit gegaan dat <span class=filename>/etc/hosts.allow</span> juist is ingesteld, maar als dat niet zo is, dan zal <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> dat melden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In tegenstelling tot bij andere implementaties van TCP Wrappers is het gebruik van <span class=filename>hosts.deny</span> niet langer mogelijk. Alle instellingen moeten in <span class=filename>/etc/hosts.allow</span> staan.</p></div></td></tr></tbody></table></div><div class=paragraph><p>In de meest eenvoudige instelling worden verbindingen naar daemons toegestaan of geweigerd afhankelijk van de opties in <span class=filename>/etc/hosts.allow</span>. De standaardinstelling in FreeBSD is verbindingen toe te staan naar iedere daemon die met inetd is gestart. Na de basisinstelling wordt aangegeven hoe dit gewijzigd kan worden.</p></div><div class=paragraph><p>De basisinstelling heeft meestal de vorm <code>daemon : adres : actie</code>. <code>daemon</code> is de daemonnaam die <code>inetd</code> heeft gestart. Het <code>adres</code> kan een geldige hostnaam, een IP-adres of een IPv6-adres tussen blokhaken ([ ]) zijn. Het veld <code>actie</code> kan <code>allow</code> of <code>deny</code> zijn, afhankelijk van of toegang toegestaan of geweigerd moet worden. De instellingen werken zo dat ze worden doorlopen van onder naar boven om te kijken welke regel als eerste van toepassing is. Als een regel van toepassing is gevonden, dan stop het zoekproces.</p></div><div class=paragraph><p>Er zijn nog andere mogelijkheden, maar die worden elders toegelicht. Een eenvoudige instelling kan al van met deze informatie worden gemaakt. Om bijvoorbeeld POP3 verbindingen toe te staan via de <a class=package href=https://cgit.freebsd.org/ports/tree/mail/qpopper/>mail/qpopper</a> daemon, zouden de volgende instellingen moeten worden toegevoegd aan <span class=filename>hosts.allow</span>:</p></div><div class="literalblock programlisting"><div class=content><pre># Deze regel is nodig voor POP3-verbindingen
qpopper : ALL : allow</pre></div></div><div class=paragraph><p>Nadat deze regel is toegevoegd moet inetd herstart worden door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd restart</span></code></pre></div></div></div><div class=sect3><h4 id=_gevorderde_instellingen>15.6.2. Gevorderde instellingen<a class=anchor href=#_gevorderde_instellingen></a></h4><div class=paragraph><p>TCP Wrappers hebben ook gevorderde instellingen. Daarmee komt meer controle over de wijze waarop er met verbindingen wordt omgegaan. Soms is het een goed idee om commentaar te sturen naar bepaalde hosts of daemonverbindingen. In andere gevallen moet misschien iets in een logboekbestand geschreven worden of een email naar de beheerder gestuurd worden. Dit kan allemaal met instellingen die <code>wildcards</code>, uitbreidingskarakters (expansion characters) en het uitvoeren van externe commando’s heten. De volgende twee paragrafen beschrijven deze mogelijkheden.</p></div><div class=sect4><h5 id=_externe_commandos>15.6.2.1. Externe commando’s<a class=anchor href=#_externe_commandos></a></h5><div class=paragraph><p>Stel dat zich de situatie voordoet waar een verbinding geweigerd moet worden, maar er een reden gestuurd moet worden naar het individu dat die verbinding probeerde op te zetten. Hoe gaat dat? Dat is mogelijk door gebruik te maken van de optie <code>twist</code>. Als er een poging tot verbinding wordt gedaan, wordt er met <code>twist</code> een shellcommando of script uitgevoerd. Er staat al een voorbeeld in <span class=filename>hosts.allow</span>:</p></div><div class="literalblock programlisting"><div class=content><pre># De andere daemons zijn beschermd.
ALL : ALL \
	: severity auth.info \
	: twist /bin/echo &#34;You are not welcome to use %d from %h.&#34;</pre></div></div><div class=paragraph><p>Dit voorbeeld geeft aan dat het bericht "You are not allowed to use <code>daemon</code> from <code>hostname</code>." wordt teruggestuurd voor iedere daemon die niet al is ingesteld in het toegangsbestand. Het is erg handig om een antwoord terug te sturen naar degene die een verbinding op heeft willen zetten meteen nadat een tot stand gekomen verbinding is verbroken. Let wel dat alle berichten die gezonden worden <em>moeten</em> staan tussen <code>"</code> karakters. Hier zijn geen uitzonderingen op.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Het is mogelijk een ontzegging van dienst aanval uit te voeren op de server als een aanvaller, of een groep aanvallers, deze daemons kan overstromen met verzoeken om verbindingen te maken.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het is ook mogelijk hier de optie <code>spawn</code> te gebruiken. Net als <code>twist</code> weigert de optie <code>spawn</code> impliciet de verbinding en kan het gebruikt worden om shellcommando’s of scripts uit te voeren. Anders dan bij <code>twist</code> stuurt <code>spawn</code> geen bericht aan degene die de verbinding wilde maken. Zie bijvoorbeeld de volgende instelling:</p></div><div class="literalblock programlisting"><div class=content><pre># Geen verbindingen van example.com:
ALL : .example.com \
	: spawn (/bin/echo %a from %h attempted to access %d &gt;&gt; \
	  /var/log/connections.log) \
	: deny</pre></div></div><div class=paragraph><p>Hiermee worden alle verbindingen van het domein <code>*.example.com</code> geweigerd. Tegelijkertijd worden ook hostnaam, IP adres en de daemon waarmee verbinding werd gemaakt naar <span class=filename>/var/log/connections.log</span> geschreven.</p></div><div class=paragraph><p>Naast de vervangingskarakters die al zijn toegelicht, zoals <code>%a</code>, bestaan er nog een paar andere. In de handleiding van <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a> staat een volledige lijst.</p></div></div><div class=sect4><h5 id=_wildcardopties>15.6.2.2. Wildcardopties<a class=anchor href=#_wildcardopties></a></h5><div class=paragraph><p>Tot nu toe is in ieder voorbeeld <code>ALL</code> gebruikt. Er bestaan nog andere opties waarmee de mogelijkheden nog verder gaan. Zo kan <code>ALL</code> gebruikt worden om van toepassing te zijn op iedere instantie van een daemon, domein of een IP adres. Een andere wildcard die gebruikt kan worden is <code>PARANOID</code>. Daarmee wordt iedere host die een IP-adres geeft dat gefingeerd kan zijn aangeduid. Met andere woorden: <code>PARANOID</code> kan gebruikt worden om een actie aan te geven als er een IP-adres gebruikt wordt dat verschilt van de hostnaam. Het volgende voorbeeld kan wat verheldering brengen:</p></div><div class="literalblock programlisting"><div class=content><pre># Weiger mogelijke gespoofte verzoeken aan sendmail:
sendmail : PARANOID : deny</pre></div></div><div class=paragraph><p>In het voorgaande voorbeeld worden alle verbindingsverzoeken aan <code>sendmail</code> met een IP-adres dat verschilt van de hostnaam geweigerd.</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Het gebruik van de wildcard <code>PARANOID</code> kan nogal wat schade aanrichten als de cliënt of de server kapotte DNS-instellingen heeft. Voorzichtigheid van de beheerder is geboden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De handleiding van <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a> geeft meer uitleg over wildcards en de mogelijkheden die ze bieden.</p></div><div class=paragraph><p>Voordat de bovenstaande instellingen werken, dient de eerste regels in <span class=filename>hosts.allow</span> als commentaar gemarkeerd te worden.</p></div></div></div></div><div class=sect2><h3 id=kerberos5>15.7. Kerberos5<a class=anchor href=#kerberos5></a></h3><div class=paragraph><p>Kerberos is een netwerkdienst, protocol en systeem waarmee gebruikers zich kunnen aanmelden met behulp van een dienst op een veilige server. Diensten als op een andere server aanmelden, op afstand kopiëren, veilig tussen systemen kopiëren en andere taken met een hoog risico worden aanmerkelijk veiliger en beter controleerbaar.</p></div><div class=paragraph><p>Kerberos kan omschrijven worden als identiteitbevestigend proxy systeem. Het kan ook omschreven worden als een vertrouwd autenticatiesysteem van een derde partij. Kerberos vervult maar één taak: het veilig autenticeren van gebruikers op het netwerk. Het vervult geen autorisatietaken (wat gebruikers mogen) en controleert ook niets (wat gebruikers hebben gedaan). Nadat een cliënt en server Kerberos hebben gebruikt om hun identiteit vast te stellen kunnen ze ook al hun communicatie coderen om hun privacy en gegevensintegriteit te garanderen.</p></div><div class=paragraph><p>Daarom wordt het sterk aangeraden om Kerberos samen met andere beveiligingsmechanismen te gebruiken die autorisatie en controlemogelijkheden bieden.</p></div><div class=paragraph><p>De aanwijzingen die nu volgen kunnen gebruikt worden als werkinstructie om Kerberos in te stellen zoals dat wordt meegeleverd met FreeBSD. Een complete beschrijving staat in de handleiding.</p></div><div class=paragraph><p>Voor demonstratie van de installatie van Kerberos wordt gebruik gemaakt van de volgende naamgeving:</p></div><div class=ulist><ul><li><p>Het DNS domein ("zone") is example.org.</p></li><li><p>De Kerberos wereld is EXAMPLE.ORG.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het advies is voor installaties van Kerberos echte domeinnamen te gebruiken, zelfs als het alleen intern wordt gebruikt. Hiermee worden DNS problemen voorkomen is een goede samenwerking met andere Kerberos werelden verzekerd.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_geschiedenis>15.7.1. Geschiedenis<a class=anchor href=#_geschiedenis></a></h4><div class=paragraph><p>Kerberos is ontworpen door MIT als oplossing voor netwerkbeveiligingsproblemen. Het Kerberos protocol gebruikt sterke codering zodat een cliënt zijn identiteit kan bewijzen aan een server (en andersom) over een onveilige netwerkverbinding.</p></div><div class=paragraph><p>Kerberos is zowel de naam van een netwerkautorisatieprotocol als een bijvoeglijk naamwoord om de programma’s te beschrijven die gebruik maken van het programma (zoals Kerberos telnet). De huidige versie van het protocol is versie 5 en is beschreven in RFC 1510.</p></div><div class=paragraph><p>Er zijn een aantal vrij beschikbare implementaties van dit protocol beschikbaar voor veel systemen. Het Massachusetts Institute of Technology (MIT), waar Kerberos ooit is ontwikkeld, ontwikkelt nog steeds door aan hun Kerberos pakket. Het wordt in de VS veel gebruikt als coderingspakket en daarom wordt het ook geraakt door de exportwetgeving van de VS. Kerberos van MIT is beschikbaar als port (<a class=package href=https://cgit.freebsd.org/ports/tree/security/krb5/>security/krb5</a>). Heimdal Kerberos is een andere implementatie van versie 5 die expliciet buiten de VS is ontwikkeld om de exportwetgeving de omzeilen (en wordt daarom vaak gebruikt in niet-commerciële UNIX® varianten). De Heimdal Kerberos distributie is beschikbaar als port (<a class=package href=https://cgit.freebsd.org/ports/tree/security/heimdal/>security/heimdal</a>) en er zit een minimale installatie in de basisinstallatie van FreeBSD.</p></div><div class=paragraph><p>Om het grootst mogelijke publiek te bereiken gaan deze instructies ervan uit dat de Heimdal distributie die bij FreeBSD zit wordt gebruikt.</p></div></div><div class=sect3><h4 id=_opzetten_van_een_heimdal_kdc>15.7.2. Opzetten van een Heimdal KDC<a class=anchor href=#_opzetten_van_een_heimdal_kdc></a></h4><div class=paragraph><p>Het Sleutel Distributie Centrum (KDC, voluit "Key Distribution Center") is de gecentraliseerde autenticatiedienst die Kerberos levert. Het is de computer die Kerberos tickets uitgeeft. Het KDC wordt "vertrouwd" door alle andere computer in de Kerberos wereld en daarom dient er een strenger beveiligingsregime op van kracht te zijn.</p></div><div class=paragraph><p>Hoewel het draaien van de Kerberos dienst erg weinig van een systeem vraagt, wordt het wel aangeraden om een machine in te richten exclusief voor het KDC om beveiligingsredenen.</p></div><div class=paragraph><p>Het opzetten van een KDC begint met de controle of de instellingen in <span class=filename>/etc/rc.conf</span> juist zijn om te functioneren als KDC (misschien moeten paden veranderd worden voor een eigen systeem):</p></div><div class="literalblock programlisting"><div class=content><pre>kerberos5_server_enable=&#34;YES&#34;
kadmind5_server_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Daarna wordt het Kerberos-instellingenbestand <span class=filename>/etc/krb5.conf</span> aangemaakt:</p></div><div class="literalblock programlisting"><div class=content><pre>[libdefaults]
    default_realm = EXAMPLE.ORG
[realms]
    EXAMPLE.ORG = {
        kdc = kerberos.example.org
        admin_server = kerberos.example.org
    }
[domain_realm]
    .example.org = EXAMPLE.ORG</pre></div></div><div class=paragraph><p><span class=filename>/etc/krb5.conf</span> gaat ervan uit dat de KDC de volledig gekwalificeerde hostnaam <code>kerberos.example.org</code> heeft. Als de KDC een andere hostnaam heeft, moet er nog een CNAME (alias) toegevoegd aan de zonefile.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voor grotere netwerken met een juist ingestelde BINDDNS server kan het bovenstaande voorbeeld ingekort worden tot:</p></div><div class="literalblock programlisting"><div class=content><pre>[libdefaults]
      default_realm = EXAMPLE.ORG</pre></div></div><div class=paragraph><p>Door de volgende regels toe te voegen aan het zonebestand voor <code>example.org</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>_kerberos._udp      IN  SRV     01 00 88 kerberos.example.org.
_kerberos._tcp      IN  SRV     01 00 88 kerberos.example.org.
_kpasswd._udp       IN  SRV     01 00 464 kerberos.example.org.
_kerberos-adm._tcp  IN  SRV     01 00 749 kerberos.example.org.
_kerberos           IN  TXT     EXAMPLE.ORG</pre></div></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Om cliënten de Kerberos-diensten te kunnen laten vinden, <em>moet</em> er een volledig ingestelde <span class=filename>/etc/krb5.conf</span> zijn of een minimaal ingestelde <span class=filename>/etc/krb5.conf</span><em>en</em> een correct ingestelde DNS-server.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Nu wordt de Kerberos database aangemaakt. Deze database bevat de sleutels voor alle principals en zijn versleuteld met een hoofdwachtwoord. Dit wachtwoord hoeft niet onthouden te worden omdat het wordt opgeslagen in (<span class=filename>/var/heimdal/m-key</span>). De hoofdsleutel wordt aangemaakt door <code>kstash</code> te starten en een wachtwoord in te voeren.</p></div><div class=paragraph><p>Als de hoofdsleutel is gemaakt, kan de database ingeschakeld worden met <code>kadmin</code> met de optie <code>-l</code> (die staat voor "local"). Deze optie geeft <code>kadmin</code> de opdracht om de databasebestanden direct te wijzigingen in plaats van via de <code>kadmind</code> netwerkdienst. Hiermee wordt het kip-ei-probleem opgelost waarbij een verbinding wordt gemaakt met de database voordat hij bestaat. Op het prompt van <code>kadmin</code> kan met <code>init</code> de database met de werelden aangemaakt worden.</p></div><div class=paragraph><p>Tenslotte, nog steeds in <code>kadmin</code>, kan de eerste principal gemaakt worden met <code>add</code>. De standaardopties voor de principal worden nu aangehouden. Deze kunnen later altijd nog gewijzigd worden met <code>modify</code>. Met het commando <code>?</code> kunnen alle beschikbare mogelijkheden getoond worden.</p></div><div class=paragraph><p>Hieronder een sessie waarin een voorbeelddatabase wordt aangemaakt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kstash</span>
Master key: xxxxxxxx
Verifying password - Master key: xxxxxxxx

<span class=c># kadmin -l</span>
kadmin&gt; init EXAMPLE.ORG
Realm max ticket life <span class=o>[</span>unlimited]:
kadmin&gt; add tillman
Max ticket life <span class=o>[</span>unlimited]:
Max renewable life <span class=o>[</span>unlimited]:
Attributes <span class=o>[]</span>:
Password: xxxxxxxx
Verifying password - Password: xxxxxxxx</code></pre></div></div><div class=paragraph><p>Nu kan de KDC dienst gestart worden met <code>service kerberos start</code> en <code>service kadmind start</code>. Op dit moment draait er nog geen enkele daemon die gebruik maakt van Kerberos. Bevestiging dat KDC draait is te krijgen door een ticket te vragen en dat uit te lezen voor de principal (gebruiker) die zojuist is aangemaakt vanaf de commandoregel van het KDC zelf:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kinit tillman
tillman@EXAMPLE.ORG<span class=s1>&#39;s Password:

% klist
Credentials cache: FILE:/tmp/krb5cc_500
	Principal: tillman@EXAMPLE.ORG

  Issued           Expires          Principal
Aug 27 15:37:58  Aug 28 01:37:58  krbtgt/EXAMPLE.ORG@EXAMPLE.ORG</span></code></pre></div></div><div class=paragraph><p>Het ticket kan worden ingenomen wanneer u klaar bent:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kdestroy</code></pre></div></div></div><div class=sect3><h4 id=_kerberos_inschakelen_op_een_server_met_heimdal_diensten>15.7.3. Kerberos inschakelen op een server met Heimdal diensten<a class=anchor href=#_kerberos_inschakelen_op_een_server_met_heimdal_diensten></a></h4><div class=paragraph><p>Als eerste is een kopie van het instellingenbestand van Kerberos nodig, <span class=filename>/etc/krb5.conf</span>. Dit bestand kan eenvoudigweg op een veilige manier (met netwerkprogramma’s als <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a>, of fysiek via een floppy) naar de cliëntcomputer gekopieerd worden vanaf de KDC.</p></div><div class=paragraph><p>Hierna is het <span class=filename>/etc/krb5.keytab</span> nodig. Dit is het belangrijkste verschil tussen een server die een daemons met Kerberos aanbiedt en een werkstation: de server heeft het bestand <span class=filename>keytab</span> nodig. Dit bestand bevat de hostsleutel van de server waardoor het werkstation en de KDC elkaars identiteit kunnen bevestigen. Dit bestand dient veilig overgebracht te worden omdat de beveiliging van de server doorbroken kan worden als de sleutel openbaar wordt gemaakt. Dit betekent expliciet dat overdracht via een protocol dat platte tekst gebruikt, bijvoorbeeld FTP, een slecht idee is.</p></div><div class=paragraph><p>Meestal wordt <span class=filename>keytab</span> naar de server gebracht met <code>kadmin</code>. Dat werkt handig omdat ook de host principal (het KDC onderdeel van <span class=filename>krb5.keytab</span>) aangemaakt moet worden met <code>kadmin</code>.</p></div><div class=paragraph><p>Let wel op dat er al een ticket moet zijn en dat dit ticket de <code>kadmin</code> interface moet mogen gebruiken in <span class=filename>kadmind.acl</span>. Zie "Beheer op Afstand" in de Heimdal informatiepagina’s (<code>info heimdal</code>) voor details over het ontwerpen van toegangscontrole. Als <code>kadmin</code> via het netwerk geen toegang mag hebben, dan kan ook op een veilige verbinding gemaakt worden met de KDC (via het lokale console, <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> of Kerberos <a href="https://man.freebsd.org/cgi/man.cgi?query=telnet&amp;sektion=1&amp;format=html">telnet(1)</a>) zodat alles lokaal uitgevoerd kan worden met <code>kadmin -l</code>.</p></div><div class=paragraph><p>Na het installeren van <span class=filename>/etc/krb5.conf</span> kan <code>kadmin</code> van de Kerberos server gebruikt worden. Met <code>add --random-key</code> kan de host principal toegevoegd worden en met <code>ext</code> kan de host principal van de server naar zijn eigen keytab getrokken worden. Bijvoorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kadmin</span>
kadmin&gt; add <span class=nt>--random-key</span> host/myserver.example.org
Max ticket life <span class=o>[</span>unlimited]:
Max renewable life <span class=o>[</span>unlimited]:
Attributes <span class=o>[]</span>:
kadmin&gt; ext host/myserver.example.org
kadmin&gt; <span class=nb>exit</span></code></pre></div></div><div class=paragraph><p>Let op: <code>ext</code> slaat de sleutel standaard op in <span class=filename>/etc/krb5.keytab</span>.</p></div><div class=paragraph><p>Als <code>kadmind</code> niet beschikbaar is op de KDC (wellicht om beveiligingsredenen) en er via het netwerk dus geen toegang is tot <code>kadmin</code>, dan kan de host principal (<code>host/myserver.EXAMPLE.ORG</code>) ook direct aan de KDC toegevoegd worden en daarna in een tijdelijk bestand gezet worden. Het volgende kan gebruikt worden om te voorkomen dat <span class=filename>/etc/krb5.keytab</span> op de KDC) wordt overschreven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kadmin</span>
kadmin&gt; ext <span class=nt>--keytab</span><span class=o>=</span>/tmp/example.keytab host/myserver.example.org
kadmin&gt; <span class=nb>exit</span></code></pre></div></div><div class=paragraph><p>Hierna kan de keytab veilig gekopieerd worden naar de server (met <code>scp</code> of een floppy). Geef een niet-standaard naam op voor de keytab om te voorkomen dat de keytab op de KDC wordt overschreven.</p></div><div class=paragraph><p>Nu kan de server communiceren met de KDC (vanweg <span class=filename>krb5.conf</span>) en zijn identiteit bewijzen (vanwege <span class=filename>krb5.keytab</span>). Nu is de server klaar om er een aantal Kerberos diensten op te activeren. In dit voorbeeld wordt de dienst <code>telnet</code> geactiveerd door de volgende regel in <span class=filename>/etc/inetd.conf</span> te zetten en dan <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> te herstarten met <code>service inetd restart</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>telnet    stream  tcp     nowait  root    /usr/libexec/telnetd  telnetd -a user</pre></div></div><div class=paragraph><p>Het belangrijkste is dat de typering <code>-a</code> (van autenticatie) op user staat. Meer details zijn in <a href="https://man.freebsd.org/cgi/man.cgi?query=telnetd&amp;sektion=8&amp;format=html">telnetd(8)</a> te vinden.</p></div></div><div class=sect3><h4 id=_kerberos_activeren_op_een_cliënt_met_heimdal>15.7.4. Kerberos activeren op een cliënt met Heimdal<a class=anchor href=#_kerberos_activeren_op_een_cliënt_met_heimdal></a></h4><div class=paragraph><p>Het opzetten van een cliëntcomputer is eigenlijk kinderlijk eenvoudig. Wat betreft de Kerberos instelling is alleen het Kerberos instellingenbestand (<span class=filename>/etc/krb5.conf</span>) nodig. Dat kan eenvoudigweg naar de cliëntcomputer gekopieerd worden vanaf de KDC.</p></div><div class=paragraph><p>Test de cliënt met <code>kinit</code>, <code>klist</code> en <code>kdestroy</code> vanaf de cliënt om een ticket te krijgen, te bekijken en daarna te verwijderen voor de principal die hierboven is aangemaakt. Nu moeten ook Kerberos applicaties gebruikt kunnen worden om verbindingen te maken met servers waarop Kerberos is geactiveerd. Als dat niet lukt en het verkrijgen van een ticket is wel mogelijk, dan ligt dat hoogstwaarschijnlijk aan de server en niet aan de cliënt of de KDC.</p></div><div class=paragraph><p>Bij het testen van een applicatie als <code>telnet</code> kan het beste een pakketsnuffelaar (bijvoorbeeld <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a>) gebruikt worden om te bevestigen dat een wachtwoord niet als tekst wordt verzonden. Gebruik <code>telnet</code> met de optie <code>-x</code>. Dan wordt de complete gegevensstroom versleuteld (vergelijkbaar met <code>ssh</code>).</p></div><div class=paragraph><p>Er worden standaard ook andere Kerberos applicaties op de cliënt geïnstalleerd. Hier komt de "minimalistische" natuur van de basisinstallatie van Heimdal boven drijven: <code>telnet</code> is de enige dienst waarvoor Kerberos geactiveerd is.</p></div><div class=paragraph><p>De port Heimdal voegt een aantal ontbrekende cliëntapplicaties toe: versies met ondersteuning voor Kerberos van <code>ftp</code>, <code>rsh</code>, <code>rcp</code>, <code>rlogin</code> en een paar minder gebruikelijke programma’s. De MIT port bevat ook een volledig gamma aan Kerberos cliëntapplicaties.</p></div></div><div class=sect3><h4 id=_instellingenbestanden_voor_gebruikers_k5login_en_k5users>15.7.5. Instellingenbestanden voor gebruikers: <span class=filename>.k5login</span> en <span class=filename>.k5users</span><a class=anchor href=#_instellingenbestanden_voor_gebruikers_k5login_en_k5users></a></h4><div class=paragraph><p>Voor gebruikers binnen een wereld wijst hun Kerberos principal (bv. <code>tillman@EXAMPLE.ORG</code>) gewoonlijk naar een lokale gebruikersaccount (bijvoorbeeld een lokale account met de naam <code>tillman</code>). Voor cliëntapplicaties als <code>telnet</code> is gewoonlijk geen gebruikersnaam of principal nodig.</p></div><div class=paragraph><p>Soms moet iemand zonder bijpassende Kerberos principal toch toegang hebben tot een lokale gebruikersaccount. <code>tillman@EXAMPLE.ORG</code> zou bijvoorbeeld toegang nodig kunnen hebben tot de lokale gebruikersaccount <code>webdevelopers</code>. Andere principals zouden die toegang wellicht ook nodig kunnen hebben.</p></div><div class=paragraph><p>De bestanden <span class=filename>.k5login</span> en <span class=filename>.k5users</span> uit de gebruikersmap kunnen op eenzelfde manier gebruikt worden als <span class=filename>.hosts</span> en <span class=filename>.rhosts</span>. Zo wordt het voorgaande probleem opgelost. Als bijvoorbeeld een <span class=filename>.k5login</span> met de volgende inhoud:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>tillman@example.org
jdoe@example.org</code></pre></div></div><div class=paragraph><p>in de thuismap van de lokale gebruiker <code>webdevelopers</code> gezet wordt dan zouden beide principals toegang hebben tot die account zonder dat ze een wachtwoord hoeven te delen.</p></div><div class=paragraph><p>We raden aan de handleidingen voor deze commando’s te lezen. Let op dat de <code>ksu</code> handleiding <span class=filename>.k5users</span> behandelt.</p></div></div><div class=sect3><h4 id=_kerberos_tips_trucs_en_problemen_oplossen>15.7.6. Kerberos tips, trucs en problemen oplossen<a class=anchor href=#_kerberos_tips_trucs_en_problemen_oplossen></a></h4><div class=ulist><ul><li><p>Als de Heimdal of MITKerberos port wordt gebruikt dan dient de <code>PATH</code> omgevingsvariabele de Kerberos versies van de cliëntapplicaties te tonen voor de systeemversies.</p></li><li><p>Hebben alle computers in de wereld hun tijd gesynchroniseerd? Als dat niet zo is, dan slaagt de autenticatie wellicht niet. <a href=./#network-ntp>Tijd synchroniseren met NTP</a> beschrijft hoe klokken met NTP gesynchroniseerd kunnen worden.</p></li><li><p>MIT en Heimdal werken prima samen. Dit geldt niet voor <code>kadmin</code> omdat daarvoor geen protocolstandaard is.</p></li><li><p>Als een hostnaam wordt gewijzigd, dan moet ook de <code>host/</code> principal aangepast en de keytab. Dit geldt ook voor bijzondere instellingen in de keytab zoals de <code>www/</code> principal voor <a class=package href=https://cgit.freebsd.org/ports/tree/www/mod_auth_kerb/>www/mod_auth_kerb</a> van Apache.</p></li><li><p>Alle hosts in een wereld moeten oplosbaar (resolvable) zijn (zowel vooruit als achteruit) in de DNS (of tenminste in <span class=filename>/etc/hosts</span>). CNAMEs werken wel, maar de A en PTR records moeten juist en actief zijn. De foutmelding is niet erg duidelijk: <code>Kerberos5 refuses authentication because Read req failed: Key table entry not found</code>.</p></li><li><p>Sommige besturingssystemen van cliënten voor een KDC zetten wellicht geen setuid <code>root</code> voor <code>ksu</code>. Dit betekent dat <code>ksu</code> niet werkt. Dat is vanuit beveiligingsoogpunt een prima idee, maar wel lastig. Dit is dus geen KDC-fout.</p></li><li><p>Als met MITKerberos een principal een ticket moet krijgen dat langer geldig is dan de standaard van tien uur, dan moet <code>modify_principal</code> in <code>kadmin</code> gebruikt worden om de maximale geldigheidsduur (maxlife) van zowel de principal waar het om gaat als de <code>krbtgt</code> principal aan te passen. Dan kan de principal <code>kinit`</code>-l` gebruiken om een ticket met een langere levensduur aan te vragen.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als een pakketsnuffelaar op de KDC draait bij om te helpen bij het oplossen van problemen en dan <code>kinit</code> vanaf een werkstation wordt gestart, dan wordt zichtbaar dat de TGT meteen wordt verstuurd als <code>kinit</code> start, zelfs nog voor het wachtwoord! De reden hiervoor is dat de Kerberos server vrijelijk een TGT (Ticket Granting Ticket) verstuurt op iedere niet geautoriseerd verzoek. Maar iedere TGT is versleuteld met een sleutel die is afgeleid van het wachtwoord van de gebruiker. Als een gebruiker zijn wachtwoord ingeeft, wordt dat dus niet naar de KDC gezonden, maar ontcijfert het de TGT die <code>kinit</code> al heeft ontvangen. Als de ontcijfering resulteert in een geldige ticket met een geldige tijdstempel, dan heeft de gebruiker geldige Kerberos rechten. Deze rechten bevatten ook een sessiesleutel voor het opzetten van beveiligde communicatie met de Kerberos server in de toekomst en de eigenlijke ticket-granting ticket, die is versleuteld met de sleutel van de Kerberos server zelf. Deze tweede laag van versleuteling is niet bekend voor de gebruiker, maar het stelt de Kerberos server in staat om de juistheid van iedere TGT te bevestigen.</p></div></td></tr></tbody></table></div></li><li><p>Als tickets worden gebruik die lang geldig zijn (bv. een week) en OpenSSH wordt gebruikt om een verbinding te maken met de machine waarop het ticket staat, zorg er dan voor dat de Kerberos optie <code>TicketCleanup</code> op <code>no</code> staat in <span class=filename>sshd_config</span> want anders worden tickets verwijderd bij afmelden.</p></li><li><p>Hostprincipals kunnen ook een langere levensduur hebben. Als een gebruikers principal een levensduur van een week heeft, maar de host waar de verbinding mee gemaakt wordt heeft een levensduur van negen uur, dan heb staat er een verlopen host principal in de cache en dan werkt een en ander niet zoals verwacht.</p></li><li><p>Een <span class=filename>krb5.dict</span> bestand om het gebruik van bepaalde slechte wachtwoorden te voorkomen (dit wordt kort behandeld in de handleiding voor <code>kadmind</code>) heeft alleen betrekking op principals waar een wachtwoordbeleid voor geldt. De opmaak van <span class=filename>krb5.dict</span> is eenvoudig: een rij tekens per regel. Een symbolische link maken naar <span class=filename>/usr/shared/dict/words</span> is misschien handig.</p></li></ul></div></div><div class=sect3><h4 id=_verschillen_met_de_mit_port>15.7.7. Verschillen met de MIT port<a class=anchor href=#_verschillen_met_de_mit_port></a></h4><div class=paragraph><p>Het belangrijkste verschil tussen de MIT en Heimdal installatie heeft betrekking op <code>kadmin</code>, dat een andere (maar gelijkwaardige) set commando’s kent en een andere protocol gebruikt. Dit betekent nogal wat als een KDCMIT is, omdat dan de <code>kadmin</code> van Heimdal niet gebruikt kan worden om de KDC vanaf afstand te beheren (dat geldt trouwens ook vice versa).</p></div><div class=paragraph><p>De cliëntapplicaties kunnen ook commandoregelopties gebruiken die een beetje verschillen, maar waarmee wel hetzelfde wordt bereikt. We raden aan de instructies op de MITKerberos website (<a href=http://web.mit.edu/Kerberos/www/>http://web.mit.edu/Kerberos/www/</a>) te volgen. Wees voorzichtig met paden: de MIT-port installeert standaard in <span class=filename>/usr/local/</span> en dus kunnen de "normale" systeemapplicaties gestart worden in plaats van die van MIT als de <code>PATH</code> omgevingsvariabele de systeemmappen als eerste weergeeft.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als de MIT<a class=package href=https://cgit.freebsd.org/ports/tree/security/krb5/>security/krb5</a> port die bij FreeBSD zit wordt gebruikt, dan zorgt het lezen van <span class=filename>/usr/local/shared/doc/krb5/README.FreeBSD</span> dat bij de port wordt geïnstalleerd voor een beter begrip over waarom het aanmelden via <code>telnetd</code> en <code>klogind</code> soms wat vreemd verloopt. Als belangrijkste wijzen we erop dat het bij het corrigeren van "onjuiste rechten op het cachebestand" noodzakelijk is dat het binaire bestand <code>login.krb5</code> wordt gebruikt voor autenticatie zodat het op de juiste wijze eigenaarschap kan wijzigen voor de doorgegeven rechten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het bestand <span class=filename>rc.conf</span> moet ook gewijzigd worden zodat het de volgende configuratie bevat:</p></div><div class="literalblock programlisting"><div class=content><pre>kerberos5_server=&#34;/usr/local/sbin/krb5kdc&#34;
kadmind5_server=&#34;/usr/local/sbin/kadmind&#34;
kerberos5_server_enable=&#34;YES&#34;
kadmind5_server_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Dit is gedaan omdat de applicaties voor MIT-Kerberos binairen in de hiërarchie <span class=filename>/usr/local</span> installeren.</p></div></div><div class=sect3><h4 id=_beperkingen_in_kerberos>15.7.8. Beperkingen in Kerberos<a class=anchor href=#_beperkingen_in_kerberos></a></h4><div class=sect4><h5 id=_kerberos_is_een_alles_of_niets_aanpak>15.7.8.1. Kerberos is een alles of niets aanpak<a class=anchor href=#_kerberos_is_een_alles_of_niets_aanpak></a></h5><div class=paragraph><p>Iedere ingeschakelde dienst op het netwerk moet aangepast worden om met Kerberos te werken (of op een andere manier beschermd zijn tegen netwerkaanvallen), want anders kunnen gebruikersrechten worden gestolen en herbruikt. Een voorbeeld hier van is het inschakelen van Kerberos voor alle shells op afstand (via <code>rsh</code> en <code>telnet</code> bijvoorbeeld), maar de POP3 mailserver die wachtwoorden als platte tekst verzend ongemoeid laten.</p></div></div><div class=sect4><h5 id=_kerberos_is_bedoeld_voor_werkstations_met_een_gebruiker>15.7.8.2. Kerberos is bedoeld voor werkstations met een gebruiker<a class=anchor href=#_kerberos_is_bedoeld_voor_werkstations_met_een_gebruiker></a></h5><div class=paragraph><p>In een meergebruikersomgeving is Kerberos minder veilig. Dit komt doordat de tickets worden opgeslagen in de map <span class=filename>/tmp</span>, waar gelezen kan worden door alle gebruikers. Als een gebruiker een computer deelt met andere gebruikers op hetzelfde moment (dus multi-user), dan is het mogelijk dat een ticket van een gebruiker wordt gestolen (gekopieerd) door een andere gebruiker.</p></div><div class=paragraph><p>Dit kan voorkomen worden met de commandoregeloptie "`-c` bestandsnaam" of (bij voorkeur) de omgevingsvariabele <code>KRB5CCNAME</code>, maar dat wordt zelden gedaan. In principe kan het opslaan van een ticket in de thuismap van een gebruiker in combinatie met eenvoudige bestandsrechten dit probleem verhelpen.</p></div></div><div class=sect4><h5 id=_de_kdc_is_een_single_point_of_failure>15.7.8.3. De KDC is een single point of failure<a class=anchor href=#_de_kdc_is_een_single_point_of_failure></a></h5><div class=paragraph><p>Zoals het is ontworpen, moet de KDC zo goed mogelijk beveiligd zijn, omdat de hoofdwachtwoorddatabase erop staat. De KDC hoort geen enkele andere dienst aan te bieden en moet ook fysiek afgeschermd worden. Het gevaar is groot, omdat Kerberos alle wachtwoorden versleutelt met dezelfde sleutel (de "master" sleutel) die als een bestand op de KDC staat.</p></div><div class=paragraph><p>Toch is een gecompromitteerde mastersleutel niet zo’n groot probleem als wellicht wordt verondersteld. De mastersleutel wordt alleen gebruikt om de Kerberos database te versleutelen en als zaad voor de generator van willekeurige nummers. Zo lang als de toegang tot de KDC is beveiligd, kan een aanvaller niet echt iets doen met de mastersleutel.</p></div><div class=paragraph><p>Als de KDC niet beschikbaar is (misschien door een ontzeggen van dienst aanval of netwerkproblemen) kunnen de netwerkdiensten niet gebruikt worden omdat er geen autenticatie uitgevoerd kan worden; een recept voor een ontzeggen van dienst aanval. Dit risico kan omzeild worden door meerdere KDC’s (één master en één of meer slaven) en een zorgvuldige implementatie van secundaire of fall-back autenticatie. PAM is hier uitermate geschikt voor.</p></div></div><div class=sect4><h5 id=_tekortkomingen_van_kerberos>15.7.8.4. Tekortkomingen van Kerberos<a class=anchor href=#_tekortkomingen_van_kerberos></a></h5><div class=paragraph><p>Kerberos stelt gebruikers, hosts en diensten in staat om elkaar te autenticeren. Maar het heeft geen mechanisme om de KDC te autenticeren aan de gebruikers, hosts of diensten. Dit betekent dat bijvoorbeeld een vervalste <code>kinit</code> alle gebruikersnamen en wachtwoorden zou kunnen afluisteren. Iets als <a class=package href=https://cgit.freebsd.org/ports/tree/security/tripwire/>security/tripwire</a> of andere controle-instrumenten voor de integriteit van bestandssystemen kunnen hier verlichting brengen.</p></div></div></div><div class=sect3><h4 id=_bronnen_en_verdere_informatie>15.7.9. Bronnen en verdere informatie<a class=anchor href=#_bronnen_en_verdere_informatie></a></h4><div class=ulist><ul><li><p><a href=http://www.faqs.org/faqs/Kerberos-faq/general/preamble.html>De Kerberos FAQ</a> (Engels)</p></li><li><p><a href=http://web.mit.edu/Kerberos/www/dialogue.html>Een Autenticatiesysteem Ontwerpen: een Dialoog in Vier Scenes</a> (Engels)</p></li><li><p><a href="http://www.ietf.org/rfc/rfc1510.txt?number=1510">RFC 1510, De Kerberos Netwerk Authenticatie Dienst (V5)</a> (Engels)</p></li><li><p><a href=http://web.mit.edu/Kerberos/www/>MIT Kerberos homepage</a></p></li><li><p><a href=http://www.pdc.kth.se/heimdal/>Heimdal Kerberos homepage</a></p></li></ul></div></div></div><div class=sect2><h3 id=openssl>15.8. OpenSSL<a class=anchor href=#openssl></a></h3><div class=paragraph><p>Een toepassing die bij FreeBSD zit die veel gebruikers over het hoofd zien is OpenSSL. OpenSSL biedt een versleutelde transportlaag bovenop de normale communicatielaag. Daardoor biedt het de mogelijkheid met veel netwerktoepassingen en diensten verweven te raken.</p></div><div class=paragraph><p>Een aantal toepassingen van OpenSSL zijn versleutelde autenticatie van mailcliënten, webgebaseerde transacties als creditcardbetalingen en nog veel meer. Veel ports zoals <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache22/>www/apache22</a> en <a class=package href=https://cgit.freebsd.org/ports/tree/mail/claws-mail/>mail/claws-mail</a> bieden tijdens het compileren ondersteuning om OpenSSL in te bouwen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In de meeste gevallen zal de Portscollectie proberen de port <a class=package href=https://cgit.freebsd.org/ports/tree/security/openssl/>security/openssl</a> te bouwen, tenzij de make variabele <code>WITH_OPENSSL_BASE</code> expliciet naar "yes" is gezet.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De versie van OpenSSL die bij FreeBSD zit ondersteunt Secure Sockets Layer v2/v3 (SSLv2/SSLv3), Transport Layer Security v1 (TLSv1) netwerkbeveiligingsprotocollen en kan gebruikt worden als generieke versleutelingsbibliotheek.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Hoewel OpenSSL ondersteuning biedt voor het IDEA algoritme, is dat standaard uitgeschakeld in verband met patenten in de Verenigde Staten. Om het te gebruiken dient de licentie gelezen te worden en, als de restricties aanvaardbaar zijn, dient de make-variabele <code>MAKE_IDEA</code> ingesteld te worden in <span class=filename>make.conf</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Een van de meest gebruikte toepassingen van OpenSSL is het leveren van certificaten voor gebruik met softwaretoepassingen. Deze certificaten verzekeren dat de eigenschappen van een bedrijf of individu geldig zijn en niet vervalst. Als het certificaat in kwestie niet geldig verklaard is door een van de "Certificate Authorities" of CA’s, dan komt er een waarschuwing. Een Certificate Authority is een bedrijf, zoals <a href=http://www.verisign.com>VeriSign</a>, dat certificaten ondertekent zodat de eigenschappen van een bedrijf of individu geldig verklaard kunnen worden. Dit proces kost geld en het is zeker geen voorwaarde voor het gebruik van certificaten. Het stelt wel de meer paranoïde gebruikers gerust.</p></div><div class=sect3><h4 id=_certificaten_maken>15.8.1. Certificaten maken<a class=anchor href=#_certificaten_maken></a></h4><div class=paragraph><p>Voor het maken van certificaten is het volgende commando beschikbaar:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl req -new -nodes -out req.pem -keyout cert.pem</span>
Generating a 1024 bit RSA private key
................
.......................................
writing new private key to <span class=s1>&#39;cert.pem&#39;</span>
<span class=nt>-----</span>
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter <span class=s1>&#39;.&#39;</span>, the field will be left blank.
<span class=nt>-----</span>
Country Name <span class=o>(</span>2 letter code<span class=o>)</span> <span class=o>[</span>AU]:US
State or Province Name <span class=o>(</span>full name<span class=o>)</span> <span class=o>[</span>Some-State]:PA
Locality Name <span class=o>(</span>eg, city<span class=o>)</span> <span class=o>[]</span>:Pittsburgh
Organization Name <span class=o>(</span>eg, company<span class=o>)</span> <span class=o>[</span>Internet Widgits Pty Ltd]:My Company
Organizational Unit Name <span class=o>(</span>eg, section<span class=o>)</span> <span class=o>[]</span>:Systems Administrator
Common Name <span class=o>(</span>eg, YOUR name<span class=o>)</span> <span class=o>[]</span>:localhost.example.org
Email Address <span class=o>[]</span>:trhodes@FreeBSD.org

Please enter the following <span class=s1>&#39;extra&#39;</span> attributes
to be sent with your certificate request
A challenge password <span class=o>[]</span>:SOME PASSWORD
An optional company name <span class=o>[]</span>:Another Name</code></pre></div></div><div class=paragraph><p>Let op dat het antwoord direct na "Common Name" een domeinnaam weergeeft. De prompt wil dat er een servernaam wordt ingegeven voor het verificatieproces. Het plaatsen van iets anders dan een domeinnaam zorgt ervoor dat het certificaat waardeloos wordt. Er zijn ook andere opties als verloopdatum, andere versleutelingsalgoritmes, etc, beschikbaar. Een volledige lijst is na te lezen in de handleiding van <a href="https://man.freebsd.org/cgi/man.cgi?query=openssl&amp;sektion=1&amp;format=html">openssl(1)</a>.</p></div><div class=paragraph><p>Er horen nu twee bestanden te staan in de map waarin het voorgaande commando is uitgevoerd. Het certificaatverzoek, <span class=filename>req.pem</span>, kan naar een certificaat autoriteit gestuurd worden die de bijgevoegde gegevens kan valideren, het verzoek kan tekenen en het certificaat kan retourneren. Het tweede bestand heet <span class=filename>cert.pem</span> en is de geheime sleutel voor het certificaat. Deze dient zorgvuldig beschermd te worden. Als de geheime sleutel in de handen van anderen valt kan die gebruikt worden om de identiteit van de eigenaar (of server) aan te nemen.</p></div><div class=paragraph><p>In gevallen waar ondertekening door een CA niet vereist is, kan een zelfondertekend certificaat gemaakt worden. Maak als eerste de RSA sleutel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl dsaparam -rand -genkey -out myRSA.key 1024</span></code></pre></div></div><div class=paragraph><p>Hierna kan de CA sleutel gemaakt worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl gendsa -des3 -out myca.key myRSA.key</span></code></pre></div></div><div class=paragraph><p>Deze sleutel kan gebruikt worden om een certificaat te maken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl req -new -x509 -days 365 -key myca.key -out new.crt</span></code></pre></div></div><div class=paragraph><p>Er zouden nu twee bestanden bijgekomen moeten zijn in de map: een certificaatautoriteit ondertekeningsbestand <span class=filename>myca.key</span> en <span class=filename>new.crt</span>, het certificaat zelf. Deze moeten in een map geplaatst worden, bij voorkeur onder <span class=filename>/etc</span> waar alleen <code>root</code> kan lezen. De rechten 0700 zijn hier prima en die kunnen ingesteld worden met <code>chmod</code>.</p></div></div><div class=sect3><h4 id=_certificaten_gebruiken_een_voorbeeld>15.8.2. Certificaten gebruiken: een voorbeeld<a class=anchor href=#_certificaten_gebruiken_een_voorbeeld></a></h4><div class=paragraph><p>En wat kunnen deze bestanden? Een prima toepassing zou het versleutelen van verbindingen naar de SendmailMTA kunnen zijn. Daardoor zouden gebruikers niet langer platte tekst hoeven te autenticeren om mail te sturen via de lokale MTA.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Dit is niet de best denkbare toepassing omdat sommige MUA’s de gebruiker een foutmelding geven als ze het certificaat niet lokaal geïnstalleerd hebben. De documentatie bij de software geeft meer informatie over het installeren van certificaten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De volgende regels moeten opgenomen worden in het lokale <span class=filename>.mc</span> bestand:</p></div><div class="literalblock programlisting"><div class=content><pre>dnl SSL Options
define(`confCACERT_PATH&#39;,`/etc/certs&#39;)dnl
define(`confCACERT&#39;,`/etc/certs/new.crt&#39;)dnl
define(`confSERVER_CERT&#39;,`/etc/certs/new.crt&#39;)dnl
define(`confSERVER_KEY&#39;,`/etc/certs/myca.key&#39;)dnl
define(`confTLS_SRV_OPTIONS&#39;, `V&#39;)dnl</pre></div></div><div class=paragraph><p><span class=filename>/etc/certs/</span> is de map die gebruikt wordt voor het lokaal opslaan van certificaten en sleutels. De laatste voorwaarde het is opnieuw aanmaken van het lokale <span class=filename>.cf</span> bestand. Dit gaat door eenvoudigweg <code>make install</code> te typen in de map <span class=filename>/etc/mail</span>. Laat dat volgen door <code>make install</code> waardoor de daemon Sendmail herstart zou moeten worden.</p></div><div class=paragraph><p>Als alles goed is gegaan, dan staan er geen foutmeldingen <span class=filename>/var/log/maillog</span> en is Sendmail zichtbaar in de proceslijst.</p></div><div class=paragraph><p>Maak als eenvoudige test een verbinding met de mailserver met <a href="https://man.freebsd.org/cgi/man.cgi?query=telnet&amp;sektion=1&amp;format=html">telnet(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># telnet example.com 25</span>
Trying 192.0.34.166...
Connected to example.com.
Escape character is <span class=s1>&#39;^]&#39;</span><span class=nb>.</span>
220 example.com ESMTP Sendmail 8.12.10/8.12.10<span class=p>;</span> Tue, 31 Aug 2004 03:41:22 <span class=nt>-0400</span> <span class=o>(</span>EDT<span class=o>)</span>
ehlo example.com
250-example.com Hello example.com <span class=o>[</span>192.0.34.166], pleased to meet you
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-8BITMIME
250-SIZE
250-DSN
250-ETRN
250-AUTH LOGIN PLAIN
250-STARTTLS
250-DELIVERBY
250 HELP
quit
221 2.0.0 example.com closing connection
Connection closed by foreign host.</code></pre></div></div><div class=paragraph><p>Als de regel "STARTTLS" verschijnt in de uitvoer dan werkt alles correct.</p></div></div></div><div class=sect2><h3 id=ipsec>15.9. VPN via IPsec<a class=anchor href=#ipsec></a></h3><div class=paragraph><p>Een VPN opzetten met FreeBSD gateways tussen twee netwerken die gescheiden zijn door Internet.</p></div><div class=sect3><h4 id=_ipsec_begrijpen>15.9.1. IPsec begrijpen<a class=anchor href=#_ipsec_begrijpen></a></h4><div class=paragraph><p>Deze paragraaf is een gids in het proces van het opzetten van IPsec. Voordat IPsec opgezet kan worden dient de lezer bekend te zijn met de concepten die nodig zijn om een aangepaste kernel te bouwen (zie <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>).</p></div><div class=paragraph><p><em>IPsec</em> is een protocol dat bovenop de Internet Protocol (IP) laag ligt. Hiermee kunnen twee of meer host op een veilige manier communiceren (vandaar de naam). De FreeBSD IPsec "netwerk wachtrij (stack)" is gebaseerd op de <a href=http://www.kame.net/>KAME</a>-implementatie, die zowel de protocolfamilies IPv4 als de IPv6 ondersteunt.</p></div><div class=paragraph><p>IPsec bestaat uit twee subprotocollen:</p></div><div class=ulist><ul><li><p><em>Encapsulated Security Payload (ESP)</em> beschermt de IP-pakketdata tegen inmenging door een derde partij door de inhoud te versleutelen met symmetrische versleutelingsalgoritmes (zoals Blowfish en 3DES).</p></li><li><p><em>Authentication Header (AH)</em> beschermt de IP-pakketkop tegen inmenging door een derde partij en spoofing door een cryptografische checksum te berekenen en de IP-pakketkopvelden te hashen met een veilige hashfunctie. Hierna wordt een extra kop ingevoegd die de hash bevat zodat de informatie in het pakket geautenticeerd kan worden.</p></li></ul></div><div class=paragraph><p>ESP en AH kunnen samen of apart gebruikt worden, afhankelijk van de omgeving.</p></div><div class=paragraph><p>IPsec kan gebruikt worden om het verkeer tussen twee hosts direct te versleutelen (dat heet <em>Transport Mode</em>) of door "virtuele tunnels" te bouwen tussen twee subnetten die gebruikt kunnen worden voor veilige communicatie tussen twee bedrijfsnetwerken (dat heet <em>Tunnel Mode</em>). De laatste versie staat beter bekend als <em>Virtual Private Network (VPN)</em>. In <a href="https://man.freebsd.org/cgi/man.cgi?query=ipsec&amp;sektion=4&amp;format=html">ipsec(4)</a> staat gedetailleerde informatie over het IPsec subsysteem in FreeBSD.</p></div><div class=paragraph><p>Voor ondersteuning voor IPsec in de kernel zijn de volgende opties nodig in het kernelinstellingenbestand:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>options   IPSEC        IP-beveiliging
device    crypto</code></pre></div></div><div class=paragraph><p>Als er ook fouten in IPsec (debugging) verwijderd moeten kunnen worden, dan is de volgende optie ook nodig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>options   IPSEC_DEBUG  debug voor IP-beveiliging</code></pre></div></div></div><div class=sect3><h4 id=_het_probleem>15.9.2. Het probleem<a class=anchor href=#_het_probleem></a></h4><div class=paragraph><p>Er bestaat geen standaard voor wat een VPN is. VPN’s kunnen opgezet worden met behulp van een aantal verschillende technologieën die allemaal hun eigen voor- en nadelen hebben. Dit onderdeel bevat een scenario en de strategieën die gebruikt kunnen worden voor het implementeren van een VPN in iedere situatie.</p></div></div><div class=sect3><h4 id=_het_scenario_twee_netwerken_de_ene_thuisgebaseerd_en_de_andere_bedrijfgebaseerd_beide_zijn_verbonden_met_het_internet_en_er_wordt_van_verwacht_dat_ze_zich_via_dit_vpn_als_één_gedragen>15.9.3. Het scenario: twee netwerken, de ene thuisgebaseerd en de andere bedrijfgebaseerd. Beide zijn verbonden met het Internet, en er wordt van verwacht dat ze zich via dit VPN als één gedragen.<a class=anchor href=#_het_scenario_twee_netwerken_de_ene_thuisgebaseerd_en_de_andere_bedrijfgebaseerd_beide_zijn_verbonden_met_het_internet_en_er_wordt_van_verwacht_dat_ze_zich_via_dit_vpn_als_één_gedragen></a></h4><div class=paragraph><p>Dit is het uitgangspunt:</p></div><div class=ulist><ul><li><p>Er zijn tenminste twee locaties</p></li><li><p>Beide locaties gebruiken IP</p></li><li><p>Beide locaties hebben een Internetverbinding via een gateway waarop FreeBSD draait.</p></li><li><p>De gateway op ieder netwerk heeft tenminste één publiek IP-adres.</p></li><li><p>De interne adressen van de twee netwerken mogen publieke of private IP-adressen zijn, dat maakt niet uit. Ze mogen alleen niet botsen; bijvoorbeeld: ze mogen niet beide <code>192.168.1.x</code> gebruiken.</p></li></ul></div></div><div class=sect3><h4 id=_ipsec_configureren_op_freebsd>15.9.4. IPsec configureren op FreeBSD<a class=anchor href=#_ipsec_configureren_op_freebsd></a></h4><div class=paragraph><p>Om te beginnen moet de port <a class=package href=https://cgit.freebsd.org/ports/tree/security/ipsec-tools/>security/ipsec-tools</a> geïnstalleerd zijn vanuit de Portscollectie. Dit softwarepakket van een derde partij biedt een aantal applicaties die helpen de configuratie te ondersteunen.</p></div><div class=paragraph><p>De volgende benodigdheid is om twee <a href="https://man.freebsd.org/cgi/man.cgi?query=gif&amp;sektion=4&amp;format=html">gif(4)</a> pseudo-apparaten aan te maken om de pakketten te tunnelen en beide netwerken in staat stellen om op een juiste wijze te communiceren. Draai als <code>root</code> de volgende commando’s, waarbij de items <em>intern</em> en <em>extern</em> met de echte interne en externe gateways:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig gif0 create</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig gif0 intern1 intern2</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig gif0 tunnel extern1 extern2</span></code></pre></div></div><div class=paragraph><p>Het publieke IP van het LAN van de onderneming is bijvoorbeeld <code>172.16.5.4</code> en het heeft een privaat IP`10.246.38.1`. Het publieke IP van het LAN van huis is <code>192.168.1.12</code> met een intern privaat IP`10.0.0.5`.</p></div><div class=paragraph><p>Dit kan verwarrend lijken, dus bekijk de volgende voorbeeld van het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>Gateway 1:

gif0: flags=8051 mtu 1280
tunnel inet 172.16.5.4 --&gt; 192.168.1.12
inet6 fe80::2e0:81ff:fe02:5881%gif0 prefixlen 64 scopeid 0x6
inet 10.246.38.1 --&gt; 10.0.0.5 netmask 0xffffff00

Gateway 2:

gif0: flags=8051 mtu 1280
tunnel inet 192.168.1.12 --&gt; 172.16.5.4
inet 10.0.0.5 --&gt; 10.246.38.1 netmask 0xffffff00
inet6 fe80::250:bfff:fe3a:c1f%gif0 prefixlen 64 scopeid 0x4</pre></div></div><div class=paragraph><p>Eenmaal compleet zouden beide private IP’s bereikbaar moeten zijn met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> zoals de volgende uitvoer suggereert:</p></div><div class="literalblock programlisting"><div class=content><pre>priv-net# ping 10.0.0.5
PING 10.0.0.5 (10.0.0.5): 56 data bytes
64 bytes from 10.0.0.5: icmp_seq=0 ttl=64 time=42.786 ms
64 bytes from 10.0.0.5: icmp_seq=1 ttl=64 time=19.255 ms
64 bytes from 10.0.0.5: icmp_seq=2 ttl=64 time=20.440 ms
64 bytes from 10.0.0.5: icmp_seq=3 ttl=64 time=21.036 ms
--- 10.0.0.5 ping statistics ---
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max/stddev = 19.255/25.879/42.786/9.782 ms

corp-net# ping 10.246.38.1
PING 10.246.38.1 (10.246.38.1): 56 data bytes
64 bytes from 10.246.38.1: icmp_seq=0 ttl=64 time=28.106 ms
64 bytes from 10.246.38.1: icmp_seq=1 ttl=64 time=42.917 ms
64 bytes from 10.246.38.1: icmp_seq=2 ttl=64 time=127.525 ms
64 bytes from 10.246.38.1: icmp_seq=3 ttl=64 time=119.896 ms
64 bytes from 10.246.38.1: icmp_seq=4 ttl=64 time=154.524 ms
--- 10.246.38.1 ping statistics ---
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev = 28.106/94.594/154.524/49.814 ms</pre></div></div><div class=paragraph><p>Zoals verwacht hebben beide kanten de mogelijkheid om ICMP-pakketten te verzenden en te ontvangen van de privaat geconfigureerde adressen. Vervolgens dient aan beide gateways verteld te worden hoe pakketten te routeren om op de juiste wijze verkeer van een van de netwerken te versturen. Het volgende commando doet dit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># corp-net# route add 10.0.0.0 10.0.0.5 255.255.255.0</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># corp-net# route add net 10.0.0.0: gateway 10.0.0.5</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># priv-net# route add 10.246.38.0 10.246.38.1 255.255.255.0</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># priv-net# route add host 10.246.38.0: gateway 10.246.38.1</span></code></pre></div></div><div class=paragraph><p>Op dit moment dienen interne machines bereikbaar te zijn vanuit elke gateway alsook als vanuit machines achter de gateways. Dit is eenvoudig te zien aan het volgende voorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>corp-net# ping 10.0.0.8
PING 10.0.0.8 (10.0.0.8): 56 data bytes
64 bytes from 10.0.0.8: icmp_seq=0 ttl=63 time=92.391 ms
64 bytes from 10.0.0.8: icmp_seq=1 ttl=63 time=21.870 ms
64 bytes from 10.0.0.8: icmp_seq=2 ttl=63 time=198.022 ms
64 bytes from 10.0.0.8: icmp_seq=3 ttl=63 time=22.241 ms
64 bytes from 10.0.0.8: icmp_seq=4 ttl=63 time=174.705 ms
--- 10.0.0.8 ping statistics ---
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev = 21.870/101.846/198.022/74.001 ms

priv-net# ping 10.246.38.107
PING 10.246.38.1 (10.246.38.107): 56 data bytes
64 bytes from 10.246.38.107: icmp_seq=0 ttl=64 time=53.491 ms
64 bytes from 10.246.38.107: icmp_seq=1 ttl=64 time=23.395 ms
64 bytes from 10.246.38.107: icmp_seq=2 ttl=64 time=23.865 ms
64 bytes from 10.246.38.107: icmp_seq=3 ttl=64 time=21.145 ms
64 bytes from 10.246.38.107: icmp_seq=4 ttl=64 time=36.708 ms
--- 10.246.38.107 ping statistics ---
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev = 21.145/31.721/53.491/12.179 ms</pre></div></div><div class=paragraph><p>De tunnels opzetten is het eenvoudige deel. Het configureren van een veilige verbinding is een veel diepgaander proces. De volgende configuratie gebruikt vooraf gedeelde (PSK) RSA-sleutels. Afgezien van de IP-adressen zijn beide bestanden <span class=filename>/usr/local/etc/racoon/racoon.conf</span> identiek en zien ze er ongeveer als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>path    pre_shared_key  &#34;/usr/lcoal/etc/racoon/psk.txt&#34;; # plaats van bestand vooraf gedeelde sleutels
log     debug;  # verbositeitsinstelling van loggen: op &#39;notify&#39; zetten als testen en debuggen klaar is

padding # opties moeten niet veranderd worden
{
        maximum_length  20;
        randomize       off;
        strict_check    off;
        exclusive_tail  off;
}

timer   # timingopties, veranderen indien nodig
{
        counter         5;
        interval        20 sec;
        persend         1;
#       natt_keepalive  15 sec;
        phase1          30 sec;
        phase2          15 sec;
}

listen  # adres [poort] waarop racoon luistert
{
        isakmp          172.16.5.4 [500];
        isakmp_natt     172.16.5.4 [4500];
}

remote  192.168.1.12 [500]
{
        exchange_mode   main,aggressive;
        doi             ipsec_doi;
        situation       identity_only;
        my_identifier   address 172.16.5.4;
        peers_identifier        address 192.168.1.12;
        lifetime        time 8 hour;
        passive         off;
        proposal_check  obey;
#       nat_traversal   off;
        generate_policy off;

                        proposal {
                                encryption_algorithm    blowfish;
                                hash_algorithm          md5;
                                authentication_method   pre_shared_key;
                                lifetime time           30 sec;
                                dh_group                1;
                        }
}

sainfo  (address 10.246.38.0/24 any address 10.0.0.0/24 any)   # adres $netwerk/$netmasker $type adres $netwerk/$netmasker $type ( $type is any of esp)
{
        pfs_group       1;
        lifetime        time    3600 sec;
        encryption_algorithm    blowfish,3des,des;
        authentication_algorithm        hmac_md5,hmac_sha1;
        compression_algorithm   deflate;
}</pre></div></div><div class=paragraph><p>Het uitleggen van elke beschikbare optie, samen met diegenen in deze voorbeelden valt buiten het bereik van dit document. De configuratiehandleiding van racoon staat vol relevante informatie.</p></div><div class=paragraph><p>De SPD-beleiden moeten geconfigureerd worden zodat FreeBSD en racoon in staat zijn om netwerkverkeer tussen hosts te versleutelen en te ontsleutelen.</p></div><div class=paragraph><p>Deze taak kan met een eenvoudig shellscript zoals het volgende dat op de gateway van de onderneming staat worden uitgevoerd. Dit bestand wordt gebruikt tijdens de systeeminitialisatie en dient bewaard te worden als <span class=filename>/usr/local/etc/racoon/setkey.conf</span>.</p></div><div class="literalblock programlisting"><div class=content><pre>flush;
spdflush;
# Naar het thuisnetwerk
spdadd 10.246.38.0/24 10.0.0.0/24 any -P out ipsec esp/tunnel/172.16.5.4-192.168.1.12/use;
spdadd 10.0.0.0/24 10.246.38.0/24 any -P in esp/tunnel/192.168.1.12-172.16.5.4/use;</pre></div></div><div class=paragraph><p>Eenmaal aanwezig kan racoon op beide gateways gestart worden met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/racoon -F -f /usr/local/etc/racoon/racoon.conf -l /var/log/racoon.log</span></code></pre></div></div><div class=paragraph><p>De uitvoer moet ongeveer gelijk zijn aan de volgende:</p></div><div class="literalblock programlisting"><div class=content><pre>corp-net# /usr/local/sbin/racoon -F -f /usr/local/etc/racoon/racoon.conf
Foreground mode.
2006-01-30 01:35:47: INFO: begin Identity Protection mode.
2006-01-30 01:35:48: INFO: received Vendor ID: KAME/racoon
2006-01-30 01:35:55: INFO: received Vendor ID: KAME/racoon
2006-01-30 01:36:04: INFO: ISAKMP-SA established 172.16.5.4[500]-192.168.1.12[500] spi:623b9b3bd2492452:7deab82d54ff704a
2006-01-30 01:36:05: INFO: initiate new phase 2 negotiation: 172.16.5.4[0]192.168.1.12[0]
2006-01-30 01:36:09: INFO: IPsec-SA established: ESP/Tunnel 192.168.1.12[0]-&gt;172.16.5.4[0] spi=28496098(0x1b2d0e2)
2006-01-30 01:36:09: INFO: IPsec-SA established: ESP/Tunnel 172.16.5.4[0]-&gt;192.168.1.2[0] spi=47784998(0x2d92426)
2006-01-30 01:36:13: INFO: respond new phase 2 negotiation: 172.16.5.4[0]192.168.1.12[0]
2006-01-30 01:36:18: INFO: IPsec-SA established: ESP/Tunnel 192.168.1.12[0]-&gt;172.16.5.4[0] spi=124397467(0x76a279b)
2006-01-30 01:36:18: INFO: IPsec-SA established: ESP/Tunnel 172.16.5.4[0]-&gt;192.168.1.12[0] spi=175852902(0xa7b4d66)</pre></div></div><div class=paragraph><p>Om er zeker van te zijn dat de tunnel correct werkt, dient naar een ander console geschakeld te worden en <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a> gebruikt te worden om hiermee het netwerkverkeer te bekijken. Vervang <code>em0</code> door de netwerkinterfacekaart indien nodig.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tcpdump -i em0 host 172.16.5.4 and dst 192.168.1.12</span></code></pre></div></div><div class=paragraph><p>Gegevens lijkend op de volgende zouden op het console moeten verschijnen. Indien niet, dan is er iets aan de hand, en is het nodig om de teruggegeven gegevens te debuggen.</p></div><div class="literalblock programlisting"><div class=content><pre>01:47:32.021683 IP corporatenetwork.com &gt; 192.168.1.12.privatenetwork.com: ESP(spi=0x02acbf9f,seq=0xa)
01:47:33.022442 IP corporatenetwork.com &gt; 192.168.1.12.privatenetwork.com: ESP(spi=0x02acbf9f,seq=0xb)
01:47:34.024218 IP corporatenetwork.com &gt; 192.168.1.12.privatenetwork.com: ESP(spi=0x02acbf9f,seq=0xc)</pre></div></div><div class=paragraph><p>Op dit punt zouden beide netwerken beschikbaar moeten zijn en deel lijken van hetzelfde netwerk. Waarschijnlijk zijn beide netwerken beschermt door een firewall, zoals het hoort. Om verkeer tussen hen toe te staan, moeten er regels worden toegevoegd om pakketten heen en terug door te laten. Voeg voor de firewall <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> de volgende regels toe aan het instellingenbestand van de firewall:</p></div><div class="literalblock programlisting"><div class=content><pre>ipfw add 00201 allow log esp from any to any
ipfw add 00202 allow log ah from any to any
ipfw add 00203 allow log ipencap from any to any
ipfw add 00204 allow log udp from any 500 to any</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Afhankelijk van de huidige hostconfiguratie dienen de regelnummers gewijzigd te worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Voor gebruikers van <a href="https://man.freebsd.org/cgi/man.cgi?query=pf&amp;sektion=4&amp;format=html">pf(4)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> zouden de volgende regels moeten volstaan:</p></div><div class="literalblock programlisting"><div class=content><pre>pass in quick proto esp form any to any
pass in quick proto ah from any to any
pass in quick proto ipencap from any to any
pass in quick proto udp form any port = 500 to any port = 500
pass in quick on gif0 from any to any
pass out quick proto esp from any to any
pass out quick proto ah from any to any
pass out quick ptoto ipencap from any to any
pass out quick proto udp from any port = 500 to any port = 500
pass out quick on gif0 from any to any</pre></div></div><div class=paragraph><p>Ter afsluiting, voeg de volgende regels toe aan <span class=filename>/etc/rc.conf</span> om de machine toe te staan om ondersteuning voor het VPN te starten tijdens de systeeminitialisatie:</p></div><div class="literalblock programlisting"><div class=content><pre>ipsec_enable=&#34;YES&#34;
ipsec_program=&#34;/usr/local/sbin/setkey&#34;
ipsec_file=&#34;/usr/local/etc/racoon/setkey.conf&#34; # staat toe om spd-beleiden tijdens het opstarten op te zetten
racoon_enable=&#34;yes&#34;</pre></div></div></div></div><div class=sect2><h3 id=openssh>15.10. OpenSSH<a class=anchor href=#openssh></a></h3><div class=paragraph><p>OpenSSH is een groep netwerkverbindingsprogramma’s waarmee computers via het netwerk veilig benaderd kunnen worden. Het kan ingezet worden als een directe vervanger van <code>rlogin</code>, <code>rsh</code>, <code>rcp</code> en <code>telnet</code>. Daarnaast kunnen TCP/IP-verbindingen veilig getunneld of geforward worden door SSH. OpenSSH versleutelt al het verkeer om afluisteren, het stelen van een verbinding en andere netwerkaanvallen effectief te voorkomen.</p></div><div class=paragraph><p>OpenSSH wordt onderhouden door het OpenBSD project en is gebaseerd op SSH v1.2.12 met alle recente bugfixes en updates. Het is compatibel met beide protocollen SSH 1 en 2.</p></div><div class=sect3><h4 id=_voordelen_van_gebruik_van_openssh>15.10.1. Voordelen van gebruik van OpenSSH<a class=anchor href=#_voordelen_van_gebruik_van_openssh></a></h4><div class=paragraph><p>Als gewoonlijk <a href="https://man.freebsd.org/cgi/man.cgi?query=telnet&amp;sektion=1&amp;format=html">telnet(1)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=rlogin&amp;sektion=1&amp;format=html">rlogin(1)</a> wordt gebruikt, wordt de data in platte tekst en niet versleuteld verzonden. Netwerksnuffelaars die ergens tussen de cliënt en de server meeluisteren, kunnen een gebruikersnaam en wachtwoord stelen en zien welke gegevens er worden overgezonden tijdens een sessie. OpenSSH biedt een verscheidenheid aan autenticatie en versleutelingsmethoden die het voorgaande voorkomen.</p></div></div><div class=sect3><h4 id=_sshd_inschakelen>15.10.2. sshd inschakelen<a class=anchor href=#_sshd_inschakelen></a></h4><div class=paragraph><p>De sshd is een optie die wordt aangeboden tijdens een <code>Standard</code>-installatie van FreeBSD. sshd is ingeschakeld als de volgende regel voorkomt in <span class=filename>rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>sshd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Hierdoor wordt <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> geladen, het daemonprogramma voor OpenSSH, als het systeem de volgende keer opstart. Als alternatief is het mogelijk om <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> te gebruiken om OpenSSH te starten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sshd start</span></code></pre></div></div></div><div class=sect3><h4 id=_ssh_cliënt>15.10.3. SSH-cliënt<a class=anchor href=#_ssh_cliënt></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> werkt net zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=rlogin&amp;sektion=1&amp;format=html">rlogin(1)</a>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ssh user@example.com</span>
Host key not found from the list of known hosts.
Are you sure you want to <span class=k>continue </span>connecting <span class=o>(</span><span class=nb>yes</span>/no<span class=o>)</span>? <span class=nb>yes
</span>Host <span class=s1>&#39;example.com&#39;</span> added to the list of known hosts.
user@example.com<span class=s1>&#39;s password: *******</span></code></pre></div></div><div class=paragraph><p>Het aanmelden gaat nu net zoals het zou gaan als wanneer er een sessie gestart zou worden met <code>rlogin</code> of <code>telnet</code>. SSH maakt gebruik van een systeem met vingerafdrukken als sleutels voor het vaststellen met welke server verbinding wordt gemaakt op het moment dat de cliënt verbinding zoekt. De gebruiker krijgt alleen de eerste keer dat verbinding wordt gezocht met de server een vraag waarop <code>yes</code> geantwoord dient te worden. Bij volgende pogingen om aan te melden wordt de vingerafdruksleutel vergeleken met de sleutel die is opgeslagen. De SSH-cliënt alarmeert de gebruiker als de opgeslagen vingerafdruk sleutel anders is dan de sleutel die de server meldt. De vingerafdrukken worden opgeslagen in <span class=filename>~/.ssh/known_hosts</span> of in <span class=filename>~/.ssh/known_hosts2</span> voor SSH v2 vingerafdrukken.</p></div><div class=paragraph><p>Recente OpenSSH servers staan standaard ingesteld om alleen SSH v2 connecties toe te staan. De cliënt gebruikt versie 2 als dat mogelijk is en valt anders terug op versie 1. De cliënt kan ook gedwongen worden om een van de twee protocollen te gebruiken door de optie <code>-1</code> of <code>-2</code> voor respectievelijk versie 1 en versie 2 aan te geven. De mogelijkheid versie 1 te gebruiken blijft in de cliënt bestaan om compatibiliteit met oudere versies te behouden.</p></div></div><div class=sect3><h4 id=_veilig_kopiëren>15.10.4. Veilig kopiëren<a class=anchor href=#_veilig_kopiëren></a></h4><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> (secure copy) werkt gelijk aan <a href="https://man.freebsd.org/cgi/man.cgi?query=rcp&amp;sektion=1&amp;format=html">rcp(1)</a>. Het kopieert een bestand van of naar een andere machine, maar doet dat veilig.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c>#  scp user@example.com:/COPYRIGHT COPYRIGHT</span>
user@example.com<span class=s1>&#39;s password: *******
COPYRIGHT            100% |*****************************|  4735
00:00
#</span></code></pre></div></div><div class=paragraph><p>Omdat de vingerafdruk al is opgeslagen voor deze host in het vorige voorbeeld, is die al geverifieerd als <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> gebruik wordt.</p></div><div class=paragraph><p>De argumenten die aan <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> gegeven worden zijn vrijwel gelijk aan die voor <a href="https://man.freebsd.org/cgi/man.cgi?query=cp&amp;sektion=1&amp;format=html">cp(1)</a> met het bestand of de bestanden als het eerste argument en de bestemming als het tweede. Omdat het bestand over het netwerk gaat, door SSH, hebben een of meer van de bestandsargumenten de vorm <code>user@host:&lt;path_to_remote_file></code>.</p></div></div><div class=sect3><h4 id=_instellen>15.10.5. Instellen<a class=anchor href=#_instellen></a></h4><div class=paragraph><p>Het instellingenbestand dat voor het hele systeem geldt voor zowel de OpenSSH daemon als cliënt staat in de map <span class=filename>/etc/ssh</span>.</p></div><div class=paragraph><p><span class=filename>ssh_config</span> bevat de instellingen voor de cliënt en <span class=filename>sshd_config</span> bevat ze voor de daemon.</p></div><div class=paragraph><p>Daarnaast bieden het <code>sshd_program</code> (standaard <span class=filename>/usr/sbin/sshd</span>) en <code>sshd_flags</code><span class=filename>rc.conf</span> opties nog meer mogelijkheden voor instellingen.</p></div></div><div class=sect3><h4 id=security-ssh-keygen>15.10.6. ssh-keygen<a class=anchor href=#security-ssh-keygen></a></h4><div class=paragraph><p>In plaats van het gebruik van wachtwoorden kan <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> gebruikt worden om DSA en RSA sleutels te maken om een gebruiker te autenticeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh-keygen <span class=nt>-t</span> dsa
Generating public/private dsa key pair.
Enter file <span class=k>in </span>which to save the key <span class=o>(</span>/home/user/.ssh/id_dsa<span class=o>)</span>:
Created directory <span class=s1>&#39;/home/user/.ssh&#39;</span><span class=nb>.</span>
Enter passphrase <span class=o>(</span>empty <span class=k>for </span>no passphrase<span class=o>)</span>:
Enter same passphrase again:
Your identification has been saved <span class=k>in</span> /home/user/.ssh/id_dsa.
Your public key has been saved <span class=k>in</span> /home/user/.ssh/id_dsa.pub.
The key fingerprint is:
bb:48:db:f2:93:57:80:b6:aa:bc:f5:d5:ba:8f:79:17 user@host.example.com</code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> maakt een publiek en privaat sleutelpaar aan dat gebruikt kan worden voor autenticatie. De private sleutel staat opgeslagen in <span class=filename>~/.ssh/id_dsa</span> of <span class=filename>~/.ssh/id_rsa</span> en de publieke sleutel staat in <span class=filename>~/.ssh/id_dsa.pub</span> of <span class=filename>~/.ssh/id_rsa.pub</span> voor respectievelijk sleuteltypen DSA en RSA. De publieke sleutel moet voor beide RSA- of DSA-sleutels in het bestand <span class=filename>~/.ssh/authorized_keys</span> van de andere machine staan om dit te laten werken.</p></div><div class=paragraph><p>Nu is het mogelijk een verbinding te maken met een andere machine die gebaseerd is op SSH sleutels in plaats van op wachtwoorden.</p></div><div class=paragraph><p>Als er een wachtwoordzin is gebruikt bij <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> dan wordt de gebruiker iedere keer dat de private sleutel wordt gebruikt een wachtwoord gevraagd. <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> kan het ongemak van steeds opnieuw een lange wachtwoordzin moeten ingeven verlichten en wordt beschreven in het onderdeel <a href=#security-ssh-agent>ssh-agent en ssh-add</a>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Afhankelijk van de gebruikte versie van OpenSSH kunnen opties en bestanden verschillen. Het is verstandig de handleiding <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> te raadplegen.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=security-ssh-agent>15.10.7. ssh-agent en ssh-add<a class=anchor href=#security-ssh-agent></a></h4><div class=paragraph><p>De hulpprogramma’s <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-add&amp;sektion=1&amp;format=html">ssh-add(1)</a> bieden de mogelijkheid om SSH in het geheugen te laden zodat niet iedere keer de wachtwoordzin ingegeven hoeft te worden.</p></div><div class=paragraph><p>Het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> handelt de autenticatie af voor de geheime sleutels die erin geladen zijn. <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> wordt gebruikt om andere programma’s te starten. Bij eenvoudig gebruik kan er een shell mee gestart worden of meer complex een schermbeheerprogramma.</p></div><div class=paragraph><p>Voordat <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> in een shell gebruikt kan worden dient het eerst gestart te worden met een shell als argument. Daarna kan de identiteit toegevoegd worden daar <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-add&amp;sektion=1&amp;format=html">ssh-add(1)</a> aan te roepen en de wachtwoordzin voor de geheime sleutel op te geven. Als deze stappen zijn voltooid kan een gebruiker met <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> naar iedere host waar de corresponderende publieke sleutel is geïnstalleerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh-agent csh
% ssh-add
Enter passphrase <span class=k>for</span> /home/user/.ssh/id_dsa:
Identity added: /home/user/.ssh/id_dsa <span class=o>(</span>/home/user/.ssh/id_dsa<span class=o>)</span>
%</code></pre></div></div><div class=paragraph><p>Om <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> te gebruiken in X11 dient er een verwijzing naar <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> in <span class=filename>~/.xinitrc</span> te staan. Dan zijn de diensten van <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> beschikbaar voor alle programma’s die in X11 gestart worden. Een <span class=filename>~/.xinitrc</span> zou er als volgt uit kunnen zien:</p></div><div class="literalblock programlisting"><div class=content><pre>exec ssh-agent startxfce4</pre></div></div><div class=paragraph><p>Hiermee wordt <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> gestart die op zijn beurt XFCE start, iedere keer dat X11 start. Als dat is gebeurd en X11 is herstart zodat de wijzigingen actief zijn, dan kan eenvoudigweg <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-add&amp;sektion=1&amp;format=html">ssh-add(1)</a> gestart worden om alle beschikbare SSH sleutels te laden.</p></div></div><div class=sect3><h4 id=security-ssh-tunneling>15.10.8. SSH tunnels<a class=anchor href=#security-ssh-tunneling></a></h4><div class=paragraph><p>OpenSSH kan een tunnel maken waarin een ander protocol ingepakt kan worden zodat er een versleutelde sessie ontstaat.</p></div><div class=paragraph><p>Het volgende commando geeft <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> aan dat er een tunnel voor telnet gemaakt moet worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 5023:localhost:23 user@foo.example.com
%</code></pre></div></div><div class=paragraph><p>Aan het <code>ssh</code> commando worden de volgende opties meegegeven:</p></div><div class=dlist><dl><dt class=hdlist1><code>-2</code></dt><dd><p>Dit dwingt <code>ssh</code> om versie 2 van het protocol te gebruiken. Gebruik van deze optie wordt afgeraden als er verbinding wordt gemaakt met oudere SSH servers.</p></dd><dt class=hdlist1><code>-N</code></dt><dd><p>Dit geeft aan dat er geen commando volgt, maar dat er een tunnel opgezet moet worden. Als deze optie niet aanwezig was, zou <code>ssh</code> een normale sessie starten.</p></dd><dt class=hdlist1><code>-f</code></dt><dd><p>Dit dwingt <code>ssh</code> om in de achtergrond te draaien.</p></dd><dt class=hdlist1><code>-L</code></dt><dd><p>Dit geeft aan dat de lokaal een tunnel wordt gemaakt in de vorm <em>lokale_poort:netwerk_host:netwerk_poort</em>.</p></dd><dt class=hdlist1><code>user@foo.example.com</code></dt><dd><p>Wijst naar een gebruiker op de SSH server op het netwerk.</p></dd></dl></div><div class=paragraph><p>Een SSH tunnel werkt doordat een luistersocket wordt gemaakt op <code>localhost</code> op de aangegeven poort. Die stuurt dan iedere ontvangen verbinding op de lokale host/poort via de SSH verbinding door naar de aangegeven host en poort op het netwerk.</p></div><div class=paragraph><p>In het voorbeeld wordt poort <em>5023</em> op <code>localhost</code> doorgestuurd naar poort <em>23</em> op <code>localhost</code> van de machine op het netwerk. Omdat <code><em>23</em></code> telnet is, zou dit een veilige telnet verbinding opleveren door een SSH tunnel.</p></div><div class=paragraph><p>Dit kan gebruikt worden om ieder willekeurig onveilig TCP protocol in te pakken als SMTP, POP3, FTP, etc.</p></div><div class=exampleblock><div class=title>Voorbeeld 20. SSH gebruiken om een veilige tunnel te maken voor SMTP</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 5025:localhost:25 user@mailserver.example.com
user@mailserver.example.com<span class=s1>&#39;s password: *****
% telnet localhost 5025
Trying 127.0.0.1...
Connected to localhost.
Escape character is &#39;</span>^]<span class=s1>&#39;.
220 mailserver.example.com ESMTP</span></code></pre></div></div><div class=paragraph><p>Dit kan samen met een <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> en extra gebruikersaccounts gebruikt worden om een min of meer naadloze en eenvoudige SSH tunnelomgeving te maken. In plaats van wachtwoorden kunnen sleutels gebruikt worden en de tunnels kunnen in de omgeving van een aparte gebruiker draaien.</p></div></div></div><div class=sect4><h5 id=_praktische_voorbeelden_van_een_ssh_tunnel>15.10.8.1. Praktische voorbeelden van een SSH tunnel<a class=anchor href=#_praktische_voorbeelden_van_een_ssh_tunnel></a></h5><div class=sect5><h6 id=_veilige_toegang_tot_een_pop3_server>15.10.8.1.1. Veilige toegang tot een POP3 server<a class=anchor href=#_veilige_toegang_tot_een_pop3_server></a></h6><div class=paragraph><p>Op het werk staat een SSH server die verbindingen van buitenaf toestaat. Op hetzelfde netwerk op kantoor staat een mailserver waarop POP3 draait. Het netwerk of het netwerkpad tussen de locatie op Internet en kantoor is wellicht niet helemaal te vertrouwen. Om deze reden dient de mailserver op een veilige manier benaderd te worden. De oplossing is een SSH verbinding opzetten naar de SSH server op kantoor en dan door de tunnel heen een verbinding opzetten met de mailserver.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 2110:mail.example.com:110 user@ssh-server.example.com
user@ssh-server.example.com<span class=s1>&#39;s password:
% ******</span></code></pre></div></div><div class=paragraph><p>Als de tunnel eenmaal draait, dan kan de mailcliënt naar <code>localhost</code> poort 2110 gewezen worden. Alle verbinding naar die poort worden veilig doorgestuurd door de tunnel naar <code>mail.example.com</code>.</p></div></div><div class=sect5><h6 id=_een_draconische_firewall_omzeilen>15.10.8.1.2. Een draconische firewall omzeilen<a class=anchor href=#_een_draconische_firewall_omzeilen></a></h6><div class=paragraph><p>Sommige netwerkbeheerders stellen draconische firewallregels op en filteren niet alleen inkomende verbindingen, maar ook uitgaande. Meestal mag dan alleen maar verbinding gemaakt worden met andere machines op poorten 22 en 80 voor SSH en websurfen.</p></div><div class=paragraph><p>Soms wil een gebruiker dan toch toegang krijgen tot andere (wellicht niet netwerkgerelateerde) diensten, zoals een Ogg Vorbis server om muziek te streamen. Als die Ogg Vorbis server streamt op een andere poort dan 22 of 80, dan kan deze niet bereikt worden.</p></div><div class=paragraph><p>De oplossing ligt in het opzetten van een SSH verbinding naar een machine buiten de firewall en die tunnel te gebruiken om bij de Ogg Vorbis server te komen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 2110:mail.example.com:110 user@ssh-server.example.com
user@ssh-server.example.com<span class=s1>&#39;s password: ******</span></code></pre></div></div><div class=paragraph><p>De streamingcliënt kan nu gewezen worden naar <code>localhost</code> poort 8888 vanwaar er wordt doorverwezen naar <code>music.example.com</code> poort 8000 en zo wordt de firewall succesvol ontwerken.</p></div></div></div></div><div class=sect3><h4 id=_de_optie_allowusers>15.10.9. De optie <code>AllowUsers</code><a class=anchor href=#_de_optie_allowusers></a></h4><div class=paragraph><p>Vaak is het verstandig om beperkingen aan te brengen op het gebied van welke gebruikers kunnen aanmelden en van waar. De optie <code>AllowUsers</code> biedt deze mogelijkheid. Om bijvoorbeeld alleen <code>root</code> toe te staan zich aan te melden van <code>192.168.1.32</code>, kan iets als de volgende regel worden opgenomen in het bestand <span class=filename>/etc/ssh/sshd_config</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>AllowUsers root@192.168.1.32</pre></div></div><div class=paragraph><p>Om de gebruiker <code>admin</code> het recht te geven zich van overal aan te melden hoeft alleen de gebruikersnaam vermeld te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>AllowUsers admin</pre></div></div><div class=paragraph><p>Meerdere gebruikers met rechten of beperkingen horen op dezelfde regel te staan:</p></div><div class="literalblock programlisting"><div class=content><pre>AllowUsers root@192.168.1.32 admin</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is van belang dat iedere gebruiker die zich moet kunnen aanmelden wordt genoemd. De overige gebruikers worden buitengesloten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Nadat er wijzigingen zijn gemaakt aan <span class=filename>/etc/ssh/sshd_config</span> dienen de bestanden in <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> geladen te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sshd reload</span></code></pre></div></div></div><div class=sect3><h4 id=_meer_informatie>15.10.10. Meer informatie<a class=anchor href=#_meer_informatie></a></h4><div class=paragraph><p><a href=http://www.openssh.com/>OpenSSH</a></p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-add&amp;sektion=1&amp;format=html">ssh-add(1)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh_config&amp;sektion=5&amp;format=html">ssh_config(5)</a></p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=sftp-server&amp;sektion=8&amp;format=html">sftp-server(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd_config&amp;sektion=5&amp;format=html">sshd_config(5)</a></p></div></div></div><div class=sect2><h3 id=fs-acl>15.11. Bestandssysteem toegangscontrolelijsten (ACLs)<a class=anchor href=#fs-acl></a></h3><div class=paragraph><p>In combinatie met verbeteringen als snapshots, biedt FreeBSD de veiligheid van Toegangscontrolelijsten voor Bestandssystemen (Access Control Lists, ACLs).</p></div><div class=paragraph><p>Met toegangscontrolelijsten wordt het standaard UNIX® rechtenmodel uitgebreid op een zeer verenigbare (POSIX®.1e) manier. Deze methodes stellen een beheerder in staat om gebruik te maken en voordeel te halen uit een geraffineerder beveiligingsmodel.</p></div><div class=paragraph><p>Om ondersteuning voor ACLs voor bestandssystemen in te schakelen dient het volgende in de kernel gecompileerd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>options UFS_ACL</pre></div></div><div class=paragraph><p>Als deze optie niet aanwezig is, dan wordt er een waarschuwing weergegeven als er wordt geprobeerd een bestandssysteem aan te koppelen dat gebruik maakt van ACLs. Deze optie is al geactiveerd in de <span class=filename>GENERIC</span> kernel. ACLs zijn afhankelijk van uitgebreide attributen die zijn ingeschakeld op het bestandssysteem. Uitgebreide attributen worden standaard ondersteund in het volgende generatie UNIX® bestandssysteem UFS2.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er is meer administratieve rompslomp nodig om uitgebreide attributen in te stellen op UFS1 dan op UFS2. De prestaties van uitgebreide attributen zijn op UFS2 ook veel beter. Daarom wordt UFS2 ook meestal aangeraden boven UFS1 bij het gebruik van toegangscontrolelijsten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>ACLs worden ingeschakeld door de beheersvlag <code>acls</code> op het moment van aankoppelen. Dit kan ook in <span class=filename>/etc/fstab</span> staan. De vlag op het moment van aankoppelen kan ook automatisch gezet worden op een persistente wijze met <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> door een superblok in de bestandssysteemkop te wijzigen. In het algemeen wordt de voorkeur gegeven aan de vlag in het superblok om een aantal redenen:</p></div><div class=ulist><ul><li><p>De ACLs vlag op het moment van aankoppelen kan niet gewijzigd worden bij opnieuw aankoppelen (<a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> <code>-u</code>), maar alleen door een volledige <a href="https://man.freebsd.org/cgi/man.cgi?query=umount&amp;sektion=8&amp;format=html">umount(8)</a> en een verse <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. Dit betekent dat ACLs niet ingeschakeld kunnen worden op root-bestandssysteem na het opstarten. Het betekent ook dat de aard van een bestandssysteem niet veranderd kan worden als het eenmaal in gebruik is.</p></li><li><p>Het inschakelen van de superblokvlag zorgt ervoor dat het bestandssysteem altijd wordt aangekoppeld met de ACLs ingeschakeld, zelfs als het niet in <span class=filename>fstab</span> staat of als de apparaten van plaats veranderen. Hiermee wordt voorkomen dat het bestandssysteem wordt gebruikt zonder dat ACLs ingeschakeld zijn, wat ervoor zou kunnen zorgen dat ACLs onjuist worden toegepast wat weer kan zorgen voor beveiligingsproblemen.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Wellicht wordt het mogelijk om de ACLs via de vlag in te schakelen zonder een compleet verse <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>, maar de ontwikkelaars vinden het wenselijk om het per ongeluk zonder ACLs aankoppelen te ontmoedigen, omdat er bijzonder vervelende gevolgen kunnen zijn als ACLs worden ingeschakeld, daarna worden uitgezet en weer worden ingeschakeld zonder dat de uitgebreide attributen worden geschoond. In het algemeen geldt dat als ACLs eenmaal zijn ingeschakeld voor een bestandssysteem, ze niet meer uitgeschakeld moeten worden, omdat de resulterende bestandsbescherming wellicht niet compatibel is met dat wat gebruikers van het systeem nodig hebben en het opnieuw aanzetten van ACLs kan leiden tot het opnieuw koppelen van voorheen bestaande ACLs aan bestanden waarvoor de toegangsrechten sindsdien zijn aangepast, wat kan leiden tot onverwachte situaties.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Bestandssystemen waarvoor ACLs zijn ingeschakeld worden weergegeven met een <code>+</code> (plus) teken als de toegangsrechten worden bekeken:</p></div><div class="literalblock programlisting"><div class=content><pre>drwx------  2 robert  robert  512 Dec 27 11:54 private
drwxrwx---+ 2 robert  robert  512 Dec 23 10:57 directory1
drwxrwx---+ 2 robert  robert  512 Dec 22 10:20 directory2
drwxrwx---+ 2 robert  robert  512 Dec 27 11:57 directory3
drwxr-xr-x  2 robert  robert  512 Nov 10 11:54 public_html</pre></div></div><div class=paragraph><p>Hierboven is te zien dat mappen <span class=filename>directory1</span>, <span class=filename>directory2</span> en <span class=filename>directory3</span> allemaal gebruik maken van ACLs. De map <span class=filename>public_html</span> doet dat niet.</p></div><div class=sect3><h4 id=_gebruik_maken_van_acls>15.11.1. Gebruik maken van ACLs<a class=anchor href=#_gebruik_maken_van_acls></a></h4><div class=paragraph><p>De ACLs van het bestandssysteem kunnen bekeken worden met het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=getfacl&amp;sektion=1&amp;format=html">getfacl(1)</a>. Om de ACL op het bestand <span class=filename>test</span> te bekijken zou het volgende commando nodig zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% getfacl <span class=nb>test</span>
<span class=c>#file:test</span>
<span class=c>#owner:1001</span>
<span class=c>#group:1001</span>
user::rw-
group::r--
other::r--</code></pre></div></div><div class=paragraph><p>Om de ACL op dit bestand te wijzigen wordt het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=setfacl&amp;sektion=1&amp;format=html">setfacl(1)</a> als volgt gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setfacl <span class=nt>-k</span> <span class=nb>test</span></code></pre></div></div><div class=paragraph><p>De vlag <code>-k</code> verwijdert alle bestaande ACLs van een bestand of bestandssysteem. De methode die de voorkeur geniet is <code>-b</code> gebruiken omdat die optie de basisvelden die nodig zijn voor het laten werken van de ACLs laat staan.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setfacl <span class=nt>-m</span> u:trhodes:rwx,group:web:r--,o::--- <span class=nb>test</span></code></pre></div></div><div class=paragraph><p>Bij het commando hierboven, werd de optie <code>-m</code> gebruikt om de standaard ACL aan te passen. Omdat er geen voorgedefinieerde instellingen waren, die waren verwijderd door het commando daarvoor, werden nu de standaardinstellingen hersteld en de rechten die werden aangegeven toegevoegd. Let op dat bij het toevoegen van een gebruiker of een groep die niet bekend is op het systeem een foutmelding <code>Invalid argument</code> wordt geschreven naar <span class=filename>stdout</span>.</p></div></div></div><div class=sect2><h3 id=security-portaudit>15.12. Monitoren van beveiligingsproblemen met andere software<a class=anchor href=#security-portaudit></a></h3><div class=paragraph><p>In de afgelopen jaren zijn er in de beveiligingswereld veel vorderingen gemaakt op het gebied van inzicht in kwetsbaarheden. Als er software naast het besturingssysteem wordt geïnstalleerd en ingesteld neemt op vrijwel ieder besturingssysteem het risico op inbraak toe.</p></div><div class=paragraph><p>Inzicht in kwetsbaarheid is een vitale factor in beveiliging en hoewel FreeBSD waarschuwingen publiceert voor het basissysteem, gaat het publiceren van waarschuwingen voor alle overige software de scope van het FreeBSD Project te buiten. Er is een manier om inzicht te krijgen in de kwetsbaarheden voor additionele software en als beheerder gewaarschuwd te worden. Voor dit doel bestaat het FreeBSD hulpprogramma Portaudit.</p></div><div class=paragraph><p>De port <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portaudit/>ports-mgmt/portaudit</a> zoekt naar bekende beveiligingsproblemen in een database die wordt bijgewerkt en onderhouden door het FreeBSD Security Team en portontwikkelaars.</p></div><div class=paragraph><p>Voordat Portaudit gebruikt kan worden dient het geïnstalleerd te worden uit de Portscollectie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/ports-mgmt/portaudit &amp;&amp; make install clean</span></code></pre></div></div><div class=paragraph><p>Tijdens het installatieproces worden de instellingenbestanden voor <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a> bijgewerkt, waardoor Portaudit uitvoer in de dagelijkse security runs meekomt. Het is van belang dat de emails die aan de emailaccount van <code>root</code> worden gezonden en uit de dagelijkse beveiligingsronde komen ook echt worden gelezen. Er zijn geen verdere instellingen nodig.</p></div><div class=paragraph><p>Na de installatie kan de beheerder de database bijwerken en bekende kwetsbaarheden in geïnstalleerde pakketten bekijken met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portaudit -Fda</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De database wordt automatisch bijgewerkt tijdens de <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a> run; dus het voorgaande commando is volledig optioneel. Het is alleen nodig om de volgende voorbeelden na te kunnen doen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De software de uit de Portscollectie is geïnstalleerd kan op elk moment door een beheerder ge-audit worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portaudit -a</span></code></pre></div></div><div class=paragraph><p>Portaudit zal iets als het volgende produceren voor kwetsbare pakketten:</p></div><div class="literalblock programlisting"><div class=content><pre>Affected package: cups-base-1.1.22.0_1
Type of problem: cups-base -- HPGL buffer overflow vulnerability.
Reference: &lt;http://www.FreeBSD.org/ports/portaudit/40a3bca2-6809-11d9-a9e7-0001020eed82.html&gt;

1 problem(s) in your installed packages found.

You are advised to update or deinstall the affected package(s) immediately.</pre></div></div><div class=paragraph><p>Door met een webbrowser naar de aangegeven URL te gaan kan een beheerder meer informatie over de bewust kwetsbaarheid krijgen, waaronder de versies die het betreft, volgens de FreeBSD Port versie en andere websites waarop beveiligingswaarschuwingen te lezen zijn.</p></div><div class=paragraph><p>In het kort is Portaudit een krachtig hulpprogramma dat bijzonder handig is als het wordt gekoppeld aan het gebruik van de port Portupgrade.</p></div></div><div class=sect2><h3 id=security-advisories>15.13. FreeBSD beveiligingswaarschuwingen<a class=anchor href=#security-advisories></a></h3><div class=paragraph><p>Net als veel andere kwalitatief goede productiebesturingssystemen publiceert FreeBSD "Beveiligingswaarschuwingen". Deze waarschuwingen worden meestal pas naar de beveiligingslijst gemaild en gedocumenteerd in de Errata als de van toepassing zijnde uitgaven gepatcht zijn. In deze paragraaf wordt toegelicht wat een waarschuwing is, hoe die te begrijpen en welke maatregelen er genomen moeten worden om een systeem bij te werken.</p></div><div class=sect3><h4 id=_hoe_ziet_een_waarschuwing_eruit>15.13.1. Hoe ziet een waarschuwing eruit?<a class=anchor href=#_hoe_ziet_een_waarschuwing_eruit></a></h4><div class=paragraph><p>De FreeBSD beveiligingswaarschuwingen zien er ongeveer uit als die hieronder die van de <a href=https://lists.FreeBSD.org/subscription/freebsd-security-notifications>FreeBSD beveiligingswaarschuwingen mailinglijst</a> mailinglijst komt.</p></div><div class="literalblock programlisting"><div class=content><pre>=============================================================================
FreeBSD-SA-XX:XX.UTIL                                     Security Advisory
                                                          The FreeBSD Project

Topic:          denial of service due to some problem <i class=conum data-value=1></i><b>(1)</b>

Category:       core <i class=conum data-value=2></i><b>(2)</b>
Module:         sys <i class=conum data-value=3></i><b>(3)</b>
Announced:      2003-09-23 <i class=conum data-value=4></i><b>(4)</b>
Credits:        Person <i class=conum data-value=5></i><b>(5)</b>
Affects:        All releases of FreeBSD <i class=conum data-value=6></i><b>(6)</b>
                FreeBSD 4-STABLE prior to the correction date
Corrected:      2003-09-23 16:42:59 UTC (RELENG_4, 4.9-PRERELEASE)
                2003-09-23 20:08:42 UTC (RELENG_5_1, 5.1-RELEASE-p6)
                2003-09-23 20:07:06 UTC (RELENG_5_0, 5.0-RELEASE-p15)
                2003-09-23 16:44:58 UTC (RELENG_4_8, 4.8-RELEASE-p8)
                2003-09-23 16:47:34 UTC (RELENG_4_7, 4.7-RELEASE-p18)
                2003-09-23 16:49:46 UTC (RELENG_4_6, 4.6-RELEASE-p21)
                2003-09-23 16:51:24 UTC (RELENG_4_5, 4.5-RELEASE-p33)
                2003-09-23 16:52:45 UTC (RELENG_4_4, 4.4-RELEASE-p43)
                2003-09-23 16:54:39 UTC (RELENG_4_3, 4.3-RELEASE-p39) <i class=conum data-value=7></i><b>(7)</b>
CVE Name:   CVE-XXXX-XXXX <i class=conum data-value=8></i><b>(8)</b>

For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit
http://www.FreeBSD.org/security/.

I.   Background <i class=conum data-value=9></i><b>(9)</b>

II.  Problem Description <i class=conum data-value=10></i><b>(10)</b>

III. Impact <i class=conum data-value=11></i><b>(11)</b>

IV.  Workaround <i class=conum data-value=12></i><b>(12)</b>

V.   Solution <i class=conum data-value=13></i><b>(13)</b>

VI.  Correction details <i class=conum data-value=14></i><b>(14)</b>

VII. References <i class=conum data-value=15></i><b>(15)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Het veld <code>Topic</code> geeft aan wat precies het probleem is. Het is eigenlijk een inleiding op de beveiligingswaarschuwing en geeft aan welke programma kwetsbaar is.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Het veld <code>Category</code> geeft aan welk onderdeel van het systeem kwetsbaar is. Dat kan een van de onderdelen <code>core</code>, <code>contrib</code> of <code>ports</code> zijn. De categorie <code>core</code> betekent dat de een kerncomponent van het FreeBSD besturingssysteem kwetsbaar is. De categorie <code>contrib</code> betekent dat software die toegevoegd is aan het FreeBSD Project kwetsbaar is, zoals sendmail. Tenslotte geeft de categorie <code>ports</code> aan dat een optionele component uit de Portscollectie kwetsbaar is.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Het veld <code>Module</code> geeft aan waar de component zich bevindt, bijvoorbeeld <code>sys</code>. In dit voorbeeld wordt het duidelijk dat de module <code>sys</code> kwetsbaar is. Hier gaat het dus om een kwetsbaar component die gebruikt wordt in de kernel.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Het veld <code>Announced</code> geeft aan wanneer de beveiligingswaarschuwing gepubliceerd of aangekondigd is. Dit betekent dat het beveiligingsteam heeft bevestigd dat het probleem bestaat en dat er een patch is gecommit in het depot met de broncode van FreeBSD.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>In het veld <code>Credits</code> wordt iemand of een organisatie bedankt die de kwetsbaarheid heeft ontdekt en gerapporteerd.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Het veld <code>Affects</code> geeft aan welke uitgaven van FreeBSD door deze kwetsbaarheid worden getroffen. Voor de kernel kan snel gekeken worden naar de uitvoer van <code>ident</code> voor de betreffende bestanden om te bepalen welke revisie ze hebben. Voor ports is het versienummer te zien in <span class=filename>/var/db/pkg</span>. Als het systeem niet gelijk op loopt met het FreeBSD Subversion-depot en dagelijks herbouwd wordt, dan is de kans groot dat het systeem kwetsbaar is.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>Het veld <code>Corrected</code> geeft de datum, tijd en tijdzone aan en de uitgave die is aangepast.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>Gereserveerd voor de identificatie-informatie die gebruikt wordt om kwetsbaarheden in het Common Vulnerabilities Database System op te zoeken.</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>Het veld <code>Background</code> geeft meer informatie over wat er precies aan de hand is. Meestal staat hier waarom het programma aanwezig is in FreeBSD, waar het voor gebruikt wordt en hoe het programma is ontstaan.</td></tr><tr><td><i class=conum data-value=10></i><b>10</b></td><td>Het veld <code>Problem Description</code> geeft gedetailleerde toelichting op het beveiligingsprobleem. Hier kan informatie bij staat over programmacode die fouten bevat of zelfs hoe het programma gebruikt kan worden om een beveiligingsgat te openen.</td></tr><tr><td><i class=conum data-value=11></i><b>11</b></td><td>Het veld <code>Impact</code> beschrijft welke invloed het probleem kan hebben op het systeem. Dit kan bijvoorbeeld een ontzegging van dienst aanval zijn, gebruikers extra rechten geven of het verkrijgen van supergebruiker toegang voor de aanvaller zijn.</td></tr><tr><td><i class=conum data-value=12></i><b>12</b></td><td>Het veld <code>Workaround</code> geeft aan hoe het mogelijk is het probleem te omzeilen (workaround) in het geval systeembeheerders niet in staat zijn om het systeem bij te werken. Dit zou te maken kunnen hebben met de tijd, beschikbaarheid van het netwerk en een hele lijst met andere redenen. Hoe dan ook, beveiliging dient serieus genomen te worden en een systeem dat kwetsbaar is moet bijgewerkt worden of het gat in de beveiliging moet gedicht worden met de alternatieve oplossing.</td></tr><tr><td><i class=conum data-value=13></i><b>13</b></td><td>Het veld <code>Solution</code> geeft instructies over hoe een systeem aangepast kan worden. Dit is een werkinstructie die getest en gecontroleerd is om een systeem aan te passen en weer veilig werkend te krijgen.</td></tr><tr><td><i class=conum data-value=14></i><b>14</b></td><td>In het veld <code>Correction Details</code> staan de Subversion-takken of uitgavenamen, met de punten veranderd in een liggend streepje. Er staat ook welke revisienummer de aangetaste bestanden binnen een tak hebben.</td></tr><tr><td><i class=conum data-value=15></i><b>15</b></td><td>In het veld <code>References</code> wordt gewoonlijk verwezen naar andere bronnen. Dit kunnen web-URLs, boeken, mailinglijsten en nieuwsgroepen zijn.</td></tr></tbody></table></div></div></div><div class=sect2><h3 id=security-accounting>15.14. Procesaccounting<a class=anchor href=#security-accounting></a></h3><div class=paragraph><p>Procesaccounting is een beveiligingsmethode die een beheerder in staat stelt om in de gaten te houden welke systeembronnen worden gebruikt, hoe ze over gebruikers verdeeld zijn, systeemmonitoring biedt en op minimalistische wijze het gebruik van commando’s door gebruikers volgt.</p></div><div class=paragraph><p>Deze methode heeft voordelen en nadelen. Eén van de positieve punten is dat een inbraak gevolgd kan worden tot het moment waarop die zich voordeed. Nadelen zijn de grootte van de logboeken die door procesaccounting worden gegenereerd en de schijfruimte die dat kost. In dit onderdeel wordt een beheerder de basis van procesaccounting getoond.</p></div><div class=sect3><h4 id=_procesaccounting_inschakelen_en_gebruiken>15.14.1. Procesaccounting inschakelen en gebruiken<a class=anchor href=#_procesaccounting_inschakelen_en_gebruiken></a></h4><div class=paragraph><p>Voordat procesaccounting gebruikt kan worden dient het te worden ingeschakeld met de volgende commando’s:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/account/acct</span>
<span class=c># accton /var/account/acct</span>
<span class=c># echo &#39;accounting_enable=&#34;YES&#34;&#39; &gt;&gt; /etc/rc.conf</span></code></pre></div></div><div class=paragraph><p>Eenmaal ingeschakeld begint accounting met het bijhouden van CPU statistieken, commando’s, enzovoort. Alle accounting logboeken worden in een niet leesbaar formaat bijgehouden en zijn uit te lezen met <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=8&amp;format=html">sa(8)</a>. Bij het uitvoeren zonder opties, toont <code>sa</code> informatie gerelateerd aan het aantal aanroepen per gebruiker, de totale tijd in minuten die is verstreken, de totale CPU- en gebruikerstijd in minuten, gemiddeld aantal I/O operaties, enzovoort.</p></div><div class=paragraph><p>Informatie over uitgevoerde commando’s kan bekeken worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=lastcomm&amp;sektion=1&amp;format=html">lastcomm(1)</a>. Zo kan met <code>lastcomm</code> bijvoorbeeld weergegeven worden welke commando’s door gebruikers op een specifieke <a href="https://man.freebsd.org/cgi/man.cgi?query=ttys&amp;sektion=5&amp;format=html">ttys(5)</a> zijn uitgevoerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lastcomm ls trhodes ttyp1</span></code></pre></div></div><div class=paragraph><p>Het bovenstaande commando toont ieder bekend gebruikt van <code>ls</code> door de gebruiker <code>trhodes</code> op terminal <code>ttyp1</code>.</p></div><div class=paragraph><p>Veel andere handige opties staan beschreven in <a href="https://man.freebsd.org/cgi/man.cgi?query=lastcomm&amp;sektion=1&amp;format=html">lastcomm(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=acct&amp;sektion=5&amp;format=html">acct(5)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=8&amp;format=html">sa(8)</a>.</p></div></div></div></div></div><div class=sect1><h2 id=jails>Hoofdstuk 16. Jails<a class=anchor href=#jails></a></h2><div class=sectionbody><div class=sect2><h3 id=jails-synopsis>16.1. Overzicht<a class=anchor href=#jails-synopsis></a></h3><div class=paragraph><p>Dit hoofdstuk levert een uitleg van wat FreeBSD jails zijn en hoe ze gebruikt kunnen worden. Jails, soms ook wel bekend als een verbeterde vervanging van <em>chroot omgevingen</em>, zijn een erg krachtige tool voor systeem beheerders, maar het standaard gedrag kan ook interessant zijn voor gevorderde gebruikers.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Jails zijn een krachtig gereedschap, maar zijn geen zilveren kogel qua beveiliging. Hoewel het belangrijk is om op te merken dat het onmogelijk is voor een gevangen proces om zelf te ontsnappen, zijn er verschillende manieren waarop een ongeprivilegieerde gebruiker buiten een jail kan samenwerken met een geprivilegieerde gebruiker binnen de jail en daarmee verhoogde privileges kan krijgen in de gastheeromgeving.</p></div><div class=paragraph><p>De meeste van deze aanvallen kunnen worden voorkomen door ervoor te zorgen dat de jail-root niet beschikbaar is voor ongeprivilegieerde gebruikers binnen de gastheeromgeving. Buiten dat geldt als algemene regel dat onvertrouwde gebruikers met geprivilegieerde toegang tot een jail geen toegang tot de gastheeromgeving moet worden gegeven.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Wat een jail is, en welk doel het kan dienen in een FreeBSD installatie.</p></li><li><p>Hoe men een jail opbouwt, start en stopt.</p></li><li><p>De basis over jail beheer, zowel van binnen in de jail, als van buitenaf.</p></li></ul></div><div class=paragraph><p>Andere bronnen met nuttige informatie over jails zijn:</p></div><div class=ulist><ul><li><p>De <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> handleiding. Hier kan de volledige referentie gevonden worden van het <code>jail</code> commando - de administratieve tool die in FreeBSD gebruikt kan worden om FreeBSD jails mee te beheren, te starten en te stoppen.</p></li><li><p>De mailinglijsten en de archieven hiervan. De archieven van de <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD algemene vragen mailinglijst</a> en andere mailing lijsten die gehost worden door de <a href=https://lists.freebsd.org>FreeBSD nlijstserver</a> bevatten reeds een rijke bron van informatie over jails. Het zou altijd aantrekkelijk moeten zijn om informatie in de archieven te zoeken, of een nieuwe vraag stellen aan de <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>freebsd-questions</a> mailinglijst.</p></li></ul></div></div><div class=sect2><h3 id=jails-terms>16.2. Termen en begrippen van jails<a class=anchor href=#jails-terms></a></h3><div class=paragraph><p>Om een beter begrip te geven over de onderdelen van FreeBSD die gerelateerd zijn aan jails, de werking ervan, en hoe ze omgaan met de rest van FreeBSD worden de volgende termen gebruikt in het hoofdstuk:</p></div><div class=dlist><dl><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a> (commando)</dt><dd><p>Hulpmiddel dat de systeemaanroep <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> van FreeBSD gebruikt om de rootmap van een proces en alle afstammelingen te veranderen.</p></dd><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> (omgeving)</dt><dd><p>Een omgeving van processen die draaien in een "chroot". Dit is inclusief bronnen die gebruikt worden, zoals bijvoorbeeld het gedeelte van het bestandssysteem dat zichtbaar is, de gebruiker en groep ID’s welke beschikbaar zijn, netwerkkaarten en andere IPC-mechanismes, etcetera.</p></dd><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> (commando)</dt><dd><p>De systeem utility die het mogelijk maakt om processen binnenin een jail te starten.</p></dd><dt class=hdlist1>host (systeem, processen, gebruiker, etc.)</dt><dd><p>Het controlerende systeem van een jail omgeving. Het host systeem heeft toegang tot alle beschikbare hardware bronnen en kan processen controleren zowel buiten als binnenin een jail. Één van de belangrijkste verschillen van het host systeem met een jail zijn de limitaties die van toepassing zijn op super-gebruiker processen binnenin een jail, niet geforceerd worden voor processen in het host systeem.</p></dd><dt class=hdlist1>hosted (systeem, processen, gebruiker, etc.)</dt><dd><p>Een proces, gebruiker, of andere entiteit wiens toegang tot bronnen is gelimiteerd door een FreeBSD jail.</p></dd></dl></div></div><div class=sect2><h3 id=jails-intro>16.3. Introductie<a class=anchor href=#jails-intro></a></h3><div class=paragraph><p>Omdat systeem beheer een complexe en enorme taak is, zijn er vele sterke tools ontwikkeld om het leven van een systeem beheerder makkelijker te maken. Deze tools leveren meestal verbeteringen op de manier waarop systemen worden geïnstalleerd, geconfigureerd en onderhouden. Een deel van de taken waarvan verwacht wordt dat die uitgevoerd wordt door de systeem beheerder is het goed configureren van de beveiliging van een systeem, zodat het kan blijven doorgaan met het serveren van de taak, zonder dat er beveiligingsproblemen optreden.</p></div><div class=paragraph><p>Één van de tools welke gebruikt kan worden om de beveiliging van een FreeBSD systeem te verbeteren zijn <em>jails</em>. Jails zijn geïntroduceerd in FreeBSD 4.X door Poul-Henning Kamp &lt;<a href=mailto:phk@FreeBSD.org>phk@FreeBSD.org</a>>, maar zijn grotendeels verbeterd in FreeBSD 5.X om ze nog sterker en krachtiger te maken. De ontwikkeling gaat nog steeds door met verbeteringen voor het gebruik, performance, betrouwbaarheid en beveiliging.</p></div><div class=sect3><h4 id=jails-what>16.3.1. Wat is een jail<a class=anchor href=#jails-what></a></h4><div class=paragraph><p>BSD achtige systemen hebben sinds 4.2-BSD ondersteuning voor <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a>. De <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a> utility kan gebruikt worden om de root directory van een set processen te wijzigen waardoor een veilige omgeving wordt gecreeërd voor de rest van het systeem. Processen die gemaakt worden in een chroot omgeving kunnen bestanden en bronnen daarbuiten niet benaderen. Daardoor zou een compromitering van een dienst die in een chroot omgeving draait niet direct betekenen dat het hele systeem gecompromiteerd is. De <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a> utility is goed genoeg voor simpele taken, waarbij flexibiliteit en geavanceerde en complexe opties niet nodig zijn. Sinds het uitvinden van het chroot concept, zijn er vele mogelijkheden gevonden om hieruit te kunnen komen en alhoewel ze verbeterd zijn in moderne versies van FreeBSD, werd het duidelijk dat <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> niet de meest ideale oplossing was voor het beveiligen van diensten. Er moest een nieuw subsysteem ontwikkeld worden.</p></div><div class=paragraph><p>Dit is één van de redenen waarom jails zijn ontwikkeld.</p></div><div class=paragraph><p>Jails zijn een verbeterd concept van de <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> omgeving, in verschillende opzichten. In een traditionele <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> omgeving worden processen alleen gelimiteerd in het deel van het bestandssysteem die ze kunnen benaderen. De rest van de systeem bronnen (zoals de set van systeem gebruikers, de draaiende processen of het netwerk subsysteem) worden gedeeld door het chrooted proces en de processen op het host systeem. Jails breiden dit model uit door het niet alleen virtualizeren van de toegang tot het bestandssysteem maar ook tot de set van gebruikers, het netwerk subsysteem van de FreeBSD kernel en een aantal andere delen. Een meer complete set van gespecificeerde controle mogelijkheden die beschikbaar zijn voor het personaliseren van de toegang tot een jail omgeving wordt beschreven in <a href=#jails-tuning>Optimaliseren en administratie</a>.</p></div><div class=paragraph><p>Een jail heeft vier kenmerken:</p></div><div class=ulist><ul><li><p>Een eigen directory structuur - het startpunt van waaruit een jail benaderd wordt. Zodra men in de jail zit, mogen processen niet buiten deze directory structuur komen. Traditionele problemen die <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a>'s ontwerp getart hebben, hebben geen invloed op FreeBSD jails.</p></li><li><p>Een hostname - de hostnaam die gebruikt wordt in de jail. Jails worden met name gebruikt voor het hosten van netwerk diensten, daardoor kan het de systeembeheerder heel erg helpen als er beschrijvende hostnames worden gekozen.</p></li><li><p>Een IP adres - deze wordt gekoppeld aan de jail en kan op geen enkele manier worden gewijzigd tijdens het leven van de jail. Het IP adres van een jail is meestal een alias op een reeds bestaande netwerk interface, maar dit is niet noodzakelijk.</p></li><li><p>Een commando - het padnaam van een uitvoerbaar bestand in de jail. Deze is relatief aan de rootdirectory van de jail omgeving en verschilt per situatie, afhankelijk van het type van de specifieke jail omgeving.</p></li></ul></div><div class=paragraph><p>Buiten deze kenmerken, kunnen jails hun eigen set aan gebruikers en <code>root</code> gebruiker hebben. Uiteraard zijn de mogelijkheden van de <code>root</code> gebruiker beperkt tot de jail omgeving en, vanuit het host systeem gezien, is de <code>root</code> gebruiker geen super-gebruiker. Daarnaast is het de <code>root</code> gebruiker in een jail omgeving niet toegestaan om kritieke operaties uit te voeren op het systeem buiten de gedefinieerde jail omgeving. Meer informatie over de mogelijkheden en beperkingen van de <code>root</code> gebruiker kan gevonden worden in <a href=#jails-tuning>Optimaliseren en administratie</a>hieronder.</p></div></div></div><div class=sect2><h3 id=jails-build>16.4. Creeëren en controleren van jails<a class=anchor href=#jails-build></a></h3><div class=paragraph><p>Sommige beheerders kiezen ervoor om jails op te delen in de volgende twee types: "complete" jails, welke een volledig FreeBSD systeem emuleert en "service" jails, gericht op één applicatie of dienst, mogelijkerwijs draaiende met privileges. Dit is alleen een conceptuele splitsing, de manier van het opbouwen van een jail wordt hierdoor niet veranderd. De <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> handleiding is heel duidelijk over de procedure voor het maken van een jail:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setenv D /here/is/the/jail</span>
<span class=c># mkdir -p $D </span><i class=conum data-value=1></i><b>(1)</b>
<span class=c># cd /usr/src</span>
<span class=c># make buildworld </span><i class=conum data-value=2></i><b>(2)</b>
<span class=c># make installworld DESTDIR=$D </span><i class=conum data-value=3></i><b>(3)</b>
<span class=c># make distribution DESTDIR=$D </span><i class=conum data-value=4></i><b>(4)</b>
<span class=c># mount -t devfs devfs $D/dev </span><i class=conum data-value=5></i><b>(5)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Het selecteren van een locatie voor een jail is het beste beginpunt. Hier zal de jail fysiek te vinden zijn binnen het bestandssysteem van het host systeem. Een goede keuze kan <span class=filename>/usr/jailjailnaam</span> zijn, waar <em>jailnaam</em> de naam is van de jail. Het <span class=filename>/usr</span> bestandssysteem heeft meestal genoeg ruimte voor het jail bestandssysteem, wat voor een "complete" jail betekend dat het eigenlijk een replica is van elk bestand dat standaard aanwezig is binnen het FreeBSD basissysteem.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Als u uw userland al heeft herbouwd met <code>make world</code> of <code>make buildworld</code>, dan kunt u deze stap overslaan en uw bestaande userland in de nieuwe jail installeren.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Dit commando zal de gekozen fysieke directory vullen met de benodigde binaire bestanden, bibliotheken, handleidingen, etc.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Het <code>distribution</code> doel voor make installeert elk benodigd configuratie bestand. In simpelere termen, het installeert alle installeerbare bestanden in <span class=filename>/usr/src/etc</span> naar de <span class=filename>/etc</span> directory van de jail omgeving: <span class=filename>$D/etc</span>.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Het koppelen van het <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> bestandssysteem is niet vereist in een jail. Aan de andere kant, vrijwel elke applicatie heeft toegang nodig tot minstens één apparaat, afhankelijk van het doel van het programma. Het is erg belangrijk om toegang tot apparaten te controleren binnenin een jail, omdat incorrecte instellingen een aanvaller de mogelijkheid kunnen geven om vervelende dingen in de jail te doen. De controle over <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> wordt gedaan door middel van rulesets, welke beschreven worden in de <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.conf&amp;sektion=5&amp;format=html">devfs.conf(5)</a> handleidingen.</td></tr></tbody></table></div><div class=paragraph><p>Zodra een jail is geïnstalleerd, kan het opgestart worden door de <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> applicatie. De <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> applicatie heeft vier benodigde argumenten welke beschreven worden in <a href=#jails-what>Wat is een jail</a>. Er kunnen ook andere argumenten gebruikt worden, om bijvoorbeeld de jail te starten met de instellingen van een specifieke gebruiker. Het <code><em>commando</em></code> argument hangt af van het type jail, voor een <em>virtueel systeem</em> is <span class=filename>/etc/rc</span> een goede keuze, omdat het de reguliere opstart procedure nabootst van een FreeBSD systeem. Voor een <em>dienst</em> jail is het geheel afhankelijk van de dienst of applicatie die in de jail gaat draaien.</p></div><div class=paragraph><p>Jails worden over het algemeen gestart tegelijkertijd met de rest van het systeem. Het FreeBSD <span class=filename>rc</span> mechanisme levert een makkelijke manier om dat te doen:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Een lijst van jails die opgestart moeten worden tijdens het opstarten van het systeem, moeten worden toegevoegd aan het <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> bestand:</p><div class="literalblock programlisting"><div class=content><pre>jail_enable=&#34;YES&#34;   # Stel dit in op NO om te voorkomen dat er jails gestart worden
jail_list=&#34;www&#34;     # Door spaties gescheiden lijst van jails</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De jail namen in <code>jail_list</code> mogen alleen alfanumerieke karakters bevatten.</p></div></td></tr></tbody></table></div></li><li><p>Voor elke jail die gespecificeerd is in <code>jail_list</code> moet een groep van <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> instellingen worden toegevoegd:</p><div class="literalblock programlisting"><div class=content><pre>jail_www_rootdir=&#34;/usr/jail/www&#34;     # de hoofd directory van de jail
jail_www_hostname=&#34;www.example.org&#34;  # de hostnaam van de jail
jail_www_ip=&#34;192.168.0.10&#34;           # het IP adres van de jail
jail_www_devfs_enable=&#34;YES&#34;          # moet devfs wel of niet gekoppeld worden in de jail
jail_www_devfs_ruleset=&#34;www_ruleset&#34; # welke devfs ruleset gebruikt moet worden voor de jail</pre></div></div><div class=paragraph><p>De standaard opstart variabelen in <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> gebruiken het <span class=filename>/etc/rc</span> bestand om de jail op te starten, wat er vanuit gaat dat de jail een compleet virtueel systeem is. Voor service jails moet het standaard opstart commando worden gewijzigd door het aanpassen van de <code>jail<em>jailname</em>exec_start</code> optie.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voor een complete lijst van beschikbare opties, zie de <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> handleiding.</p></div></td></tr></tbody></table></div></li></ol></div></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a> kan worden gebruikt om jails handmatig te starten en te stoppen, mits er een overeenkomstige verzameling regels bestaat in <span class=filename>/etc/rc.conf</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service jail start www</span>
<span class=c># service jail stop www</span></code></pre></div></div><div class=paragraph><p>Er is op dit moment geen nette methode om een jail te stoppen. Dit komt omdat de benodigde applicaties die een nette afsluiting verzorgen, niet beschikbaar zijn in een jail. De beste manier om een jail af te sluiten is door het volgende commando van binnenin de jail uit te voeren of door middel van het <a href="https://man.freebsd.org/cgi/man.cgi?query=jexec&amp;sektion=8&amp;format=html">jexec(8)</a> commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sh /etc/rc.shutdown</span></code></pre></div></div><div class=paragraph><p>Meer informatie hierover kan gevonden worden in de <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> handleiding.</p></div></div><div class=sect2><h3 id=jails-tuning>16.5. Optimaliseren en administratie<a class=anchor href=#jails-tuning></a></h3><div class=paragraph><p>Er zijn meerdere opties beschikbaar die ingesteld kunnen worden voor elke jail, en er zijn meerdere mogelijkheden om een FreeBSD host systeem te combineren met jails om een betere scheiding tussen systeem en applicaties te verkrijgen. Deze sectie leert:</p></div><div class=ulist><ul><li><p>Een aantal opties zijn beschikbaar voor het optimaliseren van het gedrag en beveiligings beperkingen die geïmplementeerd worden in een jail.</p></li><li><p>Een aantal "high-level" applicaties die gebruikt worden voor het beheren van jails, welke beschikbaar zijn via de FreeBSD Ports Collectie en kunnen gebruikt worden om een complete jail-gebaseerde oplossing te creeëren.</p></li></ul></div><div class=sect3><h4 id=jails-tuning-utilities>16.5.1. Systeem applicaties voor het optimaliseren van jails onder FreeBSD<a class=anchor href=#jails-tuning-utilities></a></h4><div class=paragraph><p>Het goed kunnen optimaliseren van een jail configuratie wordt veelal gedaan door het instellen van <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> variabelen. Er bestaat een speciale subtak van sysctl voor het organiseren van alle relevante opties: de <code>security.jail.*</code> hierarchie binnen de FreeBSD kernel. Hieronder staat een lijst van de belangrijkste jail-gerelateerde sysctl variabelen, met informatie over de standaard waarden. De benaming zou zelf beschrijvend moeten zijn, maar voor meer informatie kunnen de <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> handleidingen geraadpleegd worden.</p></div><div class=ulist><ul><li><p><code>security.jail.set_hostname_allowed: 1</code></p></li><li><p><code>security.jail.socket_unixiproute_only: 1</code></p></li><li><p><code>security.jail.sysvipc_allowed: 1</code></p></li><li><p><code>security.jail.enforce_statfs: 2</code></p></li><li><p><code>security.jail.allow_raw_sockets: 0</code></p></li><li><p><code>security.jail.chflags_allowed: 0</code></p></li><li><p><code>security.jail.jailed: 0</code></p></li></ul></div><div class=paragraph><p>Deze variabelen kunnen door de systeem beheerder gebruikt worden op het <em>host systeem</em> om limitaties toe te voegen of te verwijderen, welke standaard opgedwongen worden aan de <code>root</code> gebruiker. Let op, een aantal beperkingen kan niet worden aangepast. De <code>root</code> gebruiker mag geen bestandssystemen koppelen of ontkoppelen binnenin een <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a>. De <code>root</code> gebruiker mag ook geen <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> rulesets laden of ontladen, firewall rules plaatsen of andere taken uitvoeren die vereisen dat de in-kernel data wordt aangepast, zoals het aanpassen van de <code>securelevel</code> variabele in de kernel.</p></div><div class=paragraph><p>Het basis systeem van FreeBSD bevat een basis set van applicaties voor het inzien van de actieve jails, en voor het uitvoeren van administratieve commando’s in een jail. De <a href="https://man.freebsd.org/cgi/man.cgi?query=jls&amp;sektion=8&amp;format=html">jls(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=jexec&amp;sektion=8&amp;format=html">jexec(8)</a> commando’s zijn onderdeel van het basis systeem en kunnen gebruikt worden voor het uitvoeren van de volgende simpele taken:</p></div><div class=ulist><ul><li><p>Het printen van een lijst van actieve jails met het corresponderende jail ID (JID), IP adres, de hostnaam en het pad.</p></li><li><p>Het koppelen met een actieve jail vanuit het host systeem, en voor het uitvoeren van administratieve taken in de jail zelf. Dit is bijzonder handig wanneer de <code>root</code> gebruiker een jail netjes wilt afsluiten. Het <a href="https://man.freebsd.org/cgi/man.cgi?query=jexec&amp;sektion=8&amp;format=html">jexec(8)</a> commando kan ook gebruikt worden om een shell te starten in een jail om daarmee administratieve taken uit te voeren; bijvoorbeeld met:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># jexec 1 tcsh</span></code></pre></div></div></li></ul></div></div><div class=sect3><h4 id=jails-tuning-admintools>16.5.2. Administratieve applicaties op hoog niveau in de FreeBSD Ports Collection.<a class=anchor href=#jails-tuning-admintools></a></h4><div class=paragraph><p>Tussen de vele software van derde partijen voor jail beheer, is één van de meest complete en bruikbare paketten: <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/jailutils/>sysutils/jailutils</a>. Dit is een set van kleine applicaties, die bijdragen aan <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> beheer. Kijk op de web pagina voor meer informatie.</p></div></div></div><div class=sect2><h3 id=jails-application>16.6. Toepassing van jails<a class=anchor href=#jails-application></a></h3><div class=sect3><h4 id=jails-service-jails>16.6.1. Dienst jails<a class=anchor href=#jails-service-jails></a></h4><div class=paragraph><p>Deze sectie is gebaseerd op een idee van Simon L. B. Nielsen &lt;<a href=mailto:simon@FreeBSD.org>simon@FreeBSD.org</a>> op <a href=http://simon.nitro.dk/service-jails.html>http://simon.nitro.dk/service-jails.html</a>, en een geupdate artikel door Ken Tom <a href=mailto:locals@gmail.com>locals@gmail.com</a>. Deze sectie illusteert hoe een FreeBSD systeem opgezet kan worden met een extra laag beveiliging door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a>. Er wordt vanuit gegaan dat het betrokken systeem minstens RELENG_6_0 draait en dat de informatie eerder in dit hoofdstuk goed begrepen is.</p></div><div class=sect4><h5 id=jails-service-jails-design>16.6.1.1. Ontwerp<a class=anchor href=#jails-service-jails-design></a></h5><div class=paragraph><p>Één van de grootste problemen met jails is het beheer van het upgrade proces. Dit is meestal een probleem omdat elke jail vanaf het begin af aan moet worden opgebouwd wanneer er geupdate wordt. Meestal is dit voor een enkele jail geen probleem, omdat het update proces redelijk simpel is, maar het kan een vervelende tijdrovende klus zijn als er meerdere jails zijn.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Deze opstelling vereist uitgebreide kennis en ervaring van FreeBSD en zijn mogelijkheden. Als onderstaande stappen te lastig lijken te zijn, wordt aangeraden om een simpeler systeem te bekijken zoals <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/ezjail/>sysutils/ezjail</a>, welke een simpele manier geeft voor het beheren van FreeBSD jails en niet zo complex is als deze opstelling.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het idee werd geopperd om zulke problemen zoveel als mogelijk te voorkomen door zoveel als mogelijk te delen tussen de verschillende jails op een zo veilig mogelijke manier - door gebruik te maken van alleen-lezen <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_nullfs&amp;sektion=8&amp;format=html">mount_nullfs(8)</a> koppelingen, zodat het upgraden simpeler wordt en het inzetten van jails voor enkele diensten interessanter wordt. Daarnaast geeft het een simpele manier om nieuwe jails toe te voegen of te verwijderen en om deze te upgraden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voorbeelden binnen deze context zijn: een HTTP server, een DNS server, een SMTP server enzovoorts.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De doelen van de opstelling zoals beschreven in dit hoofdstuk zijn:</p></div><div class=ulist><ul><li><p>Het creeëren van een simpele en makkelijk te begrijpen jail structuur. Dit impliceert dat er <em>niet</em> elke keer een volledige installworld gedraaid hoeft te worden voor elke jail.</p></li><li><p>Het makkelijk maken van het aanmaken en verwijderen van jails.</p></li><li><p>Het makkelijk maken van het updaten en upgraden van bestaande jails.</p></li><li><p>Het mogelijk maken van het draaien van een eigen gemaakte FreeBSD tak.</p></li><li><p>Paranoia zijn over beveiliging, zoveel mogelijk beperken, om de kans op inbraak zo klein mogelijk te maken.</p></li><li><p>Het zoveel mogelijk besparen van ruimte en inodes.</p></li></ul></div><div class=paragraph><p>Zoals reeds besproken is dit ontwerp sterk afhankelijk van het hebben van een "master-template", welke alleen-lezen (beter bekend als nullfs) gekoppeld is binnen elke jail, en een beschrijfbaar apparaat per jail. Een apparaat kan hierin zijn een aparte fysieke schijf, een partitie, of een door vnodes ondersteunde <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> apparaat. In dit voorbeeld wordt gebruik gemaakt van lezen-schrijven nullfs koppelpunten.</p></div><div class=paragraph><p>Het gebruikte bestandssysteem wordt beschreven door de volgende lijst:</p></div><div class=ulist><ul><li><p>Elke jail zal gekopeld worden onder de <span class=filename>/home/j</span> directory.</p></li><li><p><span class=filename>/home/j/mroot</span> is de template voor elke jail en tevens de alleen-lezen partitie voor elke jail.</p></li><li><p>Voor elke jail zal een lege directory structuur gemaakt worden, welke valt onder de <span class=filename>/home/j</span> directory.</p></li><li><p>Elke jail heeft een <span class=filename>/s</span> directory, welke gekoppeld zal worden aan het beschrijfbare gedeelte van het systeem.</p></li><li><p>Elke jail zal zijn eigen beschrijfbaar systeem hebben welke gebaseerd is op <span class=filename>/home/j/skel</span>.</p></li><li><p>Elke jail ruimte (het beschrijfbare gedeelte van de jail), wordt gecreeërd in de <span class=filename>/home/js</span> directory.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De voorbeelden gaan er vanuit dat de jails geplaatst worden in <span class=filename>/home</span> partitie. Dit kan uiteraard aangepast worden, maar dan moeten de voorbeelden hieronder ook worden aangepast naar de plek die gebruikt zal worden.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=jails-service-jails-template>16.6.1.2. De template creeëren<a class=anchor href=#jails-service-jails-template></a></h5><div class=paragraph><p>Deze sectie leert welke stappen er genomen moeten worden om de master-template te maken. Deze zal het alleen-lezen gedeelte vormen van de jails.</p></div><div class=paragraph><p>Het is altijd een goed idee om ervoor te zorgen dat het FreeBSD systeem de laatst beschikbare -RELEASE versie draait. Zie het corresponderende hoofdstuk in het <a href=./#makeworld>Handboek</a> om te lezen hoe dit gedaan wordt. In het geval dat het de moeite niet is om te updaten, zal een buildworld nodig zijn voordat er verder gegaan kan worden. Daarnaast is het <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cpdup/>sysutils/cpdup</a> pakket benodigd. Er wordt gebruik gemaakt van de<a href="https://man.freebsd.org/cgi/man.cgi?query=portsnap&amp;sektion=8&amp;format=html">portsnap(8)</a> applicatie om de FreeBSD Ports Collectie te downloaden. Het handbook met het <a href=./#portsnap>hoofdstuk</a> over Portsnap, is een aanrader voor nieuwe gebruikers.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Als eerste moet er een directory structuur gecreeërd worden voor het alleen-lezen bestandssysteem, welke de FreeBSD binaries zal bevatten voor de jails. Daarna wordt het alleen-lezen bestandssysteem geïnstalleerd vanuit de FreeBSD broncode directory in de jail template:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /home/j /home/j/mroot</span>
<span class=c># cd /usr/src</span>
<span class=c># make installworld DESTDIR=/home/j/mroot</span></code></pre></div></div></li><li><p>Hierna moet de FreeBSD Ports Collectie worden voorbereid, evenals de FreeBSD broncode directory, wat voor mergemaster vereist is:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /home/j/mroot</span>
<span class=c># mkdir usr/ports</span>
<span class=c># portsnap -p /home/j/mroot/usr/ports fetch extract</span>
<span class=c># cpdup /usr/src /home/j/mroot/usr/src</span></code></pre></div></div></li><li><p>Nu moet er een "skelet" gecreeërd worden voor het bechrijfbare gedeelte van het systeem:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /home/j/skel /home/j/skel/home /home/j/skel/usr-X11R6 /home/j/skel/distfiles</span>
<span class=c># mv etc /home/j/skel</span>
<span class=c># mv usr/local /home/j/skel/usr-local</span>
<span class=c># mv tmp /home/j/skel</span>
<span class=c># mv var /home/j/skel</span>
<span class=c># mv root /home/j/skel</span></code></pre></div></div></li><li><p>De mergemaster applictie moet gebruikt worden om de ontbrekende configuratie bestanden te installeren. Erna moeten alle overtollige directories die gecreeërd zijn door mergemaster verwijderd worden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mergemaster -t /home/j/skel/var/tmp/temproot -D /home/j/skel -i</span>
<span class=c># cd /home/j/skel</span>
<span class=c># rm -R bin boot lib libexec mnt proc rescue sbin sys usr dev</span></code></pre></div></div></li><li><p>Nu moet er een symbolische link gemaakt worden tussen het beschrijfbare bestandssysteem en het alleen-lezen bestandssysteem, zorg ervoor dat de links gemaakt worden in de juiste <span class=filename>/s</span> directory. Als hier echte directories worden gemaakt of de directories worden op de verkeerde plak aangemaakt zal dit resulteren in een mislukte installatie:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /home/j/mroot</span>
<span class=c># mkdir s</span>
<span class=c># ln -s s/etc etc</span>
<span class=c># ln -s s/home home</span>
<span class=c># ln -s s/root root</span>
<span class=c># ln -s ../s/usr-local usr/local</span>
<span class=c># ln -s ../s/usr-X11R6 usr/X11R6</span>
<span class=c># ln -s ../../s/distfiles usr/ports/distfiles</span>
<span class=c># ln -s s/tmp tmp</span>
<span class=c># ln -s s/var var</span></code></pre></div></div></li><li><p>Als laatste stap moet er een generieke <span class=filename>/home/j/skel/etc/make.conf</span> gemaakt worden met de volgende inhoud:</p><div class="literalblock programlisting"><div class=content><pre>WRKDIRPREFIX?=  /s/portbuild</pre></div></div><div class=paragraph><p>Door het gebruik van <code>WRKDIRPREFIX</code> op deze manier, is het mogelijk om per jail FreeBSD ports te compileren. Onthoud dat de ports directory onderdeel is van het alleen-lezen bestandssysteem. Het eigen pad voor <code>WRKDIRPREFIX</code> maakt het mogelijk dat port builds gedaan worden op het beschrijfbare gedeelte van elke jail.</p></div></li></ol></div></div></div></div><div class=sect4><h5 id=jails-service-jails-creating>16.6.1.3. Jails creeëren<a class=anchor href=#jails-service-jails-creating></a></h5><div class=paragraph><p>Nu we een complete FreeBSD template hebben, kunnen we de jails opzetten en configureren in <span class=filename>/etc/rc.conf</span>. Dit voorbeeld demonstreert het creeëren van drie jails: "NS", "MAIL" en "WWW".</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Zet het volgende in <span class=filename>/etc/fstab</span> zodat de alleen-lezen template voor de jails en de beschrijfbare partititie beschikbaar zijn in de respectievelijke jails:</p><div class="literalblock programlisting"><div class=content><pre>/home/j/mroot   /home/j/ns     nullfs  ro  0   0
/home/j/mroot   /home/j/mail   nullfs  ro  0   0
/home/j/mroot   /home/j/www    nullfs  ro  0   0
/home/js/ns     /home/j/ns/s   nullfs  rw  0   0
/home/js/mail   /home/j/mail/s nullfs  rw  0   0
/home/js/www    /home/j/www/s  nullfs  rw  0   0</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Partities die gemarkeerd zijn met een 0 als "passnummer" worden niet gecontroleerd door <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> tijdens het opstarten, en partities met een "dumpnummer" van 0 worden niet geback-upped door <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>. Het is niet gewenst dat fsck de nullfs koppelingen controleert of dat dump een back-up maakt van de alleen-lezen nullfs koppelingen van de jails. Daarom worden ze gemarkeerd met "0 0" in de laatste twee kolommen van elke <span class=filename>fstab</span> regel hierboven.</p></div></td></tr></tbody></table></div></li><li><p>Configureer de jails in <span class=filename>/etc/rc.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>jail_enable=&#34;YES&#34;
jail_set_hostname_allow=&#34;NO&#34;
jail_list=&#34;ns mail www&#34;
jail_ns_hostname=&#34;ns.example.org&#34;
jail_ns_ip=&#34;192.168.3.17&#34;
jail_ns_rootdir=&#34;/usr/home/j/ns&#34;
jail_ns_devfs_enable=&#34;YES&#34;
jail_mail_hostname=&#34;mail.example.org&#34;
jail_mail_ip=&#34;192.168.3.18&#34;
jail_mail_rootdir=&#34;/usr/home/j/mail&#34;
jail_mail_devfs_enable=&#34;YES&#34;
jail_www_hostname=&#34;www.example.org&#34;
jail_www_ip=&#34;62.123.43.14&#34;
jail_www_rootdir=&#34;/usr/home/j/www&#34;
jail_www_devfs_enable=&#34;YES&#34;</pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>De reden dat de <code>jail<em>name</em>rootdir</code> variabele verwijst naar de <span class=filename>/usr/home</span> directory in plaats van naar <span class=filename>/home</span> komt doordat het fysieke pad van de <span class=filename>/home</span> directory op een standaard FreeBSD installatie verwijst naar <span class=filename>/usr/home</span>. De <code>jail<em>name</em>rootdir</code> variabele mag <em>niet</em> ingesteld worden op een symbolische link, omdat dan de jail weigert te starten. Gebruik het <a href="https://man.freebsd.org/cgi/man.cgi?query=realpath&amp;sektion=1&amp;format=html">realpath(1)</a> programma om te zien welke waarde ingesteld moet worden voor deze variabele. Zie de FreeBSD-SA-07:11.jail waarschuwing voor meer informatie.</p></div></td></tr></tbody></table></div></li><li><p>Creeër de benodigde koppelpunten voor het alleen-lezen bestandssysteem van elke jail:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /home/j/ns /home/j/mail /home/j/www</span></code></pre></div></div></li><li><p>Installeer de beschrijfbare template in elke jail. Let op het gebruik van <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cpdup/>sysutils/cpdup</a>, wat helpt om een goede kopie te maken in elke directory:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /home/js</span>
<span class=c># cpdup /home/j/skel /home/js/ns</span>
<span class=c># cpdup /home/j/skel /home/js/mail</span>
<span class=c># cpdup /home/j/skel /home/js/www</span></code></pre></div></div></li><li><p>In deze fase zijn de jails gebouwd en voorbereid om op te starten. Koppel eerst de benodigde bestandssystemen voor elke jail, en start ze vervolgens door gebruik te maken van het rc-bestand voor de jail:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -a</span>
<span class=c># service jail start</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>De jails zouden nu gestart moeten zijn. Om te zien of ze correct gestart zijn, wordt het <a href="https://man.freebsd.org/cgi/man.cgi?query=jls&amp;sektion=8&amp;format=html">jls(8)</a> programma gebruikt. Het resultaat hiervan ziet er ongeveer als volgend uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># jls</span>
   JID  IP Address      Hostname                      Path
     3  192.168.3.17    ns.example.org                /home/j/ns
     2  192.168.3.18    mail.example.org              /home/j/mail
     1  62.123.43.14    www.example.org               /home/j/www</code></pre></div></div><div class=paragraph><p>Op dit moment, zou het mogelijk moeten zijn om op elke jail aan te loggen, nieuwe gebruikers toe te voegen en het configureren van daemons. De <code>JID</code> kolom geeft het identificatie nummer voor elke gestarte jail. Gebruik het volgende commando om administratieve commando’s uit te voeren in de jail met het <code>JID</code> 3:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># jexec 3 tcsh</span></code></pre></div></div></div><div class=sect4><h5 id=jails-service-jails-upgrading>16.6.1.4. Upgraden<a class=anchor href=#jails-service-jails-upgrading></a></h5><div class=paragraph><p>Naarmate de tijd verstrijkt komt de noodzaak om het systeem te updaten naar een nieuwere versie van FreeBSD, danwel vanwege een veiligheids waarschuwing danwel vanwege nieuwe mogelijkheden die geïmplementeerd zijn en nuttig zijn voor de jails. Het ontwerp van deze opzet levert een makkelijke manier voor het upgraden van jails. Daarnaast minimaliseert het de "down-time", omdat de jails alleen in de allerlaatste minuut uitgeschakeld worden. Het geeft ook de mogelijkheid om terug te keren naar een oudere versie, voor het geval er problemen ontstaan.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>De eerste stap is het upgraden van het host systeem zelf, waarna een nieuwe alleen-lezen template gemaakt wordt in <span class=filename>/home/j/mroot2</span>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /home/j/mroot2</span>
<span class=c># cd /usr/src</span>
<span class=c># make installworld DESTDIR=/home/j/mroot2</span>
<span class=c># cd /home/j/mroot2</span>
<span class=c># cpdup /usr/src usr/src</span>
<span class=c># mkdir s</span></code></pre></div></div><div class=paragraph><p>Het <code>installworld</code> doel creeërt een aantal onnodige directories, welke verwijderd moeten worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chflags -R 0 var</span>
<span class=c># rm -R etc var root usr/local tmp</span></code></pre></div></div></li><li><p>Maak opnieuw de beschrijfbare symbolische linken voor het hoofd bestandssysteem:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s s/etc etc</span>
<span class=c># ln -s s/root root</span>
<span class=c># ln -s s/home home</span>
<span class=c># ln -s ../s/usr-local usr/local</span>
<span class=c># ln -s ../s/usr-X11R6 usr/X11R6</span>
<span class=c># ln -s s/tmp tmp</span>
<span class=c># ln -s s/var var</span></code></pre></div></div></li><li><p>Dit is het juiste moment om de jails te stoppen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service jail stop</span></code></pre></div></div></li><li><p>Ontkoppel de originele bestandssystemen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /home/j/ns/s</span>
<span class=c># umount /home/j/ns</span>
<span class=c># umount /home/j/mail/s</span>
<span class=c># umount /home/j/mail</span>
<span class=c># umount /home/j/www/s</span>
<span class=c># umount /home/j/www</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het beschrijfbare gedeelte van de jail is gekoppeld aan het alleen-lezen gedeelte (<span class=filename>/s</span>) en moet derhalve eerst ontkoppeld worden.</p></div></td></tr></tbody></table></div></li><li><p>Verplaatst het oude alleen-lezen systeem en vervang het door de nieuwe systeem. Het oude systeem dient als reservekopie voor het geval er iets misgaat. De naam moet het zelfde zijn als bij de installatie van het nieuwe systeem. Verplaats de FreeBSD Ports Collectie naar het nieuwe bestandssysteem om ruimte en inodes te besparen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /home/j</span>
<span class=c># mv mroot mroot.20060601</span>
<span class=c># mv mroot2 mroot</span>
<span class=c># mv mroot.20060601/usr/ports mroot/usr</span></code></pre></div></div></li><li><p>Op dit moment is het alleen-lezen gedeelte klaar, de enig overgebleven taak is nu om alle bestandssystemen opnieuw te koppelen en om de jails weer op te starten:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -a</span>
<span class=c># service jail start</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Gebruik het <a href="https://man.freebsd.org/cgi/man.cgi?query=jls&amp;sektion=8&amp;format=html">jls(8)</a> programma om te zien of de jails correct zijn opgestart. Vergeet niet om in elke jail het mergemaster programma te starten. Ook moeten de configuratie bestanden en de rc.d scripts geupdate worden.</p></div></div></div></div></div></div><div class=sect1><h2 id=mac>Hoofdstuk 17. Verplichte Toegangscontrole (MAC)<a class=anchor href=#mac></a></h2><div class=sectionbody><div class=sect2><h3 id=mac-synopsis>17.1. Overzicht<a class=anchor href=#mac-synopsis></a></h3><div class=paragraph><p>In FreeBSD 5.X werden nieuwe beveiligingsuitbreidingen geïntroduceerd uit het TrustedBSD project, dat is gebaseerd op de POSIX®.1e draft. Twee van de meest significante nieuwe beveiligingsmechanismen zijn faciliteiten voor Toegangscontrolelijsten voor bestandssystemen (ACLs) en Verplichte Toegangscontrole (Mandatory Access Control of MAC). Met Verplichte Toegangscontrole kunnen nieuwe toegangscontrolemodules geladen worden, waarmee nieuw beveiligingsbeleid opgelegd kan worden. Een aantal daarvan bieden beveiliging aan hele kleine onderdelen van het systeem, waardoor een bepaalde dienst weerbaarder wordt. Andere bieden allesomvattende gelabelde beveiliging op alle vlakken en objecten. Het verplichte deel van de definitie komt van het feit dat het opleggen van de controle wordt gedaan door beheerders en het systeem en niet wordt overgelaten aan de nukken van gebruikers, zoals wel wordt gedaan met toegangscontrole naar goeddunken (discretionary access control of DAC, de standaardrechten voor bestanden en System V IPC rechten in FreeBSD).</p></div><div class=paragraph><p>In dit hoofdstuk wordt de nadruk gelegd op het Verplichte Toegangscontrole Raamwerk (MAC Framework) en een verzameling van te activeren beveiligingsbeleidsmodules waarmee verschillende soorten beveiligingsmechanismen wordt ingeschakeld.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet u:</p></div><div class=ulist><ul><li><p>Welke MAC beveiligingsbeleidsmodules op dit moment in FreeBSD beschikbaar zijn en welke mechanismen daarbij horen.</p></li><li><p>Wat MAC beveiligingsbeleidsmodules implementeren en het verschil tussen gelabeld en niet-gelabeld beleid.</p></li><li><p>Hoe een systeem efficiënt ingesteld kan worden om met het MAC-raamwerk te werken.</p></li><li><p>Hoe het beleid van de verschillende beveiligingsbeleidsmodules die in het MAC-raamwerk zitten ingesteld kunnen worden.</p></li><li><p>Hoe een veiligere omgeving gemaakt kan worden met het MAC-raamwerk en de getoonde voorbeelden;</p></li><li><p>Hoe de MAC-instellingen getest kunnen worden om er zeker van te zijn dat het raamwerk juist is geïmplementeerd.</p></li></ul></div><div class=paragraph><p>Aangeraden voorkennis:</p></div><div class=ulist><ul><li><p>Begrip van UNIX® en FreeBSD basiskennis (<a href=./#basics>UNIX® beginselen</a>);</p></li><li><p>Bekend zijn met de beginselen van het instellen en compileren van de kernel (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>);</p></li><li><p>Enigszins bekend zijn met beveiliging en wat dat te maken heeft met FreeBSD (<a href=./#security>Beveiliging</a>).</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Het verkeerd gebruiken van de informatie die hierin staat kan leiden tot het niet langer toegang hebben tot een systeem, ergernis bij gebruikers, of het niet langer kunnen gebruiken van de mogelijkheden die X11 biedt. Nog belangrijker is dat niet alleen op MAC vertrouwd moet worden voor de beveiliging van een systeem. Het MAC-raamwerk vergroot alleen het bestaande beveiligingsbeleid; zonder goede beveiligingsprocedures en regelmatige beveiligingscontroles is een systeem nooit helemaal veilig.</p></div><div class=paragraph><p>Het is ook van belang op te merken dat de voorbeelden in dit hoofdstuk alleen voorbeelden zijn. Het is niet aan te raden ze uit te rollen op een productiesysteem. Het implementeren van de verschillende beveiligingsbeleidsmodules dient goed overdacht en getest te worden. Iemand die niet helemaal begrijpt hoe alles werkt, komt er waarschijnlijk achter dat die het complete systeem van voor naar achter en weer terug doorloopt en vele bestanden en mappen opnieuw moet instellen.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_wat_niet_wordt_behandeld>17.1.1. Wat niet wordt behandeld<a class=anchor href=#_wat_niet_wordt_behandeld></a></h4><div class=paragraph><p>In dit hoofdstuk wordt een brede reeks beveiligingsonderwerpen met betrekking tot het MAC-raamwerk behandeld. De ontwikkeling van nieuwe MAC-beveiligingsbeleidsmodules wordt niet behandeld. Een aantal modules die bij het MAC-raamwerk zitten hebben specifieke eigenschappen voor het testen en ontwikkelen van nieuwe modules. Daaronder vallen <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_test&amp;sektion=4&amp;format=html">mac_test(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_stub&amp;sektion=4&amp;format=html">mac_stub(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_none&amp;sektion=4&amp;format=html">mac_none(4)</a>. Meer informatie over deze beveiligingsbeleidsmodules en de mogelijkheden die ze bieden staan in de hulppagina’s.</p></div></div></div><div class=sect2><h3 id=mac-inline-glossary>17.2. Sleuteltermen in dit hoofdstuk<a class=anchor href=#mac-inline-glossary></a></h3><div class=paragraph><p>Voordat dit hoofdstuk gelezen wordt, moeten er een aantal sleuteltermen toegelicht worden. Hiermee wordt hopelijk mogelijke verwarring en de abrupte introductie van nieuwe termen en informatie voorkomen.</p></div><div class=ulist><ul><li><p><em>compartiment</em>: een compartiment is een verzameling van programma’s en gegevens die gepartitioneerd of gescheiden dient te worden en waartoe gebruikers expliciet toegang moeten krijgen op een systeem. Een compartiment staat ook voor een groep, zoals een werkgroep, afdeling, project, of onderwerp. Door gebruik te maken van compartimenten is het mogelijk om een "need-to-know" beveiligingsbeleid in te stellen.</p></li><li><p><em>hoogwatermarkering</em>: Een hoogwatermarkeringsbeleid is een beleid dat toestaat om beveiligingsniveaus te verhogen met het doel informatie dat op een hoger niveau aanwezig is te benaderen. In de meeste gevallen wordt het originele niveau hersteld nadat het proces voltooid is. Momenteel heeft het MAC-raamwerk van FreeBSD hier geen beleid voor, maar de definitie is voor de volledigheid opgenomen.</p></li><li><p><em>integriteit</em>: integriteit, als sleutelconcept, is het niveau van vertrouwen dat in gegevens gesteld kan worden. Als de integriteit van gegevens wordt vergroot, dan geldt dat ook voor het vertrouwen dat in die gegevens gesteld kan worden.</p></li><li><p><em>label</em>: een label is een beveiligingsattribuut dat toegepast kan worden op bestanden, mappen of andere onderdelen van een systeem. Het kan gezien worden als een vertrouwelijkheidsstempel: als er een label op een bestand is geplaatst, beschrijft dat de beveiligingseigenschappen voor dat specifieke bestand en is daarop alleen toegang voor bestanden, gebruikers, bronnen, enzovoort, met gelijke beveiligingsinstellingen. De betekenis en interpretatie van labelwaarden hangt af van de beleidsinstellingen: hoewel sommige beleidseenheden een label beschouwen als representatie van de integriteit of het geheimhoudingsniveau van een object, kunnen andere beleidseenheden labels gebruiken om regels voor toegang in op te slaan.</p></li><li><p><em>niveau</em>: de verhoogde of verlaagde instelling van een beveiligingsattribuut. Met het stijgen van het niveau wordt ook aangenomen dat de veiligheid stijgt.</p></li><li><p><em>laagwatermarkering</em>: Een laagwatermarkeringsbeleid is een beleid dat toestaat om de beveiligingsniveaus te verlagen met het doel informatie te benaderen die minder veilig is. In de meeste gevallen wordt het originele beveiligingsniveau van de gebruiker hersteld nadat het proces voltooid is. De enige beveiligingsbeleidsmodule in FreeBSD die dit gebruikt is <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_lomac&amp;sektion=4&amp;format=html">mac_lomac(4)</a>.</p></li><li><p><em>meervoudig label</em>: de eigenschap <code>multilabel</code> is een optie van het bestandssysteem die in enkelegebruikersmodus met <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a>, tijdens het opstarten via het bestand <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> of tijdens het maken van een nieuw bestandssysteem ingesteld kan worden. Met deze optie wordt het voor een beheerder mogelijk om verschillende MAC-labels op verschillende objecten toe te passen. Deze optie is alleen van toepassing op beveiligingsbeleidsmodules die labels ondersteunen.</p></li><li><p><em>object</em>: een object of systeemobject is een entiteit waar informatie doorheen stroomt op aanwijzing van een <em>subject</em>. Hieronder vallen mappen, bestanden, velden, schermen, toetsenborden, geheugen, magnetische opslag, printers en alle andere denkbare apparaten waarmee gegevens kunnen worden vervoerd of kunnen worden opgeslagen. In de basis is een object een opslageenheid voor gegevens of een systeembron; toegang tot een <em>object</em> betekent in feite toegang tot de gegevens.</p></li><li><p><em>beleidseenheid</em>: een verzameling van regels die aangeven hoe doelstellingen bereikt moeten worden. In een <em>beleidseenheid</em> staat meestal beschreven hoe bepaalde eenheden behandeld dienen te worden. In dit hoofdstuk wordt de term <em>beleidseenheid</em> in deze context gezien als een <em>beveiligingsbeleidseenheid</em>, wat zoveel wil zeggen als een verzameling regels die bepaalt hoe gegevens en informatie stroomt en aangeeft wie toegang tot welke gegevens en informatie heeft.</p></li><li><p><em>gevoeligheid</em>: meestal gebruikt bij het bespreken van MLS. Een gevoeligheidsniveau is een term die gebruikt wordt om te beschrijven hoe belangrijk of geheim de gegevens horen te zijn. Met het stijgen van het gevoeligheidsniveau stijgt ook het belang van de geheimhouding of de vertrouwelijkheid van de gegevens.</p></li><li><p><em>enkelvoudig label</em>: een enkelvoudig label wordt gebruikt als een heel bestandssysteem gebruik maakt van één label om het toegangsbeleid over de gegevensstromen af te dwingen. Als dit voor een bestandssysteem is ingesteld, wat geldt als er geen gebruik gemaakt wordt van de optie <code>multilabel</code>, dan gehoorzamen alle bestanden aan dezelfde labelinstelling.</p></li><li><p><em>subject</em>: een subject is een gegeven actieve entiteit die het stromen van informatie tussen <em>objecten</em> veroorzaakt, bijvoorbeeld een gebruiker, gebruikersprocessor, systeemproces, enzovoort. Op FreeBSD is dit bijna altijd een thread die in een proces namens een gebruiker optreedt.</p></li></ul></div></div><div class=sect2><h3 id=mac-initial>17.3. Uitleg over MAC<a class=anchor href=#mac-initial></a></h3><div class=paragraph><p>Met al deze nieuwe termen in gedachten, kan overdacht worden hoe het MAC-raamwerk de complete beveiliging van een systeem kan vergroten. De verschillende beveiligingsbeleidsmodules die het MAC-raamwerk biedt zouden gebruikt kunnen worden om het netwerk en bestandssystemen te beschermen, gebruikers toegang tot bepaalde poorten en sockets kunnen ontzeggen, en nog veel meer. Misschien kunnen de beleidsmodules het beste gebruikt worden door ze samen in te zetten, door meerdere beveiligingsbeleidsmodules te laden om te komen tot een omgeving waarin de beveiliging uit meerdere lagen is opgebouwd. In een omgeving waarin de beveiliging uit meerdere lagen is opgebouwd zijn meerdere beleidsmodules actief om de beveiliging in de hand te houden. Deze aanpak is anders dan een beleid om de beveiliging sec beter te maken, omdat daarmee in het algemeen elementen in een systeem beveiligd worden dat voor een specifiek doel wordt gebruikt. Het enige nadeel is het benodigde beheer in het geval van meervoudige bestandssysteemlabels, het instellen van toegang tot het netwerk per gebruiker, enzovoort.</p></div><div class=paragraph><p>De nadelen zijn wel minimaal als ze worden vergeleken met het immer durende effect van het raamwerk. Zo zorgt bijvoorbeeld de mogelijkheid om te kiezen welke beleidseenheden voor een specifiek gebruik nodig zijn voor het zo laag mogelijk houden van de beheerslast. Het terugdringen van ondersteuning voor onnodige beleidseenheden kan de beschikbaarheid van systemen verhogen en ook de keuzevrijheid vergroten. Voor een goede implementatie worden alle beveiligingseisen in beschouwing genomen en daarna worden de verschillende beveiligingsbeleidsmodules effectief door het raamwerk geïmplementeerd.</p></div><div class=paragraph><p>Een systeem dat gebruik maakt van de mogelijkheden van MAC dient dus tenminste de garantie te bieden dat een gebruiker niet de mogelijkheid heeft naar eigen inzicht beveiligingsattributen te wijzigen. Alle gebruikersprogramma’s en scripts moeten werken binnen de beperkingen die de toegangsregels voorschrijven volgens de geselecteerde beveiligingsbeleidsmodules. Het voorgaande impliceert ook dat de volledige controle over de MAC-toegangsregels bij de systeembeheerder ligt.</p></div><div class=paragraph><p>Het is de taak van de systeembeheerder om zorgvuldig de juiste beveiligingsbeleidsmodules te kiezen. Voor sommige omgevingen kan het nodig zijn dat de toegang tot het netwerk wordt beperkt. In dat soort gevallen zijn de beleidsmodules <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ifoff&amp;sektion=4&amp;format=html">mac_ifoff(4)</a> en zelfs <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> goede startpunten. In andere gevallen kan de strikte vertrouwelijkheid van bestandssysteemobjecten van belang zijn. Dan zijn beleidsmodules zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_mls&amp;sektion=4&amp;format=html">mac_mls(4)</a> voor dit doel gemaakt.</p></div><div class=paragraph><p>Beslissingen over beleid zouden gemaakt kunnen worden op basis van het netwerkontwerp. Wellicht wordt alleen bepaalde gebruikers toegestaan gebruik te maken van de mogelijkheden van <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> om toegang te krijgen tot het netwerk of Internet. In dat geval is de juiste beleidsmodule <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a>. Maar wat te doen voor bestandssystemen? Moet alle toegang tot bepaalde mappen worden afgesneden van andere gebruikersgroepen of specifieke gebruikers, of moeten de toegang voor gebruikers of programma’s tot bepaalde bestanden worden ingesteld door bepaalde objecten als geheim te bestempelen?</p></div><div class=paragraph><p>In het geval van het bestandssysteem, kan ervoor gekozen worden om de toegang voor sommige objecten voor bepaalde gebruikers als geheim te bestempelen, maar voor andere niet. Bijvoorbeeld: een groot ontwikkelteam wordt opgedeeld in kleinere eenheden van individuen. Ontwikkelaars in project A horen geen toegang te hebben tot objecten die zijn geschreven door ontwikkelaars in project B. Maar misschien moeten ze wel toegang hebben tot objecten die zijn geschreven door ontwikkelaars in project C. Dat is nogal wat. Door gebruik te maken van de verschillende beveiligingsbeleidsmodules in het MAC-raamwerk kunnen gebruikers in hun groepen worden opgedeeld en kan ze toegang gegeven worden tot de juiste locaties zonder dat er angst hoeft te zijn voor het lekken van informatie.</p></div><div class=paragraph><p>Zo heeft dus iedere beveiligingsbeleidsmodule een unieke wijze om om te gaan met de totale beveiliging van een systeem. Het kiezen van modules hoort gebaseerd te zijn op een zorgvuldig uitgedacht beveiligingsbeleid. In veel gevallen wordt het totale beveiligingsbeleid aangepast en opnieuw toegepast op het systeem. Een goed begrip van de verschillende beveiligingsbeleidsmodules die het MAC-raamwerk biedt helpt beheerders bij het kiezen van de juiste beleidseenheden voor hun situatie.</p></div><div class=paragraph><p>De standaard FreeBSD-kernel kent geen ondersteuning voor het MAC-raamwerk en daarom dient de volgende kerneloptie toegevoegd te worden voordat op basis van de voorbeelden of informatie uit dit hoofdstuk wijzigen worden gemaakt:</p></div><div class="literalblock programlisting"><div class=content><pre>options     MAC</pre></div></div><div class=paragraph><p>Hierna dient de kernel herbouwd en opnieuw geïnstalleerd te worden.</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Hoewel in de verschillende hulppagina’s voor MAC-beleidsmodules staat dat ze in de kernel gebouwd kunnen worden, is het mogelijk het systeem van het netwerk af te sluiten en meer. Het implementeren van MAC is net zoiets als het implementeren van een firewall en er moet opgepast worden dat een systeem niet totaal op slot gaat. Er dient rekening gehouden te worden met het teruggaan naar een vorige instelling en het op afstand implementeren van MAC dient bijzonder voorzichtig te gebeuren.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=mac-understandlabel>17.4. MAC-labels begrijpen<a class=anchor href=#mac-understandlabel></a></h3><div class=paragraph><p>Een MAC-label is een beveiligingsattribuut dat toegepast kan worden op subjecten en objecten die door het systeem gaan.</p></div><div class=paragraph><p>Bij het instellen van een label moet de gebruiker in staat zijn om precies te begrijpen wat er gebeurt. De attributen die voor een object beschikbaar zijn hangen af van de geladen beleidsmodule en die interpreteren hun attributen op nogal verschillende manieren. Het resultaat kan resulteren in onverwacht en wellicht ongewenst gedrag van een systeem als het beleid door een gebrek aan begrip verkeerd is ingesteld.</p></div><div class=paragraph><p>Het beveiligingslabel op een object wordt gebruikt als onderdeel van een beveiligingstoegangscontrolebeslissing door een beleidseenheid. Voor sommige beleidseenheden bevat het label zelf alle informatie die nodig is voor het maken van een beslissing; in andere modellen kunnen de labels als onderdeel van een grotere verzameling verwerkt worden, enzovoort.</p></div><div class=paragraph><p>Zo staat bijvoorbeeld het instellen van het label <code>biba/low</code> op een bestand voor een label dat wordt beheerd door de beveiligingsbeleidsmodule Biba, met een waarde van "low".</p></div><div class=paragraph><p>Een aantal beleidsmodules die in FreeBSD de mogelijkheid voor labelen ondersteunen, bieden drie specifieke voorgedefinieerde labels: low, high en equal. Hoewel ze in verschillende beleidsmodules op een andere manier toegangscontrole afdwingen, is er de garantie dat het label <code>low</code> de laagst mogelijke instelling is, het label <code>equal</code> het subject of object uitschakelt of ongemoeid laat en het label <code>high</code> de hoogst mogelijk instelling afdwingt die beschikbaar is in de beleidsmodules Biba en MLS.</p></div><div class=paragraph><p>Binnen een bestandssysteemomgeving met een enkelvoudig label kan er maar één label gebruikt worden op objecten. Hiermee wordt een verzameling van toegangsrechten op het hele systeem opgelegd en dat is voor veel omgevingen voldoende. Er zijn echter een aantal gevallen waarin het wenselijk is meervoudige labels in te stellen op subjecten of objecten in het bestandssysteem. In die gevallen kan de optie <code>multilabel</code> meegegeven worden aan <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a>.</p></div><div class=paragraph><p>In het geval van Biba en MLS kan er een numeriek label gezet worden om het precieze niveau van de hiërarchische controle aan te geven. Dit numerieke niveau wordt gebruikt om informatie in verschillende groepen te partitioneren of te sorteren voor het classificeren voor het geven van toegang voor een bepaalde groep of een groep van een hoger niveau.</p></div><div class=paragraph><p>In de meeste gevallen stelt een beheerder alleen maar een enkelvoudig label in dat door het hele bestandssysteem wordt gebruikt.</p></div><div class=paragraph><p><em>Wacht eens, dat klinkt net als DAC! MAC gaf de controle toch strikt aan de beheerder?</em> Dat klopt nog steeds, <code>root</code> heeft nog steeds de controle in handen en is degene die het beleid instelt zodat gebruikers in de juiste categorie en/of toegangsniveaus worden geplaatst. Daarnaast kunnen veel beleidsmodules ook de gebruiker <code>root</code> beperkingen opleggen. Dan wordt de controle overgedragen aan een groep, maar kan <code>root</code> de instellingen op ieder gewenst moment intrekken of wijzigen. Dit is het hiërarchische of toegangsmodel dat wordt afgedekt door beleidseenheden zoals Biba en MLS.</p></div><div class=sect3><h4 id=_labelinstellingen>17.4.1. Labelinstellingen<a class=anchor href=#_labelinstellingen></a></h4><div class=paragraph><p>Vrijwel alle aspecten voor het instellen van labelbeleid worden uitgevoerd met basissysteemprogramma’s. Die commando’s bieden een eenvoudige interface voor object- of subjectinstellingen of de manipulatie en verificatie van de instellingen.</p></div><div class=paragraph><p>Alle instellingen kunnen gemaakt worden met de hulpprogramma’s <a href="https://man.freebsd.org/cgi/man.cgi?query=setfmac&amp;sektion=8&amp;format=html">setfmac(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=setpmac&amp;sektion=8&amp;format=html">setpmac(8)</a>. Het commando <code>setfmac</code> wordt gebruikt om MAC labels op systeemobjecten in te stellen en <code>setpmac</code> voor het instellen van de labels op systeemsubjecten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfmac biba/high test</span></code></pre></div></div><div class=paragraph><p>Als het bovenstaande commando geen foutmeldingen heeft veroorzaakt, dan komt er een prompt terug. Deze commando’s geven nooit uitvoer, tenzij er een fout is opgetreden; net als bij de commando’s <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=chown&amp;sektion=8&amp;format=html">chown(8)</a>. In sommige gevallen kan de foutmelding <code>Permission denied</code> zijn en deze treedt meestal op als het label wordt ingesteld of gewijzigd op een object dat is beperkt. De systeembeheerder kan de volgende commando’s gebruiken om dit probleem te voorkomen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfmac biba/high test</span>
Permission denied
<span class=c># setpmac biba/low setfmac biba/high test</span>
<span class=c># getfmac test</span>
<span class=nb>test</span>: biba/high</code></pre></div></div><div class=paragraph><p>Hierboven is te zien dat <code>setpmac</code> gebruikt kan worden om aan de instellingen van een beleidsmodules voorbij te gaan door een ander label toe te wijzen aan het aangeroepen proces. Het hulpprogramma <code>getpmac</code> wordt meestal toegepast op processen die al draaien, zoals sendmail: hoewel er een proces-ID nodig is in plaats van een commando, is de logica gelijk. Als gebruikers proberen een bestand te manipuleren waar ze geen toegang tot hebben, onderhevig aan de regels van de geladen beleidsmodules, dan wordt de foutmelding <code>Operation not permitted</code> weergegeven door de functie <code>mac_set_link</code>.</p></div><div class=sect4><h5 id=_labeltypen>17.4.1.1. Labeltypen<a class=anchor href=#_labeltypen></a></h5><div class=paragraph><p>Met de beleidsmodules <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_mls&amp;sektion=4&amp;format=html">mac_mls(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_lomac&amp;sektion=4&amp;format=html">mac_lomac(4)</a> is het mogelijk eenvoudige labels toe te wijzen. Die kunnen hoog, gelijk aan en laag zijn. Hieronder een beschrijving van wat die labels betekenen:</p></div><div class=ulist><ul><li><p>Het label <code>low</code> is de laagst mogelijke labelinstelling die een object of subject kan hebben. Deze instelling op objecten of subjecten blokkeert hun toegang tot objecten of subjecten met de markering hoog.</p></li><li><p>Het label <code>equal</code> hoort alleen ingesteld te worden op objecten die uitgesloten moeten worden van een beleidsinstelling.</p></li><li><p>Het label <code>high</code> geeft een object of subject de hoogst mogelijke instelling.</p></li></ul></div><div class=paragraph><p>Afhankelijke van iedere beleidsmodule heeft iedere instelling een ander informatiestroomdirectief tot gevolg. Het lezen van de hulppagina’s die van toepassing zijn geeft inzicht in de precieze eigenschappen van de standaard labelinstellingen.</p></div><div class=sect5><h6 id=_gevorderde_labelinstellingen>17.4.1.1.1. Gevorderde labelinstellingen<a class=anchor href=#_gevorderde_labelinstellingen></a></h6><div class=paragraph><p>Dit zijn de labels met numerieke graden die gebruikt worden voor <code>vergelijking:afdeling+afdeling</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>biba/10:2+3+6(5:2+3-20:2+3+4+5+6)</pre></div></div><div class=paragraph><p>Het bovenstaande kan dus geïnterpreteerd worden als:</p></div><div class=paragraph><p>"Biba-beleidslabel"/"Graad 10":"Afdelingen 2, 3 en 6": ("graad 5 …​")</p></div><div class=paragraph><p>In dit voorbeeld is de eerste graad de "effectieve graad" met de "effectieve afdelingen", de tweede graad is de lage graad en de laatste is de hoge graad. In de meeste instellingen worden deze instellingen niet gebruikt. Ze zijn inderdaad instellingen voor gevorderden.</p></div><div class=paragraph><p>Als ze worden toegepast op systeemobjecten, hebben ze alleen een huidige graad/afdeling in vergelijking met systeemsubjecten, omdat ze de reikwijdte van rechten in het systeem en op netwerkinterfaces aangeven, waar ze gebruikt worden voor toegangscontrole.</p></div><div class=paragraph><p>De graad en afdelingen in een subject en object paar wordt gebruikt om een relatie te construeren die "dominantie" heet, waar een subject een object domineert, geen van beiden domineert, of beiden elkaar domineren. Het geval "beiden domineren" komt voor als de twee labels gelijk zijn. Vanwege de natuur van de informatiestroom van Biba, heeft een gebruiker rechten op een verzameling van afdelingen, "need to know", die overeen zouden kunnen komen met projecten, maar objecten hebben ook een verzameling van afdelingen. Gebruikers dienen wellicht hun rechten onder te verdelen met <code>su</code> of <code>setpmac</code> om toegang te krijgen tot objecten in een afdeling die geen verboden terrein voor ze zijn.</p></div></div></div><div class=sect4><h5 id=_gebruikers_en_labelinstellingen>17.4.1.2. Gebruikers en labelinstellingen<a class=anchor href=#_gebruikers_en_labelinstellingen></a></h5><div class=paragraph><p>Gebruikers moeten zelf labels hebben, zodat hun bestanden en processen juist kunnen samenwerken met het beveiligingsbeleid dat op een systeem is ingesteld. Dit wordt ingesteld via het bestand <span class=filename>login.conf</span> door gebruik te maken van aanmeldklassen. Iedere beleidsmodule die labels gebruikt implementeert ook de instelling van de gebruikersklasse.</p></div><div class=paragraph><p>Een voorbeeld dat iedere instelling uit de beleidsmodule bevat is hieronder te zien:</p></div><div class="literalblock programlisting"><div class=content><pre>default:\
        :copyright=/etc/COPYRIGHT:\
        :welcome=/etc/motd:\
        :setenv=MAIL=/var/mail/$,BLOCKSIZE=K:\
        :path=~/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin:\
        :manpath=/usr/shared/man /usr/local/man:\
        :nologin=/usr/sbin/nologin:\
        :cputime=1h30m:\
        :datasize=8M:\
        :vmemoryuse=100M:\
        :stacksize=2M:\
        :memorylocked=4M:\
        :memoryuse=8M:\
        :filesize=8M:\
        :coredumpsize=8M:\
        :openfiles=24:\
        :maxproc=32:\
        :priority=0:\
        :requirehome:\
        :passwordtime=91d:\
        :umask=022:\
        :ignoretime@:\
        :label=partition/13,mls/5,biba/10(5-15),lomac/10[2]:</pre></div></div><div class=paragraph><p>De optie <code>label</code> wordt gebruikt om het standaardlabel voor aanmeldklasse in te stellen dat door MAC wordt afgedwongen. Het wordt gebruikers nooit toegestaan deze waarde te wijzigen, dus kan het gezien worden als niet optioneel vanuit het perspectief van de gebruiker. In de echte wereld besluit een beheerder echter nooit iedere beleidsmodule te activeren. Het wordt sterk aangeraden de rest van die hoofdstuk te lezen alvorens (een deel van) de bovenstaande instellingen te implementeren.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Gebruikers kunnen hun label wijzigen na het initiële aanmelden, maar dit is wel afhankelijk van de beperkingen van een beleidsinstelling. Het bovenstaande voorbeeld vertelt de beleidseenheid Biba dat de minimale integriteit van een proces 5 en het maximum 15, maar dat het effectieve label standaard 10 is. Het proces draait op niveau 10, totdat het proces het label wijzigt, misschien door een gebruiker die <code>setpmac</code> gebruikt, bij het aanmelden beperkt tot de door Biba ingestelde reeks.</p></div></td></tr></tbody></table></div><div class=paragraph><p>In alle gevallen dient de database met aanmeldklassemogelijkheden opnieuw gebouwd te worden met <code>cap_mkdb</code> na het wijzigen van <span class=filename>login.conf</span>. Dit wordt ook in alle komende voorbeelden en beschrijvingen gedaan.</p></div><div class=paragraph><p>Het is belangrijk op te merken dat in veel gevallen sites te maken hebben met bijzonder grote aantallen gebruikers waardoor er een aantal verschillende aanmeldklassen nodig zijn. Het is dan nodig gedetailleerd te plannen omdat dit anders bijzonder complex wordt om te onderhouden.</p></div></div><div class=sect4><h5 id=_netwerkinterfaces_en_labelinstellingen>17.4.1.3. Netwerkinterfaces en labelinstellingen<a class=anchor href=#_netwerkinterfaces_en_labelinstellingen></a></h5><div class=paragraph><p>Labels kunnen ook ingesteld worden op netwerkinterfaces om te assisteren bij het controleren van het stromen van gegevens over het netwerk. In alle gevallen werken ze op dezelfde wijze als het beleid werkt ten aanzien van objecten. Gebruikers met bijvoorbeeld een hoge instelling in <code>biba</code> krijgen geen toegang tot interfaces met een laag label.</p></div><div class=paragraph><p>Het <code>maclabel</code> kan meegegeven worden aan <code>ifconfig</code> als het MAC-label op netwerkinterfaces wordt ingesteld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bge0 maclabel biba/equal</span></code></pre></div></div><div class=paragraph><p>In het bovenstaande voorbeeld wordt het MAC-label <code>biba/equal</code> ingesteld op de interface <a href="https://man.freebsd.org/cgi/man.cgi?query=bge&amp;sektion=4&amp;format=html">bge(4)</a>. Als er een instelling wordt gebruikt die gelijkvormig is aan <code>biba/high(low-high)</code>, dan moet het volledige label worden ingegeven, anders treedt er een fout op.</p></div><div class=paragraph><p>Iedere beleidsmodule die labels ondersteunt een instelling waarmee het MAC-label op netwerkinterfaces kan worden uitgeschakeld. Het label instellen op <code>equal</code> heeft hetzelfde effect. Deze instellingen zijn na te kijken in de uitvoer van <code>sysctl</code>, de hulppagina van het beleid en zelfs later in dit hoofdstuk.</p></div></div></div><div class=sect3><h4 id=_enkelvoudig_label_of_meervoudig_label>17.4.2. Enkelvoudig label of meervoudig label?<a class=anchor href=#_enkelvoudig_label_of_meervoudig_label></a></h4><div class=paragraph><p>Standaard gebruikt een systeem de optie <code>singlelabel</code>. Wat betekent dit voor een beheerder? Er zijn een aantal verschillen die allemaal hun eigen voor- en nadelen hebben voor de flexibiliteit in het beveiligingsmodel voor een systeem.</p></div><div class=paragraph><p>Bij gebruik van <code>singlelabel</code> kan er maar één label, bijvoorbeeld <code>biba/high</code>, gebruikt worden voor ieder subject of object. Hierdoor is er minder beheer nodig, maar de flexibiliteit voor beleid dat labels ondersteunt daalt erdoor. Veel beheerders willen de optie <code>multilabel</code> gebruiken in hun beveiligingsmodel.</p></div><div class=paragraph><p>De optie <code>multilabel</code> staat ieder subject of object toe om zijn eigen onafhankelijke MAC-label te hebben in plaats van de standaardoptie <code>singlelabel</code>, die maar één label toestaat op een hele partitie. De labelopties <code>multilabel</code> en <code>single</code> zijn alleen verplicht voor de beleidseenheden die de mogelijkheid bieden om te labelen, waaronder de beleidsmogelijkheden van Biba, Lomac, MLS en SEBSD.</p></div><div class=paragraph><p>In veel gevallen hoeft <code>multilabel</code> niet eens ingesteld te worden. Stel er is de volgende situatie en beveiligingsmodel:</p></div><div class=ulist><ul><li><p>FreeBSD-webserver die gebruik maakt van het MAC-raamwerk en een mengeling van verschillende beleidseenheden.</p></li><li><p>De webserver heeft maar één label nodig, <code>biba/high</code>, voor alles in het systeem. Hier is de optie <code>multilabel</code> voor het bestandssysteem niet nodig, omdat een enkelvoudig label altijd van toepassing is.</p></li><li><p>Maar omdat de machine als webserver dienst gaat doen, dient de webserver te draaien als <code>biba/low</code> om administratiemogelijkheden te voorkomen. Later wordt beschreven hoe de beleidseenheid Biba werkt, dus als de voorgaande opmerking wat lastig te begrijpen is, lees dan verder en kom later nog een keer terug. De server zou een aparte partitie kunnen gebruiken waarop <code>biba/low</code> van toepassing kan zijn voor de meeste, zo niet alle, runtime-statussen. Er ontbreekt veel in dit voorbeeld, bijvoorbeeld de restricties op gegevens en (gebruikers)instellingen. Dit was slechts een snel voorbeeld om de hiervoor aangehaalde stelling te ondersteunen.</p></li></ul></div><div class=paragraph><p>Als er een niet-labelende beleidseenheid wordt gebruikt, dan is de optie <code>multilabel</code> nooit verplicht. Hieronder vallen de beleidseenheden <code>seeotheruids</code>, <code>portacl</code> en <code>partition</code>.</p></div><div class=paragraph><p>Bij gebruik van <code>multilabel</code> voor een partitie en het neerzetten van een beveiligingsmodel gebaseerd op <code>multilabel</code> functionaliteit gaat de deur open voor hogere administratieve rompslomp, omdat alles in een bestandssysteem een label krijgt. Hieronder vallen mappen, bestanden en zelfs apparaatknooppunten.</p></div><div class=paragraph><p>Het volgende commando stelt <code>multilabel</code> in op de bestandssystemen om meerdere labels te kunnen krijgen. Dit kan alleen uitgevoerd worden in enkele gebruikersmodus:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tunefs -l enable /</span></code></pre></div></div><div class=paragraph><p>Dit is geen criterium voor het wisselbestandssysteem.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige gebruikers hebben problemen ondervonden met het instellen van de vlag <code>multilabel</code> op de rootpartitie. Als dit het geval is, kijk dan naar <a href=#mac-troubleshoot>Problemen oplossen met het MAC-raamwerk</a> van dit hoofdstuk.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=mac-planning>17.5. De beveiligingsconfiguratie plannen<a class=anchor href=#mac-planning></a></h3><div class=paragraph><p>Wanneer een nieuwe technologie wordt geïmplementeerd is een planningsfase altijd een goed idee. Tijdens de planningsfases zou een beheerder in het algemeen naar de "big picture" moeten kijken, en daarbij minstens het volgende in de gaten proberen te houden:</p></div><div class=ulist><ul><li><p>De implementatiebenodigdheden;</p></li><li><p>De implementatiedoelen;</p></li></ul></div><div class=paragraph><p>Voor MAC-installaties houden deze in:</p></div><div class=ulist><ul><li><p>Hoe de beschikbare informatie en bronnen die op het doelsysteem aanwezig zijn te classificeren.</p></li><li><p>Voor wat voor soort informatie of bronnen de toegang te beperken samen met het type van de beperkingen die dienen te worden toegepast.</p></li><li><p>Welke MAC-module(s) nodig zullen zijn om dit doel te bereiken.</p></li></ul></div><div class=paragraph><p>Het is altijd mogelijk om de systeembronnen en de beveiligingsinstellingen te veranderen en te herconfigureren, het komt vaak erg ongelegen om het systeem te doorzoeken en bestaande bestanden en gebruikersaccounts te repareren. Plannen helpt om zeker te zijn van een probleemloze en efficiënte systeemimplementatie. Het is vaak vitaal en zeker in uw voordeel om een proefronde van het vertrouwde systeem, inclusief de configuratie, te draaien <em>vóórdat</em> een MAC-implementatie wordt gebruikt op productiesystemen. Het idee om een systeem met MAC gewoon los te laten is als het plannen van mislukkingen.</p></div><div class=paragraph><p>Verschillende omgevingen kunnen verschillende behoeften en benodigdheden nodig hebben. Het opzetten van een diepgaand en compleet beveiligingsprofiel zal de noodzaak van verandering verminderen wanneer het systeem in gebruik wordt genomen. Zodoende zullen de toekomstige secties de verschillende modules die beschikbaar zijn voor beheerders behandelen; hun gebruik en configuratie beschrijven; en in sommige gevallen inzicht bieden in welke situaties ze het beste tot hun recht komen. Een webserver bijvoorbeeld zou de beleiden <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> in gebruik nemen. In andere gevallen kan voor een machine met erg weinig lokale gebruikers <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_partition&amp;sektion=4&amp;format=html">mac_partition(4)</a> een goede keuze zijn.</p></div></div><div class=sect2><h3 id=mac-modules>17.6. Module-instellingen<a class=anchor href=#mac-modules></a></h3><div class=paragraph><p>Iedere module uit het MAC-raamwerk kan zoals zojuist aangegeven in de kernel worden gecompileerd of als runtime-kernelmodule geladen worden. De geadviseerde methode is de naam van een module toevoegen aan het bestand <span class=filename>/boot/loader.conf</span> zodat die wordt geladen tijdens de eerste fase van het starten van een systeem.</p></div><div class=paragraph><p>In de volgende onderdelen worden de verschillende MAC-modules en hun mogelijkheden beschreven. De implementatie in een specifieke omgeving wordt ook in dit hoofdstuk beschreven. Een aantal modules ondersteunt het gebruik van labelen, wat het beperken van toegang is door een label als "dit is toegestaan en dat niet" af te dwingen. Een labelinstellingenbestand kan bepalen hoe bestanden kunnen worden benaderd, hoe netwerkcommunicatie wordt uitgewisseld, en meer. In het vorige onderdeel is beschreven hoe de vlag <code>multilabel</code> ingesteld kon worden op bestandssystemen om per bestand of per partitie toegangscontrole in te schakelen.</p></div><div class=paragraph><p>Een instelling met een enkelvoudig label zou maar één label over een heel systeem afdwingen, daarom wordt de optie <code>tunefs multilabel</code> genoemd.</p></div></div><div class=sect2><h3 id=mac-seeotheruids>17.7. MAC-module seeotheruids<a class=anchor href=#mac-seeotheruids></a></h3><div class=paragraph><p>Modulenaam: <span class=filename>mac_seeotheruids.ko</span></p></div><div class=paragraph><p>Kernelinstelling: <code>options MAC_SEEOTHERUIDS</code></p></div><div class=paragraph><p>Opstartoptie: <code>mac_seeotheruids_load="YES"</code></p></div><div class=paragraph><p>De module <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_seeotheruids&amp;sektion=4&amp;format=html">mac_seeotheruids(4)</a> imiteert de <code>sysctl</code>-tunables <code>security.bsd.see_other_uids</code> en <code>security.bsd.see_other_gids</code> en breidt deze uit. Voor deze optie hoeven geen labels ingesteld te worden voor de instelling en hij werkt transparant met de andere modules.</p></div><div class=paragraph><p>Na het laden van de module kunnen de volgende <code>sysctl</code>-tunables gebruikt worden om de opties te beheren:</p></div><div class=ulist><ul><li><p><code>security.mac.seeotheruids.enabled</code> schakelt de opties van de module in en gebruikt de standaardinstellingen. Deze standaardinstellingen ontzeggen gebruikt de mogelijkheid processen en sockets te zien die eigendom zijn van andere gebruikers.</p></li><li><p><code>security.mac.seeotheruids.specificgid_enabled</code> staat toe dat een bepaalde groep niet onder dit beleid valt. Om bepaalde groepen van dit beleid uit te sluiten, kan de <code>sysctl</code>-tunable <code>security.mac.seeotheruids.specificgid=XXX</code> gebruikt worden. In het bovenstaande voorbeeld dient <em>XXX</em> vervangen te worden door het numerieke ID van een groep die uitgesloten moet worden van de beleidsinstelling.</p></li><li><p><code>security.mac.seeotheruids.primarygroup_enabled</code> wordt gebruikt om specifieke primaire groepen uit te sluiten van dit beleid. Als deze tunable wordt gebruikt, mag <code>security.mac.seeotheruids.specificgid_enabled</code> niet gebruikt worden.</p></li></ul></div></div><div class=sect2><h3 id=mac-bsdextended>17.8. MAC-module bsdextended<a class=anchor href=#mac-bsdextended></a></h3><div class=paragraph><p>Modulenaam: <span class=filename>mac_bsdextended.ko</span></p></div><div class=paragraph><p>Kernelinstelling: <code>options MAC_BSDEXTENDED</code></p></div><div class=paragraph><p>Opstartoptie: <code>mac_bsdextended_load="YES"</code></p></div><div class=paragraph><p>De module <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> dwingt de bestandssysteemfirewall af. Het beleid van deze module biedt een uitbreiding van het standaard rechtenmodel voor bestandssystemen, waardoor een beheerder een firewallachtige verzameling met regels kan maken om bestanden, programma’s en mappen in de bestandssysteemhiërarchie te beschermen. Wanneer geprobeerd wordt om toegang tot een object in het bestandssysteem te krijgen, wordt de lijst met regels afgelopen totdat er òf een overeenkomstige regel is gevonden òf het einde van de lijst is bereikt. Dit gedrag kan veranderd worden door het gebruik van de <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>-parameter security.mac.bsdextended.firstmatch_enabled. Net zoals andere firewall-modules in FreeBSD kan een bestand dat regels voor toegangscontrole bevat tijdens het opstarten door het systeem worden aangemaakt en gelezen door een <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a>-variabele te gebruiken.</p></div><div class=paragraph><p>De lijst met regels kan ingevoerd worden met het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ugidfw&amp;sektion=8&amp;format=html">ugidfw(8)</a>, dat een syntaxis heeft die lijkt op die van <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a>. Meer hulpprogramma’s kunnen geschreven worden met de functies in de bibliotheek <a href="https://man.freebsd.org/cgi/man.cgi?query=libugidfw&amp;sektion=3&amp;format=html">libugidfw(3)</a>.</p></div><div class=paragraph><p>Bij het werken met deze module dient bijzondere voorzichtigheid in acht te worden genomen. Verkeerd gebruik kan toegang tot bepaalde delen van het bestandssysteem blokkeren.</p></div><div class=sect3><h4 id=_voorbeelden>17.8.1. Voorbeelden<a class=anchor href=#_voorbeelden></a></h4><div class=paragraph><p>Nadat de module <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> is geladen, kan met het volgende commando de huidige regels getoond worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ugidfw list</span>
0 slots, 0 rules</code></pre></div></div><div class=paragraph><p>Zoals verwacht zijn er geen regels ingesteld. Dit betekent dat alles nog steeds volledig toegankelijk is. Om een regel te maken die alle toegang voor alle gebruikers behalve <code>root</code> ontzegt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ugidfw add subject not uid root new object not uid root mode n</span></code></pre></div></div><div class=paragraph><p>Dit is een slecht idee, omdat het voorkomt dat alle gebruikers ook maar het meest eenvoudige commando kunnen uitvoeren, zoals <code>ls</code>. Een betere lijst met regels zou kunnen zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ugidfw set 2 subject uid gebruiker1 object uid gebruiker2 mode n</span>
<span class=c># ugidfw set 3 subject uid gebruiker1 object gid gebruiker2 mode n</span></code></pre></div></div><div class=paragraph><p>Hiermee wordt alle toegang, inclusief het tonen van mapinhoud, tot de thuismap van <code><em>gebruiker2</em></code> ontzegd voor de gebruikersnaam <code>gebruiker1</code>.</p></div><div class=paragraph><p>In plaats van <code>gebruiker1</code>, zou <code>not uid <em>gebruiker2</em></code> kunnen worden opgegeven. Hierdoor worden dezelfde restricties als hierboven actief voor alle gebruikers in plaats van voor slechts één gebruiker.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De gebruiker <code>root</code> blijft onaangetast door deze wijzigingen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Met deze informatie zou een basisbegrip moeten zijn ontstaan over hoe de module <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> gebruikt kan worden om een bestandssysteem te beschermen. Meer informatie staat in de hulppagina’s van <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=ugidfw&amp;sektion=8&amp;format=html">ugidfw(8)</a>.</p></div></div></div><div class=sect2><h3 id=mac-ifoff>17.9. MAC-module ifoff<a class=anchor href=#mac-ifoff></a></h3><div class=paragraph><p>Modulenaam: <span class=filename>mac_ifoff.ko</span></p></div><div class=paragraph><p>Kernelinstelling: <code>options MAC_IFOFF</code></p></div><div class=paragraph><p>Opstartoptie: <code>mac_ifoff_load="YES"</code></p></div><div class=paragraph><p>De module <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ifoff&amp;sektion=4&amp;format=html">mac_ifoff(4)</a> bestaat alleen om netwerkinterfaces tijdens het draaien uit te schakelen en om te verhinderen dat netwerkinterfaces tijdens het initiële opstarten worden geactiveerd. Er hoeven geen labels ingesteld te worden, noch is deze module afhankelijk van andere MAC-modules.</p></div><div class=paragraph><p>Het meeste beheer wordt gedaan met de <code>sysctl</code>-tunables die hieronder zijn vermeld.</p></div><div class=ulist><ul><li><p><code>security.mac.ifoff.lo_enabled</code> schakelt alle verkeer op het teruglusinterface (<a href="https://man.freebsd.org/cgi/man.cgi?query=lo&amp;sektion=4&amp;format=html">lo(4)</a>) in of uit.</p></li><li><p><code>security.mac.ifoff.bpfrecv_enabled</code> schakelt alle verkeer op het Berkeley Packet Filterinterface (<a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a>) in of uit.</p></li><li><p><code>security.mac.ifoff.other_enabled</code> schakelt alle verkeer op alle andere interfaces in of uit.</p></li></ul></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ifoff&amp;sektion=4&amp;format=html">mac_ifoff(4)</a> wordt het meest gebruikt om netwerken te monitoren in een omgeving waar netwerkverkeer niet toegestaan zou moeten zijn tijdens het opstarten. Een ander voorgesteld gebruik zou het schrijven van een script zijn dat <a class=package href=https://cgit.freebsd.org/ports/tree/security/aide/>security/aide</a> gebruikt om automatisch netwerkverkeer te blokkeren wanneer het nieuwe of veranderde bestanden in beschermde mappen vindt.</p></div></div><div class=sect2><h3 id=mac-portacl>17.10. MAC-module portacl<a class=anchor href=#mac-portacl></a></h3><div class=paragraph><p>Modulenaam: <span class=filename>mac_portacl.ko</span></p></div><div class=paragraph><p>Kernelinstelling: <code>MAC_PORTACL</code></p></div><div class=paragraph><p>Opstartoptie: <code>mac_portacl_load="YES"</code></p></div><div class=paragraph><p>De module <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> wordt gebruikt om het binden aan lokale TCP- en UDP-poorten te begrenzen door een waaier aan <code>sysctl</code>-variabelen te gebruiken. In essentie maakt <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> het mogelijk om niet-<code>root</code>-gebruikers in staat te stellen om aan gespecificeerde geprivilegieerde poorten te binden, dus poorten lager dan 1024.</p></div><div class=paragraph><p>Eenmaal geladen zal deze module het MAC-beleid op alle sockets aanzetten. De volgende tunables zijn beschikbaar:</p></div><div class=ulist><ul><li><p><code>security.mac.portacl.enabled</code> schakelt het beleid volledig in of uit.</p></li><li><p><code>security.mac.portacl.port_high</code> stelt het hoogste poortnummer in waarvoor <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> bescherming biedt.</p></li><li><p><code>security.mac.portacl.suser_exempt</code> sluit de gebruiker <code>root</code> uit van dit beleid wanneer het op een waarde anders dan nul wordt ingesteld.</p></li><li><p><code>security.mac.portacl.rules</code> specificeert het eigenlijke beleid van mac_portacl; zie onder.</p></li></ul></div><div class=paragraph><p>Het eigenlijke beleid van <code>mac_portacl</code>, zoals gespecificeerd in de sysctl <code>security.mac.portacl.rules</code>, is een tekststring van de vorm: <code>regel[,regel,…​]</code> met zoveel regels als nodig. Elke regel heeft de vorm: <code>idtype:id:protocol:poort</code>. De parameter <span class=parameter>idtype</span> kan <code>uid</code> of <code>gid</code> zijn en wordt gebruikt om de parameter <span class=parameter>id</span> als respectievelijk een gebruikers-id of groeps-id te interpreteren. De parameter <span class=parameter>protocol</span> wordt gebruikt om te bepalen of de regel op TCP of UDP moet worden toegepast door de parameter op <code>tcp</code> of <code>udp</code> in te stellen. De laatste parameter <span class=parameter>poort</span> is het poortnummer waaraan de gespecificeerde gebruiker of groep zich mag binden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Aangezien de regelverzameling direct door de kernel wordt geïnterpreteerd kunnen alleen numerieke waarden voor de parameters voor de gebruikers-ID, groeps-ID, en de poort gebruikt worden. Voor gebruikers, groepen, en poortdiensten kunnen dus geen namen gebruikt worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Standaard kunnen op UNIX®-achtige systemen poorten lager dan 1024 alleen aan geprivilegieerde processen gebonden worden, dus diegenen die als <code>root</code> draaien. Om <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> toe te laten staan om ongeprivilegieerde processen aan poorten lager dan 1024 te laten binden moet deze standaard UNIX®-beperking uitgezet worden. Dit kan bereikt worden door de <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>-variabelen <code>net.inet.ip.portange.reservedlow</code> en <code>net.inet.ip.portrange.reservedhigh</code> op nul te zetten.</p></div><div class=paragraph><p>Zie de onderstaande voorbeelden of bekijk de handleidingpagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> voor meer informatie.</p></div><div class=sect3><h4 id=_voorbeelden_2>17.10.1. Voorbeelden<a class=anchor href=#_voorbeelden_2></a></h4><div class=paragraph><p>De volgende voorbeelden zouden de bovenstaande discussie wat moeten toelichten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl security.mac.portacl.port_high=1023</span>
<span class=c># sysctl net.inet.ip.portrange.reservedlow=0 net.inet.ip.portrange.reservedhigh=0</span></code></pre></div></div><div class=paragraph><p>Eerst wordt <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> ingesteld om de standaard geprivilegieerde poorten te dekken en worden de normale bindbeperkingen van UNIX® uitgeschakeld.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl security.mac.portacl.suser_exempt=1</span></code></pre></div></div><div class=paragraph><p>De gebruiker <code>root</code> zou niet beperkt moeten worden door dit beleid, stel <code>security.mac.portacl.suser_exempt</code> dus in op een waarde anders dan nul. De module <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> is nu ingesteld om zich op de zelfde manier te gedragen als UNIX®-achtige systemen zich standaard gedragen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl security.mac.portacl.rules=uid:80:tcp:80</span></code></pre></div></div><div class=paragraph><p>Sta de gebruiker met UID 80 (normaliter de gebruiker <code>www</code>) toe om zich aan poort 80 te binden. Dit kan gebruikt worden om de gebruiker <code>www</code> toe te staan een webserver te draaien zonder ooit <code>root</code>-rechten te hebben.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl security.mac.portacl.rules=uid:1001:tcp:110,uid:1001:tcp:995</span></code></pre></div></div><div class=paragraph><p>Sta de gebruiker met UID 1001 om zich aan de TCP-poorten 110 ("pop3") en 995 ("pop3s") te binden. Dit staat deze gebruiker toe om een server te starten die verbindingen accepteert op poorten 110 en 995.</p></div></div></div><div class=sect2><h3 id=mac-partition>17.11. MAC-module partition<a class=anchor href=#mac-partition></a></h3><div class=paragraph><p>Modulenaam: <span class=filename>mac_partition.ko</span></p></div><div class=paragraph><p>Kernelinstelling: <code>options MAC_PARTITION</code></p></div><div class=paragraph><p>Opstartoptie: <code>mac_partition_load="YES"</code></p></div><div class=paragraph><p>Het beleid <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_partition&amp;sektion=4&amp;format=html">mac_partition(4)</a> plaatst processen in specifieke "partities" gebaseerd op hun MAC-label. Zie dit als een speciaal soort <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a>, hoewel dit nauwelijks een waardige vergelijking is.</p></div><div class=paragraph><p>Dit is één module die aan het bestand <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> dient te worden toegevoegd zodat het het beleid tijdens het opstartproces laadt en aanzet.</p></div><div class=paragraph><p>De meeste configuratie van dit beleid wordt gedaan met het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=setpmac&amp;sektion=8&amp;format=html">setpmac(8)</a>, wat hieronder zal worden uitgelegd. De volgende <code>sysctl</code>-tunable is beschikbaar voor dit beleid:</p></div><div class=ulist><ul><li><p><code>security.mac.partition.enabled</code> zet het afdwingen van MAC-procespartities aan.</p></li></ul></div><div class=paragraph><p>Wanneer dit beleid aanstaat, mogen gebruikers alleen hun eigen processen zien, en elke andere in hun partitie, maar mogen niet met gereedschappen buiten deze partitie werken. Bijvoorbeeld, een gebruiker in de klasse <code>insecure</code> heeft geen toegang tot het commando <code>top</code> noch tot vele andere commando’s die een proces moeten draaien.</p></div><div class=paragraph><p>Gebruik het gereedschap <code>setpmac</code> om gereedschappen in te stellen of ze in een partitielabel te plaatsen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setpmac partition/13 top</span></code></pre></div></div><div class=paragraph><p>Dit zal het commando <code>top</code> toevoegen aan het label dat voor gebruikers in de klasse <code>insecure</code> gebruikt wordt. Merk op dat alle processen gestart door gebruikers in de klasse <code>insecure</code> in het label <code>partition/13</code> zullen blijven.</p></div><div class=sect3><h4 id=_voorbeelden_3>17.11.1. Voorbeelden<a class=anchor href=#_voorbeelden_3></a></h4><div class=paragraph><p>Het volgende commando laat de partitielabel en de proceslijst zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ps Zax</span></code></pre></div></div><div class=paragraph><p>Het volgende commando staat toe om het procespartitielabel van een andere gebruiker en de momenteel draaiende processen van die gebruiker te zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ps -ZU trhodes</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Gebruikers kunnen processen in het label van <code>root</code> zien tenzij het beleid <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_seeotheruids&amp;sektion=4&amp;format=html">mac_seeotheruids(4)</a> is geladen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Een echte vakmansimplementatie zou alle diensten in <span class=filename>/etc/rc.conf</span> uitzetten en deze door een script met de juiste labeling laten starten.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De volgende beleiden ondersteunen integerinstellingen in plaats van de drie standaardlabels die aangeboden worden. Deze opties, inclusief hun beperkingen, worden verder uitgelegd in de handleidingpagina’s van de modules.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=mac-mls>17.12. MAC-module Multi-Level Security<a class=anchor href=#mac-mls></a></h3><div class=paragraph><p>Modulenaam: <span class=filename>mac_mls.ko</span></p></div><div class=paragraph><p>Kernelinstelling: <code>options MAC_MLS</code></p></div><div class=paragraph><p>Opstartoptie: <code>mac_mls_load="YES"</code></p></div><div class=paragraph><p>Het beleid <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_mls&amp;sektion=4&amp;format=html">mac_mls(4)</a> beheert toegang tussen subjecten en objecten in het systeem door een strikt beleid voor informatiestromen af te dwingen.</p></div><div class=paragraph><p>In MLS-omgevingen wordt een "toestemming"-niveau ingesteld in het label van elk subject of object, samen met compartimenten. Aangezien deze toestemmings- of zinnigheidsniveaus getallen groter dan zesduizend kunnen bereiken; zou het voor elke systeembeheerder een afschrikwekkende taak zijn om elk subject of object grondig te configureren. Gelukkig worden er al drie "kant-en-klare" bij dit beleid geleverd.</p></div><div class=paragraph><p>Deze labels zijn <code>mls/low</code>, <code>mls/equal</code> en <code>mls/high</code>. Aangezien deze labels uitgebreid in de handleidingpagina worden beschreven, worden ze hier slechts kort beschreven:</p></div><div class=ulist><ul><li><p>Het label <code>mls/low</code> bevat een lage configuratie welke het toestaat om door alle andere objecten te worden gedomineerd. Alles dat met <code>mls/low</code> is gelabeld heeft een laag toestemmingsniveau en heeft geen toegang tot informatie van een hoger niveau. Ook voorkomt dit label dat objecten van een hoger toestemmingsniveau informatie naar hen schrijven of aan hen doorgeven.</p></li><li><p>Het label <code>mls/equal</code> dient geplaatst te worden op objecten die geacht te zijn uitgesloten van het beleid.</p></li><li><p>Het label <code>mls/high</code> is het hoogst mogelijke toestemmingsniveau. Objecten waaraan dit label is toegekend zijn dominant over alle andere objecten in het systeem; ze mogen echter geen informatie lekken naar objecten van een lagere klasse.</p></li></ul></div><div class=paragraph><p>MLS biedt:</p></div><div class=ulist><ul><li><p>Een hiërarchisch beveiligingsniveau met een verzameling niet-hiërarchische categoriën;</p></li><li><p>Vaste regels: niet naar boven lezen, niet naar beneden schrijven (een subject kan leestoegang hebben naar objecten op zijn eigen niveau of daaronder, maar niet daarboven. Evenzo kan een subject schrijftoegang hebben naar objecten op zijn eigen niveau of daarboven maar niet daaronder.);</p></li><li><p>Geheimhouding (voorkomt ongeschikte openbaarmaking van gegevens);</p></li><li><p>Een basis voor het ontwerp van systemen die gelijktijdig gegevens op verschillende gevoeligheidsniveaus behandelen (zonder informatie tussen geheim en vertrouwelijk te lekken).</p></li></ul></div><div class=paragraph><p>De volgende <code>sysctl</code>-tunables zijn beschikbaar voor de configuratie van speciale diensten en interfaces:</p></div><div class=ulist><ul><li><p><code>security.mac.mls.enabled</code> wordt gebruikt om het MLS-beleid in en uit te schakelen.</p></li><li><p><code>security.mac.mls.ptys_equal</code> labelt alle <a href="https://man.freebsd.org/cgi/man.cgi?query=pty&amp;sektion=4&amp;format=html">pty(4)</a>-apparaten als <code>mls/equal</code> wanneer ze worden aangemaakt.</p></li><li><p><code>security.mac.mls.revocation_enabled</code> wordt gebruikt om toegang tot objecten in te trekken nadat hun label in die van een lagere graad verandert.</p></li><li><p><code>security.mac.mls.max_compartments</code> wordt gebruikt om het maximaal aantal compartimentniveaus met objecten in te stellen; in feite het maximale compartimentnummer dat op een systeem is toegestaan.</p></li></ul></div><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=setfmac&amp;sektion=8&amp;format=html">setfmac(8)</a> kan gebruikt worden om de MLS-labels te manipuleren. Gebruik het volgende commando om een label aan een object toe te kennen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfmac mls/5 test</span></code></pre></div></div><div class=paragraph><p>Gebruik het volgende commando om het MLS-label voor het bestand <span class=filename>test</span> te verkrijgen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># getfmac test</span></code></pre></div></div><div class=paragraph><p>Dit is een samenvatting van de mogelijkheden van het beleid MLS. Een andere manier is om een meesterbeleidsbestand in <span class=filename>/etc</span> aan te maken dat de MLS-informatie bevat en om dat bestand aan het commando <code>setfmac</code> te geven. Deze methode wordt uitgelegd nadat alle beleiden zijn behandeld.</p></div><div class=sect3><h4 id=_verplichte_gevoeligheid_plannen>17.12.1. Verplichte Gevoeligheid plannen<a class=anchor href=#_verplichte_gevoeligheid_plannen></a></h4><div class=paragraph><p>Met de beleidsmodule voor meerlaagse beveiliging plant een beheerder het beheren van gevoelige informatiestromen. Standaard zet het systeem met zijn natuur van lezen naar boven blokkeren en schrijven naar beneden blokkeren alles in een lage toestand. Alles is beschikbaar en een beheerder verandert dit langzaam tijdens de configuratiefase; waarbij de vertrouwelijkheid van de informatie toeneemt.</p></div><div class=paragraph><p>Buiten de bovengenoemde drie basisopties voor labels, kan een beheerder gebruikers en groepen indelen als nodig om de informatiestroom tussen hun te blokkeren. Het is misschien gemakkelijker om naar de informatie te kijken in toestemmingsniveaus waarvoor bekende woorden bestaan, zoals <code>Vertrouwelijk</code>, <code>Geheim</code> en <code>Strikt Geheim</code>. Sommige beheerders zullen verschillende groepen aanmaken gebaseerd op verschillende projecten. Ongeacht de classificatiemethode moet er een goed overwogen plan bestaan voordat zo’n berperkend beleid wordt geïmplementeerd.</p></div><div class=paragraph><p>Wat voorbeeldsituaties voor deze beveiligingsbeleidsmodule kunnen een e-commerce webserver, een bestandsserver die kritieke bedrijfsinformatie, en omgevingen van financiële instellingen zijn. De meest onwaarschijnlijke plaats zou een persoonlijk werkstation met slechts twee of drie gebruikers zijn.</p></div></div></div><div class=sect2><h3 id=mac-biba>17.13. MAC-module Biba<a class=anchor href=#mac-biba></a></h3><div class=paragraph><p>Modulenaam: <span class=filename>mac_biba.ko</span></p></div><div class=paragraph><p>Kernelinstelling: <code>options MAC_BIBA</code></p></div><div class=paragraph><p>Opstartoptie: <code>mac_biba_load="YES"</code></p></div><div class=paragraph><p>De module <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> laadt het beleid MAC Biba. Dit beleid werkt vaak zoals dat van MLS behalve dat de regels voor de informatiestroom lichtelijk zijn omgedraaid. Dit is gezegd om de neerwaartse stroom van gevoelige informatie te voorkomen terwijl het beleid MLS de opwaartse stroom van gevoelige informatie voorkomt; veel van deze sectie is dus op beide beleiden toepasbaar.</p></div><div class=paragraph><p>In Biba-omgevingen wordt een "integriteits"-label op elk subject of object ingesteld. Deze labels bestaan uit hiërarchische graden, en niet-hiërarchische componenten. Een graad van een object of subject stijgt samen met de integriteit.</p></div><div class=paragraph><p>Ondersteunde labels zijn <code>biba/low</code>, <code>biba/equal</code>, en <code>biba/high</code>; zoals hieronder uitgelegd:</p></div><div class=ulist><ul><li><p>Het label <code>biba/low</code> wordt gezien als de laagste integriteit die een object of subject kan hebben. Dit instellen op objecten of subjecten zal hun schrijftoegang tot objecten of subjecten die als hoog zijn gemarkeerd blokkeren. Ze hebben echter nog steeds leestoegang.</p></li><li><p>Het label <code>biba/equal</code> dient alleen geplaatst te worden op objecten die geacht te zijn uitgesloten van het beleid.</p></li><li><p>Het label <code>biba/high</code> staat schrijven naar objecten met een lager label toe maar sluit het lezen van dat object uit. Het wordt aangeraden om dit label te plaatsen op objecten die de integriteit van het gehele systeem beïnvloeden.</p></li></ul></div><div class=paragraph><p>Biba biedt:</p></div><div class=ulist><ul><li><p>Hiërarchische integriteitsniveaus met een verzameling niet-hiërarchische integriteitscategoriën;</p></li><li><p>Vaste regels: niet naar boven schrijven, niet naar beneden lezen (tegenovergestelde van MLS). Een subject kan schrijftoegang hebben naar objecten op hetzelfde niveau of daaronder, maar niet daarboven. Evenzo kan een subject leestoegang naar objecten op hetzelfde niveau of daarboven hebben, maar niet daaronder;</p></li><li><p>Integriteit (voorkomt oneigenlijk wijzigen van gegevens);</p></li><li><p>Integriteitsniveaus (in plaats van de gevoeligheidsniveaus van MLS)</p></li></ul></div><div class=paragraph><p>De volgende <code>sysctl</code>-tunables kunnen gebruikt worden om het Biba-beleid te manipuleren.</p></div><div class=ulist><ul><li><p><code>security.mac.biba.enabled</code> kan gebruikt worden om het afdwingen van het Biba-beleid op de doelmachine aan en uit te zetten.</p></li><li><p><code>security.mac.biba.ptys_equal</code> kan gebruikt worden om het Biba-beleid op <a href="https://man.freebsd.org/cgi/man.cgi?query=pty&amp;sektion=4&amp;format=html">pty(4)</a>-apparaten uit te zetten.</p></li><li><p><code>security.mac.biba.revocation_enabled</code> dwingt het herroepen van toegang tot objecten af als het label is veranderd om het subject te domineren.</p></li></ul></div><div class=paragraph><p>Gebruik de commando’s <code>setfmac</code> en <code>getfmac</code> om de instellingen van het Biba-beleid op systeemobjecten te benaderen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfmac biba/low test</span>
<span class=c># getfmac test</span>
<span class=nb>test</span>: biba/low</code></pre></div></div><div class=sect3><h4 id=_verplichte_integriteit_plannen>17.13.1. Verplichte Integriteit plannen<a class=anchor href=#_verplichte_integriteit_plannen></a></h4><div class=paragraph><p>Integriteit, anders dan gevoeligheid, garandeert dat de informatie nooit door onvertrouwde gebruikers zal worden gemanipuleerd. Dit geldt ook voor informatie die tussen subjecten, objecten, of beiden wordt doorgegeven. Het verzekert dat gebruikers alleen de informatie kunnen wijzigen en in sommige gevallen zelfs benaderen die ze expliciet nodig hebben.</p></div><div class=paragraph><p>De beveiligingsbeleidsmodule <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> staat een beheerder in staat om te bepalen welke bestanden en programma’s een gebruiker of gebruikers mogen zien en draaien terwijl het verzekert dat de programma’s en bestanden vrij zijn van dreigingen en vertrouwt zijn door het systeem voor die gebruiker of groep van gebruikers.</p></div><div class=paragraph><p>Tijdens de initiële planningsfase moet een beheerder bereid zijn om gebruikers in gradaties, niveaus, en gebieden in te delen. Gebruikers zal toegang tot niet alleen gegevens maar ook tot programma’s en hulpmiddelen ontzegt worden zowel voordat en nadat ze beginnen. Het systeem zal standaard een hoog label instellen nadat deze beleidsmodule is ingeschakeld, en het is aan de beheerder om de verschillende gradaties en niveaus voor gebruikers in te stellen. In plaats van toestemmingsniveaus zoals boven beschreven te gebruiken, kan een goede planningsmethode onderwerpen bevatten. Bijvoorbeeld, geef alleen ontwikkelaars veranderingstoegang tot het broncoderepository, de broncodecompiler, en andere ontwikkelgereedschappen. Andere gebruikers zouden in andere groepen zoals testers, ontwerpers, of gewone gebruikers worden ingedeeld en zouden alleen leestoegang hebben.</p></div><div class=paragraph><p>Met zijn natuurlijke beveiligingsbeheer kan een subject van lagere integriteit niet schijven naar een subject van hogere integriteit; een subject van hogere integriteit kan geen subject van lagere integriteit observeren of lezen. Een label op de laagst mogelijke graad instellen kan het ontoegankelijk voor subjecten maken. Sommige succesvolle omgevingen voor deze beveiligingsbeheermodule zijn een beperkte webserver, een ontwikkel- en testmachine, en broncoderepositories. Minder nuttige implementaties zouden een persoonlijk werkstation, een machine gebruikt als router, of een netwerkfirewall zijn.</p></div></div></div><div class=sect2><h3 id=mac-lomac>17.14. MAC-module LOMAC<a class=anchor href=#mac-lomac></a></h3><div class=paragraph><p>Modulenaam: <span class=filename>mac_lomac.ko</span></p></div><div class=paragraph><p>Kernelinstelling: <code>options MAC_LOMAC</code></p></div><div class=paragraph><p>Opstartoptie: <code>mac_lomac_load="YES"</code></p></div><div class=paragraph><p>In tegenstelling tot het beleid MAC Biba, staat het beleid <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_lomac&amp;sektion=4&amp;format=html">mac_lomac(4)</a> toegang tot objecten van lagere integriteit slechts toe nadat het integriteitsniveau is verlaagt om de integriteitsregels niet te verstoren.</p></div><div class=paragraph><p>De MAC-versie van het laagwatermarkeringsintegreitsbeleid, niet te verwarren met de oudere implementatie van <a href="https://man.freebsd.org/cgi/man.cgi?query=lomac&amp;sektion=4&amp;format=html">lomac(4)</a>, werkt bijna hetzelfde als Biba maar met de uitzondering dat er drijvende labels worden gebruikt om subjectdegradatie via een hulpcompartiment met graden te ondersteunen. Dit tweede compartiment heeft de vorm <code>[hulpgraad]</code>. Wanneer een lomac-beleid met een hulpgraad wordt toegekend, dient het er ongeveer uit te zien als: <code>lomac/10[2]</code> waar het getal twee (2) de hulpgraad is.</p></div><div class=paragraph><p>Het beleid MAC LOMAC berust op het overal labelen van alle systeemobjecten met integriteitslabels, waardoor subjecten wordt toegestaan om te lezen van objecten van lage integriteit en om daarna het label op subject te degraderen om toekomstig schrijven naar objecten van hoge integriteit te voorkomen. Dit is de hierboven besproken optie <code>[hulpgraad]</code>, dus biedt het beleid grotere compatibiliteit en vereist het minder initiële configuratie dan Biba.</p></div><div class=sect3><h4 id=_voorbeelden_4>17.14.1. Voorbeelden<a class=anchor href=#_voorbeelden_4></a></h4><div class=paragraph><p>Net zoals bij de beleiden Biba en MLS kunnen de commando’s <code>setfmac</code> en <code>setpmac</code> gebruikt worden om labels op systeemobjecten te plaatsen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfmac /usr/home/trhodes lomac/high[low]</span>
<span class=c># getfmac /usr/home/trhodes lomac/high[low]</span></code></pre></div></div><div class=paragraph><p>Merk op dat de hulpgraad hier <code>low</code> is, dit is een mogelijkheid die alleen door het beleid MAC LOMAC wordt geboden.</p></div></div></div><div class=sect2><h3 id=mac-implementing>17.15. Nagios in een MAC-jail<a class=anchor href=#mac-implementing></a></h3><div class=paragraph><p>De volgende demonstratie zal een veilige omgeving implementeren door verschillende MAC-modules te gebruiken met juist ingestelde beleiden. Dit is slechts een test en dient niet gezien te worden als het volledige antwoord op de beveiligingszorgen van iedereen. Gewoon een beleid implementeren en het verder negeren werkt nooit en kan rampzalig zijn in een productieomgeving.</p></div><div class=paragraph><p>Voordat met dit proces wordt begonnen, moet de optie <code>multilabel</code> zijn geactiveerd op elk bestandssysteem zoals vermeld aan het begin van dit hoofdstuk. Nalatigheid zal in fouten resulteren. Zorg er ook voor dat de ports <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/nagios-plugins/>net-mgmt/nagios-plugins</a>, <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/nagios/>net-mgmt/nagios</a>, en <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache22/>www/apache22</a> allemaal geïnstalleerde en geconfigureerd zijn en correct werken.</p></div><div class=sect3><h4 id=_gebruikersklasse_insecure_maken>17.15.1. Gebruikersklasse <code>insecure</code> maken<a class=anchor href=#_gebruikersklasse_insecure_maken></a></h4><div class=paragraph><p>Begin de procedure door de volgende gebruikersklasse toe te voegen aan het bestand <span class=filename>/etc/login.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>insecure:\
        :copyright=/etc/COPYRIGHT:\
        :welcome=/etc/motd:\
        :setenv=MAIL=/var/mail/$,BLOCKSIZE=K:\
        :path=~/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin
        :manpath=/usr/shared/man /usr/local/man:\
        :nologin=/usr/sbin/nologin:\
        :cputime=1h30m:\
        :datasize=8M:\
        :vmemoryuse=100M:\
        :stacksize=2M:\
        :memorylocked=4M:\
        :memoryuse=8M:\
        :filesize=8M:\
        :coredumpsize=8M:\
        :openfiles=24:\
        :maxproc=32:\
        :priority=0:\
        :requirehome:\
        :passwordtime=91d:\
        :umask=022:\
        :ignoretime@:\
        :label=biba/10(10-10):</pre></div></div><div class=paragraph><p>Voeg de volgende regel toe aan de standaard gebruikersklasse:</p></div><div class="literalblock programlisting"><div class=content><pre>:label=biba/high:</pre></div></div><div class=paragraph><p>Wanneer dit voltooid is, moet het volgende commando gedraaid worden om de database te herbouwen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div></div><div class=sect3><h4 id=_opstartinstellingen>17.15.2. Opstartinstellingen<a class=anchor href=#_opstartinstellingen></a></h4><div class=paragraph><p>Start nog niet opnieuw op, voeg alleen de volgende regels toe aan <span class=filename>/boot/loader.conf</span> zodat de benodigde modules worden geladen tijdens systeeminitialisatie:</p></div><div class="literalblock programlisting"><div class=content><pre>mac_biba_load=&#34;YES&#34;
mac_seeotheruids_load=&#34;YES&#34;</pre></div></div></div><div class=sect3><h4 id=_gebruikers_instellen>17.15.3. Gebruikers instellen<a class=anchor href=#_gebruikers_instellen></a></h4><div class=paragraph><p>Stel de gebruiker <code>root</code> in op de standaardklasse met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw usermod root -L default</span></code></pre></div></div><div class=paragraph><p>Alle gebruikersaccounts die geen <code>root</code> of systeemgebruikers zijn hebben nu een aanmeldklasse nodig. De aanmeldklasse is nodig om te voorkomen dat gebruikers geen toegang hebben tot gewone commando’s als <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a>. Het volgende <code>sh</code>-script zou moeten werken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># for x in `awk -F: &#39;($3 &gt;= 1001) &amp;&amp; ($3 != 65534) { print $1 }&#39; \</span>
	/etc/passwd<span class=sb>`</span><span class=p>;</span> <span class=k>do </span>pw usermod <span class=nv>$x</span> <span class=nt>-L</span> default<span class=p>;</span> <span class=k>done</span><span class=p>;</span></code></pre></div></div><div class=paragraph><p>Laat de gebruikers <code>nagios</code> en <code>www</code> in de klasse insecure vallen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw usermod nagios -L insecure</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw usermod www -L insecure</span></code></pre></div></div></div><div class=sect3><h4 id=_het_contextbestand_aanmaken>17.15.4. Het contextbestand aanmaken<a class=anchor href=#_het_contextbestand_aanmaken></a></h4><div class=paragraph><p>Nu dient een contextbestand aangemaakt te worden; het volgende voorbeeld dient geplaatst te worden in <span class=filename>/etc/policy.contexts</span>.</p></div><div class="literalblock programlisting"><div class=content><pre># Dit is het standaard-BIBA-beleid voor dit systeem.
# Systeem:
/var/run                        biba/equal
/var/run/*                      biba/equal

/dev                            biba/equal
/dev/*                          biba/equal

/var                            biba/equal
/var/spool                      biba/equal
/var/spool/*                    biba/equal

/var/log                        biba/equal
/var/log/*                      biba/equal

/tmp                            biba/equal
/tmp/*                          biba/equal
/var/tmp                        biba/equal
/var/tmp/*                      biba/equal

/var/spool/mqueue               biba/equal
/var/spool/clientmqueue         biba/equal

#Voor Nagios:
/usr/local/etc/nagios
/usr/local/etc/nagios/*         biba/10
/var/spool/nagios               biba/10
/var/spool/nagios/*             biba/10

#Voor Apache:
/usr/local/etc/apache           biba/10
/usr/local/etc/apache/*         biba/10</pre></div></div><div class=paragraph><p>Dit beleid zal beveiliging afdwingen door beperkingen aan de informatiestroom te stellen. In deze specifieke configuratie mogen gebruikers, inclusief <code>root</code>, nooit toegang hebben tot Nagios. Instellingenbestanden en processen die deel zijn van Nagios zullen geheel in zichzelf of in een jail zitten.</p></div><div class=paragraph><p>Dit bestand kan nu in ons systeem worden gelezen door ons systeem door het volgende commando uit te voeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfsmac -ef /etc/policy.contexts /</span>
<span class=c># setfsmac -ef /etc/policy.contexts /</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De bovenstaande indeling van het bestandssysteem kan afhankelijk van de omgeving verschillen; het moet echter op elk bestandssysteem gedraaid worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het bestand <span class=filename>/etc/mac.conf</span> dient als volgt in de hoofdsectie gewijzigd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>default_labels file ?biba
default_labels ifnet ?biba
default_labels process ?biba
default_labels socket ?biba</pre></div></div></div><div class=sect3><h4 id=_het_netwerk_activeren>17.15.5. Het netwerk activeren<a class=anchor href=#_het_netwerk_activeren></a></h4><div class=paragraph><p>Voeg de volgende regel toe aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>security.mac.biba.trust_all_interfaces=1</pre></div></div><div class=paragraph><p>En voeg het volgende toe aan de instellingen van de netwerkkaart opgeslagen in <span class=filename>rc.conf</span>. Als de primaire Internetconfiguratie via DHCP wordt gedaan, kan het nodig zijn om dit handmatig te configureren telkens nadat het systeem is opgestart:</p></div><div class="literalblock programlisting"><div class=content><pre>maclabel biba/equal</pre></div></div></div><div class=sect3><h4 id=_de_configuratie_testen>17.15.6. De configuratie testen<a class=anchor href=#_de_configuratie_testen></a></h4><div class=paragraph><p>Controleer dat de webserver en Nagios niet tijdens de systeeminitialisatie worden gestart, en start opnieuw op. Controleer dat de gebruiker <code>root</code> geen enkel bestand in de instellingenmap van Nagios kan benaderen. Als <code>root</code> het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> op <span class=filename>/var/spool/nagios</span> kan uitvoeren, is er iets verkeerd. Anders zou er een fout "Permission denied" teruggegeven moeten worden.</p></div><div class=paragraph><p>Als alles er goed uitziet, kunnen Nagios, Apache, en Sendmail nu gestart worden op een manier die past in het beveiligingsbeleid. De volgende commando’s zorgen hiervoor:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /etc/mail &amp;↦ make stop &amp;&amp; \</span>
setpmac biba/equal make start <span class=o>&amp;&amp;</span> setpmac biba/10<span class=se>\(</span>10-10<span class=se>\)</span> apachectl start <span class=o>&amp;&amp;</span> <span class=se>\</span>
setpmac biba/10<span class=se>\(</span>10-10<span class=se>\)</span> /usr/local/etc/rc.d/nagios.sh forcestart</code></pre></div></div><div class=paragraph><p>Controleer nogmaals om er zeker van te zijn dat alles juist werkt. Indien niet, controleer dan de logbestanden of de foutmeldingen. Gebruik het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> om de beveiligingsbeleidsmodule <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> uit te schakelen en probeer om alles opnieuw op te starten, zoals gewoonlijk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De gebruiker <code>root</code> kan zonder angst de afgedwongen beveiliging veranderen en de instellingenbestanden bewerken. Het volgende commando staat toe om het beveiligingsbeleid naar een lagere graad te degraderen voor een nieuw voortgebrachte shell:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setpmac biba/10 csh</span></code></pre></div></div><div class=paragraph><p>Om te voorkomen dat dit gebeurt, kan de gebruiker via <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a> in een bereik worden gedwongen. Als <a href="https://man.freebsd.org/cgi/man.cgi?query=setpmac&amp;sektion=8&amp;format=html">setpmac(8)</a> probeert om een commando buiten het bereik van het compartiment te draaien, zal er een fout worden teruggegeven en wordt het commando niet uitgevoerd. Zet in dit geval root op <code>biba/high(high-high)</code>.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=mac-userlocked>17.16. Gebruikers afsluiten<a class=anchor href=#mac-userlocked></a></h3><div class=paragraph><p>Dit voorbeeld gaat over een relatief klein opslagsysteem met minder dan vijftig gebruikers. Gebruikers kunnen zich aanmelden, en mogen zowel gegevens opslaan als bronnen benaderen.</p></div><div class=paragraph><p>Voor dit scenario kunnen <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> gecombineerd met <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_seeotheruids&amp;sektion=4&amp;format=html">mac_seeotheruids(4)</a> naast elkaar bestaan en zowel toegang tot systeemobjecten als tot gebruikersprocessen ontzeggen.</p></div><div class=paragraph><p>Begin door de volgende regel aan <span class=filename>/boot/loader.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>mac_seeotheruids_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het beveiligingsbeleidsmodule <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> kan door volgende variabele in rc.conf geactiveerd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ugidfw_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>De standaardregels in <span class=filename>/etc/rc.bsdextended</span> zullen tijdens de systeeminitialisatie worden geladen; het kan echter nodig zijn om de standaardregels te wijzigen. Aangezien van deze machine alleen verwacht wordt dat het gebruikers bedient, kunnen alle regels uitgecommentarieerd blijven behalve de laatste twee. Deze forceren het standaard laden van systeemobjecten die eigendom zijn van gebruikers.</p></div><div class=paragraph><p>Voeg de benodigde gebruikers toe aan deze machine en start opnieuw op. Probeer, voor testdoeleinden, u aan te melden als een andere gebruiker over twee consoles. Draai het commando <code>ps aux</code> om te zien of processen van andere gebruikers zichtbaar zijn. Probeer om <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> te draaien op de thuismap van een andere gebruiker, dit zou moeten mislukken.</p></div><div class=paragraph><p>Probeer niet te testen met de gebruiker <code>root</code> tenzij de specifieke <code>sysctl</code>'s om supergebruikertoegang te blokkeren zijn aangepast.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Wanneer een nieuwe gebruiker is toegevoegd, zit de <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a>-regel van die gebruiker niet in de lijst van regelverzamelingen. Om de regelverzameling snel bij te werken, kan simpelweg de beveiligingsbeleidsmodule worden herladen met de gereedschappen <a href="https://man.freebsd.org/cgi/man.cgi?query=kldunload&amp;sektion=8&amp;format=html">kldunload(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=mac-troubleshoot>17.17. Problemen oplossen met het MAC-raamwerk<a class=anchor href=#mac-troubleshoot></a></h3><div class=paragraph><p>Tijdens de ontwikkeling hebben een aantal gebruikers problemen aangegeven met normale instellingen. Hieronder worden een aantal van die problemen beschreven:</p></div><div class=sect3><h4 id=_de_optie_multilabel_kan_niet_ingeschakeld_worden_op>17.17.1. De optie <code>multilabel</code> kan niet ingeschakeld worden op <span class=filename>/</span><a class=anchor href=#_de_optie_multilabel_kan_niet_ingeschakeld_worden_op></a></h4><div class=paragraph><p>De vlag <code>multilabel</code> blijft niet ingeschakeld op de rootpartitie (<span class=filename>/</span>)!</p></div><div class=paragraph><p>Het lijkt er inderdaad op dat een paar procent van de gebruikers dit probleem heeft. Nadere analyse van het probleem doet vermoeden dat deze zogenaamde "bug" het resultaat is van òfwel onjuiste documentatie òfwel verkeerde interpretatie van de documentatie. Hoe het probleem ook is ontstaan, met de volgende stappen is het te verhelpen:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Wijzig <span class=filename>/etc/fstab</span> en stel de rootpartitie in op <code>ro</code> voor alleen-lezen.</p></li><li><p>Herstart in enkele-gebruikersmodus.</p></li><li><p>Draai <code>tunefs -l enable</code> op <span class=filename>/</span>.</p></li><li><p>Herstart in normale modus.</p></li><li><p>Draai <code>mount -urw</code><span class=filename>/</span> en wijzig <code>ro</code> terug in <code>rw</code> in <span class=filename>/etc/fstab</span> en start het systeem opnieuw.</p></li><li><p>Controleer de uitvoer van <code>mount</code> om zeker te zijn dat <code>multilabel</code> juist is ingesteld op het rootbestandssysteem.</p></li></ol></div></div></div></div><div class=sect3><h4 id=_x11_server_start_niet_na_mac>17.17.2. X11-server start niet na MAC<a class=anchor href=#_x11_server_start_niet_na_mac></a></h4><div class=paragraph><p>Na het instellen van een beveiligde omgeving met MAC start X niet meer!</p></div><div class=paragraph><p>Dit kan komen door de MAC-beleidseenheid <code>partition</code> of door een verkeerde labeling van een van de MAC-labeling beleidseenheden. Probeer als volgt te debuggen:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Controleer de foutmelding. Als de gebruiker in de klasse <code>insecure</code> zit, kan de beleidseenheid <code>partition</code> het probleem zijn. Zet de klasse voor de gebruiker terug naar de klasse <code>default</code> en herbouw de database met het commando <code>cap_mkdb</code>. Ga naar stap twee als hiermee het probleem niet is opgelost.</p></li><li><p>Controleer de labelbeleidseenheden nog een keer. Stel zeker dat het beleid voor de bewuste gebruiker, de X11-applicatie, en de onderdelen van <span class=filename>/dev</span> juist zijn ingesteld.</p></li><li><p>Als geen van beide methodes het probleem oplossen, stuur dan de foutmelding en een beschrijving van de omgeving naar de TrustedBSD-discussielijsten van de <a href=http://www.TrustedBSD.org>TrustedBSD</a> website of naar de <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD algemene vragen mailinglijst</a> mailinglijst.</p></li></ol></div></div></div></div><div class=sect3><h4 id=_error_secure_path3_cannot_stat_login_conf>17.17.3. Error: <a href="https://man.freebsd.org/cgi/man.cgi?query=_secure_path&amp;sektion=3&amp;format=html">_secure_path(3)</a> cannot stat <span class=filename>.login_conf</span><a class=anchor href=#_error_secure_path3_cannot_stat_login_conf></a></h4><div class=paragraph><p>Bij het wisselen van de gebruiker <code>root</code> naar een andere gebruiker in het systeem, verschijnt de foutmelding <code>_secure_path: unable to state .login_conf</code>.</p></div><div class=paragraph><p>Deze melding komt meestal voor als de gebruiker een hogere labelinstelling heeft dan de gebruiker waarnaar wordt gewisseld. Als bijvoorbeeld gebruiker <code>joe</code> een standaardlabel <code>biba/low</code> heeft, dan kan gebruiker <code>root</code>, die een label <code>biba/high</code> heeft, de thuismap van <code>joe</code> niet zien. Dit gebeurt zonder rekening te houden met de mogelijkheid dat <code>root</code> met <code>su</code> de identiteit van <code>joe</code> heeft aangenomen. In dit scenario staat het integriteitsmodel van Biba niet toe dat <code>root</code> objecten kan zien van een lager integriteitsniveau.</p></div></div><div class=sect3><h4 id=_de_gebruikersnaam_root_is_stuk>17.17.4. De gebruikersnaam <code>root</code> is stuk!<a class=anchor href=#_de_gebruikersnaam_root_is_stuk></a></h4><div class=paragraph><p>In normale, of zelfs in enkelegebruikersmodus, wordt <code>root</code> niet herkend. Het commando <code>whoami</code> geeft 0 (nul) terug en <code>su</code> heeft als resultaat <code>who are you?</code>. Wat is er aan de hand?</p></div><div class=paragraph><p>Dit kan gebeuren als een labelbeleid is uitgeschakeld, òfwel door <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> òf doordat de beleidsmodule niet meer is geladen. Als de beleidseenheid (tijdelijk) is uitgeschakeld dan moet de database met aanmeldmogelijkheden opnieuw worden ingesteld, waarbij de optie <code>label</code> wordt verwijderd. Er dient voor te worden zorggedragen dat het bestand <span class=filename>login.conf</span> wordt ontdaan van alle opties met <code>label</code>, waarna de database opnieuw gebouwd kan worden met <code>cap_mkdb</code>.</p></div><div class=paragraph><p>Dit kan ook gebeuren als een beleid toegang verhinderd tot het bestand of de database <span class=filename>master.passwd</span>. Meestal wordt dit veroorzaakt door een beheerder die het bestand veranderd onder een label welke conflicteert met het globale beleid dat gebruikt wordt op het systeem. In deze gevallen wordt de gebruikersinformatie gelezen door het systeem en wordt de toegang geblokkeerd omdat het bestand het nieuwe label erft. Zet het beleid uit door middel van <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> en alles zou weer normaal moeten zijn.</p></div></div></div></div></div><div class=sect1><h2 id=audit>Hoofdstuk 18. Security Event Auditing<a class=anchor href=#audit></a></h2><div class=sectionbody><div class=sect2><h3 id=audit-synopsis>18.1. Overzicht<a class=anchor href=#audit-synopsis></a></h3><div class=paragraph><p>Het besturingssysteem FreeBSD heeft ondersteuning voor diepgaande beveiligingsauditing van evenementen. Evenement auditing maakt het mogelijk dat er diepgaande en configureerbare logging van een variateit aan beveiligings-gerelateerde systeem evenementen, waaronder logins, configuratie wijzigingen, bestands- en netwerk toegang. Deze log regels kunnen erg belangrijk zijn voor live systeem monitoring, intrusion detection en postmortem analyse. FreeBSD implementeert Sun™'s gepubliceerde BSM API en bestandsformaat en is uitwisselbaar met zowel Sun™'s Solaris™ als Apple®'s Mac OS® X audit implementaties.</p></div><div class=paragraph><p>Dit hoofdstuk richt zich op de installatie en configuratie van evenement auditing. Het legt audit policies uit en geeft voorbeelden van audit configuraties.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Wat evenement auditing is en hoe het werkt.</p></li><li><p>Hoe evenement auditing geconfigureerd kan worden voor FreeBSD voor gebruikers en processen.</p></li><li><p>Hoe de audittrail bekeken kan worden door gebruik te maken van de audit reduction en onderzoek programma’s.</p></li></ul></div><div class=paragraph><p>Voordat verder gegaan wordt moet het volgende bekend zijn:</p></div><div class=ulist><ul><li><p>UNIX® en FreeBSD basishandelingen begrijpen (<a href=./#basics>UNIX® beginselen</a>).</p></li><li><p>Bekend zijn met de basishandelingen van kernel configuratie/compilatie (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li><li><p>Bekend zijn met beveiliging en hoe dat relateert aan FreeBSD (<a href=./#security>Beveiliging</a>).</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>De audit-faciliteiten hebben enkele bekende beperkingen waaronder dat niet alle beveiligings-relevante systeemevenementen geaudit kunnen worden en dat sommige login-mechanismes, zoals X11-gebaseerde display managers en programma’s van erde partijen geen (goede) ondersteuning bieden voor het auditen van login-sessies van gebruikers.</p></div><div class=paragraph><p>De beveiligings evenement auditing faciliteit is in staat om erg gedetailleerde logs van systeem activiteiten op een druk systeem te genereren, trail bestands data kan erg groot worden wanneer er erg precieze details worden gevraagd, wat enkele gigabytes per week kan behalen in sommige configuraties. Beheerders moeten rekening houden met voldoende schijfruimte voor grote audit configuraties. Bijvoorbeeld het kan gewenst zijn om eigen bestandsysteem aan <span class=filename>/var/audit</span> toe te wijzen zo dat andere bestandssystemen geen hinder ondervinden als het audit bestandssysteem onverhoopt vol raakt.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=audit-inline-glossary>18.2. Sleutelwoorden in dit hoofdstuk<a class=anchor href=#audit-inline-glossary></a></h3><div class=paragraph><p>Voordat dit hoofdstuk gelezen kan worden, moeten er een aantal audit gerelateerde termen uitgelegd worden:</p></div><div class=ulist><ul><li><p><em>evenement</em>: Een auditbaar evenement is elk evenement dat gelogged kan worden door het audit subsysteem. Voorbeelden van beveiligings gerelateerde evenementen zijn het creëeren van een bestand, het opzetten van een netwerk verbinding, of van een gebruiker die aanlogt. Evenementen zijn ofwel "attributable" wat betekend dat ze getraceerd kunnen worden naar een geauthoriseerde gebruiker, of "non-attributable" voor situaties waarin dat niet mogelijk is. Voorbeelden van non-attributable evenementen zijn elk evenement dat gebeurd voordat authorisatie plaatsvind in het login proces, zoals bij foutieve inlog pogingen.</p></li><li><p><em>class</em>: Evenement klassen zijn benoemde sets van gerelateerde evenementen en worden gebruikt in selectie expressies. Veel gebruikte klassen van evenementen zijn "bestands creatie" (fc), "exec" (ex) en "login_logout" (lo).</p></li><li><p><em>record</em>: Een record is een audit log regel die het beveiligings evenement beschrijft. Records bevatten een record evenement type, informatie over het onderwerp (de gebruiker) welke de actie uitvoerd, de datum en de tijd, informatie over de objecten of argumenten, en een conditie die aangeeft of de actie geslaagd of mislukt is.</p></li><li><p><em>trail</em>: Een audit trail, of log bestand bestaat uit een serie van audit records welke beveiligings evenementen beschrijft. Meestal lopen deze trails in chronologische orde, gebaseerd op de tijd dat het evenement optrad. Alleen geauthoriseerde processen mogen records toevoegen aan de audit trail.</p></li><li><p><em>selection expression</em>: Een selectie expressie is een string welke een lijst bevat van prefixes en audit evenement klasse namen die overeenkomen met evenementen.</p></li><li><p><em>preselection</em>: Het proces waarbij het systeem bepaald welke evenementen interessant zijn voor de beheerder, zodat wordt voorkomen dat er audit records worden gegenereerd voor evenementen die niet interessant zijn. De "preselection" configuratie gebruikt een serie van selectie expressies om te identificeren welke klassen van evenementen van toepassing zijn op gebruikers en globale instellingen voor zowel geauthoriseerde als ongeauthoriseerde processen.</p></li><li><p><em>reduction</em>: Het proces waarbij records van bestaande audit trails worden geselecteerd voor bewaring, uitprinten of analyse. Ook is dit het proces waarbij ongewenste audit records worden verwijderd uit het audit trail. Door gebruik te maken van reduction kunnen beheerders policies implementeren die het bewaren van audit data verzorgen. Bijvoorbeeld gedetailleerde audit trails kunnen één maand bewaard worden maar erna worden trails gereduceerd zodat alleen login informatie bewaard worden voor archiverings redenen.</p></li></ul></div></div><div class=sect2><h3 id=audit-install>18.3. Installeren van audit ondersteuning.<a class=anchor href=#audit-install></a></h3><div class=paragraph><p>Ondersteuning in de gebruikersomgeving voor evenement auditing wordt geïnstalleerd als onderdeel van het basis FreeBSD besturingssysteem. Kernel-ondersteuning voor evenement-auditing wordt standaard meegenomen tijdens compilatie, maar moet expliciet in de kernel gecompileerd worden door de volgende regel toe te voegen aan het configuratiebestand van de kernel:</p></div><div class="literalblock programlisting"><div class=content><pre>options	AUDIT</pre></div></div><div class=paragraph><p>Bouw en herinstalleer de kernel volgens het normale proces zoals beschreven in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div><div class=paragraph><p>Zodra een audit ondersteunende kernel is gebouwd en geïnstalleerd en deze is opgestart kan de audit daemon aangezet worden door de volgende regel aan <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>auditd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Audit ondersteuning moet daarna aangezet worden door een herstart van het systeem of door het handmatig starten van de audit daemon:</p></div><div class="literalblock programlisting"><div class=content><pre>service auditd start</pre></div></div></div><div class=sect2><h3 id=audit-config>18.4. Audit Configuratie<a class=anchor href=#audit-config></a></h3><div class=paragraph><p>Alle configuratie bestanden voor beveiligings audit kunnen worden gevonden in <span class=filename>/etc/security</span>. De volgende bestanden moeten aanwezig zijn voor de audit daemon wordt gestart:</p></div><div class=ulist><ul><li><p><span class=filename>audit_class</span> - Bevat de definities van de audit klasses.</p></li><li><p><span class=filename>audit_control</span> - Controleert aspecten van het audit subsysteem, zoals de standaard audit klassen, minimale hoeveelheid diskruimte die moet overblijven op de audit log schijf, de maximale audit trail grootte, etc.</p></li><li><p><span class=filename>audit_event</span> - Tekst namen en beschrijvingen van systeem audit evenementen, evenals een lijst van klassen waarin elk evenement zich bevind.</p></li><li><p><span class=filename>audit_user</span> - Gebruiker specifieke audit benodigdheden welke gecombineerd worden met de globale standaarden tijdens het inloggen.</p></li><li><p><span class=filename>audit_warn</span> - Een bewerkbaar shell script gebruikt door de auditd applicatie welke waarschuwings berichten genereert in bijzondere situaties zoals wanneer de ruimte voor audit records te laagis of wanneer het audit trail bestand is geroteerd.</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Audit configuratie bestanden moeten voorzichtig worden bewerkt en onderhouden, omdat fouten in de configuratie kunnen resulteren in het verkeerd loggen van evenementen.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_evenement_selectie_expressies>18.4.1. Evenement selectie expressies<a class=anchor href=#_evenement_selectie_expressies></a></h4><div class=paragraph><p>Selectie expressies worden gebruikt op een aantal plaatsen in de audit configuratie om te bepalen welke evenementen er geaudit moeten worden. Expressies bevatten een lijst van evenement klassen welke gelijk zijn aan een prefix welke aangeeft of gelijke records geaccepteerd moeten worden of genegeerd en optioneel om aan te geven of de regel is bedoeld om succesvolle of mislukte operaties te matchen. Selectie expressies worden geevalueerd van links naar rechts en twee expressies worden gecombineerd door de één aan de ander toe te voegen.</p></div><div class=paragraph><p>De volgende lijst bevat de standaard audit evenement klassen welke aanwezig zijn in het <span class=filename>audit_class</span> bestand:</p></div><div class=ulist><ul><li><p><code>all</code> - <em>all</em> - Matched alle evenement klasses.</p></li><li><p><code>ad</code> - <em>administrative</em> - Administratieve acties welke uitgevoerd worden op het gehele systeem.</p></li><li><p><code>ap</code> - <em>application</em> - Applicatie gedefinieerde acties.</p></li><li><p><code>cl</code> - <em>file close</em> - Audit aanroepen naar de <code>close</code> systeem aanroep.</p></li><li><p><code>ex</code> - <em>exec</em> - Audit programma uitvoer. Het auditen van command line argumenten en omgevings variabelen wordt gecontroleerd via <a href="https://man.freebsd.org/cgi/man.cgi?query=audit_control&amp;sektion=5&amp;format=html">audit_control(5)</a> door gebruik te maken van de <code>argv</code> en <code>envv</code> parameters in de <code>policy</code> setting.</p></li><li><p><code>fa</code> - <em>file attribute access</em> - Audit de toevoeging van object attributen zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=stat&amp;sektion=1&amp;format=html">stat(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=pathconf&amp;sektion=2&amp;format=html">pathconf(2)</a> en gelijkwaardige evenementen.</p></li><li><p><code>fc</code> - <em>file create</em> - Audit evenementen waar een bestand wordt gecreëerd als resultaat.</p></li><li><p><code>fd</code> - <em>file delete</em> - Audit evenementen waarbij bestanden verwijderd worden.</p></li><li><p><code>fm</code> - <em>file attribute modify</em> - Audit evenementen waarbij bestandsattribuut wijzigingen plaatsvinden zoals bij <a href="https://man.freebsd.org/cgi/man.cgi?query=chown&amp;sektion=8&amp;format=html">chown(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=flock&amp;sektion=2&amp;format=html">flock(2)</a>, etc.</p></li><li><p><code>fr</code> - <em>file read</em> - Audit evenementen waarbij data wordt gelezen, bestanden worden geopend voor lezen etc.</p></li><li><p><code>fw</code> - <em>file write</em> - Audit evenementen waarbij data wordt geschreven, bestanden worden geschreven of gewijzigd, etc.</p></li><li><p><code>io</code> - <em>ioctl</em> - Audit het gebruik van de <a href="https://man.freebsd.org/cgi/man.cgi?query=ioctl&amp;sektion=2&amp;format=html">ioctl(2)</a> systeem aanroep.</p></li><li><p><code>ip</code> - <em>ipc</em> - Audit verschillende vormen van Inter-Process Communication, zoals POSIX pipes en System V IPC operaties.</p></li><li><p><code>lo</code> - <em>login_logout</em> - Audit <a href="https://man.freebsd.org/cgi/man.cgi?query=login&amp;sektion=1&amp;format=html">login(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=logout&amp;sektion=1&amp;format=html">logout(1)</a> evenementen die plaatsvinden op het systeem.</p></li><li><p><code>na</code> - <em>non attributable</em> - Audit non-attributable evenementen.</p></li><li><p><code>no</code> - <em>invalid class</em> - Matched geen enkel audit evenement.</p></li><li><p><code>nt</code> - <em>network</em> - Audit evenementen die gerelateerd zijn aan netwerk acties zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=connect&amp;sektion=2&amp;format=html">connect(2)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=accept&amp;sektion=2&amp;format=html">accept(2)</a>.</p></li><li><p><code>ot</code> - <em>other</em> - Audit diverse evenementen.</p></li><li><p><code>pc</code> - <em>process</em> - Audit process operaties zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=exec&amp;sektion=3&amp;format=html">exec(3)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=exit&amp;sektion=3&amp;format=html">exit(3)</a></p></li></ul></div><div class=paragraph><p>Deze audit evenement klassen kunnen veranderd worden door het wijzigingen van de <span class=filename>audit_class</span> en <span class=filename>audit_event</span> configuratie bestanden.</p></div><div class=paragraph><p>Elke audit klasse in de lijst wordt gecombineerd met een voorzetsel welke aangeeft of er succesvolle of mislukte operaties hebben plaatsgevonden en of de regel wordt toegevoegd of verwijderd van het matchen van de klasse en het type.</p></div><div class=ulist><ul><li><p>(none) Audit zowel succesvolle als mislukte informatie van het evenement.</p></li><li><p><code>+</code> Audit succesvolle evenementen in deze klasse.</p></li><li><p><code>-</code> Audit mislukte evenementen in deze klasse.</p></li><li><p><code>^</code> Audit geen enkele succesvolle of mislukte evenementen in deze klasse.</p></li><li><p><code>^+</code> Audit geen succesvolle evenementen in deze klasse.</p></li><li><p><code>^-</code> Audit geen mislukte evenementen in deze klasse.</p></li></ul></div><div class=paragraph><p>De volgende voorbeeld selectie strings selecteren zowel succesvolle als mislukte login/logout evenementen, maar alleen succesvolle uitvoer evenementen:</p></div><div class="literalblock programlisting"><div class=content><pre>lo,+ex</pre></div></div></div><div class=sect3><h4 id=_configuratie_bestanden>18.4.2. Configuratie bestanden<a class=anchor href=#_configuratie_bestanden></a></h4><div class=paragraph><p>In de meeste gevallen moet een beheerder twee bestanden wijzigingen wanneer het audit systeem wordt geconfigureerd: <span class=filename>audit_control</span> en <span class=filename>audit_user</span>. Het eerste controleert systeem brede audit eigenschappen en policies, het tweede kan gebruikt worden om diepgaande auditing per gebruiker uit te voeren.</p></div><div class=sect4><h5 id=audit-auditcontrol>18.4.2.1. Het <span class=filename>audit_control</span> bestand<a class=anchor href=#audit-auditcontrol></a></h5><div class=paragraph><p>Het <span class=filename>audit_control</span> bestand specificeert een aantal standaarden van het audit subsysteem. Als de inhoud bekeken wordt van dit bestand is het volgende te zien:</p></div><div class="literalblock programlisting"><div class=content><pre>dir:/var/audit
flags:lo
minfree:20
naflags:lo
policy:cnt
filesz:0</pre></div></div><div class=paragraph><p>De <code>dir</code> optie wordt gebruikt om één of meerdere directories te specificeren die gebruikt worden voor de opslag van audit logs. Als er meer dan één directory wordt gespecificeerd, worden ze op volgorde gebruikt naarmate ze gevuld worden. Het is standaard dat audit geconfigureerd wordt dat audit logs worden bewaard op een eigen bestandssysteem, om te voorkomen dat het audit subsysteem en andere subsystemen met elkaar botsen als het bestandssysteem volraakt.</p></div><div class=paragraph><p>Het <code>flags</code> veld stelt de systeem brede standaard preselection maskers voor attributable evenementen in. In het voorbeeld boven worden succesvolle en mislukte login en logout evenementen geaudit voor alle gebruikers.</p></div><div class=paragraph><p>De <code>minfree</code> optie definieerd het minimale percentage aan vrije ruimte voor dit bestandssysteem waar de audit trails worden opgeslagen. Wanneer deze limiet wordt overschreven wordt er een waarschuwing gegenereerd. In het bovenstaande voorbeeld wordt de minimale vrije ruimte ingesteld op 20 procent.</p></div><div class=paragraph><p>De <code>naflags</code> optie specificeerd audit klasses welke geaudit moeten worden voor non-attributed evenementen zoals het login proces en voor systeem daemons.</p></div><div class=paragraph><p>De <code>policy</code> optie specificeert een komma gescheiden lijst van policy vlaggen welke diverse aspecten van het audit proces beheren. De standaard <code>cnt</code> vlag geeft aan dat het systeem moet blijven draaien ook al treden er audit fouten op (deze vlag wordt sterk aangeraden). Een andere veel gebruikte vlag is <code>argv</code>, wat het mogelijk maakt om command line argumenten aan de <a href="https://man.freebsd.org/cgi/man.cgi?query=execve&amp;sektion=2&amp;format=html">execve(2)</a> systeem aanroep te auditen als onderdeel van het uitvoeren van commando’s.</p></div><div class=paragraph><p>De <code>filesz</code> optie specificeert de maximale grootte in bytes hoeveel een audit trail bestand mag groeien voordat het automatisch getermineerd en geroteerd wordt. De standaard, 0, schakelt automatische log rotatie uit. Als de gevraagde bestands grootte niet nul is en onder de minimale 512k zit, wordt de optie genegeerd en wordt er een log bericht gegenereerd.</p></div></div><div class=sect4><h5 id=audit-audituser>18.4.2.2. Het <span class=filename>audit_user</span> bestand<a class=anchor href=#audit-audituser></a></h5><div class=paragraph><p>Het <span class=filename>audit_user</span> bestand staat de beheerder toe om verdere audit benodigdheden te specificeren voor gebruikers. Elke regel configureert auditing voor een gebruiker via twee velden, het eerste is het <code>alwaysaudit</code> veld, welke een set van evenementen specificeert welke altijd moet worden geaudit voor de gebruiker, en de tweede is het <code>neveraudit</code> veld, welke een set van evenementen specificeerd die nooit geaudit moeten worden voor de gebruiker.</p></div><div class=paragraph><p>Het volgende voorbeeld <span class=filename>audit_user</span> bestand audit login/logout evenementen en succesvolle commando uitvoer voor de <code>root</code> gebruiker, en audit bestands creatie en succesvolle commando uitvoer voor de <code>www</code> gebruiker. Als dit gebruikt wordt in combinatie met het voorbeeld <span class=filename>audit_control</span> bestand hierboven, is de <code>root</code> regel dubbelop en zullen login/logout evenementen ook worden geaudit voor de <code>www</code> gebruiker.</p></div><div class="literalblock programlisting"><div class=content><pre>root:lo,+ex:no
www:fc,+ex:no</pre></div></div></div></div></div><div class=sect2><h3 id=audit-administration>18.5. Het audit subsysteem beheren.<a class=anchor href=#audit-administration></a></h3><div class=sect3><h4 id=_audit_trails_inzien>18.5.1. Audit trails inzien<a class=anchor href=#_audit_trails_inzien></a></h4><div class=paragraph><p>Audit trails worden opgeslagen in het BSM binaire formaat, dus ondersteunende programma’s moeten worden gebruikt om de informatie te wijzigen of converteren naar tekst. Het <a href="https://man.freebsd.org/cgi/man.cgi?query=praudit&amp;sektion=1&amp;format=html">praudit(1)</a> commando converteert trail bestanden naar een simpel tekst formaat; het <a href="https://man.freebsd.org/cgi/man.cgi?query=auditreduce&amp;sektion=1&amp;format=html">auditreduce(1)</a> commando kan gebruikt worden om de audit trail te reduceren voor analyse, archivering of voor het uitprinten van de data. <code>auditreduce</code> ondersteund een variateit aan selectie parameters, zoals evenement type, evenement klasse, gebruiker, datum of tijd van het evenement en het bestandspad of object dat gebruikt wordt.</p></div><div class=paragraph><p>Bijvoorbeeld, het <code>praudit</code> programma zal een dump maken van de volledige inhoud van een gespecificeerd audit log bestand in normale tekst:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># praudit /var/audit/AUDITFILE</span></code></pre></div></div><div class=paragraph><p>Waar <span class=filename>AUDITFILE</span> het audit bestand is dat ingelezen moet worden.</p></div><div class=paragraph><p>Audit trails bestaan uit een serie van audit records die gevormd worden door tokens, welke <code>praudit</code> sequentieel print één per regel. Elke token is van een specifiek type, zoals een <code>header</code> welke de audit record header bevat, of <code>path</code> welke het bestandspad bevat van een lookup. Het volgende is een voorbeeld van een <code>execve</code> evenement:</p></div><div class="literalblock programlisting"><div class=content><pre>header,133,10,execve(2),0,Mon Sep 25 15:58:03 2006, + 384 msec
exec arg,finger,doug
path,/usr/bin/finger
attribute,555,root,wheel,90,24918,104944
subject,robert,root,wheel,root,wheel,38439,38032,42086,128.232.9.100
return,success,0
trailer,133</pre></div></div><div class=paragraph><p>Deze audit representeert een succesvolle <code>execve</code> aanroep, waarbij het commando <code>finger doug</code> is aangeroepen. Het argument token bevat beide commando’s gerepresenteerd door de shell aan de kernel. Het <code>path</code> token bevat het pad naar het uitvoerbare bestand zoals opgezocht door de kernel. Het <code>attribute</code> token beschrijft de binary en om precies te zijn bevat het de bestands mode welke gebruikt kan worden om te zien of het bestand setuid was. Het <code>subject</code> token beschrijft het onderwerp proces en bevat sequentieel het audit gebruikers ID, effectieve gebruikers ID en groep ID, echte gebruikers ID, groep ID, proces ID, sessie ID, port ID en login adres. Let op dat het audit gebruikers ID en het echte gebruikers ID van elkaar verschillen omdat de gebruiker <code>robert</code> veranderd is naar de <code>root</code> gebruiker voordat het commando werd uitgevoerd, maar welke geaudit wordt als de originele geauthoriseerde gebruiker. Als laatste wordt de <code>return</code> token gebruikt om aan te geven dat er een succesvolle uitvoer is geweest en <code>trailer</code> geeft het einde aan van het record.</p></div><div class=paragraph><p><code>praudit</code> ook een XML output formaat, welke geselecteerd kan worden door gebruik te maken van het <code>x</code> argument.</p></div></div><div class=sect3><h4 id=_het_reduceren_van_audit_trails>18.5.2. Het reduceren van audit trails<a class=anchor href=#_het_reduceren_van_audit_trails></a></h4><div class=paragraph><p>Omdat audit logs erg groot kunnen worden, zal de beheerder waarschijnlijk een subset van records willen selecteren om te gebruiken, zoals records die gekoppeld zijn aan een specifieke gebruiker:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># auditreduce -u trhodes /var/audit/AUDITFILE | praudit</span></code></pre></div></div><div class=paragraph><p>Dit selecteert alle audit records die geproduceert zijn voor de gebruiker <code>trhodes</code> die opgeslagen is in het <span class=filename>AUDITFILE</span> bestand.</p></div></div><div class=sect3><h4 id=_delegeren_van_audit_onderzoek_rechten>18.5.3. Delegeren van audit onderzoek rechten<a class=anchor href=#_delegeren_van_audit_onderzoek_rechten></a></h4><div class=paragraph><p>Leden van de <code>audit</code> groep krijgen permissie om de audit trails te lezen in <span class=filename>/var/audit</span>; standaard is deze groep leeg en kan alleen de <code>root</code> gebruiker deze audit trails lezen. Gebruikers kunnen toegevoegd worden aan de <code>audit</code> groep zodat onderzoek rechten kunnen worden gedelegeerd aan de geruiker. Omdat de mogelijkheid van het inzien van audit log inhoud significante inzicht kan geven in het gedrag van gebruikers en processen, wordt het aangeraden dat de delagatie van onderzoek rechten eerst goed overdacht wordt.</p></div></div><div class=sect3><h4 id=_live_monitoren_door_gebruik_van_audit_pipes>18.5.4. Live monitoren door gebruik van audit pipes<a class=anchor href=#_live_monitoren_door_gebruik_van_audit_pipes></a></h4><div class=paragraph><p>Audit pipes zijn gecloonde pseudo-devices in het device bestands systeem, welke applicaties toestaat om een tap te plaatsen in de live audit record stream. Dit is primair interessant voor schrijvers van intrusion detection en systeem monitoring applicaties. Echter, voor een beheerder is het audit pipe device een makkelijke manier om live monitoring toe te staan zonder dat er problemen kunnen ontstaan met het eigenaarschap van het audit trail bestand, of dat een log rotatie de evenementen stroom in de weg zit. Om de live audit evenementen stroom te kunnen inzien is het volgende commando benodigd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># praudit /dev/auditpipe</span></code></pre></div></div><div class=paragraph><p>Standaard zijn de audit pipe device nodes alleen toegankelijk voor de <code>root</code> gebruiker. Om deze toegankelijk te maken voor leden van de <code>audit</code> groep, moet een <code>devfs</code> regel toegevoegd worden aan het <span class=filename>devfs.rules</span> bestand:</p></div><div class="literalblock programlisting"><div class=content><pre>add path &#39;auditpipe*&#39; mode 0440 group audit</pre></div></div><div class=paragraph><p>Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.rules&amp;sektion=5&amp;format=html">devfs.rules(5)</a> voor meer informatie over het configureren van het devfs bestands systeem.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Het is makkelijk om audit evenement terugkoppeling cyclussen te creëeren, waarbij het tonen van elk audit evenement resulteert in het genereren van nog meer audit evenementen. Bijvoorbeeld, als alle netwerk I/O wordt geaudit en <a href="https://man.freebsd.org/cgi/man.cgi?query=praudit&amp;sektion=1&amp;format=html">praudit(1)</a> wordt gestart vanuit een SSH sessie, wordt er een grote continue stroom aan audit evenementen gegenereert doordat elk getoond evenement een nieuw evenement genereert. Het is verstandig om <code>praudit</code> te draaien op een audit pipe device voor sessies zonder diepgaande I/O auditing om te voorkomen dat dit gebeurd.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_het_roteren_van_audit_trail_bestanden>18.5.5. Het roteren van audit trail bestanden<a class=anchor href=#_het_roteren_van_audit_trail_bestanden></a></h4><div class=paragraph><p>Audit trails worden alleen beschreven door de kernel en alleen beheerd worden door de audit daemon, auditd. Beheerders mogen geen gebruik maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog.conf&amp;sektion=5&amp;format=html">newsyslog.conf(5)</a> of soortgelijke programma’s om de audit files te roteren. In plaats daarvan kan het <code>audit</code> management programma gebruikt worden om auditing te stoppen, het audit systeem te herconfigureren en log rotatie uit te voeren. Het volgende commando zorgt ervoor dat de audit daemon een nieuwe audit log maakt, en vervolgens de kernel een signaal stuurt om het nieuwe logbestand te gaan gebruiken. Het oude logbestand wordt getermineerd en hernoemd, waarna het bestand gemanipuleerd kan worden door de beheerder.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># audit -n</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Als de auditd daemon op dit moment niet actief is, zal het commando falen en zal er een error bericht worden geproduceerd.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als de volgende regel wordt toegevoegd aan het <span class=filename>/etc/crontab</span> bestand, zal er elke twaalf uur een rotatie plaatsvinden door middel van <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>0     */12       *       *       *       root    /usr/sbin/audit -n</pre></div></div><div class=paragraph><p>Deze wijziging wordt van kracht op het moment dat het nieuwe <span class=filename>/etc/crontab</span> bestand wordt opgeslagen.</p></div><div class=paragraph><p>Automatische rotatie van het audit trail bestand gebaseerd op de bestand grootte is mogelijk via de <code>filesz</code> optie in <a href="https://man.freebsd.org/cgi/man.cgi?query=audit_control&amp;sektion=5&amp;format=html">audit_control(5)</a> en wordt beschreven in de configuratie bestanden sectie van dit hoofdstuk.</p></div></div><div class=sect3><h4 id=_audit_trails_comprimeren>18.5.6. Audit trails comprimeren<a class=anchor href=#_audit_trails_comprimeren></a></h4><div class=paragraph><p>Omdat audit trail bestanden erg groot kunnen worden, is het meestal gewenst om de trails te comprimeren of op een andere manier te archiveren zodra ze afgesloten zijn door de audit daemon. Het <span class=filename>audit_warn</span> script kan gebruikt worden om bewerkte operaties te doen voor een variateit aan audit gerelateerde evenementen inclusief een nette terminatie van audit trails wanneer deze geroteerd worden. Bijvoorbeeld het volgende kan worden toegevoegd aan het <span class=filename>audit_warn</span> script, dat de audit trails comprimeert zodra ze afgesloten worden:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# Compress audit trail files on close.
#
if [ &#34;$1&#34; = closefile ]; then
        gzip -9 $2
fi</pre></div></div><div class=paragraph><p>Andere archiverings activiteiten kunnen zijn het kopieren van trail bestanden naar een gecentraliseerde server, het verwijderen van oude trail bestanden of het reduceren van de audit trail om onnodige records te verwijderen. Het script zal alleen draaien als audit trail bestanden netjes worden afgesloten, wat betekend dat het script niet uitgevoerd wordt op trails die niet netjes afgesloten zijn, waardoor bestanden corrupt kunnen raken.</p></div></div></div></div></div><div class=sect1><h2 id=disks>Hoofdstuk 19. Opslag<a class=anchor href=#disks></a></h2><div class=sectionbody><div class=sect2><h3 id=disks-synopsis>19.1. Overzicht<a class=anchor href=#disks-synopsis></a></h3><div class=paragraph><p>Dit hoofdstuk behandelt het gebruik van schijven in FreeBSD. Dit omvat geheugenschijven, schijven die met het netwerk verbonden zijn, SCSI/IDE-opslagapparaten en apparaten die gebruik maken van de USB-interface.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Welke terminologie FreeBSD gebruikt om de gegevensindeling op een fysieke schijf te beschrijven (partities en slices);</p></li><li><p>Hoe aanvullende harde schijven aan een systeem toe te voegen;</p></li><li><p>Hoe FreeBSD in te stellen om het gebruik te laten maken van USB-opslagapparaten;</p></li><li><p>Hoe virtuële bestandssystemen, zoals geheugenschijven, aan te maken;</p></li><li><p>Hoe quota te gebruiken om het schijfgebruik te beperken;</p></li><li><p>Hoe schijven te versleutelen om ze tegen inbrekers te beschermen;</p></li><li><p>Hoe vanuit FreeBSD CD’s en DVD’s aan te maken en te branden;</p></li><li><p>Wat de verschillende mogelijkheden zijn voor opslagmedia voor back-ups;</p></li><li><p>Hoe back-upprogramma’s te gebruiken die beschikbaar zijn in FreeBSD;</p></li><li><p>Hoe een back-up naar diskettes te maken;</p></li><li><p>Wat bestandssysteem snapshots zijn en hoe ze efficiënt te gebruiken.</p></li></ul></div><div class=paragraph><p>Aangeraden voorkennis:</p></div><div class=ulist><ul><li><p>Hoe een nieuwe FreeBSD-kernel in te stellen en te installeren (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li></ul></div></div><div class=sect2><h3 id=disks-naming>19.2. Apparaatnamen<a class=anchor href=#disks-naming></a></h3><div class=paragraph><p>De volgende lijst noemt de fysieke opslagapparaten die in FreeBSD ondersteund worden, samen met de bijhorende namen.</p></div><table id=disk-naming-physical-table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 6. Naamconventies voor fysieke Schijven</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Type medium</th><th class="tableblock halign-left valign-top">Apparaatnaam medium</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE harde schijven</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ad</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE CD-ROM-stations</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>acd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI harde schijven en USB-apparaten voor massa-opslag</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>da</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI CD-ROM-schijven</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Overige niet-standaard-CD-ROM-stations</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>mcd</code> voor Mitsumi CD-ROM en <code>scd</code> voor Sony CD-ROM apparaten.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Diskettestations</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI bandstations</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>sa</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE bandstations</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ast</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Flashdrives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fla</code> voor DiskOnChip® flashapparaten</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RAID-schijven</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>aacd</code> voor Adaptec® AdvancedRAID, <code>mlxd</code> en <code>mlyd</code> voor Mylex®, <code>amrd</code> voor AMI MegaRAID®, <code>idad</code> voor Compaq Smart RAID, <code>twed</code> voor 3ware® RAID.</p></td></tr></tbody></table></div><div class=sect2><h3 id=disks-adding>19.3. Schijven toevoegen<a class=anchor href=#disks-adding></a></h3><div class=paragraph><p>De volgende sectie beschrijft hoe een nieuwe SCSI schijf aan een machine toe te voegen die slechts een enkele drive heeft. Ten eerste dient de computer uitgeschakeld te worden en dient de schijf volgens de instructies van de computer, controller en schijffabrikant geïnstalleerd te worden. Wegens de grote variéteiten om dit soort procedures uit te voeren, vallen de details buiten het bereik van dit document.</p></div><div class=paragraph><p>Er dient als gebruiker <code>root</code> ingelogd te worden. Nadat de schijf is toegevoegd, dient <span class=filename>/var/run/dmesg.boot</span> bekeken te worden om er zeker van te zijn dat de nieuwe schijf is gevonden. Volgens het voorbeeld heet de nieuw toegevoegde schijf <span class=filename>da1</span> en die wordt aangekoppeld op <span class=filename>/1</span> (als er een IDE-schijf wordt toegevoegd, is de apparaatnaam <span class=filename>ad1</span>).</p></div><div class=paragraph><p>FreeBSD draait op IBM-PC-compatibele computers. Daarom moet het rekening houden met de PC-BIOS-partities. Deze wijken af van de traditionele BSD-partities. Een PC-schijf bevat tot vier ingangen voor BIOS-partities. Indien de schijf geheel aan FreeBSD wordt gewijd, kan de <em>toegewijde</em>-modus gebruikt worden. In het andere geval moet FreeBSD binnen één van de vier PC-BIOS-partities draaien. De PC-BIOS-partities worden door FreeBSD <em>slices</em> genoemd om ze niet met de traditionele BSD-partities te verwarren. Slices kunnen ook op een schijf worden gebruikt die toegewijd is aan FreeBSD, maar in een computer zit die ook andere besturingssystemen heeft geïnstalleerd. Dit is een goede manier om verwarring met het programma <code>fdisk</code> van andere, niet-FreeBSD besturingssystemen te voorkomen.</p></div><div class=paragraph><p>Als er met slices gewerkt wordt, wordt de schijf toegevoegd als <span class=filename>/dev/da1s1e</span>. Dit moet worden gelezen als: SCSI-schijf, eenheid 1 (tweede SCSI-schijf), slice 1 (PC-BIOS-partitie 1) en BSD-partitie <span class=filename>e</span>. Als de schijf toegewijd is, wordt deze simpelweg als <span class=filename>/dev/da1e</span> toegevoegd.</p></div><div class=paragraph><p>Omdat 32-bit-integers worden gebruikt om het aantal sectoren op te slaan, is <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> beperkt tot 2^32-1 sectoren per schijf, wat meestal neerkomt op 2 TB. Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> staat geen hogere startsector toe dan 2^32-1 en geen grotere lengte dan 2^32-1, meestal worden hiermee partities tot 2 TB begrensd en schijven tot 4 TB. Het formaat van <a href="https://man.freebsd.org/cgi/man.cgi?query=sunlabel&amp;sektion=8&amp;format=html">sunlabel(8)</a> is beperkt tot 2^32-1 sectoren per partitie en 8 partities per schijf, in totaal dus 16 TB. Voor grotere schijven kan <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a> worden gebruikt om GPT-partities aan te maken. GPT heeft het bijkomende voordeel dat het niet tot 4 slices beperkt is.</p></div><div class=sect3><h4 id=_sysinstall8_gebruiken>19.3.1. <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> gebruiken<a class=anchor href=#_sysinstall8_gebruiken></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Navigeren door sysinstall</p><div class=paragraph><p><code>sysinstall</code> kan gebruikt worden om een nieuwe schijf te partitioneren en te labelen met eenvoudig te gebruiken menu’s. Hiervoor dient òfwel als gebruiker <code>root</code> ingelogd te zijn, òfwel gebruik te worden gemaakt van <code>su</code>. Draai <code>sysinstall</code> en ga naar het menu <code>Configure</code>. Scroll binnen het <code>FreeBSD Configuration Menu</code> naar beneden en kies de optie <code>Fdisk</code>.</p></div></li><li><p>fdisk partitie-bewerker</p><div class=paragraph><p>Eenmaal binnen fdisk kan op <kbd>A</kbd> gedrukt worden om de gehele schijf voor FreeBSD te gebruiken. Wanneer gevraagd wordt of het systeem compatibel dient te blijven met mogelijk toekomstige besturingssystemen, dient met <code>YES</code> geantwoord te worden. Met <kbd>W</kbd> kunnen de veranderingen naar de schijf worden geschreven. Nu dient de FDISK-bewerker verlaten te worden door op <kbd>Q</kbd> te drukken. Vervolgens wordt er een vraag gesteld over het "Master Boot Record". Omdat er een schijf aan een reeds draaiend systeem wordt toegevoegd, dient hier <code>None</code> gekozen te worden.</p></div></li><li><p>Schijflabelbewerker</p><div class=paragraph><p>Vervolgens dient sysinstall verlaten en opnieuw gestart te worden. Volg bovenstaande aanwijzingen, maar kies deze keer voor de optie <code>Label</code>. Dit geeft toegang tot de <code>Disk Label Editor</code>. Hier worden de traditionele BSD-partities aangemaakt. Een schijf kan tot acht partities bevatten, gelabeld <code>a-h</code>. Enkele partitielabels hebben een speciale functie. De partitie <code>a</code> wordt gebruikt voor de rootpartitie (<span class=filename>/</span>). Alleen de systeemschijf (bijvoorbeeld de schijf van waaruit opgestart wordt) moet een partitie <code>a</code> hebben. De partitie <code>b</code> wordt voor swappartities gebruikt, en het is mogelijk om vele schijven met swappartities te hebben. De partitie <code>c</code> adresseert de gehele schijf in toegewijde modus, of de gehele FreeBSD-slice in slice-modus. De andere partities zijn voor algemeen gebruik.</p></div><div class=paragraph><p>sysinstall’s Labelbewerker heeft een voorkeur voor de partitie <code>e</code> voor niet-root-niet-swap-partities. Binnen de Labelbewerker dient een enkel bestandssysteem te worden aangemaakt door op <kbd>C</kbd> te drukken. Kies <code>FS</code> wanneer gevraagd wordt of dit een FS (file system) of swap wordt, en geef een koppelpunt in (bijvoorbeeld <span class=filename>/mnt</span>). Wanneer een schijf in post-installatie-modus wordt toegevoegd, maakt sysinstall geen ingangen aan in <span class=filename>/etc/fstab</span>, dus dan is het opgegeven koppelpunt niet van belang.</p></div><div class=paragraph><p>Nu kan het nieuwe label naar de schijf worden geschreven en er een bestandssysteem op aangemaakt worden. Dit kan gedaan worden door op <kbd>W</kbd> te drukken. Fouten van sysinstall dat de nieuwe partitie niet aankoppeld kon worden kunnen genegeerd worden. De Labelbewerker en sysinstall kunnen nu volledig verlaten worden.</p></div></li><li><p>Afronden</p><div class=paragraph><p>De laatste stap bestaat uit het bewerken van <span class=filename>/etc/fstab</span> om hier een regel voor de nieuwe schijf aan toe te voegen.</p></div></li></ol></div></div></div></div><div class=sect3><h4 id=_het_gebruik_van_opdrachtregelgereedschappen>19.3.2. Het gebruik van opdrachtregelgereedschappen<a class=anchor href=#_het_gebruik_van_opdrachtregelgereedschappen></a></h4><div class=sect4><h5 id=_het_gebruik_van_slices>19.3.2.1. Het gebruik van slices<a class=anchor href=#_het_gebruik_van_slices></a></h5><div class=paragraph><p>Deze installatie zorgt ervoor dat de schijf correct samenwerkt met andere besturingssystemen die eventueel op de computer zijn geïnstalleerd en dat de <code>fdisk</code>-gereedschappen van andere besturingssystemen niet verward raken. Het wordt aangeraden om deze methode te gebruiken voor de installatie van nieuwe schijven. Gebruik de <code>toegewijde</code> modus alleen als hier een goede reden voor bestaat!</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of/dev/da1 bs=1k count=1</span>
<span class=c># fdisk -BI da1 # Initialiseer de nieuwe schijf.</span>
<span class=c># bsdlabel -B -w da1s1 auto # Label de schijf.</span>
<span class=c># bsdlabel -e da1s1 # Bewerk de zojuist aangemaakte schijflabel en voeg partities toe.</span>
<span class=c># mkdir -p /1</span>
<span class=c># newfs /dev/da1s1e # Herhaal dit voor alle aangemaakte partities.</span>
<span class=c># mount /dev/da1s1e /1 # Mount de partitie(s).</span>
<span class=c># vi /etc/fstab # Voeg de juiste regel(s) aan /etc/fstab toe.</span></code></pre></div></div><div class=paragraph><p>Vervang voor een IDE-schijf <span class=filename>da</span> door <span class=filename>ad</span>.</p></div></div><div class=sect4><h5 id=_toegewijd>19.3.2.2. Toegewijd<a class=anchor href=#_toegewijd></a></h5><div class=paragraph><p>Indien de nieuwe schijf niet met een ander besturingssysteem gedeeld wordt, kan de <code>toegewijde</code> modus gebruikt worden. Denk eraan dat deze modus besturingssystemen van Microsoft kan verwarren. Ze richten echter geen schade aan. IBM’s OS/2® "fatsoeneert" echter partities die het niet begrijpt.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 bs=1k count=1</span>
<span class=c># bsdlabel -Bw da1 auto</span>
<span class=c># bsdlabel -e da1 # Maak de `e&#39;-partitie aan.</span>
<span class=c># newfs /dev/da1e</span>
<span class=c># mkdir -p /1</span>
<span class=c># vi /etc/fstab # Voeg een regel voor /dev/da1e toe.</span>
<span class=c># mount /1</span></code></pre></div></div><div class=paragraph><p>Een alternatieve methode is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 count=2</span>
<span class=c># bsdlabel /dev/da1 | bsdlabel -BR da1 /dev/stdin</span>
<span class=c># newfs /dev/da1e</span>
<span class=c># mkdir -p /1 # Voeg een regel voor /dev/da1e toe.</span>
<span class=c># mount /1</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=raid>19.4. RAID<a class=anchor href=#raid></a></h3><div class=sect3><h4 id=raid-soft>19.4.1. Software RAID<a class=anchor href=#raid-soft></a></h4><div class=sect4><h5 id=ccd>19.4.1.1. Concatenated Disk Driver (CCD) instellingen<a class=anchor href=#ccd></a></h5><div class=paragraph><p>Bij het kiezen van een medium voor massa-opslag zijn de belangrijkste afwegingen snelheid, betrouwbaarheid en kosten. Het komt zelden voor dat alle drie in balans zijn. Normaalgesproken is een snel, betrouwbaar apparaat voor massa-opslag duur en kosten sparen gaat ten koste van òfwel snelheid òfwel betrouwbaarheid.</p></div><div class=paragraph><p>Bij het ontwerpen van het onderstaande systeem werd primair op de kosten gelet, gevolgd door snelheid en als laatste betrouwbaarheid. De overdrachtsnelheid van gegevens wordt voor dit systeem uiteindelijk beperkt door het netwerk. En hoewel betrouwbaarheid erg belangrijk is, wordt onderstaande CCD-schijf gebruikt voor het serven van on-line gegevens die reeds volledig op CD-R’s zijn geback-upt en eenvoudig vervangen kunnen worden.</p></div><div class=paragraph><p>De eerste stap in het kiezen van een massa-opslagoplossing is het bepalen van de eigen benodigdheden. Indien snelheid belangrijker is dan betrouwbaarheid of kosten, wijkt de oplossing af van het systeem dat in deze sectie wordt beschreven.</p></div><div class=sect5><h6 id=ccd-installhw>19.4.1.1.1. Hardware installeren<a class=anchor href=#ccd-installhw></a></h6><div class=paragraph><p>Als aanvulling op de IDE systeemschijf zijn drie Western Digital IDE-schijven van 30 GB, 5400 RPM vanuit de kern van de onderstaande CCD-schijf aanwezig, die ongeveer 90 GB aan on-line opslag bieden. Ideaal gezien heeft iedere IDE-schijf een eigen IDE-controller en kabel, maar om de kosten te minimaliseren zijn geen aanvullende IDE-kabels gebruikt. In plaats hiervan zijn de schijven zodanig met jumpers ingesteld dat elke IDE-controller één master en één slave heeft.</p></div><div class=paragraph><p>Tijdens het opnieuw opstarten werd het systeem-BIOS zodanig ingesteld dat het automatisch de aangekoppelde schijven detecteerde. Het was belangrijker dat FreeBSD ze tijdens het opnieuw opstarten herkende:</p></div><div class="literalblock programlisting"><div class=content><pre>ad0: 19574MB &lt;WDC WD205BA&gt; [39770/16/63] at ata0-master UDMA33
ad1: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata0-slave UDMA33
ad2: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata1-master UDMA33
ad3: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata1-slave UDMA33</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien FreeBSD niet alle schijven detecteert, moet gecontroleerd worden of de jumpers juist zijn ingesteld. De meeste IDE-schijven hebben ook een jumper voor "Cable Select". Dit is <em>niet</em> de jumper voor de master/slave-instelling. Voor hulp met het identificeren van de juiste jumper dient de documentatie van de schijf geraadpleegd te worden.</p></div></td></tr></tbody></table></div></div><div class=sect5><h6 id=ccd-setup>19.4.1.1.2. CCD installeren<a class=anchor href=#ccd-setup></a></h6><div class=paragraph><p>Het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> biedt de mogelijkheid om meerdere identieke schijven aaneen te rijgen tot één logisch bestandssysteem. Om gebruik te kunnen maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> is een kernel met ingebouwde ondersteuning voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> nodig. De volgende regel dient toegevoegd te worden aan het kernelinstellingenbestand en de kernel dient opnieuw gebouwd en geïnstalleerd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>device  ccd</pre></div></div><div class=paragraph><p>Om <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> te installeren dient eerst <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> gebruikt te worden om de schijven te labelen:</p></div><div class="literalblock programlisting"><div class=content><pre>bsdlabel -w -ad1 auto
bsdlabel -w ad2 auto
bsdlabel -w ad3 auto</pre></div></div><div class=paragraph><p>Bovenstaande maakt een schijflabel aan voor <span class=filename>ad1c</span>, <span class=filename>ad2c</span> en <span class=filename>ad3c</span> die de gehele schijf beslaat.</p></div><div class=paragraph><p>Vervolgens dient het labeltype van de schijf veranderd te worden. Voor het bewerken van de schijven kan <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> gebruikt worden:</p></div><div class="literalblock programlisting"><div class=content><pre>bsdlabel -e ad1
bsdlabel -e ad2
bsdlabel -e ad3</pre></div></div><div class=paragraph><p>Dit zorgt ervoor dat het huidige schijflabel van elke schijf met de tekstverwerker wordt geopend die door de omgevingsvariabele <code>EDITOR</code> wordt gespecificeerd, vaak <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a>.</p></div><div class=paragraph><p>Een ongewijzigd schijflabel ziet er ongeveer als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>8 partitions:
# size	offset	fstype	[fsize	bsize bps/cpg]
c: 60074784 0 unused  0	0 0 # (Cyl. 0 - 59597)</pre></div></div><div class=paragraph><p>Er dient een nieuwe partitie <code>e</code> toegevoegd te worden die door <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> gebruikt kan worden. Deze kan gewoonlijk van partitie <code>c</code> overgenomen worden, maar het <code>fstype <em>moet</em> 4.2BSD</code> zijn. Het schijflabel ziet er nu ongeveer als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>8 partitions:
# size	offset	fstype	[fsize	bsize bps/cpg]
c:  60074784  0	unused	0 0 0 # (Cyl. 0 - 59597)
e:  60074784  0	4.2BSD	0 0 0 #	(Cyl. 0 - 59597)</pre></div></div></div><div class=sect5><h6 id=ccd-buildingfs>19.4.1.1.3. Bestandssysteem aanmaken<a class=anchor href=#ccd-buildingfs></a></h6><div class=paragraph><p>Nu alle schijven gelabeld zijn, moet de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> gebouwd worden. Om dit te doen, dient <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> gebruikt te worden met opties die ongeveer gelijk zijn aan de volgende:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig ccd0 32 0 /dev/ad1e /dev/ad2e /dev/ad3e</pre></div></div><div class=paragraph><p>Hieronder staat het gebruik en de betekenis van elke optie:</p></div><div class=ulist><ul><li><p>Het eerste argument is het in te stellen apparaat, in dit geval <span class=filename>/dev/ccd0c</span>. Het gedeelte <span class=filename>/dev/</span> is optioneel.</p></li><li><p>De interleave voor het bestandssysteem. De interleave definiëert de grootte van een stripe in schijfblokken, elk schijfblok is normaalgesproken 512 bytes groot. Een interleave van 32 is dus 16.384 bytes groot.</p></li><li><p>Vlaggen voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a>. Indien het gewenst is om schijfspiegeling aan te zetten, kan er hier een vlag voor gespecificeerd worden. Deze opstelling biedt geen spiegeling voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>, dus is die op 0 (nul) ingesteld.</p></li><li><p>De laatste argumenten voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> zijn de apparaten die in de rij geplaatst dienen te worden. Voor elk apparaat dient de complete padnaam gebruikt te worden.</p></li></ul></div><div class=paragraph><p>Nadat <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> gedraaid is, is de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> ingesteld. Er kan een bestandssysteem worden geïnstalleerd. Er kan in <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> worden gekeken voor opties, of het draaien van het onderstaande commando is ook toereikend:</p></div><div class="literalblock programlisting"><div class=content><pre>newfs /dev/ccd0c</pre></div></div></div><div class=sect5><h6 id=ccd-auto>19.4.1.1.4. Alles automatisch maken<a class=anchor href=#ccd-auto></a></h6><div class=paragraph><p>In het algemeen is het wenselijk om de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> telkens te mouten wanneer er opnieuw opgestart wordt. Dit dient eerst ingesteld te worden. Met het volgende commando worden de huidige instellingen naar <span class=filename>/etc/ccd.conf</span> geschreven:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig -g &gt; /etc/ccd.conf</pre></div></div><div class=paragraph><p>Tijdens het opstarten draait het script <code>/etc/rc ccdconfig -C</code> indien <span class=filename>/etc/ccd.conf</span> bestaat. Dit stelt automatisch de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> in, zodat die kan worden aangekoppeld.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien er in enkele-gebruiker-modus wordt opgestart, dient het volgende commando te worden uitgevoerd om de rij in te stellen voordat de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> aangekoppeld kan worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig -C</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Om de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> automatisch aan te koppelen, kan er een regel voor de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> in <span class=filename>/etc/fstab</span> geplaatst worden, zodat die tijdens het opstarten aangekoppeld wordt:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ccd0c  /media  ufs rw  2	2</pre></div></div></div></div><div class=sect4><h5 id=vinum>19.4.1.2. Volumebeheerder Vinum<a class=anchor href=#vinum></a></h5><div class=paragraph><p>De volumebeheerder Vinum is een blokstuurprogramma dat virtuele schijven implementeert. Het isoleert schijfhardware van de blokapparaat-interface en projecteert gegevens op een manier die de flexibiliteit, prestatie en betrouwbaarheid verhoogt in vergelijking met de traditionele slice-blik op schijfopslag. <a href="https://man.freebsd.org/cgi/man.cgi?query=vinum&amp;sektion=4&amp;format=html">vinum(4)</a> implementeert de modellen RAID-0, RAID-1 en RAID-5, zowel individueel als als combinatie.</p></div></div></div><div class=sect3><h4 id=raid-hard>19.4.2. Hardwarematige RAID<a class=anchor href=#raid-hard></a></h4><div class=paragraph><p>FreeBSD ondersteunt ook een verscheidenheid aan hardwarematige RAID-stuurprogramma’s. Deze apparaten besturen een RAID-deelsysteem zonder dat er FreeBSD-specifieke software nodig is om de rij te beheren.</p></div><div class=paragraph><p>Door gebruik te maken van een BIOS die op de kaart aanwezig is, beheert de kaart de meeste schijfbewerkingen zelf. Nu volgt een korte beschrijving van een opzet waarbij een Promise IDE-stuurprogramma is gebruikt. Wanneer deze kaart geïnstalleerd en het systeem opgestart is, beeldt het een prompt af waarbij om informatie wordt gevraagd. De instructies dienen opgevolgd te worden om bij het instelscherm van de kaart te komen. Van hieruit kunnen alle aangekoppelde schijven gecombineerd worden. Nadat dit gedaan is, zien de schijven er voor FreeBSD als één enkele schijf uit. Andere RAID-niveaus kunnen overeenkomstig ingesteld worden.</p></div></div><div class=sect3><h4 id=_ata_raid1_rijen_opnieuw_bouwen>19.4.3. ATA RAID1-rijen opnieuw bouwen<a class=anchor href=#_ata_raid1_rijen_opnieuw_bouwen></a></h4><div class=paragraph><p>Met FreeBSD is het mogelijk om een defecte schijf in een rij te vervangen terwijl de computer aanstaat ("hot replace"). Hiervoor dient de schijf vóór het opnieuw opstarten vervangen te zijn.</p></div><div class=paragraph><p>Waarschijnlijk is zoiets als het volgende in <span class=filename>/var/log/messages</span> of in de uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> te zien:</p></div><div class="literalblock programlisting"><div class=content><pre>ad6 on monster1 suffered a hard error.
ad6: READ command timeout tag=0 serv=0 - resetting
ad6: trying fallback to PIO mode
ata3: resetting devices .. done
ad6: hard error reading fsbn 1116119 of 0-7 (ad6 bn 1116119; cn 1107 tn 4 sn 11)\\
status=59 error=40
ar0: WARNING - mirror lost</pre></div></div><div class=paragraph><p>Meer informatie kan met behulp van <a href="https://man.freebsd.org/cgi/man.cgi?query=atacontrol&amp;sektion=8&amp;format=html">atacontrol(8)</a> gezocht worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol list</span>
ATA channel 0:
	Master:      no device present
	Slave:   acd0 &lt;HL-DT-ST CD-ROM GCR-8520B/1.00&gt; ATA/ATAPI rev 0

ATA channel 1:
	Master:      no device present
	Slave:       no device present

ATA channel 2:
	Master:  ad4 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
	Slave:       no device present

ATA channel 3:
	Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
	Slave:       no device present

<span class=c># atacontrol status ar0</span>
ar0: ATA RAID1 subdisks: ad4 ad6 status: DEGRADED</code></pre></div></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Ontkoppel eerst het ata kanaal met de falende schijf zodat deze veilig kan worden verwijderd:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol detach ata3</span></code></pre></div></div></li><li><p>Vervang de schijf.</p></li><li><p>Koppel het ata kanaal opnieuw aan:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol attach ata3</span>
Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
Slave:   no device present</code></pre></div></div></li><li><p>Voeg de nieuwe schijf toe aan de rij als reserve:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol addspare ar0 ad6</span></code></pre></div></div></li><li><p>De rij dient nu opnieuw opgebouwd te worden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol rebuild ar0</span></code></pre></div></div></li><li><p>Het is mogelijk de voortgang te volgen met het volgende commando:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dmesg | tail -10</span>
<span class=o>[</span>uitvoer verwijderd]
ad6: removed from configuration
ad6: deleted from ar0 disk1
ad6: inserted into ar0 disk1 as spare

<span class=c># atacontrol status ar0</span>
ar0: ATA RAID1 subdisks: ad4 ad6 status: REBUILDING 0% completed</code></pre></div></div></li><li><p>Nu moet er gewacht worden tot de bewerking voltooid is.</p></li></ol></div></div></div></div></div><div class=sect2><h3 id=usb-disks>19.5. USB-opslagapparaten<a class=anchor href=#usb-disks></a></h3><div class=paragraph><p>Veel externe opslagoplossingen gebruiken tegenwoordig de Universele Seriële Bus (USB): harde schijven, USB-duimdrives, CD-R-branders, etc. FreeBSD biedt voor al dit soort apparaten ondersteuning.</p></div><div class=sect3><h4 id=_instellen_2>19.5.1. Instellen<a class=anchor href=#_instellen_2></a></h4><div class=paragraph><p>Het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> biedt de ondersteuning voor USB-opslagapparaten. Indien de kernel <span class=filename>GENERIC</span> wordt gebruikt, hoeft er niets aan de instellingen gewijzigd te worden. Als er een eigen kernel wordt gebruikt, dienen de volgende regels in het kernelinstellingenbestand aanwezig zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>device scbus
device da
device pass
device uhci
device ohci
device ehci
device usb
device umass</pre></div></div><div class=paragraph><p>Het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> gebruikt het subsysteem SCSI om toegang te krijgen tot de USB-opslagapparaten. Het USB-apparaat wordt door het systeem als een SCSI-apparaat gezien. Afhankelijk van de chipset op het moederbord is slechts òf <code>device uhci</code> òf <code>device ohci</code> nodig voor ondersteuning van USB 1.X. Het kan echter geen kwaad om ze beiden in het kernelinstellingenbestand te hebben. Ondersteuning voor USB 2.0 wordt geleverd door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ehci&amp;sektion=4&amp;format=html">ehci(4)</a> (de regel met <code>device ehci</code>). Indien er regels zijn toegevoegd dient de kernel opnieuw gecompileerd en geïnstalleerd te worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien het USB-apparaat een CD-R- of DVD-brander is, dient het SCSI CD-ROM-stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=cd&amp;sektion=4&amp;format=html">cd(4)</a> met de volgende regel aan de kernel toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>device cd</pre></div></div><div class=paragraph><p>Aangezien de brander als een SCSI-schijf gezien wordt, dient het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> niet in de kernelinstellingen gebruikt te worden.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_instellingen_testen>19.5.2. Instellingen testen<a class=anchor href=#_instellingen_testen></a></h4><div class=paragraph><p>De instellingen zijn klaar om getest te worden: het USB-apparaat dient aangesloten te worden en in de buffer voor systeemmeldingen (<a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a>) dient het stuurprogramma ongeveer als volgt te verschijnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: USB Solid state disk, rev 1.10/1.00, addr 2
GEOM: create disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
da0 at umass-sim0 bus 0 target 0 lun 0
da0: &lt;Generic Traveling Disk 1.11&gt; Removable Direct Access SCSI-2 device
da0: 1.000MB/s transfers
da0: 126MB <span class=o>(</span>258048 512 byte sectors: 64H 32S/T 126C<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Uiteraard kunnen het merk, de apparaatnode (<span class=filename>da0</span>) en andere details verschillen naar gelang de instelling.</p></div><div class=paragraph><p>Aangezien het USB-apparaat als een SCSI-apparaat gezien wordt, kan het commando <code>camcontrol</code> gebruikt worden om de USB-opslagapparaten weer te geven die aan het systeem gekoppeld zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;Generic Traveling Disk 1.11&gt;      at scbus0 target 0 lun 0 <span class=o>(</span>da0,pass0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Indien er een bestandssysteem op de schijf aanwezig is, kan dat aangekoppeld worden. <a href=#disks-adding>Schijven toevoegen</a> biedt indien nodig hulp bij het formatteren en aanmaken van partities op de USB-drive.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Door het toestaan dat gewone gebruikers verschillende media kunnen koppelen door bijvoorbeeld het aanzetten van <code>vfs.usermount</code> zoals hieronder beschreven, zou niet als veilig beschoud moeten worden uit een beveiligings oogpunt. Veel bestandssystemen in FreeBSD zijn niet geschreven om beveiliging te bieden tegen kwaadaardige apparaten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om het apparaat koppelbaar te maken voor de gewone gebruiker moeten er een aantal stappen ondernomen worden. Als eerste moeten de apparaten die gecreeerd worden wanneer het USB opslag- medium wordt toegevoegd toegankelijk zijn voor de gebruiker. Een oplossing is om alle gebruikers die deze rechten nodig hebben toe te voegen aan de <code>operator</code> groep. Dit kan gedaan worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>. Daarna moet het voor de <code>operator</code> groep mogelijk zijn te lezen en te schrijven naar de gecreeerde apparaten. Dit kan bewerkstelligd worden door de volgende regels toe te voegen aan <span class=filename>/etc/devfs.rules</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>[localrules=5]
add path &#39;da*&#39; mode 0660 group operator</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als er SCSI schijven in het systeem aanwezig zijn moet dit anders aangepakt worden. Stel dat het systeem reeds over de volgende schijven beschikt <span class=filename>da0</span> tot en met <span class=filename>da2</span>, verander de regel dan in het volgende:</p></div><div class="literalblock programlisting"><div class=content><pre>add path &#39;da[3-9]*&#39; mode 0660 group operator</pre></div></div><div class=paragraph><p>Dit sluit de reeds bestaande schijven buiten van toegang door de operator groep.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Erna moet ook de nieuwe ruleset voor <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.rules&amp;sektion=5&amp;format=html">devfs.rules(5)</a> ingeschakeld worden door middel van <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>devfs_system_ruleset=&#34;localrules&#34;</pre></div></div><div class=paragraph><p>Hierna moet de kernel worden geconfigureerd zodat gewone gebruikers rechten krijgen om bestandssystemen te koppelen. De makkelijkste manier is door de volgende regel toe te voegen aan <span class=filename>/etc/sysctl.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>vfs.usermount=1</pre></div></div><div class=paragraph><p>Let op, deze wijziging wordt pas actief na de volgende start van het systeem. Als alternatief kan ook <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> gebruikt worden om deze variabele te zetten.</p></div><div class=paragraph><p>De laatste stap is het creëeren van de map waar het bestandssysteem gekoppeld wordt. Deze map moet eigendom zijn van de gebruiker die het bestandssysteem gaat koppelen. Een manier om dat te bewerkstelligen is door met de gebruiker <code>root</code> een submap aan te maken die eigendom is van de gebruiker als <span class=filename>/mntgebruikersnaam</span> (verander <em>gebruikersnaam</em> door de loginnaam van de daadwerkelijke gebruiker en <em>gebruikersgroep</em> door de primaire groep van de gebruiker):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /mnt/gebruikersnaam</span>
<span class=c># chown gebruikersnaam:gebruikersgroep /mnt/gebruikersnaam</span></code></pre></div></div><div class=paragraph><p>Stel dat er vervolgens een USB-stick ingeplugged wordt en er een <span class=filename>/dev/da0s1</span> aangemaakt wordt. Omdat deze apparaten meestal voorgeformatteerd met een FAT-bestandssysteem komen, kan deze als volgende gekoppeld worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mount <span class=nt>-t</span> msdosfs <span class=nt>-o</span> <span class=nt>-m</span><span class=o>=</span>644,-M<span class=o>=</span>755 /dev/da0s1 /mnt/gebruikersnaam</code></pre></div></div><div class=paragraph><p>Indien het apparaat losgekoppeld wordt (nadat de schijf afgekoppeld is), dient in de buffer voor systeemmeldingen iets als het volgende te zien te zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: at uhub0 port 1 <span class=o>(</span>addr2<span class=o>)</span> disconnected
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: lost device
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: removing device entry
GEOM: destroy disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
umass0: detached</code></pre></div></div></div><div class=sect3><h4 id=_referenties>19.5.3. Referenties<a class=anchor href=#_referenties></a></h4><div class=paragraph><p>Naast de onderdelen <a href=#disks-adding>Schijven toevoegen</a> en <a href=./#mount-unmount>Bestandssystemen aan- en afkoppelen</a>, kunnen de volgende hulppagina’s ook nuttig zijn: <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=usbconfig&amp;sektion=8&amp;format=html">usbconfig(8)</a> voor FreeBSD 8.X of <a href="https://man.freebsd.org/cgi/man.cgi?query=usbdevs&amp;sektion=8&amp;format=html">usbdevs(8)</a> voor eerdere versies van FreeBSD.</p></div></div></div><div class=sect2><h3 id=creating-cds>19.6. Optische media (CD’s) aanmaken en gebruiken<a class=anchor href=#creating-cds></a></h3><div class=sect3><h4 id=_inleiding_3>19.6.1. Inleiding<a class=anchor href=#_inleiding_3></a></h4><div class=paragraph><p>CD’s hebben een aantal eigenschappen waardoor ze verschillen van conventionele schijven. Initieel zijn ze door de gebruiker niet beschrijfbaar. Ze zijn zó ontworpen dat ze continu, zonder vertragingen van het verplaatsen van de kop tussen tracks, gelezen kunnen worden. Ze zijn ook veel gemakkelijker tussen twee systemen te verplaatsen dan gelijksoortige media in hun tijd waren.</p></div><div class=paragraph><p>CD’s hebben tracks, maar die verwijzen naar secties van gegevens die continu gelezen dienen te worden en niet naar fysieke eigenschappen van de schijf. Om een CD op FreeBSD te produceren, dienen de gegevensbestanden waaruit de tracks op de CD gaan bestaan te worden voorbereid, waarna de tracks op de CD worden geschreven.</p></div><div class=paragraph><p>Het bestandssysteem ISO 9660 is ontworpen om met deze verschillen om te gaan. Helaas codeert het bestandssysteemgrenzen die destijds gebruikelijk waren. Gelukkig biedt het een uitbreidingsmechanisme dat correct geschreven CD’s toestaat om deze grenzen te overschrijden en nog steeds te werken met systemen die deze uitbreidingen niet ondersteunen.</p></div><div class=paragraph><p>De port <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> bevat <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, een programma dat gebruikt kan worden om een gegevensbestand aan te maken dat een ISO 9660-bestandssysteem bevat. Het bevat opties die verschillende uitbreidingen ondersteunen en wordt hieronder beschreven.</p></div><div class=paragraph><p>Het gereedschap om de CD te branden hangt af van het feit of de CD-brander ATAPI of iets anders is. ATAPI CD-branders gebruiken het programma <code>burncd</code> dat deel uitmaakt van het basissysteem. SCSI en USB CD-branders dienen <code>cdrecord</code> van de port <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> te gebruiken. Het is ook mogelijk om <code>cdrecord</code> en andere gereedschappen voor SCSI-drives op ATAPI-hardware te gebruiken door middel van de <a href=#atapicam>module ATAPI/CAM</a>.</p></div><div class=paragraph><p>Indien CD-brandsoftware met een grafische gebruikersinterface gewenst is, is X-CD-Roast of K3b een mogelijkheid. Deze gereedschappen zijn beschikbaar als package of vanuit de ports <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/xcdroast/>sysutils/xcdroast</a> en <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a>. X-CD-Roast en K3b hebben de <a href=#atapicam>module ATAPI/CAM</a> met ATAPI-hardware nodig.</p></div></div><div class=sect3><h4 id=mkisofs>19.6.2. mkisofs<a class=anchor href=#mkisofs></a></h4><div class=paragraph><p>Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, dat deel uitmaakt van de port <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a>, maakt een ISO 9660-bestandssysteem aan dat een beeld is van een boomstructuur in de UNIX® bestandssysteem-namespace. De eenvoudigste gebruiksvorm is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -o beeldbestand.iso /pad/naar/boomstructuur</span></code></pre></div></div><div class=paragraph><p>Dit commando maakt een <em>beeldbestand.iso</em> aan dat een ISO 9660-bestandssysteem bevat dat een kopie is van de boomstructuur in <em>/pad/naar/boomstructuur</em>. Tijdens het proces beeldt het bestandsnamen af op namen die aan de beperkingen van het standaard ISO 9660-bestandssysteem voldoen en sluit het bestanden uit die namen hebben die niet karakteristiek zijn voor ISO-bestandssystemen.</p></div><div class=paragraph><p>Er is een aantal opties beschikbaar om over deze beperkingen heen te komen. In het bijzonder zet <code>-R</code> de Rock Ridge-uitbreidingen aan die gangbaar zijn voor UNIX® systemen, zet <code>-J</code> de Rock Ridge-uitbreidingen aan die gebruikt worden op Microsoft-systemen en <code>-hfs</code> kan gebruikt worden om HFS-bestandssystemen aan te maken die door Mac OS® gebruikt worden.</p></div><div class=paragraph><p>Voor CD’s die alleen op FreeBSD-systemen gebruikt gaan worden, kan <code>-U</code> gebruikt worden om alle restricties op bestandsnamen uit te zetten. Indien het met <code>-R</code> gebruikt wordt, maakt het een bestandssysteembeeld aan dat identiek is aan de FreeBSD-boomstructuur van waaruit begonnen is, alhoewel het mogelijk is dat het zich op aantal manieren niet aan de ISO 9660-standaard houdt.</p></div><div class=paragraph><p>De laatste optie voor algemeen gebruik is <code>-b</code>. Deze wordt gebruikt om de plaats van het opstartbeeld aan te geven om een "El Torito" opstartbare CD te maken. Deze optie heeft een argument nodig, namelijk het pad naar een opstartbeeld dat het begin van de boomstructuur die naar de CD geschreven wordt voorstelt. Gewoonlijk maakt <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> een ISO-beeld aan in de zogenaamde "diskette-emulatie"-modus en verwacht het dus dat het beeldbestand exact 1200, 1440 of 2880 KB groot is. Sommige bootloaders, zoals degene die door de distributieschijven van FreeBSD wordt gebruikt, gebruiken de emulatiemodus niet. In dat geval dient de optie <code>-no-emul-boot</code> gebruikt te worden. Dus indien <span class=filename>/tmp/myboot</span> een opstartbaar FreeBSD-systeem met het beeldbestand in <span class=filename>/tmp/myboot/boot/cdboot</span> bevat, kan het beeld van een ISO 9660-bestandssysteem als volgt in <span class=filename>/tmp/bootable.iso</span> aangemaakt worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -R -no-emul-boot -b boot/cdboot -o /tmp/bootable.iso /tmp/myboot</span></code></pre></div></div><div class=paragraph><p>Als dit gedaan is en <span class=filename>md</span> in de kernel is ingesteld, kan het bestandssysteem gekoppeld worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /tmp/bootable.iso -u 0</span>
<span class=c># mount -t cd9660 /dev/md0 /mnt</span></code></pre></div></div><div class=paragraph><p>Nu kan gecontroleerd worden of <span class=filename>/mnt</span> en <span class=filename>/tmp/myboot</span> identiek zijn.</p></div><div class=paragraph><p>Er zijn vele andere opties die met <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> gebruikt kunnen worden om het gedrag af te stemmen. In het bijzonder wijzigingen aan een ISO 9660-structuur en het aanmaken van Joliet- en HFS-schijven. Details staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>.</p></div></div><div class=sect3><h4 id=burncd>19.6.3. burncd<a class=anchor href=#burncd></a></h4><div class=paragraph><p>Indien er een ATAPI CD-brander aanwezig is, kan het commando <code>burncd</code> gebruikt worden om een ISO-beeld naar een CD te branden. <code>burncd</code> maakt deel uit van het basissysteem en is geïnstalleerd als <span class=filename>/usr/sbin/burncd</span>. Het gebruik is erg eenvoudig, aangezien het weinig opties heeft.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f cd-apparaat gegevens beeldbestand.iso fixate</span></code></pre></div></div><div class=paragraph><p>Het bovenstaande commando brandt een kopie van <em>beeldbestand.iso</em> naar <em>cd-apparaat</em>. Het standaardapparaat is <span class=filename>/dev/acd0</span>. Opties om de schrijfsnelheid in te stellen, de CD na het branden uit te werpen en geluidsgegevens te schrijven staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=burncd&amp;sektion=8&amp;format=html">burncd(8)</a>.</p></div></div><div class=sect3><h4 id=cdrecord>19.6.4. cdrecord<a class=anchor href=#cdrecord></a></h4><div class=paragraph><p>Indien er geen ATAPI CD-brander aanwezig is, dient <code>cdrecord</code> gebruikt te worden om CD’s te branden. <code>cdrecord</code> maakt geen deel uit van het basissysteem. Het dient òfwel vanuit de port in <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> òfwel als package geïnstalleerd te worden. Veranderingen in het basissysteem kunnen ervoor zorgen dat binaire versies van dit programma falen, wat mogelijk tot een "coaster" leidt. Daarom dient òfwel de port bijgewerkt te worden als het systeem wordt bijgewerkt, òwel, als <a href=./#stable>-STABLE gevolgd</a> wordt, dient de port bijgewerkt te worden wanneer er een nieuwe versie beschikbaar komt.</p></div><div class=paragraph><p>Hoewel <code>cdrecord</code> vele opties heeft, is het gebruik voor gewone situaties nog eenvoudiger dan dat van <code>burncd</code>. Een ISO 9660-beeld kan gebrand worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord dev=device beeldbestand.iso</span></code></pre></div></div><div class=paragraph><p>Het lastige gedeelte in het gebruik van <code>cdrecord</code> is het vinden van de juiste <code>dev</code>. Om de juiste instelling te vinden, kan de vlag <code>-scanbus</code> van <code>cdrecord</code> gebruikt worden, wat resultaten zoals de onderstaande kan geven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord -scanbus</span>
Cdrecord-Clone  2.01 <span class=o>(</span>i386-unknown-freebsd7.0<span class=o>)</span> Copyright <span class=o>(</span>C<span class=o>)</span> 1995-2004 Jörg Schilling
Using libscg version <span class=s1>&#39;schily-0.1&#39;</span>
scsibus0:
        0,0,0     0<span class=o>)</span> <span class=s1>&#39;SEAGATE &#39;</span> <span class=s1>&#39;ST39236LW       &#39;</span> <span class=s1>&#39;0004&#39;</span> Disk
        0,1,0     1<span class=o>)</span> <span class=s1>&#39;SEAGATE &#39;</span> <span class=s1>&#39;ST39173W        &#39;</span> <span class=s1>&#39;5958&#39;</span> Disk
        0,2,0     2<span class=o>)</span> <span class=k>*</span>
        0,3,0     3<span class=o>)</span> <span class=s1>&#39;iomega  &#39;</span> <span class=s1>&#39;jaz 1GB         &#39;</span> <span class=s1>&#39;J.86&#39;</span> Removable Disk
        0,4,0     4<span class=o>)</span> <span class=s1>&#39;NEC     &#39;</span> <span class=s1>&#39;CD-ROM DRIVE:466&#39;</span> <span class=s1>&#39;1.26&#39;</span> Removable CD-ROM
        0,5,0     5<span class=o>)</span> <span class=k>*</span>
        0,6,0     6<span class=o>)</span> <span class=k>*</span>
        0,7,0     7<span class=o>)</span> <span class=k>*</span>
scsibus1:
        1,0,0   100<span class=o>)</span> <span class=k>*</span>
        1,1,0   101<span class=o>)</span> <span class=k>*</span>
        1,2,0   102<span class=o>)</span> <span class=k>*</span>
        1,3,0   103<span class=o>)</span> <span class=k>*</span>
        1,4,0   104<span class=o>)</span> <span class=k>*</span>
        1,5,0   105<span class=o>)</span> <span class=s1>&#39;YAMAHA  &#39;</span> <span class=s1>&#39;CRW4260         &#39;</span> <span class=s1>&#39;1.0q&#39;</span> Removable CD-ROM
        1,6,0   106<span class=o>)</span> <span class=s1>&#39;ARTEC   &#39;</span> <span class=s1>&#39;AM12S           &#39;</span> <span class=s1>&#39;1.06&#39;</span> Scanner
        1,7,0   107<span class=o>)</span> <span class=k>*</span></code></pre></div></div><div class=paragraph><p>Dit geeft de gepaste <code>dev</code>-waarden voor de apparaten in de lijst. De CD-brander dient gezocht te worden, waarna de drie getallen gescheiden door komma’s gebruikt kunnen worden als de waarde voor <code>dev</code>. In dit geval is het CD-RW-apparaat 1,5,0, dus is de juiste invoer <code>dev=1,5,0</code>. Er zijn eenvoudigere manieren om deze waarde te specificeren. In <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> staan meer details. Hier staat ook informatie over geluidstracks, de snelheid instellen en meer.</p></div></div><div class=sect3><h4 id=duplicating-audiocds>19.6.5. Audio-CD’s dupliceren<a class=anchor href=#duplicating-audiocds></a></h4><div class=paragraph><p>Een audio-CD kan gedupliceerd worden door de geluidsgegevens van de CD naar een serie bestanden te schrijven en deze bestanden daarna naar een lege CD te schrijven. Het proces verschilt licht tussen ATAPI- en SCSI-drives.</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: SCSI-drives</strong></p></div><div class="olist arabic"><ol class=arabic><li><p>Onttrek <code>cdda2wav</code> de audio:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdda2wav <span class=nt>-vall</span> <span class=nt>-D2</span>,0 <span class=nt>-B</span> <span class=nt>-Owav</span></code></pre></div></div></li><li><p>Schrijf met <code>cdrecord</code> de <span class=filename>.wav</span>-bestanden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdrecord <span class=nt>-v</span> <span class=nv>dev</span><span class=o>=</span>2,0 <span class=nt>-dao</span> <span class=nt>-useinfo</span> <span class=k>*</span>.wav</code></pre></div></div><div class=paragraph><p>Controleer of <em>2,0</em> juist is opgegeven, zoals beschreven in <a href=#cdrecord>cdrecord</a>.</p></div></li></ol></div></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: ATAPI-drives</strong></p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Met behulp van de <a href=#atapicam>ATAPI/CAM module</a> kan <code>cdda2wav</code> ook gebruikt worden voor ATAPI-drives. Dit gereedschap is vaak een betere keuze voor de meeste gebruikers (jitter-correctie, endianness-zaken, etc.) dan de methode die hieronder wordt voorgesteld.</p></div></td></tr></tbody></table></div><div class="olist arabic"><ol class=arabic><li><p>Het ATAPI CD-stuurprogramma maakt elke track beschikbaar als <span class=filename>/dev/acddtnn</span>, waarin <em>d</em> het stationsnummer is en <em>nn</em> het tracknummer is in twee decimale cijfers, dat indien nodig vooraf wordt gegaan door een nul. Dus is de eerste track op de eerste schijf <span class=filename>/dev/acd0t01</span>, de tweede <span class=filename>/dev/acd0t02</span>, de derde <span class=filename>/dev/acd0t03</span>, enzovoort.</p><div class=paragraph><p>Controleer of de juiste bestanden in <span class=filename>/dev</span> bestaan. Als de benodigde namen er niet bijstaan, forceer het systeem dan om opnieuw te kijken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=/dev/null count=1</span></code></pre></div></div></li><li><p>De track kan met <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a> onttrokken worden. Bij het onttrekken van de bestanden dient een specifieke blokgrootte gebruikt te worden.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0t01 of=track1.cdr bs=2352</span>
<span class=c>#dd if=/dev/acd0t02 of=track2.cdr bs=2352</span>
...</code></pre></div></div></li><li><p>Brand de onttrokken bestanden met <code>burncd</code>. Er dient opgegeven te worden dat het geluidsbestanden zijn en dat <code>burncd</code> de schijf moet fixeren wanneer na afronding van het proces.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd0 audio track1.cdr track2.cdr ... fixate</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=imaging-cd>19.6.6. Gegevens-CD’s dupliceren<a class=anchor href=#imaging-cd></a></h4><div class=paragraph><p>Een gegevens-CD kan gekopieerd worden naar een beeldbestand dat functioneel gelijk is aan het beeldbestand dat met <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> gemaakt is en het kan gebruikt worden om elke gegevens-CD te dupliceren. Het hier gegeven voorbeeld neemt aan dat het CD-ROM-apparaat <span class=filename>acd0</span> is.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=bestand.iso bs=2048</span></code></pre></div></div><div class=paragraph><p>Nu het beeld beschikbaar is, kan het naar CD geschreven worden zoals hierboven beschreven.</p></div></div><div class=sect3><h4 id=mounting-cd>19.6.7. Gegevens-CD’s gebruiken<a class=anchor href=#mounting-cd></a></h4><div class=paragraph><p>Nu er een standaard gegevens-CD-ROM is aangemaakt moet deze waarschijnlijk aangekoppeld worden om de gegevens die er op staan te lezen. Normaalgesproken neemt <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> aan dat een bestandssysteem van het soort <code>ufs</code> is. Als zoiets als onderstaande geprobeerd wordt komt er een klacht over <code>Incorrect super block</code> en wordt er niet aangekoppeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>De CD-ROM bevat geen <code>UFS</code>-bestandssysteem, dus pogingen om zo aan te koppelen mislukken. Er dient aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> verteld te worden dat het bestandssysteem van het soort <code>ISO9660</code> is en dan werkt alles. Dit kan door de optie <code>-t cd9660</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> op te geven. Het CD-ROM-apparaat <span class=filename>/dev/cd0</span> onder <span class=filename>/mnt</span> aankoppelen kan zo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>De apparaatnaam (in dit voorbeeld <span class=filename>/dev/cd0</span>) kan afwijken, afhankelijk van de interface die de CD-ROM gebruikt. Verder voert de optie <code>-t cd9660</code> gewoon <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a> uit. Bovenstaand voorbeeld kan verkort worden tot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount_cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Het is in het algemeen mogelijk om gegevens-CD-ROMs van elke fabrikant op deze manier te gebruiken. Schijven met bepaalde uitbreidingen op ISO 9660 kunnen zich echter vreemd gedragen. Joliet-schijven bijvoorbeeld, slaan alle bestandsnamen op in twee-byte Unicode-karakters. De FreeBSD-kernel spreekt geen Unicode, maar het FreeBSD CD9660 stuurprogramma is in staat om Unicode karakters direct te converteren. Als er niet-Engelse karakters verschijnen als vraagtekens, moet de lokale karakterset gedefinieerd worden met de <code>-C</code> optie. Zie de <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a> handleiding voor meer informatie.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Om in staat te zijn om de karakter conversie te doen met behulp van de <code>-C</code> optie, heeft de kernel de <span class=filename>cd9660_iconv.ko</span> module nodig. Deze kan ingeladen worden door het volgende toe te voegen aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>cd9660_iconv_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>en daarna de machine te herstarten of door de module direct in te laden met <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Zo nu en dan kan <code>Device not configured</code> verschijnen als geprobeerd wordt om een CD-ROM aan te koppelen. Dit betekent meestal dat het CD-ROM-station denkt dat er geen schijf in de lade ligt of dat het station niet zichtbaar is op de bus. Omdat het enkele seconden kan duren voordat een CD-ROM-station doorheeft dat er een CD-ROM in ligt, is geduld geboden.</p></div><div class=paragraph><p>Soms wordt een SCSI CD-ROM gemist omdat het station niet genoeg tijd had om antwoord te geven op de busreset. Indien er een SCSI CD-ROM aanwezig is, dient de volgende optie aan de kernelinstellingen toegevoegd te worden en de <a href=./#kernelconfig-building>kernel opnieuw gebouwd</a> te worden.</p></div><div class="literalblock programlisting"><div class=content><pre>options SCSI_DELAY=15000</pre></div></div><div class=paragraph><p>Dit zorgt ervoor dat de SCSI-bus 15 seconden pauzeert tijdens het opstarten opdat het CD-ROM-station elke gelegenheid krijgt om de busreset te beantwoorden.</p></div></div><div class=sect3><h4 id=rawdata-cd>19.6.8. Rauwe gegevens-CD’s branden<a class=anchor href=#rawdata-cd></a></h4><div class=paragraph><p>Een bestand kan direct naar CD geschreven worden zonder een ISO 9660-bestandssysteem aan te maken. Sommige mensen doen dit voor back-updoeleinden. Dit gaat sneller dan een standaard-CD branden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd1 -s 12 gegevens archief.tar.gz fixate</span></code></pre></div></div><div class=paragraph><p>Om de gegevens terug te halen die op zo’n CD gebrand zijn, is het noodzakelijk om gegevens van de rauwe apparaatnode te lezen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar xzvf /dev/acd1</span></code></pre></div></div><div class=paragraph><p>Het is niet mogelijk om deze schijf aan te koppelen zoals dat voor een normale CD-ROM gedaan wordt. Zo’n CD-ROM kan onder geen enkel besturingssysteem, behalve FreeBSD, gelezen worden. Om de CD aan te kunnen koppelen of gegevens te delen met een ander besturingssysteem, dient <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> gebruikt te worden, zoals boven beschreven is.</p></div></div><div class=sect3><h4 id=atapicam>19.6.9. Het ATAPI/CAM-stuurprogramma gebruiken<a class=anchor href=#atapicam></a></h4><div class=paragraph><p>Dit stuurprogramma stelt ATAPI-apparaten (CD-ROM, CD-RW, DVD-stations, enzovoort) in staat om vanuit het SCSI-subsysteem benaderd te worden en maakt daarmee het gebruik van applicaties zoals <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrdao/>sysutils/cdrdao</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> mogelijk.</p></div><div class=paragraph><p>Om dit stuurprogramma te gebruiken, is het noodzakelijk om de volgende regel aan het <span class=filename>/boot/loader.conf</span> bestand toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>atapicam_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>om daarna de machine opnieuw op te starten.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als het noodzakelijk is om <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> statisch toe te voegen aan de kernel moet de volgende regel worden toegevoegd aan het kernelinstellingenbestand:</p></div><div class="literalblock programlisting"><div class=content><pre>device atapicam</pre></div></div><div class=paragraph><p>Ook zijn de volgende regels in het kernelinstellingenbestand nodig, die meestal wel aanwezig zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>device ata
device scbus
device cd
device pass</pre></div></div><div class=paragraph><p>Hierna dient de nieuwe kernel opnieuw gebouwd en geïnstalleerd te worden en dient de machine opnieuw gestart te worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Tijdens het opstartproces dient de brander als volgt te verschijnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>acd0: CD-RW &lt;MATSHITA CD-RW/DVD-ROM UJDA740&gt; at ata1-master PIO4
cd0 at ata1 bus 0 target 0 lun 0
cd0: &lt;MATSHITA CD-RW/DVD UJDA740 1.00&gt; Removable CD-ROM SCSI-0 device
cd0: 16.000MB/s transfers
cd0: Attempt to query device size failed: NOT READY, Medium not present - tray closed</code></pre></div></div><div class=paragraph><p>Het station is nu toegankelijk via de apparaatnaam <span class=filename>/dev/cd0</span>. Om bijvoorbeeld een CD-ROM op <span class=filename>/mnt</span> aan te koppelen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Als <code>root</code> kan het volgende commando gegeven worden om het SCSI-adres van de brander te verkrijgen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;MATSHITA CD-RW/DVD UJDA740 1.00&gt; at scbus1 target 0 lun 0 <span class=o>(</span>pass0,cd0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Dus <code>1,0,0</code> is het SCSI-adres dat met <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> en andere SCSI-toepassingen gebruikt dient te worden.</p></div><div class=paragraph><p>Meer informatie over het ATAPI/CAM en het SCSI-systeem staat in de hulppagina’s van <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=cam&amp;sektion=4&amp;format=html">cam(4)</a>.</p></div></div></div><div class=sect2><h3 id=creating-dvds>19.7. Optische media (DVD’s) aanmaken en gebruiken<a class=anchor href=#creating-dvds></a></h3><div class=sect3><h4 id=_inleiding_4>19.7.1. Inleiding<a class=anchor href=#_inleiding_4></a></h4><div class=paragraph><p>Vergeleken met de CD behoort de DVD de tot de volgende generatie van optische media-opslagtechnologie. De DVD kan meer gegevens bevatten dan enige CD en is tegenwoordig de standaard voor videopublicatie.</p></div><div class=paragraph><p>Er kunnen vijf fysieke opneembare formaten gedefinieerd worden die opneembare DVD heten:</p></div><div class=ulist><ul><li><p>DVD-R: dit was het eerst beschikbare opneembare DVD-formaat. De DVD-R-standaard is gedefinieerd door het <a href=http://www.dvdforum.com/forum.shtml>DVD Forum</a>. Dit formaat is voor eenmalig schrijven.</p></li><li><p>DVD-RW: dit is de herschrijfbare versie van de DVD-R-standaard. Een DVD-RW kan tot ongeveer 1.000 maal herschreven worden.</p></li><li><p>DVD-RAM: dit is ook een herschrijfbaar formaat dat door het DVD Forum ondersteund wordt. Een DVD-RAM kan gezien worden als een verwisselbare harde schijf. Dit medium is echter niet uitwisselbaar met de meeste DVD-ROM-stations en DVD-Video-spelers. Slechts enkele DVD-schrijvers ondersteunen het DVD-RAM-formaat. Lees <a href=#creating-dvd-ram>DVD-RAM gebruiken</a> voor meer informatie over het gebruik van DVD-RAM.</p></li><li><p>DVD+RW: dit is het herschrijfbare formaat dat is gedefinieerd door de <a href=http://www.dvdrw.com/>DVD+RW Alliance</a>. Een DVD+RW kan tot ongeveer 1.000 maal herschreven worden.</p></li><li><p>DVD+R: dit formaat is de eenmalig beschrijfbare versie van het DVD+RW-formaat.</p></li></ul></div><div class=paragraph><p>Een enkellaags opneembare DVD kan maximaal 4.700.000.000 bytes bevatten, wat eigenlijk 4,38 GB of 4.485 MB is (1 kB is 1024 bytes).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er dient onderscheid gemaakt te worden tussen het fysieke medium en de toepassing. Een DVD-Video bijvoorbeeld is een specifiek bestandsschema dat op elk fysiek opneembaar DVD-medium geschreven kan worden: DVD-R, DVD+R, DVD-RW, enzovoort. Voordat het mediumtype gekozen wordt, dient het zeker te zijn dat zowel de brander als de DVD-Video-speler (een onafhankelijke speler of een DVD-ROM-station in een computer) overweg kunnen met het overwogen medium.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_instellingen>19.7.2. Instellingen<a class=anchor href=#_instellingen></a></h4><div class=paragraph><p>Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> wordt gebruikt om DVD’s op te nemen. Dit commando is deel van de dvd+rw-tools gereedschappen (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/dvd+rw-tools/>sysutils/dvd+rw-tools</a>). dvd+rw-tools ondersteunt alle types DVD-media.</p></div><div class=paragraph><p>Deze gereedschappen gebruiken het SCSI-subsysteem om toegang tot de apparaten te krijgen, daarvoor moet <a href=#atapicam>ondersteuning voor ATAPI/CAM</a> aan de kernel toegevoegd worden. Indien de brander de USB-interface gebruikt, is deze toevoeging nutteloos en dient <a href=#usb-disks>USB-opslagapparaten</a> gelezen te worden voor meer details over het instellen van USB-apparaten.</p></div><div class=paragraph><p>De DMA-toegang voor ATAPI-apparaten dient ook aangezet te worden door de volgende regel aan het bestand <span class=filename>/boot/loader.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div><div class=paragraph><p>Voordat de dvd+rw-tools gebruikt kunnen worden, dienen de <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/hcn.html>dvd+rw-tools' hardware compatibility notes</a> geraadpleegd te worden voor enige informatie die betrekking heeft op de DVD-brander.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien een grafische gebruikersinterface gewenst is, is K3b (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a>), die een gebruikersvriendelijke interface biedt voor <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> en vele andere brandprogramma’s, het bekijken waard.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_gegevens_dvds_branden>19.7.3. Gegevens-DVD’s branden<a class=anchor href=#_gegevens_dvds_branden></a></h4><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> is een frontend voor <a href=#mkisofs>mkisofs</a>. Het roept <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> aan om het bestandssysteemoverzicht aan te maken en het schrijft naar de DVD. Hierdoor is het niet nodig om een beeld van de gegevens aan te maken voordat met branden begonnen wordt.</p></div><div class=paragraph><p>Om de gegevens uit de map <span class=filename>/pad/naar/gegevens</span> op een DVD+R of een DVD-R te branden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0 -J -R /pad/naar/gegevens</span></code></pre></div></div><div class=paragraph><p>De opties <code>-J -R</code> worden doorgegeven aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> voor het aanmaken van het bestandssysteem (in dit geval een ISO 9660-bestandssysteem met Joliet en Rock Ridge uitbreidingen). Meer details staan in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>.</p></div><div class=paragraph><p>De optie <code>-Z</code> wordt gebruikt voor het opnemen van de eerste sessie, ook bij meerdere sessies. Het DVD-apparaat, <em>/dev/cd0</em>, dient aan de hand van de instellingen aangepast te worden. De parameter <code>-dvd-compat</code> sluit de schijf zodat er niets aan de opname toegevoegd kan worden. Dit zou als tegenprestatie betere uitwisselbaarheid met DVD-ROM-stations moeten geven.</p></div><div class=paragraph><p>Het is ook mogelijk om een vooraf gemastered beeld te branden, om bijvoorbeeld het beeld <em>beeldbestand.iso</em> te branden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0=beeldbestand.iso</span></code></pre></div></div><div class=paragraph><p>De schrijfsnelheid moet automatisch gedetecteerd en ingesteld worden, afhankelijk van het medium en het gebruikte station. Om de schrijfsnelheid te forceren, dient de parameter <code>-speed=</code> gebruikt te worden. Meer informatie staat in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Om bestanden groter dan 4,38GB in de compilatie op te nemen dient een UDF/ISO-9660 hybride bestandssysteem aangemaakt te worden door de aanvullende parameter <code>-udf -iso-level 3</code> aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> en alle gerelateerde programma’s (i.e., <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>) door te geven. Dit is alleen nodig als een ISO beeldbestand wordt aangemaakt, of als bestanden direct naar een schijf worden geschreven. Schijven die op deze manier zijn aangemaakt moeten als een UDF-bestandssysteem worden aangekoppeld met het hulpmiddel <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_udf&amp;sektion=8&amp;format=html">mount_udf(8)</a>, zodat het alleen bruikbaar is op een besturingssysteem dat zich van UDF bewust is, anders zal het lijken of er corrupte bestanden op staan.</p></div><div class=paragraph><p>Om zo’n ISO-bestand aan te maken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mkisofs <span class=nt>-R</span> <span class=nt>-J</span> <span class=nt>-udf</span> <span class=nt>-iso-level</span> 3 <span class=nt>-o</span> beeldbestand.iso /pad/naar/gegevens</code></pre></div></div><div class=paragraph><p>Om de bestanden direct naar een schijf te schrijven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -udf -iso-level 3 -Z /dev/cd0 -J -R /pad/naar/gegevens</span></code></pre></div></div><div class=paragraph><p>Wanneer u een ISO-beeld heeft dat al grote bestanden bevat, zijn er geen extra opties nodig om met <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> het beeld naar een schijf te schrijven.</p></div><div class=paragraph><p>Zorg er ook voor dat u een actuele versie van <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> heeft (welke <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> bevat), aangezien oudere versies geen ondersteuning voor grote bestanden bieden. Als u problemen tegenkomt, gebruik dan de ontwikkelversie, <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools-devel/>sysutils/cdrtools-devel</a> en lees de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_dvd_video_branden>19.7.4. DVD-Video branden<a class=anchor href=#_dvd_video_branden></a></h4><div class=paragraph><p>Een DVD-Video is een specifiek bestandsschema dat gebaseerd is op de ISO 9660 en de micro-UDF (M-UDF) specificaties. DVD-Video heeft ook een specifieke hiërarchie voor de gegevensstructuur, de reden waarom een speciaal programma zoals <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/dvdauthor/>multimedia/dvdauthor</a> nodig is om de DVD te schrijven.</p></div><div class=paragraph><p>Indien er reeds een beeld van het bestandssysteem van de DVD-Video beschikbaar is, kan het zoals elk ander beeld gebrand worden. In de vorige sectie staat een voorbeeld. Als het resultaat voor de inhoud voor de DVD bijvoorbeeld in de map <span class=filename>/pad/naar/video</span> staat, kan de DVD-Video als volgt gebrand worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -dvd-video /pad/naar/video</span></code></pre></div></div><div class=paragraph><p>De optie <code>-dvd-video</code> wordt doorgegeven aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> en geeft het opdracht om een bestandssysteemschema voor een DVD-Video aan te maken. Verder impliceert de optie <code>-dvd-video</code> de optie <code>-dvd-compat</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>.</p></div></div><div class=sect3><h4 id=_dvdrw_gebruiken>19.7.5. DVD+RW gebruiken<a class=anchor href=#_dvdrw_gebruiken></a></h4><div class=paragraph><p>In tegenstelling tot een CD-RW dient een nieuwe DVD+RW voor het eerste gebruik geformatteerd te worden. Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> regelt dit automatisch als nodig. Dit is de <em>aanbevolen</em> manier. Het is ook mogelijk om <code>dvd+rw-format</code> te gebruiken om een DVD+RW te formatteren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Deze operatie hoeft slechts één maal uitgevoerd te worden. Onthoud dat alleen nieuwe DVD+RW-media geformatteerd dienen te worden. Daarna is het mogelijk om de DVD+RW op dezelfde manier te branden zoals in bovenstaande secties staat vermeldt.</p></div><div class=paragraph><p>Om nieuwe gegevens op een DVD+RW te branden (een geheel nieuw bestandssysteem branden, niet wat gegevens toevoegen), is het niet nodig om deze te wissen. Het is voldoende om de vorige opname te overschrijven (tijdens het aanmaken van een initiële sessie), zoals hieronder:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /pad/naar/nieuwe gegevens</span></code></pre></div></div><div class=paragraph><p>Het DVD+RW-formaat biedt de mogelijkheid om eenvoudig nieuwe gegevens aan een vorige opname toe te voegen. De operatie bestaat uit het samenvoegen van een nieuwe sessie en de bestaande. Het is geen multisessie-schrijven. <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> laat het ISO 9660-bestandssysteem dat aanwezig is op het medium <em>groeien</em>.</p></div><div class=paragraph><p>Om gegevens aan de vorige DVD+RW toe te voegen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /pad/naar/volgende gegevens</span></code></pre></div></div><div class=paragraph><p>Dezelfde opties van <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> die gebruikt werden om de initiële sessie te branden, dienen gebruikt te worden tijdens schrijfsessies.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De optie <code>-dvd-compat</code> kan gebruikt worden als betere uitwisselbaarheid met DVD-ROM-stations gewenst is. In het geval van een DVD+RW verhindert dit het toevoegen van gegevens niet.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om het medium te wissen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0=/dev/zero</span></code></pre></div></div></div><div class=sect3><h4 id=_dvd_rw_gebruiken>19.7.6. DVD-RW gebruiken<a class=anchor href=#_dvd_rw_gebruiken></a></h4><div class=paragraph><p>Een DVD-RW accepteert twee schijfformaten: de incrementele sequentiële en beperkt overschrijven. Standaard zijn DVD-RW-schijven in het sequentiële formaat.</p></div><div class=paragraph><p>Een nieuwe DVD-RW kan direct beschreven worden zonder deze te formatteren. Een gebruikte DVD-RW in sequentieel formaat dient echter gewist te worden voordat het mogelijk is om een nieuwe initiële sessie te schrijven.</p></div><div class=paragraph><p>Om een DVD-RW in sequentiële toestand te wissen, dient het volgende gedaan te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Volledig wissen (<code>-blank=full</code>) neemt ongeveer één uur in beslag op een 1x-medium. Het is mogelijk om snel te wissen door gebruik te maken van de optie <code>blank</code> als de DVD-RW in Disk-At-Once-modus (DAO) wordt opgenomen. Om de DVD-RW in DAO-modus te branden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -use-the-force-luke=dao -Z /dev/cd0=beeldbestand.iso</span></code></pre></div></div><div class=paragraph><p>De optie <code>-use-the-force-luke=dao</code> is niet nodig aangezien <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> probeert om minimale (snel gewiste) media te detecteren en gebruik te maken van DAO-schrijven.</p></div><div class=paragraph><p>Eigenlijk moet beperkt overschrijven gebruikt worden met elke DVD-RW. Dit formaat is flexibeler dan het standaard incrementeel sequentiële.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om gegevens op een sequentiële DVD-RW te schrijven, worden dezelfde instructies gebruikt als voor de andere DVD-formaten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /pad/naar/gegevens</span></code></pre></div></div><div class=paragraph><p>Om wat gegevens aan de vorige opname toe te voegen, dient de optie <code>-M</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> gebruikt te worden. Als echter gegevens aan een DVD-RW in incrementeel sequentiële modus worden toegevoegd, wordt een nieuwe sessie op de schijf aangemaakt wat resulteert in een multisessie schijf.</p></div><div class=paragraph><p>Een DVD-RW in het beperkt overschrijven formaat hoeft niet gewist te worden vóór een nieuwe initiële sessie. Het is voldoende om de schijf te overschrijven met de optie <code>-Z</code>, wat analoog is aan het geval van de DVD+RW. Het is ook mogelijk om een bestaand ISO 9660-bestandssysteem te laten groeien op soortgelijke wijze als voor een DVD+RW met de optie <code>-M</code>. Het resultaat is een enkelsessie DVD.</p></div><div class=paragraph><p>Om een DVD-RW in het beperkt overschrijven-formaat te zetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Om terug te gaan naar het sequentiële formaat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div></div><div class=sect3><h4 id=_multisessie>19.7.7. Multisessie<a class=anchor href=#_multisessie></a></h4><div class=paragraph><p>Multisessie DVD’s worden door zeer weinig DVD-ROM-stations geaccepteerd en meestal lezen ze hopelijk tenminste de eerste sessie. DVD+R, DVD-R en DVD-RW kunnen in het sequentiële formaat meerdere sessies accepteren. Het idee van meerdere sessies bestaat niet voor de formaten DVD+RW en DVD-RW in beperkt overschrijven.</p></div><div class=paragraph><p>Om een nieuwe sessie achter een initiële (niet-gesloten) sessie op een DVD+R, DVD-R of DVD-RW in sequentieel formaat toe te voegen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /pad/naar/volgende gegevens</span></code></pre></div></div><div class=paragraph><p>Het gebruik van dit commando met een DVD+RW of een DVD-RW in beperkt overschrijven-formaat voegt gegevens toe door de nieuwe sessie samen te voegen met de bestaande. Dit leidt tot een enkelsessie schijf. Deze manier kan gebruikt worden om gegevens achter een initiële sessie aan deze media toe te voegen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Op deze media wordt wat ruimte gebruikt tussen elke sessie om het einde en begin van de sessies aan te geven. Daarom dienen sessies met grote hoeveelheden gegevens toegevoegd te worden om de mediaruimte te optimaliseren. Het aantal sessies is beperkt tot 154 voor een DVD+R, ongeveer 2000 voor een DVD-R en 127 voor een dubbellaags DVD+R.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_meer_informatie_2>19.7.8. Meer informatie<a class=anchor href=#_meer_informatie_2></a></h4><div class=paragraph><p>Om meer informatie over een DVD te verkrijgen kan het commando <code>dvd+rw-mediainfo /dev/cd0</code> met de schijf in het station gebruikt worden.</p></div><div class=paragraph><p>Meer informatie over dvd+rw-tools staat in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>, op de <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/>dvd+rw-tools website</a> en in de archieven van de <a href=http://lists.debian.org/cdwrite/>cdwrite mailing list</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De uitvoer van <code>dvd+rw-mediainfo</code> met betrekking tot de resulterende opname of het medium met problemen is verplicht voor elk probleemrapport. Zonder deze uitvoer volgt geen hulp.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=creating-dvd-ram>19.7.9. DVD-RAM gebruiken<a class=anchor href=#creating-dvd-ram></a></h4><div class=sect4><h5 id=_configuratie>19.7.9.1. Configuratie<a class=anchor href=#_configuratie></a></h5><div class=paragraph><p>DVD-RAM schrijvers komen met of een SCSI of een ATAPI interface. DMA toegang voor ATAPI apparaten moet worden ingeschakeld, wat gedaan kan worden door de volgende regel toe te voegen aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div></div><div class=sect4><h5 id=_voorbereiden_van_het_medium>19.7.9.2. Voorbereiden van het medium<a class=anchor href=#_voorbereiden_van_het_medium></a></h5><div class=paragraph><p>Zoals vermeld in de introductie van dit hoofdstuk kan DVD-RAM gezien worden als een verwijderbare harde schijf. Zoals elke andere harde schijf moet de DVD-RAM "voorbereid" worden voor het eerste gebruik. In het voorbeeld wordt alle beschikbare ruimte gebruikt voor een standaard UFS2 bestandssysteem:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/acd0 bs=2k count=1</span>
<span class=c># bsdlabel -Bw acd0</span>
<span class=c># newfs /dev/acd0</span></code></pre></div></div><div class=paragraph><p>Het DVD apparaat, <span class=filename>acd0</span> moet worden gewijzigd naar gelang de configuratie.</p></div></div><div class=sect4><h5 id=_het_medium_gebruiken>19.7.9.3. Het medium gebruiken<a class=anchor href=#_het_medium_gebruiken></a></h5><div class=paragraph><p>Zodra de voorgaande operaties uitgevoerd zijn op de DVD-RAM kan het gekoppeld worden net als een normale harde schijf:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/acd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Hierna zal de DVD-RAM zowel lees- als beschrijfbaar zijn.</p></div></div></div></div><div class=sect2><h3 id=floppies>19.8. Diskettes aanmaken en gebruiken<a class=anchor href=#floppies></a></h3><div class=paragraph><p>Soms is het opslaan van gegevens op een diskette nuttig, bijvoorbeeld als er geen andere verwijderbare opslagmedia beschikbaar zijn of als kleine hoeveelheden gegevens naar een andere computer moeten worden overgedragen.</p></div><div class=paragraph><p>In deze sectie wordt beschreven hoe diskettes in FreeBSD gebruikt dienen te worden. Hier worden hoofdzakelijk het formatteren en gebruik van 3,5 inch DOS-diskettes behandeld, maar de concepten zijn vergelijkbaar voor andere disketteformaten.</p></div><div class=sect3><h4 id=_diskettes_formatteren>19.8.1. Diskettes formatteren<a class=anchor href=#_diskettes_formatteren></a></h4><div class=sect4><h5 id=_het_apparaat>19.8.1.1. Het apparaat<a class=anchor href=#_het_apparaat></a></h5><div class=paragraph><p>Diskettes worden benaderd door ingangen in <span class=filename>/dev</span> net zoals andere apparaten. Om een rauwe floppy te benaderen gebruikt u <span class=filename>/dev/fdN</span>.</p></div></div><div class=sect4><h5 id=_formatteren>19.8.1.2. Formatteren<a class=anchor href=#_formatteren></a></h5><div class=paragraph><p>Een diskette dient op laag niveau geformatteerd te worden voordat deze kan worden gebruikt. Dit wordt meestal door de fabrikant gedaan, maar formatteren is een goede manier om de integriteit van het medium te controleren. Hoewel het mogelijk is om grotere (of kleinere) schijfgroottes te forceren, zijn de meeste diskettes ontworpen voor 1440kB.</p></div><div class=paragraph><p>Een diskette kan op laag niveau geformatteerd worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=fdformat&amp;sektion=1&amp;format=html">fdformat(1)</a>. Dit gereedschap verwacht de apparaatnaam als parameter.</p></div><div class=paragraph><p>Op basis van eventuele foutmeldingen kan bepaald worden of een schijf goed of slecht is.</p></div><div class=sect5><h6 id=_formatteren_van_floppies>19.8.1.2.1. Formatteren van floppies<a class=anchor href=#_formatteren_van_floppies></a></h6><div class=paragraph><p>Voor het formatteren van de diskette dienen de apparaten <span class=filename>/dev/fdN</span> gebruikt te worden. Nadat een 3,5 inch diskette in het station is gestoken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/sbin/fdformat -f 1440 /dev/fd0</span></code></pre></div></div></div></div></div><div class=sect3><h4 id=_schijflabels>19.8.2. Schijflabels<a class=anchor href=#_schijflabels></a></h4><div class=paragraph><p>Nadat de diskette op laag niveau is geformatteerd, dient er schijflabel aan gekoppeld te worden. Dit schijflabel wordt later vernietigd, maar het systeem heeft het nodig om later de grootte en de geometrie van de schijf te bepalen.</p></div><div class=paragraph><p>Het nieuwe schijflabel neemt de gehele schijf over en bevat alle benodigde informatie over de geometrie van de diskette. De geometriewaarden van het schijflabel staan vermeld in <span class=filename>/etc/disktab</span>.</p></div><div class=paragraph><p>Nu kan <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> als volgt gedraaid worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/bsdlabel -B -w /dev/fd0 fd1440</span></code></pre></div></div></div><div class=sect3><h4 id=_bestandssystemen>19.8.3. Bestandssystemen<a class=anchor href=#_bestandssystemen></a></h4><div class=paragraph><p>Nu is de diskette klaar om op hoog niveau geformatteerd te worden. Hiermee wordt een nieuw bestandssysteem opgezet, wat FreeBSD in staat stelt om naar de schijf te lezen en te schrijven. Nadat het nieuwe bestandssysteem is aangemaakt, wordt het schijflabel vernietigd, dus om de schijf te herformatteren is het noodzakelijk om het schijflabel opnieuw aan te maken.</p></div><div class=paragraph><p>Het bestandssysteem voor diskettes kan zowel UFS als FAT zijn. FAT is over het algemeen een betere keuze voor diskettes.</p></div><div class=paragraph><p>Om een nieuw bestandssysteem op de diskettes te zetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/newfs_msdos /dev/fd0</span></code></pre></div></div><div class=paragraph><p>De schijf is nu klaar voor gebruik.</p></div></div><div class=sect3><h4 id=_diskettes_gebruiken>19.8.4. Diskettes gebruiken<a class=anchor href=#_diskettes_gebruiken></a></h4><div class=paragraph><p>Om de diskette te gebruiken kan <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> gebruikt worden om het medium aan te koppelen. Ook kan <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/mtools/>emulators/mtools</a> uit de Portscollectie worden gebruikt.</p></div></div></div><div class=sect2><h3 id=backups-tapebackups>19.9. Gegevensbanden aanmaken en gebruiken<a class=anchor href=#backups-tapebackups></a></h3><div class=paragraph><p>Bandtechnologie is zich blijven ontwikkelen maar het is minder waarschijnlijk dat het in moderne systemen wordt gebruikt. Moderne back-upsystemen neigen om offsite gecombineerd met technologieën voor plaatselijke verwisselbare schijfstations te gebruiken. FreeBSD zal nog steeds elk bandstation dat SCSI gebruikt zoals LTO en oudere apparaten zoals DAT ondersteunen. Er is ook beperkte ondersteuning voor SATA- en USB-bandstations.</p></div><div class=sect3><h4 id=tapes-sa0>19.9.1. Seriële toegang met <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=4&amp;format=html">sa(4)</a><a class=anchor href=#tapes-sa0></a></h4><div class=paragraph><p>FreeBSD gebruikt het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=4&amp;format=html">sa(4)</a>, dat <span class=filename>/dev/sa0</span>, <span class=filename>/dev/nsa0</span> en <span class=filename>/dev/esa0</span> aanbiedt. Voor normaal gebruik is alleen <span class=filename>/dev/sa0</span> nodig. <span class=filename>/dev/nsa0</span> is fysiek hetzelfde apparaat als <span class=filename>/dev/sa0</span> maar spoelt de band niet terug nadat een bestand is geschreven. Dit maakt het mogelijk om meer dan één bestand naar een band te schrijven. <span class=filename>/dev/esa0</span> werpt, indien van toepassing, de band uit nadat het apparaat is gesloten.</p></div></div><div class=sect3><h4 id=_het_bandstation_met_mt1_beheren>19.9.2. Het bandstation met <a href="https://man.freebsd.org/cgi/man.cgi?query=mt&amp;sektion=1&amp;format=html">mt(1)</a> beheren<a class=anchor href=#_het_bandstation_met_mt1_beheren></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mt&amp;sektion=1&amp;format=html">mt(1)</a> is het hulpmiddel van FreeBSD om andere bewerkingen op het bandstation uit te voeren, zoals bestanden op een band doorzoeken of controlepunten naar de band schrijven.</p></div><div class=paragraph><p>Als voorbeeld kunnen de eerste drie bestanden op een band bewaard worden door ze over te slaan voordat een nieuw bestand wordt geschreven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mt -f /dev/nsa0 fsf 3</span></code></pre></div></div></div><div class=sect3><h4 id=_tar1_gebruiken_om_back_ups_op_banden_te_lezen_en_schrijven>19.9.3. <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> gebruiken om back-ups op banden te lezen en schrijven<a class=anchor href=#_tar1_gebruiken_om_back_ups_op_banden_te_lezen_en_schrijven></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> gebruiken om een enkel bestand naar band te schrijven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar cvf /dev/sa0 bestand</span></code></pre></div></div><div class=paragraph><p>Bestanden vanuit een <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a>-archief op band naar de huidige map herstellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar xvf /dev/sa0</span></code></pre></div></div></div><div class=sect3><h4 id=_dump8_en_restore8_gebruiken_om_back_ups_aan_te_maken_en_te_herstellen>19.9.4. <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a> gebruiken om back-ups aan te maken en te herstellen<a class=anchor href=#_dump8_en_restore8_gebruiken_om_back_ups_aan_te_maken_en_te_herstellen></a></h4><div class=paragraph><p>Een eenvoudige back-up van <span class=filename>/usr</span> maken met <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dump -0aL -b64 -f /dev/nsa0 /usr</span></code></pre></div></div><div class=paragraph><p>Interactief bestanden van een <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>-bestand vanaf band naar de huidige map herstellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># restore -i -f /dev/nsa0</span></code></pre></div></div></div><div class=sect3><h4 id=_andere_bandsoftware>19.9.5. Andere bandsoftware<a class=anchor href=#_andere_bandsoftware></a></h4><div class=paragraph><p>Er zijn programma’s op hoger niveau beschikbaar om het back-uppen naar banden eenvoudiger te maken. De populairste zijn AMANDA en Bacula. Deze programma’s hebben als doel om back-uppen eenvoudiger en aangenamer te maken, of om complexe back-ups van meerdere machines te automatiseren. De Portscollectie bevat deze beide en andere toepassingen om met banden te werken.</p></div></div></div><div class=sect2><h3 id=backups-floppybackups>19.10. Naar diskettes back-uppen<a class=anchor href=#backups-floppybackups></a></h3><div class=sect3><h4 id=floppies-using>19.10.1. Kunnen diskettes gebruikt worden om gegevens te back-uppen?<a class=anchor href=#floppies-using></a></h4><div class=paragraph><p>Diskettes zijn niet bepaald een geschikt medium om back-ups mee te maken, omdat:</p></div><div class=ulist><ul><li><p>Het medium onbetrouwbaar is, in het bijzonder op de langere termijn;</p></li><li><p>Het back-uppen en terugzetten erg traag is;</p></li><li><p>Diskettes een zeer beperkte capaciteit hebben. De tijden dat een hele harde schijf naar een tiental diskettes kon worden geback-upped zijn allang verstreken.</p></li></ul></div><div class=paragraph><p>Maar als er geen andere manier beschikbaar is om de gegevens te back-uppen, is een back-up naar diskettes beter dan helemaal geen back-up.</p></div><div class=paragraph><p>Gebruikte diskettes moet van goede kwaliteit zijn. Diskettes die al jaren op kantoor rondgeslingerd hebben, zijn een slechte keuze. In het ideale geval dienen nieuwe diskettes van een reputabele fabrikant gebruikt te worden.</p></div></div><div class=sect3><h4 id=floppies-creating>19.10.2. Hoe de gegevens naar diskettes back-uppen?<a class=anchor href=#floppies-creating></a></h4><div class=paragraph><p>Het beste kan naar diskettes worden geback-upped door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> met de optie <code>-M</code> (meerdere volumes), die back-ups over meerdere diskettes ondersteunt.</p></div><div class=paragraph><p>Om alle bestanden in de huidige map en de submappen te back-uppen (als <code>root</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mcvf /dev/fd0 *</span></code></pre></div></div><div class=paragraph><p>Als de eerste diskette vol is, vraagt <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> om het volgende volume. Omdat <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> media-onafhankelijk is, refereert het aan volumes, in deze context diskettes.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Prepare volume <span class=c>#2 for /dev/fd0 and hit return:</span></code></pre></div></div><div class=paragraph><p>Dit wordt herhaald (met oplopend volumenummer) totdat alle gespecificeerde bestanden zijn geback-upped.</p></div></div><div class=sect3><h4 id=floppies-compress>19.10.3. Kunnen back-ups gecomprimeerd worden?<a class=anchor href=#floppies-compress></a></h4><div class=paragraph><p>Helaas staat <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> het gebruik van de optie <code>-z</code> niet toe voor archieven over meerdere volumes. Het is uiteraard mogelijk om alle bestanden met <a href="https://man.freebsd.org/cgi/man.cgi?query=gzip&amp;sektion=1&amp;format=html">gzip(1)</a> te comprimeren, ze met <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> op diskettes te zetten en ze daarna met <a href="https://man.freebsd.org/cgi/man.cgi?query=gunzip&amp;sektion=1&amp;format=html">gunzip(1)</a> weer te decomprimeren!</p></div></div><div class=sect3><h4 id=floppies-restoring>19.10.4. Hoe worden de back-ups teruggezet?<a class=anchor href=#floppies-restoring></a></h4><div class=paragraph><p>Om een volledige archief terug te zetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mxvf /dev/fd0</span></code></pre></div></div><div class=paragraph><p>Er zijn twee manieren om alleen specifieke bestanden terug te zetten. Ten eerste kan met de eerste diskette begonnen worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mxvf /dev/fd0 bestandsnaam</span></code></pre></div></div><div class=paragraph><p>Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> vraagt om de vervolgdiskettes totdat het benodigde bestand is gevonden.</p></div><div class=paragraph><p>Als alternatief kan, als bekend is op welke diskette het bestand staat, de betreffende diskette worden ingestoken en bovenstaand commando gebruikt worden. Als het eerste bestand op de diskette een vervolg is van de vorige diskette, waarschuwt <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> dat het bestand niet teruggezet kan worden, zelfs als hier niet om gevraagd is!</p></div></div></div><div class=sect2><h3 id=backup-strategies>19.11. Back-up strategieën<a class=anchor href=#backup-strategies></a></h3><div class=paragraph><p>Het eerste wat nodig is voor het ontwepken van een back-upplan, is er voor te zorgen dat de volgende mogelijke problemen worden ondervangen:</p></div><div class=ulist><ul><li><p>Schijffalen</p></li><li><p>Per ongeluk verwijderde bestanden</p></li><li><p>Willekeurige bestandscorruptie</p></li><li><p>Complete machinevernietiging (door bijvoorbeeld brand), inclusief de vernietiging van lokaal beschikbare back-ups.</p></li></ul></div><div class=paragraph><p>Het is goed mogelijk dat een aantal systemen het best geholpen zijn door voor al deze problemen een andere techniek te gebruiken. Behalve voor volledig persoonlijke systemen met niet echt belangrijke gegevens, is het zelfs onwaarschijnlijk dat één techniek alle mogelijke problemen kan afvangen.</p></div><div class=paragraph><p>Een aantal technieken in de gereedschapskist zijn:</p></div><div class=ulist><ul><li><p>Archiveren van een heel systeem op een back-up die niet lokaal wordt bewaard. Dit biedt bescherming tegen alle hierboven beschreven problemen, maar het is langzaam en onhandig om er een restore van te maken. Het is mogelijk om lokaal een kopie aan te houden en/of online, maar dan zijn er nog steeds onhandigheden, in het bijzonder voor restores voor gebruikers met beperkte rechten.</p></li><li><p>Snapshots van bestandssystemen. Dit werkt eigenlijk alleen in het geval bestanden per ongelijk verwijderd worden, maar het kan in dat geval <em>erg</em> handig zijn en het werkt snel en eenvoudig.</p></li><li><p>Een kopie maken van hele bestandssystemen en/of schijven (bijvoorbeeld een periodieke <a href="https://man.freebsd.org/cgi/man.cgi?query=rsync&amp;sektion=1&amp;format=html">rsync(1)</a> van een hele machine). Dit is in het algemeen het meest bruikbaar in netwerken met specifieke eisen. Voor algemene bescherming tegen het falen van een schijf, is het meestal minder geschikt dan RAID. Voor het herstellen van per ongeluk verwijderde bestanden is het vergelijkbaar aan UFS snapshots, maar dat hangt af van persoonlijke voorkeuren.</p></li><li><p>RAID. Minimaliseert of voorkomt downtijd als een schijf faalt. Dit ten koste van het vaker hebben van schijven die falen (omdat er meer van zijn), maar wel met een veel lagere urgentie.</p></li><li><p>Controleren van fingerprints van bestanden. Het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a> kan hier bij helpen. Hoewel dit geen back-uptechniek is, zorgt het er wel voor dat kan worden opgemerkt wanneer back-ups geraadpleegd moeten worden. Dit is in het bijzonder belangrijk voor offline back-ups en de fingerprints horen periodiek gecontroleerd te worden.</p></li></ul></div><div class=paragraph><p>Het is makkelijk om met nog meer technieken op de proppen te komen, waaronder veel variaties op de bovengenoemde. Bijzondere eisen leiden vaak tot bijzondere oplossingen. Het back-uppen van een draaiende database vereist bijvoorbeeld een methode die toegespitst is op de gebruikte database software als tussenstap. Het is van groot belang om te onderkennen tegen welke gevaren er bescherming dient te zijn en hoe daarmee om te gaan.</p></div></div><div class=sect2><h3 id=backup-basics>19.12. Back-upbeginselen<a class=anchor href=#backup-basics></a></h3><div class=paragraph><p>De drie grote back-upprogramma’s zijn <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>.</p></div><div class=sect3><h4 id=_dump_en_restore>19.12.1. Dump en Restore<a class=anchor href=#_dump_en_restore></a></h4><div class=paragraph><p>De traditionele back-upprogramma’s voor UNIX® zijn <code>dump</code> en <code>restore</code>. Deze zien het station als een verzameling van schijfblokken, onder de abstracties van bestanden, koppelingen en mappen die door de bestandssystemen worden aangemaakt. In tegenstelling tot andere back-upprogramma’s, verzorgt <code>dump</code> een back-up van een compleet bestandssysteem op een apparaat. Het is niet in staat om slechts een gedeelte van een bestandssysteem of een mapstructuur die meer dan één bestandssysteem in beslag neemt te back-uppen. Het commando <code>dump</code> schrijft geen bestanden en mappen naar band, maar de rauwe gegevensblokken waaruit de bestanden en mappen bestaan. Wanneer het gebruikt wordt om gegevens te extraheren, slaat <code>restore</code> tijdelijke bestanden standaard op in <span class=filename>/tmp/</span> - als u werkt vanaf een herstelschijf met een kleine map <span class=filename>/tmp</span>, moet u wellicht de omgevingsvariabele <code>TMPDIR</code> op een map met meer vrije ruimte instellen zodat de restore kan slagen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien <code>dump</code> op een hoofdmap wordt gebruikt, wordt er geen back-up gemaakt van <span class=filename>/home</span>, <span class=filename>/usr</span> of van de vele andere mappen, aangezien dit typisch koppelpunten voor andere bestandssystemen of symbolische koppelingen binnen deze bestandssystemen zijn.</p></div></td></tr></tbody></table></div><div class=paragraph><p><code>dump</code> bevat eigenaardigheden die uit de begintijd in Versie 6 van AT&amp;T UNIX® (circa 1975) zijn overgebleven. De standaardparameters zijn geschikt voor banden met 9 sporen (6.250 bpi), niet voor de media met hoge dichtheid die vandaag beschikbaar zijn (tot 62.182 ftpi). Deze standaardwaarden dienen op de opdrachtregel overschreven te worden om de capaciteit van de huidige bandstations te benutten.</p></div><div class=paragraph><p>Het is ook mogelijk om gegevens met <code>rdump</code> en <code>rrestore</code> over een netwerk naar een bandstation dat aan een andere computer gekoppeld is te back-uppen. Beide programma’s maken gebruik van <a href="https://man.freebsd.org/cgi/man.cgi?query=rcmd&amp;sektion=3&amp;format=html">rcmd(3)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=ruserok&amp;sektion=3&amp;format=html">ruserok(3)</a> om toegang tot het bandstation op afstand te krijgen. De gebruiker die de back-up uitvoert moet vermeld staat in het bestand <span class=filename>.rhosts</span> op de computer op afstand. De argumenten die aan <code>rdump</code> en <code>rrestore</code> gegeven worden dienen geschikt te zijn voor gebruik op de computer op afstand. Als <code>rdump</code> gebruikt wordt om een dump te maken van een FreeBSD computer naar een Exabyte-bandstation dat met een Sun-computer genaamd <code>komodo</code> verbonden is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/rdump 0dsbfu 54000 13000 126 komodo:/dev/nsa8 /dev/da0a 2&gt;&amp;1</span></code></pre></div></div><div class=paragraph><p>Let op: er kleven veiligheidsbezwaren aan het toestaan van authenticatie met <span class=filename>.rhosts</span>. De situatie dient goed geëvalueerd te worden.</p></div><div class=paragraph><p>Het is ook mogelijk om <code>dump</code> en <code>restore</code> op een veiligere manier via <code>ssh</code> te gebruiken.</p></div><div class=exampleblock><div class=title>Voorbeeld 21. Het gebruik van <code>dump</code> via ssh</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/dump -0uan -f - /usr | gzip -2 | ssh -c blowfish \</span>
	  doelgebruiker@doelmachine.example.com <span class=nb>dd </span><span class=nv>of</span><span class=o>=</span>/mijngrotebestanden/dump-usr-10.gz</code></pre></div></div></div></div><div class=paragraph><p>Ook kan de ingebouwde manier van <code>dump</code> gebruikt worden, door de omgevingsvariabele <code>RSH</code> in te stellen:</p></div><div class=exampleblock><div class=title>Voorbeeld 22. Het gebruik van <code>dump</code> via ssh met ingestelde <code>RSH</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># env RSH=/usr/bin/ssh /sbin/dump -0uan -f doelgebruiker@doelmachine.example.com:/dev/sa0 /usr</span></code></pre></div></div></div></div></div><div class=sect3><h4 id=_tar>19.12.2. <code>tar</code><a class=anchor href=#_tar></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> stamt ook uit de tijd van Versie 6 van AT&amp;T UNIX® (circa 1975). Het werkt samen met het bestandssysteem. <code>tar</code> schrijft bestanden en mappen naar band en ondersteunt niet het volledige scala aan opties dat beschikbaar is met <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>, maar <code>tar</code> heeft niet de ongebruikelijke opdrachtpijplijn nodig die <code>cpio</code> gebruikt.</p></div><div class=paragraph><p>Om <code>tar</code> toe te passen op een Exabyte-bandstation die met een Sun genaamd <code>komodo</code> verbonden is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar cf - . | rsh komodo dd of=tape-device obs=20b</span></code></pre></div></div><div class=paragraph><p>Indien de veiligheid van back-uppen over een netwerk een punt is, dient gebruik te worden gemaakt van het commando <code>ssh</code> en niet van <code>rsh</code>.</p></div></div><div class=sect3><h4 id=_cpio>19.12.3. <code>cpio</code><a class=anchor href=#_cpio></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> is het originele UNIX® bandprogramma voor magnetische media om bestanden uit te wisselen. <code>cpio</code> heeft opties (naast vele anderen) om byte-swapping uit te voeren, een aantal verschillende archiefformaten te schrijven en de gegevens over een pijplijn naar andere programma’s te voeren. Deze laatste optie maakt <code>cpio</code> een uitstekende keuze voor installatiemedia. <code>cpio</code> weet niet hoe het door een mapstructuur moet lopen. Er dient een lijst met bestanden door <span class=filename>stdin</span> aangeleverd te worden.</p></div><div class=paragraph><p><code>cpio</code> biedt geen ondersteuning voor back-ups over het netwerk. Er kan gebruik worden gemaakt van een pijplijn en <code>rsh</code> om de gegevens naar een banddrive op afstand te sturen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># for f in maplijst;  do</span>
find <span class=nv>$f</span> <span class=o>&gt;&gt;</span> back-up.lijst
<span class=k>done</span>
<span class=c># cpio -v -o --format=newc &lt; back-up.lijst | ssh gebruiker@host &#34;cat &gt; back-upapparaat&#34;</span></code></pre></div></div><div class=paragraph><p>Hier is <em>maplijst</em> een lijst van de mappen waarvan een back-up gemaakt dient te worden, <em>gebruiker</em>@<em>host</em> de gebruiker/hostnaam-combinatie die de back-ups uitvoert, en <em>back-upapparaat</em> het apparaat waar de back-ups naar toe geschreven te worden (bijvoorbeeld <span class=filename>/dev/nsa0</span>).</p></div></div><div class=sect3><h4 id=_pax>19.12.4. <code>pax</code><a class=anchor href=#_pax></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;format=html">pax(1)</a> is het antwoord van IEEE en POSIX® op <code>tar</code> en <code>cpio</code>. In de loop der jaren zijn de verscheidene versies van <code>tar</code> en <code>cpio</code> licht incompatibel geworden. Dus in plaats van dit uit te vechten en ze volledig te standaardiseren, heeft POSIX® een nieuw archiveringsprogramma gemaakt. <code>pax</code> poogt om veel van de verscheidene formaten van <code>cpio</code> en <code>tar</code> te lezen en te schrijven, met daarbij nog nieuwe, eigen formaten. De commandoverzameling lijkt meer op die van <code>cpio</code> dan op die van <code>tar</code>.</p></div></div><div class=sect3><h4 id=backups-programs-amanda>19.12.5. Amanda<a class=anchor href=#backups-programs-amanda></a></h4><div class=paragraph><p>Amanda (Advanced Maryland Network Disk Archiver) is een client/server-back-upsysteem, in plaats van een enkel programma. Een Amanda server back-upt elk aantal computers dat een Amanda client en een netwerkverbinding met de Amanda server heeft naar een enkel bandstation. Een veelvoorkomend probleem bij bedrijven met een groot aantal schijven is dat de tijd die nodig is om de gegevens direct naar band te back-uppen langer is dan de tijd die voor de taak gereserveerd is. Amanda lost dit probleem op. Amanda kan gebruik maken van een "tussenschijf" om verschillende bestandssystemen tegelijkertijd te back-uppen. Amanda maakt "archiefverzamelingen" aan, een groep banden die gedurende een tijd gebruikt wordt om volledige back-ups te maken van alle bestandssystemen die in het instellingenbestand van Amanda vermeld staan. De "archiefverzameling" bevat ook incrementele (of differentiële) back-ups van alle bestandssystemen. Voor het herstellen van een beschadigd bestandssysteem zijn de meest recente volledige back-up en de incrementele back-ups nodig.</p></div><div class=paragraph><p>Het instellingenbestand biedt verfijnde controle over de back-ups en het netwerkverkeer door Amanda. Amanda kan elk bovenstaand back-upprogramma gebruiken om de gegevens naar de band te schijven. Amanda is òf als port òf als package beschikbaar.</p></div></div><div class=sect3><h4 id=_nietsdoen>19.12.6. Nietsdoen<a class=anchor href=#_nietsdoen></a></h4><div class=paragraph><p>"Nietsdoen" is geen computerprogramma, maar de de meest gebruikte back-upstrategie. Er zijn geen initiële kosten. Er is geen back-upschema om te volgen. Zeg gewoon nee. Als er iets met gegevens gebeurt, lach erom en leef ermee!</p></div><div class=paragraph><p>Als tijd en gegevens weinig tot niets waard zijn, is "Nietsdoen" het meest geschikte back-upprogramma. Maar wees bedacht, UNIX® is een nuttig stuk gereedschap en er is zo maar binnen zes maanden een verzameling bestanden die wèl van waarde is.</p></div><div class=paragraph><p>"Nietsdoen" is de juiste back-upmethode voor <span class=filename>/usr/obj</span> en andere mapstructuren die zo opnieuw aangemaakt kunnen worden. Een voorbeeld zijn de bestanden waaruit de HTML- of PostScript® versie van dit Handboek bestaan. Deze documentformaten zijn vanuit XML-invoerbestanden aangemaakt. Het back-uppen van de HTML- of PostScript® bestanden is niet nodig. Van de XML-bestanden dient regelmatig een back-up gemaakt te worden.</p></div></div><div class=sect3><h4 id=_welk_back_upprogramma_is_het_beste>19.12.7. Welk back-upprogramma is het beste?<a class=anchor href=#_welk_back_upprogramma_is_het_beste></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>. <em>Punt uit.</em>. Elizabeth D. Zwicky heeft stresstesten op alle hierboven besproken back-upprogramma’s uitgevoerd. De heldere keuze voor het behouden van alle gegevens en alle eigenaardigheden van UNIX® bestandssystemen is <code>dump</code>. Elizabeth heeft bestandssystemen aangemaakt met een grote verscheidenheid aan ongewone omstandigheden (en enkele minder ongebruikelijke) en heeft elk programma getest door een back-up van die bestandssystemen uit te voeren en ze te herstellen. De eigenaardigheden omvatten bestanden met gaten, bestanden met gaten en een blok nullen, bestanden met vreemde tekens in hun namen, onleesbare en onschrijfbare bestanden, apparaten, bestanden waarvan de grootte verandert tijdens het back-uppen, bestanden die aangemaakt/verwijderd worden tijdens het back-uppen en meer. Ze presenteerde de resultaten op LISA V in oktober 1991. Zie <a href=http://www.coredumps.de/doc/dump/zwicky/testdump.doc.html>torture-testing Backup and Archive Programs</a>.</p></div></div><div class=sect3><h4 id=_noodterugzetprocedure>19.12.8. Noodterugzetprocedure<a class=anchor href=#_noodterugzetprocedure></a></h4><div class=sect4><h5 id=_vóór_de_ramp>19.12.8.1. Vóór de ramp<a class=anchor href=#_vóór_de_ramp></a></h5><div class=paragraph><p>Er zijn slechts vier stappen om te volgen bij het voorbereiden op elke ramp die voor kan komen.</p></div><div class=paragraph><p>Het schijflabel van elke schijf dient afgedrukt te worden (bijvoorbeeld met <code>bsdlabel da0 | lpr</code>), de bestandssysteemtabel (<span class=filename>/etc/fstab</span>) en alle opstartboodschappen, alles in tweevoud.</p></div><div class=paragraph><p>Ten tweede dient een "livefs" CD-ROM gebrandt te worden. Deze CD-ROM biedt ondersteuning voor het opstarten in een FreeBSD "livefs" reddingsmodus die gebruiker in staat stelt om vele taken uit te voeren zoals het draaien van <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> en meer. Een livefs CD-beeld voor FreeBSD/i386 11.2-RELEASE is beschikbaar op <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/11.2/FreeBSD-11.2-RELEASE-i386-livefs.iso>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/11.2/FreeBSD-11.2-RELEASE-i386-livefs.iso</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Livefs CD-beelden zijn niet beschikbaar voor FreeBSD 12.0-RELEASE en nieuwer. Naast de beelden voor CDROM-installaties kunnen ook beelden voor flash-drive-installaties gebruikt worden om een systeem te redden. Het "memstick"-beelden voor FreeBSD/i386 12.0-RELEASE is beschikbaar op <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-memstick.img>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-memstick.img</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ten derde dienen regelmatig back-upbanden aangemaakt te worden. Alle veranderingen die na de laatste back-up zijn gemaakt kunnen onherroepelijk verloren zijn gegaan. De back-upbanden dienen beveiligd te worden tegen overschrijven.</p></div><div class=paragraph><p>Ten vierde dienen de "livefs" CD-ROM die in stap twee gemaakt is en de back-upbanden getest te worden. Van de handelingen dienen aantekeningen gemaakt te worden. De aantekeningen, de CD-ROM, de afdrukken en de back-upbanden dienen gezamenlijk bewaard te worden. Tijdens het herstellen kunnen de notities ervoor zorgen dat de back-upbanden vernietigd worden. Hoe? In plaats van <code>tar xvf /dev/sa0</code> kan per ongeluk <code>tar cvf /dev/sa0</code> worden ingetypt, waardoor de back-upband overschreven wordt.</p></div><div class=paragraph><p>Als extra veiligheidsmaatregel dienen telkens een "livefs" CD-ROM en twee back-upbanden gemaakt te worden. Eén van deze banden dient op een plaats op afstand bewaard te worden. Zo’n plaats is NIET de kelder van het zelfde kantoorgebouw. Een aantal bedrijven in het World Trade Center heeft deze les op de harde manier geleerd. Zo’n plaats dient fysiek gescheiden te zijn van de computers en de schijven door een significante afstand.</p></div></div><div class=sect4><h5 id=_na_de_ramp>19.12.8.2. Na de ramp<a class=anchor href=#_na_de_ramp></a></h5><div class=paragraph><p>De hamvraag is: heeft de hardware het overleefd? Er zijn regelmatig back-ups gemaakt, dus zorgen over de software zijn niet nodig.</p></div><div class=paragraph><p>Indien hardware beschadigd is, dienen kapotte onderdelen vervangen te worden voordat gepoogd wordt om een computer te gebruiken.</p></div><div class=paragraph><p>Plaats de "livefs" CD-ROM in de CD-ROM drive indien de hardware in orde is en start de computer op. Het originele installatiemenu wordt op het scherm getoond. Kies het land van toepassing en kies daarna <span class=guimenuitem>Fixit — Repair mode with CDROM/DVD/floppy</span> en kies het item <span class=guimenuitem>CDROM/DVD — Use the live filesystem CDROM/DVD</span>. <code>restore</code> en de andere benodigde programma’s staan in <span class=filename>/mnt2/rescue</span>.</p></div><div class=paragraph><p>Herstel elk bestandssysteem apart.</p></div><div class=paragraph><p>Probeer de rootpartitie van de eerste schijf aan te koppelen (bijvoorbeeld <code>mount /dev/da0a /mnt</code>). Als het schijflabel beschadigd is, gebruik dan <code>bsdlabel</code> om de schijf opnieuw te partitioneren en te labelen zodat deze overeenkomt met het afgedrukte en bewaarde label. Gebruik voor het opnieuw aanmaken van de bestandssystemen <code>newfs</code>. Koppel de rootpartitie van de schijf opnieuw aan voor lezen en schrijven (<code>mount -u -o rw /mnt</code>). Gebruik voor het herstellen van de gegevens van dit bestandssysteem het back-upprogramma en de back-upbanden (bijvoorbeeld <code>restore vrf /dev/sa0</code>). Koppel nu het bestandssysteem af (bijvoorbeeld <code>umount /mnt</code>). Herhaal dit voor elk beschadigd bestandssysteem.</p></div><div class=paragraph><p>Back-up de gegevens naar nieuwe banden als het systeem weer draait. De omstandigheden die verantwoordelijk waren voor de crash of het gegevensverlies kunnen weer voorkomen. Nu een extra uur investeren, kan later grote zorgen besparen.</p></div></div></div></div><div class=sect2><h3 id=disks-virtual>19.13. Netwerk-, geheugen-, en bestandsgebaseerde bestandssystemen<a class=anchor href=#disks-virtual></a></h3><div class=paragraph><p>Naast de schijven die fysiek in de computer zitten, diskettes, CD’s, harde schijven, enzovoort, worden er ook andere vormen van schijven door FreeBSD begrepen: de <em>virtuele schijven</em>.</p></div><div class=paragraph><p>Dit omvat netwerkbestandssystemen zoals het <a href=./#network-nfs>Network File System</a> en Coda, geheugengebaseerde bestandssystemen en bestandsgebaseerde bestandssystemen.</p></div><div class=paragraph><p>Nagelang de gebruikte versie van FreeBSD, zijn er andere gereedschappen voor het aanmaken en gebruiken van bestandsgebaseerde en geheugengebaseerde bestandssystemen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> om de apparaatnodes transparant voor de gebruiker toe te wijzen.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=disks-mdconfig>19.13.1. Bestandsgebaseerd bestandssysteem<a class=anchor href=#disks-mdconfig></a></h4><div class=paragraph><p>Met <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> kunnen geheugenschijven, <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>, ingesteld worden en aangezet worden. Om <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> te gebruiken, moet de module <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> geladen worden of ondersteuning aan het kernelinstellingenbestand toegevoegd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>device md</pre></div></div><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> ondersteunt drie types geheugen-gebaseerde virtuele schijven: geheugenschijven die met <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> toegewezen zijn, geheugenschijven die een bestand als basis gebruiken en geheugenschijven die swapruimte als basis gebruiken. Een mogelijk gebruik is het aankoppelen van een beeld van een diskette of CD dat in een bestand bewaard wordt.</p></div><div class=paragraph><p>Om een bestaand beeld van een bestandssysteem aan te koppelen:</p></div><div class=exampleblock><div class=title>Voorbeeld 23. <code>mdconfig</code> gebruiken om een bestaand beeld van een bestandssysteem aan te koppelen</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f schijfbeeld -u 0</span>
<span class=c># mount /dev/md0 /mnt</span></code></pre></div></div></div></div><div class=paragraph><p>Om een nieuw beeld van een bestandssysteem aan te maken met <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>:</p></div><div class=exampleblock><div class=title>Voorbeeld 24. Nieuwe bestandsgebaseerde schijf aanmaken met <code>mdconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=nieuwbeeld bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdconfig -a -t vnode -f nieuwbeeld -u 0</span>
<span class=c># bsdlabel -w md0 auto</span>
<span class=c># newfs md0a</span>
/dev/md0a: 5.0MB <span class=o>(</span>10240 sectors<span class=o>)</span> block size 16384, fragment size 2048
	using 4 cylinder <span class=nb>groups </span>of 1.25MB, 80 blks, 192 inodes.
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2720, 5280, 7840
<span class=c># mount /dev/md0a /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0a       4710    4  4330     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>Indien het eenheidsnummer niet met de optie <code>-u</code> gespecificeerd wordt, gebruikt <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> de automatische toewijzing van <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> om een ongebruikt apparaat te selecteren. De naam van het toegewezen apparaat wordt op stdout weergegeven als <span class=filename>md4</span>. Meer details staan in de hulppagina van <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>.</p></div><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> is erg nuttig, hoewel het veel opdrachten vergt om een bestandsgebaseerd bestandssysteem aan te maken. FreeBSD wordt met <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> geleverd. Dit programma stelt een <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>-schijf in door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>, zet er een bestandssysteem op door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> en koppel het aan door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. Om hetzelfde bestandssysteembeeld als hierboven aan te maken en aan te koppelen:</p></div><div class=exampleblock><div class=title>Voorbeeld 25. Instellen en aankoppelen van een bestandsgebaseerde schijf met <code>mdmfs</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=nieuwbeeld bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdmfs -F nieuwbeeld -s 5m md0 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>Als de optie <code>md</code> zonder eenheidsnummer gebruikt wordt, gebruikt <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> de automatische toewijzing van <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> om automatisch een ongebruikt apparaat te selecteren. Meer details staan in de hulppagina van <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a>.</p></div></div><div class=sect3><h4 id=disks-md-freebsd5>19.13.2. Geheugengebaseerd bestandssysteem<a class=anchor href=#disks-md-freebsd5></a></h4><div class=paragraph><p>Voor een geheugen gebaseerd bestands systeem moet normaal gesproken "wisselbestand geheugen" gebruikt worden. Gebruik maken van wisselbestand geheugen wil niet perse zeggen dat de geheugen schijf direct in het wisselbestand gezet wordt, maar dat het bestand naar het wisselbestand geschreven kan worden indien nodig. Het is ook mogelijk om <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> gebaseerde geheugen schijven te maken, maar door hiervan gebruik te maken kan het gebeuren dat het systeem crashed als de kernel uit het geheugen loopt.</p></div><div class=exampleblock><div class=title>Voorbeeld 26. Nieuwe geheugengebaseerde schijf aanmaken met <code>mdconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t swap -s 5m -u 1</span>
<span class=c># newfs -U md1</span>
/dev/md1: 5.0MB <span class=o>(</span>10240 sectors<span class=o>)</span> block size 16384, fragment size 2048
	using 4 cylinder <span class=nb>groups </span>of 1.27MB, 81 blks, 192 inodes.
	with soft updates
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2752, 5344, 7936
<span class=c># mount /dev/md1 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md1        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=exampleblock><div class=title>Voorbeeld 27. Nieuwe geheugengebaseerde schijf aanmaken met <code>mdmfs</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdmfs -s 5m md2 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md2        4846    2  4458     0%    /mnt</code></pre></div></div></div></div></div><div class=sect3><h4 id=_geheugenschijf_van_het_systeem_afkoppelen>19.13.3. Geheugenschijf van het systeem afkoppelen<a class=anchor href=#_geheugenschijf_van_het_systeem_afkoppelen></a></h4><div class=paragraph><p>Als een geheugen- of bestandsgebaseerd bestandssysteem niet gebruikt wordt, dienen alle bronnen aan het systeem vrijgegeven te worden. Koppel als eerste het bestandssysteem af, gebruikt daarna <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> om de schijf van een systeem los te koppelen en de bronnen vrij te geven.</p></div><div class=paragraph><p>Om bijvoorbeeld alle bronnen die door <span class=filename>/dev/md4</span> gebruikt worden los te koppelen en vrij te geven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>Het is mogelijk om de informatie over ingestelde <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> apparaten weer te geven door gebruik te maken van <code>mdconfig -l</code>.</p></div></div></div><div class=sect2><h3 id=snapshots>19.14. Snapshots van bestandssystemen<a class=anchor href=#snapshots></a></h3><div class=paragraph><p>FreeBSD biedt een mogelijkheid om samen met <a href=./#soft-updates>Soft Updates</a>: snapshots van bestandssystemen.</p></div><div class=paragraph><p>Snapshots bieden de mogelijkheid om beelden van een gespecificeerd bestandssysteem te maken en ze als bestand te behandelen. Snapshotbestanden moeten aangemaakt worden in het bestandssysteem waarop de handeling wordt uitgevoerd en er mogen niet meer dan 20 snapshots per bestandssysteem worden aangemaakt. Actieve snapshots worden opgeslagen in het superblok zodat ze persistent zijn met afkoppel- en heraankoppelbewerkingen en met het opnieuw opstarten van het systeem. Als een snapshot niet langer nodig is, kan het met het standaardcommando <a href="https://man.freebsd.org/cgi/man.cgi?query=rm&amp;sektion=1&amp;format=html">rm(1)</a> worden verwijderd. Snapshots kunnen in elke volgorde verwijderd worden, alhoewel misschien niet alle gebruikte ruimte teruggewonnen wordt omdat sommige vrijgegeven blokken mogelijk door een ander snapshot geclaimd worden.</p></div><div class=paragraph><p>De onveranderlijke bestandsvlag <code>snapshot</code> wordt door <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a> ingesteld nadat het snapshotbestand initieel is aangemaakt. Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=unlink&amp;sektion=1&amp;format=html">unlink(1)</a> maakt een uitzondering voor snapshotbestanden aangezien het toestaat dat ze verwijderd worden.</p></div><div class=paragraph><p>Snapshotbestanden worden aangemaakt met <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. Om een snapshot van <span class=filename>/var</span> in het bestand <span class=filename>/var/snapshot/snap</span> te plaatsen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -o -o snapshot /var/snapshot/snap /var</span></code></pre></div></div><div class=paragraph><p>Als alternatief kan <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a> gebruikt worden om een snapshot aan te maken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mksnap_ffs /var /var/snapshot/snap</span></code></pre></div></div><div class=paragraph><p>Snapshotbestanden kunnen gezocht worden op een bestandssysteem (bijvoorbeeld <span class=filename>/var</span>) door gebruik te maken van het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=find&amp;sektion=1&amp;format=html">find(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># find /var -flags snapshot</span></code></pre></div></div><div class=paragraph><p>Nadat een snapshot is aangemaakt, kan het voor een aantal dingen gebruikt worden:</p></div><div class=ulist><ul><li><p>Sommige systeembeheerders gebruiken een snapshotbestand voor back-updoeleinden, omdat het snapshot naar CD’s of band overgezet kan worden;</p></li><li><p>De bestandssysteem integriteit controle, <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> kan gebruikt worden op het snapshot. Ervan uitgaande dat het bestandssysteem schoon was toen het werd aangekoppeld, zou dit altijd een schoon (en onveranderlijk) resultaat moeten opleveren. Dit is in principe wat het <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a>-achtergrondsproces doet;</p></li><li><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> draaien op het snapshot. Er wordt een dump teruggegeven die consistent is met het bestandssysteem en tijdsstempel van het snapshot. <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> kan ook in één commando een snapshot maken, een dumpbeeld aanmaken en daarna het snapshot verwijderen door gebruik te maken van de vlag <code>-L</code>;</p></li><li><p>Het snapshot kan met <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> als bevroren beeld van het bestandssysteem worden aangekoppeld. Om het snapshot <span class=filename>/var/snapshot/snap</span> aan te koppelen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /var/snapshot/snap -u 4</span>
<span class=c># mount -r /dev/md4 /mnt</span></code></pre></div></div></li></ul></div><div class=paragraph><p>Het is nu mogelijk om door de structuur van het bevroren bestandssysteem <span class=filename>/var</span> te lopen dat aangekoppeld is op <span class=filename>/mnt</span>. Alles zal initieel in dezelfde toestand verkeren als op het moment dat het snapshot werd aangemaakt. De enige uitzondering hierop is dat eerdere snapshots als bestanden met lengte nul verschijnen. Als een snapshot niet meer nodig is, kan het als volgt afgekoppeld worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /mnt</span>
<span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>Meer informatie over <code>softupdates</code> en snapshots van bestandssystemen, inclusief technische documenten, staat op de website van Marshall Kirk McKusick op <a href=http://www.mckusick.com/>http://www.mckusick.com/</a>.</p></div></div><div class=sect2><h3 id=quotas>19.15. Bestandssysteemquota<a class=anchor href=#quotas></a></h3><div class=paragraph><p>Quota zijn een optionele mogelijkheid van het besturingssysteem om de hoeveelheid schijfruimte en/of het aantal bestanden dat gebruikers of leden van een groep per bestandssysteem mogen gebruiken te beperken. Dit wordt het meeste gebruikt op timesharing-systemen waar het wenselijk is om het aantal bronnen dat elke gebruiker of groep van gebruikers mag gebruiken te beperken. Dit voorkomt dat één gebruiker of groep van gebruikers alle beschikbare schijfruimte in beslag neemt.</p></div><div class=sect3><h4 id=_schijfquota_inschakelen>19.15.1. Schijfquota inschakelen<a class=anchor href=#_schijfquota_inschakelen></a></h4><div class=paragraph><p>Controleer alvorens te proberen om schijfquota te gebruiken of quota ingesteld zijn in de kernel. Dit gebeurt door het toevoegen van de volgende regel aan het kernelinstellingenbestand:</p></div><div class="literalblock programlisting"><div class=content><pre>options QUOTA</pre></div></div><div class=paragraph><p>De standaardkernel <span class=filename>GENERIC</span> heeft deze optie niet aanstaan, dus is het nodig om een eigen kernel in te stellen, te bouwen en te installeren om gebruik te kunnen maken van schijfquota. Meer informatie over het instellen van de kernel staat in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div><div class=paragraph><p>Vervolgens dienen schijfquota aangezet te worden in <span class=filename>/etc/rc.conf</span>. Op FreeBSD 7.X en eerder wordt deze regel toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>enable_quotas=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Voeg op FreeBSD 8.0-RELEASE en nieuwer in plaats daarvan deze regel toe:</p></div><div class="literalblock programlisting"><div class=content><pre>quota_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Voor fijnere controle over de opstartquota zijn extra instellingsvariabelen beschikbaar. Normaalgesproken wordt de integriteit van de quota van elk bestandssysteem tijdens het opstarten door <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a> gecontroleerd. <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a> verzekert dat de gegevens in de quotadatabase een juiste afspiegeling vormen van de gegevens op het bestandssysteem. Dit proces neemt erg veel tijd in beslag en beïnvloedt de tijd die een systeem nodig heeft om op te starten significant. Om deze stap over te slaan, bestaat een variabele in <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>check_quotas=&#34;NO&#34;</pre></div></div><div class=paragraph><p>Als laatste dient <span class=filename>/etc/fstab</span> bewerkt te worden om schijfquota per bestandssysteem aan te zetten. Hier kunnen gebruiker- of groepquota of beide worden aangezet voor alle bestandssystemen.</p></div><div class=paragraph><p>Om quota per gebruiker op een bestandssysteem aan te zetten, dient de optie <code>userquota</code> aan het optieveld toegevoegd te worden aan de regel in <span class=filename>/etc/fstab</span> voor het bestandssysteem waar quota worden aangezet. Bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g   /home    ufs rw,userquota 1 2</pre></div></div><div class=paragraph><p>Analoog, om groepquota aan te zetten, dient de optie <code>groupquota</code> in plaats van <code>userquota</code> gebruikt te worden. Om zowel gebruikers- als groepsquota aan te zetten, dient de regel als volgt veranderd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g   /home    ufs rw,userquota,groupquota 1 2</pre></div></div><div class=paragraph><p>Standaard worden de quotabestanden opgeslagen in de hoofdmap van het bestandssysteem onder de namen <span class=filename>quota.user</span> en <span class=filename>quota.group</span> voor respectievelijk gebruikers- en groepsquota. Meer informatie staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a>. Alhoewel de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> vermeld dat een alternatieve plaats voor de quotabestanden gespecificeerd kan worden, wordt dit niet aangeraden omdat de verschillende quotagereedschappen dit niet juist schijnen af te handelen.</p></div><div class=paragraph><p>Hier aangekomen dient het systeem opnieuw opgestart te worden met de nieuwe kernel. <span class=filename>/etc/rc</span> voert automatisch de juiste commando’s uit om de initiële quotabestanden aan te maken voor alle quota die in <span class=filename>/etc/fstab</span> zijn aangezet. Het is dus niet nodig om handmatig quotabestanden met lengte nul aan te maken.</p></div><div class=paragraph><p>Tijdens normale bewerkingen moet het niet nodig zijn om de commando’s <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaon&amp;sektion=8&amp;format=html">quotaon(8)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaoff&amp;sektion=8&amp;format=html">quotaoff(8)</a> handmatig te draaien. Lees wel de betreffende hulppagina’s om bekend te raken met de werking ervan.</p></div></div><div class=sect3><h4 id=_quotalimieten_instellen>19.15.2. Quotalimieten instellen<a class=anchor href=#_quotalimieten_instellen></a></h4><div class=paragraph><p>Indien het systeem ingesteld voor gebruik van quota, controleer dan of ze echt aanstaan. Een eenvoudige manier om dit te doen is de volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># quota -v</span></code></pre></div></div><div class=paragraph><p>Er hoort een eenregelige samenvatting te verschijnen over het schijfgebruik en de huidige quotalimieten voor elk bestandssysteem waarop quota aanstaan.</p></div><div class=paragraph><p>Nu kunnen quotalimieten toegewezen worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>.</p></div><div class=paragraph><p>Er zijn verschillende opties om grenzen te stellen aan de hoeveelheid schijfruimte die een gebruiker of groep mag toewijzen en het aantal bestanden dat ze mogen aanmaken. Toewijzingen kunnen begrensd worden met betrekking tot schijfruimte (blokquota) of het aantal bestanden (inode-quota) of een combinatie van beide. Elk van deze limieten is op zijn beurt weer opgesplitst in twee categoriën: harde en zachte limieten.</p></div><div class=paragraph><p>Een harde limiet mag niet overschreden worden. Indien een gebruiker de harde limiet bereikt, mag deze geen verdere toewijzingen maken op het betreffende bestandssysteem. Indien een gebruiker bijvoorbeeld een harde limiet heeft van 500 kB op een bestandssysteem en er 490 kB van gebruikt, kan deze nog slechts 10 kB toewijzen. Een poging om 11 kB toe te wijzen zal mislukken.</p></div><div class=paragraph><p>Zachte limieten kunnen voor een beperkte tijd overschreden worden. Deze periode staat bekend als de gratieperiode, die standaard een week bedraagt. Als een gebruiker de zachte limiet langer dan de gratieperiode overschrijdt, verandert de zachte limiet in een harde limiet en zijn er geen verdere toewijzingen toegestaan. Als de gebruiker onder de zachte limiet komt, wordt de gratieperiode opnieuw ingesteld.</p></div><div class=paragraph><p>Het volgende is een voorbeeld van een mogelijk gebruik van <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>. Als het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a> gestart wordt, wordt de tekstverwerker opgestart die door de omgevingsvariabele <code>EDITOR</code> gespecificeerd is, of de tekstverwerker vi als de variabele <code>EDITOR</code> niet is ingesteld. Nu kunnen de quotalimieten bewerkt worden.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -u test</span></code></pre></div></div><div class="literalblock programlisting"><div class=content><pre>Quotas for user test:
/usr: kbytes in use: 65, limits (soft = 50, hard = 75)
        inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)
        inodes in use: 0, limits (soft = 50, hard = 60)</pre></div></div><div class=paragraph><p>Normaalgesproken worden er twee regels weergegeven voor elk bestandssysteem waarvoor quota gelden: één regel voor de bloklimieten, en één voor de inode-limieten. Om de quotalimieten te veranderen dient de waarde ervan veranderd te worden. Om bijvoorbeeld de bloklimiet van een gebruiker te veranderen van een zachte limiet van 50 en een harde limiet van 75 in een zachte limiet van 500 en een harde limiet van 600, dient het volgende veranderd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 50, hard = 75)</pre></div></div><div class=paragraph><p>In:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 500, hard = 600)</pre></div></div><div class=paragraph><p>De nieuwe quotalimieten gelden zodra de tekstverwerker verlaten wordt.</p></div><div class=paragraph><p>Soms is het gewenst om quotalimieten in te stellen op een aantal UID’s. Dit kan gedaan worden door de optie <code>-p</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a> te gebruiken. Wijs eerst de gewenste quotalimiet aan een gebruiker toe en draai daarna <code>edquota -p protogebruiker beginuid-einduid</code>. Indien bijvoorbeeld gebruiker <code>test</code> de gewenste quotalimieten heeft, kan het volgende commando gebruikt worden om deze quotalimieten te dupliceren voor UID’s 10.000 tot en met 19.999:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -p test 10000-19999</span></code></pre></div></div><div class=paragraph><p>Meer informatie staat in de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>.</p></div></div><div class=sect3><h4 id=_quotalimieten_en_schijfgebruik_controleren>19.15.3. Quotalimieten en schijfgebruik controleren<a class=anchor href=#_quotalimieten_en_schijfgebruik_controleren></a></h4><div class=paragraph><p>Zowel <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> als <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a> kunnen gebruikt worden om de quotalimieten en het schijfgebruik te controleren. Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> kan gebruikt worden om de quota van zowel individuele gebruikers als groepen en het schijfgebruik te controleren. Een gebruiker mag alleen de eigen quota en de quota van een groep waarvan deze lid is controleren. Alleen de beheerder mag alle gebruikers- en groepsquota bekijken. Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a> kan gebruikt worden om een overzicht te krijgen van alle quota en gebruik van bestandssystemen waarvan quota aanstaan.</p></div><div class=paragraph><p>Het volgende is een mogelijke uitvoer van het commando <code>quota -v</code> voor een gebruiker die quotalimieten heeft op twee bestandssystemen.</p></div><div class="literalblock programlisting"><div class=content><pre>Disk quotas for user test (uid 1002):
     Filesystem  usage    quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75               0      50      60</pre></div></div><div class=paragraph><p>Voor het bestandssysteem <span class=filename>/usr</span> in bovenstaand voorbeeld overschrijdt deze gebruiker de zachte limiet van 50 kB momenteel met 15 kB en heeft deze 5 dagen van de gratieperiode over. De asterisk, <code>*</code> geeft aan dat de gebruiker momenteel de quotalimiet overschrijdt.</p></div><div class=paragraph><p>Normaalgesproken worden bestandssystemen waarvan de gebruiker geen schijfruimte gebruikt niet weergegeven in de uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a>, zelfs niet als er de gebruiker een quotalimiet heeft voor dat bestandssysteem. De optie <code>-v</code> geeft deze bestandssystemen weer, zoals het bestandssysteem <span class=filename>/usr/var</span> in bovenstaand voorbeeld.</p></div></div><div class=sect3><h4 id=_quota_over_nfs>19.15.4. Quota over NFS<a class=anchor href=#_quota_over_nfs></a></h4><div class=paragraph><p>Quota worden afgedwongen door het quota-subsysteem op de NFS-server. De daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.rquotad&amp;sektion=8&amp;format=html">rpc.rquotad(8)</a> stelt quota-informatie beschikbaar aan het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> op de NFS-cliënts, wat de gebruikers op deze machines in staat stelt hun quota-statistieken in te zien.</p></div><div class=paragraph><p><code>rpc.rquotad</code> dient als volgt in <span class=filename>/etc/inetd.conf</span> aangezet te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</pre></div></div><div class=paragraph><p>Vervolgens dient <code>inetd</code> opnieuw gestart te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd restart</span></code></pre></div></div></div></div><div class=sect2><h3 id=disks-encrypting>19.16. Schijfpartities versleutelen<a class=anchor href=#disks-encrypting></a></h3><div class=paragraph><p>FreeBSD biedt uitstekende on-line bescherming tegen onbevoegde gegevenstoegang. Bestandsrechten en Mandatory Access Control (MAC) (zie <a href=./#mac>Verplichte Toegangscontrole (MAC)</a>) helpen voorkomen dat onbevoegde derde partijen toegang tot de gegevens krijgen als het besturingssysteem actief is en de computer aanstaat. De door het besturingssysteem afgedwongen rechten zijn echter niet relevant als een aanvaller fysieke toegang tot een computer heeft en deze de harde schijf van de computer in een ander systeem kan plaatsen om de gevoelige gegevens te kopiëren en te analyseren.</p></div><div class=paragraph><p>Afgezien van hoe een aanvaller in het bezit van een harde schijf of een uitgezette computer gekomen is, kan GEOM Based Disk Encryption (gbde) de gegevens op het bestandssysteem van de computer zelfs tegen hooggemotiveerde aanvallers met aanzienlijke middelen beschermen. In tegenstelling tot lastige versleutelmethoden die alleen losse bestanden versleutelen, versleutelt gbde gehele bestandssystemen op een transparante manier. De harde schijf komt nooit in aanraking met klare tekst.</p></div><div class=paragraph><p>Los van hoe een aanvaller in het bezit van een harde schijf of een uitgezette computer gekomen is, kunnen de cryptografische subsystemen GEOM Based Disk Encryption (gbde) en <code>geli</code> in FreeBSD gegevens op bestandssystemen van een computer beschermen tegen zelfs de meer gemotiveerde belagers die ook nog eens adequate middelen hebben. Anders dan met lastige versleutelingsmethoden die alleen individuele bestanden versleutelen, versleutelen <code>gbde</code> en <code>geli</code> transparant complete bestandssystemen. Er komt nooit platte tekst op een harde schijf.</p></div><div class=sect3><h4 id=_schijven_versleutelen_met_gbde>19.16.1. Schijven versleutelen met gbde<a class=anchor href=#_schijven_versleutelen_met_gbde></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Word <code>root</code></p><div class=paragraph><p>Het instellen van gbde vereist beheerdersrechten.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% su -
Password:</code></pre></div></div></li><li><p>Voeg ondersteuning voor <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a> aan het kernelinstellingenbestand toe</p><div class=paragraph><p>Voeg de volgende regel toe aan het kernelinstellingenbestand:</p></div><div class=paragraph><p><code>options GEOM_BDE</code></p></div><div class=paragraph><p>Herbouw de kernel opnieuw zoals beschreven in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div><div class=paragraph><p>Start op met de nieuwe kernel.</p></div></li><li><p>Een alternatief voor het hercompileren van de kernel is door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> om <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a> te laden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload geom_bde</span></code></pre></div></div></li></ol></div></div></div><div class=sect4><h5 id=_versleutelde_harde_schijf_voorbereiden>19.16.1.1. Versleutelde harde schijf voorbereiden<a class=anchor href=#_versleutelde_harde_schijf_voorbereiden></a></h5><div class=paragraph><p>In het volgende voorbeeld wordt aangenomen dat er een nieuwe harde schijf aan het systeem wordt toegevoegd die een enkele versleutelde partitie zal bevatten. Deze partitie wordt aangekoppeld als <span class=filename>/private</span>. gbde kan ook gebruikt worden om <span class=filename>/home</span> en <span class=filename>/var/mail</span> te versleutelen, maar daarvoor zijn complexere instructies nodig die buiten het bereik van deze inleiding vallen.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Voeg een nieuwe harde schijf toe</p><div class=paragraph><p>Voeg de nieuwe harde schijf toe zoals beschreven in <a href=#disks-adding>Schijven toevoegen</a>. In dit voorbeeld is een nieuwe harde schijfpartitie toegevoegd als <span class=filename>/dev/ad4s1c</span>. De apparaten <span class=filename>/dev/ad0s1*</span> stellen bestaande standaard FreeBSD partities van het voorbeeldsysteem voor.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4</code></pre></div></div></li><li><p>Maak een map aan voor gbde lockbestanden</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /etc/gbde</span></code></pre></div></div><div class=paragraph><p>Het lockbestand voor gbde bevat informatie die gbde nodig heeft om toegang te krijgen tot versleutelde partities. Zonder toegang tot de lockbestand is gbde niet in staat om de gegevens die op de versleutelde partitie staan te ontsleutelen zonder aanzienlijke handmatige tussenkomst die niet door de software ondersteund wordt. Elke versleutelde partitie gebruikt een ander lockbestand.</p></div></li><li><p>Initialiseer de gbde-partitie</p><div class=paragraph><p>Een gbde-partitie dient geïnitialiseerd te worden voordat deze kan worden gebruikt. Deze initialisatie dient slechts eenmalig uitgevoerd te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde init /dev/ad4s1c -i -L /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> opent een tekstverwerker om verschillende instellingen in een sjabloon te kunnen instellen. Stel de sector_size in op 2048 als UFS of UFS2 wordt gebruikt:</p></div><div class="literalblock programlisting"><div class=content><pre># $FreeBSD: src/sbin/gbde/template.txt,v 1.1 2002/10/20 11:16:13 phk Exp $
#
# Sector size is the smallest unit of data which can be read or written.
# Making it too small decreases performance and decreases available space.
# Making it too large may prevent filesystems from working.  512 is the
# minimum and always safe.  For UFS, use the fragment size
#
sector_size	=	2048
[...]</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> vraagt twee keer om de wachtwoordzin voor het beveiligen van de gegevens. De wachtwoordzin dient beide keren hetzelfde te zijn. De mogelijkheid van gbde om de gegevens te beveiligen is geheel afhankelijk de gekozen wachtwoordzin.</p></div><div class=paragraph><p>Het commando <code>gbde init</code> maakt een lockbestand aan voor de gbde-partitie die in dit voorbeeld is opgeslagen als <span class=filename>/etc/gbde/ad4s1c.lock</span>. gdbde slotbestanden moeten eindigen op ".lock" om correct door het opstartscript <span class=filename>/etc/rc.d/gbde</span> gedetecteerd te worden.</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>gbde lockbestanden <em>moeten</em> samen met de inhoud van versleutelde partities geback-upped worden. Hoewel het verwijderen van een lockbestand op zich een gedreven aanvaller er niet van weerhoudt een gbde partitie te ontsleutelen, is de wettige eigenaar zonder het lockbestand niet in staat om de gegevens op de versleutelde partitie te benaderen zonder een aanzienlijke hoeveelheid werk die in het geheel niet ondersteund wordt door <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> of de ontwerper ervan.</p></div></td></tr></tbody></table></div></li><li><p>Koppel de versleutelde partitie aan de kernel</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>Er wordt om de wachtwoordzin gevraagd die gekozen is tijdens de initialisatie van de versleutelde partitie. Het nieuwe versleutelde apparaat verschijnt in <span class=filename>/dev</span> als <span class=filename>/dev/apparaatnaam.bde</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4        /dev/ad4s1c.bde</code></pre></div></div></li><li><p>Maak een bestandssysteem op het versleutelde apparaat</p><div class=paragraph><p>Nu het versleutelde apparaat aan de kernel gekoppeld is, kan een bestandssysteem op het apparaat aangemaakt worden. Met <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> kan een bestandssysteem op het versleutelde apparaat aangemaakt wordne. Aangezien het veel sneller is om een nieuw UFS2 bestandssysteem te initialiseren dan om een oud UFS1 bestandssysteem te initialiseren, is het aan te raden om <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> met de optie <code>-O2</code> te gebruiken.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U -O2 /dev/ad4s1c.bde</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voer <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> uit op een aangekoppelde gbde-partitie die geïndificeerd wordt door de uitbreiding <span class=filename>*.bde</span> op de apparaatnaam.</p></div></td></tr></tbody></table></div></li><li><p>Mount de versleutelde partitie</p><div class=paragraph><p>Maak een koppelpunt voor het versleutelde bestandssysteem aan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /private</span></code></pre></div></div><div class=paragraph><p>Mount het versleutelde bestandssysteem:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /private</span></code></pre></div></div></li><li><p>Controleer of het versleutelde bestandssysteem beschikbaar is</p><div class=paragraph><p>Het versleutelde bestandssysteem is nu zichtbaar met <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> en gebruiksklaar:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>df</span> <span class=nt>-H</span>
Filesystem        Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a      1037M    72M   883M     8%    /
/devfs            1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f       8.1G    55K   7.5G     0%    /home
/dev/ad0s1e      1037M   1.1M   953M     0%    /tmp
/dev/ad0s1d       6.1G   1.9G   3.7G    35%    /usr
/dev/ad4s1c.bde   150G   4.1K   138G     0%    /private</code></pre></div></div></li></ol></div></div></div></div><div class=sect4><h5 id=_bestaande_versleutelde_bestandssystemen_aankoppelen>19.16.1.2. Bestaande versleutelde bestandssystemen aankoppelen<a class=anchor href=#_bestaande_versleutelde_bestandssystemen_aankoppelen></a></h5><div class=paragraph><p>Elke keer nadat het systeem is opgestart dient elk versleuteld bestandssysteem opnieuw aan de kernel gekoppeld te worden, op fouten gecontroleerd te worden, en aangekoppeld te worden voordat de bestandssystemen gebruikt kunnen worden. De benodigde commando’s dienen als de gebruiker <code>root</code> uitgevoerd te worden.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Koppel de gbde-partitie aan de kernel</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>Er wordt om de wachtwoordzin gevraagd die gekozen is tijdens de initialisatie van de versleutelde gbde-partitie.</p></div></li><li><p>Controleer het bestandssysteem op fouten</p><div class=paragraph><p>Aangezien het nog niet mogelijk is om versleutelde bestandssystemen op te nemen in <span class=filename>/etc/fstab</span> voor automatische controle, dienen de bestandssystemen voordat ze aangekoppeld worden handmatig op fouten gecontroleerd te worden door <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> uit te voeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fsck -p -t ffs /dev/ad4s1c.bde</span></code></pre></div></div></li><li><p>Mount het versleutelde bestandssysteem</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /private</span></code></pre></div></div><div class=paragraph><p>Het versleutelde bestandssysteem is nu klaar voor gebruik.</p></div></li></ol></div></div></div><div class=sect5><h6 id=_versleutelde_partities_automatisch_aankoppelen>19.16.1.2.1. Versleutelde partities automatisch aankoppelen<a class=anchor href=#_versleutelde_partities_automatisch_aankoppelen></a></h6><div class=paragraph><p>Het is mogelijk om een script aan te maken om automatisch een versleutelde partitie aan te koppelen, op fouten te controleren en aan te koppelen, maar vanwege veiligheidsredenen dient het script niet het wachtwoord voor <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> te bevatten. In plaats hiervan wordt het aangeraden om zulke scripts handmatig uit te voeren en het wachtwoord via de console of <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> te geven.</p></div><div class=paragraph><p>Als alternatief, wordt er een <span class=filename>rc.d</span> script bijgeleverd. De argumenten kunnen via <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> doorgegeven worden. Bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>gbde_autoattach_all=&#34;YES&#34;
gbde_devices=&#34;ad4s1c&#34;
gbde_lockdir=&#34;/etc/gbde&#34;</pre></div></div><div class=paragraph><p>Hierdoor is het noodzakelijk dat de wachtwoordzin voor gbde bij het starten wordt ingegeven. Na het invoeren van de juiste wachtwoordzin wordt de met gbde versleutelde partitie automatisch aangekoppeld. Dit kan erg handig zijn bij het gebruik van gbde op notebooks.</p></div></div></div><div class=sect4><h5 id=_door_gbde_gebruikte_cryptografische_beschermingen>19.16.1.3. Door gbde gebruikte cryptografische beschermingen<a class=anchor href=#_door_gbde_gebruikte_cryptografische_beschermingen></a></h5><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> versleutelt de sectorlading door gebruik te maken van 128-bit AES in CBC-modus. Elke sector op de schijf wordt met een andere AES-sleutel versleuteld. Meer informatie over het cryptografische ontwerp van gbde, inclusief de methode die gebruikt wordt om de sectorsleutels van de door de gebruiker gegeven wachtwoordzin af te leiden, staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a>.</p></div></div><div class=sect4><h5 id=_compatibiliteitspunten>19.16.1.4. Compatibiliteitspunten<a class=anchor href=#_compatibiliteitspunten></a></h5><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> is niet compatibel met apparaten die met gbde versleuteld zijn. Alle <span class=filename>*.bde</span> apparaten moeten van de kernel ontkoppeld worden voordat <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> gebruikt wordt om te voorkomen dat het crasht tijdens het initiële zoeken naar apparaten. Om het versleutelde apparaat dat in dit voorbeeld gebruikt wordt te ontkoppelen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde detach /dev/ad4s1c</span></code></pre></div></div></div></div><div class=sect3><h4 id=_schijfversleuteling_met_geli>19.16.2. Schijfversleuteling met <code>geli</code><a class=anchor href=#_schijfversleuteling_met_geli></a></h4><div class=paragraph><p>Een alternatieve cryptografische GEOM klassie is beschikbaar - <code>geli</code>. Deze wordt op het moment ontwikkeld door Paweł Jakub Dawidek &lt;<a href=mailto:pjd@FreeBSD.org>pjd@FreeBSD.org</a>>. <code>geli</code> verschilt van <code>gbde</code> in de mogelijkheden en in het gebruik van een andere methode voor het versleutelen.</p></div><div class=paragraph><p>De meest belangrijke mogelijkheden van <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> zijn:</p></div><div class=ulist><ul><li><p>Gebruikt het <a href="https://man.freebsd.org/cgi/man.cgi?query=crypto&amp;sektion=9&amp;format=html">crypto(9)</a> framework; als cryptografische hardware aanwezig is, gebruikt <code>geli</code> die automatisch;</p></li><li><p>Ondersteunt meedere cryptografische algoritmen. Op dit moment AES, Blowfish en 3DES;</p></li><li><p>Staat toe dat de root-partitie wordt versleuteld. De wachtwoordzin die wordt gebruikt om de root-partitie te versleutelen wordt opgevraagd tijdens het starten van een systeem;</p></li><li><p>Staat het gebruik van twee onafhankelijke sleutels toe, bijvoorbeeld een "sleutel" en een "bedrijfssleutel");</p></li><li><p><code>geli</code> is snel; het werkt met sector-naar-sector versleuteling;</p></li><li><p>Ondersteunt back-up en restore van Master Keys. Als een gebruiker sleutels moet vernietigen, is het mogelijk weer toegang te krijgen tot de gegevens door sleutels uit een back-up te halen;</p></li><li><p>Ondersteunt het koppelen van een schijf met een willekeurige, eenmalige sleutel. Handig voor swap-partities en tijdelijke bestandssystemen.</p></li></ul></div><div class=paragraph><p>Meer mogelijkheden van <code>geli</code> staan beschreven in de handleiding van <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>.</p></div><div class=paragraph><p>De volgende stappen beschrijven hoe ondersteuning voor <code>geli</code> in de FreeBSD-kernel ingeschakeld kan worden en hoe een nieuwe <code>geli</code> versleutelingsvoorziening gemaakt kan worden.</p></div><div class=paragraph><p>Het is noodzakelijk super-user rechten te hebben omdat de kernel wordt aangepast.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Toevoegen van <code>geli</code>-ondersteuning</p><div class=paragraph><p>Voeg de volgende regels toe aan het bestand met kernelinstellingen:</p></div><div class="literalblock programlisting"><div class=content><pre>options GEOM_ELI
device crypto</pre></div></div><div class=paragraph><p>Herbouw de kernel zoals beschreven is in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div><div class=paragraph><p>De <code>geli</code>-module kan ook bij het opstarten geladen worden. Voeg de volgende regel toe aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_eli_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Nu hoort <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> door de kernel ondersteund te worden.</p></div></li><li><p>Een Master Key genereren</p><div class=paragraph><p>Het volgende voorbeeld beschrijft hoe een sleutelbestand te maken, dat wordt gebruikt als onderdeel van de Master Key voor de versleutelde dienst die wordt aangekoppeld onder <span class=filename>/private</span>. Het sleutelbestand zorgt voor wat willekeurige gegevens die worden gebruikt om de Master Key te versleutelen. De Master Key wordt ook door een wachtwoordzin beschermd. De sectorgrootte van de dienst wordt 4 kB. Ook wordt beschreven hoe de <code>geli</code>-dienst te koppelen, er een bestandsysteem op te maken, dat aan te koppelen, hoe ermee te werken en tenslotte hoe te ontkoppelen.</p></div><div class=paragraph><p>Het wordt aangeraden een grotere sectorgrootte in te stellen (zoals 4 kB) voor betere prestaties.</p></div><div class=paragraph><p>De Master Key wordt beschermd door een wachtwoordzin en de gegevensbron voor het sleutelbestand wordt <span class=filename>/dev/random</span>. De sectorgrootte van <span class=filename>/dev/da2.eli</span>, die als dienst wordt aangeduid, wordt 4 kB.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/root/da2.key bs=64 count=1</span>
<span class=c># geli init -s 4096 -K /root/da2.key /dev/da2</span>
Enter new passphrase:
Reenter new passphrase:</code></pre></div></div><div class=paragraph><p>Het is niet verplicht om zowel een wachtwoordzijn als een sleutelbestand te gebruiken. De methodes kunnen onafhankelijk van elkaar gebruikt worden.</p></div><div class=paragraph><p>Als een sleutelbestand wordt opgegeven als "-", wordt de standaardinvoer gebruikt. In het onderstaande voorbeeld wordt aangegeven hoe meer dan een sleutelbestand kan worden gebruikt.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat sleutelbestand1 sleutelbestand2 sleutelbestand3 | geli init -K - /dev/da2</span></code></pre></div></div></li><li><p>De dienst koppelen met de gemaakte sleutel</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># geli attach -k /root/da2.key /dev/da2</span>
Enter passphrase:</code></pre></div></div><div class=paragraph><p>Het nieuwe platte tekst-apparaat wordt <span class=filename>/dev/da2.eli</span> genoemd.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/da2*</span>
/dev/da2  /dev/da2.eli</code></pre></div></div></li><li><p>Het nieuwe bestandssysteem maken</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/da2.eli bs=1m</span>
<span class=c># newfs /dev/da2.eli</span>
<span class=c># mount /dev/da2.eli /private</span></code></pre></div></div><div class=paragraph><p>Het versleutelde bestandssysteem moet nu zichtbaar zijn voor <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> en beschikbaar zijn voor gebruik:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># df -H</span>
Filesystem     Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a    248M    89M   139M    38%    /
/devfs         1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f    7.7G   2.3G   4.9G    32%    /usr
/dev/ad0s1d    989M   1.5M   909M     0%    /tmp
/dev/ad0s1e    3.9G   1.3G   2.3G    35%    /var
/dev/da2.eli   150G   4.1K   138G     0%    /private</code></pre></div></div></li><li><p>De dienst afkoppelen</p><div class=paragraph><p>Als het werk met de versleutelde partitie is afgehandeld en de <span class=filename>/private</span>-partitie niet langer nodig is, dan is het verstandig te overwegen de met <code>geli</code> versleutelde partitie af te koppelen van het bestandssysteem en de kernel.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /private</span>
<span class=c># geli detach da2.eli</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Meer informatie over <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> staat in de handleiding.</p></div><div class=sect4><h5 id=_gebruik_maken_van_het_geli_rc_d_script>19.16.2.1. Gebruik maken van het <span class=filename>geli</span> <span class=filename>rc.d</span> script.<a class=anchor href=#_gebruik_maken_van_het_geli_rc_d_script></a></h5><div class=paragraph><p>Bij <code>geli</code> hoort een <span class=filename>rc.d</span> script dat gebruikt kan worden om het gebruik van <code>geli</code> te vereenvoudigen. Een voorbeeld van hoe <code>geli</code> met <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> ingesteld kan worden volgt:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_devices=&#34;da2&#34;
geli_da2_flags=&#34;-p -k /root/da2.key&#34;</pre></div></div><div class=paragraph><p>Hiermee wordt <span class=filename>/dev/da2</span> ingesteld als <code>geli</code>-dienst met Master Key-bestand <span class=filename>/root/da2.key</span> en <code>geli</code> gebruikt geen wachtwoordzin als de dienst wordt gekoppeld (dit kan alleen gebruikt worden als <code>-P</code> is meegegeven tijdens de <code>geli init</code> fase van <code>geli</code>). Een systeem ontkoppelt de <code>geli</code>-dienst van de kernel voordat het afsluit.</p></div><div class=paragraph><p>Meer informatie over het instellen van rc.d staat in het onderdeel over <a href=./#configtuning-rcd>rc.d</a>.</p></div></div></div></div><div class=sect2><h3 id=swap-encrypting>19.17. Het versleutelen van de wisselbestand ruimte<a class=anchor href=#swap-encrypting></a></h3><div class=paragraph><p>Het versleutelen van de wisselbestand ruimte is gemakkelijk met FreeBSD te configureren. Afhankelijk van welke versie er gebruikt wordt zijn er verschillende configuratie opties en instellingen mogelijk. De <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> programma’s kunnen gebruikt worden voor het versleutelen van het wisselbestand. Beide systemen maken gebruik van het <span class=filename>encswap</span> <a href=./#configtuning-rcd>rc.d</a> script.</p></div><div class=paragraph><p>De vorige sectie, <a href=#disks-encrypting>Schijfpartities versleutelen</a>, biedt een korte discussie over de verschillende versleutel systemen.</p></div><div class=sect3><h4 id=_waarom_moet_het_wisselbestand_versleuteld_worden>19.17.1. Waarom moet het wisselbestand versleuteld worden?<a class=anchor href=#_waarom_moet_het_wisselbestand_versleuteld_worden></a></h4><div class=paragraph><p>Net als met het versleutelen van harde schijven, wordt het versleutelen van het wisselbestand gebruikt om gevoelige data te beschermen. Stelt u eens een applicatie voor dat omgaat het wachtwoorden. Zolang deze wachtwoorden in het fysieke geheugen blijven is er niets aan de hand. Echter zodra deze verplaatst worden naar het wisselbestand om ruimte te maken voor andere applicaties, kan het gebeuren dat de wachtwoorden onbeschermd op de harde schijf geschreven worden, waardoor het makkelijk te achterhalen is voor iemand die kwaad wilt. Het versleutelen van het wisselbestand biedt hierin een mogelijke uitkomst.</p></div></div><div class=sect3><h4 id=_voorbereiding_2>19.17.2. Voorbereiding<a class=anchor href=#_voorbereiding_2></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Tot het einde van deze sectie zal <span class=filename>ad0s1b</span> het wisselbestand bevatten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Tot op dit moment is het wisselbestand niet versleuteld. Het is mogelijk dat er reeds wachtwoorden of andere gevoelige data onbeschermd op de harde schijf geschreven zijn. Om dit te corrigeren, moet de data op de swap partitie overschreven worden met willekeurige data:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/ad0s1b bs=1m</span></code></pre></div></div></div><div class=sect3><h4 id=_versleutelen_van_het_wisselbestand_met_gbde8>19.17.3. Versleutelen van het wisselbestand met <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a><a class=anchor href=#_versleutelen_van_het_wisselbestand_met_gbde8></a></h4><div class=paragraph><p>Er moet gebruik gemaakt worden van het <code>.bde</code> achtervoegsel aan het apparaat in de respectievelijke <span class=filename>/etc/fstab</span>-regel betreffende het wisselbestand:</p></div><div class="literalblock programlisting"><div class=content><pre># Device		Mountpoint	FStype	Options		Dump	Pass#
/dev/ad0s1b.bde		none		swap	sw		0	0</pre></div></div></div><div class=sect3><h4 id=_versleutelen_van_het_wisselbestand_met_geli8>19.17.4. Versleutelen van het wisselbestand met <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a><a class=anchor href=#_versleutelen_van_het_wisselbestand_met_geli8></a></h4><div class=paragraph><p>Het opzetten van <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> voor het versleutelen van het wisselbestand is hetzelfde als dat van <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a>. Hier moet echter gebruik gemaakt worden van het <code>.eli</code> achtervoegsel aan het apparaat in de respectievelijke <span class=filename>/etc/fstab</span> wisselbestand regel:</p></div><div class="literalblock programlisting"><div class=content><pre># Device		Mountpoint	FStype	Options		Dump	Pass#
/dev/ad0s1b.eli		none		swap	sw		0	0</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> maakt standaard gebruik van het AES algoritme met een sleutellengte van 128 bits.</p></div><div class=paragraph><p>Optioneel kunnen deze standaardwaarden worden aangepast door gebruik te maken van de <code>geli_swap_flags</code> optie in <span class=filename>/etc/rc.conf</span>. De volgende regel verteld het <span class=filename>encswap</span> rc.d bestand om een <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> wisselbestand te maken met het Blowfish algoritme met een sleutel lengte van 128 bit, een sectorgrootte van 4 kilobytes en met de optie "ontkoppelen nadat de laatste afsluiting" gezet:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_swap_flags=&#34;-e blowfish -l 128 -s 4096 -d&#34;</pre></div></div><div class=paragraph><p>Zie de uitleg over het <code>onetime</code> commando in de <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> handleiding voor een lijst van mogelijke opties.</p></div></div><div class=sect3><h4 id=_controleren_of_het_werkt>19.17.5. Controleren of het werkt<a class=anchor href=#_controleren_of_het_werkt></a></h4><div class=paragraph><p>Zodra het systeem opnieuw opgestart is kan gekeken worden of alles nog goed werkt door gebruik te maken van het <code>swapinfo</code> commando.</p></div><div class=paragraph><p>Als gebruik gemaakt wordt van <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.bde    542720        0   542720     0%</code></pre></div></div><div class=paragraph><p>Als gebruik gemaakt wordt van <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.eli    542720        0   542720     0%</code></pre></div></div></div></div><div class=sect2><h3 id=disks-hast>19.18. Highly Available Storage (HAST)<a class=anchor href=#disks-hast></a></h3><div class=sect3><h4 id=_overzicht_2>19.18.1. Overzicht<a class=anchor href=#_overzicht_2></a></h4><div class=paragraph><p>Hoge beschikbaarheid is een van de hoofdzaken in serieuze zakelijke toepassingen en hoog beschikbare opslag is een sleutelonderdeel in zulke omgevingen. Hoog beschikbare opslag, of HAST, werd ontwikkeld door Paweł Jakub Dawidek &lt;<a href=mailto:pjd@FreeBSD.org>pjd@FreeBSD.org</a>> als een raamwerk dat transparante opslag van dezelfde gegevens toestaat over fysiek gescheiden machines die verbonden zijn door een TCP/IP-netwerk. HAST kan gezien worden als een netwerkgebaseerde RAID1 (spiegel) en is vergelijkbaar met het DRBD® opslagsysteem bekend van het GNU/Linux® platform. In combinatie met andere eigenschappen voor hoge beschikbaarheid van FreeBSD zoals CARP maakt HAST het mogelijk om een opslagcluster met hoge beschikbaarheid te bouwen dat resistent is tegen falende hardware.</p></div><div class=paragraph><p>Na het lezen van deze sectie weet u:</p></div><div class=ulist><ul><li><p>Wat HAST is, hoe het werkt en welke mogelijkheden het biedt.</p></li><li><p>Hoe HAST op FreeBSD te op te zetten en te gebruiken.</p></li><li><p>Hoe CARP en <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> te integreren om een robuust opslagsysteem te bouwen.</p></li></ul></div><div class=paragraph><p>Voor het lezen van deze sectie dient u:</p></div><div class=ulist><ul><li><p>De beginselen van UNIX® en FreeBSD te begrijpen (<a href=./#basics>UNIX® beginselen</a>).</p></li><li><p>Te weten hoe de netwerkinterfaces en andere kerndeelsystemen van FreeBSD in te stellen (<a href=./#config-tuning>Instellingen en optimalisatie</a>).</p></li><li><p>Netwerken op FreeBSD goed te begrijpen (<a href=./#network-communication>Netwerkcommunicatie</a>).</p></li><li><p>FreeBSD 8.1-RELEASE of nieuwer te gebruiken.</p></li></ul></div><div class=paragraph><p>Het HAST-project werd gesponsord door The FreeBSD Foundation met ondersteuning van <a href=http://www.omc.net/>OMCnet Internet Service GmbH</a> en <a href=http://www.transip.nl/>TransIP BV</a>.</p></div></div><div class=sect3><h4 id=_eigenschappen_van_hast>19.18.2. Eigenschappen van HAST<a class=anchor href=#_eigenschappen_van_hast></a></h4><div class=paragraph><p>De belangrijkste eigenschappen van HAST zijn:</p></div><div class=ulist><ul><li><p>Het kan gebruikt worden om I/O-fouten op lokale harde schijven te maskeren.</p></li><li><p>Agnostisch qua bestandssysteem, dus het werkt met elk bestandssysteem dat door FreeBSD wordt ondersteund.</p></li><li><p>Efficiënte en snelle hersynchronisatie, alleen de blokken die zijn veranderd toen een knooppunt uitstond worden gesynchroniseerd.</p></li><li><p>Het kan gebruikt worden in reeds uitgerolde omgevingen om aanvullende redundantie toe te voegen.</p></li><li><p>Samen met CARP, Heartbeat of andere gereedschappen kan het worden gebruikt om een robuust en duurzaam opslagsysteem te bouwen.</p></li></ul></div></div><div class=sect3><h4 id=_werking_van_hast>19.18.3. Werking van HAST<a class=anchor href=#_werking_van_hast></a></h4><div class=paragraph><p>Omdat HAST synchrone replicatie op blokniveau van elk opslagmedium naar verscheidene machines biedt, heeft het tenminste twee knooppunten (fysieke machines) nodig - het <code>primaire</code> (ook bekend als <code>meester</code>) knooppunt en het <code>secundaire</code> (<code>slaaf</code>) knooppunt. Tezamen worden deze twee machines een cluster genoemd.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>HAST is momenteel beperkt tot een totaal van twee clusterknooppunten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Aangezien HAST in een primaire-secundaire configuratie werkt, kan er op elk moment slechts één van de clusterknooppunten actief zijn. Het <code>primaire</code> knooppunt, ookwel <code>actief</code>, is degene die alle I/O-verzoeken aan apparaten die door HAST worden beheerd afhandelt. Het <code>secundaire</code> knooppunt wordt dan automatisch gesynchroniseerd vanuit het <code>primaire</code> knooppunt.</p></div><div class=paragraph><p>De fysieke componenten van het HAST-systeem zijn:</p></div><div class=ulist><ul><li><p>lokale schijf (op primair knooppunt)</p></li><li><p>schijf op verre machine (secundair knooppunt)</p></li></ul></div><div class=paragraph><p>HAST werkt synchroon op blokniveau, wat het transparant maakt voor bestandssystemen en toepassingen. HAST biedt reguliere GEOM-aanbieders aan in <span class=filename>/dev/hast/</span> voor zowel andere gereedschappen als toepassingen, er is dus geen verschil tussen het gebruik van apparaten die door HAST worden geleverd en rauwe schijven, partities, etc.</p></div><div class=paragraph><p>Elke bewerking met betrekking tot schrijven, verwijderen of spoelen wordt naar de plaatselijke schijf en over TCP/IP naar de verre schijf gestuurd. Elke leesbewerking wordt gedaan door de plaatselijke schijf, tenzij de plaatselijke schijf niet actueel is of er een I/O-fout optreed. In zulke gevallen wordt de leesbewerking naar het secundaire knooppunt gestuurd.</p></div><div class=sect4><h5 id=_synchronisatie_en_replicatiemodi>19.18.3.1. Synchronisatie- en replicatiemodi<a class=anchor href=#_synchronisatie_en_replicatiemodi></a></h5><div class=paragraph><p>HAST probeert om een snel herstel van fouten te leveren. Om deze reden is het heel belangrijk om de synchronisatietijd te verkorten nadat een knooppunt is hersteld van een uitval. Om een snelle synchronisatie te leveren, beheert HAST op de schijf een bitmap van gebruikte extents en synchroniseert het die alleen tijdens een reguliere synchronisatie (met uitzondering van de initiëe synchronisatie).</p></div><div class=paragraph><p>Er zijn vele manieren om synchronisatie af te handelen. HAST implementeert meerdere replicatiemodi om verschillende synchronisatiemethodes af te handelen:</p></div><div class=ulist><ul><li><p><em>memsync</em>: rapporteer een schrijfbewerking als voltooid wanneer de plaatselijke schrijfbewerking klaar is en wanneer het verre knooppunt de gegevensaankomst bevestigt, maar voordat het de gegevens daadwerkelijk heeft opgeslagen. De gegevens op het verre knooppunt zullen meteen na het versturen van de bevestiging worden opgeslagen. Deze modus is bedoeld om latency te verminderen en nog steeds een zeer goede betrouwbaarheid te bieden. De replicatiemodus <em>memsync</em> is momenteel niet geïmplementeerd.</p></li><li><p><em>fullsync</em>: rapporteer een schrijfbewerking als voltooid wanneer zowel de plaatselijke en de verre schrijfbewerking voltooid zijn. Dit is de veiligste en traagste replicatiemodus. Dit is de standaardmodus.</p></li><li><p><em>async</em>: rapporteer de schrijfbewerking als voltooid wanneer de plaatselijke schrijfbewerking klaar is. Dit is de snelste en gevaarlijkste replicatiemodus. Het dient gebruikt te worden wanneer er naar een ver knooppunt wordt gerepliceerd en de latency te hoog is voor andere modi. De replicatiemodus <em>async</em> is momenteel niet geïmplementeerd.</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Momenteel wordt alleen de replicatiemodus <em>fullsync</em> ondersteund.</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=_hast_configuratie>19.18.4. HAST-configuratie<a class=anchor href=#_hast_configuratie></a></h4><div class=paragraph><p>HAST heeft ondersteuning voor <code>GEOM_GATE</code> nodig om te kunnen functioneren. De kernel <code>GENERIC</code> bevat standaard <em>geen</em> <code>GEOM_GATE</code>, de laadbare module <span class=filename>geom_gate.ko</span> is echter beschikbaar in de standaardinstallatie van FreeBSD. Zorg ervoor dat deze module beschikbaar is voor afgeslankte systemen. Het is ook mogelijk om ondersteuning voor <code>GEOM_GATE</code> statisch in de kernel te bouwen, door deze regel aan het kernelconfiguratiebestand toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>options	GEOM_GATE</pre></div></div><div class=paragraph><p>Het HAST-raamwerk bestaat vanuit het besturingssysteem gezien uit verschillende delen:</p></div><div class=ulist><ul><li><p>het daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> dat verantwoordelijk is voor de gegevenssynchronisatie,</p></li><li><p>het beheerprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=hastctl&amp;sektion=8&amp;format=html">hastctl(8)</a> voor de gebruikers,</p></li><li><p>het configuratiebestand <a href="https://man.freebsd.org/cgi/man.cgi?query=hast.conf&amp;sektion=5&amp;format=html">hast.conf(5)</a>.</p></li></ul></div><div class=paragraph><p>Het volgende voorbeeld beschrijft hoe twee knooppunten in een <code>meester</code>-<code>slaaf</code> / <code>primaire</code>-<code>secundaire</code> opstelling te configureren door HAST te gebruiken om de gegevens tussen de twee te repliceren. De knooppunten worden <code>hasta</code> met IP-adres <em>172.16.0.1</em> en <code>hastb</code> met IP-adres <em>172.16.0.2</em> genoemd. Beide knooppunten hebben een toegewijde harde schijf <span class=filename>/dev/ad6</span> van dezelfde grootte om met HAST te werken. De HAST-pool (soms ook een hulpbron genoemd, i.e., de GEOM-aanbieder in <span class=filename>/dev/hast/</span>) wordt <span class=filename>test</span> genoemd.</p></div><div class=paragraph><p>Het bestand <span class=filename>/etc/hast.conf</span> regelt de configuratie van HAST. Dit bestand dient hetzelfde te zijn op beide knooppunten. Het volgende is de eenvoudigste configuratie die mogelijk is:</p></div><div class="literalblock programlisting"><div class=content><pre>resource test {
	on hasta {
		local /dev/ad6
		remote 172.16.0.2
	}
	on hastb {
		local /dev/ad6
		remote 172.16.0.1
	}
}</pre></div></div><div class=paragraph><p>Raadpleeg voor geavanceerdere configuraties de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=hast.conf&amp;sektion=5&amp;format=html">hast.conf(5)</a>.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Het is ook mogelijk om hostnamen in de regels met <code>remote</code> te gebruiken. Zorg er in dat geval voor dat deze hosts vindbaar zijn, bijvoorbeeld doordat ze zijn gedefinieerd in het bestand <span class=filename>/etc/hosts</span> of anders in het plaatselijke DNS.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Nu de configuratie op beide knooppunten aanwezig is, kan de HAST-pool aangemaakt worden . Voer deze commando’s op beide knooppunten uit om de initiële metagegevens op de plaatselijke schijf te plaatsen en het <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a>-daemon te starten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl create test</span>
<span class=c># service hastd onestart</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is <em>niet</em> mogelijk om GEOM-aanbieders met een bestaand bestandssysteem te gebruiken (i.e., een bestaande opslag omzetten naar een door HAST beheerde pool), omdat deze procedure wat metagegevens op de aanbieder moet opslaan en er daarvoor niet genoeg beschikbare ruimte is.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De rol van een HAST-knooppunt (<code>primair</code> of <code>secundair</code>) wordt uitgekozen door een beheerder of software zoals Heartbeat dat het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=hastctl&amp;sektion=8&amp;format=html">hastctl(8)</a> gebruikt. Voer het volgende commando uit op het primaire knooppunt ( <code>hasta</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl role primary test</span></code></pre></div></div><div class=paragraph><p>Voer dit soortgelijke commando uit op het secundaire knooppunt ( <code>hastb</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl role secondary test</span></code></pre></div></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>De situatie dat de knooppunten niet met elkaar kunnen communiceren en beide geconfigureerd zijn als primaire knooppunten; wordt <code>split-brain</code> genoemd. Volg de stappen zoals beschreven in <a href=#disks-hast-sb>Herstellen van de Split-brain-conditie</a> om deze situatie op te lossen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Verifieer met het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=hastctl&amp;sektion=8&amp;format=html">hastctl(8)</a> het resultaat op elk knooppunt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl status test</span></code></pre></div></div><div class=paragraph><p>De belangrijke tekst is de regel met <code>status</code> dat voor alle knooppunten <code>complete</code> dient te bevatten. Als het <code>degraded</code> bevat, is er iets verkeerd gegaan. Op dat moment is de synchronisatie tussen de knooppunten al begonnen. De synchronisatie is compleet wanneer <code>hastctl status</code> 0 bytes aan <code>dirty</code> extents rapporteert.</p></div><div class=paragraph><p>De volgende stap is het aanmaken van een bestandssysteem op de GEOM-aanbieder <span class=filename>/dev/hast/test</span> en het aan te koppelen. Dit moet op het <code>primaire</code> knooppunt gebeuren, aangezien <span class=filename>/dev/hast/test</span> alleen op het <code>primaire</code> knooppunt verschijnt. Het aanmaken van het bestandssysteem kan afhankelijk van de grootte van de harde schijf enkele minuten duren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U /dev/hast/test</span>
<span class=c># mkdir /hast/test</span>
<span class=c># mount /dev/hast/test /hast/test</span></code></pre></div></div><div class=paragraph><p>Wanneer het HAST-raamwerk correct is geconfigureerd, betreft de laatste stap het ervoor zorgen dat HAST automatisch tijdens het opstarten wordt gestart. Voeg deze regel toe aan het bestand <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hastd_enable=&#34;YES&#34;</pre></div></div><div class=sect4><h5 id=_failover_configuratie>19.18.4.1. Failover-configuratie<a class=anchor href=#_failover_configuratie></a></h5><div class=paragraph><p>Het doel van dit voorbeeld is om een robuust opslagsysteem te bouwen dat resistent is tegen het falen van alle knooppunten. Het scenario is dat een <code>primair</code> knooppunt van het cluster faalt. Als dit gebeurt, dan neemt het <code>secundaire</code> knooppunt het feilloos over, controleert het het bestandssysteem en koppelt het het bestandssysteem aan, en gaat het verder zonder dat er een bit aan gegevens ontbreekt.</p></div><div class=paragraph><p>Om dit voor elkaar te krijgen, is er een andere eigenschap die beschikbaar is op FreeBSD dat voorziet in automatische failover van de IP-laag - CARP. CARP (Common Address Redundancy Protocol) maakt het mogelijk dat meerdere hosts in hetzelfde netwerksegment een IP-adres delen. Stel CARP in op beide knooppunten van het cluster volgens de documentatie die beschikbaar is in <a href=./#carp>Common Address Redundancy Protocol (CARP)</a>. Nadat de opzet voltooid is, heeft elk knooppunt een eigen interface <span class=filename>carp0</span> met een gedeeld IP-adres <em>172.16.0.254</em>. Het primaire HAST-knooppunt van het cluster moet het meester-CARP-knooppunt zijn.</p></div><div class=paragraph><p>De HAST-pool die in de vorige sectie is gemaakt is nu klaar om geëxporteerd te worden naar de andere hosts op het netwerk. Dit kan gedaan worden door het te exporteren over NFS, Samba, etc., door gebruik te maken van het gedeelde IP-adres <em>172.16.0.254</em>. Het enige overgebleven probleem is een automatische failover in het geval dat het primaire knooppunt het begeeft.</p></div><div class=paragraph><p>Als een CARP-interface aan- of uitgaat, genereert FreeBSD een <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a>-gebeurtenis, wat het mogelijk maakt om toestandsveranderingen op de CARP-interfaces in de gaten te houden. Een toestandsverandering op het CARP-interface geeft aan dat een van de knooppunten het begaf of weer online kwam. Deze toestandsveranderingen maken het mogelijk om een script te draaien dat automatisch de HAST-failover afhandelt.</p></div><div class=paragraph><p>Voeg, om toestandsverandering op de CARP-interfaces af te vangen, het volgende toe aan het bestand <span class=filename>/etc/devd.conf</span> op elk knooppunt:</p></div><div class="literalblock programlisting"><div class=content><pre>notify 30 {
	match &#34;system&#34; &#34;IFNET&#34;;
	match &#34;subsystem&#34; &#34;carp0&#34;;
	match &#34;type&#34; &#34;LINK_UP&#34;;
	action &#34;/usr/local/sbin/carp-hast-switch master&#34;;
};

notify 30 {
	match &#34;system&#34; &#34;IFNET&#34;;
	match &#34;subsystem&#34; &#34;carp0&#34;;
	match &#34;type&#34; &#34;LINK_DOWN&#34;;
	action &#34;/usr/local/sbin/carp-hast-switch slave&#34;;
};</pre></div></div><div class=paragraph><p>Herstart <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> op beide knooppunten om de nieuwe configuratie te laten gelden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service devd restart</span></code></pre></div></div><div class=paragraph><p>Als het interface <span class=filename>carp0</span> aan of uit gaat (i.e., de toestand van het interface verandert), genereert het systeem een notificatie wat het subsysteem <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> in staat stelt om een willekeurig script te draaien, in dit geval <span class=filename>/usr/local/sbin/carp-hast-switch</span>. Dit is het script dat de automatische failover afhandelt. Raadpleeg de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=devd.conf&amp;sektion=5&amp;format=html">devd.conf(5)</a> voor verdere uitleg over de bovenstaande configuratie van <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a>.</p></div><div class=paragraph><p>Dit zou een voorbeeld van zo’n script kunnen zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
# Origineel script door Freddie Cash &lt;fjwcash@gmail.com&gt;
# Gewijzigd door Michael W. Lucas &lt;mwlucas@BlackHelicopters.org&gt;
# en Viktor Petersson &lt;vpetersson@wireload.net&gt;

# De namen van de HAST-hulpbronnen, zoals vermeld in /etc/hast.conf
resources=&#34;test&#34;

# vertraging voor het aankoppelen van de HAST-hulpbron na het worden van meester
# doe een gok
delay=3

# logging
log=&#34;local0.debug&#34;
name=&#34;carp-hast&#34;

# einde van gebruiker-instelbare dingen

case &#34;$1&#34; in
	master)
		logger -p $log -t $name &#34;Omschakelen naar primaire aanbieder voor ${resources}.&#34;
		sleep ${delay}

		# Wacht totdat de &#34;hastd secondary&#34; processen zijn gestopt
		for disk in ${resources}; do
			while $( pgrep -lf &#34;hastd: ${disk} \(secondary\)&#34; &gt; /dev/null 2&gt;&amp;1 ); do
				sleep 1
			done

			# Verwissel de rol voor elke schijf
			hastctl role primary ${disk}
			if [ $? -ne 0 ]; then
				logger -p $log -t $name &#34;Omschakelen van rol naar primair voor hulpbron ${disk} mislukt.&#34;
				exit 1
			fi
		done

		# Wacht totdat de apparaten /dev/hast/* verschijnen
		for disk in ${resources}; do
			for I in $( jot 60 ); do
				[ -c &#34;/dev/hast/${disk}&#34; ] &amp;&amp; break
				sleep 0.5
			done

			if [ ! -c &#34;/dev/hast/${disk}&#34; ]; then
				logger -p $log -t $name &#34;GEOM-aanbieder /dev/hast/${disk} is niet verschenen.&#34;
				exit 1
			fi
		done

		logger -p $log -t $name &#34;Rollen van HAST-hulpbronnen ${resources} omgeschakeld naar primair.&#34;

		logger -p $log -t $name &#34;Schijven aankoppelen.&#34;
		for disk in ${resources}; do
			mkdir -p /hast/${disk}
			fsck -p -y -t ufs /dev/hast/${disk}
			mount /dev/hast/${disk} /hast/${disk}
		done

	;;

	slave)
		logger -p $log -t $name &#34;Omschakelen naar secundaire aanbieder voor ${resources}.&#34;

		# Schakel de rollen van de HAST-hulpbronnen om
		for disk in ${resources}; do
			if ! mount | grep -q &#34;^/dev/hast/${disk} on &#34;
			then
			else
				umount -f /hast/${disk}
			fi
			sleep $delay
			hastctl role secondary ${disk} 2&gt;&amp;1
			if [ $? -ne 0 ]; then
				logger -p $log -t $name &#34;Omschakelen van rol naar secundair voor hulpbron ${disk} mislukt.&#34;
				exit 1
			fi
			logger -p $log -t $name &#34;Rol van hulpbron ${disk} omgeschakeld naar secundair.&#34;
		done
	;;
esac</pre></div></div><div class=paragraph><p>In een notendop neemt het script deze acties wanneer een knooppunt <code>meester</code> / <code>primair</code> wordt:</p></div><div class=ulist><ul><li><p>De HAST-pools opwaarderen naar primair op een gegeven knooppunt.</p></li><li><p>Het bestandssysteem onder de HAST-pool controleren.</p></li><li><p>De pools op een juiste plaats aankoppelen.</p></li></ul></div><div class=paragraph><p>Wanneer een knooppunt <code>back-up</code> / <code>secundair</code> wordt:</p></div><div class=ulist><ul><li><p>De HAST-pools afkoppelen.</p></li><li><p>De HAST-pools degraderen naar secundair.</p></li></ul></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Houd in gedachte dat dit slechts een voorbeeldscript is om aan te tonen dat alles werkt. Het behandeld niet alle mogelijke situaties en kan op elke manier worden uitgebreid of veranderd, het kan bijvoorbeeld benodigde diensten starten en stoppen.</p></div></td></tr></tbody></table></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Voor dit voorbeeld hebben we een standaard UFS-bestandssysteem gebruikt. Om de tijd die nodig is voor herstel te verkorten, kan een bestandssysteem met UFS-journalling of ZFS worden gebruikt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Meer gedetailleerde informatie met aanvullende voorbeelden kunnen gevonden worden op de <a href=http://wiki.FreeBSD.org/HAST>HAST Wiki</a>-pagina.</p></div></div></div><div class=sect3><h4 id=_problemen_oplossen_3>19.18.5. Problemen oplossen<a class=anchor href=#_problemen_oplossen_3></a></h4><div class=sect4><h5 id=_algemene_tips_om_problemen_op_te_lossen>19.18.5.1. Algemene tips om problemen op te lossen<a class=anchor href=#_algemene_tips_om_problemen_op_te_lossen></a></h5><div class=paragraph><p>HAST zou over het algemeen zonder problemen moeten werken. Net als met elk ander software-product zijn er momenten waarop het anders werkt dan het zou moeten. De oorzaken van de problemen kunnen verschillen, maar de vuistregel is om ervoor te zorgen dat de klokken zijn gesynchroniseerd op alle knooppunten in het cluster.</p></div><div class=paragraph><p>Wanneer problemen met HAST worden verholpen, dient het debug-niveau van <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> verhoogd te worden door het daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> met het argument <code>-d</code> op te starten. Merk op dat dit argument meerdere malen kan worden opgegeven om het debug-niveau nog verder op te hogen. Op deze manier kan veel nuttige informatie worden vergaard. Overweeg ook om het argument <code>-F</code> te gebruiken, dat het daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> in de voorgrond zal starten.</p></div></div><div class=sect4><h5 id=disks-hast-sb>19.18.5.2. Herstellen van de Split-brain-conditie<a class=anchor href=#disks-hast-sb></a></h5><div class=paragraph><p><code>Split-brain</code> treedt op waneer de knooppunten van het cluster niet met elkaar kunnen communiceren, en beide als primair zijn geconfigureerd. Dit is een gevaarlijke situatie omdat het beide knooppunten in staat stelt om incompatibele veranderingen aan de gegevens te maken. Dit probleem dient handmatig door de systeembeheerder te worden gecorrigeerd.</p></div><div class=paragraph><p>De beheerder moet besluiten welk knooppunt de belangrijkere veranderingen bevat (of ze handmatig samenvoegen) en HAST een volledige synchronisatie op het knooppunt dat de kapotte gegevens heeft laten uitvoeren. Voer hiervoor deze commando’s uit op het knooppunt dat opnieuw gesynchroniseerd moet worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl role init &lt;resource&gt;</span>
<span class=c># hastctl create &lt;resource&gt;</span>
<span class=c># hastctl role secondary &lt;resource&gt;</span></code></pre></div></div></div></div></div></div></div><div class=sect1><h2 id=geom>Hoofdstuk 20. GEOM. Modulair schijftransformatie raamwerk<a class=anchor href=#geom></a></h2><div class=sectionbody><div class=sect2><h3 id=geom-synopsis>20.1. Overzicht<a class=anchor href=#geom-synopsis></a></h3><div class=paragraph><p>Dit hoofdstuk beschrijft het gebruik van schijven in het GEOM raamwerk in FreeBSD. Hieronder vallen de belangrijkste RAID besturingsprogramma’s die het raamwerk gebruikt voor instellingen. In dit hoofdstuk wordt niet diepgaand beschreven hoe GEOM omgaat met I/O, het onderliggende subsysteem of code. Die informatie staat in het hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=geom&amp;sektion=4&amp;format=html">geom(4)</a> en de verscheidene "SEE ALSO" referenties. Dit hoofdstuk is ook geen definitief stuk over het instellen van RAID. Alleen de door GEOM ondersteunde RAID-classificaties worden beschreven.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Welk type RAID-ondersteuning via GEOM beschikbaar is;</p></li><li><p>Hoe de basisgereedschappen te gebruiken om de verschillende RAID-niveaus in te stellen, te onderhouden en te wijzigen;</p></li><li><p>Hoe schijfapparaten via GEOM te spiegelen, aaneen te schakelen, te versleutelen en vanaf afstand schijven aan te sluiten;</p></li><li><p>Hoe problemen op te lossen met schijven die via het GEOM raamwerk zijn aangesloten.</p></li></ul></div><div class=paragraph><p>Veronderstelde voorkennis:</p></div><div class=ulist><ul><li><p>Begrijpen hoe FreeBSD omgaat met schijfapparaten (<a href=./#disks>Stockage des données</a>);</p></li><li><p>Weten hoe een nieuwe FreeBSD kernel in te stellen en te installeren (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li></ul></div></div><div class=sect2><h3 id=GEOM-intro>20.2. GEOM inleiding<a class=anchor href=#GEOM-intro></a></h3><div class=paragraph><p>GEOM staat toegang en controle toe op klassen, Master Boot Records, BSD labels, enzovoort, door gebruik te maken van diensten of de speciale bestanden in <span class=filename>/dev</span>. GEOM ondersteunt verschillende software RAID instellingen en biedt transparante toegang tot het besturingssysteem en de hulpprogramma’s.</p></div></div><div class=sect2><h3 id=GEOM-striping>20.3. RAID0 - aaneengeschakeld<a class=anchor href=#GEOM-striping></a></h3><div class=paragraph><p>Aaneenschakelen is een methode die gebruikt wordt om meerdere schijven te combineren tot een enkele volume. In veel gevallen wordt dit gedaan met hardware controllers. Het GEOM subsysteem biedt softwareondersteuning voor RAID0, ook wel bekend als aaneenschakelen ("disk striping").</p></div><div class=paragraph><p>In een RAID0-systeem worden gegevens opgedeeld in blokken die verdeeld worden over de schijven in een reeks. In plaats van te hoeven wachten tot een systeem 256k naar één schijf heeft geschreven, kan een RAID0-systeem tegelijkertijd 64k naar vier verschillende schijven schrijven, waardoor superieure I/O prestaties worden bereikt. Deze prestaties kunnen nog verbeterd worden door meerdere schijfcontrollers te gebruiken.</p></div><div class=paragraph><p>Iedere schijf in een RAID0-aaneenschakeling moet van dezelfde grootte zijn, omdat I/O-verzoeken altijd zijn opgebouwd uit precies gelijk over de schijven verdeelde verzoeken tot lezen of schrijven.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/geom/striping.png alt="Illustratie aaneengeschakelde schijven"></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Ongeformatteerde ATA-schijven aaneenschakelen</strong></p></div><div class="olist arabic"><ol class=arabic><li><p>Laad de module <span class=filename>geom_stripe.ko</span>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload geom_stripe</span></code></pre></div></div></li><li><p>Zorg ervoor dat er een koppelpunt beschikbaar is. Als dit volume een rootpartitie wordt, gebruikt dan tijdelijk een ander koppelpunt zoals <span class=filename>/mnt</span>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /mnt</span></code></pre></div></div></li><li><p>Stel de apparaatnamen voor de schijven vast die aaneen worden geschakeld en maak het nieuwe apparaat aan. Om twee ongebruikte, ongepartitioneerde ATA schijven aaneen te schakelen (<span class=filename>/dev/ad2</span> en <span class=filename>/dev/ad3</span>):</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gstripe label -v st0 /dev/ad2 /dev/ad3</span>
Metadata value stored on /dev/ad2.
Metadata value stored on /dev/ad3.
Done.</code></pre></div></div></li><li><p>Schrijf een standaard label naar de nieuwe partitie, ook wel bekend als een partitietabel en installeer de standaard opstart code:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># bsdlabel -wB /dev/stripe/st0</span></code></pre></div></div></li><li><p>Dit proces hoort twee nieuwe apparaten gemaakt te hebben in de map <span class=filename>/dev/stripe</span> naast het apparaat <span class=filename>st0</span>, te weten <span class=filename>st0a</span> en <span class=filename>st0c</span>. Vanaf nu kan er een bestandssysteem op <span class=filename>st0a</span> worden gezet met behulp van de <code>newfs</code> applicatie:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U /dev/stripe/st0a</span></code></pre></div></div><div class=paragraph><p>Na het uitvoeren van het bovenstaande commando rollen er veel getallen over het scherm en na een aantal seconden is het proces afgerond. Het volume is gereed en klaar om aangekoppeld te worden.</p></div></li></ol></div></div></div><div class=paragraph><p>Om de nieuwe aaneengeschakelde schijf handmatig te koppelen moet het volgende gedaan worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/stripe/st0a /mnt</span></code></pre></div></div><div class=paragraph><p>Om dit aaneengeschakelde bestandssysteem automatisch aan te koppelen bij het opstarten wordt de volume-informatie in <span class=filename>/etc/fstab</span> gezet. Voor dit doel wordt een permanent koppelpunt, genaamd <span class=filename>stripe</span>, aangemaakt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /stripe</span>
<span class=c># echo &#34;/dev/stripe/st0a /mnt ufs rw 2 2&#34; \</span>
      <span class=o>&gt;&gt;</span> /etc/fstab</code></pre></div></div><div class=paragraph><p>Laadt de module <span class=filename>geom_stripe.ko</span> ook automatisch bij het initialiseren van een systeem door de volgende regel toe te voegen aan <span class=filename>/boot/loader.conf</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;geom_stripe_load=&#34;YES&#34;&#39; &gt;&gt; /boot/loader.conf</span></code></pre></div></div></div><div class=sect2><h3 id=GEOM-mirror>20.4. RAID1 - spiegelen<a class=anchor href=#GEOM-mirror></a></h3><div class=paragraph><p>RAID1, of <em>spiegelen</em>, is de techniek om dezelfde gegevens naar meer dan één schijf te schrijven. Spiegels worden normaliter gebruikt om tegen gegevensverlies te beschermen indien een schijf kapot gaat. Elke schijf in een spiegel bevat een identieke kopie van de gegevens. Wanneer een individuele schijf het begeeft, blijft de spiegel functioneren, en levert het gegevens van de schijven die nog wel functioneren. De computer blijft draaien en de beheerder heeft tijd om de kapotte schijf te vervangen zonder onderbreking voor de gebruikers.</p></div><div class=paragraph><p>Twee veelvoorkomende situaties worden in deze voorbeelden getoond. Het eerste is het maken van een spiegel van twee nieuwe schijven en het als vervanging voor een bestaande enkele schijf te gebruiken. Het tweede voorbeeld maakt een spiegel op een enkele nieuwe schijf aan, kopieert de gegevens van de oude schijf er naar toe, en plaatst daarna de oude schijf in de spiegel. Hoewel deze procedure iets moeilijker is, is er maar één nieuwe schijf nodig.</p></div><div class=paragraph><p>Traditioneel zijn de twee schijven in een spiegel van hetzelfde model en hebben ze dezelfde capaciteit, maar <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> verplicht dit niet. Spiegels die met ongelijke schijven zijn gemaakt zullen de capaciteit van de kleinste schijf in de spiegel aannemen. Extra schijfruimte op grotere schijven zal ongebruikt blijven. Schijven die later in de spiegel worden geplaatst moeten tenminste evenveel capaciteit hebben als de kleinste schijf die reeds in de spiegel zit.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>De procedures voor het spiegelen die hier getoond worden zijn niet-destructief, maar maak zoals bij elke grote schijfoperatie eerst een volledige back-up.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=GEOM-mirror-metadata>20.4.1. Kwesties met meta-gegevens<a class=anchor href=#GEOM-mirror-metadata></a></h4><div class=paragraph><p>Veel schijfsystemen slaan meta-gegevens op aan het einde van elke schijf. Oude meta-gegevens dienen gewist te worden voordat de schijf herbruikt wordt voor een spiegel. De meeste problemen worden veroorzaakt door twee soorten van achtergebleven meta-gegevens: GPT-partitietabellen en oude meta-gegevens van <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> van een vorige spiegel.</p></div><div class=paragraph><p>GPT-meta-gegevens kunnen gewist worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a>. Dit voorbeeld wist zowel de primaire als de back-up GPT-partitietabellen van schijf <span class=filename>ada8</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart destroy -F ada8</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> kan in één stap een schijf uit een actieve spiegel halen en de meta-gegevens wissen. Hier wordt de voorbeeldschijf <span class=filename>ada8</span> uit de actieve spiegel <span class=filename>gm4</span> gehaald:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror remove gm4 ada8</span></code></pre></div></div><div class=paragraph><p>Gebruik, als de spiegel niet draait maar er nog oude meta-gegevens van de spiegel op de schijf staan, <code>gmirror clear</code> om deze te verwijderen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror clear ada8</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> slaat één blok aan meta-gegevens aan het einde van de schijf op. Omdat GPT-partitieschema’s ook meta-gegevens aan het einde van de schijf opslaan, wordt het spiegelen van volledige GPT-schijven met <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> niet aangeraden. Hier wordt MBR-partitionering gebruikt omdat het alleen een partitietabel aan het begin van de schijf opslaat en niet conflicteert met <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a>.</p></div></div><div class=sect3><h4 id=_een_spiegel_met_twee_nieuwe_schijven_maken>20.4.2. Een spiegel met twee nieuwe schijven maken<a class=anchor href=#_een_spiegel_met_twee_nieuwe_schijven_maken></a></h4><div class=paragraph><p>In dit voorbeeld is FreeBSD reeds op een enkele schijf <span class=filename>ada0</span> geïnstalleerd. Twee nieuwe schijven, <span class=filename>ada1</span> en <span class=filename>ada2</span> zijn met het systeem verbonden. Er zal een nieuwe spiegel op deze twee schijven aangemaakt worden die de oude enkele schijf zal vervangen.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> heeft een kernelmodule <span class=filename>geom_mirror.ko</span> nodig, ingebouwd in de kernel of geladen tijdens het opstarten of draaien. Laadt nu handmatig de kernelmodule:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror load</span></code></pre></div></div><div class=paragraph><p>Maak de spiegel aan met de twee nieuwe schijven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror label -v gm0 /dev/ada1 /dev/ada2</span></code></pre></div></div><div class=paragraph><p><span class=filename>gm0</span> is een door de gebruiker gekozen apparaatnaam die aan de nieuwe spiegel wordt toegekend. Nadat de spiegel is gestart, zal deze apparaatnaam verschijnen in de map <span class=filename>/dev/mirror/</span>.</p></div><div class=paragraph><p>Nu kunnen er met <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a> MBR- en bsdlabel-partitietabellen op de spiegel worden aangemaakt. Hier wordt er een traditioneel schema van een gesplitst bestandssysteem getoond, met partities voor <span class=filename>/</span>, swap, <span class=filename>/var</span>, <span class=filename>/tmp</span> en <span class=filename>/usr</span>. Dit werkt ook voor een enkel bestandssysteem met enkel <span class=filename>/</span> en een wisselpartitie.</p></div><div class=paragraph><p>Partities op de spiegel hoeven niet dezelfde grootte te hebben als die op de bestaande schijf, maar moeten groot genoeg zijn om alle gegevens die reeds op <span class=filename>ada0</span> staan te kunnen bevatten.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart create -s MBR mirror/gm0</span>
<span class=c># gpart add -t freebsd -a 4k mirror/gm0</span>
<span class=c># gpart show mirror/gm0</span>
<span class=o>=&gt;</span>       63  156301423  mirror/gm0  MBR  <span class=o>(</span>74G<span class=o>)</span>
         63         63                    - free -  <span class=o>(</span>31k<span class=o>)</span>
        126  156301299                 1  freebsd  <span class=o>(</span>74G<span class=o>)</span>
  156301425         61                    - free -  <span class=o>(</span>30k<span class=o>)</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart create -s BSD mirror/gm0s1</span>
<span class=c># gpart add -t freebsd-ufs  -a 4k -s 2g mirror/gm0s1</span>
<span class=c># gpart add -t freebsd-swap -a 4k -s 4g mirror/gm0s1</span>
<span class=c># gpart add -t freebsd-ufs  -a 4k -s 2g mirror/gm0s1</span>
<span class=c># gpart add -t freebsd-ufs  -a 4k -s 1g mirror/gm0s1</span>
<span class=c># gpart add -t freebsd-ufs  -a 4k       mirror/gm0s1</span>
<span class=c># gpart show mirror/gm0s1</span>
<span class=o>=&gt;</span>        0  156301299  mirror/gm0s1  BSD  <span class=o>(</span>74G<span class=o>)</span>
          0          2                      - free -  <span class=o>(</span>1.0k<span class=o>)</span>
          2    4194304                   1  freebsd-ufs  <span class=o>(</span>2.0G<span class=o>)</span>
    4194306    8388608                   2  freebsd-swap  <span class=o>(</span>4.0G<span class=o>)</span>
   12582914    4194304                   4  freebsd-ufs  <span class=o>(</span>2.0G<span class=o>)</span>
   16777218    2097152                   5  freebsd-ufs  <span class=o>(</span>1.0G<span class=o>)</span>
   18874370  137426928                   6  freebsd-ufs  <span class=o>(</span>65G<span class=o>)</span>
  156301298          1                      - free -  <span class=o>(</span>512B<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Maak de spiegel opstartbaar door opstartcode in het MBR en bsdlabel te installeren en de actieve slice in te stellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart bootcode -b /boot/mbr mirror/gm0</span>
<span class=c># gpart set -a active -i 1 mirror/gm0</span>
<span class=c># gpart bootcode -b /boot/boot mirror/gm0s1</span></code></pre></div></div><div class=paragraph><p>Formatteer de bestandssystemen op de nieuwe spiegel en zet daarbij soft-updates aan.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U /dev/mirror/gm0s1a</span>
<span class=c># newfs -U /dev/mirror/gm0s1d</span>
<span class=c># newfs -U /dev/mirror/gm0s1e</span>
<span class=c># newfs -U /dev/mirror/gm0s1f</span></code></pre></div></div><div class=paragraph><p>Bestandssystemen van de originele schijf (<span class=filename>ada0</span>) kunnen nu met <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a> naar de spiegel gekopieerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/mirror/gm0s1a /mnt</span>
<span class=c># dump -C16 -b64 -0aL -f - / | (cd /mnt &amp;&amp; restore -rf -)</span>
<span class=c># mount /dev/mirror/gm0s1d /mnt/var</span>
<span class=c># mount /dev/mirror/gm0s1e /mnt/tmp</span>
<span class=c># mount /dev/mirror/gm0s1f /mnt/usr</span>
<span class=c># dump -C16 -b64 -0aL -f - /var | (cd /mnt/var &amp;&amp; restore -rf -)</span>
<span class=c># dump -C16 -b64 -0aL -f - /tmp | (cd /mnt/tmp &amp;&amp; restore -rf -)</span>
<span class=c># dump -C16 -b64 -0aL -f - /usr | (cd /mnt/usr &amp;&amp; restore -rf -)</span></code></pre></div></div><div class=paragraph><p><span class=filename>/mnt/etc/fstab</span> moet bewerkt worden om naar de nieuwe bestandssystemen op de spiegel te wijzen:</p></div><div class="literalblock programlisting"><div class=content><pre># Device		Mountpoint	FStype	Options	Dump	Pass#
/dev/mirror/gm0s1a	/		ufs	rw	1	1
/dev/mirror/gm0s1b	none		swap	sw	0	0
/dev/mirror/gm0s1d	/var		ufs	rw	2	2
/dev/mirror/gm0s1e	/tmp		ufs	rw	2	2
/dev/mirror/gm0s1f	/usr		ufs	rw	2	2</pre></div></div><div class=paragraph><p>Als de kernelmodule <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> niet in de kernel is ingebouwd, wordt <span class=filename>/mnt/boot/loader.conf</span> bewerkt om de module tijdens het opstarten te laden:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_mirror_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Herstart het systeem om de nieuwe spiegel te testen en te verifiëren dat alle gegevens zijn gekopieerd. Het BIOS zal de spiegel als twee individuele schijven zien in plaats van als een spiegel. Omdat de schijven identiek zijn, maakt het niet uit vanaf welke schijf wordt opgestart.</p></div><div class=paragraph><p>Bekijk de sectie <a href=#gmirror-troubleshooting>Problemen oplossen</a> als er problemen zijn tijdens het opstarten. Door de originele <span class=filename>ada0</span> uit te schakelen en los te koppelen kan het als offline back-up bewaard worden.</p></div><div class=paragraph><p>Tijdens het gebruik zal de spiegel zich net zoals de originele enkele schijf gedragen.</p></div></div><div class=sect3><h4 id=_een_spiegel_met_een_bestaande_schijf_aanmaken>20.4.3. Een spiegel met een bestaande schijf aanmaken<a class=anchor href=#_een_spiegel_met_een_bestaande_schijf_aanmaken></a></h4><div class=paragraph><p>In dit voorbeeld is FreeBSD reeds geïnstalleerd op een enkele schijf, <span class=filename>ada0</span>. Een nieuwe schijf, <span class=filename>ada1</span>, is met het systeem verbonden. Er zal een spiegel van één schijf worden aangemaakt op de nieuwe schijf, het bestaande systeem zal ernaar worden gekopieerd, en daarna zal de oude schijf in de spiegel worden geplaatst. Deze enigszins complexe procedure is nodig omdat <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> een blok van 512 bytes aan meta-gegevens aan het einde van elke schijf moet plaatsen en de bestaande <span class=filename>ada0</span> meestal alle ruimte reeds heeft toegewezen.</p></div><div class=paragraph><p>Laadt de kernelmodule <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror load</span></code></pre></div></div><div class=paragraph><p>Controleer de mediagrootte van de originele schijf met <a href="https://man.freebsd.org/cgi/man.cgi?query=diskinfo&amp;sektion=8&amp;format=html">diskinfo(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># diskinfo -v ada0 | head -n3</span>
/dev/ada0
	512             <span class=c># sectorsize</span>
	1000204821504   <span class=c># mediasize in bytes (931G)</span></code></pre></div></div><div class=paragraph><p>Maak een spiegel aan op de nieuwe schijf. Om er zeker van te zijn dat de capaciteit van de spiegel niet groter is dan die van de originele schijf, wordt <a href="https://man.freebsd.org/cgi/man.cgi?query=gnop&amp;sektion=8&amp;format=html">gnop(8)</a> gebruikt om een nepschijf van precies dezelfde grootte aan te maken. Deze schijf slaat geen gegevens op, maar wordt alleen gebruikt om de grootte van de spiegel te begrenzen. Wanneer <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> de spiegel aanmaakt, zal het de capaciteit beperken tot de grootte van <span class=filename>gzero.nop</span> zelfs als de nieuwe schijf (<span class=filename>ada1</span>) meer ruimte heeft. Merk op dat de <em>1000204821504</em> op de tweede regel gelijk moet zijn aan de mediagrootte van <span class=filename>ada0</span> zoals hierboven door <a href="https://man.freebsd.org/cgi/man.cgi?query=diskinfo&amp;sektion=8&amp;format=html">diskinfo(8)</a> is getoond.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># geom zero load</span>
<span class=c># gnop create -s 1000204821504 gzero</span>
<span class=c># gmirror label -v gm0 gzero.nop ada1</span>
<span class=c># gmirror forget gm0</span></code></pre></div></div><div class=paragraph><p><span class=filename>gzero.nop</span> slaat geen gegevens op, dus ziet de spiegel het niet als verbonden. De spiegel wordt verteld om componenten die niet verbonden zijn te "vergeten", waarbij referenties naar <span class=filename>gzero.nop</span> worden verwijderd. Het resultaat is een spiegelapparaat dat slechts één enkele schijf, <span class=filename>ada1</span>, bevat.</p></div><div class=paragraph><p>Bekijk de partitietabel van <span class=filename>ada0</span> nadat <span class=filename>gm0</span> is aangemaakt.</p></div><div class=paragraph><p>Deze uitvoer komt van een schijf van 1 TB. Als er wat niet-toegewezen ruimte aanwezig is aan het einde van de schijf, kan de inhoud direct van <span class=filename>ada0</span> naar de nieuwe spiegel worden gekopieerd.</p></div><div class=paragraph><p>Als de uitvoer echter toont dat alle ruimte op de schijf is toegewezen zoals in de volgende lijst, is er geen ruimte over voor de 512 bytes aan meta-gegevens van <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> aan het einde van de schijf.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart show ada0</span>
<span class=o>=&gt;</span>        63  1953525105        ada0  MBR  <span class=o>(</span>931G<span class=o>)</span>
          63  1953525105           1  freebsd  <span class=o>[</span>active]  <span class=o>(</span>931G<span class=o>)</span></code></pre></div></div><div class=paragraph><p>In dit geval moet de partitietabel worden bewerkt om de capaciteit op <span class=filename>mirror/gm0</span> met één sector te verminderen. De procedure hiervoor wordt later uitgelegd.</p></div><div class=paragraph><p>In beide gevallen dienen de partitietabellen op de primaire schijf eerst gekopieerd te worden. Dit kan gedaan worden met de subcommando’s <code>backup</code> en <code>restore</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart backup ada0 &gt; table.ada0</span>
<span class=c># gpart backup ada0s1 &gt; table.ada0s1</span></code></pre></div></div><div class=paragraph><p>Deze subcommando’s maken twee bestanden aan, <span class=filename>table.ada0</span> en <span class=filename>table.ada0s1</span>. Dit voorbeeld komt van een schijf van 1 TB af:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat table.ada0</span>
MBR 4
1 freebsd         63 1953525105   <span class=o>[</span>active]</code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat table.ada0s1</span>
BSD 8
1  freebsd-ufs          0    4194304
2 freebsd-swap    4194304   33554432
4  freebsd-ufs   37748736   50331648
5  freebsd-ufs   88080384   41943040
6  freebsd-ufs  130023424  838860800
7  freebsd-ufs  968884224  984640881</code></pre></div></div><div class=paragraph><p>Als de gehele schijf was gebruikt in de uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a> <code>show</code>, dan moet de capaciteit in deze partitietabellen met één sector verminderd worden. Bewerk de twee bestanden zodat de grootte van zowel de slice als de laatste partitie met één verminderd wordt. Dit zijn de laatste getallen in elke lijst.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat table.ada0</span>
MBR 4
1 freebsd         63 1953525104   <span class=o>[</span>active]</code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat table.ada0s1</span>
BSD 8
1  freebsd-ufs          0    4194304
2 freebsd-swap    4194304   33554432
4  freebsd-ufs   37748736   50331648
5  freebsd-ufs   88080384   41943040
6  freebsd-ufs  130023424  838860800
7  freebsd-ufs  968884224  984640880</code></pre></div></div><div class=paragraph><p>Als er tenminste één sector aan het einde van de schijf niet was toegewezen, kunnen deze twee bestanden ongewijzigd gebruikt worden.</p></div><div class=paragraph><p>Herstel nu de partitietabel naar <span class=filename>mirror/gm0</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart restore mirror/gm0 &lt; table.ada0</span>
<span class=c># gpart restore mirror/gm0s1 &lt; table.ada0s1</span></code></pre></div></div><div class=paragraph><p>Controleer de partitietabel met <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a> <code>show</code>. Dit voorbeeld heeft <span class=filename>gm0s1a</span> voor <span class=filename>/</span>, <span class=filename>gm0s1d</span> voor <span class=filename>/var</span>, <span class=filename>gm0s1e</span> voor <span class=filename>/usr</span>, <span class=filename>gm0s1f</span> voor <span class=filename>/data1</span> en <span class=filename>gm0s1g</span> voor <span class=filename>/data2</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart show mirror/gm0</span>
<span class=o>=&gt;</span>        63  1953525104  mirror/gm0  MBR  <span class=o>(</span>931G<span class=o>)</span>
          63  1953525042           1  freebsd  <span class=o>[</span>active]  <span class=o>(</span>931G<span class=o>)</span>
  1953525105          62              - free -  <span class=o>(</span>31k<span class=o>)</span>

<span class=c># gpart show mirror/gm0s1</span>
<span class=o>=&gt;</span>         0  1953525042  mirror/gm0s1  BSD  <span class=o>(</span>931G<span class=o>)</span>
           0     2097152             1  freebsd-ufs  <span class=o>(</span>1.0G<span class=o>)</span>
     2097152    16777216             2  freebsd-swap  <span class=o>(</span>8.0G<span class=o>)</span>
    18874368    41943040             4  freebsd-ufs  <span class=o>(</span>20G<span class=o>)</span>
    60817408    20971520             5  freebsd-ufs  <span class=o>(</span>10G<span class=o>)</span>
    81788928   629145600             6  freebsd-ufs  <span class=o>(</span>300G<span class=o>)</span>
   710934528  1242590514             7  freebsd-ufs  <span class=o>(</span>592G<span class=o>)</span>
  1953525042          63                - free -  <span class=o>(</span>31k<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Zowel de slice als de laatste partitie dienen wat vrije ruimte aan het einde van elke schijf te hebben.</p></div><div class=paragraph><p>Maak bestandssystemen aan op deze nieuwe partities. Het aantal partities zal variëren, overeenkomend met de partities op de originele schijf, <span class=filename>ada0</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U /dev/mirror/gm0s1a</span>
<span class=c># newfs -U /dev/mirror/gm0s1d</span>
<span class=c># newfs -U /dev/mirror/gm0s1e</span>
<span class=c># newfs -U /dev/mirror/gm0s1f</span>
<span class=c># newfs -U /dev/mirror/gm0s1g</span></code></pre></div></div><div class=paragraph><p>Maak de spiegel opstartbaar door opstartcode in het MBR en bsdlabel te installeren en de actieve slice in te stellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart bootcode -b /boot/mbr mirror/gm0</span>
<span class=c># gpart set -a active -i 1 mirror/gm0</span>
<span class=c># gpart bootcode -b /boot/boot mirror/gm0s1</span></code></pre></div></div><div class=paragraph><p>Pas <span class=filename>/etc/fstab</span> aan zodat het de nieuwe partities op de spiegel gebruikt. Maak eerst een kopie van dit bestand als <span class=filename>/etc/fstab.orig</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp /etc/fstab /etc/fstab.orig</span></code></pre></div></div><div class=paragraph><p>Wijzig <span class=filename>/etc/fstab</span> door <span class=filename>/dev/ada0</span> door <span class=filename>mirror/gm0</span> te vervangen.</p></div><div class="literalblock programlisting"><div class=content><pre># Device		Mountpoint	FStype	Options	Dump	Pass#
/dev/mirror/gm0s1a	/		ufs	rw	1	1
/dev/mirror/gm0s1b	none		swap	sw	0	0
/dev/mirror/gm0s1d	/var		ufs	rw	2	2
/dev/mirror/gm0s1e	/usr		ufs	rw	2	2
/dev/mirror/gm0s1f	/data1		ufs	rw	2	2
/dev/mirror/gm0s1g	/data2		ufs	rw	2	2</pre></div></div><div class=paragraph><p>Als de kernelmodule <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> niet in de kernel is gebouwd, wijzig dan <span class=filename>/boot/loader.conf</span> om het te laden:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_mirror_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Bestandssystemen van de originele schijf kunnen nu met <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a> naar de spiegel gekopieerd worden. Merk op dat het maken van een snapshot voor elk bestandssysteem dat met <code>dump -L</code> gedumpt is even kan duren.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/mirror/gm0s1a /mnt</span>
<span class=c># dump -C16 -b64 -0aL -f - /    | (cd /mnt &amp;&amp; restore -rf -)</span>
<span class=c># mount /dev/mirror/gm0s1d /mnt/var</span>
<span class=c># mount /dev/mirror/gm0s1e /mnt/usr</span>
<span class=c># mount /dev/mirror/gm0s1f /mnt/data1</span>
<span class=c># mount /dev/mirror/gm0s1g /mnt/data2</span>
<span class=c># dump -C16 -b64 -0aL -f - /usr | (cd /mnt/usr &amp;&amp; restore -rf -)</span>
<span class=c># dump -C16 -b64 -0aL -f - /var | (cd /mnt/var &amp;&amp; restore -rf -)</span>
<span class=c># dump -C16 -b64 -0aL -f - /data1 | (cd /mnt/data1 &amp;&amp; restore -rf -)</span>
<span class=c># dump -C16 -b64 -0aL -f - /data2 | (cd /mnt/data2 &amp;&amp; restore -rf -)</span></code></pre></div></div><div class=paragraph><p>Start het systeem opnieuw op vanaf <span class=filename>ada1</span>. Als alles werkt, zal het systeem opstarten vanaf <span class=filename>mirror/gm0</span>, wat nu dezelfde gegevens bevat die <span class=filename>ada0</span> eerder bevatte. Zie de sectie <a href=#gmirror-troubleshooting>Problemen oplossen</a> als er problemen zijn met het opstarten.</p></div><div class=paragraph><p>Op dit moment bestaat de spiegel nog steeds alleen uit de enkele schijf <span class=filename>ada1</span>.</p></div><div class=paragraph><p>Nadat er succesvol van <span class=filename>mirror/gm0</span> is opgestart, is de laatste stap het plaatsen van <span class=filename>ada0</span> in de spiegel.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Als <span class=filename>ada0</span> in de spiegel wordt geplaatst, zal de vorige inhoud worden overschreven door gegevens in de spiegel. Ben er zeker van dat <span class=filename>mirror/gm0</span> dezelfde gegevens bevat als <span class=filename>ada0</span> voordat <span class=filename>ada0</span> aan de spiegel wordt toegevoegd. Als er iets mis is met de gegevens die door <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a> gekopieerd zijn, draai dan <span class=filename>/etc/fstab</span> terug om de bestandssystemen op <span class=filename>ada0</span> aan te koppelen, start opnieuw op, en probeer de hele procedure nogmaals.</p></div></td></tr></tbody></table></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror insert gm0 ada0</span>
GEOM_MIRROR: Device gm0: rebuilding provider ada0</code></pre></div></div><div class=paragraph><p>De synchronisatie tussen de twee schijven zal onmiddellijk beginnen. <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> <code>status</code> toont de voortgang.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror status</span>
      Name    Status  Components
mirror/gm0  DEGRADED  ada1 <span class=o>(</span>ACTIVE<span class=o>)</span>
                      ada0 <span class=o>(</span>SYNCHRONIZING, 64%<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Na een tijd zal de synchronisatie voltooid zijn.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>GEOM_MIRROR: Device gm0: rebuilding provider ada0 finished.
<span class=c># gmirror status</span>
      Name    Status  Components
mirror/gm0  COMPLETE  ada1 <span class=o>(</span>ACTIVE<span class=o>)</span>
                      ada0 <span class=o>(</span>ACTIVE<span class=o>)</span></code></pre></div></div><div class=paragraph><p><span class=filename>mirror/gm0</span> bestaat nu uit de twee schijven <span class=filename>ada0</span> en <span class=filename>ada1</span>, en de inhoud wordt automatisch met elkaar gesynchroniseerd. In het gebruik zal <span class=filename>mirror/gm0</span> zich net zo gedragen als de originele enkele schijf.</p></div></div><div class=sect3><h4 id=gmirror-troubleshooting>20.4.4. Problemen oplossen<a class=anchor href=#gmirror-troubleshooting></a></h4><div class=sect4><h5 id=_problemen_met_opstarten>20.4.4.1. Problemen met opstarten<a class=anchor href=#_problemen_met_opstarten></a></h5><div class=sect5><h6 id=_bios_instellingen>20.4.4.1.1. BIOS-instellingen<a class=anchor href=#_bios_instellingen></a></h6><div class=paragraph><p>Mogelijk is het nodig om de BIOS-instellingen te wijzigen om van één van de nieuwe gespiegelde schijven op te starten. Beide spiegelschijven kunnen gebruikt worden voor het opstarten. Als componenten van een spiegel bevatten ze identieke gegevens.</p></div></div><div class=sect5><h6 id=_opstartproblemen>20.4.4.1.2. Opstartproblemen<a class=anchor href=#_opstartproblemen></a></h6><div class=paragraph><p>Als het opstarten met dit bericht stopt, is er iets mis met het spiegelapparaat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Mounting from ufs:/dev/mirror/gm0s1a failed with error 19.

Loader variables:
  vfs.root.mountfrom<span class=o>=</span>ufs:/dev/mirror/gm0s1a
  vfs.root.mountfrom.options<span class=o>=</span>rw

Manual root filesystem specification:
  &lt;fstype&gt;:&lt;device&gt; <span class=o>[</span>options]
      Mount &lt;device&gt; using filesystem &lt;fstype&gt;
      and with the specified <span class=o>(</span>optional<span class=o>)</span> option list.

    eg. ufs:/dev/da0s1a
        zfs:tank
        cd9660:/dev/acd0 ro
          <span class=o>(</span>which is equivalent to: mount <span class=nt>-t</span> cd9660 <span class=nt>-o</span> ro /dev/acd0 /<span class=o>)</span>

  ?               List valid disk boot devices
  <span class=nb>.</span>               Yield 1 second <span class=o>(</span><span class=k>for </span>background tasks<span class=o>)</span>
  &lt;empty line&gt;    Abort manual input

mountroot&gt;</code></pre></div></div><div class=paragraph><p>Het vergeten om de module <span class=filename>geom_mirror</span> in <span class=filename>/boot/loader.conf</span> te laden kan dit probleem veroorzaken. Start op vanaf een FreeBSD-9 of nieuwere CD of USB-stick en kies <code>Shell</code> op de eerste prompt om dit op te lossen. Laadt daarna de spiegelmodule en en koppel het spiegelapparaat aan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror load</span>
<span class=c># mount /dev/mirror/gm0s1a /mnt</span></code></pre></div></div><div class=paragraph><p>Voeg een regel om de spiegelmodule te laden toe aan <span class=filename>/mnt/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_mirror_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Sla het bestand op en start opnieuw op.</p></div><div class=paragraph><p>Andere problemen die <code>error 19</code> veroorzaken zijn lastiger om op te lossen. Typ <code>ufs:/dev/ada0s1a</code> in op de prompt. Hoewel het systeem van <span class=filename>ada0</span> zou moeten opstarten, verschijnt er een andere prompt om een shell uit te kiezen omdat <span class=filename>/etc/fstab</span> onjuist is. Druk op de prompt op de Enter-toets. Draai de wijzigingen tot nu toe terug door <span class=filename>/etc/fstab</span> terug te draaien, waardoor de bestandssystemen vanaf de originele schijf ( <span class=filename>ada0</span>) in plaats vanaf de spiegel worden aangekoppeld. Start het systeem opnieuw op en probeer de procedure nogmaals.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Enter full pathname of shell or RETURN <span class=k>for</span> /bin/sh:
<span class=c># cp /etc/fstab.orig /etc/fstab</span>
<span class=c># reboot</span></code></pre></div></div></div></div></div><div class=sect3><h4 id=_herstellen_van_falende_schijven>20.4.5. Herstellen van falende schijven<a class=anchor href=#_herstellen_van_falende_schijven></a></h4><div class=paragraph><p>Het mooie aan het spiegelen van schijven is dat een individuele schijf kan falen zonder dat de spiegel gegevens verliest.</p></div><div class=paragraph><p><span class=filename>ada0</span> is één van de twee schijven die de spiegel in het vorige voorbeeld vormen. Als <span class=filename>ada0</span> faalt zal de spiegel blijven werken en gegevens leveren van de overgebleven werkende schijf, <span class=filename>ada1</span>.</p></div><div class=paragraph><p>Om de kapotte schijf te vervangen wordt de computer uitgezet en de kapotte schijf fysiek vervangen door een nieuwe schijf van gelijke of grotere capaciteit. Fabrikanten passen enigszins willekeurige waarden toe om schijven in gigabytes aan te duiden, de enige manier om er echt zeker van te zijn is om de totale hoeveelheid aan sectors aangegeven door <code>diskinfo -v</code> te vergelijken. Een schijf met een grotere capaciteit dan in de spiegel zal werken, alhoewel de extra ruimte op de nieuwe schijf niet gebruikt zal worden.</p></div><div class=paragraph><p>Nadat de computer opnieuw is aangezet, zal de spiegel in een "degraded" toestand met slechts één schijf draaien. De spiegel wordt verteld om schijven die momenteel niet verbonden zijn te vergeten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror forget gm0</span></code></pre></div></div><div class=paragraph><p>Alle oude meta-gegevens zouden <a href=#GEOM-mirror-metadata>van de vervangende schijf gewist</a> moeten zijn. Daarna wordt de schijf, in dit voorbeeld <span class=filename>ada4</span>, in de spiegel geplaatst:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror insert gm0 /dev/ada4</span></code></pre></div></div><div class=paragraph><p>De hersynchronisatie begint wanneer de nieuwe schijf in de spiegel wordt geplaatst. Het kopiëren van gegevens van de spiegel naar een nieuwe schijf kan een tijd duren. De prestaties van de spiegel zullen tijdens het kopiëren sterk verminderd zijn, dus is het het beste om nieuwe schijven in te voegen wanneer de vraag op de computer laag is.</p></div><div class=paragraph><p>De voortgang kan met <code>gmirror status</code> gevolgd worden, wat de schijven die gesynchroniseerd en het percentage van de voltooiing laat zien. Tijdens de hersynchronisatie zal de status <code>DEGRADED</code> zijn en veranderen in <code>COMPLETE</code> wanneer het proces is voltooid.</p></div></div></div><div class=sect2><h3 id=GEOM-raid3>20.5. RAID3 - Striping op byte-niveau met toegewijde pariteit<a class=anchor href=#GEOM-raid3></a></h3><div class=paragraph><p>RAID3 is een methode om verschillende schijven te combineren in een enkel volume met een toegewijde schijf voor de pariteit. In een RAID3-systeem worden de gegevens opgesplitst in een aantal bytes die over alle schijven in de rij worden geschreven, behalve naar één schijf die als een toegewijde schijf voor de pariteit dient. Dit betekent dat het lezen van 1024 kB van een RAID3-implementatie alle schijven in de rij zal benaderen. De prestatie kan worden verhoogd door meerdere schijfcontrollers te gebruiken. De RAID3-rij biedt een fouttolerantie van 1 schijf, terwijl het een capaciteit van 1 - 1/n maal de totale capaciteit biedt van alle schijven in de rij, waarbij n het aantal harde schijven in de rij is. Zulke configuraties zijn meestal geschikt voor het opslaan van gegevens van grotere groottes, bijvoorbeeld multimedia-bestanden.</p></div><div class=paragraph><p>Er zijn minstens 3 fysieke harde schijven nodig om een RAID3-rij te bouwen. Elke schijf moet van dezelfde grootte zijn, aangezien I/O-verzoeken worden verweven om parallel naar meerdere schijven te lezen of schrijven. Bovendien moet vanwege de aard van RAID3 het aantal schijven gelijk zijn aan 3, 5, 9, 17, enzovoorts (dus 2^n + 1).</p></div><div class=sect3><h4 id=_een_toegewijde_raid3_rij_aanmaken>20.5.1. Een toegewijde RAID3-rij aanmaken.<a class=anchor href=#_een_toegewijde_raid3_rij_aanmaken></a></h4><div class=paragraph><p>In FreeBSD is ondersteuning voor RAID3 geïmplementeerd in de GEOM-klasse <a href="https://man.freebsd.org/cgi/man.cgi?query=graid3&amp;sektion=8&amp;format=html">graid3(8)</a>. Voor het aanmaken van een toegewijde RAID3-rij op FreeBSD zijn deze stappen nodig.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Hoewel het theoretisch mogelijk is om op FreeBSD van een RAID3-rij op te starten, is deze configuratie ongebruikelijk en niet aangeraden.</p></div></td></tr></tbody></table></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Laad ten eerste de kernelmodule <span class=filename>geom_raid3.ko</span> door de volgende opdracht uit te voeren:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># graid3 load</span></code></pre></div></div><div class=paragraph><p>Het is ook mogelijk om handmatig de module <span class=filename>geom_raid3.ko</span> te laden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload geom_raid3.ko</span></code></pre></div></div></li><li><p>Zorg ervoor dat er een geschikt aankoppelpunt bestaat of maak het aan:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /multimedia/</span></code></pre></div></div></li><li><p>Bepaal de apparaatnamen voor de schijven die aan de rij worden toegevoegd en maak het nieuwe RAID3-apparaat aan. Het laatst vermelde apparaat zal dienst doen als de toegewijde schijf voor de pariteit. Dit voorbeeld gebruikt drie ongepartitioneerde ATA-schijven: <span class=filename>ada1</span> en <span class=filename>ada2</span> voor gegevens en <span class=filename>ada3</span> voor pariteit.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># graid3 label -v gr0 /dev/ada1 /dev/ada2 /dev/ada3</span>
Metadata value stored on /dev/ada1.
Metadata value stored on /dev/ada2.
Metadata value stored on /dev/ada3.
Done.</code></pre></div></div></li><li><p>Partitioneer het nieuw aangemaakte apparaat <span class=filename>gr0</span> en zet er een UFS-bestandssysteem op:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart create -s GPT /dev/raid3/gr0</span>
<span class=c># gpart add -t freebsd-ufs /dev/raid3/gr0</span>
<span class=c># newfs -j /dev/raid3/gr0p1</span></code></pre></div></div><div class=paragraph><p>Vele getallen zullen over het scherm lopen, en na wat tijd zal het proces voltooid zijn. Het volume is aangemaakt en is klaar om aangekoppeld te worden.</p></div></li><li><p>De laatste stap is het aankoppelen van het bestandssysteem:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/raid3/gr0p1 /multimedia/</span></code></pre></div></div><div class=paragraph><p>De RAID3-rij is nu klaar voor gebruik.</p></div></li></ol></div></div></div><div class=paragraph><p>Aanvullende configuratie is nodig om de bovenstaande opstelling te behouden tussen het opnieuw starten van het systeem.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>De module <span class=filename>geom_raid3.ko</span> moet geladen zijn voordat de rij kan worden aangekoppeld. Voeg de volgende regel toe aan <span class=filename>/boot/loader.conf</span> om de kernelmodule automatisch tijdens de initialisatie van het systeem te laden:</p><div class="literalblock programlisting"><div class=content><pre>geom_raid3_load=&#34;YES&#34;</pre></div></div></li><li><p>De volgende volume-informatie moet aan het bestand <span class=filename>/etc/fstab</span> worden toegevoegd om het bestandssysteem van de rij automatisch aan de koppelen tijdens het opstarten van het systeem:</p><div class="literalblock programlisting"><div class=content><pre>/dev/raid3/gr0p1	/multimedia	ufs	rw	2	2</pre></div></div></li></ol></div></div></div></div></div><div class=sect2><h3 id=geom-ggate>20.6. GEOM Gate netwerk apparaten<a class=anchor href=#geom-ggate></a></h3><div class=paragraph><p>GEOM ondersteund het op afstand gebruiken van apparaten, zoals schijven, CD-ROMs, bestanden, etcetera door het gebruik van de gate-applicaties. Dit is vergelijkbaar met NFS.</p></div><div class=paragraph><p>Om te beginnen moet er een exports bestand gemaakt worden. Dit bestand specificeert wie de geëxporteerde bron mag benaderen en welke rechten er op dat moment verleend worden. Bijvoorbeeld om de vierde slice te exporteren van de eerste SCSI schijf, moet het volgende in <span class=filename>/etc/gg.exports</span> gezet worden:</p></div><div class="literalblock programlisting"><div class=content><pre>192.168.1.0/24 RW /dev/da0s4d</pre></div></div><div class=paragraph><p>Dit staat alle machines in het privé netwerk toe om het bestandssysteem op <span class=filename>da0s4d</span> te benaderen.</p></div><div class=paragraph><p>Om dit apparaat te kunnen exporteren is het van belang dat de schijf nog niet gekoppeld is en moet de <a href="https://man.freebsd.org/cgi/man.cgi?query=ggated&amp;sektion=8&amp;format=html">ggated(8)</a> dienst gestart worden.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ggated</span></code></pre></div></div><div class=paragraph><p>Om vervolgens het apparaat aan een client machine te koppelen moet het volgende gedaan worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ggatec create -o rw 192.168.1.1 /dev/da0s4d</span>
ggate0
<span class=c># mount /dev/ggate0 /mnt</span></code></pre></div></div><div class=paragraph><p>Vanaf dit moment kan de schijf benaderd worden via het koppelpunt <span class=filename>/mnt</span>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Let op, dit mislukt als de schijf reeds gekoppeld is op de server machine of als deze reeds gekoppeld is aan een andere machine op het netwerk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Zodra het apparaat niet langer nodig is, kan het veilig ontkoppeld worden met behulp van <a href="https://man.freebsd.org/cgi/man.cgi?query=umount&amp;sektion=8&amp;format=html">umount(8)</a> net zoals met elke andere schijf.</p></div></div><div class=sect2><h3 id=geom-glabels>20.7. Het labelen van schijven<a class=anchor href=#geom-glabels></a></h3><div class=paragraph><p>Tijdens het initialiseren van het systeem zal de FreeBSD kernel apparaatknooppunten creëren nadat het een apparaat gevonden heeft. Deze manier om te zoeken naar apparaten levert wat problemen op bijvoorbeeld wanneer er een nieuwe schijf wordt toegevoegd via USB. Het is hoogst waarschijnlijk dat een flash apparaat een apparaatknooppunt krijgt van <span class=filename>da0</span>, waarna de originele <span class=filename>da0</span> op schuift naar <span class=filename>da1</span>. Dit levert problemen op als bestandssystemen worden gekoppeld als ze gedefinieerd zijn in <span class=filename>/etc/fstab</span>, dit kan zelfs ertoe leiden dat het systeem niet opstart.</p></div><div class=paragraph><p>Een mogelijke oplossing hiervoor is om de SCSI schijven een vaste plek te geven op een bepaalde volgorde, zodat zodra er een nieuwe schijf geplaatst wordt, deze een ongebruikt apparaatknooppunt toegewezen krijgt. Maar wat als er USB apparaten zijn die de primaire SCSI schijf vervangt? Dit gebeurd omdat USB apparaten meestal eerder gevonden worden dan een SCSI kaart. Een oplossing hiervoor is om de apparaten pas toe te voegen als het systeem reeds gestart is, een andere methode kan zijn om alleen een enkele ATA schijf te koppelen en nooit SCSI schijven door middel van <span class=filename>/etc/fstab</span>.</p></div><div class=paragraph><p>Maar er is een betere oplossing beschikbaar. Door het gebruik van <code>glabel</code> kunnen beheerders en gebruikers een label toevoegen aan een schijf, en deze labels gebruiken in <span class=filename>/etc/fstab</span>. Omdat <code>glabel</code> het label bewaard in de laatste sector van de schijf, kan het label bewaard blijven ook na een reboot en kan het bestandssysteem altijd gekoppeld worden ongeacht welk apparaatknooppunt toegekend is aan het apparaat.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Uiteraard hoeft een label niet permanent te zijn, het <code>glabel</code> programma kan zowel tijdelijke als permanente labels aanmaken. Alleen een permanent label blijft beschikbaar ook na een reboot. Zie de <a href="https://man.freebsd.org/cgi/man.cgi?query=glabel&amp;sektion=8&amp;format=html">glabel(8)</a> handleiding voor meer informatie over de verschillen tussen de labeltypes.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_label_types_en_voorbeelden>20.7.1. Label types en voorbeelden<a class=anchor href=#_label_types_en_voorbeelden></a></h4><div class=paragraph><p>Er zijn twee type labels: een generiek label en een bestandssysteemlabel. Labels kunnen permanent of tijdelijk zijn. Permanente labels kunnen met de commando’s <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> aangemaakt worden. Ze zullen vervolgens worden aangemaakt in een submap van <span class=filename>/dev</span>, welke genoemd wordt naar het bestandssysteemtype. Bijvoorbeeld UFS2 labels worden geplaatst in de map <span class=filename>/dev/ufs</span>. Permanente labels kunnen ook worden aangemaakt met het commando <code>glabel label</code>. Deze zijn niet specifiek voor het bestandssysteem, en zullen in de map <span class=filename>/dev/label</span> aangemaakt worden.</p></div><div class=paragraph><p>Een tijdelijk label verdwijnt na een herstart van het systeem. Deze labels worden gecreëerd in <span class=filename>/dev/label</span> en zijn perfect voor experimenten. Een tijdelijk kan met het commando <code>glabel create</code> worden aangemaakt. Lees voor meer informatie de handleidingpagina van <a href="https://man.freebsd.org/cgi/man.cgi?query=glabel&amp;sektion=8&amp;format=html">glabel(8)</a>.</p></div><div class=paragraph><p>Om een permanent label te schrijven voor een UFS2-bestandssysteem zonder de huidige data te vernietigen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tunefs -L home /dev/da3</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Als het bestandssyteem vol is kan dit leiden tot data corruptie; echter als het bestandssysteem vol is zou het hoofddoel moeten zijn om oude achtergebleven bestanden weg te halen in plaats van het toevoegen van labels.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Er zou nu een label moeten bestaan in <span class=filename>/dev/ufs</span>, welke toegevoegd kan worden aan het <span class=filename>/etc/fstab</span> bestand:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ufs/home	/home            ufs     rw              2      2</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het bestandssysteem mag niet aangekoppeld zijn op het moment dat <code>tunefs</code> gebruikt wordt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Nu kan het bestandssysteem net als normaal worden gekoppeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /home</span></code></pre></div></div><div class=paragraph><p>Vanaf dit moment is het mogelijk om, zolang de <span class=filename>geom_label.ko</span> geladen wordt tijdens het opstarten van het systeem, of als deze is meegecompileerd door middel van de <code>GEOM_LABEL</code> optie in de kernel, het apparaatknooppunt te wijzigen zonder ernstige gevolgen voor het systeem.</p></div><div class=paragraph><p>Bestandssystemen kunnen ook een standaard label mee krijgen door gebruik te maken van de <code>-L</code> optie met het <code>newfs</code> commando. Zie de <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> handleiding voor meer informatie.</p></div><div class=paragraph><p>Het volgende commando kan worden gebruikt om een label te verwijderen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># glabel destroy home</span></code></pre></div></div><div class=paragraph><p>Het volgende voorbeeld laat zien hoe de partities van een opstartschijf gelabeld worden.</p></div><div class=exampleblock><div class=title>Voorbeeld 28. Partities op de opstartschijf labelen</div><div class=content><div class=paragraph><p>Door de partities op de opstartschijf permanent te labelen zou het systeem in staat moeten zijn om normaal door te gaan met opstarten, zelfs als de schijf verplaatst is naar een andere controller of is overgeplaatst naar een ander systeem. In dit voorbeeld wordt aangenomen dat er een enkele ATA-schijf wordt gebruikt, die momenteel als <span class=filename>ad0</span> door het systeem wordt herkend. Het wordt ook aangenomen dat het standaard partitieschema van FreeBSD wordt gebruikt, met de bestandssystemen <span class=filename>/</span>, <span class=filename>/var</span>, <span class=filename>/usr</span>, en <span class=filename>/tmp</span>, alsmede een wisselpartitie.</p></div><div class=paragraph><p>Start het systeem opnieuw op, en druk bij de <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a>-prompt op 4 om in enkele gebruikersmodus op te starten. Geef dan de volgende commando’s:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># glabel label rootfs /dev/ad0s1a</span>
GEOM_LABEL: Label <span class=k>for </span>provider /dev/ad0s1a is label/rootfs
<span class=c># glabel label var /dev/ad0s1d</span>
GEOM_LABEL: Label <span class=k>for </span>provider /dev/ad0s1d is label/var
<span class=c># glabel label usr /dev/ad0s1f</span>
GEOM_LABEL: Label <span class=k>for </span>provider /dev/ad0s1f is label/usr
<span class=c># glabel label tmp /dev/ad0s1e</span>
GEOM_LABEL: Label <span class=k>for </span>provider /dev/ad0s1e is label/tmp
<span class=c># glabel label swap /dev/ad0s1b</span>
GEOM_LABEL: Label <span class=k>for </span>provider /dev/ad0s1b is label/swap
<span class=c># exit</span></code></pre></div></div><div class=paragraph><p>Het systeem zal doorgaan met opstarten in meergebruikersmodus. Bewerk, nadat het opstarten is voltooid, <span class=filename>/etc/fstab</span> en vervang de conventionele namen door de respectievelijke labels. Het uiteindelijke bestand <span class=filename>/etc/fstab</span> zal er als volgt uitzien:</p></div><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/label/swap          none            swap    sw              0       0
/dev/label/rootfs        /               ufs     rw              1       1
/dev/label/tmp           /tmp            ufs     rw              2       2
/dev/label/usr           /usr            ufs     rw              2       2
/dev/label/var           /var            ufs     rw              2       2</pre></div></div><div class=paragraph><p>Het systeem kan nu worden herstart. Als alles goed ging, zal het normaal opstarten en zal <code>mount</code> dit laten zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount</span>
/dev/label/rootfs on / <span class=o>(</span>ufs, <span class=nb>local</span><span class=o>)</span>
devfs on /dev <span class=o>(</span>devfs, <span class=nb>local</span><span class=o>)</span>
/dev/label/tmp on /tmp <span class=o>(</span>ufs, <span class=nb>local</span>, soft-updates<span class=o>)</span>
/dev/label/usr on /usr <span class=o>(</span>ufs, <span class=nb>local</span>, soft-updates<span class=o>)</span>
/dev/label/var on /var <span class=o>(</span>ufs, <span class=nb>local</span>, soft-updates<span class=o>)</span></code></pre></div></div></div></div><div class=paragraph><p>Beginnend met FreeBSD 7.2 ondersteunt de klasse <a href="https://man.freebsd.org/cgi/man.cgi?query=glabel&amp;sektion=8&amp;format=html">glabel(8)</a> een nieuw labeltype voor UFS-bestandssystemen, gebaseerd op het unieke id van het bestandssysteem, <code>ufsid</code>. Deze labels kunnen in de map <span class=filename>/dev/ufsid</span> gevonden worden en worden automatisch tijdens het opstarten aangemaakt. Het is mogelijk om de <code>ufsid</code>-labels te gebruiken om partities aan te koppelen door middel van de faciliteit <span class=filename>/etc/fstab</span>. Gebruik <code>glabel status</code> om een lijst van bestandssystemen en hun overeenkomende <code>ufsid</code>-labels te ontvangen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% glabel status
                  Name  Status  Components
ufsid/486b6fc38d330916     N/A  ad4s1d
ufsid/486b6fc16926168e     N/A  ad4s1f</code></pre></div></div><div class=paragraph><p>In het bovenstaande voorbeeld representeert <span class=filename>ad4s1d</span> het bestandssysteem <span class=filename>/var</span>, terwijl <span class=filename>ad4s1f</span> het bestandssysteem <span class=filename>/usr</span> representeert. Door gebruik te maken van de gegeven <code>ufsid</code>-waarden kunnen deze partities nu aangekoppeld worden met de volgende regels in <span class=filename>/etc/fstab</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ufsid/486b6fc38d330916	/var	ufs	rw	2	2
/dev/ufsid/486b6fc16926168e	/usr	ufs	rw	2	2</pre></div></div><div class=paragraph><p>Elke partitie met een <code>ufsid</code>-label kan op deze manier worden aangekoppeld, waardoor het niet meer nodig is om handmatig permanente labels voor ze aan te maken, terwijl er nog steeds van de voordelen van apparaatnaam-onafhankelijk aankoppelen genoten kan worden.</p></div></div></div><div class=sect2><h3 id=geom-gjournal>20.8. UFS logboeken door middel van GEOM<a class=anchor href=#geom-gjournal></a></h3><div class=paragraph><p>Met de komst van FreeBSD 7.0 komt ook de langverwachte optie van UFS logboeken. De implementatie zelf is gedaan door middel van het GEOM subsysteem, welke makkelijk geconfigureerd kan worden met behulp van de <a href="https://man.freebsd.org/cgi/man.cgi?query=gjournal&amp;sektion=8&amp;format=html">gjournal(8)</a> applicatie.</p></div><div class=paragraph><p>Wat is logboeken? Logboek mogelijkheden betekend het opslaan van bestandssysteem transacties, zoals wijzigingen die een complete schrijfactie zijn, voor er meta-data wordt toegevoegd en voor de wijzigingen op schijf worden gezet. Deze transactie log kan later opnieuw afgespeeld worden om te voorkomen dat er bestandssysteem inconsistenties voorkomen.</p></div><div class=paragraph><p>Deze methode is een extra manier om te beschermen tegen gegevensverlies en inconsistenties van het bestandssysteem. In tegenstelling tot Soft Updates, welke bijhoud welke meta-data wijzigingen er worden uitgevoerd en Snapshots, wat een beeld bestand is van het bestandssysteem, wordt er een complete log bewaard in de schijfruimte die speciaal voor deze taak is gereserveerd, en in sommige gevallen op een compleet andere schijf.</p></div><div class=paragraph><p>In tegenstelling tot andere logboek implementaties is de <code>gjournal</code> methode blok gebaseerd en niet geïmplementeerd als onderdeel van het bestandssysteem maar als uitbreiding op GEOM.</p></div><div class=paragraph><p>Om ondersteuning in te schakelen voor <code>gjournal</code>, moet de kernel over de volgende optie beschikken, welke standaard is op FreeBSD 7.X-systemen:</p></div><div class="literalblock programlisting"><div class=content><pre>options        UFS_GJOURNAL</pre></div></div><div class=paragraph><p>Indien gejournalde volumes tijdens het opstarten aangekoppeld moeten worden, moet de kernelmodule <span class=filename>geom_journal.ko</span> ook geladen zijn, door de volgende regel aan <span class=filename>/boot/loader.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_journal_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ook kan deze functie in een eigen kernel worden ingebouwd, door de volgende regel aan het kernelinstellingenbestand toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>options    GEOM_JOURNAL</pre></div></div><div class=paragraph><p>Het creëren van een logboek op een vrij en beschikbaar bestandssysteem kan nu gedaan worden met behulp van de volgende stappen, ervan uitgaande dat <span class=filename>da4</span> de nieuwe beschikbare SCSI schijf is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gjournal load</span>
<span class=c># gjournal label /dev/da4</span></code></pre></div></div><div class=paragraph><p>Op dit moment zou er een <span class=filename>ad4</span> apparaatknooppunt en een <span class=filename>ad4.journal</span> apparaatknooppunt moeten zijn. Nu kan er een bestandssysteem op gezet worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -O 2 -J /dev/da4.journal</span></code></pre></div></div><div class=paragraph><p>Het hiervoor ingevoerde commando zal een UFS2 bestandssysteem met logboek ondersteuning aanmaken.</p></div><div class=paragraph><p>Koppel het apparaat op een gewenst koppelpunt met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/da4.journal /mnt</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In het geval dat er meerdere slices zijn, zal er een logboek voor elke slice gecreëerd worden. Bijvoorbeeld, als <span class=filename>ad4s1</span> en <span class=filename>ad4s2</span> allebei slices zijn, dan zal <code>gjournal</code> een <span class=filename>ad4s1.journal</span> en een <span class=filename>ad4s2.journal</span> creëeren.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Voor performance doeleinden is het gewenst om het logboek op een andere schijf te bewaren. Voor deze gevallen moet de logboekleverancier of het opslagapparaat gespecificeerd worden achter het apparaat waarop de logboek functionaliteit aangebracht moet worden. De logboekfunctionaliteit kan ook worden ingeschakeld op een reeds bestaand systeem met behulp van <code>tunefs</code>. Maak echter altijd een back-up voor dat dit soort dingen uitgeprobeerd worden. In de meeste gevallen zal <code>gjournal</code> falen als het geen actueel logboek kan maken, maar het voorkomt geen dataverlies als gevolg van verkeerd gebruik van <code>tunefs</code>.</p></div><div class=paragraph><p>Het is ook mogelijk om een journal van de opstartschijf van een FreeBSD-systeem bij te houden. Voor gedetailleerde instructies over deze taak wordt naar het artikel <a href=https://docs.freebsd.org/en/articles/gjournal-desktop/>Implementing UFS Journaling on a Desktop PC</a> verwezen.</p></div></div></div></div><div class=sect1><h2 id=filesystems>Hoofdstuk 21. Ondersteuning van bestandssystemen<a class=anchor href=#filesystems></a></h2><div class=sectionbody><div class=sect2><h3 id=filesystems-synopsis>21.1. Overzicht<a class=anchor href=#filesystems-synopsis></a></h3><div class=paragraph><p>Bestandssystemen zijn een integraal onderdeel van ieder besturingssysteem. Ze stellen gebruikers in de gelegenheid om bestanden te uploaden en op te slaan, geven toegang tot gegevens en maken natuurlijk harde schijven bruikbaar. Verschillende besturingssystemen hebben gewoonlijk één gezamenlijk aspect, namelijk het bestandssysteem. Op FreeBSD staat dit bestandssysteem bekend onder de naam Fast File System ofwel FFS, dat is gebaseerd op het oorspronkelijke Unix™ File System, ook bekend als UFS. Dit is het oorspronkelijke bestandssysteem van FreeBSD dat op harde schijven wordt geplaatst voor gegevenstoegang.</p></div><div class=paragraph><p>FreeBSD ondersteunt daarnaast ook een groot aantal andere bestandssystemen om lokaal toegang tot gegevens van andere besturingssystemen te bewerkstelligen; dat wil zeggen: gegevens opgeslagen op lokaal aangesloten USB opslagapparaten, flash drives, en harde schijven. Verder is er ook ondersteuning voor vreemde bestandssystemen. Dit zijn bestandssystemen ontwikkeld voor andere besturingssystemen zoals het Linux® Extended File System (EXT) en het Sun™ Z File System (ZFS).</p></div><div class=paragraph><p>Er zijn verschillende gradaties van ondersteuning voor de verschillende bestandssystemen op FreeBSD. Sommigen vereisen het laden van een kernelmodule, voor anderen moet een toolset worden geïnstalleerd. Dit hoofdstuk is geschreven om gebruikers van FreeBSD te helpen om op hun systeem toegang te verkrijgen tot andere bestandssystemen, te beginnen met het Sun™ Z File System.</p></div><div class=paragraph><p>Na het lezen van dit hoofstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Het verschil tussen eigen en ondersteunde bestandssystemen.</p></li><li><p>Welke bestandssystemen zijn ondersteund in FreeBSD.</p></li><li><p>Hoe niet-eigen bestandssystemen geactiveerd, geconfigureerd, benaderd en gebruikt kunnen worden.</p></li></ul></div><div class=paragraph><p>Voorafgaand aan het lezen van dit hoofdstuk dient de lezer:</p></div><div class=ulist><ul><li><p>Begrip te hebben van de beginselen van UNIX® en FreeBSD (<a href=./#basics>UNIX® beginselen</a>).</p></li><li><p>Bekend te zijn met de beginselen van kernelconfiguratie en -compilatie (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li><li><p>Vertrouwd te zijn met installatie van software van derden in FreeBSD (<a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></li><li><p>Enigszins bekend te zijn met schijven, opslag en apparaatnamen in FreeBSD (<a href=./#disks>Opslag</a>).</p></li></ul></div></div><div class=sect2><h3 id=filesystems-zfs>21.2. Het Z File System (ZFS)<a class=anchor href=#filesystems-zfs></a></h3><div class=paragraph><p>Het Z File System, ontwikkeld door Sun™, is een nieuwe technologie ontwikkeld om gebruik te maken van een pool-gebaseerde opslagmethode. Dit houdt in dat ruimte pas wordt gebruikt wanneer het nodig is voor dataopslag. Verder is het ontworpen voor maximale integriteit van gegevens, ondersteuning van gegevens-snapshots, meerdere kopieën, en gegevenschecksums. Ook is een nieuw gegevensreplicatiemodel, bekend als RAID-Z, toegevoegd; RAID-Z lijkt op RAID5, maar is ontworpen om corruptie tijdens het schrijven van gegevens te voorkomen.</p></div><div class=sect3><h4 id=_zfs_tuning>21.2.1. ZFS tuning<a class=anchor href=#_zfs_tuning></a></h4><div class=paragraph><p>Het ZFS subsysteem maakt gebruik van veel systeembronnen waardoor het nodig kan zijn een en ander af te stellen, zodat voor het dagelijks gebruik maximale efficiëntie wordt behaald. Doordat het een experimentele eigenschap van FreeBSD is, kan dit in de nabije toekomst veranderen; op dit moment echter, worden de volgende stappen aangeraden.</p></div><div class=sect4><h5 id=_geheugen>21.2.1.1. Geheugen<a class=anchor href=#_geheugen></a></h5><div class=paragraph><p>De totale hoeveelheid systeemgeheugen dient minstens één gigabyte te zijn, maar twee gigabytes of meer wordt aanbevolen. In alle voorbeelden hier heeft het systeem één gigabyte geheugen, met verschillende andere afstelmechanismen in werking.</p></div><div class=paragraph><p>Sommigen hebben succes gehad met minder dan een gigabyte geheugen, maar met een dergelijke, beperkte hoeveelheid geheugen is de kans groot dat onder zware belasting een kernelpanic in FreeBSD op zal treden door uitputting van het geheugen.</p></div></div><div class=sect4><h5 id=_kernelconfiguratie>21.2.1.2. Kernelconfiguratie<a class=anchor href=#_kernelconfiguratie></a></h5><div class=paragraph><p>Het wordt aangeraden om ongebruikte stuurprogramma’s en opties te verwijderen uit het kernelconfiguratiebestand. Omdat de meeste stuurprogramma’s beschikbaar zijn als modules kunnen ze alsnog worden geladen door middel van het bestand <span class=filename>/boot/loader.conf</span>.</p></div><div class=paragraph><p>Gebruikers van de i386™-architectuur dienen de volgende optie aan hun kernelconfiguratiebestand toe te voegen, de kernel opnieuw te compileren, en opnieuw op te starten:</p></div><div class="literalblock programlisting"><div class=content><pre>options		KVA_PAGES=512</pre></div></div><div class=paragraph><p>Deze optie vergroot de kerneladresruimte, waarmee het mogelijk wordt gemaakt om de <code>vm.kvm_size</code> afstelling hoger dan de huidige limiet van 1 GB (2 GB voor PAE) in te stellen. Deel, om de meest geschikte waarde voor deze optie te vinden, de gewenste hoeveelheid adresruimte door vier (4). In dit geval is dat <code>512</code> voor 2 GB.</p></div></div><div class=sect4><h5 id=_loader_tunables>21.2.1.3. Loader tunables<a class=anchor href=#_loader_tunables></a></h5><div class=paragraph><p>De <span class=filename>kmem</span> adresruimte dient te worden vergroot op alle FreeBSD architecturen. Op het testsysteem met één gigabyte fysiek geheugen werd succes behaald met de volgende opties, die in het bestand <span class=filename>/boot/loader.conf</span> geplaatst dienen te worden, waarna het systeem opnieuw moet worden opgestart:</p></div><div class="literalblock programlisting"><div class=content><pre>vm.kmem_size=&#34;330M&#34;
vm.kmem_size_max=&#34;330M&#34;
vfs.zfs.arc_max=&#34;40M&#34;
vfs.zfs.vdev.cache.size=&#34;5M&#34;</pre></div></div><div class=paragraph><p>Zie voor een meer gedetailleerde lijst van aanbevelingen aangaande ZFS-afstelling: <a href=http://wiki.freebsd.org/ZFSTuningGuide>http://wiki.freebsd.org/ZFSTuningGuide</a> .</p></div></div></div><div class=sect3><h4 id=_gebruik_maken_van_zfs>21.2.2. Gebruik maken van ZFS<a class=anchor href=#_gebruik_maken_van_zfs></a></h4><div class=paragraph><p>Er is een opstartmechanisme dat FreeBSD in staat stelt om ZFS pools te mounten tijdens initialisatie van het systeem. Voer de volgende commando’s uit om dit in te stellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;zfs_enable=&#34;YES&#34;&#39; &gt;&gt; /etc/rc.conf</span>
<span class=c># service zfs start</span></code></pre></div></div><div class=paragraph><p>In het resterende deel van dit document wordt aangenomen dat er drie SCSI-schijven beschikbaar zijn, en dat hun apparaatnamen respectievelijk <span class=filename>da0</span>, <span class=filename>da1</span> en <span class=filename>da2</span> zijn. Gebruikers van IDE-hardware kunnen de <span class=filename>ad</span> apparaten gebruiken in plaats van SCSI-apparaten.</p></div><div class=sect4><h5 id=_een_pool_op_een_enkele_schijf>21.2.2.1. Een pool op een enkele schijf<a class=anchor href=#_een_pool_op_een_enkele_schijf></a></h5><div class=paragraph><p>Voer het commando <code>zpool</code> uit om een simpele, niet-redundante ZFS-pool op een enkele schijf aan te maken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool create example /dev/da0</span></code></pre></div></div><div class=paragraph><p>Bestudeer de uitvoer van het commando <code>df</code> om de nieuwe pool te zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># df</span>
Filesystem  1K-blocks    Used    Avail Capacity  Mounted on
/dev/ad0s1a   2026030  235230  1628718    13%    /
devfs               1       1        0   100%    /dev
/dev/ad0s1d  54098308 1032846 48737598     2%    /usr
example      17547136       0 17547136     0%    /example</code></pre></div></div><div class=paragraph><p>In deze uitvoer wordt duidelijk dat de <code>example</code>-pool niet alleen is aangemaakt, maar ook direct <em>gemount</em> is. Hij is ook toegankelijk, net als een gewoon bestandssysteem; er kunnen bestanden op worden aangemaakt en gebruikers kunnen er op rondkijken zoals in het volgende voorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /example</span>
<span class=c># ls</span>
<span class=c># touch testfile</span>
<span class=c># ls -al</span>
total 4
drwxr-xr-x   2 root  wheel    3 Aug 29 23:15 <span class=nb>.</span>
drwxr-xr-x  21 root  wheel  512 Aug 29 23:12 ..
<span class=nt>-rw-r--r--</span>   1 root  wheel    0 Aug 29 23:15 testfile</code></pre></div></div><div class=paragraph><p>Helaas benut deze pool nog geen ZFS-mogelijkheden. Maak een bestandssysteem aan op deze pool en activeer er compressie op:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs create example/compressed</span>
<span class=c># zfs set compression=gzip example/compressed</span></code></pre></div></div><div class=paragraph><p><code>example/compressed</code> is nu een gecomprimeerd ZFS-bestandssysteem. Probeer er een paar grote bestanden naartoe te kopiëren door ze naar <span class=filename>/example/compressed</span> te kopiëren.</p></div><div class=paragraph><p>De compressie kan nu worden uitgeschakeld met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set compression=off example/compressed</span></code></pre></div></div><div class=paragraph><p>Voer het volgende commando uit om het bestandssysteem te unmounten, en controleer dat daarna met <code>df</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs umount example/compressed</span>
<span class=c># df</span>
Filesystem  1K-blocks    Used    Avail Capacity  Mounted on
/dev/ad0s1a   2026030  235232  1628716    13%    /
devfs               1       1        0   100%    /dev
/dev/ad0s1d  54098308 1032864 48737580     2%    /usr
example      17547008       0 17547008     0%    /example</code></pre></div></div><div class=paragraph><p>Mount het bestandssysteem opnieuw om het weer toegankelijk te maken en controleer met <code>df</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs mount example/compressed</span>
<span class=c># df</span>
Filesystem         1K-blocks    Used    Avail Capacity  Mounted on
/dev/ad0s1a          2026030  235234  1628714    13%    /
devfs                      1       1        0   100%    /dev
/dev/ad0s1d         54098308 1032864 48737580     2%    /usr
example             17547008       0 17547008     0%    /example
example/compressed  17547008       0 17547008     0%    /example/compressed</code></pre></div></div><div class=paragraph><p>De pool en het bestandssysteem zijn ook zichtbaar in de uitvoer van <code>mount</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount</span>
/dev/ad0s1a on / <span class=o>(</span>ufs, <span class=nb>local</span><span class=o>)</span>
devfs on /dev <span class=o>(</span>devfs, <span class=nb>local</span><span class=o>)</span>
/dev/ad0s1d on /usr <span class=o>(</span>ufs, <span class=nb>local</span>, soft-updates<span class=o>)</span>
example on /example <span class=o>(</span>zfs, <span class=nb>local</span><span class=o>)</span>
example/data on /example/data <span class=o>(</span>zfs, <span class=nb>local</span><span class=o>)</span>
example/compressed on /example/compressed <span class=o>(</span>zfs, <span class=nb>local</span><span class=o>)</span></code></pre></div></div><div class=paragraph><p>Zoals is te zien kunnen ZFS-bestandssystemen, nadat ze zijn gecreëerd, net als gewone bestandssystemen worden gebruikt; er zijn echter ook vele andere mogelijkheden beschikbaar. In het volgende voorbeeld wordt er een nieuw bestandssysteem <code>data</code> gecreëerd. Er zullen belangrijke bestanden op worden bewaard, dus het bestandssysteem wordt zodanig ingesteld dat het twee kopieën van ieder gegevensblok opslaat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs create example/data</span>
<span class=c># zfs set copies=2 example/data</span></code></pre></div></div><div class=paragraph><p>Het is nu mogelijk om het gegevens- en ruimtegebruik te bekijken door <code>df</code> opnieuw te draaien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># df</span>
Filesystem         1K-blocks    Used    Avail Capacity  Mounted on
/dev/ad0s1a          2026030  235234  1628714    13%    /
devfs                      1       1        0   100%    /dev
/dev/ad0s1d         54098308 1032864 48737580     2%    /usr
example             17547008       0 17547008     0%    /example
example/compressed  17547008       0 17547008     0%    /example/compressed
example/data        17547008       0 17547008     0%    /example/data</code></pre></div></div><div class=paragraph><p>Merk op dat ieder bestandssysteem in de pool dezelfde hoeveelheid vrije ruimte heeft. Dit is de reden dat <code>df</code> steeds wordt gebruikt tussen de voorbeelden door, om te laten zien dat de bestandssystemen slechts zoveel ruimte gebruiken als ze nodig hebben en allemaal putten uit dezelfde pool. Het ZFS bestandssysteem elimineert concepten als volumes en partities, en staat verschillende bestandssystemen toe om in dezelfde pool te bestaan. Verwijder nu de bestandssystemen en verwijder daarna de pool, omdat deze niet meer nodig zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs destroy example/compressed</span>
<span class=c># zfs destroy example/data</span>
<span class=c># zpool destroy example</span></code></pre></div></div><div class=paragraph><p>Schijven gaan slechter werken en begeven het, een onvermijdelijke eigenschap. Wanneer de schijf stukgaat zullen de gegevens verloren gaan. Een methode om gegevensverlies ten gevolge van een kapotte harde schijf te vermijden is het implementeren van RAID. ZFS ondersteunt deze mogelijkheid in zijn pool-ontwerp en wordt beschreven in de volgende sectie.</p></div></div><div class=sect4><h5 id=_zfs_raid_z>21.2.2.2. ZFS RAID-Z<a class=anchor href=#_zfs_raid_z></a></h5><div class=paragraph><p>Zoals eerder opgemerkt wordt in deze sectie aangenomen dat er drie SCSI-schijven bestaan als de apparaten <span class=filename>da0</span>, <span class=filename>da1</span> en <span class=filename>da2</span> (of <span class=filename>ad0</span> en hoger als IDE-schijven worden gebruikt). Voer het volgende commando uit om een RAID-Z-pool te creëren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool create storage raidz da0 da1 da2</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sun™ raadt aan om tussen de drie en negen schijven te gebruiken voor een RAID-Z-configuratie. Overweeg, als u een enkele pool met 10 of meer schijven nodig heeft, om deze te splitsen in kleine RAID-Z-groepen. Overweeg, als u slechts twee schijven heeft en nog steeds redundantie nodig heeft, om in plaats hiervan een ZFS-spiegel te gebruiken. Bekijk de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=zpool&amp;sektion=8&amp;format=html">zpool(8)</a> voor meer details.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De <code>storage</code> zpool zou gecreëerd moeten zijn. Dit kan worden geverifieerd met de <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> commando’s zoals eerder. Er kunnen meer schijfapparaten worden toegewezen door ze aan het einde van de bovenstaande lijst toe te voegen. Maak een nieuw bestandssysteem in de pool, genaamd <code>home</code>, waar op den duur de gebruikersbestanden geplaatst zullen worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs create storage/home</span></code></pre></div></div><div class=paragraph><p>Het is nu mogelijk om compressie in te schakelen en extra kopieën te bewaren van de gebruikersmappen en -bestanden. Dit kan net als eerder worden bewerkstelligd door de volgende commando’s uit te voeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set copies=2 storage/home</span>
<span class=c># zfs set compression=gzip storage/home</span></code></pre></div></div><div class=paragraph><p>Kopieer, om dit als de nieuwe home-map voor gebruikers in te stellen, de gebruikersgegevens naar deze map en creëer de benodigde links:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp -rp /home/* /storage/home</span>
<span class=c># rm -rf /home /usr/home</span>
<span class=c># ln -s /storage/home /home</span>
<span class=c># ln -s /storage/home /usr/home</span></code></pre></div></div><div class=paragraph><p>De gebruikersgegevens zouden nu op het nieuw aangemaakte <span class=filename>/storage/home</span> bestandssysteem moeten staan. Test dit door een nieuwe gebruiker aan te maken en daarmee in te loggen.</p></div><div class=paragraph><p>Probeer een snapshot te maken dat later weer hersteld kan worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs snapshot storage/home@08-30-08</span></code></pre></div></div><div class=paragraph><p>Merk op dat de snapshot-optie alleen een echt bestandssysteem vastlegt, geen mappen of bestanden. Het <code>@</code>-karakter wordt gebruikt als scheidingsteken tussen de naam van het bestandssysteem of de naam van het volume. Wanneer de home-map van een gebruiker wordt weggegooid, kan deze worden hersteld met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs rollback storage/home@08-30-08</span></code></pre></div></div><div class=paragraph><p>Voer <code>ls</code> in de <span class=filename>.zfs/snapshot</span> directory van het bestandssysteem uit om een lijst van alle beschikbare snapshots te krijgen. Voer, om bijvoorbeeld het zojuist gemaakte snapshot te zien, het volgende commando uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /storage/home/.zfs/snapshot</span></code></pre></div></div><div class=paragraph><p>Het is mogelijk om een script te schrijven dat maandelijks een snapshot van de gebruikersgegevens maakt; na verloop van tijd kunnen snapshots echter een grote hoeveelheid schrijfruimte in beslag nemen. Het vorige snapshot kan worden verwijderd met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs destroy storage/home@08-30-08</span></code></pre></div></div><div class=paragraph><p>Na al dit testen is er geen reden om <span class=filename>/storage/home</span> in zijn huidige staat nog te bewaren. Maak er het echte <span class=filename>/home</span> bestandssysteem van:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set mountpoint=/home storage/home</span></code></pre></div></div><div class=paragraph><p>Het uitvoeren van de commando’s <code>df</code> en <code>mount</code> laat zien dat het systeem ons bestandssysteem nu als de echte <span class=filename>/home</span> behandelt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount</span>
/dev/ad0s1a on / <span class=o>(</span>ufs, <span class=nb>local</span><span class=o>)</span>
devfs on /dev <span class=o>(</span>devfs, <span class=nb>local</span><span class=o>)</span>
/dev/ad0s1d on /usr <span class=o>(</span>ufs, <span class=nb>local</span>, soft-updates<span class=o>)</span>
storage on /storage <span class=o>(</span>zfs, <span class=nb>local</span><span class=o>)</span>
storage/home on /home <span class=o>(</span>zfs, <span class=nb>local</span><span class=o>)</span>
<span class=c># df</span>
Filesystem   1K-blocks    Used    Avail Capacity  Mounted on
/dev/ad0s1a    2026030  235240  1628708    13%    /
devfs                1       1        0   100%    /dev
/dev/ad0s1d   54098308 1032826 48737618     2%    /usr
storage       26320512	     0 26320512     0%    /storage
storage/home  26320512       0 26320512     0%    /home</code></pre></div></div><div class=paragraph><p>Hiermee is de RAID-Z configuratie compleet. Voer het volgende commando uit om status-updates van de gecreëerde bestandssystemen te krijgen tijdens het draaien van de nachtelijke <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;daily_status_zfs_enable=&#34;YES&#34;&#39; &gt;&gt; /etc/periodic.conf</span></code></pre></div></div></div><div class=sect4><h5 id=_het_herstellen_van_raid_z>21.2.2.3. Het herstellen van RAID-Z<a class=anchor href=#_het_herstellen_van_raid_z></a></h5><div class=paragraph><p>Iedere software-RAID heeft een methode om zijn <code>status</code> te inspecteren. ZFS is geen uitzondering. De status van RAID-Z-apparaten kan worden geïnspecteerd met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool status -x</span></code></pre></div></div><div class=paragraph><p>Als alle pools in orde zijn en alles is normaal, dan wordt het volgende bericht weergegeven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>all pools are healthy</code></pre></div></div><div class=paragraph><p>Als er een probleem is, misschien een schijf die offine is gegaan, dan wordt de status van de pool weergegeven en dat zal er als volgt uitzien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  pool: storage
 state: DEGRADED
status: One or more devices has been taken offline by the administrator.
	Sufficient replicas exist <span class=k>for </span>the pool to <span class=k>continue </span>functioning <span class=k>in </span>a
	degraded state.
action: Online the device using <span class=s1>&#39;zpool online&#39;</span> or replace the device with
	<span class=s1>&#39;zpool replace&#39;</span><span class=nb>.</span>
 scrub: none requested
config:

	NAME        STATE     READ WRITE CKSUM
	storage     DEGRADED     0     0     0
	  raidz1    DEGRADED     0     0     0
	    da0     ONLINE       0     0     0
	    da1     OFFLINE      0     0     0
	    da2     ONLINE       0     0     0

errors: No known data errors</code></pre></div></div><div class=paragraph><p>Hier staat dat het apparaat offline is gezet door de beheerder. Dat is waar voor dit specifieke voorbeeld. Om de schijf offline te zetten werd het volgende commando gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool offline storage da1</span></code></pre></div></div><div class=paragraph><p>Het is nu mogelijk om de schijf <span class=filename>da1</span> te vervangen nadat het systeem uitgeschakeld is. Zodra het systeem weer opgestart is, kan het volgende commando worden uitgevoerd om de schijf te vervangen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool replace storage da1</span></code></pre></div></div><div class=paragraph><p>Nu kan de status opnieuw geïnspecteerd worden, dit keer zonder de <code>-x</code> vlag, om de statusinformatie op te vragen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool status storage</span>
 pool: storage
 state: ONLINE
 scrub: resilver completed with 0 errors on Sat Aug 30 19:44:11 2008
config:

	NAME        STATE     READ WRITE CKSUM
	storage     ONLINE       0     0     0
	  raidz1    ONLINE       0     0     0
	    da0     ONLINE       0     0     0
	    da1     ONLINE       0     0     0
	    da2     ONLINE       0     0     0

errors: No known data errors</code></pre></div></div><div class=paragraph><p>Zoals te zien in dit voorbeeld lijkt alles normaal te zijn.</p></div></div><div class=sect4><h5 id=_gegevensverificatie>21.2.2.4. Gegevensverificatie<a class=anchor href=#_gegevensverificatie></a></h5><div class=paragraph><p>Zoals eerder opgemerkt gebruikt ZFS <code>checksums</code> om de integriteit van opgeslagen gegevens te verifiëren. Ze worden automatisch ingeschakeld bij het creëeren van bestandssystemen en kunnen worden uitgeschakeld door middel van het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set checksum=off storage/home</span></code></pre></div></div><div class=paragraph><p>Dit is echter geen verstandig idee, omdat checksums zeer weinig opslagruimte innemen en nuttiger zijn wanneer ze zijn ingeschakeld. Het lijkt daarnaast ook geen merkbare invloed op de prestaties te hebben wanneer ze zijn ingeschakeld. Wanneer ze aanstaan is het mogelijk om ZFS gegevensintegriteit te laten controleren door middel van checksum-verificatie. Dit proces staat bekend als "scrubbing". Voer het volgende commando uit om de gegevensintegriteit van de <code>storage</code>-pool te controleren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool scrub storage</span></code></pre></div></div><div class=paragraph><p>Dit proces kan, afhankelijk van de hoeveelheid opgeslagen gegevens, een aanzienlijke hoeveelheid tijd in beslag nemen. Het is daarnaast ook zeer I/O-intensief, zozeer dat slechts één van deze operaties tegelijkertijd uitgevoerd kan worden. Nadat de scrub is voltooid wordt de status bijgewerkt en kan deze worden bekeken door een statusaanvraag te doen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool status storage</span>
 pool: storage
 state: ONLINE
 scrub: scrub completed with 0 errors on Sat Aug 30 19:57:37 2008
config:

	NAME        STATE     READ WRITE CKSUM
	storage     ONLINE       0     0     0
	  raidz1    ONLINE       0     0     0
	    da0     ONLINE       0     0     0
	    da1     ONLINE       0     0     0
	    da2     ONLINE       0     0     0

errors: No known data errors</code></pre></div></div><div class=paragraph><p>De voltooiingstijd is in dit voorbeeld duidelijk zichtbaar. Deze eigenschap helpt om gegevensintegriteit te garanderen gedurende een langere tijdsperiode.</p></div><div class=paragraph><p>Er zijn vele andere opties voor het Z-bestandssysteem, zie de handleidingpagina’s <a href="https://man.freebsd.org/cgi/man.cgi?query=zfs&amp;sektion=8&amp;format=html">zfs(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=zpool&amp;sektion=8&amp;format=html">zpool(8)</a>.</p></div></div><div class=sect4><h5 id=_zfs_quota>21.2.2.5. ZFS quota<a class=anchor href=#_zfs_quota></a></h5><div class=paragraph><p>ZFS ondersteunt verschillende soorten quota: de refquota, de algemene quota, de gebruikersquota en de groepsquota. Deze sectie legt de beginselen van ieder van deze uit en bevat wat instructies voor gebruik.</p></div><div class=paragraph><p>Quota beperken de hoeveelheid ruimte die een gegevensverzameling en zijn afstammelingen kunnen gebruiken en dwingen een limiet af op de hoeveelheid ruimte dat gebruikt wordt door bestandssystemen en snapshots voor deze afstammelingen. Vanuit gebruikers zijn quota handig om de hoeveelheid ruimte die een bepaalde gebruiker kan gebruiken te beperken.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Quota kunnen niet op volumes worden ingesteld, aangezien de eigenschap <code>volsize</code> als een impliciet quotum optreedt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De refquota, <code>refquota=grootte</code>, beperkt de hoeveelheid ruimte die een gegevensverzameling in beslag kan nemen door een harde grens aan de gebruikte ruimte te stellen. Deze harde grens bevat echter niet de ruimte gebruikt door afstammelingen, zoals bestandssystemen of snapshots.</p></div><div class=paragraph><p>Gebruik het volgende om een algemeen quotum van 10 GB voor <span class=filename>/home/storage/bob</span> af te dwingen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set quota=10G storage/home/bob</span></code></pre></div></div><div class=paragraph><p>Gebruikersquota beperken de hoeveelheid ruimte die door de aangegeven gebruiker kan worden gebruikt. Het algemene formaat is <code>userquota@gebruiker=grootte</code> waarbij de gebruikersnaam in één van de volgende formaten dient te zijn:</p></div><div class=ulist><ul><li><p>Naam compatibel met POSIX (bijvoorbeeld <em>jan</em>).</p></li><li><p>Numeriek POSIX-ID (bijvoorbeeld <em>789</em>).</p></li><li><p>SID-naam (bijvoorbeeld <em>jan.bloggs@example.com</em>).</p></li><li><p>Numeriek SID-ID (bijvoorbeeld <em>S-1-123-456-789</em>).</p></li></ul></div><div class=paragraph><p>Gebruik het volgende om bijvoorbeeld een quotum van 50 GB voor een gebruiker <em>jan</em> af te dwingen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set userquota@jan=50G</span></code></pre></div></div><div class=paragraph><p>Gebruik in plaats hiervan, om het quotum te verwijderen of er zeker van te zijn dat er geen is ingesteld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set userquota@jan=none</span></code></pre></div></div><div class=paragraph><p>Eigenschappen van gebruikersquota worden niet weergegeven door <code>zfs get all</code>. Niet-<code>root</code> gebruikers kunnen alleen hun eigen quota zien tenzij het privilege <code>userquota</code> aan ze is gegeven. Gebruikers met dit privilege kunnen ieders quota bekijken en instellen.</p></div><div class=paragraph><p>Groepsquota beperken de hoeveelheid ruimte die de gespecificeerde gebruikersgroep in beslag kan nemen. Het algemene formaat is <code>groupquota@groep=grootte</code>.</p></div><div class=paragraph><p>Gebruik om het quotum voor de groep <em>eerstegroep</em> op 50 GB in te stellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set groupquota@eerstegroep=50G</span></code></pre></div></div><div class=paragraph><p>Gebruik in plaats hiervan, om het quotum voor de groep <em>eerstegroep</em> te verwijderen of om er voor te zorgen dat deze niet is ingesteld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set groupquota@eerstegroep=none</span></code></pre></div></div><div class=paragraph><p>Net zoals bij de eigenschappen van gebruikersquota kunnen niet-<code>root</code>-gebruikers alleen de quota zien die geassocieerd zijn met de gebruikersgroepen waar ze bij horen, een <code>root</code>-gebruiker of een gebruiker met het privilege <code>groupquota</code> kan alle quota voor alle groepen bekijken en instellen.</p></div><div class=paragraph><p>Het deelcommando <code>zfs userspace</code> geeft de hoeveelheid ruimte weer die door elke gebruiker op de snapshot van het gespecificeerde bestandssysteem in beslag wordt genomen, tezamen met alle ingestelde quota. Het deelcommando <code>zfs groupspace</code> doet hetzelfde voor groepen. Bekijk <a href="https://man.freebsd.org/cgi/man.cgi?query=zfs&amp;sektion=1&amp;format=html">zfs(1)</a> voor meer informatie over ondersteunde opties of het weergegeven van specifieke opties.</p></div><div class=paragraph><p>Gebruik het volgende om de quota voor <span class=filename>storage/home/bob</span> weer te geven, als u de juiste privileges heeft of <code>root</code> bent:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs get quota storage/home/bob</span></code></pre></div></div></div><div class=sect4><h5 id=_reserveringen_in_zfs>21.2.2.6. Reserveringen in ZFS<a class=anchor href=#_reserveringen_in_zfs></a></h5><div class=paragraph><p>ZFS ondersteunt twee soorten van ruimtereserveringen. Deze sectie legt de beginselen van elk van de twee uit en bevat enkele instructies voor gebruik.</p></div><div class=paragraph><p>De eigenschap <code>reservation</code> maakt het mogelijk om een gegarandeerde minimale hoeveelheid ruimte voor een gegevensverzameling en zijn afstammelingen te reserveren. Dit betekent dat als er een reservering van 10 GB is ingesteld voor <span class=filename>storage/home/bob</span> en de schijfruimte op raakt, er tenminste 10 GB aan ruimte is gereserveerd voor deze gegevensverzameling. De eigenschap <code>reservation</code> stelt de minimale hoeveelheid ruimte in die gegarandeerd is voor een gegevensverzameling exclusief afstammelingen zoals snapshots, of geeft deze aan. Als er bijvoorbeeld een snapshot is genomen van <span class=filename>storage/home/bob</span> moet er genoeg schijfruimte zijn buiten de <code>refreservation</code> hoeveelheid om de operatie te laten slagen omdat afstammelingen van de hoofdgegevensverzameling niet worden meegeteld in de <code>refreservation</code> hoeveelheid en dus niet stiekem de vastgestelde ruimte wijzigen.</p></div><div class=paragraph><p>Reserveringen kunnen in allerlei situaties nuttig zijn, bijvoorbeeld voor het plannen en testen van de geschiktheid van het toewijzen van schijfruimte in een nieuw systeem, of om ervoor te zorgen dat er genoeg schijfruimte beschikbaar is op bestandsssystemen voor systeemherstelprocedures en bestanden.</p></div><div class=paragraph><p>Het algemene formaat van de eigenschap <code>reservation</code> is <code>reservation=grootte</code>, dus gebruik het onderstaande commando om een reservering van 10 GB op <span class=filename>storage/home/bob</span> te plaatsen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set reservation=10G storage/home/bob</span></code></pre></div></div><div class=paragraph><p>Gebruik, om te controleren of er geen reservatie is geplaatst of om een reservatie te verwijderen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set reservation=none storage/home/bob</span></code></pre></div></div><div class=paragraph><p>Het zelfde principe kan worden toegepast op de eigenschap <code>refreservation</code> om een refreservation in te stellen, met het algemene formaat <code>refreservation=grootte</code>.</p></div><div class=paragraph><p>Gebruik één van de volgende commando’s om te kijken of er een reservatie of refreservation bestaat op <span class=filename>storage/home/bob</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs get reservation storage/home/bob</span>
<span class=c># zfs get refreservation storage/home/bob</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=filesystems-linux>21.3. Linux® bestandssystemen<a class=anchor href=#filesystems-linux></a></h3><div class=paragraph><p>Deze sectie beschrijft enkele van de Linux® bestandssystemen die door FreeBSD worden ondersteund.</p></div><div class=sect3><h4 id=_ext2fs>21.3.1. Ext2FS<a class=anchor href=#_ext2fs></a></h4><div class=paragraph><p>De kernelimplementatie van het <a href="https://man.freebsd.org/cgi/man.cgi?query=ext2fs&amp;sektion=5&amp;format=html">ext2fs(5)</a> bestandssysteem was geschreven door Godmar Back, het eerste stuurprogramma verscheen in FreeBSD 2.2. In FreeBSD 8 en eerder is de code gelicenseerd onder de GNU Public License, onder FreeBSD 9 is de code echter herschreven en nu beschikbaar onder de BSD-licentie.</p></div><div class=paragraph><p>Het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ext2fs&amp;sektion=5&amp;format=html">ext2fs(5)</a> stelt de FreeBSD-kernel in staat om ext2 bestandssystemen te lezen en er naar te schrijven.</p></div><div class=paragraph><p>Laad ten eerste de kernelmodule:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload ext2fs</span></code></pre></div></div><div class=paragraph><p>Koppel daarna een <a href="https://man.freebsd.org/cgi/man.cgi?query=ext2fs&amp;sektion=5&amp;format=html">ext2fs(5)</a>-volume aan dat zich op <span class=filename>/dev/ad1s1</span> bevindt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t ext2fs /dev/ad1s1 /mnt</span></code></pre></div></div></div><div class=sect3><h4 id=_xfs>21.3.2. XFS<a class=anchor href=#_xfs></a></h4><div class=paragraph><p>Het X-bestandssysteem, XFS, is origineel geschreven door SGI voor het besturingssysteem IRIX, ze hebben het overgebracht naar Linux®. De broncode is vrijgegeven onder de GNU Public License. Kijk op <a href=https://oss.sgi.com/projects/xfs>deze pagina</a> voor meer details. De FreeBSD-port werd gestart door Russel Cattelan, Alexander Kabaev &lt;<a href=mailto:kan@FreeBSD.org>kan@FreeBSD.org</a>> en Craig Rodrigues &lt;<a href=mailto:rodrigc@FreeBSD.org>rodrigc@FreeBSD.org</a>>.</p></div><div class=paragraph><p>Om XFS als een kernelmodule te laden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload xfs</span></code></pre></div></div><div class=paragraph><p>Het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=xfs&amp;sektion=5&amp;format=html">xfs(5)</a> stelt de FreeBSD-kernel in staat om XFS-bestandssystemen te benaderen. Momenteel is echter alleen ondersteuning voor lezen aanwezig. Schrijven naar een volume is niet mogelijk.</p></div><div class=paragraph><p>Om een <a href="https://man.freebsd.org/cgi/man.cgi?query=xfs&amp;sektion=5&amp;format=html">xfs(5)</a>-volume wat op <span class=filename>/dev/ad1s1</span> aan te koppelen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t xfs /dev/ad1s1 /mnt</span></code></pre></div></div><div class=paragraph><p>Merk op dat de port <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/xfsprogs/>sysutils/xfsprogs</a> het gereedschap <code>mkfs.xfs</code> bevat wat het mogelijk maakt om XFS-bestandssystemen aan te maken, en verder gereedschappen om ze te analyseren en repareren.</p></div><div class=paragraph><p>De vlag <code>-p</code> van <code>mkfs.xfs</code> kan worden gebruikt om een <a href="https://man.freebsd.org/cgi/man.cgi?query=xfs&amp;sektion=5&amp;format=html">xfs(5)</a>-bestandssysteem aan te maken welke bevolkt wordt met bestanden en andere meta-gegevens. Dit kan worden gebruikt om snel een alleen-lezen bestandssysteem aan te maken welke op FreeBSD getest kan worden.</p></div></div><div class=sect3><h4 id=_reiserfs>21.3.3. ReiserFS<a class=anchor href=#_reiserfs></a></h4><div class=paragraph><p>Het Reiser bestandssysteem, ReiserFS, was overgebracht naar FreeBSD door Jean-Sébastien Pédron &lt;<a href=mailto:dumbbell@FreeBSD.org>dumbbell@FreeBSD.org</a>> en is vrijgegeven onder de GNU Public License.</p></div><div class=paragraph><p>Het stuurprogramma voor ReiserFS stelt de FreeBSD-kernel momenteel in staat om ReiserFS bestandssystemen te benaderen en hun inhoud te lezen, maar het kan ze momenteel niet beschrijven.</p></div><div class=paragraph><p>Laad ten eerste eerst de kernelmodule:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload reiserfs</span></code></pre></div></div><div class=paragraph><p>Om ten tweede een ReiserFS-volume dat zich op <span class=filename>/dev/ad1s1</span> aan te koppelen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t reiserfs /dev/ad1s1 /mnt</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=virtualization>Hoofdstuk 22. Virtualisatie<a class=anchor href=#virtualization></a></h2><div class=sectionbody><div class=sect2><h3 id=virtualization-synopsis>22.1. Overzicht<a class=anchor href=#virtualization-synopsis></a></h3><div class=paragraph><p>Virtualisatiesoftware maakt het mogelijk om meerdere besturingssystemen gelijktijdig op dezelfde computer te draaien. Zulke softwaresystemen voor PC’s gebruiken vaak een gastheer-besturingssysteem dat de virtualisatiesoftware draait en dat elk aantal gast-besturingssystemen ondersteunt.</p></div><div class=paragraph><p>Aan het einde van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Het verschil tussen een gastheer-besturingssysteem en een gast-besturingssysteem.</p></li><li><p>Hoe FreeBSD op een Intel®-gebaseerde Apple® Macintosh® computer te installeren.</p></li><li><p>Hoe FreeBSD op Microsoft® Windows® te installeren met Virtual PC.</p></li><li><p>Hoe een FreeBSD-systeem in te stellen voor de beste prestaties tijdens virtualisatie.</p></li></ul></div><div class=paragraph><p>Voor het lezen van dit hoofdstuk, dient de lezer:</p></div><div class=ulist><ul><li><p>De beginselen van UNIX® en FreeBSD (<a href=./#basics>UNIX® beginselen</a>) te begrijpen.</p></li><li><p>Te weten hoe FreeBSD te installeren (<a href=./#install>FreeBSD installeren op FreeBSD 8.X en eerder</a>).</p></li><li><p>Te weten hoe een netwerkverbinding te installeren (<a href=./#advanced-networking>Geavanceerd netwerken</a>).</p></li><li><p>Te weten hoe aanvullende software van derde partijen te installeren (<a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></li></ul></div></div><div class=sect2><h3 id=virtualization-guest>22.2. FreeBSD als een gast-besturingssysteem<a class=anchor href=#virtualization-guest></a></h3><div class=sect3><h4 id=virtualization-guest-parallels>22.2.1. Parallels op Mac OS®<a class=anchor href=#virtualization-guest-parallels></a></h4><div class=paragraph><p>Parallels Desktop voor Mac OS® is een commercieel softwareprodukt voor Intel®-gebaseerde Apple® Mac® computers die Mac OS® 10.4.6 of nieuwer draaien. FreeBSD is een volledig ondersteund gast-besturingssysteem. Nadat Parallels is geïnstalleerd op Mac OS® X dient de gebruiker een virtuele machine in te stellen en daarna het gewenste gast-besturingssysteem te installeren.</p></div><div class=sect4><h5 id=virtualization-guest-parallels-install>22.2.1.1. FreeBSD installeren op Parallels/Mac OS® X<a class=anchor href=#virtualization-guest-parallels-install></a></h5><div class=paragraph><p>De eerste stap in het installeren van FreeBSD op Mac OS® X Parallels is het aanmaken van een nieuwe virtuele machine voor het installeren van FreeBSD. Selecteer <span class=guimenuitem>FreeBSD</span> als het <span class=guimenuitem>Guest OS Type</span> wanneer dit gevraagd wordt:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd1.png alt="parallels freebsd1"></div></div><div class=paragraph><p>Kies verder een hoeveelheid aan schijf- en geheugenruimte afhankelijk van de plannen voor deze virtuele instantie van FreeBSD. 4GB aan schijfruimte en 512MB aan RAM werken goed voor de meeste gebruikers van FreeBSD onder Parallels:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd2.png alt="parallels freebsd2"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd3.png alt="parallels freebsd3"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd4.png alt="parallels freebsd4"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd5.png alt="parallels freebsd5"></div></div><div class=paragraph><p>Selecteer het type netwerk en een netwerkinterface:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd6.png alt="parallels freebsd6"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd7.png alt="parallels freebsd7"></div></div><div class=paragraph><p>Bewaar de instellingen en sluit af:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd8.png alt="parallels freebsd8"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd9.png alt="parallels freebsd9"></div></div><div class=paragraph><p>Nadat de virtuele FreeBSD-machine is aangemaakt, dient er FreeBSD op geïnstalleerd te worden. Dit gaat het beste met een officiële FreeBSD CDROM of met een ISO-beeld dat is gedownload van een officiële FTP-site. Wanneer het juiste ISO-beeld op het plaatselijke Mac®-bestandssysteem of een CDROM in de CD-drive van de Mac® aanwezig is, dient op het schijfikoon in de rechteronderhoek van het FreeBSD Parallels-scherm geklikt te worden. Dit zal een scherm tonen dat het mogelijk maakt om de CDROM-drive in de virtuele machine te associëren met een ISO-bestand op schijf of met een echte CDROM-drive.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd11.png alt="parallels freebsd11"></div></div><div class=paragraph><p>Nadat deze associatie met de CDROM-bron is gemaakt, dient de virtuele FreeBSD-machine herstart te worden door op het herstart-icoon te klikken. Parallels zal herstarten met een speciale BIOS dat eerst controleert of er een CDROM aanwezig is, net zoals een normale BIOS zou doen.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd10.png alt="parallels freebsd10"></div></div><div class=paragraph><p>In dit geval zal het de installatiemedia van FreeBSD vinden en een normale installatie gebaseerd op sysinstall beginnen zoals beschreven in <a href=./#install>FreeBSD installeren op FreeBSD 8.X en eerder</a>. X11 kan nu geïnstalleerd, maar nog niet ingesteld, worden.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd12.png alt="parallels freebsd12"></div></div><div class=paragraph><p>Nadat de installatie is voltooid, kan naar de nieuw geïnstalleerde virtuele FreeBSD-machine herstart worden.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd13.png alt="parallels freebsd13"></div></div></div><div class=sect4><h5 id=virtualization-guest-parallels-configure>22.2.1.2. FreeBSD instellen op Mac OS® X/Parallels<a class=anchor href=#virtualization-guest-parallels-configure></a></h5><div class=paragraph><p>Nadat FreeBSD succesvol op Mac OS® X met Parallels is geïnstalleerd, zijn er een aantal instellingen die gewijzigd kunnen worden om het systeem voor virtuele werking te optimaliseren.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>De variabelen voor de bootloader instellen</p><div class=paragraph><p>De belangrijkste stap is om de tunable <code>kern.hz</code> te verlagen om het CPU-gebruik van FreeBSD onder de Parallels-omgeving te verminderen. Dit kan bereikt worden door de volgende regel aan <span class=filename>/boot/loader.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>kern.hz=100</pre></div></div><div class=paragraph><p>Zonder deze instelling zal een rustend FreeBSD Parallels gast-besturingssysteem ongeveer 15% van de CPU van een enkele iMac®-processor gebruiken. Na deze wijziging zal het gebruik slechts ongeveer 5% zijn.</p></div></li><li><p>Een nieuw instellingenbestand voor de kernel aanmaken</p><div class=paragraph><p>Alle stuurprogramma’s voor SCSI, FireWire, en USB kunnen verwijderd worden. Parallels biedt een virtuele netwerkadapter die door het stuurpogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ed&amp;sektion=4&amp;format=html">ed(4)</a> wordt gebruikt, dus kunnen alle andere netwerkapparaten behalve <a href="https://man.freebsd.org/cgi/man.cgi?query=ed&amp;sektion=4&amp;format=html">ed(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=miibus&amp;sektion=4&amp;format=html">miibus(4)</a> uit de kernel verwijderd worden.</p></div></li><li><p>Het netwerk instellen</p><div class=paragraph><p>De eenvoudigste netwerkinstallatie omvat het gebruik van DHCP om de virtuele machine met hetzelfde LAN te verbinden als het Mac®-gastheer. Dit kan bereikt worden door <code>ifconfig_ed0="DHCP"</code> aan <span class=filename>/etc/rc.conf</span> toe te voegen. Meer geavanceerde netwerkinstallaties staan beschreven in <a href=./#advanced-networking>Netwerken voor gevorderden</a>.</p></div></li></ol></div></div></div></div></div><div class=sect3><h4 id=virtualization-guest-virtualpc>22.2.2. Virtual PC op Windows®<a class=anchor href=#virtualization-guest-virtualpc></a></h4><div class=paragraph><p>Virtual PC voor Windows® is een softwareprodukt van Microsoft® dat gratis gedownload kan worden . Zie <a href=http://www.microsoft.com/windows/downloads/virtualpc/sysreq.mspx>systeemeisen</a>. Nadat Virtual PC is geïnstalleerd op Microsoft® Windows®, dient de gebruiker een virtuele machine in te stellen en daarna het gewenste gast-besturingssysteem te installeren.</p></div><div class=sect4><h5 id=virtualization-guest-virtualpc-install>22.2.2.1. FreeBSD installeren op Virtual PC/Microsoft® Windows®<a class=anchor href=#virtualization-guest-virtualpc-install></a></h5><div class=paragraph><p>De eerste stap in het installeren van FreeBSD op Microsoft® Windows®/Virtual PC is het aanmaken van een nieuwe virtuele machine voor het installeren van FreeBSD. Kies <span class=guimenuitem>Create a virtual machine</span> wanneer daarom wordt gevraagd:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd1.png alt="virtualpc freebsd1"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd2.png alt="virtualpc freebsd2"></div></div><div class=paragraph><p>Selecteer <span class=guimenuitem>Other</span> als het <span class=guimenuitem>Operating system</span> wanneer dat gevraagd wordt:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd3.png alt="virtualpc freebsd3"></div></div><div class=paragraph><p>Kies vervolgens een gepaste hoeveelheid aan schijf- en geheugenruimte afhankelijk van de plannen voor deze virtuele instantie van FreeBSD. 4GB aan schijfruimte en 512MB aan RAM werken goed voor de meeste gebruikers van FreeBSD onder Virtual PC:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd4.png alt="virtualpc freebsd4"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd5.png alt="virtualpc freebsd5"></div></div><div class=paragraph><p>Bewaar de instellingen en sluit ze af:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd6.png alt="virtualpc freebsd6"></div></div><div class=paragraph><p>Selecteer de virtuele FreeBSD-machine en klik op <b class=menuref>Settings</b>, stel daarna het type netwerk en een netwerkinterface in:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd7.png alt="virtualpc freebsd7"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd8.png alt="virtualpc freebsd8"></div></div><div class=paragraph><p>Nadat de virtuele FreeBSD-machine is aangemaakt, dient FreeBSD erop geïnstalleerd te worden. Dit gaat het beste met een officiële FreeBSD-CDROM of met een ISO-beeld dat van een officiële FTP-site is gedownload. Wanneer het juiste ISO-beeld op het lokale bestandssysteem van Windows® staat of er een CDROM in de CD-drive zit, dubbelklik dan op de virtuele FreeBSD-machine om op te starten. Klik daarna op <b class=menuref>CD</b> en kies menu:Capture ISO Image…​ [] in het venster van Virtual PC . Dit toont een scherm dat het mogelijk maakt om de CDROM-drive in de virtuele machine te associëren met een ISO-bestand op schijf of met een echte CDROM-drive.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd9.png alt="virtualpc freebsd9"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd10.png alt="virtualpc freebsd10"></div></div><div class=paragraph><p>Start, nadat deze associatie met de CDROM-bron is gemaakt, de virtuele FreeBSD-machine opnieuw op zoals gewoonlijk door op <b class=menuref>Action</b> en <b class=menuref>Reset</b> te klikken. Virtual PC zal herstarten met een speciale BIOS dat eerst controleert of er een CDROM aanwezig is, net zoals eeen normale BIOS dat zou doen.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd11.png alt="virtualpc freebsd11"></div></div><div class=paragraph><p>In dit geval zal het de installatiemedia van FreeBSD vinden en een normale installatie gebaseerd op sysinstall beginnen zoals beschreven in <a href=./#install>FreeBSD installeren op FreeBSD 8.X en eerder</a>. X11 kan nu geïnstalleerd, maar nog niet ingesteld, worden.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd12.png alt="virtualpc freebsd12"></div></div><div class=paragraph><p>Denk eraan om de CDROM of het ISO-beeld te verwijderen nadat de installatie voltooid is. Start als laatste op naar de nieuw geïnstalleerde virtuele FreeBSD-machine.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd13.png alt="virtualpc freebsd13"></div></div></div><div class=sect4><h5 id=virtualization-guest-virtualpc-configure>22.2.2.2. FreeBSD instellen op Microsoft® Windows®/Virtual PC<a class=anchor href=#virtualization-guest-virtualpc-configure></a></h5><div class=paragraph><p>Nadat FreeBSD succesvol is geïnstalleerd op Microsoft® Windows® met Virtual PC zijn er een aantal instellingen die aangepast kunnen worden om het system te optimaliseren voor virtueel gebruik.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>De variabelen voor de bootloader instellen</p><div class=paragraph><p>De belangrijkste stap is om de tunable <code>kern.hz</code> te verlagen om zo het CPU-gebruik van FreeBSD in de omgeving van Virtual PC te verminderen. Dit kan bereikt worden door de volgende regel aan <span class=filename>/boot/loader.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>kern.hz=100</pre></div></div><div class=paragraph><p>Zonder deze instelling zal een FreeBSD als gast-besturingssysteem voor Virtual PC in rust ongeveer 40% van de CPU van een computer met een enkele processor gebruiken. Na deze verandering zal het gebruik slechts rond de 3% liggen.</p></div></li><li><p>Een nieuw instellingenbestand voor de kernel aanmaken</p><div class=paragraph><p>Alle stuurprogramma’s voor SCSI, FireWire, en USB kunnen verwijderd worden. Virtual PC beidt een virtuele netwerkadapter dat door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=de&amp;sektion=4&amp;format=html">de(4)</a> gebruikt wordt, dus kunnen alle netwerkapparaten behalve <a href="https://man.freebsd.org/cgi/man.cgi?query=de&amp;sektion=4&amp;format=html">de(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=miibus&amp;sektion=4&amp;format=html">miibus(4)</a> uit de kernel verwijderd worden.</p></div></li><li><p>Het netwerk instellen</p><div class=paragraph><p>De eenvoudigste netwerkinstallatie omvat het gebruik van DHCP om de virtuele machine met het zelfde LAN te verbinden als de Microsoft® Windows®-gastheer. Dit kan bereikt worden door <code>ifconfig_de0="DHCP"</code> toe te voegen aan <span class=filename>/etc/rc.conf</span>. Geavanceerdere netwerkinstallaties staan beschreven in <a href=./#advanced-networking>Netwerken voor gevorderden</a>.</p></div></li></ol></div></div></div></div></div><div class=sect3><h4 id=virtualization-guest-vmware>22.2.3. VMware op Mac OS®<a class=anchor href=#virtualization-guest-vmware></a></h4><div class=paragraph><p>VMware Fusion voor Mac® is een comercieel softwareprodukt beschikbaar voor op Intel® gebaseeerde Mac®-computers die Mac OS® 10.4.9 of nieuwer draaien. FreeBSD is een volledig ondersteund gast-besturingssysteem. Nadat VMware Fusion is geïnstalleerd op Mac OS® X dient de gebruiker een virtuele machine in te stellen en daarna het gewenste gast-besturingssysteem te installeren.</p></div><div class=sect4><h5 id=virtualization-guest-vmware-install>22.2.3.1. FreeBSD installeren op VMware/Mac OS® X<a class=anchor href=#virtualization-guest-vmware-install></a></h5><div class=paragraph><p>De eerste stap is om VMware Fusion te laden, de Virtual Machine Library zal geladen worden. Klik op "New" om de VM aan te maken:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd01.png alt="vmware freebsd01"></div></div><div class=paragraph><p>Dit laadt de New Virtual Machine Assistant dat helpt om de VM aan te maken, klik op Continue om verder te gaan:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd02.png alt="vmware freebsd02"></div></div><div class=paragraph><p>Selecteer <span class=guimenuitem>Other</span> als het <span class=guimenuitem>Operating System</span> en <span class=guimenuitem>FreeBSD</span> of <span class=guimenuitem>FreeBSD 64-bit</span>, afhankelijk van de wens voor ondersteuning voor 64-bit, als de <span class=guimenuitem>Version</span> wanneer dat gevraagd wordt:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd03.png alt="vmware freebsd03"></div></div><div class=paragraph><p>Kies de naam van het VM-beeld en de map waarin het bewaard dient te worden:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd04.png alt="vmware freebsd04"></div></div><div class=paragraph><p>Kies de grootte van de virtuele harde schijf voor de VM:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd05.png alt="vmware freebsd05"></div></div><div class=paragraph><p>Kies de manier om de VM te installeren, van een ISO-beeld of van een CD:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd06.png alt="vmware freebsd06"></div></div><div class=paragraph><p>Nadat op Finish is geklikt, zal de VM opstarten:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd07.png alt="vmware freebsd07"></div></div><div class=paragraph><p>Installeer FreeBSD zoals gewoonlijk, of door de aanwijzingen in <a href=./#install>FreeBSD installeren op FreeBSD 8.X en eerder</a> op te volgen:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd08.png alt="vmware freebsd08"></div></div><div class=paragraph><p>Nadat de installatie voltooid is kunnen de instellingen van de VM aangepast worden, zoals het geheugengebruik:</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De instellingen van de systeemhardware van de VM kunnen niet veranderd worden zolang de VM draait.</p></div></td></tr></tbody></table></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd09.png alt="vmware freebsd09"></div></div><div class=paragraph><p>Het aantal CPU’s waartoe de VM toegang heeft:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd10.png alt="vmware freebsd10"></div></div><div class=paragraph><p>De status van het CD-ROM-apparaat. Gewoonlijk kan de CD-ROM of het ISO-beeld van de VM worden losgekoppeld wanneer het niet meer nodig is.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd11.png alt="vmware freebsd11"></div></div><div class=paragraph><p>Het laatste om te veranderen is de manier waarop de VM verbinding met het netwerk maakt. Indien verbindingen naar de VM van andere machines naast de gastheer gewenst zijn, dient <span class=guimenuitem>Connect directly to the physical network (Bridged)</span> gekozen te worden. In andere situaties is <span class=guimenuitem>Share the host’s internet connection (NAT)</span> te verkiezen, zodat de VM toegang kan hebben tot het Internet, maar dat het netwerk geen toegang heeft tot de VM.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd12.png alt="vmware freebsd12"></div></div><div class=paragraph><p>Herstart de nieuw geïnstalleerde virtuele FreeBSD-machine nadat alle instellingen zijn aangepast.</p></div></div><div class=sect4><h5 id=virtualization-guest-vmware-configure>22.2.3.2. FreeBSD instellen op Mac OS® X/VMware<a class=anchor href=#virtualization-guest-vmware-configure></a></h5><div class=paragraph><p>Nadat FreeBSD succesvol is geïnstalleerd op Mac OS® X met VMware, zijn er een aantal instellingen die gewijzigd kunnen worden op het systeem te optimaliseren voor virtueel gebruik.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>De variabelen voor de bootloader instellen</p><div class=paragraph><p>De belangrijkste stap is het verlagen van de tunable <code>kern.hz</code> om het CPU-gebruik van FreeBSD in de omgeving van VMware te verminderen. Dit kan bereikt worden door de volgende regel aan <span class=filename>/boot/loader.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>kern.hz=100</pre></div></div><div class=paragraph><p>Zonder deze instelling gebruikt FreeBSD als VMware gast-besturingssysteem ongeveer 15% van de CPU van een enkele iMac®-processor. Na deze verandering zal het gebruik dichter bij 5% liggen.</p></div></li><li><p>Een nieuw instellingenbestand voor de kernel aanmaken</p><div class=paragraph><p>Alle stuurprogramma’s voor FireWire en USB kunnen verwijderd worden. VMware biedt een virtuele netwerkadapter dat door het stuurpogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=em&amp;sektion=4&amp;format=html">em(4)</a> gebruikt wordt, dus alle netwerkapparaten behalve <a href="https://man.freebsd.org/cgi/man.cgi?query=em&amp;sektion=4&amp;format=html">em(4)</a> kunnen uit de kernel verwijderd worden.</p></div></li><li><p>Het netwerk instellen</p><div class=paragraph><p>De eenvoudigste netwerkinstallatie omvat het gebruik van DHCP om de virtuele machine met hetzelfde LAN te verbinden als de Mac®-gastheer. Dit kan bereikt worden door <code>ifconfig_em0="DHCP"</code> toe te voegen aan <span class=filename>/etc/rc.conf</span>. Geavanceerdere netwerkinstallaties staan beschreven in <a href=./#advanced-networking>Netwerken voor gevorderden</a>.</p></div></li></ol></div></div></div></div></div><div class=sect3><h4 id=virtualization-guest-virtualbox-guest-additions>22.2.4. VirtualBox™ gasttoevoegingen op een FreeBSD-gast<a class=anchor href=#virtualization-guest-virtualbox-guest-additions></a></h4><div class=paragraph><p>De gasttoevoegingen van VirtualBox™ bieden ondersteuning voor:</p></div><div class=ulist><ul><li><p>Het delen van het prikbord</p></li><li><p>Integratie van de muiscursor</p></li><li><p>Synchronisatie met de tijd van de gastheer</p></li><li><p>Het schalen van vensters</p></li><li><p>Naadloze modus</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De volgende commando’s worden gedraaid in de FreeBSD-gast.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Installeer ten eerste het pakket <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/virtualbox-ose-additions/>emulators/virtualbox-ose-additions</a> in de FreeBSD-gast.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/emulators/virtualbox-ose-additions &amp;&amp; make install clean</span></code></pre></div></div><div class=paragraph><p>Voeg deze regels toe aan <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>vboxguest_enable=&#34;YES&#34;
vboxservice_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Als <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> gebruikt, dient de synchronisatie met de tijd van de gastheer te worden uitgeschakeld:</p></div><div class="literalblock programlisting"><div class=content><pre>vboxservice_flags=&#34;--disable-timesync&#34;</pre></div></div><div class=paragraph><p>De <code>vboxvideo_drv</code> zou herkend moeten worden door <code>Xorg -configure</code>. Als dit niet zo is, dient <span class=filename>xorg.conf</span> gewijzigd te worden voor de videokaart van VirtualBox™:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;Device&#34;
	### Available Driver options are:-
	### Values: &lt;i&gt;: integer, &lt;f&gt;: float, &lt;bool&gt;: &#34;True&#34;/&#34;False&#34;,
	### &lt;string&gt;: &#34;String&#34;, &lt;freq&gt;: &#34;&lt;f&gt; Hz/kHz/MHz&#34;
	### [arg]: arg optional
	Identifier &#34;Card0&#34;
	Driver &#34;vboxvideo&#34;
	VendorName &#34;InnoTek Systemberatung GmbH&#34;
	BoardName &#34;VirtualBox Graphics Adapter&#34;
	BusID &#34;PCI:0:2:0&#34;
EndSection</pre></div></div><div class=paragraph><p>Pas het gedeelte over de muis in <span class=filename>xorg.conf</span> aan om <code>vboxmouse_drv</code> te gebruiken:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;InputDevice&#34;
	Identifier &#34;Mouse0&#34;
	Driver &#34;vboxmouse&#34;
EndSection</pre></div></div><div class=paragraph><p>Gebruikers van HAL dienen dit bestand aan te maken als <span class=filename>/usr/local/etc/hal/fdi/policy/90-vboxguest.fdi</span> of het te kopiëren van <span class=filename>/usr/local/hal/fdi/policy/10osvendor/90-vboxguest.fdi</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;!--
# Sun VirtualBox
# Hal driver description for the vboxmouse driver
# $Id$

       Copyright (C) 2008-2009 Sun Microsystems, Inc.

       This file is part of VirtualBox Open Source Edition (OSE, as
       available from http://www.virtualbox.org. This file is free software;
       you can redistribute it and/or modify it under the terms of the GNU
       General Public License (GPL) as published by the Free Software
       Foundation, in version 2 as it comes in the &#34;COPYING&#34; file of the
       VirtualBox OSE distribution. VirtualBox OSE is distributed in the
       hope that it will be useful, but WITHOUT ANY WARRANTY of any kind.

       Please contact Sun Microsystems, Inc., 4150 Network Circle, Santa
       Clara, CA 95054 USA or visit http://www.sun.com if you need
       additional information or have any questions.
--&gt;
&lt;deviceinfo version=&#34;0.2&#34;&gt;
  &lt;device&gt;
    &lt;match key=&#34;info.subsystem&#34; string=&#34;pci&#34;&gt;
      &lt;match key=&#34;info.product&#34; string=&#34;VirtualBox guest Service&#34;&gt;
	&lt;append key=&#34;info.capabilities&#34; type=&#34;strlist&#34;&gt;input&lt;/append&gt;
	&lt;append key=&#34;info.capabilities&#34; type=&#34;strlist&#34;&gt;input.mouse&lt;/append&gt;
	&lt;merge key=&#34;input.x11_driver&#34; type=&#34;string&#34;&gt;vboxmouse&lt;/merge&gt;
	&lt;merge key=&#34;input.device&#34; type=&#34;string&#34;&gt;/dev/vboxguest&lt;/merge&gt;
      &lt;/match&gt;
    &lt;/match&gt;
  &lt;/device&gt;
&lt;/deviceinfo&gt;</pre></div></div></div></div><div class=sect2><h3 id=virtualization-host>22.3. FreeBSD als een gastheer-besturingssysteem<a class=anchor href=#virtualization-host></a></h3><div class=paragraph><p>Voor een aantal jaren werd FreeBSD niet officieel ondersteund als een gastheer-besturingssysteem door de beschikbare virtualisatiepakketten. Sommige mensen gebruikten oudere en meestal overbodige versies van VMware (zoals <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/vmware3/>emulators/vmware3</a>), die gebruik maakten van de Linux® binaire compatibiliteitslaag. Kort na de uitgave van FreeBSD 7.2 verscheen Suns VirtualBox™ in de Ports; Collectie als een programma dat voor FreeBSD zelf bedoeld is.</p></div><div class=paragraph><p>VirtualBox™ is een actief ontwikkeld en compleet virtualisatiepakket dat beschikbaar is voor de meeste besturingssystemen waaronder Windows®, Mac OS®, Linux® en FreeBSD. Het kan evengoed Windows® of UNIX® als gast draaien. Het is gerealiseerd als een open-source pakket met gesloten-source componenten beschikbaar in een apart uitbreidingspakket. Deze componenten bevatten onder andere ondersteuning voor USB-2.0-apparaten. Meer informatie kan gevonden worden op de pagina "Downloads" van de VirtualBox™-wiki op <a href=http://www.virtualbox.org/wiki/Downloads>http://www.virtualbox.org/wiki/Downloads</a>. Momenteel zijn deze uitbreidingen niet beschikbaar voor FreeBSD.</p></div><div class=sect3><h4 id=virtualization-virtualbox-install>22.3.1. VirtualBox™ installeren<a class=anchor href=#virtualization-virtualbox-install></a></h4><div class=paragraph><p>VirtualBox™ is beschikbaar als een FreeBSD-port in <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/virtualbox-ose/>emulators/virtualbox-ose</a>. Zorg ervoor, aangezien VirtualBox™ erg actief ontwikkeld wordt, dat uw ports bijgewerkt is voordat u met de installatie begint. Installeer het met deze commando’s:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/emulators/virtualbox-ose</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Een nuttige optie in het configuratiescherm is de verzameling <code>GuestAdditions</code> programma’s. Deze bieden een aantal nuttige mogelijkheden in gastbesturingssystemen, zoals integratie van de muiscursor (wat het mogelijk maakt om de muis te delen tussen de gast en de gastheer zonder dat er een speciale toetsencombinatie hoeft te worden gebruikt voor het omwisselen) en snellere video-rendering, met name in Windows®-gasten. De gastaanvullingen zijn beschikbaar in het menu <b class=menuref>Devices</b>, nadat de installatie van het gastbesturingssysteem is voltooid.</p></div><div class=paragraph><p>Er zijn enkele aanpassingen aan de instellingen nodig voordat VirtualBox™ voor het eerst wordt gestart. De port installeert een kernelmodule in <span class=filename>/boot/modules</span> welke in de draaiende kernel geladen moet worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload vboxdrv</span></code></pre></div></div><div class=paragraph><p>Voeg de volgende regel toe aan <span class=filename>/boot/loader.conf</span> om er zeker van te zijn dat de module altijd na een herstart wordt geladen:</p></div><div class="literalblock programlisting"><div class=content><pre>vboxdrv_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Voeg het volgende aan <span class=filename>/etc/rc.conf</span> toe en herstart de computer om de kernelmodules te gebruiken die in gebridgede of gastheer-only netwerken voorzien:</p></div><div class="literalblock programlisting"><div class=content><pre>vboxnet_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>De groep <code>vboxusers</code> wordt tijdens de installatie van VirtualBox™ aangemaakt. Alle gebruikers die toegang tot VirtualBox™ nodig hebben moeten als lid van deze groep worden toegevoegd. Met het commando <code>pw</code> kunnen nieuwe leden worden toegevoegd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod vboxusers -m uwgebruikersnaam</span></code></pre></div></div><div class=paragraph><p>De standaardpermissies voor <span class=filename>/dev/vboxnetctl</span> zijn restrictief en moeten veranderd worden voor gebridged netwerken.</p></div><div class=paragraph><p>Om het tijdelijk te testen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chown root:vboxusers /dev/vboxnetctl</span>
<span class=c># chmod 0660 /dev/vboxnetctl</span></code></pre></div></div><div class=paragraph><p>Voeg deze regels toe aan <span class=filename>/etc/devfs.conf</span> om de permissiewijziging permanent te maken:</p></div><div class="literalblock programlisting"><div class=content><pre>own	vboxnetctl root:vboxusers
perm	vboxnetctl 0660</pre></div></div><div class=paragraph><p>Gebruik de optie <span class=guimenuitem>Sun VirtualBox</span> van het menu van de grafische omgeving of typ het volgende in een terminal om VirtualBox™ te starten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% VirtualBox</code></pre></div></div><div class=paragraph><p>Bezoek de officiële website op <a href=http://www.virtualbox.org>http://www.virtualbox.org</a> voor meer informatie over het configureren en gebruiken van VirtualBox™. Aangezien de FreeBSD-port erg nieuw is, wordt het nog volop ontwikkeld. Kijk voor de laatste informatie en instructies om problemen op te lossen op de relevantie pagina in de FreeBSD-wiki op <a href=http://wiki.FreeBSD.org/VirtualBox>http://wiki.FreeBSD.org/VirtualBox</a>.</p></div></div><div class=sect3><h4 id=virtualization-virtualbox-usb-suport>22.3.2. USB-ondersteuning in VirtualBox™<a class=anchor href=#virtualization-virtualbox-usb-suport></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voor deze stappen is VirtualBox 4.0.0 of nieuwer nodig.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om van UBS-apparaten te kunnen lezen en ernaar te kunnen schrijven dienen gebruikers lid te zijn van de groep operator:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod operator -m jerry</span></code></pre></div></div><div class=paragraph><p>Voeg vervolgens het volgende toe aan <span class=filename>/etc/devfs.rules</span> (maak het aan als het nog niet bestaat):</p></div><div class="literalblock programlisting"><div class=content><pre>[system=10]
add path &#39;usb/*&#39; mode 0660 group operator</pre></div></div><div class=paragraph><p>Voeg het volgende aan toe aan <span class=filename>/etc/rc.conf</span> om deze nieuwe regels te laden:</p></div><div class="literalblock programlisting"><div class=content><pre>devfs_system_ruleset=&#34;system</pre></div></div><div class=paragraph><p>Herstart vervolgens devfs:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service devfs restart</span></code></pre></div></div><div class=paragraph><p>USB kan nu in het gast-besturingssysteem worden aangezet. USB-apparaten zouden zichtbaar moeten zijn in de voorkeuren van VirtualBox™.</p></div></div><div class=sect3><h4 id=virtualization-virtualbox-host-dvd-cd-access>22.3.3. DVD/CD-toegang van de gastheer in VirtualBox™<a class=anchor href=#virtualization-virtualbox-host-dvd-cd-access></a></h4><div class=paragraph><p>Toegang tot de CD/DVD-stations van de gastheer wordt bereikt door het delen van de fysieke stations. In de GUI kan dit vanuit het scherm Opslag in de Instellingen van de virtuele machine worden ingesteld. Maak eerst een leeg IDE CD-/DVD-apparaat aan. Kies daarna het Gastheerstation van het popup-menu voor het kiezen van het virtuele CD-/DVD-station. Later zal er een checkbox genaamd <code>Passthrough</code> verschijnen. Dit stelt de virtuele machine in staat om de hardware direct te gebruiken. Audio-CDs en branders bijvoorbeeld werken alleen als deze optie is aangezet.</p></div><div class=paragraph><p>HAL moet draaien om de DVD/CD-functies van VirtualBox™ te laten werken, zet het dus aan in <span class=filename>/etc/rc.conf</span> en start het (als het niet reeds draait):</p></div><div class="literalblock programlisting"><div class=content><pre>hald_enable=&#34;YES&#34;</pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service hald start</span></code></pre></div></div><div class=paragraph><p>Om gebruikers de DVD/CD-functionaliteit van VirtualBox™ te laten gebruiken, dienen ze toegang te hebben tot <span class=filename>/dev/xpt0</span>, <span class=filename>/dev/cdN</span> en <span class=filename>/dev/passN</span>. Dit wordt normaliter gedaan door de gebruiker van VirtualBox™ lid te maken van de groep operator, wat ook de standaardgroep is voor bovengenoemde apparaten. De rechten van deze apparaten dienen gecorrigeerd te worden door de volgende regels aan <span class=filename>/etc/devfs.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>perm cd* 0600
perm xpt0 0660
perm pass* 0660</pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service devfs restart</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=l10n>Hoofdstuk 23. Lokalisatie - I18N/L10N gebruiken en instellen<a class=anchor href=#l10n></a></h2><div class=sectionbody><div class=sect2><h3 id=l10n-synopsis>23.1. Overzicht<a class=anchor href=#l10n-synopsis></a></h3><div class=paragraph><p>FreeBSD is een zeer gedistribueerd project met gebruikers over de gehele wereld. Dit hoofdstuk behandelt de internationalisatie- en lokalisatie-eigenschappen van FreeBSD die niet-Engelssprekende gebruikers echt werk laten verzetten. Er zitten veel aspecten van de i18n-implementatie in zowel de systeem- als applicatieniveaus, dus waar mogelijk wordt de lezer verwezen naar meer specifieke bronnen.</p></div><div class=paragraph><p>Na dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe verschillende talen en locales gecodeerd zijn op moderne besturingssystemen.</p></li><li><p>Hoe de locale in te stellen voor een login-shell.</p></li><li><p>Hoe de console voor niet-Engelse talen in te stellen.</p></li><li><p>Hoe het X Window systeem effectief met meerdere talen te gebruiken.</p></li><li><p>Waar meer informatie te vinden over het schrijven van i18n-respecterende applicaties.</p></li></ul></div><div class=paragraph><p>Veronderstelde voorkennis:</p></div><div class=ulist><ul><li><p>Weten hoe aanvullende applicaties van derde partijen geïnstalleerd worden (<a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></li></ul></div></div><div class=sect2><h3 id=l10n-basics>23.2. Beginselen<a class=anchor href=#l10n-basics></a></h3><div class=sect3><h4 id=_wat_is_i18nl10n>23.2.1. Wat is I18N/L10N?<a class=anchor href=#_wat_is_i18nl10n></a></h4><div class=paragraph><p>Ontwikkelaars hebben internationalisatie ("internationalization" afgekort tot de term I18N, de eerste en de laatste letter en het aantal tussenliggende letters. L10N gebruikt hetzelfde schema voor naamgeving en komt van "localization". Samen staan I18N/L10N methoden, protocollen en applicaties gebruikers toe de taal van hun keuze te gebruiken.</p></div><div class=paragraph><p>I18N-applicaties zijn geprogrammeerd door gebruik te maken van I18N-gereedschappen van bibliotheken. Daarmee kunnen ontwikkelaars een eenvoudig bestand schrijven en menu’s en teksten weergeven in elke taal. Programmeurs worden door het FreeBSD Project sterk aangemoedigd deze conventie te volgen.</p></div></div><div class=sect3><h4 id=_waarom_i18nl10n_gebruiken>23.2.2. Waarom I18N/L10N gebruiken?<a class=anchor href=#_waarom_i18nl10n_gebruiken></a></h4><div class=paragraph><p>I18N/L10N wordt gebruikt als een gebruiker gegevens wil bekijken, invoeren of verwerken in niet-Engelse talen.</p></div></div><div class=sect3><h4 id=_welke_talen_worden_ondersteund_door_i18n>23.2.3. Welke talen worden ondersteund door I18N?<a class=anchor href=#_welke_talen_worden_ondersteund_door_i18n></a></h4><div class=paragraph><p>I18N en L10N zijn niet FreeBSD specifiek. Momenteel kan er gekozen worden uit de meeste grote wereldtalen, inclusief maar niet beperkt tot: Chinees, Duits, Japans, Koreaans, Frans, Russisch en Vietnamees.</p></div></div></div><div class=sect2><h3 id=using-localization>23.3. Lokalisatie gebruiken<a class=anchor href=#using-localization></a></h3><div class=paragraph><p>In al zijn pracht is I18N niet FreeBSD specifiek maar een conventie. Het FreeBSD Project moedigt iedereen aan FreeBSD te helpen deze conventie te gebruiken.</p></div><div class=paragraph><p>Lokalisatie-instellingen zijn gebaseerd op drie hoofdtermen: Taalcode, Landcode en Codering. Localenamen zijn als volgt opgebouwd:</p></div><div class="literalblock programlisting"><div class=content><pre>Taalcode_Landcode.Codering</pre></div></div><div class=sect3><h4 id=_taal_en_landcodes>23.3.1. Taal- en landcodes<a class=anchor href=#_taal_en_landcodes></a></h4><div class=paragraph><p>Om een FreeBSD-systeem (of een ander I18N-ondersteunend UNIX® achtig systeem) te lokaliseren naar een bepaalde taal, moet de gebruiker de codes voor het specifieke land en taal achterhalen. Landcodes geven applicaties aan welke variatie van de gegeven taal gebruikt moet worden. Ook webbrowsers, SMTP/POP-servers, webservers, enzovoorts maken beslissingen gebaseerd op die codes. Hieronder staan voorbeelden van taal- en landcodes:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Taal- en landcode</th><th class="tableblock halign-left valign-top">Omschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>en_US</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Engels - Verenigde Staten</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ru_RU</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Russisch voor Rusland</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>zh_TW</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Traditioneel Chinees voor Taiwan</p></td></tr></tbody></table><div class=paragraph><p>Een complete lijst van beschikbare locales is beschikbaar via:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% locale <span class=nt>-a</span></code></pre></div></div></div><div class=sect3><h4 id=_coderingen>23.3.2. Coderingen<a class=anchor href=#_coderingen></a></h4><div class=paragraph><p>Sommige talen gebruiken andere ASCII-coderingen dan 8-bit, wijde of multibyte karakters, zie <a href="https://man.freebsd.org/cgi/man.cgi?query=multibyte&amp;sektion=3&amp;format=html">multibyte(3)</a>. Oudere programma’s herkennen die niet en interpreteren ze foutief als controlekarakters aan. Afhankelijk van de implementatie moeten gebruikers eventueel een applicatie met wijde of multibyte karakterondersteuning compileren, of hem correct instellen. Om wijde of multibyte karakters in te kunnen voeren en te kunnen verwerken levert de <a href=https://www.FreeBSD.org/ports/>FreeBSD Portscollectie</a> voor elke taal programma’s. Hiervoor staat I18N-documentatie in de respectievelijke FreeBSD Port.</p></div><div class=paragraph><p>Voor het bouwen van een gewenste applicatie met lokalisatie is het verstandig de applicatiedocumentatie te bekijken om te bepalen hoe de juiste waarden doorgegeven kunnen worden naar configure, Makefile of de compiler.</p></div><div class=paragraph><p>Houd rekening met:</p></div><div class=ulist><ul><li><p>Taalspecifieke enkele C-karakters karakterverzamelingen (zie <a href="https://man.freebsd.org/cgi/man.cgi?query=multibyte&amp;sektion=3&amp;format=html">multibyte(3)</a>), bijvoorbeeld ISO8859-1, ISO-8859-15, KOI8-R of CP437.</p></li><li><p>Wijde of multibyte coderingen, bijvoorbeeld EUC of Big5.</p></li></ul></div><div class=paragraph><p>Een lijst met actieve karakterverzamelingen staat bij de <a href=http://www.iana.org/assignments/character-sets>IANA Registry</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>FreeBSD gebruikt in plaats hiervan X11-compatible locale-coderingen.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_i18n_applicaties>23.3.3. I18N applicaties<a class=anchor href=#_i18n_applicaties></a></h4><div class=paragraph><p>In het FreeBSD Ports en Package systeem hebben I18N-applicaties <code>I18N</code> in hun naam zodat ze eenvoudig herkend kunnen worden. Toch ondersteunen ze niet altijd iedere mogelijk gewenste taal.</p></div></div><div class=sect3><h4 id=setting-locale>23.3.4. Locale instellen<a class=anchor href=#setting-locale></a></h4><div class=paragraph><p>Meestal is het voldoende om de waarde van de localenaam te exporteren als <code>LANG</code> in de login-shell. Dit kan door die waarde in <span class=filename>~/.login_conf</span> van de gebruiker of in <span class=filename>~/.profile</span>, <span class=filename>~/.bashrc</span> of <span class=filename>~/.cshrc</span>) van de gebruiker te zetten. Het is niet nodig om localedeelverzamelingen als <code>LC_CTYPE</code> of <code>LC_CTIME</code> in te stellen. Bij de taalspecifieke FreeBSD documentatie staat vaak nog informatie.</p></div><div class=paragraph><p>De twee volgende omgevingsvariabelen moeten in de instellingenbestanden ingesteld worden:</p></div><div class=ulist><ul><li><p><code>LANG</code> voor de POSIX® <a href="https://man.freebsd.org/cgi/man.cgi?query=setlocale&amp;sektion=3&amp;format=html">setlocale(3)</a> functies.</p></li><li><p><code>MM_CHARSET</code> voor de MIME karakters voor applicaties.</p></li></ul></div><div class=paragraph><p>Dit is inclusief het instellen van de gebruikers-shell, het instellen van de specifieke applicatie en de instellingen voor X11.</p></div><div class=sect4><h5 id=_methoden_om_locale_in_te_stellen>23.3.4.1. Methoden om locale in te stellen<a class=anchor href=#_methoden_om_locale_in_te_stellen></a></h5><div class=paragraph><p>Er zijn twee methoden om de locale in te stellen en beiden worden hieronder beschreven. De eerste (aanbevolen) methode is door middel van het toekennen van omgevingsvariabelen in de <a href=#login-class>loginklasse</a> en de tweede is mogelijk door middel van het toevoegen van de omgevingsvariabelen aan het <a href=#startup-file>opstartbestand</a> van de systeem-shell.</p></div><div class=sect5><h6 id=login-class>23.3.4.1.1. Methode loginklasse<a class=anchor href=#login-class></a></h6><div class=paragraph><p>Deze methode biedt de mogelijkheid om omgevingsvariabelen die nodig zijn voor de localenaam en MIME karakterverzamelingen éénmalig voor elke mogelijke shell toe te kennen in plaats van door toekenning via het opstartbestand van elke shell. <a href=#usr-setup>Gebruikersinstellingen</a> kunnen door de gebruiker zelf worden gemaakt en voor <a href=#adm-setup>Beheerdersinstellingen</a> zijn superuser-rechten nodig.</p></div><div class=sect6><h7 id=usr-setup>23.3.4.1.1.1. Gebruikersinstellingen<a class=anchor href=#usr-setup></a></h7><div class=paragraph><p>Hieronder staat een minimaal voorbeeld van een <span class=filename>.login_conf</span> bestand in de thuismap van een gebruiker die beide variabelen heeft ingesteld op Latin-1 codering:</p></div><div class="literalblock programlisting"><div class=content><pre>me:\
  :charset=ISO-8859-1:\
  :lang=de_DE.ISO8859-1:</pre></div></div><div class=paragraph><p>Hieronder staat is een voorbeeld van een <span class=filename>.login_conf</span> die variabelen instelt voor traditioneel Chinees in BIG-5 codering. Er zijn veel andere variabelen ingesteld zijn omdat sommige software localevariabelen niet correct respecteert voor Chinees, Japans, en Koreaans.</p></div><div class="literalblock programlisting"><div class=content><pre># Gebruikers die geen valuta eenheden of tijdformaten voor Taiwan
# willen gebruiken kunnen handmatig elke variabele wijzigen.
me:\
  :lang=zh_TW.Big5:\
  :setenv=LC_ALL=zh_TW.Big5:\
  :setenv=LC_COLLATE=zh_TW.Big5:\
  :setenv=LC_CTYPE=zh_TW.Big5:\
  :setenv=LC_MESSAGES=zh_TW.Big5:\
  :setenv=LC_MONETARY=zh_TW.Big5:\
  :setenv=LC_NUMERIC=zh_TW.Big5:\
  :setenv=LC_TIME=zh_TW.Big5:\
  :charset=big5:\
  :xmodifiers=&#34;@im=gcin&#34;: # Stel gcin in als XIM invoerserver</pre></div></div><div class=paragraph><p>Zie <a href=#adm-setup>Beheerdersinstellingen</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a> voor meer details.</p></div></div></div><div class=sect5><h6 id=adm-setup>23.3.4.1.2. Beheerdersinstellingen<a class=anchor href=#adm-setup></a></h6><div class=paragraph><p>Er dient gecontroleerd te worden of loginklasse voor gebruikers, <span class=filename>/etc/login.conf</span>, de juiste taal instelt door de volgende instellingen in <span class=filename>/etc/login.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>taalnaam|accountstitel:\
  :charset=MIME_karakterverzameling:
  :lang=localenaam:\
  :tc=default:</pre></div></div><div class=paragraph><p>Voor het bovenstaande voorbeeld dat gebruik maakt van Latin-1 ziet dat er als hieronder uit:</p></div><div class="literalblock programlisting"><div class=content><pre>german|Duitse gebruikersaccounts:\
  :charset=ISO-8859-1:\
  :lang=de_DE.ISO8859-1:\
  :tc=default:</pre></div></div><div class=paragraph><p>Voer voordat de gebruikers login class wordt gewijzigd het volgende uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div><div class=paragraph><p>om de nieuwe configuratie in <span class=filename>/etc/login.conf</span> zichtbaar te maken voor het systeem.</p></div></div><div class=sect5><h6 id=_loginklasse_wijzigen_met_vipw8>23.3.4.1.3. Loginklasse wijzigen met <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a><a class=anchor href=#_loginklasse_wijzigen_met_vipw8></a></h6><div class=paragraph><p>Met <code>vipw</code> kunnen nieuwe gebruikers toegevoegd worden en de instellingen dienen ongeveer als volgt uit te zien:</p></div><div class="literalblock programlisting"><div class=content><pre>gebruiker:wachtwoord:1111:11:taal:0:0:Gebruikersnaam:/home/gebruiker:/bin/sh</pre></div></div></div><div class=sect5><h6 id=_loginklasse_wijzigen_met_adduser8>23.3.4.1.4. Loginklasse wijzigen met <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a><a class=anchor href=#_loginklasse_wijzigen_met_adduser8></a></h6><div class=paragraph><p>Met <code>adduser</code> kunnen nieuwe gebruikers toegevoegd worden. Hierna dient één van de volgende stappen uitgevoerd te worden:</p></div><div class=ulist><ul><li><p><code>defaultclass = taal</code> instellen in <span class=filename>/etc/adduser.conf</span>. In dit geval dient er voor alle gebruikers van andere talen een <code>default</code> klasse ingevoerd te worden.</p></li><li><p>Er kan ook gekozen worden voor een antwoord op de vraag over taal vanuit <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Enter login class: default <span class=o>[]</span>:</code></pre></div></div></li><li><p>Ook kan het volgende gebruikt worden voor elke gebruiker die een andere taal gebruikt:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># adduser -class taal</span></code></pre></div></div></li></ul></div></div><div class=sect5><h6 id=_loginklasse_wijzigen_met_pw8>23.3.4.1.5. Loginklasse wijzigen met <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a><a class=anchor href=#_loginklasse_wijzigen_met_pw8></a></h6><div class=paragraph><p>Als <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> wordt gebruikt om nieuwe gebruikers toe te voegen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw useradd gebruikersnaam -L taal</span></code></pre></div></div></div><div class=sect5><h6 id=startup-file>23.3.4.1.6. Methode opstartbestand shell<a class=anchor href=#startup-file></a></h6><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Deze methode wordt niet aanbevolen omdat er instellingenen nodig zijn voor elke mogelijke shell. Het advies is de <a href=#login-class>Methode Loginklasse</a> te gebruiken.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om de localenaam en MIME karakterverzameling toe te voegen kunnen gewoon twee omgevingsvariabelen ingesteld worden, zoals hieronder te zien is, in <span class=filename>/etc/profile</span> en/of <span class=filename>/etc/csh.login</span> opstartbestanden voor shells. Hier wordt de Duitse taal als voorbeeld gebruikt:</p></div><div class=paragraph><p>In <span class=filename>/etc/profile</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>LANG=de_DE.ISO8859-1; export LANG
MM_CHARSET=ISO-8859-1; export MM_CHARSET</pre></div></div><div class=paragraph><p>Of in <span class=filename>/etc/csh.login</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>setenv LANG de_DE.ISO8859-1
setenv MM_CHARSET ISO-8859-1</pre></div></div><div class=paragraph><p>Het is ook mogelijk de bovenstaande instructies toe te toevoegen <span class=filename>/usr/shared/skel/dot.profile</span> (ongeveer gelijk aan wat hierboven in <span class=filename>/etc/profile</span> is gebruikt) of aan <span class=filename>/usr/shared/skel/dot.login</span> (ongeveer gelijk aan wat hierboven in <span class=filename>/etc/csh.login</span> is gebruikt).</p></div><div class=paragraph><p>Voor X11:</p></div><div class=paragraph><p>In <span class=filename>$HOME/.xinitrc</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>LANG=de_DE.ISO8859-1; export LANG</pre></div></div><div class=paragraph><p>Of:</p></div><div class="literalblock programlisting"><div class=content><pre>setenv LANG de_DE.ISO8859-1</pre></div></div><div class=paragraph><p>Afhankelijk van de shell (zie boven).</p></div></div></div></div><div class=sect3><h4 id=setting-console>23.3.5. Console instellen<a class=anchor href=#setting-console></a></h4><div class=paragraph><p>Voor alle enkele C-karakters karakterverzamelingen worden de juiste lettertypen voor het console ingesteld in <span class=filename>/etc/rc.conf</span> voor de taal in kwestie met:</p></div><div class="literalblock programlisting"><div class=content><pre>font8x16=lettertypenaam
font8x14=fontnaam
font8x8=fontnaam</pre></div></div><div class=paragraph><p>De <em>lettertypenaam</em> komt uit de map <span class=filename>/usr/shared/syscons/fonts</span> zonder het achtervoegsel <span class=filename>.fnt</span>.</p></div><div class=paragraph><p>De gebruiker dient ervoor te zorgen dat indien nodig de juiste enkele C-karakters karakterverzameling wordt ingesteld met <span class=filename>/stand/sysinstall</span>. In sysinstall kan <span class=guimenuitem>Configure</span> en <span class=guimenuitem>Console</span> gekozen worden. Het is ook mogelijk het volgende aan <span class=filename>/etc/rc.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>scrnmap=schermmappingnaam
keymap=toetsenmappingnaam
keychange=&#34;fkey_nummer sequentie&#34;</pre></div></div><div class=paragraph><p><em>schermmappingnaam</em> komt uit de map <span class=filename>/usr/shared/syscons/scrnmaps</span> zonder het achtervoegsel <span class=filename>.scm</span>. Meestal is een schermmapping met een overeenkomstig gemapt lettertype nodig als workaround om bit 8 naar bit 9 uit te breiden op een lettertype-karaktermatrix van een VGA-adapter in pseudografische gebieden, dat wil zeggen om letters uit dat gebied te halen als het schermlettertype een bit 8 kolom gebruikt.</p></div><div class=paragraph><p>Als de moused daemon is ingeschakeld met de onderstaande regel in <span class=filename>/etc/rc.conf</span>, dan wordt aangeraden de muiscursorinformatie in de volgende paragraaf te bekijken.</p></div><div class="literalblock programlisting"><div class=content><pre>moused_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Standaard neemt de muiscursor van het <a href="https://man.freebsd.org/cgi/man.cgi?query=syscons&amp;sektion=4&amp;format=html">syscons(4)</a> stuurprogramma het bereik 0xd0-0xd3 van de tekenverzameling in beslag. Als een ingestelde taal dit bereik gebruikt, moet het cursorbereik hierbuiten gehaald worden. Om de workaround voor FreeBSD aan te zetten kan de volgende regel aan <span class=filename>/etc/rc.conf</span> toegevoegd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>mousechar_start=3</pre></div></div><div class=paragraph><p>De <em>toetsenmappingnaam</em> komt uit de map <span class=filename>/usr/shared/syscons/keymaps</span> zonder het achtervoegsel <span class=filename>.kbd</span>. Als niet precies duidelijk is welke toetsenmapping te gebruiken, kan de toetsenmapping getest worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=kbdmap&amp;sektion=1&amp;format=html">kbdmap(1)</a> zonder opnieuw op te starten.</p></div><div class=paragraph><p><code>keychange</code> is nodig om functietoetsen zo te programmeren dat ze overeenkomen met het geselecteerde terminaltype omdat functietoetssequenties niet in de toetsenmapping gedefinieerd kunnen worden.</p></div><div class=paragraph><p>Er dient ook een controle te zijn op een juiste instelling van het juiste terminaltype voor het console in <span class=filename>/etc/ttys</span> voor alle <code>ttyv*</code> regels. De huidige instellingen zijn:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Karakterverzameling</th><th class="tableblock halign-left valign-top">Terminaltype</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ISO8859-1 of ISO-8859-15</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25l1</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ISO8859-2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25l2</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ISO8859-7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25l7</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KOI8-R</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25r</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KOI8-U</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25u</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CP437 (VGA standaardinstelling)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>US-ASCII</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25w</code></p></td></tr></tbody></table><div class=paragraph><p>Voor wijde of multibyte karaktertalen kan je juiste FreeBSD port in de map <span class=filename>/usr/ports/taal</span> gebruikt worden. Sommige ports verschijnen als console terwijl het systeem ze als serieële vtty ziet. Er dienen dus voldoende vtty’s gereserveerd te zijn voor zowel X11 als de pseudo-serieële console. Hier is een gedeeltelijke lijst van applicaties voor het gebruik van andere talen in console:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Taal</th><th class="tableblock halign-left valign-top">Locatie</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>traditioneel Chinees (BIG-5)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/chinese/big5con/>chinese/big5con</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Japans</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/japanese/kon2-16dot/>japanese/kon2-16dot</a> of <a class=package href=https://cgit.freebsd.org/ports/tree/japanese/mule-freewnn/>japanese/mule-freewnn</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Koreaans</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/korean/han/>korean/han</a></p></td></tr></tbody></table></div><div class=sect3><h4 id=_x11_instellen_2>23.3.6. X11 instellen<a class=anchor href=#_x11_instellen_2></a></h4><div class=paragraph><p>Hoewel X11 geen deel is van het FreeBSD Project wordt het hier wel besproken voor FreeBSD gebruikers. Meer details zijn te vinden op de <a href=http://www.x.org/>Xorg website</a> of op de website van een andere X11 server die gebruikt wordt.</p></div><div class=paragraph><p>In <span class=filename>~/.Xresources</span> kunnen applicatiespecifieke I18N instellingen gemaakt worden als lettertypen, menu’s, enzovoort.</p></div><div class=sect4><h5 id=_lettertypen_weergeven>23.3.6.1. Lettertypen weergeven<a class=anchor href=#_lettertypen_weergeven></a></h5><div class=paragraph><p>Eerst moet Xorg server (<a class=package href=https://cgit.freebsd.org/ports/tree/x11-servers/xorg-server/>x11-servers/xorg-server</a>), geïnstalleerd worden en daarna de TrueType® lettertypen van de taal. Door de gewenste locale in te stellen worden de menu’s en dergelijke in de gekozen taal weergegeven.</p></div></div><div class=sect4><h5 id=_niet_engelse_karakters_invoeren>23.3.6.2. Niet-Engelse karakters invoeren<a class=anchor href=#_niet_engelse_karakters_invoeren></a></h5><div class=paragraph><p>Het X11 Input Method (XIM) protocol is een nieuwe standaard voor alle X11-cliënts. Alle X11-applicaties horen geschreven te worden als XIM-cliënts die invoer aannemen van de XIM-invoerservers. Er zijn meerdere XIM-servers beschikbaar voor verschillende talen.</p></div></div></div><div class=sect3><h4 id=_printerinstellingen>23.3.7. Printerinstellingen<a class=anchor href=#_printerinstellingen></a></h4><div class=paragraph><p>Sommige enkele C-karakters karakterverzamelingen zijn standaard hardware-gecodeerd in printers. Voor wijde of multibyte karakterverzamelingen is een speciale installatie nodig en het gebruik van apsfilter wordt dan aangeraden. Een document kan ook naar PostScript® of PDF formaat omgezet worden door gebruik te maken van taalspecifieke conversieprogramma’s.</p></div></div><div class=sect3><h4 id=_kernel_en_bestandssystemen>23.3.8. Kernel en bestandssystemen<a class=anchor href=#_kernel_en_bestandssystemen></a></h4><div class=paragraph><p>Het FreeBSD Snelle Bestandssysteem (FFS) is 8-bit schoon, dus het kan gebruikt worden met elke enkele C-karakters karakterverzameling (zie <a href="https://man.freebsd.org/cgi/man.cgi?query=multibyte&amp;sektion=3&amp;format=html">multibyte(3)</a>), maar er is geen karakterverzamelingnaam opgeslagen in het bestandssysteem. Het is dus rauw 8-bit en het weet niets van coderingsbevelen. Officieel ondersteunt FFS nog geen enkele vorm van wijde of multibyte karakterverzamelingen. Toch hebben sommige wijde of multibyte karakterverzamelingen onafhankelijke patches voor FFS die ondersteuning inschakelen. Dit zijn tijdelijke oplossingen of hacks die niet overdraagbaar zijn en daarom is besloten ze niet in de source tree op te nemen. Op de websites van de talen staan de patchbestanden en meer informatie.</p></div><div class=paragraph><p>Voor het FreeBSD MS-DOS® bestandssysteem kan geschakeld worden tussen MS-DOS®, Unicode karakterverzamelingen en gekozen FreeBSD bestandssysteem-karakterverzamelingen. <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> beschijft de details.</p></div></div></div><div class=sect2><h3 id=l10n-compiling>23.4. I18N-programma’s compileren<a class=anchor href=#l10n-compiling></a></h3><div class=paragraph><p>Veel FreeBSD Ports zijn geschikt gemaakt voor FreeBSD met I18N-ondersteuning. Een aantal daarvan zijn gemarkeerd met "-I18N" in de portnaam. Deze en nog veel andere programma’s hebben ingebouwde ondersteuning voor I18N en behoeven geen speciale aandacht.</p></div><div class=paragraph><p>Toch is het voor sommige applicaties zoals MySQL nodig dat de <span class=filename>Makefile</span> ingesteld is met de specifieke karakterverzameling. Dit wordt normaliter gedaan in de <span class=filename>Makefile</span> of door middel van het doorgeven van een waarde aan configure in de broncode.</p></div></div><div class=sect2><h3 id=lang-setup>23.5. FreeBSD lokaliseren naar talen<a class=anchor href=#lang-setup></a></h3><div class=sect3><h4 id=ru-localize>23.5.1. Russisch (KOI8-R codering)<a class=anchor href=#ru-localize></a></h4><div class=paragraph><p>Voor meer informatie over KOI8-R codering, zie de <a href=http://koi8.pp.ru/>KOI8-R References (Russian Net Character Set)</a>.</p></div><div class=sect4><h5 id=_locale_instellen>23.5.1.1. Locale instellen<a class=anchor href=#_locale_instellen></a></h5><div class=paragraph><p>Voeg de volgende regels toe aan <span class=filename>~/.login_conf</span> bestand:</p></div><div class="literalblock programlisting"><div class=content><pre>me:Mijn account:\
  :charset=KOI8-R:\
  :lang=ru_RU.KOI8-R:</pre></div></div><div class=paragraph><p>Zie eerder in dit hoofdstuk voor voorbeelden over het opzetten van de <a href=#setting-locale>locale</a>.</p></div></div><div class=sect4><h5 id=_console_instellen>23.5.1.2. Console instellen<a class=anchor href=#_console_instellen></a></h5><div class=ulist><ul><li><p>Voeg de volgende regel toe aan <span class=filename>/etc/rc.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>mousechar_start=3</pre></div></div></li><li><p>Gebruik ook de volgende instellingen in <span class=filename>/etc/rc.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>keymap=&#34;ru.utf-8&#34;
scrnmap=&#34;utf-82cp866&#34;
font8x16=&#34;cp866b-8x16&#34;
font8x14=&#34;cp866-8x14&#34;
font8x8=&#34;cp866-8x8&#34;</pre></div></div></li><li><p>Voor elke <code>ttyv*</code> regel in <span class=filename>/etc/ttys</span>, gebruik <code>cons25r</code> als het terminaltype.</p></li></ul></div><div class=paragraph><p>Zie eerder in dit hoofdstuk voor voorbeelden over het opzetten van de <a href=#setting-console>console</a>.</p></div></div><div class=sect4><h5 id=_printer_instellen>23.5.1.3. Printer instellen<a class=anchor href=#_printer_instellen></a></h5><div class=paragraph><p>Aangezien de meeste printers met Russische karakters met hardware-codepagina CP866 komen, is een speciaal uitvoerfilter nodig om KOI8-R om te zetten in CP866. Zo’n filter is standaard geïnstalleerd als <span class=filename>/usr/libexec/lpr/ru/koi2alt</span>. Een <span class=filename>/etc/printcap</span> regel voor een Russische printer moet er uit zien als:</p></div><div class="literalblock programlisting"><div class=content><pre>lp|Russische lokale lijnprinter:\
  :sh:of=/usr/libexec/lpr/ru/koi2alt:\
  :lp=/dev/lpt0:sd=/var/spool/output/lpd:lf=/var/log/lpd-errs:</pre></div></div><div class=paragraph><p>Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=printcap&amp;sektion=5&amp;format=html">printcap(5)</a> voor een gedetailleerde beschrijving.</p></div></div><div class=sect4><h5 id=_ms_dos_bestandssysteem_en_russische_bestandsnamen>23.5.1.4. MS-DOS® bestandssysteem en Russische bestandsnamen<a class=anchor href=#_ms_dos_bestandssysteem_en_russische_bestandsnamen></a></h5><div class=paragraph><p>De volgende voorbeeld <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> regel zet ondersteuning aan voor Russische bestandsnamen gekoppeld op MS-DOS® bestandssystemen:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ad0s2  /dos/c  msdos rw,-Wkoi2dos,-Lru_RU.KIO8-R 0	0</pre></div></div><div class=paragraph><p>De <code>-L</code> optie selecteert de te gebruiken localenaam, en <code>-W</code> stelt de karakteromzettabel in. Om de <code>-W</code> te gebruiken moet <span class=filename>/usr</span> gemount zijn voor de MS-DOS® partitie omdat de omzettabellen zich bevinden in <span class=filename>/usr/libdata/msdosfs</span>. <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> geeft verdere uitleg.</p></div></div><div class=sect4><h5 id=_x11_instellen_3>23.5.1.5. X11 instellen<a class=anchor href=#_x11_instellen_3></a></h5><div class="olist arabic"><ol class=arabic><li><p>Voer eerst de <a href=#setting-locale>niet-X lokale instellingen</a> uit zoals beschreven.</p></li><li><p>Installeer bij gebruik van Xorg het package <a class=package href=https://cgit.freebsd.org/ports/tree/x11-fonts/xorg-fonts-cyrillic/>x11-fonts/xorg-fonts-cyrillic</a>.</p><div class=paragraph><p>Controleer de <code>"Files"</code> sectie in <span class=filename>/etc/X11/xorg.conf</span> bestand. Zorg dat de volgende regel <em>vóór</em> andere <code>FontPath</code> regels staan:</p></div><div class="literalblock programlisting"><div class=content><pre>FontPath  &#34;/usr/local/lib/X11/fonts/cyrillic&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Zie de Ports Collectie voor meer cyrillic fonts.</p></div></td></tr></tbody></table></div></li><li><p>Om een Russisch toetsenbord te activeren dient het volgende in het <code>"Keyboard"</code> gedeelte van <span class=filename>xorg.conf</span> te staan:</p><div class="literalblock programlisting"><div class=content><pre>XkbLayout &#34;ru&#34;
XkbOptions  &#34;grp:caps_toggle&#34;</pre></div></div><div class=paragraph><p>Voor Xorg:</p></div><div class="literalblock programlisting"><div class=content><pre>Option  &#34;XkbLayout&#34;	&#34;us,ru&#34;
Option	&#34;XkbOptions&#34;  &#34;grp:caps_toggle&#34;</pre></div></div><div class=paragraph><p>Ook moet daar <code>XkbDisable</code> uitgeschakeld (uitgecomment) zijn.</p></div><div class=paragraph><p>Voor <code>grp:toggle</code> is de RUS/LAT-schakelaar <kbd>Rechter Alt</kbd> voor de <code>grp:ctrl_shift_toggle</code> schakelaar zal dat <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Shift</kbd></span> zijn. Voor <code>grp:caps_toggle</code> zal de RUS/LAT-schakelaar <kbd>CapsLock</kbd> zijn. De oude <kbd>CapsLock</kbd> functie is nog steeds beschikbaar via <span class=keyseq><kbd>Shift</kbd>+<kbd>CapsLock</kbd></span> (alleen in LAT-modus). <code>grp:caps_toggle</code> werkt om onbekende reden niet in Xorg.</p></div><div class=paragraph><p>Als er "Windows®" toetsen op een toetsenbord zitten en het blijkt dat sommige niet-alfabetische toetsen verkeerd gemapt zijn in RUS-modus, dan kan de volgende regel aan <span class=filename>xorg.conf</span> toegevoegd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>Option  &#34;XkbVariant&#34;  &#34;,winkeys&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het Russische XKB toetsenbord hoeft niet te werken met niet-gelokaliseerde applicaties.</p></div></td></tr></tbody></table></div></li></ol></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Minimaal gelokaliseerde applicaties moeten vroeg in het programma een aanroep naar de <code>XtSetLanguageProc (NULL, NULL,);</code> functie doen.</p></div><div class=paragraph><p>In <a href=http://koi8.pp.ru/xwin.html>KOI8-R for X Window</a> staan meer instructies over het lokaliseren van X11-applicaties.</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=_traditioneel_chinees_voor_taiwan>23.5.2. Traditioneel Chinees voor Taiwan<a class=anchor href=#_traditioneel_chinees_voor_taiwan></a></h4><div class=paragraph><p>Het FreeBSD-Taiwan Project heeft een Chinese HOWTO voor FreeBSD op <a href=http://netlab.cse.yzu.edu.tw/~statue/zh-l10n-tut/>http://netlab.cse.yzu.edu.tw/~statue/zh-l10n-tut/</a> die gebruik maakt van veel Chinese ports. De huidige redacteur voor de <code>FreeBSD Chinese HOWTO</code> is Shen Chuan-Hsing <a href=mailto:statue@freebsd.sinica.edu.tw>statue@freebsd.sinica.edu.tw</a>.</p></div><div class=paragraph><p>Chuan-Hsing Shen heeft de <a href=http://netlab.cse.yzu.edu.tw/\~statue/cfc>Chinese FreeBSD Collection (CFC)</a> gemaakt met gebruik van FreeBSD-Taiwan’s <code>zh-L10N-tut</code>. De packages en scriptbestanden zijn beschikbaar op <a href=ftp://freebsd.csie.nctu.edu.tw/pub/taiwan/CFC>ftp://freebsd.csie.nctu.edu.tw/pub/taiwan/CFC</a>.</p></div></div><div class=sect3><h4 id=_duits_alle_iso_8859_1_talen>23.5.3. Duits (alle ISO 8859-1 talen)<a class=anchor href=#_duits_alle_iso_8859_1_talen></a></h4><div class=paragraph><p>Slaven Rezic <a href=mailto:eserte@cs.tu-berlin.de>eserte@cs.tu-berlin.de</a> heeft een tutorial geschreven over het gebruik van umlauten op een FreeBSD-machine. De tutorial is in het Duits geschreven en staat op <a href=ttp://user.cs.tu-berlin.de/~eserte/FreeBSD/doc/umlaute/umlaute.html>ttp://user.cs.tu-berlin.de/~eserte/FreeBSD/doc/umlaute/umlaute.html</a>.</p></div></div><div class=sect3><h4 id=_grieks>23.5.4. Grieks<a class=anchor href=#_grieks></a></h4><div class=paragraph><p>Nikos Kokkalis <a href=mailto:nickkokkalis@gmail.com>nickkokkalis@gmail.com</a> heeft een compleet artikel over Griekse ondersteuning in FreeBSD geschreven. Het is beschikbaar als deel van de officiële Griekse FreeBSD-documentatie, in <a href=https://www.FreeBSD.org/doc/el/articles/greek-language-support/>http://www.freebsd.org/doc/el/articles/greek-language-support/</a>. Merk opdat dit <em>alleen</em> in het Grieks beschikbaar is.</p></div></div><div class=sect3><h4 id=_japans_en_koreaans>23.5.5. Japans en Koreaans<a class=anchor href=#_japans_en_koreaans></a></h4><div class=paragraph><p>Japanse lokalisatie staat beschreven op <a href=http://www.jp.FreeBSD.org/>http://www.jp.FreeBSD.org/</a> en de Koreaanse lokalisatie staat op <a href=http://www.kr.FreeBSD.org/>http://www.kr.FreeBSD.org/</a>.</p></div></div><div class=sect3><h4 id=_niet_engelstalige_freebsd_documentatie>23.5.6. Niet-Engelstalige FreeBSD documentatie<a class=anchor href=#_niet_engelstalige_freebsd_documentatie></a></h4><div class=paragraph><p>Sommige delen van de FreeBSD-documentatie zijn naar andere talen vertaald. Hiernaar staan links op de <a href=https://www.FreeBSD.org/>hoofdsite</a> of in <span class=filename>/usr/shared/doc</span>.</p></div></div></div></div></div><div class=sect1><h2 id=updating-upgrading>Hoofdstuk 24. FreeBSD updaten en upgraden<a class=anchor href=#updating-upgrading></a></h2><div class=sectionbody><div class=sect2><h3 id=updating-upgrading-synopsis>24.1. Overzicht<a class=anchor href=#updating-upgrading-synopsis></a></h3><div class=paragraph><p>FreeBSD wordt ontwikkeld tussen de verschillende versies in. Sommige mensen prefereren om de officieel uitgegeven versies te draaien, terwijl anderen gesynchroniseerd willen blijven met de nieuwste ontwikkelingen. Zelfs officiële uitgaven echter worden vaak bijgewerkt met veiligheids- en andere kritieke reparaties. Ongeacht de gebruikte versie biedt FreeBSD alle noodzakelijke gereedschappen om uw systeem bijgewerkt te houden, en maakt FreeBSD het upgraden tussen versies ook gemakkelijk. Dit hoofdstuk helpt om een keuze te maken of het wenselijk is het ontwikkelsysteem te volgen of één van de uitgegeven versies. De basisgereedschappen om uw systeem bijgewerkt te houden worden ook gepresenteerd.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Welke gereedschappen gebruikt kunnen worden om het systeem en de Portscollectie te updaten.</p></li><li><p>Hoe een systeem bijgewerkt kan worden met freebsd-update, CVSup, CVS of CTM;</p></li><li><p>Hoe de toestand van een geïnstalleerd systeem met een bekende maagdelijke kopie te vergelijken.</p></li><li><p>Hoe uw documentatie bijgewerkt te houden met CVSup of documentatie-ports.</p></li><li><p>De verschillen tussen de ontwikkeltakken FreeBSD-STABLE en FreeBSD-CURRENT;</p></li><li><p>Hoe een basissysteem opnieuw te compileren en te herinstalleren met <code>make buildworld</code>, enzovoort.</p></li></ul></div><div class=paragraph><p>Veronderstelde criteria:</p></div><div class=ulist><ul><li><p>Een juist ingesteld netwerk (<a href=./#advanced-networking>Geavanceerd netwerken</a>);</p></li><li><p>Weten hoe software van derden te installeren (<a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Door dit hoofdstuk heen wordt <code>cvsup</code> gebruikt om de broncode van FreeBSD te verkrijgen en bij te werken. Om het te gebruiken, dient u de port of het pakket voor <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup/>net/cvsup</a> te installeren (als u niet de grafische <code>cvsup</code>-cliënt wilt installeren, kunt u de port <span class=filename>net/cvsup-without-gui</span> installeren. U kunt ervoor kiezen om dit te vervangen door <a href="https://man.freebsd.org/cgi/man.cgi?query=csup&amp;sektion=1&amp;format=html">csup(1)</a> welke onderdeel is van het basissysteem.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=updating-upgrading-freebsdupdate>24.2. FreeBSD Update<a class=anchor href=#updating-upgrading-freebsdupdate></a></h3><div class=paragraph><p>Het toepassen van beveiligingspatches is een belangrijk onderdeel van het beheren van computersoftware, met name het besturingssysteem. Dit was voor een lange tijd geen gemakkelijk proces op FreeBSD. Er moesten patches op de broncode worden toegepast, de code moest herbouwd worden tot binairen, en daarna moesten de binairen worden geherinstalleerd.</p></div><div class=paragraph><p>Dit is niet langer het geval aangezien FreeBSD nu een gereedschap heeft dat eenvoudigweg <code>freebsd-update</code> heet. Dit gereedschap biedt twee gescheiden functies. Ten eerste voorziet het in het toepassen van binaire beveiligings- en errata-updates op het basissysteem van FreeBSD zonder de eis om te bouwen en te installeren. Ten tweede ondersteunt het gereedschap kleine en grote uitgave-upgrades.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Binaire updates zijn beschikbaar voor alle architecturen en uitgaveaankondigingen dienen gelezen te worden aangezien deze belangrijke informatie over de gewenste uitgave kunnen bevatten. De aankondigingen kunnen op de volgende koppelin bekeken worden: <a href=http://www.FreeBSD.org/releases/>http://www.FreeBSD.org/releases/</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als er een <code>crontab</code> bestaat die de mogelijkheden van <code>freebsd-update</code> gebruikt, moet het uitgeschakeld worden voordat aan de volgende operatie wordt begonnen.</p></div><div class=sect3><h4 id=freebsdupdate-config-file>24.2.1. Het configuratiebestand<a class=anchor href=#freebsdupdate-config-file></a></h4><div class=paragraph><p>Sommige gebruikers willen het standaard configuratiebestand optimaliseren, waardoor het proces beter gecontroleerd kan worden. De opties zijn goed gedocumenteerd, maar voor de volgenden is wat extra uitleg nodig:</p></div><div class="literalblock programlisting"><div class=content><pre># Componenten van het basissysteem die bijgewerkt moeten blijven
Components src world kernel</pre></div></div><div class=paragraph><p>Deze parameter bepaalt welke delen van FreeBSD bijgewerkt blijven. Standaard wordt de broncode bijgewerkt, het hele basissysteem, en de kernel. Dezelfde componenten als tijdens de installatie zijn beschikbaar, het toevoegen van bijvoorbeeld <code>world/games</code> zou de spelpatches toepassen. Het gebruik van <code>src/bin</code> zou de broncode in <span class=filename>src/bin</span> bijgewerkt houden.</p></div><div class=paragraph><p>Het beste kan dit op de standaardwaarde blijven aangezien het veranderen hiervan om specifieke items te bevatten de gebruiker dwingt om alle items die bijgewerkt dienen te worden op te noemen. Dit kan rampzalige gevolgen hebben aangezien de broncode en de binairen asynchroon kunnen raken.</p></div><div class="literalblock programlisting"><div class=content><pre># Paden die beginnen met iets wat overeenkomt met een regel in een IgnorePaths
# statement zullen genegeerd worden.
IgnorePaths</pre></div></div><div class=paragraph><p>Voeg paden, zoals <span class=filename>/bin</span> of <span class=filename>/sbin</span> toe om deze specifieke mappen ongemoeid te laten tijdens het updateproces. Deze optie kan gebruikt worden om te voorkomen dat <code>freebsd-update</code> lokale wijzigingen overschrijft.</p></div><div class="literalblock programlisting"><div class=content><pre># Paden die beginnen met iets wat overeenkomt met een regel in een UpdateIfUnmodified
# statement zullen alleen worden bijgewerkt als de inhoud van het bestand niet is
# gewijzigd door de gebruiker (tenzij veranderingen zijn samengevoegd; zie beneden).
UpdateIfUnmodified /etc/ /var/ /root/ /.cshrc /.profile</pre></div></div><div class=paragraph><p>Werk configuratiebestanden in de aangegeven mappen alleen bij als ze niet zijn gewijzigd. Alle veranderingen die door de gebruiker zijn gemaakt maken het automatisch bijwerken van deze bestanden ongeldig. Er is een andere optie, <code>KeepModifiedMetadata</code>, die <code>freebsd-update</code> instrueert om de veranderingen tijdens het samenvoegen te bewaren.</p></div><div class="literalblock programlisting"><div class=content><pre># Wanneer naar een nieuwe uitgave van FreeBSD wordt ge-upgraded, worden lokale veranderingen van bestanden die overeenkomen met MergeChanges
# samengevoegd in de versie van de nieuwe uitgave.
MergeChanges /etc/ /var/named/etc/</pre></div></div><div class=paragraph><p>Lijst van mappen met instellingenbestanden waar <code>freebsd-update</code> moet proberen om in samen te voegen. Het proces van bestanden samenvoegen is een serie van <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a>-patches die ongeveer gelijk is aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> met minder opties, de samenvoegingen worden ofwel geaccepteerd, of openen een tekstverwerker, of zorgen ervoor dat <code>freebsd-update</code> afbreekt. Maak in geval van twijfel een reservekopie van <span class=filename>/etc</span> en accepteer de samenvoegingen. In <a href=#mergemaster><code>mergemaster</code></a> staat meer informatie over het commando <code>mergemaster</code>.</p></div><div class="literalblock programlisting"><div class=content><pre># Map waarin de gedownloade updates en tijdelijke
bestanden
# die door een FreeBSD Update worden gebruikt worden opgeslagen.
# WorkDir /var/db/freebsd-update</pre></div></div><div class=paragraph><p>Dit is de map waarin alle patches en tijdelijke bestanden worden geplaatst. In het geval dat de gebruiker een versie-upgrade uitvoert, dient deze locatie tenminste een gigabyte aan vrije schijfruimte te hebben.</p></div><div class="literalblock programlisting"><div class=content><pre># Wanneer tussen uitgaven wordt ge-upgraded, dient de lijst van Componenten dan
# strikt gelezen te worden (StrictComponents yes) of slechts als een lijst van componenten

# die geïnstalleerd *kunnen* worden en waarvan FreeBSD Update uit dient te zoeken
# welke daadwerkelijk zijn geïnstalleerd en die te upgraden (StrictComponents no)?
# StrictComponents no</pre></div></div><div class=paragraph><p>Wanneer ingesteld op <code>yes</code>, zal <code>freebsd-update</code> aannemen dat de lijst <code>Components</code> compleet is en zal het niet proberen om wijzigingen buiten de lijst te maken. Effectief zal <code>freebsd-update</code> proberen om elk bestand bij te werken dat op de lijst <code>Components</code> staat.</p></div></div><div class=sect3><h4 id=freebsdupdate-security-patches>24.2.2. Beveiligingspatches<a class=anchor href=#freebsdupdate-security-patches></a></h4><div class=paragraph><p>Beveiligingspatches staan op een verre machine en kunnen met het volgende commando gedownload en geïnstalleerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update fetch</span>
<span class=c># freebsd-update install</span></code></pre></div></div><div class=paragraph><p>Als er kernelpatches zijn toegepast moet het systeem opnieuw opgestart worden. Als alles goed is gegaan dient het systeem gepatcht te zijn en kan <code>freebsd-update</code> als een nachtelijke <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a>-taak gedraaid worden. Een regel in <span class=filename>/etc/crontab</span> zou genoeg moeten zijn om deze taak te volbrengen:</p></div><div class="literalblock programlisting"><div class=content><pre>@daily                                  root    freebsd-update cron</pre></div></div><div class=paragraph><p>Deze regel verklaart dat eenmaal per dag het commando <code>freebsd-update</code> gedraaid zal worden. Op deze manier, door het argument <code>cron</code> te gebruiken, zal het gereedschap <code>freebsd-update</code> alleen kijken of er updates bestaan. Als er patches bestaan, zullen ze automatisch worden gedownload naar de plaatselijke schijf maar niet worden toegepast. Er zal een email aan de gebruiker <code>root</code> worden verstuurd zodat ze handmatig geïnstalleerd kunnen worden.</p></div><div class=paragraph><p>Als er iets misging, heeft <code>freebsd-update</code> de mogelijkheid om de laatste verzamelingen veranderingen terug te draaien met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update rollback</span></code></pre></div></div><div class=paragraph><p>Eenmaal voltooid, dient het systeem herstart te worden als de kernel of enige kernelmodule is gewijzigd. Dit stelt FreeBSD in staat om de nieuwe binairen in het geheugen te laden.</p></div><div class=paragraph><p>Het gereedschap <code>freebsd-update</code> kan alleen de kernel <span class=filename>GENERIC</span> automatisch bijwerken. Als een eigen kernel wordt gebruikt, moet het herbouwd en geherinstalleerd worden nadat <code>freebsd-update</code> klaar is met het installeren de rest van de updates. <code>freebsd-update</code> zal echter de kernel <span class=filename>GENERIC</span> in <span class=filename>/boot/GENERIC</span> detecteren en bijwerken (als het bestaat), zelfs als het niet de huidige (draaiende) kernel van het systeem is.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is een goed idee om altijd een kopie van de kernel <span class=filename>GENERIC</span> in <span class=filename>/boot/GENERIC</span> te bewaren. Het kan van pas komen bij het vaststellen van een keur aan problemen, en bij het uitvoeren van versie-upgrades met <code>freebsd-update</code> zoals beschreven in <a href=#freebsdupdate-upgrade>Grote en kleine upgrades</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Tenzij de standaardconfiguratie in <span class=filename>/etc/freebsd-update.conf</span> is gewijzigd, zal <code>freebsd-update</code> de bijgewerkte kernelbronnen samen met de rest van de updates installeren. Het herbouwen en herinstalleren van uw nieuwe eigen kernel kan daarna op de gebruikelijke manier gedaan worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De updates die via <code>freebsd-update</code> verspreid worden hebben niet altijd betrekking op de kernel. Het is niet nodig om uw eigen kernel te herbouwen als de kernelbronnen niet zijn aangepast door het uitvoeren van <code>freebsd-update install</code>. <code>freebsd-update install</code> zal echter altijd het bestand <span class=filename>/usr/src/sys/conf/newvers.sh</span> bijwerken. Het huidige patchniveau (zoals aangegeven door het <code>-p</code>-nummer gerapporteerd door <code>uname -r</code>) wordt uit dit bestand gehaald. Het herbouwen van uw eigen kernel, zelfs als er niets veranderd is, stelt <a href="https://man.freebsd.org/cgi/man.cgi?query=uname&amp;sektion=1&amp;format=html">uname(1)</a> in staat om het huidige patchniveau van het systeem accuraat te rapporteren. Dit is in het bijzonder behulpzaam wanneer meerdere systemen onderhouden worden, aangezien hierdoor snel de geïnstalleerde updates op elk ervan kunnen worden nagegaan.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=freebsdupdate-upgrade>24.2.3. Grote en kleine upgrades<a class=anchor href=#freebsdupdate-upgrade></a></h4><div class=paragraph><p>Dit proces ruimt oude objectbestanden en bibliotheken op waardoor de meeste applicaties van derde partijen kapot gaan. Het wordt aangeraden dat alle geïnstalleerde poorten ofwel verwijderd en geherinstalleerd worden of later ge-upgraded worden met het hulpmiddel <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portupgrade/>ports-mgmt/portupgrade</a>. De meeste gebruikers zullen willen proefdraaien met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -af</span></code></pre></div></div><div class=paragraph><p>Dit zorgt ervoor dat alles juist wordt geherinstalleerd. Merk op dat het instellen van de omgevingsvariabele <code>BATCH</code> op <code>yes</code> het antwoord <code>yes</code> zal geven op alle prompts tijdens dit proces, waardoor het niet nodig is om handmatig in het bouwproces in te grijpen.</p></div><div class=paragraph><p>Als een eigen kernel wordt gebruikt, is het upgradeproces iets ingewikkelder. Een kopie van de kernel <span class=filename>GENERIC</span> is nodig en dient in <span class=filename>/boot/GENERIC</span> geplaatst te worden. Als de kernel <span class=filename>GENERIC</span> niet reeds op het systeem aanwezig is, moet het met één van de volgende methoden verkregen worden:</p></div><div class=ulist><ul><li><p>Als er slechts eenmaal een eigen kernel is gebouwd, dan is de kernel in <span class=filename>/boot/kernel.old</span> eigenlijk de <span class=filename>GENERIC</span>. Hernoem deze map naar <span class=filename>/boot/GENERIC</span>.</p></li><li><p>Aannemende dat fysieke toegang tot de machine mogelijk is, kan een kopie van de kernel <span class=filename>GENERIC</span> van het CD-ROM-medium worden geïnstalleerd. Laad de installatieschijf en geef de volgende commando’s:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /cdrom</span>
<span class=c># cd /cdrom/X.Y-RELEASE/kernels</span>
<span class=c># ./install.sh GENERIC</span></code></pre></div></div><div class=paragraph><p>Vervang <span class=filename>X.Y-RELEASE</span> met de versie van de uitgave die u gebruikt. De kernel <span class=filename>GENERIC</span> zal standaard in <span class=filename>/boot/GENERIC</span> worden geïnstalleerd.</p></div></li><li><p>Als al het bovenstaande niet lukt, kan de kernel <span class=filename>GENERIC</span> herbouwd en geherinstalleerd worden vanaf de broncode:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># env DESTDIR=/boot/GENERIC make kernel</span>
<span class=c># mv /boot/GENERIC/boot/kernel/* /boot/GENERIC</span>
<span class=c># rm -rf /boot/GENERIC/boot</span></code></pre></div></div><div class=paragraph><p>Om deze kernel door <code>freebsd-update</code> als <span class=filename>GENERIC</span> te laten herkennen, mag het configuratiebestand voor <span class=filename>GENERIC</span> niet op enige wijze veranderd zijn. Het is ook aan te raden dat het zonder andere speciale opties wordt gebouwd (bij voorkeur met een leeg <span class=filename>/etc/make.conf</span>).</p></div></li></ul></div><div class=paragraph><p>Opnieuw opstarten naar de kernel <span class=filename>GENERIC</span> is in dit stadium niet nodig.</p></div><div class=paragraph><p>Updates van grote en kleine versies kunnen worden uitgevoerd door een uitgaveversie als doel aan <code>freebsd-update</code> op te geven, het volgende commando zal bijvoorbeeld updaten naar FreeBSD 8.1:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update -r 8.1-RELEASE upgrade</span></code></pre></div></div><div class=paragraph><p>Nadat het commando is ontvangen, zal <code>freebsd-update</code> het instellingenbestand en het huidige systeem evalueren in een poging om de benodigde informatie te verzamelen om het systeem te updaten. Een lijst op het scherm zal aangeven welke componenten zijn gedetecteerd en welke niet. Bijvoorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Looking up update.FreeBSD.org mirrors... 1 mirrors found.
Fetching metadata signature <span class=k>for </span>8.0-RELEASE from update1.FreeBSD.org... <span class=k>done</span><span class=nb>.</span>
Fetching metadata index... <span class=k>done</span><span class=nb>.</span>
Inspecting system... <span class=k>done</span><span class=nb>.</span>

The following components of FreeBSD seem to be installed:
kernel/smp src/base src/bin src/contrib src/crypto src/etc src/games
src/gnu src/include src/krb5 src/lib src/libexec src/release src/rescue
src/sbin src/secure src/share src/sys src/tools src/ubin src/usbin
world/base world/info world/lib32 world/manpages

The following components of FreeBSD <span class=k>do </span>not seem to be installed:
kernel/generic world/catpages world/dict world/doc world/games
world/proflibs

Does this look reasonable <span class=o>(</span>y/n<span class=o>)</span>? y</code></pre></div></div><div class=paragraph><p>Nu zal <code>freebsd-update</code> proberen om alle bestanden die nodig zijn voor de upgrade te downloaden. In sommige gevallen kan de gebruiker worden gevraagd wat te installeren of hoe verder te gaan.</p></div><div class=paragraph><p>Wanneer een eigen kernel wordt gebruikt, zal de bovenstaande stap een waarschuwing geven die lijkt op de volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>WARNING: This system is running a <span class=s2>&#34;MIJNKERNEL&#34;</span> kernel, which is not a
kernel configuration distributed as part of FreeBSD 8.0-RELEASE.
This kernel will not be updated: you MUST update the kernel manually
before running <span class=s2>&#34;/usr/sbin/freebsd-update install&#34;</span></code></pre></div></div><div class=paragraph><p>Deze waarschuwing kan op dit moment veilig worden genegeerd. De bijgewerkte kernel <span class=filename>GENERIC</span> zal als tussenliggende stap in het upgradeproces worden gebruikt.</p></div><div class=paragraph><p>Nadat alle patches zijn gedownload naar het plaatselijke systeem zullen ze worden toegepast. Dit proces kan afhankelijk van de snelheid en werklast van de machine even duren. Hierna zullen instellingenbestanden worden samengevoegd - voor dit gedeelte van het proces is enige tussenkomst van de gebruiker nodig aangezien een bestand kan worden samengevoegd of omdat er een tekstverwerker op het scherm kan verschijnen om het bestand handmatig samen te voegen. Het resultaat van elke succesvolle samenvoeging zal aan de gebruiker worden getoond naarmate het proces verder gaat. Een mislukte of genegeerde samenvoegpoging zal het proces afbreken. Het is mogelijk voor gebruikers om een reservekopie van <span class=filename>/etc</span> te maken en belangrijke bestanden, zoals <span class=filename>master.passwd</span> of <span class=filename>group</span>, later samen te voegen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het systeem is nog niet veranderd, al het patchen en samenvoegen gebeurt in een andere map. Wanneer alle patches succesvol zijn toegepast, alle instellingenbestanden zijn samengevoegd en het erop lijkt dat het proces soepel verloopt, dienen de veranderingen verzegeld te worden door de gebruiker.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als dit proces eenmaal voltooid is, kan de upgrade aan de schijf toevertrouwd worden met het volgende commando.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div><div class=paragraph><p>De kernel en kernelmodules zullen als eerste gepatcht worden. Nu moet de machine opnieuw opgestart worden. Als het systeem een eigen kernel draaide, gebruik dan het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=nextboot&amp;sektion=8&amp;format=html">nextboot(8)</a> om de kernel voor de volgende keer dat opgestart wordt in te stellen op <span class=filename>/boot/GENERIC</span> (welke is bijgewerkt):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># nextboot -k GENERIC</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Voordat er met de kernel <span class=filename>GENERIC</span> wordt opgestart, dient te worden gecontroleerd dat het alle stuurprogramma’s bevat om uw systeem juist te laten opstarten (en met het netwerk te verbinden, als de machine die bijgewerkt wordt van afstand wordt benaderd). In het bijzonder, als de vorige kernel die draaide ingebouwde functionaliteit bevatte die normaalgesproken door kernelmodules wordt geleverd, zorg er dan voor dat deze modules tijdelijk in de kernel <span class=filename>GENERIC</span> worden geladen door de faciliteit <span class=filename>/boot/loader.conf</span> te gebruiken. U kunt er ook voor kiezen om niet-essentiële diensten, schijf- en netwerkkoppelingen, enzovoorts uit te zetten totdat het upgradeproces voltooid is.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De machine dient nu te worden herstart met de bijgewerkte kernel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown -r now</span></code></pre></div></div><div class=paragraph><p>Als het systeem weer actief is, moet <code>freebsd-update</code> nogmaals gestart worden. De toestand van het proces is opgeslagen en dus zal <code>freebsd-update</code> niet vooraan beginnen, maar zal het alle oude gedeelde bibliotheken en objectbestanden verwijderen. Geef het volgende commando om verder te gaan op dit punt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Afhankelijk van het feit of er versienummers van bibliotheken zijn opgehoogd, kunnen er slechts twee in plaats van drie installatiefasen zijn.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Alle software van derde partijen dient nu opnieuw gebouwd en geïnstalleerd te worden. Dit is nodig omdat geïnstalleerde software van bibliotheken afhankelijk kan zijn die tijdens het upgradeproces zijn verwijderd. Het commando <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portupgrade/>ports-mgmt/portupgrade</a> kan gebruikt worden om dit proces te automatiseren. Dit proces kan met de volgende commando’s gestart worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -f ruby</span>
<span class=c># rm /var/db/pkg/pkgdb.db</span>
<span class=c># portupgrade -f ruby18-bdb</span>
<span class=c># rm /var/db/pkg/pkgdb.db /usr/ports/INDEX-*.db</span>
<span class=c># portupgrade -af</span></code></pre></div></div><div class=paragraph><p>Voltooi, nadat dit voltooid is, het upgradeproces met een laatste aanroep naar <code>freebsd-update</code>. Geef het volgende commando om alle losse eindjes in het upgradeproces samen te knopen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div><div class=paragraph><p>Als de kernel <span class=filename>GENERIC</span> tijdelijk werd gebruikt, is dit het moment om een nieuwe eigen kernel op de gebruikelijke manier te bouwen en installeren.</p></div><div class=paragraph><p>Start de machine opnieuw op in de nieuwe FreeBSD-versie. Het proces is voltooid.</p></div></div><div class=sect3><h4 id=freebsdupdate-system-comparison>24.2.4. Het vergelijken van systeemtoestanden<a class=anchor href=#freebsdupdate-system-comparison></a></h4><div class=paragraph><p>Het gereedschap <code>freebsd-update</code> kan gebruikt worden om de toestand van de geïnstalleerde versie van FreeBSD met een bekende goede kopie te vergelijken. Deze optie evalueert de huidige versie van systeemgereedschappen, bibliotheken, en instellingenbestanden. Geef het volgende commando om met de vergelijking te beginnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update IDS &gt;&gt; uitvoerbestand.ids</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Hoewel de commandonaam IDS is, is het in geen geval een vervanging voor een indringdetectiesysteem zoals <a class=package href=https://cgit.freebsd.org/ports/tree/security/snort/>security/snort</a>. Aangezien <code>freebsd-update</code> gegevens op schijf opslaat, is de mogelijkheid om te knoeien duidelijk. Hoewel deze mogelijkheid verminderd kan worden door de instelling <code>kern.securelevel</code> te gebruiken en de gegevens van <code>freebsd-update</code> op een bestandssysteem dat alleen gelezen kan worden op te slaan wanneer deze niet gebruikt worden, zou een betere oplossing zijn om het systeem met een veilige schijf te vergelijken, zoals een DVD of een veilig opgeslagen externe USB-schijf.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het systeem zal nu geïnspecteerd worden, en er zal een lijst van hun <a href="https://man.freebsd.org/cgi/man.cgi?query=sha256&amp;sektion=1&amp;format=html">sha256(1)</a>-hashwaarden, zowel de bekende waarde in de uitgave en de huidige geïnstalleerde waarde, afgebeeld worden. Hierom wordt de uitvoer naar het bestand <span class=filename>uitvoerbestand.ids</span> gezonden. Het scrollt te snel voorbij om het met het oog te vergelijken, en het vult al snel de gehele consolebuffer op.</p></div><div class=paragraph><p>Deze regels zijn ook extreem lang, maar het uitvoerformaat kan vrij eenvoudig geparsed worden. Geef, om bijvoorbeeld een lijst van alle bestanden te krijgen die verschillen van die in de uitgave, het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat uitvoerbestand.ids | awk &#39;{ print $1 }&#39; | more</span>
/etc/master.passwd
/etc/motd
/etc/passwd
/etc/pf.conf</code></pre></div></div><div class=paragraph><p>Deze uitvoer is afgekapt, er bestaan veel meer bestanden. Sommige van deze bestanden hebben natuurlijke veranderingen, het <span class=filename>/etc/passwd</span> is gewijzigd omdat er gebruikers aan het systeem zijn toegevoegd. In sommige gevallen kunnen er andere bestanden zijn, zoals kernelmodules, die verschillen aangezien <code>freebsd-update</code> ze ge-updated kan hebben. Voeg, om bepaalde bestanden of mappen uit te sluiten, deze toe aan de optie <code>IDSIgnorePaths</code> in <span class=filename>/etc/freebsd-update.conf</span>.</p></div><div class=paragraph><p>Dit systeem kan gebruikt worden als deel van een uitgebreide upgrademethode, afgezien van de eerder besproken versie.</p></div></div></div><div class=sect2><h3 id=updating-upgrading-portsnap>24.3. Portsnap: een updategereedschap voor de Portscollectie<a class=anchor href=#updating-upgrading-portsnap></a></h3><div class=paragraph><p>Het basissysteem van FreeBSD bevat ook een gereedschap om de Portscollectie bij te werken: het hulpmiddel <a href="https://man.freebsd.org/cgi/man.cgi?query=portsnap&amp;sektion=8&amp;format=html">portsnap(8)</a>. Wanneer het wordt uitgevoerd, zal het een verbinding maken met een verre site, de veilige sleutel controleren, en een nieuwe kopie van de Portscollectie downloaden. De sleutel wordt gebruikt om de integriteit van alle gedownloade bestanden te controleren, om er zeker van te zijn dat ze niet tijdens het downloaden zijn gewijzigd. Geef het volgende commando om de nieuwste versie van de bestanden van de Portscollectie te downloaden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap fetch</span>
Looking up portsnap.FreeBSD.org mirrors... 9 mirrors found.
Fetching snapshot tag from geodns-1.portsnap.freebsd.org... <span class=k>done</span><span class=nb>.</span>
Fetching snapshot metadata... <span class=k>done</span><span class=nb>.</span>
Updating from Tue May 22 02:12:15 CEST 2012 to Wed May 23 16:28:31 CEST 2012.
Fetching 3 metadata patches.. <span class=k>done</span><span class=nb>.</span>
Applying metadata patches... <span class=k>done</span><span class=nb>.</span>
Fetching 3 metadata files... <span class=k>done</span><span class=nb>.</span>
Fetching 90 patches.....10....20....30....40....50....60....70....80....90. <span class=k>done</span><span class=nb>.</span>
Applying patches... <span class=k>done</span><span class=nb>.</span>
Fetching 133 new ports or files... <span class=k>done</span>.</code></pre></div></div><div class=paragraph><p>Dit voorbeeld laat zien dat <a href="https://man.freebsd.org/cgi/man.cgi?query=portsnap&amp;sektion=8&amp;format=html">portsnap(8)</a> verscheidene patches heeft gevonden en deze met de huidige portsgegevens heeft gecontroleerd. Het geeft ook aan dat het gereedschap eerder is gedraaid, als het voor de eerste keer was gedraaid, had het simpelweg de collectie gedownload.</p></div><div class=paragraph><p>Wanneer <a href="https://man.freebsd.org/cgi/man.cgi?query=portsnap&amp;sektion=8&amp;format=html">portsnap(8)</a> succesvol een <code>fetch</code>-operatie afrondt, bestaan de Portscollectie en de vervolgpatches die de verificatie doorstaan hebben op het plaatselijke systeem. Gebruik de eerste keer dat <code>portsnap</code> wordt uitgevoerd <code>extract</code> om de gedownloade bestanden te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap extract</span>
/usr/ports/.cvsignore
/usr/ports/CHANGES
/usr/ports/COPYRIGHT
/usr/ports/GIDs
/usr/ports/KNOBS
/usr/ports/LEGAL
/usr/ports/MOVED
/usr/ports/Makefile
/usr/ports/Mk/bsd.apache.mk
/usr/ports/Mk/bsd.autotools.mk
/usr/ports/Mk/bsd.cmake.mk
...</code></pre></div></div><div class=paragraph><p>Om een reeds geïnstalleerde Ports Collectie te updaten kan er gebruik worden gemaakt van het commando <code>portsnap update</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap update</span></code></pre></div></div><div class=paragraph><p>Het proces is nu compleet, en applicaties kunnen met de bijgewerkte Portscollectie worden geïnstalleerd of worden bijgewerkt.</p></div><div class=paragraph><p>De bewerkingen <code>fetch</code> en <code>extract</code> of <code>update</code> kunnen achter elkaar uitgevoerd worden, zoals het volgende voorbeeld laat zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap fetch update</span></code></pre></div></div><div class=paragraph><p>Dit commando zal de laatste versie van de Ports Collectie downloaden en de lokale versie bijwerken in de <span class=filename>/usr/ports</span>.</p></div></div><div class=sect2><h3 id=updating-upgrading-documentation>24.4. De documentatie bijwerken<a class=anchor href=#updating-upgrading-documentation></a></h3><div class=paragraph><p>Naast het basissysteem en de Portscollectie is documentatie een integraal onderdeel van het besturingssysteem FreeBSD. Hoewel een actuele versie van de FreeBSD-documentatie altijd beschikbaar is op de <a href=http://www.freebsd.org/doc/>FreeBSD website</a>, hebben sommige gebruikers een langzame of helemaal geen permanente netwerkverbinding. Gelukkig zijn er verschillende manieren om de documentatie die bij elke uitgave wordt geleverd bij te werken door een lokale kopie van de nieuwste FreeBSD-documentatie bij te houden.</p></div><div class=sect3><h4 id=dsvn-doc>24.4.1. Subversion gebruiken om de documentatie bij te werken<a class=anchor href=#dsvn-doc></a></h4><div class=paragraph><p>De bronnen van de FreeBSD-documentatie kunnen met Subversion worden bijgewerkt. Deze sectie beschrijft:</p></div><div class=ulist><ul><li><p>Hoe de documentatiegereedschappen, de gereedschappen die nodig zijn om de FreeBSD-documentatie vanuit de broncode te herbouwen, te installeren.</p></li><li><p>Hoe een kopie van de documentatiebronnen in <span class=filename>/usr/doc</span> te downloaden door Subversion te gebruiken.</p></li><li><p>Hoe de FreeBSD-documentatie vanuit de broncode te herbouwen en onder <span class=filename>/usr/shared/doc</span> te installeren.</p></li><li><p>Sommige bouwopties die door het bouwsysteem van de documentatie ondersteund worden, i.e., de opties die slechts enkele van de verschillende vertalingen van de documentatie bouwen of de opties die een specifiek uitvoerformaat selecteren.</p></li></ul></div></div><div class=sect3><h4 id=installing-documentation-toolchain>24.4.2. Subversion en de documentatiegereedschappen installeren<a class=anchor href=#installing-documentation-toolchain></a></h4><div class=paragraph><p>Voor het herbouwen van de FreeBSD-documentatie vanuit de broncode is een aardig grote verzameling gereedschappen nodig. Deze gereedschappen zijn geen deel van het basissysteem van FreeBSD omdat ze een grote hoeveelheid schijfruimte nodig hebben en niet voor alle FreeBSD-gebruikers nuttig zijn; ze zijn alleen nuttig voor die gebruikers die actief nieuwe documentatie voor FreeBSD schrijven of regelmatig hun documentatie vanuit de broncode bijwerken.</p></div><div class=paragraph><p>Alle benodigde gereedschappen zijn beschikbaar als deel van de Portscollectie. De port <a class=package href=https://cgit.freebsd.org/ports/tree/textproc/docproj/>textproc/docproj</a> is een meester-port die door het FreeBSD Documentatieproject is ontwikkeld om de installatie en toekomstige updates van deze gereedschappen makkelijker te maken.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Wanneer er geen PostScript®- of PDF-documentatie nodig is, kan men overwegen om in plaats hiervan de port <a class=package href=https://cgit.freebsd.org/ports/tree/textproc/docproj-nojadetex/>textproc/docproj-nojadetex</a> te installeren. Deze versie van de documentatiegereedschappen bevat alles behalve de typesetting-engine teTeX. teTeX is een erg grote verzameling van gereedschappen, dus kan het zinvol zijn om de installatie ervan achterwege te laten als PDF-uitvoer niet echt nodig is.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Subversion wordt geïnstalleerd met de port <a class=package href=https://cgit.freebsd.org/ports/tree/textproc/docproj/>textproc/docproj</a>.</p></div></div><div class=sect3><h4 id=updating-documentation-sources>24.4.3. De documentatiebroncode bijwerken<a class=anchor href=#updating-documentation-sources></a></h4><div class=paragraph><p>Het programma Subversion kan een schone kopie van de documentatiebroncode ophalen door het volgende te typen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># svn checkout svn://svn.FreeBSD.org/doc/head /usr/doc</span></code></pre></div></div><div class=paragraph><p>De initiële download van de documentatiebroncode kan een tijd duren. Laat het draaien totdat het voltooid is.</p></div><div class=paragraph><p>Toekomstige updates van de documentatiebroncode kunnen opgehaald worden door het volgende commando te draaien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># svn update /usr/doc</span></code></pre></div></div><div class=paragraph><p>Nadat de broncode is uitgecheckt, wordt een alternatieve manier om de documentatie bij te werken ondersteund door <span class=filename>Makefile</span> van de map <span class=filename>/usr/doc</span> door het volgende te draaien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc</span>
<span class=c># make update</span></code></pre></div></div></div><div class=sect3><h4 id=updating-documentation-options>24.4.4. Instelbare opties van de documentatiebroncode<a class=anchor href=#updating-documentation-options></a></h4><div class=paragraph><p>Het bijwerk- en bouwsysteem van de FreeBSD-documentatie ondersteunt enkele opties die het proces om de documentatie alleen gedeeltelijk bij te werken, of om specifieke vertalingen te bouwen, makkelijker maken. Deze opties kunnen of als systeemwijde opties in het bestand <span class=filename>/etc/make.conf</span> worden ingesteld, of als opdrachtregelopties aan het hulpmiddel <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> worden doorgegeven.</p></div><div class=paragraph><p>De volgende opties zijn er enkelen van:</p></div><div class=dlist><dl><dt class=hdlist1><code>DOC_LANG</code></dt><dd><p>De lijst van te bouwen en te installeren talen en coderingen, bijvoorbeeld <code>en_US.ISO8859-1</code> voor alleen de Engelse documentatie.</p></dd><dt class=hdlist1><code>FORMATS</code></dt><dd><p>Een enkel formaat of een lijst van uitvoerformaten die gebouwd moeten worden. Momenteel worden <code>html</code>, <code>html-split</code>, <code>txt</code>, <code>ps</code>, <code>pdf</code>, en <code>rtf</code> ondersteund.</p></dd><dt class=hdlist1><code>DOCDIR</code></dt><dd><p>Waar de documentatie te installeren. Dit staat standaard op <span class=filename>/usr/shared/doc</span>.</p></dd></dl></div><div class=paragraph><p>Bekijk <a href="https://man.freebsd.org/cgi/man.cgi?query=make.conf&amp;sektion=5&amp;format=html">make.conf(5)</a> voor meer make-variabelen die als systeemwijde opties in FreeBSD worden ondersteund.</p></div><div class=paragraph><p>Voor meer make-variabelen die door het bouwsysteem van de FreeBSD-documentatie ondersteund worden, wordt naar het <a href=www.FreeBSD.org/books/fdp-primer>FreeBSD Documentation Project Primer for New Contributors</a> verwezen.</p></div></div><div class=sect3><h4 id=updating-installed-documentation>24.4.5. De FreeBSD-documentatie vanuit de broncode installeren<a class=anchor href=#updating-installed-documentation></a></h4><div class=paragraph><p>Wanneer er een actueel snapshot van de documentatiebroncode is opgehaald in <span class=filename>/usr/doc</span>, is alles gereed om de geïnstalleerde documentatie bij te werken.</p></div><div class=paragraph><p>Het volledig bijwerken van alle talen die in de Makefile-optie <code>DOC_LANG</code> zijn gedefinieerd kan worden gedaan door te typen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Als alleen het bijwerken van een specifieke taal gewenst is, dan kan <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> worden aangeroepen in een taalspecifieke submap van <span class=filename>/usr/doc</span>, i.e.:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc/en_US.ISO8859-1</span>
<span class=c># make update install clean</span></code></pre></div></div><div class=paragraph><p>De te installeren uitvoerformaten kunnen worden gespecificeerd door de make-variabele <code>FORMATS</code> in te stellen, i.e.:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc</span>
<span class=c># make FORMATS=&#39;html html-split&#39; install clean</span></code></pre></div></div></div><div class=sect3><h4 id=doc-ports>24.4.6. Documentatieports gebruiken<a class=anchor href=#doc-ports></a></h4><div class=paragraph><p>In de vorige sectie werd er een methode voor het bijwerken van de FreeBSD-documentatie vanaf de broncode gepresenteerd. Het bijwerken gebaseerd op broncode is echter niet voor alle FreeBSD-systemen haalbaar of praktisch. Voor het bouwen van de documentatiebronnen zijn een redelijk grote verzameling van gereedschappen, de <em>documentatie gereedschapskist</em>, een bepaald niveau van bekendheid met Subversion en checkouts van broncode vanuit een reservoir nodig, en een aantal handmatige stappen om de uitgecheckte broncode te bouwen. In deze sectie wordt een alternatieve manier beschreven om de geïnstalleerde kopiën van de FreeBSD-documentatie bij te werken; een die de Ports Collectie gebruikt en het mogelijk maakt om:</p></div><div class=ulist><ul><li><p>Voorgebouwde versies van de documentatie te downloaden en te installeren, zonder iets lokaal te hoeven bouwen (op deze manier wordt de noodzaak voor een installatie van de gehele documentatie-gereedschapskist voorkomen).</p></li><li><p>De documentatiebronnen te bouwen en ze via het ports-raamwerk te bouwen (de stappen van het uitchecken en bouwen worden iets eenvoudiger gemaakt).</p></li></ul></div><div class=paragraph><p>Deze twee methoden om de FreeBSD-documentatie bij te werken worden ondersteund door een verzameling van <em>documentatie-ports</em> die maandelijks door het Documentatie Engineering Team &lt;<a href=mailto:doceng@FreeBSD.org>doceng@FreeBSD.org</a>> worden bijgewerkt. Deze zijn vermeld in de FreeBSD Ports Collectie onder de virtuele categorie <a href=http://www.freshports.org/docs/>docs</a>.</p></div><div class=sect4><h5 id=doc-ports-install-make>24.4.6.1. Documentatie-ports bouwen en installeren<a class=anchor href=#doc-ports-install-make></a></h5><div class=paragraph><p>De documentatie-ports gebruiken het bouwraamwerk van de ports om het bouwen van documentatie eenvoudiger te maken. Ze automatiseren het proces van het uitchecken van de broncode van de documentatie, het draaien van <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> met de juiste omgevingsinstellingen en opdrachtregelopties, en ze maken de installatie of deïnstallatie van documentatie net zo eenvoudig als de installatie van elke andere FreeBSD-port of -pakket.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als een extra eigenschap registreren de documentatie-ports, wanneer ze lokaal zijn gebouwd, een afhankelijkheid naar de ports van de <em>documentatie-gereedschapskist</em>, zodat de laatste ook automatisch is geïnstalleerd.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De organisatie van de documentatie-ports is als volgt:</p></div><div class=ulist><ul><li><p>Er is een "meester-port", <a class=package href=https://cgit.freebsd.org/ports/tree/misc/freebsd-doc-en/>misc/freebsd-doc-en</a>, waar de bestanden van de documentatie-ports gevonden kunnen worden. Het is de basis van alle documentatie-ports. Standaard bouwt het alleen de Engelstalige documentatie.</p></li><li><p>Er is een "alles-in-één port", <a class=package href=https://cgit.freebsd.org/ports/tree/misc/freebsd-doc-all/>misc/freebsd-doc-all</a>, en het bouwt en installeert alle documentatie in alle beschikbare talen.</p></li><li><p>Ten slotte is er een "slaaf-port" voor elke vertaling, bijvoorbeeld <a class=package href=https://cgit.freebsd.org/ports/tree/misc/freebsd-doc-hu/>misc/freebsd-doc-hu</a> voor de documenten in het Hongaars. Ze zijn allemaal afhankelijk van de meester-port en installeren de vertaalde documentatie van de respectievelijke taal.</p></li></ul></div><div class=paragraph><p>Gebruik de volgende commando’s (als <code>root</code>) om een documentatieport vanaf de broncode te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/misc/freebsd-doc-en</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Dit zal de Engelstalige documentatie in gesplitst HTML-formaat (hetzelfde als dat op <a href=http://www.FreeBSD.org>http://www.FreeBSD.org</a> wordt gebruikt) in de map <span class=filename>/usr/local/shared/doc/freebsd</span> bouwen en installeren.</p></div><div class=sect5><h6 id=doc-ports-options>24.4.6.1.1. Algemene knoppen en opties<a class=anchor href=#doc-ports-options></a></h6><div class=paragraph><p>Er zijn vele opties om het standaardgedrag van de documentatie-ports aan te passen. Het volgende is slechts een korte lijst:</p></div><div class=dlist><dl><dt class=hdlist1><code>WITH_HTML</code></dt><dd><p>Staat bouwen van het HTML-formaat toe: een enkel HTML-bestand per document. De opgemaakte documentatie wordt naar gelang in een bestand genaamd <span class=filename>article.html</span>, of <span class=filename>book.html</span>, met afbeeldingen opgeslagen.</p></dd><dt class=hdlist1><code>WITH_PDF</code></dt><dd><p>Staat bouwen van het Adobe® Portable Document Format toe, te gebruiken met Adobe® Acrobat Reader®, Ghostscript, of andere PDF-lezers. De opgemaakte documentatie wordt naar gelang opgeslagen in een bestand genaamd <span class=filename>article.pdf</span> of <span class=filename>book.pdf</span> opgeslagen.</p></dd><dt class=hdlist1><code>DOCBASE</code></dt><dd><p>Waar de documentatie te installeren. Standaard is dit <span class=filename>/usr/local/shared/doc/freebsd</span>.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Merk op dat de standaard doelmap afwijkt van de map die door de Subversion-methode wordt gebruikt. Dit komt omdat er een port wordt geïnstalleerd, en ports worden normaliter onder de map <span class=filename>/usr/local</span> geïnstalleerd. Dit kan veranderd worden door de variabele <code>PREFIX</code> toe te voegen.</p></div></td></tr></tbody></table></div></dd></dl></div><div class=paragraph><p>Hier is een kort voorbeeld over hoe de bovengenoemde variabelen te gebruiken om de Hongaarse documentatie in Portable Document Format te installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/misc/freebsd-doc-hu</span>
<span class=c># make -DWITH_PDF DOCBASE=share/doc/freebsd/hu install clean</span></code></pre></div></div></div></div><div class=sect4><h5 id=doc-ports-install-package>24.4.6.2. Documentatiepakketten gebruiken<a class=anchor href=#doc-ports-install-package></a></h5><div class=paragraph><p>Voor het bouwen van de documentatie-ports vanaf broncode, zoals beschreven in de vorige sectie, is een lokale installatie van de documentatie-gereedschapskist en wat schijfruimte voor het bouwen van de ports nodig. Wanneer de bronnen voor het installeren van de documentatie-gereedschapskist niet aanwezig zijn, of wanneer het bouwen vanaf broncode te veel schijfruimte in beslag neemt, is het nog steeds mogelijk om de vooraf gebouwde versies van de documentatie-ports te installeren.</p></div><div class=paragraph><p>Het Documentatie Engineering Team &lt;<a href=mailto:doceng@FreeBSD.org>doceng@FreeBSD.org</a>> bereidt maandelijkse versies van de FreeBSD documentatiepakketten voor. Deze binaire pakketten kunnen met elk van de meegeleverde pakketgereedschappen, zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a>, enzovoorts gebruikt worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Wanneer binaire pakketten worden gebruikt, zal de FreeBSD documentatie in <em>alle</em> beschikbare formaten voor de gegeven taal geïnstalleerd worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het volgende commando bijvoorbeeld zal het nieuwste vooraf gebouwde pakket van de Hongaarse documentatie installeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r hu-freebsd-doc</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Pakketten hebben het volgende naamformaat welke afwijkt van de naam van de overeenkomstige port: <code>taal-freebsd-doc</code>. Hier is <em>taal</em> het korte formaat van de taalcode, i.e., <code>hu</code> voor Hongaars, of <code>zh_cn</code> voor Vereenvoudigd Chinees.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=doc-ports-update>24.4.6.3. Documentatieports bijwerken<a class=anchor href=#doc-ports-update></a></h5><div class=paragraph><p>Voor het bijwerken van een eerder geïnstalleerde documentatieport is elk gereedschap voor het bijwerken van ports geschikt. Het volgende commando bijvoorbeeld werkt de geïnstalleerde Hongaarse documentatie bij via het gereedschap <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portupgrade/>ports-mgmt/portupgrade</a> door alleen pakketten te gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -PP hu-freebsd-doc</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=current-stable>24.5. Een ontwikkelingstak volgen<a class=anchor href=#current-stable></a></h3><div class=paragraph><p>Er zijn twee ontwikkeltakken voor FreeBSD: FreeBSD-CURRENT en FreeBSD-STABLE. Deze sectie licht beiden toe en beschrijft hoe een systeem bijgewerkt te houden met elke tak. FreeBSD-CURRENT wordt eerst behandeld, daarna FreeBSD-STABLE.</p></div><div class=sect3><h4 id=current>24.5.1. Bijblijven met FreeBSD<a class=anchor href=#current></a></h4><div class=paragraph><p>Bedenk dat FreeBSD-CURRENT het "nieuwste van het nieuwste" is van FreeBSD ontwikkeling. Van FreeBSD-CURRENT gebruikers wordt verwacht dat ze veel technische kennis hebben en capabel zijn om zelfstandig lastige systeemproblemen op te lossen. Nieuwe gebruikers van FreeBSD kunnen het beste twee keer nadenken alvorens het te installeren.</p></div><div class=sect4><h5 id=_wat_is_freebsd_current>24.5.1.1. Wat is FreeBSD-CURRENT?<a class=anchor href=#_wat_is_freebsd_current></a></h5><div class=paragraph><p>FreeBSD-CURRENT is de laatste werkende set broncode voor FreeBSD. Dit bevat werk in uitvoering, experimentele wijzigingen en overgangsmechanismes die mogelijk wel of niet meegenomen worden in de volgende officiële uitgave van het besturingssysteem. Alhoewel veel FreeBSD-ontwikkelaars de broncode van FreeBSD-CURRENT dagelijks compileren, zijn er periodes dat de broncode niet compileerbaar is. Deze problemen worden zo snel mogelijk gerepareerd, maar het is mogelijk dat FreeBSD-CURRENT een ramp veroorzaakt in plaats van dat het de gewenste functionaliteit levert. Dit ligt geheel aan het moment waarop de broncode is opgehaald.</p></div></div><div class=sect4><h5 id=_wie_heeft_freebsd_current_nodig>24.5.1.2. Wie heeft FreeBSD-CURRENT nodig?<a class=anchor href=#_wie_heeft_freebsd_current_nodig></a></h5><div class=paragraph><p>FreeBSD-CURRENT is beschikbaar voor drie primaire aandachtsgroepen:</p></div><div class="olist arabic"><ol class=arabic><li><p>Leden van de FreeBSD-gemeenschap die actief werken aan een deel van de broncode voor wie "current" een echte eis is.</p></li><li><p>Leden van de FreeBSD-gemeenschap die actief testen en tijd hebben om problemen op te lossen om zeker te stellen dat FreeBSD-CURRENT zo gezond als mogelijk is. Er zijn ook mensen die actuele suggesties maken over wijzigingen en de algemene richting van FreeBSD en die patches opsturen om deze te implementeren.</p></li><li><p>Diegenen die alleen een oogje in het zeil willen houden of de huidige bronnen gebruiken ter referentie (bijvoorbeeld voor het <em>lezen</em> en niet het draaien). Deze mensen geven ook regelmatig commentaar of dragen bij in de code.</p></li></ol></div></div><div class=sect4><h5 id=_wat_is_freebsd_current_niet>24.5.1.3. Wat is FreeBSD-CURRENT <em>niet</em>?<a class=anchor href=#_wat_is_freebsd_current_niet></a></h5><div class="olist arabic"><ol class=arabic><li><p>Een snelle manier om pre-release versies te krijgen omdat bekend is dat er een aantal leuke nieuwe mogelijkheden in zitten en het leuk is deze als eerste te gebruiken. Het als eerste gebruiken van nieuwe mogelijkheden betekent ook de eerste zijn die nieuwe bugs ontdekt.</p></li><li><p>Een snelle manier om bugfixes te krijgen. Elke willekeurige versie van FreeBSD-CURRENT heeft waarschijnlijk net zoveel nieuwe bugs als dat er bugs opgelost zijn.</p></li><li><p>Op welke manier dan ook "officieel ondersteund". We doen onze best om mensen echt te helpen in één van de drie "legitieme" FreeBSD-CURRENT groepen maar er is simpelweg <em>niet genoeg tijd</em> om technische ondersteuning te leveren. Dit is niet omdat we gemene en vervelende mensen zijn die anderen niet willen helpen (we zouden niet eens aan FreeBSD werken als we dat durfden). De ontwikkelaars kunnen simpelweg geen honderd berichten per dag beantwoorden <em>én</em> aan FreeBSD werken. Bij de keuze tussen het verbeteren van FreeBSD en vragen beantwoorden over experimentele code, kiezen ontwikkelaars voor het eerste.</p></li></ol></div></div><div class=sect4><h5 id=_freebsd_current_gebruiken>24.5.1.4. FreeBSD-CURRENT gebruiken<a class=anchor href=#_freebsd_current_gebruiken></a></h5><div class="olist arabic"><ol class=arabic><li><p>Neem een abonnement op de mailinglijsten <a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT mailinglijst</a> en <a href=https://lists.FreeBSD.org/subscription/svn-src-head>SVN-commitberichten voor de src-structuur voor head/-current</a>. Dit is niet alleen een goed idee, het is <em>essentieel</em>. Geen berichten ontvangen van de lijst <em><a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT mailinglijst</a></em> betekent geen commentaar zien dat mensen maken over de huidige staat van het systeem en dus waarschijnlijk struikelen over problemen die anderen al gevonden en opgelost hebben. Nog belangrijker is het missen van belangrijke informatie die kritisch kan zijn voor een systeem.</p><div class=paragraph><p>De lijst <a href=https://lists.FreeBSD.org/subscription/svn-src-head>SVN-commitberichten voor de src-structuur voor head/-current</a> biedt de mogelijkheid de wijzigingsboodschap te zien voor elke wijziging die gemaakt wordt, samen met relevante informatie over mogelijke bijwerkingen.</p></div><div class=paragraph><p>Ga om op deze lijsten of één van de andere beschikbare lijsten te abonneren naar <a href=https://lists.freebsd.org class=bare>https://lists.freebsd.org</a> en klik op de gewenste lijst. Instructies over de rest van de procedure zijn daar beschikbaar. Als u geïnteresseerd bent in het volgen van veranderingen voor de gehele broncodeboom, raden wij u aan een abonnement te nemen op de lijst <a href=https://lists.FreeBSD.org/subscription/svn-src-all>SVN-commitberichten voor de gehele src-structuur (behalve voor "user" en "projects")</a>.</p></div></li><li><p>Haal de broncode van een FreeBSD <a href=./#mirrors>mirrorsite</a>. Dit kan op de volgende twee manieren:</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>Gebruik het programma <a href=./#cvsup>cvsup</a> met de <span class=filename>supfile</span> genaamd <span class=filename>standard-supfile</span> uit <span class=filename>/usr/shared/examples/cvsup</span>. Dit is de geadviseerde methode, omdat de gehele collectie in één keer wordt binnengehaald en daarna alleen hetgeen wat gewijzigd is. Veel mensen draaien <code>cvsup</code> vanuit de <code>cron</code> en houden daarmee hun broncode automatisch bijgewerkt. De voorbeeld <span class=filename>supfile</span> dient aangepast te worden om <a href=./#cvsup>cvsup</a> in te stellen voor uw omgeving.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het voorbeeld <span class=filename>standard-supfile</span> is bedoeld om een specifieke beveiligingstak van FreeBSD te volgen, niet FreeBSD-CURRENT. U moet dit bestand bewerken en de volgende regel vervangen:</p></div><div class="literalblock programlisting"><div class=content><pre>*default release=cvs tag=RELENG_X_Y</pre></div></div><div class=paragraph><p>door deze:</p></div><div class="literalblock programlisting"><div class=content><pre>*default release=cvs tag=.</pre></div></div><div class=paragraph><p>Voor een gedetailleerde uitleg over bruikbare tags wordt naar de sectie <a href=./#cvs-tags>CVS Tags</a> van het Handboek verwezen.</p></div></td></tr></tbody></table></div></li><li><p>Gebruik de faciliteit CTM. Bij een "slechte verbinding", dure connecties of alleen e-mail toegang, is CTM een optie. Het werkt echter lastig en geeft mogelijk corrupte bestanden. Dit zorgt ervoor dat het zelden gebruikt wordt, dat de kans verhoogt dat het niet werkt voor redelijk lange periodes. Het advies is CVSup te gebruiken.</p></li></ol></div></li><li><p>Als de broncode wordt opgehaald om te draaien en niet alleen om naar te kijken, haal dan <em>alles</em> op van FreeBSD-CURRENT en niet alleen geselecteerde delen. De reden hiervoor is dat verschillende delen van de code afhangen van updates op andere plekken en het compileren van een onderdeel gegarandeerd problemen oplevert.</p><div class=paragraph><p>Voordat FreeBSD-CURRENT gecompileerd wordt is het raadzaam om de <span class=filename>Makefile</span> in <span class=filename>/usr/src</span> aandachtig te bekijken. Het is handig om de eerste keer op zijn minst <a href=#makeworld>de kernel en de "wereld" opnieuw te bouwen</a> als onderdeel van het updateproces. Via de <a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT mailinglijst</a> en <span class=filename>/usr/src/UPDATING</span> is het mogelijk op de hoogte te blijven van mogelijke wijzigingen in de opstartprocedures die soms nodig zijn tussen verschillende versies.</p></div></li><li><p>Wees actief! Ervaringen van FreeBSD-CURRENT-gebruikers zijn belangrijk, zeker als het gaat om suggesties voor verbeteringen of bugfixes. Suggesties met bijbehorende code worden enthousiast ontvangen!</p></li></ol></div></div></div><div class=sect3><h4 id=stable>24.5.2. FreeBSD stabiel houden<a class=anchor href=#stable></a></h4><div class=sect4><h5 id=_wat_is_freebsd_stable>24.5.2.1. Wat is FreeBSD-STABLE?<a class=anchor href=#_wat_is_freebsd_stable></a></h5><div class=paragraph><p>FreeBSD-STABLE is de ontwikkeltak waaruit grote releases gemaakt worden. Wijzigingen in deze tak gaan in een ander tempo en met de algemene aanname dat ze eerst in FreeBSD-CURRENT worden ingebracht ter test. Dit is <em>nog steeds</em> een ontwikkeltak, echter dit betekent dat op elk gegeven moment de code voor FreeBSD-STABLE wel of niet geschikt is voor een speciaal doel. Het is simpelweg een andere ontwikkelomgeving en geen bron voor eindgebruikers.</p></div></div><div class=sect4><h5 id=_wie_heeft_freebsd_stable_nodig>24.5.2.2. Wie heeft FreeBSD-STABLE nodig?<a class=anchor href=#_wie_heeft_freebsd_stable_nodig></a></h5><div class=paragraph><p>Bij interesse in het bijhouden van of bijdragen aan het FreeBSD-ontwikkelproces, speciaal als het gerelateerd is aan de volgende versie van FreeBSD, is het volgen van FreeBSD-STABLE het overwegen waard.</p></div><div class=paragraph><p>Ondanks dat security fixes ook in de FreeBSD-STABLE-tak komen, hoeft dit <em>niet</em> per se. In elke beveiligingswaarschuwing voor FreeBSD wordt uitgelegd uit hoe het probleem opgelost kan worden voor de release die het betreft. Het volgen van de volledige ontwikkeltak alleen om veiligheidsredenen levert ongetwijfeld ongewenste wijzigingen op.</p></div><div class=paragraph><p>Ondanks het voornemen ervoor te zorgen dat de FreeBSD-STABLE-tak compileert en altijd draait, wordt dit niet gegarandeerd. Terwijl code ontwikkeld wordt in FreeBSD-CURRENT voordat die in FreeBSD-STABLE verwerkt wordt, draaien meer mensen FreeBSD-STABLE dan FreeBSD-CURRENT, dus het is onontkoombaar dat bugs en randgevallen soms in FreeBSD-STABLE gevonden worden die niet in FreeBSD-CURRENT bekend waren.</p></div><div class=paragraph><p>Om deze redenen wordt <em>niet</em> aangeraden FreeBSD-STABLE blindelings te volgen en het is extra belangrijk geen productieservers bij te werken naar FreeBSD-STABLE zonder de code te testen in een testomgeving.</p></div><div class=paragraph><p>Als de mogelijkheden om dit te doen niet beschikbaar zijn, dan is het advies de meest recente release van FreeBSD te draaien en dan de binaire update methode te hanteren om bij te werken tussen verschillende releases.</p></div></div><div class=sect4><h5 id=_freebsd_stable_gebruiken>24.5.2.3. FreeBSD-STABLE gebruiken<a class=anchor href=#_freebsd_stable_gebruiken></a></h5><div class="olist arabic"><ol class=arabic><li><p>Neem een abonnement op de lijst <a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; mailinglijst</a>. Deze biedt informatie over onderdelen van de build die mogelijk verschijnen in FreeBSD-STABLE of eventuele andere kwesties die speciale aandacht vereisen. Ontwikkelaars kondigen in deze mailinglijst ook aan wanneer ze overwegen om een controversiële fix of aanpassing willen maken, waardoor de gebruikers een kans hebben om te reageren als ze goede redenen hebben tegen de voorgestelde wijziging.</p><div class=paragraph><p>Wordt lid van de relevante SVN-lijst voor de tak die u volgt. Als u bijvoorbeeld de tak 7-STABLE volgt, wordt u lid van de <a href=https://lists.FreeBSD.org/subscription/svn-src-stable-7>svn-src-stable-7</a> lijst. Dit stelt u in staat om het commit-log-bericht te bekijken voor elke verandering die is gemaakt, tezamen met relevante informatie over mogelijke bijwerkingen.</p></div><div class=paragraph><p>Ga om te abonneren op deze lijsten, of één van de andere beschikbare lijsten naar <a href=https://lists.freebsd.org class=bare>https://lists.freebsd.org</a> en klik op de lijst waarop een abonnement gewenst is. Instructies over de rest van de procedure zijn daar beschikbaar. Als u geïnteresseerd bent in het volgen van veranderingen voor de gehele broncodeboom, raden wij u aan een abonnement te nemen op de <a href=https://lists.FreeBSD.org/subscription/svn-src-all>SVN-commitberichten voor de gehele src-structuur (behalve voor "user" en "projects")</a> lijst.</p></div></li><li><p>Kijk op de webpagina <a href=https://www.FreeBSD.org/snapshots/>Snapshots</a> om een systeem te installeren van een maandelijkse snapshot van FreeBSD-STABLE. Het is ook mogelijk om de meest recente FreeBSD-STABLE release te installeren van de <a href=./#mirrors>mirrorsites</a>. Volg de onderstaande instructies om een systeem bij te werken naar de meest recente FreeBSD-STABLE broncode.</p><div class=paragraph><p>Als al een vorige release van FreeBSD draait en bijgewerkt moet worden via de broncodes dan kan dat via de FreeBSD <a href=./#mirrors>mirrorsites</a>. Dit kan op één van de twee volgende manieren:</p></div><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>Gebruik het programma <a href=./#cvsup>cvsup</a> met de <span class=filename>supfile</span> <span class=filename>stable-supfile</span> uit de map <span class=filename>/usr/shared/examples/cvsup</span>. Dit is de aanbevolen methode omdat het hiermee mogelijk is de volledige collectie te downloaden en daarna alleen hetgeen wat veranderd is. Veel mensen draaien <code>cvsup</code> vanuit de <code>cron</code> om de broncodes automatisch bij te werken. Het voorbeeld van de <span class=filename>supfile</span> dient aangepast en ingesteld te worden voor de omgeving waarin het instellingenbestand gebruikt wordt.</p></li><li><p>Gebruik CTM als er geen snelle, goedkope verbinding is met internet. Dan is dit de methode om te gebruiken.</p></li></ol></div></li><li><p>Als er snelle on-demand toegang nodig is tot de broncode en bandbreedte is geen overweging, gebruik dan <code>cvsup</code> of <code>ftp</code>. Gebruik anders CTM.</p></li><li><p>Lees alvorens FreeBSD-STABLE te compileren goed de <span class=filename>Makefile</span> in <span class=filename>/usr/src</span>. Het is handig om de eerste keer op zijn minst <a href=#makeworld>de kernel en de "wereld" opnieuw te bouwen</a> als onderdeel van het updateproces. Via de <a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; mailinglijst</a> en <span class=filename>/usr/src/UPDATING</span> is het mogelijk op de hoogte te blijven van mogelijke wijzigingen in de opstartprocedures die soms nodig zijn tussen verschillende releases.</p></li></ol></div></div></div></div><div class=sect2><h3 id=synching>24.6. Broncode synchroniseren<a class=anchor href=#synching></a></h3><div class=paragraph><p>Er zijn verschillende manieren om een internet (of e-mail) verbinding te gebruiken om bij te blijven met elk onderdeel van de FreeBSD projectbronnen of alle onderdelen, afhankelijk van het interessegebied. De primaire diensten zijn <a href=./#anoncvs>Anonieme CVS</a> en <a href=./#ctm>CTM</a>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ondanks dat het mogelijk is om alleen delen van de broncode bij te werken, is de enige ondersteunde methode de totale broncode bijwerken en zowel userland (alle programma’s die in gebruikersruimte draaien, zoals programma’s in <span class=filename>/bin</span> en <span class=filename>/sbin</span>) als de kernel opnieuw compileren. Als alleen delen van de broncode worden bijgewerkt, alleen de kernel of alleen het userland, resulteert dat vaak in problemen. Deze problemen kunnen verschillen van compileerfouten tot kernel panics of corruptie van gegevens.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Anonieme CVS en CVSup gebruiken het <em>pull</em> model om broncode bij te werken. In het geval van CVSup start de gebruiker (of een <code>cron</code> script) het programma <code>cvsup</code> waarbij het communiceert met een <code>cvsupd</code> server om bestanden bij te werken. De ontvangen updates zijn op de minuut nauwkeurig en ze komen alleen wanneer dat is ingesteld. Updates kunnen eenvoudig beperkt worden tot specifieke bestanden of mappen uit een interessegebied. Updates worden automatisch gegenereerd door een server, aan de hand van wat is ingesteld. Anonieme CVS is veel eenvoudiger dan CVSup omdat dat alleen een uitbreiding is van CVS die de mogelijkheid biedt om wijzigingen direct van een CVS repository op afstand te halen. CVSup kan dit veel efficiënter doen, maar anonieme CVS is makkelijker in het gebruik.</p></div><div class=paragraph><p>CTM aan de andere kant maakt geen vergelijking tussen de aanwezige bronnen en die op de master server. In plaats daarvan wordt een script uitgevoerd dat wijzigingen in bestanden ziet sinds de vorige keer dat is bijgewerkt en die meerdere keren per dag worden uitgevoerd op de master CTM machine. Elke ontdekte wijziging wordt gecomprimeerd, krijgt een volgnummer toegekend en wordt gecodeerd voor verzending via e-mail (in leesbare ASCII). Deze "CTM delta’s" kunnen dan aangeleverd worden aan <a href="https://man.freebsd.org/cgi/man.cgi?query=ctm_rmail&amp;sektion=1&amp;format=html">ctm_rmail(1)</a> die ze automatisch decodeert, controleert en toepast in de gebruikerskopie van de bronnen. Dit proces is veel efficiënter dan CVSup en claimt minder systeembronnen omdat het model <em>push</em> in plaats van <em>pull</em> is.</p></div><div class=paragraph><p>Er zijn andere nadelen. Als per ongeluk een deel van het archief wordt verwijderd, kan CVSup dat detecteren en het beschadigde deel repareren. CTM doet dit niet en als een deel van de broncode wordt verwijderd (en er geen back-up is), dan moet er opnieuw begonnen worden (vanaf de meest recente CVS "base delta" en moet alles opnieuw opgebouwd worden met CTM. Met Anonymous CVS kan simpelweg het slechte deel verwijderd worden alvorens weer te synchroniseren.</p></div></div><div class=sect2><h3 id=makeworld>24.7. De "wereld" opnieuw bouwen<a class=anchor href=#makeworld></a></h3><div class=paragraph><p>Zodra de lokale broncode gesynchroniseerd is met een bepaalde versie van FreeBSD (FreeBSD-STABLE, FreeBSD-CURRENT, enzovoort) kan de broncode gebruikt worden om een systeem te herbouwen.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Maak een back-up</div><div class=paragraph><p>Het kan niet vaak genoeg verteld worden hoe belangrijk het is om een back-up te maken van een systeem <em>vóór</em> deze taak uit te voeren. Ook al is het opnieuw bouwen van de wereld vrij simpel (als deze instructies gevolgd worden), er worden ongetwijfeld ooit fouten gemaakt, misschien zelfs in de broncode, die het onmogelijk maken om een systeem op te starten.</p></div><div class=paragraph><p>Wees ervan verzekerd dat er een back-up gemaakt is en dat er een reparatiediskette of cd-rom bij de hand is. Deze wordt waarschijnlijk nooit gebruikt maar "better safe than sorry".</p></div></td></tr></tbody></table></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Abonneer op de juiste mailinglijsten</div><div class=paragraph><p>De FreeBSD-STABLE en FreeBSD-CURRENT takken zijn van nature <em>in ontwikkeling</em>. Mensen die bijdragen aan FreeBSD zijn menselijk en foutjes ontstaan regelmatig.</p></div><div class=paragraph><p>Soms zijn deze foutjes onschadelijk, ze geven dan hooguit een nieuwe diagnostische waarschuwing weer. Maar de wijziging kan ook catastrofaal zijn en ervoor zorgen dat een systeem niet meer opstart of bestandssystemen vernietigt (of erger).</p></div><div class=paragraph><p>Als problemen zoals deze voorkomen wordt er een "heads up" naar de juiste mailinglijst gestuurd, waarin uitgelegd wordt wat het probleem is en welke systemen het raakt. Er wordt een "all clear" bericht gestuurd als het probleem is opgelost.</p></div><div class=paragraph><p>FreeBSD-STABLE of FreeBSD-CURRENT volgen zonder de <a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; mailinglijst</a> of <a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT mailinglijst</a> te volgen is vragen om problemen.</p></div></td></tr></tbody></table></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Gebruik geen <code>make world</code></div><div class=paragraph><p>Veel oudere documentatie raadt aan om <code>make world</code> te gebruiken. In dat geval worden er belangrijke stappen overgeslagen en gebruik het commando alleen als er voldoende kennis over aanwezig is. In bijna alle omstandigheden is <code>make world</code> verkeerd en de procedure die hier beschreven is hoort in plaats daarvan gebruikt te worden.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=canonical-build>24.7.1. De universele wijze om een systeem bij te werken<a class=anchor href=#canonical-build></a></h4><div class=paragraph><p>Om uw systeem bij te werken, dient u <span class=filename>/usr/src/UPDATING</span> te controleren op eventuele pre-buildworld stappen die nodig zijn voor uw versie van de broncode en daarna de procedure te gebruiken die hier beschreven staat.</p></div><div class=paragraph><p>Deze bijwerkstappen nemen aan dat u nu een oude versie van FreeBSD gebruikt, die uit een oude compiler, een oude kernel, een oude wereld en oude instellingenbestanden bestaat. Onder "wereld" worden de binairen, bibliotheken, en programmeerbestanden van het kernsysteem verstaan. De compiler is deel van "wereld", maar heeft enkele speciale aandachtspunten.</p></div><div class=paragraph><p>We nemen ook aan dat u reeds de broncode van een nieuwer systeem heeft verkregen. Bekijk, als de bronnen op een bepaald systeem ook oud zijn, <a href=#synching>Broncode synchroniseren</a> voor uitgebreide hulp over het synchroniseren ervan naar een nieuwere versie.</p></div><div class=paragraph><p>Het bijwerken van het systeem vanaf de broncode is wat subtieler dan het op het eerste gezicht lijkt, en de ontwikkelaars van FreeBSD vonden het in de loop der jaren nodig om de aangeraden methode redelijk drastisch te veranderen met het aan het licht komen van nieuwe soorten onontwijkbare afhankelijkheden. De rest van deze sectie beschrijft de rationale achter de huidige aanbevolen bijwerkmethode.</p></div><div class=paragraph><p>Elke succesvolle bijwerkmethode krijgt te maken met de volgende punten:</p></div><div class=ulist><ul><li><p>Het kan voorkomen dat de oude compiler de nieuwe kernel niet kan compileren. (Oude compilers bevatten soms bugs.) De nieuwe kernel dient dus met de nieuwe compiler gebouwd te worden. In het bijzonder moet de nieuwe compiler gebouwd worden voordat de nieuwe kernel gebouwd wordt. Dit betekent niet per se dat de nieuwe compiler <em>geïnstalleerd</em> moet worden voordat de nieuwe kernel gebouwd wordt.</p></li><li><p>De nieuwe wereld kan afhankelijk zijn van mogelijkheden van de nieuwe kernel. Dus moet de nieuwe kernel worden geïnstalleerd voordat de nieuwe wereld wordt geïnstalleerd.</p></li></ul></div><div class=paragraph><p>De eerste twee gevallen zijn de basis voor de methode <code>buildworld</code>, <code>buildkernel</code>, <code>installkernel</code>, <code>installworld</code> die we in de volgende paragrafen beschrijven. Dit is geen uitputtende lijst van alle redenen waarom het huidige aanbevolen bijwerkproces de voorkeur verdient. Wat minder voor de hand liggende redenen worden hieronder genoemd:</p></div><div class=ulist><ul><li><p>Het kan zijn dat de oude wereld niet correct draait op de nieuwe kernel, dus moet de nieuwe wereld onmiddellijk na het installeren van de nieuwe kernel geïnstalleerd worden.</p></li><li><p>Sommige instellingen moeten veranderd worden voordat de nieuwe wereld wordt geïnstalleerd, maar anderen kunnen de oude wereld kapot maken. Vandaar dat over het algemeen twee verschillende bijwerkstappen voor de instellingen nodig zijn.</p></li><li><p>Voor het grootste gedeelte houdt het bijwerkproces zich alleen bezig met het vervangen of toevoegen van bestanden; bestaande oude bestanden worden niet verwijderd. Dit kan in sommige gevallen problemen geven. Als een gevolg zal de bijwerkprocedure soms aangeven dat bepaalde bestanden tijdens bepaalde stappen handmatig verwijderd dienen te worden. Dit kan in de toekomst eventueel geautomatiseerd worden.</p></li></ul></div><div class=paragraph><p>Deze zorgen hebben tot het volgende aanbevolen bijwerkproces geleid. Merk op dat het gedetailleerde proces voor bepaalde updates aanvullende stappen nodig kan hebben, maar dit kernproces zou de komende tijd ongewijzigd moeten blijven:</p></div><div class="olist arabic"><ol class=arabic><li><p><code>make buildworld</code></p><div class=paragraph><p>Dit compileert eerst de nieuwe compiler en enkele aanverwante gereedschappen, daarna wordt de nieuwe compiler gebruikt om de rest van de nieuwe wereld te compileren. Het resultaat komt in <span class=filename>/usr/obj</span> te staan.</p></div></li><li><p><code>make buildkernel</code></p><div class=paragraph><p>In tegenstelling tot de oude aanpak, die <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> gebruikt, gebruikt dit de <em>nieuwe</em> compiler die in <span class=filename>/usr/obj</span> verblijft. Dit beschermt u tegen mismatches tussen de compiler en de kernel.</p></div></li><li><p><code>make installkernel</code></p><div class=paragraph><p>Plaatst de nieuwe kernel en kernelmodules op de schijf, waardoor het mogelijk wordt om met de nieuw bijgewerkte kernel op te starten.</p></div></li><li><p>Start opnieuw op in enkele-gebruikersmodus.</p><div class=paragraph><p>De enkele-gebruikersmodus minimaliseert problemen met het bijwerken van software die al draait. Het minimaliseert ook problemen die opduiken door een oude wereld op een nieuwe kernel te draaien.</p></div></li><li><p><code>mergemaster -p</code></p><div class=paragraph><p>Dit voert wat initiële updates aan instellingenbestanden uit ter voorbereiding op de nieuwe wereld. Het kan bijvoorbeeld nieuwe gebruikersgroepen aan het systeem, of nieuwe gebruikersnamen aan de wachtwoorddatabase toevoegen. Dit is vaak nodig wanneer er nieuwe groepen of speciale accounts voor systeemgebruikers zijn toegevoegd sinds de laatste keer bijwerken, zodat de stap <code>installworld</code> zonder problemen de nieuw geïnstalleerde namen van systeemgebruikers of systeemgroepen kan gebruiken.</p></div></li><li><p><code>make installworld</code></p><div class=paragraph><p>Kopieert de wereld van <span class=filename>/usr/obj</span>. U heeft nu een nieuwe kernel en een nieuwe wereld op schijf staan.</p></div></li><li><p><code>mergemaster</code></p><div class=paragraph><p>Nu kunt u de overgebleven instellingenbestanden bijwerken, aangezien u een nieuwe wereld op schijf heeft staan.</p></div></li><li><p>Start opnieuw op.</p><div class=paragraph><p>Een volledige nieuwe start van de machine is nodig om de nieuwe kernel en de nieuwe wereld met nieuwe instellingenbestanden te laden.</p></div></li></ol></div><div class=paragraph><p>Merk op dat als u van de ene uitgave van dezelfde tak van FreeBSD bijwerkt naar een recentere uitgave van dezelfde tak, i.e. van 7.0 naar 7.1, dat deze procedure dan niet absoluut nodig is, aangezien het onwaarschijnlijk is dat u serieuze problemen krijgt met de compiler, kernel, gebruikersland en instellingenbestanden. De oudere aanpak met <code>make world</code> gevolgd door het bouwen en installeren van een nieuwe kernel kan voor kleine updates goed genoeg zijn.</p></div><div class=paragraph><p>Maar mensen die deze procedure niet volgen tijdens het bijwerken tussen grote uitgaven kunnen wat problemen verwachten.</p></div><div class=paragraph><p>Het is ook goed om op te merken dat veel upgrades (i.e. 4.<em>X</em> naar 5.0) wat specifieke aanvullende stappen nodig hebben (bijvoorbeeld het hernoemen of verwijderen van specifieke bestanden voorafgaand aan installworld). Lees het bestand <span class=filename>/usr/src/UPDATING</span> zorgvuldig, met name het einde, waar het huidig aangeraden bijwerkproces expliciet wordt beschreven.</p></div><div class=paragraph><p>Deze procedure is in de loop der tijd veranderd aangezien de ontwikkelaars zagen dat het onmogelijk was om bepaalde mismatch-problemen volledig te voorkomen. Hopelijk blijft de huidige procedure voor een lange tijd stabiel.</p></div><div class=paragraph><p>Samengevat is de huidige aanbevolen manier om FreeBSD vanaf broncode bij te werken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make buildworld</span>
<span class=c># make buildkernel</span>
<span class=c># make installkernel</span>
<span class=c># shutdown -r now</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er zijn een aantal zeldzame gevallen waarin <code>mergemaster -p</code> nog een keer moet draaien voor de stap met <code>buildworld</code>. Deze staan beschreven in <span class=filename>UPDATING</span>. In het algemeen kan deze stap echter zonder risico worden overgeslagen als er niet tussen een of meer hoofdversies wordt bijgewerkt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Nadat <code>installkernel</code> succesvol is afgerond, dient er in single-user modus opgestart te worden (met <code>boot -s</code> vanaf de loaderprompt). Draai dan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -u /</span>
<span class=c># mount -a -t ufs</span>
<span class=c># adjkerntz -i</span>
<span class=c># mergemaster -p</span>
<span class=c># cd /usr/src</span>
<span class=c># make installworld</span>
<span class=c># mergemaster</span>
<span class=c># reboot</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Lees verdere uitleg</div><div class=paragraph><p>De hierboven beschreven volgorde is alleen een korte samenvatting. Ook de volgende secties lezen geeft een beter beeld van elke stap, met name als er een op maat gemaakte kernelinstelling wordt gebruikt.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=src-updating>24.7.2. <span class=filename>/usr/src/UPDATING</span> lezen<a class=anchor href=#src-updating></a></h4><div class=paragraph><p>Lees voor verder te gaan <span class=filename>/usr/src/UPDATING</span> (of het gelijknamige bestand waar de kopie van de broncode ook staat). Dit bestand kan belangrijke informatie bevatten over mogelijke problemen of specificeert de volgorde waarin bepaalde commando’s gestart moeten worden. Als <span class=filename>UPDATING</span> tegenstrijdig is met wat hier wordt beschreven, heeft <span class=filename>UPDATING</span> voorrang.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p><span class=filename>UPDATING</span> lezen is geen acceptabele vervanging voor het abonneren op de correcte mailinglijst zoals eerder beschreven. De twee vullen elkaar aan en zijn niet exclusief.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=make-conf>24.7.3. <span class=filename>/etc/make.conf</span> controleren<a class=anchor href=#make-conf></a></h4><div class=paragraph><p>Controleer <span class=filename>/usr/shared/examples/etc/make.conf</span> en <span class=filename>/etc/make.conf</span>. Het eerste bestand bevat standaard definities, waarvan de meeste uitgecommentarieerd zijn. Om hiervan gebruik te maken als het systeem opnieuw opgebouwd wordt vanuit de broncode, moeten ze toegevoegd worden aan <span class=filename>/etc/make.conf</span>. Bedenk dat alles wat toegevoegd wordt aan <span class=filename>/etc/make.conf</span> ook gebruikt wordt bij elk <code>make</code> commando. Het is dus verstandig om daar redelijke waardes in te vullen voor een systeem.</p></div><div class=paragraph><p>Een typische gebruiker wil waarschijnlijk de regel <code>NO_PROFILE</code> uit <span class=filename>/usr/shared/examples/etc/make.conf</span> kopiëren naar <span class=filename>/etc/make.conf</span> en het commentaar verwijderen.</p></div><div class=paragraph><p>Bekijk de andere definities, zoals <code>NOPORTDOCS</code> en bepaal of deze relevant zijn.</p></div></div><div class=sect3><h4 id=updating-etc>24.7.4. <span class=filename>/etc</span> bijwerken<a class=anchor href=#updating-etc></a></h4><div class=paragraph><p>De map <span class=filename>/etc</span> bevat een groot deel van de systeeminstellingen en scripts die gestart worden tijdens de systeemstart. Sommige van deze scripts verschillen van versie tot versie in FreeBSD.</p></div><div class=paragraph><p>Sommige van de instellingenbestanden worden dagelijks gebruikt voor het draaien van een systeem. In het bijzonder <span class=filename>/etc/group</span>.</p></div><div class=paragraph><p>Er zijn gevallen geweest waarbij het installatiegedeelte van <code>make installworld</code> een aantal gebruikersnamen of groepen verwachtte. Als er een upgrade wordt uitgevoerd is het waarschijnlijk dat deze gebruikers of groepen niet bestaan. Dit levert problemen op bij upgraden. In sommige gevallen controleert <code>make buildworld</code> of deze gebruikers of groepen bestaan.</p></div><div class=paragraph><p>Een voorbeeld hiervan is het toevoegen van de gebruiker <code>smmsp</code>. Gebruikers hadden een falend installatieproces toen <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a> probeerde om <span class=filename>/var/spool/clientmqueue</span> te creëren.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> kan in voorbereidende modus gedraaid worden als de optie <code>-p</code> wordt meegegeven. Dan worden alleen de bestanden vergeleken die essentieel zijn voor het succes van <code>buildworld</code> of <code>installworld</code>:</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>In "paranoide beheerdersmodus" kan er gecontroleerd worden welke bestanden op een systeem eigendom zijn van de groep die wordt hernoemd of verwijderd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># find / -group GID -print</span></code></pre></div></div><div class=paragraph><p>Dit commando toont alle bestanden die eigendom zijn van de groep <em>GID</em> (een groepsnaam of een numeriek groeps-ID).</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=makeworld-singleuser>24.7.5. Systeem naar single-user modus brengen<a class=anchor href=#makeworld-singleuser></a></h4><div class=paragraph><p>Het kan zijn dat een systeem in single-user modus gecompileerd moet worden. Buiten het duidelijke voordeel dat de operatie iets sneller verloopt, is het voordeel dat bij een herinstallatie van een systeem een aantal belangrijke systeembestanden waaronder binaire systeembestanden, bibliotheken, include bestanden, enzovoort, worden aangepast, iets wat op een actief systeem vragen om problemen is (zeker als er actieve gebruikers op een systeem aanwezig zijn).</p></div><div class=paragraph><p>Een andere methode is het systeem compileren in multi-user modus en daarna naar single-user modus gaan voor de installatie. Bij deze methode moeten de volgende stappen gevolgd worden. Het overschakelen naar single-user modus kan uitgesteld worden tot en met <code>installkernel</code> of <code>installworld</code>.</p></div><div class=paragraph><p>Een supergebruiker kan als volgt een draaiend systeem naar single-user modus overgeschakelen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown now</span></code></pre></div></div><div class=paragraph><p>Als alternatief kan tijdens het opstarten de optie <code>single user</code> worden gekozen. Het systeem start dan in single-user modus. Op de shell prompt moet dan worden ingegeven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fsck -p</span>
<span class=c># mount -u /</span>
<span class=c># mount -a -t ufs</span>
<span class=c># swapon -a</span></code></pre></div></div><div class=paragraph><p>Hierdoor worden de bestandssystemen gecontroleerd, <span class=filename>/</span> met lees en schrijf rechten opnieuw gemount, worden alle andere UFS bestandssystemen die in <span class=filename>/etc/fstab</span> staan gemount en wordt swap ingeschakeld.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als de CMOS-klok ingesteld is naar de lokale tijd en niet naar GMT (dit is waar als het resultaat van <a href="https://man.freebsd.org/cgi/man.cgi?query=date&amp;sektion=1&amp;format=html">date(1)</a> niet de correcte tijd en zone weergeeft), dan is het misschien handig om het volgende commando te starten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># adjkerntz -i</span></code></pre></div></div><div class=paragraph><p>Dit zorgt ervoor dat de lokale tijdzoneinstellingen correct ingesteld worden. Zonder deze instelling kunnen er later problemen ontstaan.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=cleaning-usr-obj>24.7.6. <span class=filename>/usr/obj</span> verwijderen<a class=anchor href=#cleaning-usr-obj></a></h4><div class=paragraph><p>Als delen van een systeem opnieuw gebouwd worden, worden ze standaard geplaatst in mappen onder <span class=filename>/usr/obj</span>. Deze mappen schaduwen de mappen onder <span class=filename>/usr/src</span>.</p></div><div class=paragraph><p>Het proces <code>make buildworld</code> kan versneld worden en problemen met afhankelijkheden kunnen voorkomen worden als deze map wordt verwijderd.</p></div><div class=paragraph><p>Sommige bestanden onder <span class=filename>/usr/obj</span> hebben mogelijk de optie "niet aanpassen" ingesteld (zie <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a>) die eerst verwijderd moet worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/obj</span>
<span class=c># chflags -R noschg *</span>
<span class=c># rm -rf *</span></code></pre></div></div></div><div class=sect3><h4 id=updating-upgrading-recompilebase>24.7.7. Broncode van het basissysteem hercompileren<a class=anchor href=#updating-upgrading-recompilebase></a></h4><div class=sect4><h5 id=_uitvoer_bewaren>24.7.7.1. Uitvoer bewaren<a class=anchor href=#_uitvoer_bewaren></a></h5><div class=paragraph><p>Het is een goed idee om de uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> te bewaren in een ander bestand. Als er iets misgaat is er een kopie van de foutmelding aanwezig. Hoewel dit misschien niet helpt in de diagnose van wat er fout is gegaan, kan het anderen helpen als het probleem wordt aangegeven in een FreeBSD mailinglijst.</p></div><div class=paragraph><p>De makkelijkste manier om dit te doen is door het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=script&amp;sektion=1&amp;format=html">script(1)</a> te gebruiken, met een parameter die de naam specificeert waar de uitvoer naartoe moet. Dit moet direct gedaan worden vóór het herbouwen van de wereld, zodat het proces klaar is moet <code>exit</code> worden ingegeven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># script /var/tmp/mw.out</span>
Script started, output file is /var/tmp/mw.out
<span class=c># make TARGET</span>
… compile, compile, compile …
<span class=c># exit</span>
Script <span class=k>done</span>, …</code></pre></div></div><div class=paragraph><p>Bewaar de uitvoer in deze stap <em>niet</em> in <span class=filename>/tmp</span>. Deze map wordt mogelijk opgeschoond tijdens de volgende herstart. Een betere plaats om dit bestand te bewaren is de map <span class=filename>/var/tmp</span> (zoals in het vorige voorbeeld) of in de thuismap van <code>root</code>.</p></div></div><div class=sect4><h5 id=make-buildworld>24.7.7.2. Basissysteem compileren<a class=anchor href=#make-buildworld></a></h5><div class=paragraph><p>Ga naar de map <span class=filename>/usr/src</span>, tenzij de broncode ergens anders staat, in welk geval naar die map gegaan moet worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span></code></pre></div></div><div class=paragraph><p>Om de wereld opnieuw te bouwen moet het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> gebruikt worden. Dit commando leest zijn instructies uit het bestand <span class=filename>Makefile</span>, dat beschrijft hoe de programma’s die samen FreeBSD vormen moeten worden gebouwd, in welke volgorde ze gebouwd moeten worden, enzovoort.</p></div><div class=paragraph><p>Het algemene formaat van de commandoregel die gebruikt moet worden is als volgt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -x -DVARIABELE doel</span></code></pre></div></div><div class=paragraph><p>In dit voorbeeld is de optie <code>-<em>x</em></code> een optie die wordt meegegeven aan <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a>. In de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> staat een voorbeeld van de opties die meegegeven kunnen worden.</p></div><div class=paragraph><p><code>-D_VARIABELE_</code> geeft een variabele door aan <span class=filename>Makefile</span>. Het gedrag van <span class=filename>Makefile</span> wordt beïnvloed door deze variabele. Dit zijn dezelfde variabelen die ingesteld worden in <span class=filename>/etc/make.conf</span>. Deze optie biedt een alternatief om deze opties in te stellen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DNO_PROFILE doel</span></code></pre></div></div><div class=paragraph><p>Het bovenstaande commando is een andere manier om aan te geven dat geprofileerde bibliotheken niet gebouwd moeten worden en correspondeert met de onderstaande regel in <span class=filename>/etc/make.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>NO_PROFILE=    true	#    Avoid compiling profiled libraries</pre></div></div><div class=paragraph><p><em>doel</em> geeft <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> aan wat er gedaan moet worden. Elke <span class=filename>Makefile</span> definieert een aantal van verschillende doelen en het gekozen doel bepaalt wat er gebeurt.</p></div><div class=paragraph><p>Sommige doelen staan vermeld in het bestand <span class=filename>Makefile</span>, maar zijn niet geschikt om direct te starten. Integendeel, deze worden gebruikt door het bouwproces om de benodigde stappen onder te verdelen.</p></div><div class=paragraph><p>In veel gevallen hoeven er geen parameters te worden meegegeven aan <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> en dus ziet de commando regel er als volgt uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make doel</span></code></pre></div></div><div class=paragraph><p>Waar <em>doel</em> een van de vele bouw opties is. De eerste target moet echter altijd <code>buildworld</code> zijn.</p></div><div class=paragraph><p>Zoals de namen impliceren bouwt <code>buildworld</code> een compleet nieuwe boom onder <span class=filename>/usr/obj</span> en <code>installworld</code>, een andere target, installeert deze boom op de huidige machine.</p></div><div class=paragraph><p>Het hebben van verschillende opties is handig om twee redenen. Als eerste biedt het de mogelijkheid om de bouw veilig te doen met de wetenschap dat geen enkel draaiend onderdeel van een systeem geraakt wordt. De bouw is "zelf ondersteunend". Hierdoor kan veilig in multi-user modus <code>buildworld</code> gedraaid worden. Het wordt echter nog steeds aangeraden om <code>installworld</code> in single-user modus te starten.</p></div><div class=paragraph><p>Ten tweede geeft het de mogelijkheid om NFS-mounts te gebruiken om meerdere machines in het netwerk bij te werken. Als er drie machines zijn, <code>A</code>, <code>B</code> en <code>C</code>, die bijgewerkt moeten worden, dan kunnen <code>make buildworld</code> en <code>make installworld</code> gedraaid worden op <code>A</code> waarna <code>B</code> en <code>C</code> een NFS-mount kunnen opzetten naar <span class=filename>/usr/src</span> en <span class=filename>/usr/obj</span> op machine <code>A</code> waarna <code>make installworld</code> gedraaid kan worden op <code>B</code> en <code>C</code> om de resultaten de installeren.</p></div><div class=paragraph><p>Alhoewel het doel <code>world</code> nog wel bestaat wordt het gebruik ervan sterk <em>afgeraden</em>.</p></div><div class=paragraph><p>Voer het volgende commando uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make buildworld</span></code></pre></div></div><div class=paragraph><p>Het is mogelijk om de optie <code>-j</code> mee te geven aan <code>make</code>, wat resulteert in meerdere processen die tegelijkertijd draaien. Dit heeft het meeste effect op machines met meerdere processoren. Echter, omdat het compilatieproces meer IO-gericht is dan processorgericht, kan het ook nuttig zijn op systemen met één processor.</p></div><div class=paragraph><p>Start als volgt op een systeem met één processor:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -j4 buildworld</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> draait dan maximaal 4 processen tegelijkertijd. In het algemeen blijkt uit de mailinglijsten dat dit de beste resultaten geeft.</p></div><div class=paragraph><p>Als er meerdere processoren in een systeem zitten en gebruik gemaakt wordt van een SMP kernel, probeer dan waardes tussen de 6 en 10 en bekijk hoe het systeem reageert.</p></div></div><div class=sect4><h5 id=_doorlooptijd>24.7.7.3. Doorlooptijd<a class=anchor href=#_doorlooptijd></a></h5><div class=paragraph><p>Veel factoren bepalen de doorlooptijd van het bouwen van een boom, maar redelijk recente machines doen er maar 1 tot 2 uur over om de FreeBSD-STABLE boom te bouwen. zonder extra trucjes. Een FreeBSD-CURRENT boom kan wat langer duren.</p></div></div></div><div class=sect3><h4 id=new-kernel>24.7.8. Nieuwe kernel compileren en installeren<a class=anchor href=#new-kernel></a></h4><div class=paragraph><p>Om volledig gebruik te maken van het nieuwe systeem moet de kernel opnieuw gecompileerd worden. Dit is bijna altijd nodig omdat sommige geheugenstructuren mogelijkerwijs veranderd zijn en programma’s als <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> niet werken totdat de kernel en de broncode dezelfde versie hebben.</p></div><div class=paragraph><p>De simpelste en makkelijkste manier om dit te doen is om een kernel te maken die gebaseerd is op <span class=filename>GENERIC</span>. Ondanks dat <span class=filename>GENERIC</span> mogelijk niet alle benodigde apparaten heeft voor een systeem, hoort het alles te bevatten dat nodig is om een systeem te starten in single-user modus. Dit is een goede test op de correcte werking van een nieuw systeem. Na het opstarten van <span class=filename>GENERIC</span> en een systeemcontrole kan erna een nieuwe kernel gebouwd worden gebaseerd op een aangepast kernelinstellingenbestand.</p></div><div class=paragraph><p>Op FreeBSD is het belangrijk om de <a href=#make-buildworld>wereld opnieuw te bouwen</a> voordat een nieuwe kernel gebouwd wordt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als een aangepaste kernel gemaakt moet worden en er reeds een instellingenbestand aanwezig is, gebruik dan <code>KERNCONF=MYKERNEL</code> als volgt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make buildkernel KERNCONF=MYKERNEL</span>
<span class=c># make installkernel KERNCONF=MYKERNEL</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Let op dat als <code>kern.securelevel</code> een waarde hoger dan 1 heeft <em>of</em> <code>noschg</code> of gelijksoortige opties geplaatst zijn op het binaire kernelbestand, is het misschien nodig om terug te gaan naar single-user modus om <code>installkernel</code> uit te voeren. In andere gevallen moet het mogelijk zijn om deze commando’s zonder problemen uit te voeren in multi-user modus. Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> voor meer informatie over <code>kern.securelevel</code> en <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a> voor informatie over diverse bestandsopties.</p></div></div><div class=sect3><h4 id=new-kernel-singleuser>24.7.9. Opnieuw opstarten in single-user modus<a class=anchor href=#new-kernel-singleuser></a></h4><div class=paragraph><p>Start met de instructies in <a href=#makeworld-singleuser>Systeem naar single-user modus brengen</a> in single-user modus op om te testen of de nieuwe kernel werkt.</p></div></div><div class=sect3><h4 id=post-installworld-updates>24.7.10. Nieuwe binaire systeembestanden installeren<a class=anchor href=#post-installworld-updates></a></h4><div class=paragraph><p>Na het draaien van <code>make buildworld</code> kan nu <code>installworld</code> gebruikt worden om de nieuwe binaire systeembestanden te installeren.</p></div><div class=paragraph><p>Voer de volgende commando’s uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make installworld</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als er variabelen gespecificeerd zijn op de commandoregel van <code>make buildworld</code> moeten dezelfde variabelen gebruikt worden op de commandoregel van <code>make installworld</code>. Dit is niet per se waar voor opties zoals <code>-j</code>, die nooit gebruikt mogen worden met <code>installworld</code>.</p></div><div class=paragraph><p>Als bijvoorbeeld het volgende commando is uitgevoerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DNO_PROFILE buildworld</span></code></pre></div></div><div class=paragraph><p>Dan moet het resultaat geïnstalleerd worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DNO_PROFILE installworld</span></code></pre></div></div><div class=paragraph><p>Anders wordt geprobeerd geprofileerde bibliotheken te installeren die niet gebouwd zijn tijdens de fase <code>make buildworld</code>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=make-installworld>24.7.11. Bestanden bijwerken die niet bijgewerkt zijn door <code>make installworld</code><a class=anchor href=#make-installworld></a></h4><div class=paragraph><p>Het herbouwen van de wereld werkt bepaalde mappen niet bij (in het bijzonder <span class=filename>/etc</span>, <span class=filename>/var</span> en <span class=filename>/usr</span>) met nieuwe of gewijzigde instellingenbestanden.</p></div><div class=paragraph><p>De simpelste manier om deze bestanden bij te werken is door <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> te gebruiken, maar het is ook mogelijk dit handmatig te doen. Welke manier er ook gekozen wordt, zorg er altijd voor dat een back-up van <span class=filename>/etc</span> beschikbaar is voor het geval er iets misgaat.</p></div><div class=sect4><h5 id=mergemaster>24.7.11.1. <code>mergemaster</code><a class=anchor href=#mergemaster></a></h5><div class=paragraph><p>Het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> is een Bourne script dat helpt bij het bepalen van de verschillen tussen de instellingenbestanden in <span class=filename>/etc</span> en de instellingenbestanden in de broncodeboom <span class=filename>/usr/src/etc</span>. Deze methode wordt aangeraden om instellingenbestanden van een systeem bijgewerkt te houden met de bestanden die in de broncodeboom staan.</p></div><div class=paragraph><p>Het programma wordt gestart met <code>mergemaster</code> op de commandoregel en geeft dan resultaten weer. <code>mergemaster</code> bouwt dan een tijdelijke root omgeving vanaf <span class=filename>/</span> en vult deze met diverse instellingenbestanden voor een systeem. Deze bestanden worden vergeleken met de bestanden die geïnstalleerd zijn op een systeem. Op dit punt worden de bestanden getoond die verschillen in het <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a>-formaat, met een <code>+</code> voor toegevoegde of gewijzigde regels en een <code>-</code> voor regels die verwijderd of vervangen zijn. In de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> staat meer informatie over de syntaxis van <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> en hoe bestandsverschillen getoond worden.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> toont dan elk bestand dat verschilt en op dit moment is er de mogelijkheid om of het nieuwe bestand te verwijderen (ofwel het tijdelijke bestand), het tijdelijke bestand te installeren zonder enige wijzigingen, het verwerken van het oude bestand in het nieuwe bestand of de resultaten van <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> nogmaals te tonen.</p></div><div class=paragraph><p>Als gekozen wordt om het tijdelijke bestand te verwijderen, geeft dit <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> aan dat het huidige bestand niet gewijzigd dient te worden en de nieuwe versie verwijderd kan worden. Deze optie wordt niet aangeraden, behalve als er geen reden is om het huidige bestand aan te passen. Op ieder moment kunnen hulpteksten getoond worden door <kbd>?</kbd> in te geven op de prompt van <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a>. Als een bestand wordt overgeslagen, dan wordt het weer getoond als alle overige bestanden verwerkt zijn.</p></div><div class=paragraph><p>Bij de keuze om het ongewijzigde tijdelijke bestand te installeren wordt het huidige bestand vervangen door het nieuwe. Voor de meeste ongewijzigde bestanden is dit de beste optie.</p></div><div class=paragraph><p>Als ervoor gekozen wordt om de wijzigingen te verwerken wordt er een tekstverwerker gestart die de inhoud van beide bestanden toont. De verschillen kunnen verwerkt worden terwijl beide bestanden naast elkaar op het scherm staan. Hier kunnen delen gekozen worden die gezamenlijk een nieuw bestand opleveren. Als de bestanden zij aan zij vergeleken worden, wordt met de toets <kbd>l</kbd> de inhoud links geselecteerd en met de toets <kbd>r</kbd> de inhoud rechts geselecteerd. Het eindresultaat bestaat uit delen van beide bestanden die erna geinstalleerd kunnen worden. Deze optie wordt voornamelijk gebruikt voor bestanden die gewijzigd zijn door de beheerder.</p></div><div class=paragraph><p>Als ervoor gekozen wordt om de <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> resultaten nog een keer te tonen, worden dezelfde verschillen getoond zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> deed voordat een optie gevraagd werd.</p></div><div class=paragraph><p>Zodra <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> klaar is met de systeembestanden worden er andere opties getoond. <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> kan vragen of het wachtwoordbestand opnieuw gebouwd moet worden. Als laatste wordt een optie getoond om alle overgebleven tijdelijke bestanden te verwijderen.</p></div></div><div class=sect4><h5 id=_handmatig_bijwerken>24.7.11.2. Handmatig bijwerken<a class=anchor href=#_handmatig_bijwerken></a></h5><div class=paragraph><p>Bij handmatig bijwerken kunnen de bestanden van <span class=filename>/usr/src/etc</span> niet zomaar naar <span class=filename>/etc</span> gekopieerd worden om een werkend systeem te krijgen. Sommige van deze bestanden moeten eerst "geïnstalleerd" worden. Dit omdat de map <span class=filename>/usr/src/etc</span><em>geen</em> kopie is van <span class=filename>/etc</span>. Daarnaast staan er in <span class=filename>/etc</span> bestanden die niet in <span class=filename>/usr/src/etc</span> staan.</p></div><div class=paragraph><p>Als <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> gebruikt wordt (zoals aangeraden), kan doorgegaan worden met het <a href=#updating-upgrading-rebooting>volgende onderdeel</a>.</p></div><div class=paragraph><p>De simpelste manier om met de hand bij te werken, is de bestanden in een nieuwe map installeren en daarna naar verschillen tussen de bestanden te zoeken.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Back-up maken van <span class=filename>/etc</span></div><div class=paragraph><p>Ondanks dat, in theorie, niets in deze map automatisch wordt aangepast, is het altijd beter om daar zeker van te zijn. Dus kopieer de bestaande <span class=filename>/etc</span> naar een veilige locatie. Zoals bijvoorbeeld met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp -Rp /etc /etc.old</span></code></pre></div></div><div class=paragraph><p><code>-R</code> maakt een recursieve kopie, <code>-p</code> bewaart tijden, eigenaarschap, enzovoorts op bestanden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Er moet een dummyset van mappen gemaakt worden om de nieuwe <span class=filename>/etc</span> en andere bestanden in te installeren. <span class=filename>/var/tmp/root</span> is een redelijke keuze en er zijn hier een aantal benodigde submappen aanwezig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/tmp/root</span>
<span class=c># cd /usr/src/etc</span>
<span class=c># make DESTDIR=/var/tmp/root distrib-dirs distribution</span></code></pre></div></div><div class=paragraph><p>Dit maakt de benodigde mappenstructuur en installeert de bestanden. Een groot deel van de submappen die gemaakt zijn in <span class=filename>/var/tmp/root</span> zijn leeg en moeten verwijderd worden. De simpelste manier om dit te doen is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /var/tmp/root</span>
<span class=c># find -d . -type d | xargs rmdir 2&gt;/dev/null</span></code></pre></div></div><div class=paragraph><p>Dit verwijderd alle lege mappen. De standaardfout wordt omgeleid naar <span class=filename>/dev/null</span> om waarschuwingen te voorkomen over mappen die niet leeg zijn.</p></div><div class=paragraph><p><span class=filename>/var/tmp/root</span> bevat nu alle bestanden die geplaatst zouden moeten worden op de juiste locaties in <span class=filename>/</span>. Er moet nu in de bestanden gekeken worden om te bepalen of deze verschillen met de huidige betanden.</p></div><div class=paragraph><p>Let op dat sommige van de bestanden die geïnstalleerd zijn in <span class=filename>/var/tmp/root</span> beginnen met een ".". Op het moment van schrijven hebben alleen shell opstartscripts in <span class=filename>/var/tmp/root</span> en <span class=filename>/var/tmp/root/root</span> dit, maar er kunnen ook andere zijn. Zorg ervoor dat <code>ls -a</code> gebruikt wordt om deze bestanden te zien.</p></div><div class=paragraph><p>De simpelste manier om twee bestanden te vergelijken is <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># diff /etc/shells /var/tmp/root/etc/shells</span></code></pre></div></div><div class=paragraph><p>Dit toont de verschillen tussen de huidige <span class=filename>/etc/shells</span> en de nieuwe <span class=filename>/var/tmp/root/etc/shells</span>. Gebruik dit om te bepalen of de wijzigingen gemigreerd moeten worden of dat het oude bestand gekopieërd moet worden.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=title>Voeg aan de naam van de nieuwe rootmap (<span class=filename>/var/tmp/root</span>) een tijdsindicatie toe zodat makkelijk verschillen tussen versies bepaald kunnen worden</div><div class=paragraph><p>Als de wereld regelmatig wordt herbouwd moeten bestanden in <span class=filename>/etc</span> ook regelmatig bijgewerkt moeten worden, wat een vervelend werkje kan zijn.</p></div><div class=paragraph><p>Dit proces kan versneld worden door een kopie te bewaren van de bestanden die gemigreerd zijn naar <span class=filename>/etc</span>. De volgende procedure geeft een idee over hoe dit gedaan kan worden.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Maak de wereld zoals normaal. Als <span class=filename>/etc</span> en de andere mappen bijgewerkt moeten worden, geef dan de doelmap een naam gebaseerd op de huidige datum. Op 14 februari 1998 wordt dat als volgt gedaan:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/tmp/root-19980214</span>
<span class=c># cd /usr/src/etc</span>
<span class=c># make DESTDIR=/var/tmp/root-19980214 \</span>
    distrib-dirs distribution</code></pre></div></div></li><li><p>Migreer de wijzigingen van deze map zoals hierboven beschreven.</p><div class=paragraph><p>Verwijder de map <span class=filename>/var/tmp/root-19980214</span><em>niet</em> na afronden.</p></div></li><li><p>Als de laatste versie van de broncode gedownload en opnieuw gemaakt is, volg stap 1. Dit geeft een nieuwe map die wellicht <span class=filename>/var/tmp/root-19980221</span> heet (als er een week zit tussen het bijwerken).</p></li><li><p>De verschillen die gemaakt zijn in de tussenliggende week kunnen nu getoond worden door met <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> een recursieve diff te maken tussen de twee mappen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /var/tmp</span>
<span class=c># diff -r root-19980214 root-19980221</span></code></pre></div></div><div class=paragraph><p>Vaak is dit een kleinere set aan verschillen dan tussen <span class=filename>/var/tmp/root-19980221/etc</span> en <span class=filename>/etc</span>. Omdat de set verschillen kleiner is, is het makkelijker om deze te migreren naar de map <span class=filename>/etc</span>.</p></div></li><li><p>De oudste van de twee <span class=filename>/var/tmp/root-*</span>-mappen kan nu verwijderd worden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rm -rf /var/tmp/root-19980214</span></code></pre></div></div></li><li><p>Herhaal dit proces elke keer als er wijzigingen gemigreerd moeten worden naar <span class=filename>/etc</span>.</p></li></ol></div></div></div><div class=paragraph><p>Met <a href="https://man.freebsd.org/cgi/man.cgi?query=date&amp;sektion=1&amp;format=html">date(1)</a> kan het maken van de mappen geautomatiseerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/tmp/root-`date &#34;+%Y%m%d&#34;`</span></code></pre></div></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=updating-upgrading-rebooting>24.7.12. Herstarten<a class=anchor href=#updating-upgrading-rebooting></a></h4><div class=paragraph><p>Dit was het. Na een controle of alles op de juiste plaats staat kan het systeem herstart worden. Dan kan met een simpele <a href="https://man.freebsd.org/cgi/man.cgi?query=shutdown&amp;sektion=8&amp;format=html">shutdown(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown -r now</span></code></pre></div></div></div><div class=sect3><h4 id=_klaar>24.7.13. Klaar<a class=anchor href=#_klaar></a></h4><div class=paragraph><p>Het FreeBSD systeem is nu succesvol bijgewerkt. Gefeliciteerd!</p></div><div class=paragraph><p>Als er dingen misgingen is het makkelijk om een deel van het systeem opnieuw te bouwen. Als bijvoorbeeld per ongeluk <span class=filename>/etc/magic</span> verwijderd is als onderdeel van de upgrade of door het samenvoegen van <span class=filename>/etc</span>, dan werkt <a href="https://man.freebsd.org/cgi/man.cgi?query=file&amp;sektion=1&amp;format=html">file(1)</a> niet meer. Dat kan als volgt opgelost worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/usr.bin/file</span>
<span class=c># make all install</span></code></pre></div></div></div><div class=sect3><h4 id=updating-questions>24.7.14. Vragen<a class=anchor href=#updating-questions></a></h4><div class=sect4><h5 id=_moet_de_wereld_opnieuw_gemaakt_worden_voor_elke_wijziging>24.7.14.1. Moet de wereld opnieuw gemaakt worden voor elke wijziging?<a class=anchor href=#_moet_de_wereld_opnieuw_gemaakt_worden_voor_elke_wijziging></a></h5><div class=paragraph><p>Op deze vraag bestaat geen eenvoudig antwoord, omdat dit afhangt van de aard van de wijziging. Als bijvoorbeeld net CVSup is gedraaid en de onderstaande bestanden zijn bijgewerkt, dan is het waarschijnlijk niet de moeite waard om de volledige wereld te herbouwen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>src/games/cribbage/instr.c
src/games/sail/pl_main.c
src/release/sysinstall/config.c
src/release/sysinstall/media.c
src/shared/mk/bsd.port.mk</code></pre></div></div><div class=paragraph><p>Dan is het handiger om naar de juiste submappen te gaan, daar <code>make all install</code> uit te voeren en dat is het zo’n beetje. Maar als er iets wezenlijks is veranderd, bijvoorbeeld <span class=filename>src/lib/libc/stdlib</span>, dan dient ofwel de wereld herbouwd te worden of tenminste die delen die statisch gelinkt zijn (en ook al het andere dat statisch gelinkt is en onderdeel is van een systeem).</p></div><div class=paragraph><p>Uiteindelijk beslist een beheerder zelf. Misschien vindt die het prettig iedere twee weken de wereld te herbouwen terwijl de wijzigingen in die twee weken binnenkomen. Een andere beheerder herbouwt alleen die onderdelen die veranderd zijn en vertrouwt erop dat hij alle afhankelijkheden in de gaten heeft.</p></div><div class=paragraph><p>Natuurlijk hangt het ook af van de keuze hoe vaak het wenselijk is bij te werken en of FreeBSD-STABLE of FreeBSD-CURRENT wordt bijgehouden.</p></div></div><div class=sect4><h5 id=_het_compileren_gaat_fout_met_veel_meldingen_van_signal_11signal_11_of_andere_signalnummers_wat_is_er_aan_de_hand>24.7.14.2. Het compileren gaat fout met veel meldingen van signal 11signal 11 (of andere signalnummers). Wat is er aan de hand?<a class=anchor href=#_het_compileren_gaat_fout_met_veel_meldingen_van_signal_11signal_11_of_andere_signalnummers_wat_is_er_aan_de_hand></a></h5><div class=paragraph><p>Dit wijst meestal op hardwareproblemen. Het (her)bouwen van de wereld is een prima manier om een stresstest op hardware uit te voeren en hierdoor komen vaak geheugenproblemen bovendrijven. Die resulteren vaak in een compiler die op mysterieuze wijze overlijdt na het ontvangen van vreemde signalen.</p></div><div class=paragraph><p>Dit probleem is nog duidelijker als na het herstarten van de make het proces opnieuw stopt op een ander punt.</p></div><div class=paragraph><p>Hier biedt niets anders uitkomst dan componenten in een systeem wisselen om uit te zoeken welk component er faalt.</p></div></div><div class=sect4><h5 id=_kan_usrobj_verwijderd_worden_na_afloop>24.7.14.3. Kan /usr/obj verwijderd worden na afloop?<a class=anchor href=#_kan_usrobj_verwijderd_worden_na_afloop></a></h5><div class=paragraph><p>Het korte antwoord is ja.</p></div><div class=paragraph><p><span class=filename>/usr/obj</span> bevat alle objectbestanden die tijdens het compileren zijn gemaakt. Normaliter is een van de eerste stappen in het <code>make buildworld</code> proces deze map verwijderen en een verse start maken. In dit geval heeft het behouden van <span class=filename>/usr/obj</span> na het afronden weinig zin en geeft het ook nogal wat extra vrije schijfruimte (ongeveer 2 GB).</p></div><div class=paragraph><p>Als er veel kennis aanwezig is bij een beheerder, dan kan <code>make buildworld</code> aangegeven worden deze stap over te slaan. Hierdoor draaien volgende builds veel sneller, omdat veel broncode niet opnieuw gecompileerd hoeft te worden. De andere kant van de medaille is dat er subtiele afhankelijkheidsproblemen kunnen ontstaan, waardoor een build op bijzondere wijze kan falen. Hierdoor onstaat regelmatig ruis op FreeBSD mailinglijsten als er iemand klaagt dat zijn build faalt, terwijl hij zich niet realiseert dat dit komt doordat hij zijn updateproces niet volgens het boekje heeft uitgevoerd.</p></div></div><div class=sect4><h5 id=_kunnen_onderbroken_builds_gecontinueerd_worden>24.7.14.4. Kunnen onderbroken builds gecontinueerd worden?<a class=anchor href=#_kunnen_onderbroken_builds_gecontinueerd_worden></a></h5><div class=paragraph><p>Dit hangt af van hoever een systeem was voordat een probleem gevonden werd.</p></div><div class=paragraph><p><em>Normaal gesproken</em> (en dit is geen vaste regel) maakt het proces <code>make buildworld</code> nieuwe kopieën van essentiele hulpprogramma’s (zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=gcc&amp;sektion=1&amp;format=html">gcc(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a>) en de systeembibliotheken. Deze hulpprogramma’s en bibliotheken worden daarna geïnstalleerd. De nieuwe hulpprogramma’s en bibliotheken worden daarna gebruikt om zichzelf opnieuw op te bouwen en wederom te installeren. Het complete systeem (nu met gewone programma’s zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=grep&amp;sektion=1&amp;format=html">grep(1)</a>) wordt daarna opnieuw gebouwd met de nieuwe systeembestanden.</p></div><div class=paragraph><p>Als een systeem in de laatste fase zit (wat uit de uitvoer blijkt) kan dit redelijk veilig gedaan worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>… fix the problem …
<span class=c># cd /usr/src</span>
<span class=c># make -DNO_CLEAN all</span></code></pre></div></div><div class=paragraph><p>Dit maakt het werk van de vorige <code>make buildworld</code> niet ongedaan.</p></div><div class=paragraph><p>Als het onderstaande bericht in de uitvoer van <code>make buildworld</code> staat, dan is het redelijk veilig om het te doen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>--------------------------------------------------------------</span>
Building everything..
<span class=nt>--------------------------------------------------------------</span></code></pre></div></div><div class=paragraph><p>Als dat bericht er niet is, of er is onzekerheid over, dan is het altijd beter om de build opnieuw te starten vanaf het begin.</p></div></div><div class=sect4><h5 id=_kan_kan_de_wereld_bouwen_versneld_worden>24.7.14.5. Kan kan de wereld bouwen versneld worden?<a class=anchor href=#_kan_kan_de_wereld_bouwen_versneld_worden></a></h5><div class=ulist><ul><li><p>Draai in single-user modus;</p></li><li><p>Zet de mappen <span class=filename>/usr/src</span> en <span class=filename>/usr/obj</span> op aparte bestandssystemen die op aparte schijven staan. Hang deze schijven als mogelijk aan aparte schijfcontrollers;</p></li><li><p>Nog beter, verspreid de bestandssystemen over meerdere schijven via het apparaat <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> (concatenated disk driver);</p></li><li><p>Zet profiling uit (voeg "NO_PROFILE=true" toe aan <span class=filename>/etc/make.conf</span>). Het is zeer waarschijnlijk niet nodig;</p></li><li><p>Geef de optie <code>-j<em>n</em></code> mee aan <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> om meerdere processen parallel te laten lopen. Dit helpt in de meeste gevallen, onafhankelijk of er gewerkt wordt op een systeem met één of meerdere processoren;</p></li><li><p>Het bestandssysteem dat <span class=filename>/usr/src</span> bevat, kan (opnieuw) gemount worden met de optie <code>noatime</code>. Dit voorkomt dat het bestandssysteem de toegangsmomenten registreert. Deze informatie is waarschijnlijk toch niet nodig.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -u -o noatime /usr/src</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>In dit voorbeeld wordt aangenomen dat <span class=filename>/usr/src</span> op zijn eigen bestandssysteem staat. Als dit niet het geval is (bijvoorbeeld als het onderdeel is van <span class=filename>/usr</span>), dan moet het mountpunt voor dat bestandssysteem gebruikt moeten worden en niet <span class=filename>/usr/src</span>;</p></div></td></tr></tbody></table></div></li><li><p>Het bestandssysteem dat <span class=filename>/usr/obj</span> gevat kan (opnieuw) worden gemount met de optie <code>async</code>. Dit zorgt ervoor dat schrijfacties naar een schijf asynchroon plaatsvinden. In andere woorden: de schrijfactie wordt direct uitgevoerd en de gegevens worden later naar de schijf geschreven. Dit stelt het systeem in staat om data geclusterd weg te schrijven, wat een grote prestatieverbetering kan opleveren.</p><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Houd er rekening mee dat deze optie het bestandssysteem kwetsbaarder maakt. Met deze optie is er een vergrote kans dat, indien er een stroomstoring optreed, het bestandssysteem in een niet meer te herstellen staat komt als de machine herstart.</p></div><div class=paragraph><p>Als op dit bestandssysteem alleen <span class=filename>/usr/obj</span> staat, is dit geen probleem. Als er andere belangrijke gegevens op hetzelfde bestandssysteem staan, zorg er dan voor dat er verse back-ups zijn voordat deze optie aangezet wordt.</p></div></td></tr></tbody></table></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -u -o async /usr/obj</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Zorg ervoor, zoals al eerder is aangegeven, dat als <span class=filename>/usr/obj</span> niet op een eigen bestandssysteem staat, het juiste mountpunt wordt gebruikt.</p></div></td></tr></tbody></table></div></li></ul></div></div><div class=sect4><h5 id=_wat_te_doen_als_er_iets_mis_gaat>24.7.14.6. Wat te doen als er iets mis gaat?<a class=anchor href=#_wat_te_doen_als_er_iets_mis_gaat></a></h5><div class=paragraph><p>Zorg ervoor dat het systeem geen rommel meer bevat van eerdere builds. Het volgende helpt daarbij:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chflags -R noschg /usr/obj/usr</span>
<span class=c># rm -rf /usr/obj/usr</span>
<span class=c># cd /usr/src</span>
<span class=c># make cleandir</span>
<span class=c># make cleandir</span></code></pre></div></div><div class=paragraph><p>Inderdaad, <code>make cleandir</code> moet twee keer gedraaid worden.</p></div><div class=paragraph><p>Herstart daarna het complete proces vanaf <code>make buildworld</code>.</p></div><div class=paragraph><p>Als er nog steeds problemen zijn, stuur dan de foutmelding en de uitvoer van <code>uname -a</code> naar de <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD algemene vragen mailinglijst</a>. Wees bereid aanvullende vragen over het systeem te beantwoorden!</p></div></div></div></div><div class=sect2><h3 id=make-delete-old>24.8. Het verwijderen van overbodige bestanden, directories en bibliotheken<a class=anchor href=#make-delete-old></a></h3><div class=paragraph><p>Als onderdeel van de FreeBSD ontwikkel levenscyclus kan het van tijd tot tijd gebeuren dat bestanden en de inhoud ervan overbodig worden. Dit kan komen doordat de functionaliteit ergens anders geïmplementeerd is, het versienummer van de bibliotheek veranderd is of hij is totaal van het systeem verdwenen. Dit is inclusief oude bestanden, bibliotheken en directories welke verwijderd moeten worden bij het updaten van het systeem. Het voordeel voor de gebruiker is dat het systeem niet vervuild wordt met oude bestanden die onnodig ruimte innemen op het opslag (en back-up) systeem. Ook is het zo dat als de oude bibliotheek een beveiligings of stabiliteits probleem had, er moet worden geupdate naar de nieuwere bibliotheek om het systeem veilig te houden en te voorkomen dat er crashes komen door de oude implementatie van de bibliotheek. De bestanden, directories en bibliotheken welke als overbodig worden gezien zijn beschreven in <span class=filename>/usr/src/ObsoleteFiles.inc</span>. De volgende instructies zullen helpen om deze verouderde bestanden te verwijderen tijdens het systeem upgrade proces.</p></div><div class=paragraph><p>Er wordt aangenomen dat de stappen gevolgd worden zoals uitgelegd in <a href=#canonical-build>De universele wijze om een systeem bij te werken</a>. Na het <code>make installworld</code> commando en het daarop volgende <code>mergemaster</code> commando succesvol uitgevoerd zijn kan er op de volgende manier gecontroleerd worden voor verouderde bestanden en bibliotheken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make check-old</span></code></pre></div></div><div class=paragraph><p>Als er verouderde bestanden gevonden worden kunnen deze verwijderd worden door het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make delete-old</span></code></pre></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Zie het <span class=filename>/usr/src/Makefile</span> bestand voor meer interessante targets.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Er wordt een prompt getoond voordat elk verouderd bestand wordt verwijderd. Deze prompt kan worden overgeslagen en het systeem deze bestanden automatisch laten verwijderen door gebruik te maken van de <code>BATCH_DELETE_OLD_FILES</code> make variabele als volgt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DBATCH_DELETE_OLD_FILES delete-old</span></code></pre></div></div><div class=paragraph><p>Dit kan ook worden gedaan door deze commando’s door <code>yes</code> te pipen als volgt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># yes|make delete-old</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Waarschuwing</div><div class=paragraph><p>Het verwijderen van verouderde bestanden zal applicaties stuk maken die nog gebruik maken van de overbodige bestanden. Dit is zeker waar voor oude bibliotheken. In de meeste gevallen moeten de programma’s, ports of bibliotheken opnieuw gecompileerd worden voordat <code>make delete-old-libs</code> wordt uitgevoerd.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Gereedschappen om gedeelde bibliotheek afhankelijkheden te controleren zijn beschikbaar in de Ports Collectie in <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/libchk/>sysutils/libchk</a> of <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/bsdadminscripts/>sysutils/bsdadminscripts</a>.</p></div><div class=paragraph><p>Overbodige gedeelde bibliotheken kunnen conflicteren met nieuwere bibliotheken welke berichten zoals deze kunnen veroorzaken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/usr/bin/ld: warning: libz.so.4, needed by /usr/local/lib/libtiff.so, may conflict with libz.so.5
/usr/bin/ld: warning: librpcsvc.so.4, needed by /usr/local/lib/libXext.so, may conflict with librpcsvc.so.5</code></pre></div></div><div class=paragraph><p>Om deze problemen op te lossen moet bepaald worden welke port deze bibliotheek heeft geïnstalleerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_info -W /usr/local/lib/libtiff.so</span>
/usr/local/lib/libtiff.so was installed by package tiff-3.9.4
<span class=c># pkg_info -W /usr/local/lib/libXext.so</span>
/usr/local/lib/libXext.so was installed by package libXext-1.1.1,1</code></pre></div></div><div class=paragraph><p>Deïnstalleer, herbouw en herinstalleer de port. De <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portmaster/>ports-mgmt/portmaster</a> en <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portupgrade/>ports-mgmt/portupgrade</a> gereedschappen kunnen gebruikt worden om deze processen te automatiseren. Nadat zeker is dat alle ports opnieuw gebouwd zijn, en de oude bibliotheken niet meer gebruikt worden, kunnen deze verwijderd worden met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make delete-old-libs</span></code></pre></div></div></div><div class=sect2><h3 id=small-lan>24.9. Meerdere machines bijwerken<a class=anchor href=#small-lan></a></h3><div class=paragraph><p>Als er meerdere machines zijn die dezelfde broncode bijhouden, lijkt het downloaden van alle broncode en alles overal opnieuw bouwen zonde van de bronnen: harde schijfruimte, netwerk bandbreedte, en processorbelasting. Dit klopt en de oplossing is om alles op één machine te doen terwijl de overige machines het uitgevoerde werk benaderen via NFS. Nu wordt een methode beschreven waarmee dit gedaan kan worden.</p></div><div class=sect3><h4 id=small-lan-preliminaries>24.9.1. Benodigdheden<a class=anchor href=#small-lan-preliminaries></a></h4><div class=paragraph><p>Als eerste moet er een groep van machines gekozen worden die dezelfde set aan binaire bestanden zal draaien, hier een <em>bouwgroep</em>. Elke machine kan een eigen afwijkende kernel hebben maar moet dezelfde binaire gebruikersbestanden draaien. Uit die groep moet een machine gekozen worden die de <em>bouwmachine</em> wordt. Dit wordt de machine waar de wereld en kernel op gebouwd worden. In het meest ideale geval is dit een snelle machine die genoeg processorkracht vrij heeft om <code>make buildworld</code> en <code>make buildkernel</code> te draaien. Er moet ook een machine gekozen worden die de <em>testmachine</em> wordt waarop alle bijgewerkte software wordt test voordat die in productie wordt genomen. Dit <em>moet</em> een machine zijn die voor langere tijd down mag zijn. Dit kan de bouwmachine zijn maar dat hoeft niet per se.</p></div><div class=paragraph><p>Alle machines in deze bouwgroep moeten ingesteld worden om <span class=filename>/usr/obj</span> en <span class=filename>/usr/src</span> vanaf dezelfde machine te mounten op hetzelfde punt. In het meest ideale geval zijn dit twee verschillende schijven op de bouwmachine, maar ze kunnen ook door middel van NFS op die machine gemount zijn. Als er meerdere bouwgroepen zijn, dan moet <span class=filename>/usr/src</span> op één bouwmachine staan en door middel van NFS gemount worden op de overige machines.</p></div><div class=paragraph><p>Zorg er als laatste voor dat <span class=filename>/etc/make.conf</span> en <span class=filename>/etc/src.conf</span> op alle machines in de bouwgroep het eens zijn met de bouwmachine. Dat betekent dat de bouwmachine alle delen van het basissysteem moet bouwen die elke machine in de bouwgroep installeert. Ook heeft elke bouwmachine zijn kernelnaam ingesteld met <code>KERNCONF</code> in <span class=filename>/etc/make.conf</span> en de bouwmachine moet ze allemaal hebben in <code>KERNCONF</code>, zijn eigen kernel eerst. De bouwmachine moet de instellingenbestanden voor elke machine in <span class=filename>/usr/src/sys/arch/conf</span> hebben als deze machine de kernels voor de overige machines gaat bouwen.</p></div></div><div class=sect3><h4 id=small-lan-base-system>24.9.2. Basissysteem<a class=anchor href=#small-lan-base-system></a></h4><div class=paragraph><p>Nu kan één systeem alles bouwen. Bouw de kernel en wereld zoals beschreven in <a href=#make-buildworld>Basissysteem compileren</a> op de bouwmachine, maar installeer niets. Zodra de bouw klaar is, moet op de testmachine de kernel geïnstalleerd en getest worden. Als deze machine <span class=filename>/usr/src</span> en <span class=filename>/usr/obj</span> mount via NFS, moet na een herstart in single-user modus het netwerk ingeschakeld worden zodat de mounts opnieuw gemaakt kunnen worden. De makkelijkste manier om dit te doen is om te starten in multi-user modus en daar <code>shutdown now</code> starten om in single-user modus te komen. Eenmaal daar aangekomen kunnen de nieuwe kernel en de wereld geïnstalleerd worden en kan daarna normaal <code>mergemaster</code> gestart worden. Zodra dit klaar is, kan de machine opnieuw gestart worden om naar multi-user modus terug te keren.</p></div><div class=paragraph><p>Nadat zeker is dat alles op de testmachine correct werkt, kan dezelfde procedure gebruikt worden om de nieuwe software op elke machine te installeren in de bouwgroep.</p></div></div><div class=sect3><h4 id=small-lan-ports>24.9.3. Ports<a class=anchor href=#small-lan-ports></a></h4><div class=paragraph><p>Dezelfde ideeën kunnen gebruikt worden voor de ports. De eerste kritieke stap is om <span class=filename>/usr/ports</span> te mounten op alle machines in de bouwgroep. Daarna kan <span class=filename>/etc/make.conf</span> correct ingesteld worden om de distfiles te delen. De variabele <code>DISTDIR</code> moet wijzen naar een gedeelde map waarin geschreven kan worden door de gebruiker waar <code>root</code> naar wijst in de NFS mounts. Op elke machine moet <code>WRKDIRPREFIX</code> naar een lokale bouwmap wijzen. Als er pakketten gebouwd en gedistribueerd worden moet <code>PACKAGES</code> naar een map wijzen gelijkvormig aan de instelling voor <code>DISTDIR</code>.</p></div></div></div></div></div><div class=sect1><h2 id=dtrace>Hoofdstuk 25. DTrace<a class=anchor href=#dtrace></a></h2><div class=sectionbody><div class=sect2><h3 id=dtrace-synopsis>25.1. Overzicht<a class=anchor href=#dtrace-synopsis></a></h3><div class=paragraph><p>DTrace, ook bekend als Dynamic Tracing, was ontwikkeld door Sun™ als een gereedschap om prestatie-bottlenecks in productie- en preproductiesystemen op te sporen. Het is in geen enkel opzicht een debug-gereedschap, maar een gereedschap voor real-time analyse om prestatie- en andere zaken op te sporen.</p></div><div class=paragraph><p>DTrace is een opmerkelijk profileringsgereedschap, met een indrukwekkende verzameling mogelijkheden om systeemzaken te diagnosticeren. Het kan ook worden gebruikt om vooraf geschreven scripts te draaien om zo voordeel te halen uit de mogelijkheden. Gebruikers kunnen zelfs hun eigen middelen schrijven door gebruik te maken van de DTrace D Language, wat ze in staat stelt om hun profilering aan te passen aan hun specifieke behoeften.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet u:</p></div><div class=ulist><ul><li><p>Wat DTrace is en welke mogelijkheden het biedt.</p></li><li><p>De verschillen tussen de DTrace-implementatie van Solaris™ en degene die door FreeBSD wordt aangeboden.</p></li><li><p>Hoe DTrace op FreeBSD aan te zetten en te gebruiken.</p></li></ul></div><div class=paragraph><p>Voordat u dit hoofdstuk leest, dient u:</p></div><div class=ulist><ul><li><p>De beginselen van UNIX® en FreeBSD te begrijpen (<a href=./#basics>UNIX® beginselen</a>).</p></li><li><p>Bekend te zijn met de beginselen van kernelconfiguratie en -compilatie (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li><li><p>Wat bekendheid te hebben met beveiliging en hoe het zich verhoudt tot FreeBSD (<a href=./#security>Beveiliging</a>).</p></li><li><p>Te begrijpen hoe de broncode van FreeBSD te verkrijgen en te herbouwen (<a href=./#updating-upgrading>FreeBSD updaten en upgraden</a>).</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Deze mogelijkheid wordt als experimenteel beschouwd. Van sommige opties kan er functionaliteit ontbreken, andere delen kunnen in het geheel niet werken. In de loop der tijd zal deze mogelijkheid als productierijp worden beschouwd en zal deze documentatie worden aangepast om die situatie te representeren.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=dtrace-implementation>25.2. Implementatieverschillen<a class=anchor href=#dtrace-implementation></a></h3><div class=paragraph><p>Hoewel DTrace in FreeBSD erg lijkt op degene die in Solaris™ zit, zijn er verschillen die uitgelegd moeten worden voordat er verder wordt gegaan. Het primaire verschil dat gebruikers zullen zien is dat DTrace specifiek moet worden aangezet op FreeBSD. Er zijn kernelopties en modulen die aangezet moeten worden om DTrace juist te laten werken. Deze zullen later worden uitgelegd.</p></div><div class=paragraph><p>Er is een kerneloptie <code>DDB_CTF</code> die gebruikt wordt om ondersteuning voor het laden van CTF-gegevens van kernelmodulen en de kernel zelf. CTF is het Compact C Type Format van Solaris™ welke een beperkte vorm van debuginformatie bevat die vergelijkbaar is met DWARF en de befaamde stabs. Deze CTF-gegevens worden door de bouwmiddelen <code>ctfconvert</code> en <code>ctfmerge</code> aan de binairen toegevoegd. Het hulpmiddel <code>ctfconvert</code> parseert DWARFELF-debug-secties die door de compiler zijn aangemaakt en <code>ctfmerge</code> voegt CTFELF-secties van objecten samen in hun executables of gedeelde bibliotheken. Meer informatie over hoe dit voor de bouw van de kernel en FreeBSD aan te zetten komt eraan.</p></div><div class=paragraph><p>Sommige aanbieders voor FreeBSD verschillen van die voor Solaris™. De meest opmerkelijke is de aanbieder <code>dtmalloc</code>, welke het volgen van <code>malloc()</code> op soort in de FreeBSD-kernel toestaat.</p></div><div class=paragraph><p>Alleen <code>root</code> mag DTrace op FreeBSD gebruiken. Dit heeft te maken met beveiligingsverschillen, Solaris™ heeft enkele beveiligingscontroles op laag niveau die nog niet bestaan in FreeBSD. Hierom is <span class=filename>/dev/dtrace/dtrace</span> strikt beperkt tot <code>root</code>.</p></div><div class=paragraph><p>Tenslotte valt de DTrace-software onder de CDDL-licentie van Sun™. De <code>Common Development and Distribution License</code> wordt bij FreeBSD geleverd, zie <span class=filename>/usr/src/cddl/contrib/opensolaris/OPENSOLARIS.LICENSE</span> of bekijk het online op <a href=http://www.opensolaris.org/os/licensing>http://www.opensolaris.org/os/licensing</a>.</p></div><div class=paragraph><p>Deze licentie houdt in dat een FreeBSD-kernel met de DTrace-opties nog steeds onder de BSD-licentie valt; de CDDL komt echter op de proppen wanneer de modulen in binaire vorm worden verspreid, of wanneer de binairen zijn geladen.</p></div></div><div class=sect2><h3 id=dtrace-enable>25.3. Ondersteuning voor DTrace aanzetten<a class=anchor href=#dtrace-enable></a></h3><div class=paragraph><p>Voeg de volgende regels toe aan het kernelinstellingenbestand om ondersteuning voor DTrace aan te zetten:</p></div><div class="literalblock programlisting"><div class=content><pre>options         KDTRACE_HOOKS
options         DDB_CTF</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Gebruikers van de AMD64-architectuur zullen de volgende regel aan hun kernelinstellingenbestand willen toevoegen:</p></div><div class="literalblock programlisting"><div class=content><pre>options         KDTRACE_FRAME</pre></div></div><div class=paragraph><p>Deze optie biedt ondersteuning voor de mogelijkheid FBT. DTrace zal zonder deze optie werken; er zal echter beperkte ondersteuning zijn voor het volgen van functiegrenzen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Alle broncode moet herbouwd en geherinstalleerd worden met de CTF-opties. Om deze taak te volbrengen, wordt de FreeBSD-broncode herbouwd met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>

<span class=c># make WITH_CTF=1 kernel</span></code></pre></div></div><div class=paragraph><p>Het systeem moet opnieuw gestart worden.</p></div><div class=paragraph><p>Nadat opnieuw is opgestart en de nieuwe kernel in het geheugen is geladen, dient ondersteuning voor de Korn-shell te worden toegevoegd. Dit is nodig omdat de verschillende hulpmiddelen van DTraceToolkit in <code>ksh</code> zijn geschreven. Installeer <a class=package href=https://cgit.freebsd.org/ports/tree/shells/ksh93/>shells/ksh93</a>. Het is ook mogelijk om deze hulpmiddelen in <a class=package href=https://cgit.freebsd.org/ports/tree/shells/pdksh/>shells/pdksh</a> of <a class=package href=https://cgit.freebsd.org/ports/tree/shells/mksh/>shells/mksh</a> te draaien.</p></div><div class=paragraph><p>Als laatste dient de huidige DTraceToolkit verkregen te worden. Indien u FreeBSD 10 draait, vindt u de DTraceToolkit in <span class=filename>/usr/shared/dtrace</span>. In andere gevallen kunt u de DTraceToolkit installeren via de port <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/dtrace-toolkit/>sysutils/dtrace-toolkit</a>.</p></div></div><div class=sect2><h3 id=dtrace-using>25.4. DTrace gebruiken<a class=anchor href=#dtrace-using></a></h3><div class=paragraph><p>Voordat er gebruik wordt gemaakt van de functionaliteit van DTrace, moet het DTrace-apparaat bestaan. Geef het volgende commando om het apparaat te laten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload dtraceall</span></code></pre></div></div><div class=paragraph><p>Ondersteuning van DTrace zou nu beschikbaar moeten zijn. De beheerder kan het volgende commando uitvoeren om alle sondes te bekijken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dtrace -l | more</span></code></pre></div></div><div class=paragraph><p>Alle uitvoer wordt aan het hulpmiddel <code>more</code> doorgegeven omdat het snel de schermbuffer zal laten overstromen. DTrace kan nu als werkend worden beschouwd. Het is nu tijd om de gereedschapskist te bekijken.</p></div><div class=paragraph><p>De gereedschapskist is een verzameling van kant-en-klare scripts die met DTrace gedraaid kunnen worden om informatie over het systeem te verzamelen. Er zijn scripts om open bestanden, geheugen, CPU-gebruik, en nog veel meer te controleren. Pak de scripts uit met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gunzip -c DTraceToolkit* | tar xvf -</span></code></pre></div></div><div class=paragraph><p>Ga naar die map met <code>cd</code> en zet de uitvoerpermissies voor alle bestanden waarvan de naam uit kleine letters bestaat, op <code>755</code>.</p></div><div class=paragraph><p>De inhoud van al deze scripts moet veranderd worden. Degenen die naar <span class=filename>/usr/bin/ksh</span> verwijzen dienen naar <span class=filename>/usr/local/bin/ksh</span> te verwijzen, de anderen die <span class=filename>/usr/bin/sh</span> gebruiken dienen gewijzigd te worden om <span class=filename>/bin/sh</span> te gebruiken, en tenslotte dienen degenen die <span class=filename>/usr/bin/perl</span> gebruiken veranderd te worden om <span class=filename>/usr/local/bin/perl</span> te gebruiken.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Op dit moment is het voorzichtig om de lezer eraan te herinneren dat de ondersteuning voor DTrace in FreeBSD <em>niet compleet</em> en <em>experimenteel</em> is. Veel van deze scripts zullen niet werken omdat ze of te Solaris™-specifiek zijn of omdat ze sondes gebruiken die momenteel niet ondersteund worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Op het moment van schrijven worden slechts twee scripts van de DTrace Toolkit volledig ondersteund in FreeBSD: de scripts <span class=filename>hotkernel</span> en <span class=filename>procsystime</span>. Dit zijn de twee die we in de volgende gedeelten van deze sectie zullen bekijken.</p></div><div class=paragraph><p>De <span class=filename>hotkernel</span> is ontworpen om te identificeren welke functie de meeste kerneltijd gebruikt. Als het normaal gedraaid wordt, zal het uitvoer die op de volgende lijkt produceren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/shared/dtrace/toolkit</span>
<span class=c># ./hotkernel</span>
Sampling... Hit Ctrl-C to end.</code></pre></div></div><div class=paragraph><p>De systeembeheerder moet de toetsencombinatie <span class=keyseq><kbd>Ctrl</kbd>+<kbd>C</kbd></span> gebruiken om het proces te stoppen. Nadat het gestopt is, zal het script een lijst van kernelfuncties en timinginformatie weergeven, waarbij de uitvoer in volgorde van toenemende tijd is gesorteerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>kernel<span class=sb>`</span>_thread_lock_flags                                   2   0.0%
0xc1097063                                                  2   0.0%
kernel<span class=sb>`</span>sched_userret                                        2   0.0%
kernel<span class=sb>`</span>kern_select                                          2   0.0%
kernel<span class=sb>`</span>generic_copyin                                       3   0.0%
kernel<span class=sb>`</span>_mtx_assert                                          3   0.0%
kernel<span class=sb>`</span>vm_fault                                             3   0.0%
kernel<span class=sb>`</span>sopoll_generic                                       3   0.0%
kernel<span class=sb>`</span>fixup_filename                                       4   0.0%
kernel<span class=sb>`</span>_isitmyx                                             4   0.0%
kernel<span class=sb>`</span>find_instance                                        4   0.0%
kernel<span class=sb>`</span>_mtx_unlock_flags                                    5   0.0%
kernel<span class=sb>`</span>syscall                                              5   0.0%
kernel<span class=sb>`</span>DELAY                                                5   0.0%
0xc108a253                                                  6   0.0%
kernel<span class=sb>`</span>witness_lock                                         7   0.0%
kernel<span class=sb>`</span>read_aux_data_no_wait                                7   0.0%
kernel<span class=sb>`</span>Xint0x80_syscall                                     7   0.0%
kernel<span class=sb>`</span>witness_checkorder                                   7   0.0%
kernel<span class=sb>`</span>sse2_pagezero                                        8   0.0%
kernel<span class=sb>`</span>strncmp                                              9   0.0%
kernel<span class=sb>`</span>spinlock_exit                                       10   0.0%
kernel<span class=sb>`</span>_mtx_lock_flags                                     11   0.0%
kernel<span class=sb>`</span>witness_unlock                                      15   0.0%
kernel<span class=sb>`</span>sched_idletd                                       137   0.3%
0xc10981a5                                              42139  99.3%</code></pre></div></div><div class=paragraph><p>Het script werkt ook met kernelmodules. Draai het script met de vlag <code>-m</code> om deze mogelijkheid te gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ./hotkernel -m</span>
Sampling... Hit Ctrl-C to end.
^C
MODULE                                                  COUNT   PCNT
0xc107882e                                                  1   0.0%
0xc10e6aa4                                                  1   0.0%
0xc1076983                                                  1   0.0%
0xc109708a                                                  1   0.0%
0xc1075a5d                                                  1   0.0%
0xc1077325                                                  1   0.0%
0xc108a245                                                  1   0.0%
0xc107730d                                                  1   0.0%
0xc1097063                                                  2   0.0%
0xc108a253                                                 73   0.0%
kernel                                                    874   0.4%
0xc10981a5                                             213781  99.6%</code></pre></div></div><div class=paragraph><p>Het script <span class=filename>procsystime</span> vangt en beeldt het tijdsgebruik van systeemaanroepen af voor een gegeven PID of procesnaam. In het volgende voorbeeld wordt er een nieuwe instantie van <span class=filename>/bin/csh</span> gedraaid. Het <span class=filename>procsystime</span> werd uitgevoerd en bleef wachten terwijl er enkele commando’s op de andere instantie van <code>csh</code> werden getypt. Dit zijn de resultaten van deze test:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ./procsystime -n csh</span>
Tracing... Hit Ctrl-C to end...
^C

Elapsed Times <span class=k>for </span>processes csh,

         SYSCALL          TIME <span class=o>(</span>ns<span class=o>)</span>
          getpid               6131
       sigreturn               8121
           close              19127
           fcntl              19959
             dup              26955
         setpgid              28070
            <span class=nb>stat              </span>31899
       setitimer              40938
           wait4              62717
       sigaction              67372
     sigprocmask             119091
    gettimeofday             183710
           write             263242
          execve             492547
           ioctl             770073
           vfork            3258923
      sigsuspend            6985124
            <span class=nb>read         </span>3988049784</code></pre></div></div><div class=paragraph><p>Zoals te zien is, lijkt de systeemaanroep <code>read()</code> de meeste tijd in nanoseconden te gebruiken en gebruikte de systeemaanroep <code>getpid()</code> de minste hoeveelheid tijd.</p></div></div><div class=sect2><h3 id=dtrace-language>25.5. De taal D<a class=anchor href=#dtrace-language></a></h3><div class=paragraph><p>De DTrace-gereedschapskist bevat vele scripts in de speciale taal van DTrace. Deze taal wordt "de taal D" genoemd door de documentatie van Sun™, en lijkt sterk op C++. Een diepgaande discussie over de taal valt buiten het bereik van dit document. Het wordt uitgebreid behandeld op <a href=http://wikis.oracle.com/display/DTrace/Documentation>http://wikis.oracle.com/display/DTrace/Documentation</a>.</p></div></div></div></div><h1 id=network-communication class=sect0>Deel IV: Netwerkcommunicatie<a class=anchor href=#network-communication></a></h1><div class="openblock partintro"><div class=content><div class=paragraph><p>Als het om servers gaat die hoge prestaties moeten leveren, wordt wereldwijd vaak FreeBSD toegepast. De hoofdstukken in dit deel behandelen:</p></div><div class=ulist><ul><li><p>Seriëe communicatie;</p></li><li><p>PPP en PPP over Ethernet;</p></li><li><p>E-mail;</p></li><li><p>Netwerkdiensten;</p></li><li><p>Firewalls;</p></li><li><p>Overig gevorderd netwerken.</p></li></ul></div><div class=paragraph><p>Deze hoofdstukken zijn geschreven om gelezen te worden als de informatie nodig is. Ze hoeven niet allemaal in een bepaalde volgorde gelezen te worden. Ze hoeven ook niet allemaal gelezen te worden om FreeBSD in een netwerkomgeving in te zetten.</p></div></div></div><div class=sect1><h2 id=serialcomms>Hoofdstuk 26. Seriële communicatie<a class=anchor href=#serialcomms></a></h2><div class=sectionbody><div class=sect2><h3 id=serial-synopsis>26.1. Overzicht<a class=anchor href=#serial-synopsis></a></h3><div class=paragraph><p>UNIX® heeft altijd ondersteuning geboden voor seriële communicatie. Het is een feit dat de allereerste UNIX®-machines afhankelijk waren van seriële kabels voor gebruikersinvoer en -uitvoer. De dingen zijn flink veranderd sinds de tijd dat de gemiddelde "terminal" uit een 10-tekens-per-seconde seriële printer en een toetsenbord bestond. Dit hoofdstuk beschrijft enkele manieren waarop FreeBSD gebruik maakt van seriële communicatie.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe terminals met een FreeBSD-systeem te verbinden;</p></li><li><p>Hoe een modem te gebruiken om naar computers op afstand te bellen;</p></li><li><p>Hoe het mogelijk te maken voor gebruikers op afstand om met een modem op een systeem aan te melden;</p></li><li><p>Hoe een systeem van een seriële console op te starten.</p></li></ul></div><div class=paragraph><p>Veronderstelde voorkennis:</p></div><div class=ulist><ul><li><p>Weten hoe een nieuwe kernel ingesteld en geïnstalleerd wordt (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>);</p></li><li><p>Begrijpen hoe rechten en processen in UNIX® werken (<a href=./#basics>UNIX® beginselen</a>);</p></li><li><p>De beschikking hebben over het technische handboek voor de hardware (modem of meerpoortige kaart) die gebruikt wordt met FreeBSD.</p></li></ul></div></div><div class=sect2><h3 id=serial>26.2. Inleiding<a class=anchor href=#serial></a></h3><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Vanaf FreeBSD 8.0 zijn de seriële poorten hernoemd van <span class=filename>/dev/cuadN</span> naar <span class=filename>/dev/cuauN</span> en van <span class=filename>/dev/ttydN</span> naar <span class=filename>/dev/ttyuN</span>. FreeBSD 7.X gebruikers moeten de documentatie aanpassen naar deze wijzigingen.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=serial-terminology>26.2.1. Terminologie<a class=anchor href=#serial-terminology></a></h4><div class=dlist><dl><dt class=hdlist1>bps</dt><dd><p>Bits per seconde: de snelheid waarmee gegevens verstuurd worden</p></dd><dt class=hdlist1>DTE</dt><dd><p>Data Terminal Equipment (apparatuur voor gegevensterminal): bijvoorbeeld een computer</p></dd><dt class=hdlist1>DCE</dt><dd><p>Data Communications Equipment (apparatuur voor gegevenscommunicatie): een modem</p></dd><dt class=hdlist1>RS-232</dt><dd><p>EIA standaard voor hardwarematige seriële communicatie</p></dd></dl></div><div class=paragraph><p>Deze sectie gebruikt niet de term "baud" als er over snelheden van gegevenscommunicatie gesproken wordt. Baud verwijst naar het aantal elektrische toestandsovergangen dat binnen een tijdsperiode gemaakt mag worden, "bps" (bits per seconde) is de <em>correcte</em> term om te gebruiken (de oude mopperkonten schijnen zich er niet erg druk over te maken).</p></div></div><div class=sect3><h4 id=serial-cables-ports>26.2.2. Kabels en poorten<a class=anchor href=#serial-cables-ports></a></h4><div class=paragraph><p>Om een modem of terminal met een FreeBSD-systeem te verbinden, dienen een seriële poort op een computer en een kabel om verbinding te maken met een serieel apparaat aanwezig te zijn. Indien kennis over hardware en de benodigde kabel reeds aanwezig is, kan deze sectie veilig worden overgeslagen.</p></div><div class=sect4><h5 id=term-cables>26.2.2.1. Kabels<a class=anchor href=#term-cables></a></h5><div class=paragraph><p>Er zijn verschillende soorten seriële kabels. De twee meest voorkomende types in deze context zijn nulmodem-kabels en standaard ("rechte") RS-232-kabels. De documentatie van de hardware beschrijft het type kabel dat nodig is.</p></div><div class=sect5><h6 id=term-cables-null>26.2.2.1.1. Nulmodem-kabels<a class=anchor href=#term-cables-null></a></h6><div class=paragraph><p>Een nulmodem-kabel geeft sommige signalen, zoals "Aardesignaal" recht door, maar kruist andere signalen. Bijvoorbeeld, de "Verzonden Gegevens"-pin aan de ene kant gaat naar de "Ontvangen Gegevens"-pin aan de andere kant.</p></div><div class=paragraph><p>Een nulmodem-kabel voor het gebruik met terminals kan ook zelf worden gemaakt (bijvoorbeeld voor kwaliteitsdoeleinden). Deze tabel toont de RS-232C <a href=#serialcomms-signal-names>signalen</a> en de pinnummers op een DB-25-aansluiting. De standaard vereist ook een <em>Aardebescherming</em> rechte lijn van pin 1 naar pin 1, maar deze wordt vaak weggelaten. Sommige terminals werken goed met slechts pin 2, 3 en 7, terwijl andere instellingen eisen die afwijken van die in de onderstaande voorbeelden.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 7. DB-25 naar DB-25 nulmodem-kabel</caption><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><thead><tr><th class="tableblock halign-left valign-top">Signaal</th><th class="tableblock halign-left valign-top">Pin #</th><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top">Pin #</th><th class="tableblock halign-left valign-top">Signaal</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td></tr></tbody></table><div class=paragraph><p>In de onderstaande tabellen volgen twee schema’s die momenteel meer gebruikelijk zijn:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 8. DB-9 naar DB-9 nulmodem-kabel</caption><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><thead><tr><th class="tableblock halign-left valign-top">Signaal</th><th class="tableblock halign-left valign-top">Pin #</th><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top">Pin #</th><th class="tableblock halign-left valign-top">Signaal</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td></tr></tbody></table><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 9. DB-9 naar DB-25 nulmodem-kabel</caption><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><thead><tr><th class="tableblock halign-left valign-top">Signaal</th><th class="tableblock halign-left valign-top">Pin #</th><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top">Pin #</th><th class="tableblock halign-left valign-top">Signaal</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>verbonden met</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als een pin aan het ene eind verbonden is met een pinnenpaar aan het andere eind, is dit meestal geïmplementeerd met een korte draad tussen het pinnenpaar in de stekker en een lange draad naar de andere, enkele pin.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Bovenstaande ontwerpen lijken het populairst. In een andere variatie (uitgelegd in het boek <em>RS-232 Made Easy</em>) worden de volgende verbindingen gemaakt: SG met SG, TD met RD, RTS en CTS met DCD, DTR met DSR en vice-versa.</p></div></div><div class=sect5><h6 id=term-cables-std>26.2.2.1.2. Standaard RS-232C-kabels<a class=anchor href=#term-cables-std></a></h6><div class=paragraph><p>Een standaard seriële kabel laat alle RS-232C-signalen recht door. Dit betekent dat de "Verzonden Gegevens"-pin aan de ene kant naar de "Verzonden Gegevens"-pin aan de andere kant gaat. Dit type kabel wordt gebruikt om een modem met een FreeBSD-systeem te verbinden en is ook geschikt voor sommige terminals.</p></div></div></div><div class=sect4><h5 id=term-ports>26.2.2.2. Poorten<a class=anchor href=#term-ports></a></h5><div class=paragraph><p>Seriële poorten zijn apparaten die gebruikt worden om gegevens te versturen tussen een FreeBSD gastcomputer en een terminal. Deze sectie beschrijft de bestaande soorten poorten en hoe deze aangesproken worden in FreeBSD.</p></div><div class=sect5><h6 id=term-portkinds>26.2.2.2.1. Soorten poorten<a class=anchor href=#term-portkinds></a></h6><div class=paragraph><p>Er bestaan verschillende soorten seriële poorten. Controleer of een kabel past op de poorten van een terminal en een FreeBSD-systeem alvorens deze te kopen of te maken.</p></div><div class=paragraph><p>De meeste terminals hebben DB-25-poorten. PC’s, inclusief PC’s die FreeBSD draaien, hebben DB-25- of DB-9-poorten. Indien een meerpoortige seriële kaart voor een PC beschikbaar is, kan het zijn dat er RJ-12- of RJ-45-poorten aanwezig zijn.</p></div><div class=paragraph><p>In documentatie die bij hardware zit, staan specificaties over het soort poort dat gebruikt wordt. Vaak volstaat ook een visuele inspectie van een poort.</p></div></div><div class=sect5><h6 id=term-portnames>26.2.2.2.2. Poortnamen<a class=anchor href=#term-portnames></a></h6><div class=paragraph><p>In FreeBSD wordt elke seriële poort benaderd door een ingang in de map <span class=filename>/dev</span>. Er zijn twee verschillende soorten ingangen:</p></div><div class=ulist><ul><li><p>Inbelpoorten heten <span class=filename>/dev/ttyuN</span> waarbij <em>N</em> het poortnummer is, beginnend met nul. In het algemeen kunnen inbelpoorten voor terminals gebruikt worden. Inbelpoorten stellen de eis dat een seriële kabel ervoor zorgt dat het data carrier detect (DCD) signaal correct werkt.</p></li><li><p>Uitbelpoorten heten <span class=filename>/dev/cuauN</span>. In het algemeen worden uitbelpoorten niet voor terminals maar voor modems gebruikt. Gebruik een uitbelpoort als een seriële kabel of terminal het carrier detect-signaal niet ondersteunt.</p></li></ul></div><div class=paragraph><p>Als er een terminal met de eerste seriële poort (<span class=filename>COM1</span> in MS-DOS®) verbonden is, wordt <span class=filename>/dev/ttyu0</span> gebruikt om naar de terminal te verwijzen. Als een terminal op de tweede seriële poort is aangesloten (ook bekend als <span class=filename>COM2</span>), dient <span class=filename>/dev/ttyu1</span> gebruikt te worden, enzovoort.</p></div></div></div></div><div class=sect3><h4 id=_kernelinstellingen>26.2.3. Kernelinstellingen<a class=anchor href=#_kernelinstellingen></a></h4><div class=paragraph><p>FreeBSD ondersteunt standaard vier seriële poorten. In de wereld van MS-DOS® staan ze bekend als <span class=filename>COM1</span>, <span class=filename>COM2</span>, <span class=filename>COM3</span> en <span class=filename>COM4</span>. FreeBSD ondersteunt momenteel "domme" meerpoortige seriële interfacekaarten, zoals de BocaBoard 1008 en 2016, alsook intelligentere meerpoortige kaarten van fabrikanten als Digiboard en Stallion Technologies. De kernel kijkt echter alleen naar de standaard COM-poorten.</p></div><div class=paragraph><p>Bekijk de boodschappen tijdens het opstarten van de kernel om te zien of de kernel seriële poorten herkent of gebruik het commando <code>/sbin/dmesg</code> om de opstartboodschappen van de kernel te herhalen. Kijk in het bijzonder naar boodschappen die met de tekens <code>uart</code> beginnen als u FreeBSD 8.0 of nieuwer gebruikt, of <code>sio</code> voor FreeBSD 7.4 of ouder.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Gebruik het volgende commando om alleen de boodschappen die het woord <code>sio</code> bevatten te zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/dmesg | grep &#39;uart&#39;</span>
<span class=c># /sbin/dmesg | grep &#39;sio&#39;</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Voor bijvoorbeeld een FreeBSD 7.<em>X</em> systeem met vier seriële poorten zijn dit de opstartboodschappen van de kernel die specifiek zijn voor de seriële poorten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sio0 at 0x3f8-0x3ff irq 4 on isa
sio0: <span class=nb>type </span>16550A
sio1 at 0x2f8-0x2ff irq 3 on isa
sio1: <span class=nb>type </span>16550A
sio2 at 0x3e8-0x3ef irq 5 on isa
sio2: <span class=nb>type </span>16550A
sio3 at 0x2e8-0x2ef irq 9 on isa
sio3: <span class=nb>type </span>16550A</code></pre></div></div><div class=paragraph><p>Als een kernel niet alle seriële poorten herkent, dan dient waarschijnlijk de kernel aangepast te worden in het bestand <span class=filename>/boot/device.hints</span>. Het is ook mogelijk regels uit te schakelen of volledig te verwijderen voor apparaten die niet aanwezig zijn.</p></div><div class=paragraph><p>Zie de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> voor meer informatie over het instellen van seriële poorten en meerpoortige kaarten. Bij gebruik van een instellingenbestand dat eerder voor een andere versie van FreeBSD werd gebruikt is voorzichtigheid geboden omdat de apparaatvlaggen en de syntaxis tussen de versies veranderd zijn.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>port IO_COM1</code> is een substitutie voor <code>port 0x3f8</code>, <code>IO_COM2</code> is <code>0x2f8</code>, <code>IO_COM3</code> is <code>0x3e8</code> en <code>IO_COM4</code> is <code>0x2e8</code>, welke redelijk algemene poortadressen zijn voor hun overeenkomstige seriële poorten. Interrupts 4, 3, 5 en 9 zijn redelijk algemene interruptlijnen. Reguliere seriële poorten kunnen <em>geen</em> interrupts delen op ISA-bus-PC’s (meerpoortige kaarten hebben elektronica die alle 16550A’s op een kaart in staat stellen om één of twee interruptlijnen te delen).</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_speciale_apparaatbestanden>26.2.4. Speciale apparaatbestanden<a class=anchor href=#_speciale_apparaatbestanden></a></h4><div class=paragraph><p>De meeste apparaten in de kernel worden benaderd met "speciale apparaatbestanden" die in de map <span class=filename>/dev</span> staan. De apparaten <span class=filename>sio</span> worden benaderd met de apparaten <span class=filename>/dev/ttyuN</span> (inbellen) en <span class=filename>/dev/cuauN</span> (uitbellen). FreeBSD biedt ook initialisatie-apparaten (<span class=filename>/dev/ttyuN.init</span> en <span class=filename>/dev/cuauN.init</span>) en slotapparaten (<span class=filename>/dev/ttyuN.lock</span> en <span class=filename>/dev/cuadN.lock</span>). De initialisatie-apparaten worden gebruikt om telkens als een poort wordt geopend de parameters van de communicatiepoorten te initialiseren, zoals <code>crtscts</code> voor modems die gebruik maken van <code>RTS/CTS</code>-signalering voor gegevensstroombeheer. De slotapparaten worden gebruikt om vlaggen op poorten op slot te zetten om te voorkomen dat gebruikers of programma’s bepaalde parameters veranderen. In de hulppagina’s <a href="https://man.freebsd.org/cgi/man.cgi?query=termios&amp;sektion=4&amp;format=html">termios(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a> staat informatie over respectievelijk terminalinstellingen, apparaten op slot zetten en initialiseren en terminalopties instellen.</p></div></div><div class=sect3><h4 id=serial-hw-config>26.2.5. De seriële poort instellen<a class=anchor href=#serial-hw-config></a></h4><div class=paragraph><p>Het apparaat <span class=filename>ttyuN</span> (of <span class=filename>cuauN</span>) is het gebruikelijke apparaat dat geopend dient te worden voor de applicaties. Wanneer een proces het apparaat opent, heeft het een standaardverzameling aan terminal I/O-instellingen. Bekijk deze instellingen met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># stty -a -f /dev/ttyu1</span></code></pre></div></div><div class=paragraph><p>Als de instellingen van dit apparaat veranderd worden, blijven de instellingen geldig totdat het apparaat gesloten wordt. Als het heropend wordt, gaat het terug naar de standaardverzameling. Om de standaardverzameling te veranderen, dient het apparaat voor de "initiële toestand" geopend te worden en die instellingen veranderd te worden. Om bijvoorbeeld de <code>CLOCAL</code>-modus, 8-bits-communicatie en <code>XON/XOFF</code>-gegevensstroombeheer voor apparaat <span class=filename>ttyu5</span> standaard aan te zetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># stty -f /dev/ttyu5.init clocal cs8 ixon ixoff</span></code></pre></div></div><div class=paragraph><p>De systeembrede initialisatie van de seriële apparaten wordt beheerd in <span class=filename>/etc/rc.d/serial</span>. Dit bestand heeft invloed op de standaardinstellingen van seriële apparaten.</p></div><div class=paragraph><p>Om te voorkomen dat bepaalde instellingen door een applicatie worden veranderd, dienen wijzigingen aan het "slottoestand"-apparaat te worden aangebracht. Om bijvoorbeeld de snelheid van <span class=filename>ttyu5</span> vast te zetten op 57600 bps:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># stty -f /dev/ttyu5.lock 57600</span></code></pre></div></div><div class=paragraph><p>Nu blijft een applicatie die <span class=filename>ttyu5</span> en de snelheid van de poort probeert te veranderen zitten op 57600 bps.</p></div><div class=paragraph><p>Uiteraard dienen de apparaten voor de initiële toestand en de slottoestand alleen voor het account <code>root</code> schrijfbaar te zijn.</p></div></div></div><div class=sect2><h3 id=term>26.3. Terminals<a class=anchor href=#term></a></h3><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Vanaf FreeBSD 8.0 zijn de seriële poorten hernoemd van <span class=filename>/dev/cuadN</span> naar <span class=filename>/dev/cuauN</span> en van <span class=filename>/dev/ttydN</span> naar <span class=filename>/dev/ttyuN</span>. FreeBSD 7.X gebruikers moeten de documentatie aanpassen naar deze wijzigingen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Terminals bieden een handige en goedkope manier om een FreeBSD systeem te benaderen als de console van of een netwerk naar een computer niet beschikbaar is. Deze sectie beschrijft hoe terminals met FreeBSD te gebruiken.</p></div><div class=sect3><h4 id=term-uses>26.3.1. Types terminals en ze gebruiken<a class=anchor href=#term-uses></a></h4><div class=paragraph><p>De originele UNIX®-systemen hadden geen consoles. In plaats daarvan werd er aangemeld en werden programma’s via terminals gedraaid die verbonden waren met de seriële poorten van een computer. Het is goed vergelijkbaar met het gebruik van een modem en terminalsoftware om op een systeem op afstand in te bellen en werk te doen wat alleen uit tekst bestaat.</p></div><div class=paragraph><p>De consoles van hedendaagse PC’s kunnen grafische uitvoer van hoge kwaliteit produceren, maar de mogelijkheid om een aanmeldsessie op een seriële poort tot stand te brengen bestaat nog steeds op bijna elk hedendaags UNIX®-achtig systeem. FreeBSD is geen uitzondering. Door gebruik te maken van een terminal die aangesloten is op een ongebruikte seriële poort, kan er aangemeld worden en kan bijna elk tekstprogramma gedraaid worden dat normaalgesproken op de console of in een <code>xterm</code>-venster in het X Window-systeem gedraaid wordt.</p></div><div class=paragraph><p>Een zakelijke gebruiker kan vele terminals aan een FreeBSD-systeem koppelen en deze op de bureaus van medewerkers neerzetten. Een thuisgebruiker kan een reservecomputer, zoals een oudere IBM PC of een Macintosh®, met de terminal verbinden met een krachtigere computer die FreeBSD draait. Op deze manier kan wat anders een computer voor een enkele gebruiker zou zijn, worden veranderd in een krachtig systeem voor meerdere gebruikers.</p></div><div class=paragraph><p>Er zijn drie soorten terminals voor FreeBSD:</p></div><div class=ulist><ul><li><p><a href=#term-dumb>Domme terminals</a>;</p></li><li><p><a href=#term-pcs>PC’s die als terminals dienen</a>;</p></li><li><p><a href=#term-x>X-terminals</a>.</p></li></ul></div><div class=paragraph><p>De overige subsecties beschrijven elk van deze soorten.</p></div><div class=sect4><h5 id=term-dumb>26.3.1.1. Domme terminals<a class=anchor href=#term-dumb></a></h5><div class=paragraph><p>Domme terminals zijn gespecialiseerde stukken hardware die computers door seriële kabels kunnen verbinden. Ze worden "dom" genoemd omdat ze alleen maar tekst kunnen weergeven, verzenden en ontvangen. Het is niet mogelijk om programma’s op deze terminals te draaien. De computer waar ze op zijn aangesloten heeft de benodigde kracht om tekstverwerkers, compilers, e-mail, spellen, enzovoort te draaien.</p></div><div class=paragraph><p>Er zijn honderden soorten domme terminals gemaakt door vele fabrikanten, inclusief de VT-100 van Digital Equipment Corporation en de WY-75 van Wyse. Bijna elke soort werkt met FreeBSD. Sommige terminals uit de hoogste klasse kunnen zelfs grafisch weergeven, maar slechts bepaalde softwarepakketten kunnen gebruik maken van deze geavanceerde mogelijkheden.</p></div><div class=paragraph><p>Domme terminals zijn ook populair in werkomgevingen waarin gebruikers geen toegang tot grafische applicaties nodig hebben, zoals die door het X Window systeem worden geleverd.</p></div></div><div class=sect4><h5 id=term-pcs>26.3.1.2. PC’s die als terminal dienen<a class=anchor href=#term-pcs></a></h5><div class=paragraph><p>Indien een <a href=#term-dumb>domme terminal</a> net genoeg mogelijkheden heeft om tekst weer te geven, te verzenden en te ontvangen, dan kan zeker elke reserve-PC een domme terminal zijn. De enige benodigdheden zijn de juiste kabel en wat <em>terminal-emulatie</em> software om op de computer te draaien.</p></div><div class=paragraph><p>Zo’n opstelling is populair in thuissituaties. Indien bijvoorbeeld persoon A werkt op de console van een FreeBSD-systeem, kan persoon B wat alleen-tekst-werk verrichten op een minder krachtige PC die als terminal met het FreeBSD-systeem verbonden is.</p></div><div class=paragraph><p>Er zijn minstens twee applicaties beschikbaar in het basissysteem van FreeBSD welke gebruikt kunnen worden om te communiceren door een seriële connectie: <a href="https://man.freebsd.org/cgi/man.cgi?query=cu&amp;sektion=1&amp;format=html">cu(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a>.</p></div><div class=paragraph><p>Om een connectie op te zetten vanaf een systeem dat FreeBSD draait naar een seriële connectie van een andere machine kan het volgende gedaan worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -l serial-port-device</span></code></pre></div></div><div class=paragraph><p>Hierbij is "serial-port-device" de naam is van de speciale apparaatnode die gebruikt wordt voor de seriële poort op het systeem. Deze bestanden heten <span class=filename>/dev/cuauN</span>.</p></div><div class=paragraph><p>Het "N" gedeelte van de apparaatnaam is het nummer van de seriële poort.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Let op, de apparaatnummers beginnen in FreeBSD bij nul en niet bij één (zoals ze bijvoorbeeld wel doen bij MS-DOS® gebaseerde systemen). Dit betekend dat wat MS-DOS® gebaseerde systemen <span class=filename>COM1</span> noemt bij FreeBSD meestal <span class=filename>/dev/cuau0</span> genoemd wordt.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige mensen preferen andere programma’s die beschikbaar zijn via de Ports Collectie. De ports bevatten een aantal programma’s die hetzelfde kunnen werken als <a href="https://man.freebsd.org/cgi/man.cgi?query=cu&amp;sektion=1&amp;format=html">cu(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a>, zoals <a class=package href=https://cgit.freebsd.org/ports/tree/comms/minicom/>comms/minicom</a>.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=term-x>26.3.1.3. X-terminals<a class=anchor href=#term-x></a></h5><div class=paragraph><p>X-terminals behoren tot de meest geavanceerde terminalsoort die beschikbaar is. In plaats van dat ze verbinding maken met een seriële poort, maken ze meestal verbinding met een netwerk zoals Ethernet. In plaats van dat ze alleen tekstapplicaties weergeven, kunnen ze elke X-applicatie weergeven.</p></div><div class=paragraph><p>X-terminals worden slechts voor de compleetheid geïntroduceerd. Dit hoofdstuk behandelt echter <em>niet</em> de installatie, het instellen of het gebruik van X-terminals.</p></div></div></div><div class=sect3><h4 id=term-config>26.3.2. Instellen<a class=anchor href=#term-config></a></h4><div class=paragraph><p>Deze sectie beschrijft wat in te stellen op een os;-systeem om een aanmeldsessie op een terminal mogelijk te maken. De sectie gaat ervan uit dat er al een kernel is ingesteld met ondersteuning voor een seriële poort waar de terminal op is aangesloten en dat deze verbonden is.</p></div><div class=paragraph><p>In <a href=./#boot>Het FreeBSD opstartproces</a> staat beschreven dat het proces <code>init</code> verantwoordelijk is voor het beheer van alle processen en voor de initialisatie tijdens het opstarten van een systeem. Eén van de taken die door <code>init</code> wordt uitgevoerd is het lezen van het bestand <span class=filename>/etc/ttys</span> en het starten van een proces <code>getty</code> op de beschikbare terminals. Het proces <code>getty</code> is verantwoordelijk voor het lezen van een aanmeldnaam en het starten van het programma <code>login</code>.</p></div><div class=paragraph><p>Voer volgende stappen als <code>root</code> uit om terminals voor een FreeBSD-systeem in te stellen:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Voeg een regel aan <span class=filename>/etc/ttys</span> toe voor de ingang in de map <span class=filename>/dev</span> voor een seriële poort als deze er nog niet is;</p></li><li><p>Specificeer dat <code>/usr/libexec/getty</code> uitgevoerd moet worden op de poort en het juiste type <em>getty</em> van het bestand <span class=filename>/etc/gettytab</span>;</p></li><li><p>Specificeer het standaard terminaltype;</p></li><li><p>Stel de poort in op "on";</p></li><li><p>Specificeer of de poort "secure" dient te zijn;</p></li><li><p><code>init</code> dient <span class=filename>/etc/ttys</span> opnieuw te lezen.</p></li></ol></div></div></div><div class=paragraph><p>Als optionele stap kan het wenselijk zijn om een eigen type <em>getty</em> aan te maken voor stap 2 door een ingang in <span class=filename>/etc/gettytab</span> te maken. Dit wordt hier niet beschreven. Meer informatie staat in de hulppagina’s <a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a>.</p></div><div class=sect4><h5 id=term-etcttys>26.3.2.1. Een regel aan <span class=filename>/etc/ttys</span> toevoegen<a class=anchor href=#term-etcttys></a></h5><div class=paragraph><p>Het bestand <span class=filename>/etc/ttys</span> bevat alle poorten op een FreeBSD-systeem waar aanmelden is toegestaan. De eerste virtuele console <span class=filename>ttyv0</span> staat bijvoorbeeld in dit bestand vermeld. Met deze vermelding kan er op de console worden aangemeld. Dit bestand bevat ook vermeldingen voor de andere virtuele consoles, seriële poorten en pseudo-tty’s. Vermeld voor een vast aangesloten terminal de <span class=filename>/dev</span>-regel van de seriële poort zonder het <span class=filename>/dev</span>-gedeelte (<span class=filename>/dev/ttyv0</span> wordt bijvoorbeeld <span class=filename>ttyv0</span>).</p></div><div class=paragraph><p>Een standaard FreeBSD installatie bevat een bestand <span class=filename>/etc/ttys</span> met ondersteuning voor de eerste vier seriële poorten: <span class=filename>ttyu0</span> tot en met <span class=filename>ttyu3</span>. Indien er aan een van deze poorten een terminal wordt gekoppeld is het niet nodig om een regel toe te voegen.</p></div><div id=ex-etc-ttys class=exampleblock><div class=title>Voorbeeld 29. Terminalregels aan <span class=filename>/etc/ttys</span> toevoegen</div><div class=content><div class=paragraph><p>Stel dat er twee terminals verbonden moeten worden met een systeem: een Wyse-50 en een oude 286 IBM-PC waarop Procomm terminalsoftware draait dat een VT-100 terminal emuleert. De Wyse wordt met de tweede seriële poort verbonden en de 286 met de zesde seriële poort (een poort op een meerpoortige seriële kaart). De overeenkomstige regels in <span class=filename>/etc/ttys</span> zien er als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyu1  &#34;/usr/libexec getty std.38400&#34;  wy50  on  insecure
ttyu5   &#34;/usr/libexec/getty std.19200&#34;  vt100  on  insecure</pre></div></div><div class=ulist><ul><li><p>Het eerste veld specificeert normaalgesproken de naam van het speciale terminalbestand zoals dat in <span class=filename>/dev</span> staat.</p></li><li><p>Het tweede veld bevat het commando dat voor deze regel uitgevoerd moet worden, meestal is dit <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a>. <code>getty</code> initialiseert en opent een lijn, stelt een snelheid in, vraagt om een gebruikersnaam en draait daarna het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=login&amp;sektion=1&amp;format=html">login(1)</a>.Het programma <code>getty</code> accepteert één (optionele) parameter op de opdrachtregel, het type <em>getty</em>. Een type <em>getty</em> stelt karakteristieken op een terminallijn in, zoals de bps-snelheid en de pariteit. Het programma <code>getty</code> leest deze karakteristieken uit het bestand <span class=filename>/etc/gettytab</span>.Het bestand <span class=filename>/etc/gettytab</span> bevat een hoop regels voor zowel oude als nieuwe terminallijnen. In bijna alle gevallen werken de regels die met de tekst <code>std</code> beginnen voor vast aangesloten terminals. Deze regels negeren pariteit. Er is een <code>std</code>-regel voor elke bps-snelheid van 110 tot en met 115200. Uiteraard kunnen eigen regels aan dit bestand worden toegevoegd. De hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a> biedt meer informatie.Zorg er tijdens het instellen van het type <em>getty</em> in het bestand <span class=filename>/etc/ttys</span> voor dat de communicatie-instellingen op de terminal ermee over komen.In bovenstaand voorbeeld gebruikt de Wyse-50 geen pariteit en maakt deze verbinding met 38400 bps. De 286 PC gebruikt geen pariteit en maakt verbinding met 19200 bps.</p></li><li><p>Het derde veld bevat het type terminal dat normaalgesproken is verbonden met de tty-lijn. Voor inbelpoorten wordt voor dit veld normaalgesproken <code>unknown</code> of <code>dialup</code> gebruikt omdat gebruikers bijna elk type terminal of software gebruiken om in te bellen. Voor terminals met een vaste aansluiting verandert het type terminal niet, dus kan in dit veld een echt terminaltype uit het databasebestand <a href="https://man.freebsd.org/cgi/man.cgi?query=termcap&amp;sektion=5&amp;format=html">termcap(5)</a> worden gebruikt.In bovenstaand voorbeeld gebruikt de Wyse-50 het echte terminaltype, terwijl de 286 PC die Procomm draait zo ingesteld wordt dat deze een VT-100 emuleert.</p></li><li><p>Het vierde veld geeft aan of de poort aan moet staan. Indien hier <code>on</code> staat, start <code>init</code> het programma in het tweede veld, <code>getty</code>, op. Indien hier <code>off</code> staat wordt <code>getty</code> niet uitgevoerd en kan er daarom niet op de poort worden aangemeld.</p></li><li><p>Het laatste veld geeft aan of de poort veilig is. Indien deze poort als veilig is aangemerkt betekent dit dat er genoeg vertrouwen is om de gebruiker <code>root</code> (of iedere andere account met een gebruikers-id 0) aan te laten melden via deze poort. Onveilige poorten staan aanmelden door <code>root</code> niet toe. Meld op onveilige poorten eerst aan een account zonder rechten en gebruik daarna <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> of een soortgelijk mechanisme om rootrechten te verkrijgen.Het wordt sterk aangeraden om "insecure" zelfs voor terminals achter gesloten deuren te gebruiken. Het is vrij gemakkelijk om aan te melden en <code>su</code> te gebruiken indien rootrechten nodig zijn.</p></li></ul></div></div></div></div><div class=sect4><h5 id=term-hup>26.3.2.2. <code>init</code> forceren om <span class=filename>/etc/ttys</span> opnieuw te lezen<a class=anchor href=#term-hup></a></h5><div class=paragraph><p>Stuur na het maken van de benodigde veranderingen aan het bestand <span class=filename>/etc/ttys</span> een SIGHUP-signaal (ophangen) naar het proces <code>init</code> om het te dwingen het instellingenbestand opnieuw te lezen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -HUP 1</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>init</code> is altijd het eerste proces dat op een systeem gedraaid wordt, daarom heeft het altijd PID 1.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Indien alles juist is ingesteld, alle kabels juist zijn aangesloten en alle terminals aanstaan, draait er op elke terminal een proces <code>getty</code> en is er een aanmeldprompt zichtbaar op de terminals.</p></div></div></div><div class=sect3><h4 id=term-debug>26.3.3. Problemen met een verbinding oplossen<a class=anchor href=#term-debug></a></h4><div class=paragraph><p>Zelfs met de grootste aandacht voor details kan er nog steeds iets mis gaan met het instellen van een terminal. Hier is een lijst van symptomen en mogelijke oplossingen.</p></div><div class=sect4><h5 id=_er_verschijnt_geen_aanmeldprompt>26.3.3.1. Er verschijnt geen aanmeldprompt<a class=anchor href=#_er_verschijnt_geen_aanmeldprompt></a></h5><div class=paragraph><p>Controleer of de terminal is aangesloten en aan staat. Indien het een PC is die als terminal fungeert, controleer of de terminalemulatiesoftware op de juiste seriële poort draait.</p></div><div class=paragraph><p>Controleer of de kabel stevig verbonden is met zowel de terminal als de FreeBSD computer en dat de kabel van het juiste soort is.</p></div><div class=paragraph><p>Controleer of de terminal en FreeBSD dezelfde bps-snelheid en pariteit gebruiken. Indien de terminal een beeldscherm is, controleer dan of de video- en helderheidsniveaus zijn ingesteld. Indien de terminal een printer is, controleer of er voldoende papier en inkt aanwezig zijn.</p></div><div class=paragraph><p>Controleer of er een proces <code>getty</code> draait dat de terminal bedient. Om bijvoorbeeld een lijst van draaiende <code>getty</code>-processen te krijgen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ps -axww|grep getty</span></code></pre></div></div><div class=paragraph><p>Er zou een regel voor de terminal zichtbaar moeten zijn. Het volgende scherm geeft bijvoorbeeld weer dat <code>getty</code> op de tweede seriële poort <span class=filename>ttyu1</span> draait en de regel <code>std.38400</code> in <span class=filename>/etc/gettytab</span> gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>22189  d1  Is+   0:00.03 /usr/libexec/getty std.38400 ttyu1</code></pre></div></div><div class=paragraph><p>Indien er geen proces <code>getty</code> draait, controleer dan of de poort in <span class=filename>/etc/ttys</span> aan staat. Draai <code>kill -HUP 1</code> nadat het bestand <span class=filename>ttys</span> is gewijzigd.</p></div><div class=paragraph><p>Indien het proces <code>getty</code> draait maar de terminal nog steeds geen aanmeldprompt weergeeft of als het een prompt weergeeft maar er niet getypt kan worden, kan het zijn dat de terminal of de kabel hardwarematige handshaking niet ondersteunt. Probeer om de regel in <span class=filename>/etc/ttys</span> van <code>std.38400</code> in <code>3wire.38400</code> te veranderen (draai na het wijzigen van <span class=filename>/etc/ttys</span><code>kill -HUP 1</code>). De regel <code>3wire</code> is vergelijkbaar met de regel <code>std</code>, maar negeert hardwarematige handshaking. Het kan nodig zijn om de baudsnelheid te verlagen of om softwarematig doorvoerbeheer aan te zetten als <code>3wire</code> gebruikt wordt, om overspoelde buffers te voorkomen.</p></div></div><div class=sect4><h5 id=_als_er_rommel_in_plaats_van_een_aanmeldprompt_verschijnt>26.3.3.2. Als er rommel in plaats van een aanmeldprompt verschijnt<a class=anchor href=#_als_er_rommel_in_plaats_van_een_aanmeldprompt_verschijnt></a></h5><div class=paragraph><p>Controleer of de terminal en FreeBSD dezelfde bps-snelheid en pariteit gebruiken. Controleer de <code>getty</code>-processen op het gebruik van het juiste type <code>getty</code>. Indien dit niet het geval is, wijzig dan <span class=filename>/etc/ttys</span> en draai <code>kill -HUP 1</code>.</p></div></div><div class=sect4><h5 id=_tekens_verschijnen_dubbel_enof_het_wachtwoord_verschijnt_tijdens_de_invoer>26.3.3.3. Tekens verschijnen dubbel en/of het wachtwoord verschijnt tijdens de invoer<a class=anchor href=#_tekens_verschijnen_dubbel_enof_het_wachtwoord_verschijnt_tijdens_de_invoer></a></h5><div class=paragraph><p>Wijzig de terminal (of de terminalemulatiesoftware) van "half duplex" of "local echo" naar "full duplex".</p></div></div></div></div><div class=sect2><h3 id=dialup>26.4. Inbeldienst<a class=anchor href=#dialup></a></h3><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Vanaf FreeBSD 8.0 zijn de seriële poorten hernoemd van <span class=filename>/dev/cuadN</span> naar <span class=filename>/dev/cuauN</span> en van <span class=filename>/dev/ttydN</span> naar <span class=filename>/dev/ttyuN</span>. FreeBSD 7.X gebruikers moeten de documentatie aanpassen naar deze wijzigingen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het instellen van het FreeBSD-systeem voor inbeldiensten is vrijwel gelijk aan het verbinden van terminals, behalve dat er met modems in plaats van terminals wordt gewerkt.</p></div><div class=sect3><h4 id=_externe_en_interne_modems>26.4.1. Externe en interne modems<a class=anchor href=#_externe_en_interne_modems></a></h4><div class=paragraph><p>Externe modems lijken gemakkelijker voor het inbellen, omdat externe modems vaak semi-permanent ingesteld kunnen worden via parameters die in een niet-vluchtig RAM worden opgeslagen en ze hebben gewoonlijk LED’s die de toestand van belangrijke RS-232-signalen weergeven. Knipperende LED’s maken indruk op bezoekers, maar LED’s zijn ook zeer nuttig om te zien of een modem goed functioneert.</p></div><div class=paragraph><p>Interne modems hebben vaak geen niet-vluchtig RAM en het kan dus voorkomen dat de instelmogelijkheden beperkt zijn tot het instellen van DIP-schakelaars. Als een intern modem al indicatie-LED’s voor signalen heeft, zijn ze moeilijk te zien in de behuizing van een systeem.</p></div><div class=sect4><h5 id=_modems_en_kabels>26.4.1.1. Modems en kabels<a class=anchor href=#_modems_en_kabels></a></h5><div class=paragraph><p>Bij gebruik van een extern modem is uiteraard een juiste kabel nodig. Een standaard RS-232C seriële kabel moet voldoen zolang alle normale signalen zijn aangesloten.</p></div><table id=serialcomms-signal-names class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 10. Signaalnamen</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Acroniemen</th><th class="tableblock halign-left valign-top">Namen</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Received Data (ontvangen gegevens)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Transmitted Data (verzonden gegevens)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Data Terminal Ready (gegevensterminal gereed)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Data Set Ready (gegevensverzameling gereed)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Data Carrier Detect (RS-232’s detector voor signaal lijn-ontvangen)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Signal Ground (signaalaarde)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Request to Send (verzoek om te zenden)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Clear to Send (gereed om te zenden)</p></td></tr></tbody></table><div class=paragraph><p>FreeBSD heeft de signalen RTS en CTS nodig voor doorstroombeheer bij snelheden van meer dan 2400 bps, het signaal CD om te bepalen wanneer een oproep beantwoord of geannuleerd is, en het signaal DTR om een modem opnieuw in te stellen nadat een sessie voltooid is. Op sommige kabels ontbreken sommige benodigde signalen. Dus als zich problemen voordoen, zoals een aanmeldsessie die niet weggaat nadat de verbinding verbroken is, kan dit aan de kabel liggen.</p></div><div class=paragraph><p>Net als andere UNIX®-achtige besturingssystemen gebruikt FreeBSD hardwaresignalen om te bepalen of een oproep beantwoord of weggedrukt is en om met het modem op te hangen en dit opnieuw in te stellen na een oproep. FreeBSD vermijdt het versturen van commando’s naar een modem en het bekijken van de toestand van een modem. Dit kan vreemd lijken als bekend is hoe modems met PC-gebaseerde prikbordsystemen (BBS) verbinden.</p></div></div></div><div class=sect3><h4 id=_overwegingen_voor_de_seriële_interface>26.4.2. Overwegingen voor de seriële interface<a class=anchor href=#_overwegingen_voor_de_seriële_interface></a></h4><div class=paragraph><p>FreeBSD ondersteunt EIA RS-232C (CCITT V.24) communicatie-interfaces gebaseerd op NS8250, NS1645, NS16550 en NS16550A. De 8250- en 16450-apparaten hebben buffers van een enkel karakter. Het 16550-apparaat biedt een buffer van 16 karakters, wat betere systeemprestaties toestaat. Door fouten in platte 16550’s is het niet mogelijk de buffer van 16 karakters te gebruiken, dus gebruik indien mogelijk 16550A’s. Omdat apparaten met een buffer van een enkel karakter meer werk door het besturingssysteem vereisen dan apparaten met een buffer van 16 karakters, ligt de voorkeur bij seriële interfacekaarten gebaseerd op de 16550A. Indien een systeem veel actieve seriële poorten heeft of zwaar belast wordt, zijn kaarten gebaseerd op de 16550A beter voor communicatie met een lage foutenratio.</p></div></div><div class=sect3><h4 id=_snel_overzicht>26.4.3. Snel overzicht<a class=anchor href=#_snel_overzicht></a></h4><div class=paragraph><p>Net als met terminals zet <code>init</code> een <code>getty</code>-proces op voor elke seriële poort die voor inbelverbindingen is ingesteld. Indien bijvoorbeeld een modem aan <span class=filename>/dev/ttyu0</span> is gekoppeld, kan het commando <code>ps ax</code> het volgende weergeven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>4850 ??  I     0:00.09 /usr/libexec/getty V19200 ttyu0</code></pre></div></div><div class=paragraph><p>Wanneer een gebruiker naar de modemlijn belt en de modems verbinding maken, wordt de CD-lijn (Carrier Detect) door het modem gerapporteerd. De kernel merkt op dat een draaggolf is gesignaleerd en laat <code>getty</code> het openen van de poort voltooien. <code>getty</code> stuurt een prompt <code>login:</code> met de initieel gespecificeerde lijnsnelheid. <code>getty</code> bekijkt of er geldige karakters zijn ontvangen en probeert, in een typische opstelling, indien het rommel aantreft (waarschijnlijk omdat de snelheid waarmee het modem verbindt afwijkt van de snelheid van <code>getty</code>) de lijnsnelheden aan te passen totdat het redelijke karakters ontvangt.</p></div><div class=paragraph><p>Nadat een gebruikersnaam is opgegeven voert <code>getty</code><span class=filename>/usr/bin/login</span> uit, die het aanmelden voltooit door te vragen naar het wachtwoord van een gebruiker en daarna de shell van een gebruiker op te starten.</p></div></div><div class=sect3><h4 id=_instellingenbestanden>26.4.4. Instellingenbestanden<a class=anchor href=#_instellingenbestanden></a></h4><div class=paragraph><p>Er zijn drie systeeminstellingenbestanden in de map <span class=filename>/etc</span> die waarschijnlijk gewijzigd moeten worden om inbellen op een FreeBSD-systeem toe te staan. Het eerste bestand, <span class=filename>/etc/gettytab</span>, bevat informatie om de daemon <span class=filename>/usr/libexec/getty</span> in te stellen. Het tweede bestand, <span class=filename>/etc/ttys</span> bevat informatie voor <span class=filename>/sbin/init</span> dat vertelt op welke <span class=filename>tty</span> apparaten een proces <code>getty</code> moet draaien. Als laatste kunnen in het script <span class=filename>/etc/rc.d/serial</span> commando’s geplaatst worden om poorten te initialiseren.</p></div><div class=paragraph><p>Er bestaan twee stromingen met betrekking tot inbelmodems op UNIX®. De ene houdt ervan om modems en systemen in te stellen zodat de lokale computer-naar-modem RS-232-interface met een vaste snelheid werkt, ongeacht de snelheid waarmee een gebruiker-op-afstand inbelt. Het voordeel van deze instelling is dat een gebruiker-op-afstand altijd meteen een aanmeldprompt van een systeem ziet. Het nadeel is dat een systeem niet weet wat de werkelijke gegevenssnelheid van een gebruiker is en dus passen programma’s die met een volledig scherm werken, zoals Emacs, hun methode om het scherm te tekenen niet aan om hun reactie beter te maken voor langzame verbindingen.</p></div><div class=paragraph><p>De andere stroming stelt de RS-232-interface van een modem zo in dat de snelheid ervan varieert met de verbindingssnelheid van een gebruiker-op-afstand. Zo zorgen V.32bis-verbindingen (14,4 kbps) met een modem ervoor dat een modem de RS-232-interface op 19,2 kbps laat draaien, terwijl verbindingen op 2400 bps ervoor zorgen dat de RS-232-interface van een modem op 2400 bps draait. Omdat <code>getty</code> meldingen over de verbindingssnelheid van een gegeven modem niet begrijpt, geeft <code>getty</code> een bericht <code>login:</code> op een initiële snelheid en kijkt het naar de karakters die als antwoord terugkomen. Als een gebruiker rommel ziet, wordt ervan uitgegaan dat deze weet dat de <kbd>Enter</kbd> toets ingedrukt moet worden totdat een herkenbaar prompt zichtbaar is. Indien de gegevenssnelheden niet overeenkomen, ziet <code>getty</code> alles wat een gebruiker intypt als "rommel", probeert het op de volgende snelheid over te gaan en het geeft opnieuw het prompt <code>login:</code>. Deze procedure kan ad nauseam doorgaan, maar normaal gesproken zijn er slechts een stuk of twee toetsaanslagen nodig voordat een gebruiker een juist prompt ziet. Het is duidelijk dat deze aanmeldprocedure er niet zo mooi uitziet als de methode "vaste-snelheid", maar een gebruiker met een langzame verbinding zou betere interactiviteit moeten beleven met programma’s die met een volledig scherm werken.</p></div><div class=paragraph><p>Deze sectie poogt om neutrale informatie over instellingen te geven, maar is geneigd om de gegevenssnelheid van het modem af te laten hangen van de verbindingssnelheid.</p></div><div class=sect4><h5 id=_etcgettytab>26.4.4.1. <span class=filename>/etc/gettytab</span><a class=anchor href=#_etcgettytab></a></h5><div class=paragraph><p><span class=filename>/etc/gettytab</span> is een bestand met informatie over instellingen voor <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a> in de stijl van <a href="https://man.freebsd.org/cgi/man.cgi?query=termcap&amp;sektion=5&amp;format=html">termcap(5)</a>. In de hulppagina van <a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a> staat de volledige informatie over het formaat van het bestand en de lijst met mogelijkheden.</p></div><div class=sect5><h6 id=_vaste_snelheid_instellen>26.4.4.1.1. Vaste snelheid instellen<a class=anchor href=#_vaste_snelheid_instellen></a></h6><div class=paragraph><p>Indien de snelheid van een modem om gegevens te communiceren op een bepaalde waarde wordt vastgezet, is het waarschijnlijk niet nodig om wijzigingen aan te brengen in <span class=filename>/etc/gettytab</span>.</p></div></div><div class=sect5><h6 id=_overeenkomstige_snelheid_instellen>26.4.4.1.2. Overeenkomstige snelheid instellen<a class=anchor href=#_overeenkomstige_snelheid_instellen></a></h6><div class=paragraph><p>In <span class=filename>/etc/gettytab</span> dient een regel ingesteld te worden om <code>getty</code> informatie te geven over de snelheden die voor het modem gewenst zijn. Indien een 2400 bps modem aanwezig is, kan waarschijnlijk de bestaande regel <code>D2400</code> gebruikt worden.</p></div><div class="literalblock programlisting"><div class=content><pre>#
# Voor snelle inbelterminals, 2400/1200/300 roterend (er kan met beide kanten begonnen worden)
#
D2400|d2400|Fast-Dial-2400:\
	:nx=D1200:tc=2400-baud:
3|D1200|Fast-Dial-1200:\
	:nx=D300:tc=1200-baud:
5|D300|Fast-Dial-300:\
	:nx=D2400:tc=300-baud:</pre></div></div><div class=paragraph><p>Indien er een modem voor hogere snelheden aanwezig is, dient er waarschijnlijk een regel aan <span class=filename>/etc/gettytab</span> toegevoegd te worden. Hieronder staat een regel die gebruikt kan worden voor een 14,4 kbps modem met een maximale interface-snelheid van 19,2 kbps:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# Toevoegingen voor een V.32bis modem
#
um|V300|High Speed Modem at 300,8-bit:\
	:nx=V19200:tc=std.300:
un|V1200|High Speed Modem at 1200,8-bit:\
	:nx=V300:tc=std.1200:
uo|V2400|High Speed Modem at 2400,8-bit:\
	:nx=V1200:tc=std.2400:
up|V9600|High Speed Modem at 9600,8-bit:\
	:nx=V2400:tc=std.9600:
uq|V19200|High Speed Modem at 19200,8-bit:\
	:nx=V9600:tc=std.19200:</pre></div></div><div class=paragraph><p>Dit resulteert in 8-bits verbindingen zonder pariteit.</p></div><div class=paragraph><p>Het bovenstaande voorbeeld begint met een communicatiesnelheid van 19,2 kbps (voor een V.32bis-verbinding), daarna doorloopt het 9600 bps (voor V.32), 2400 bps, 1200 bps, 300 bps en daarna weer 19,2 kbps. Het doorlopen van de communicatiesnelheid is met de mogelijkheid <code>nx=</code> ("volgende tabel") geïmplementeerd. Elk van deze regels gebruikt een regel <code>tc=</code> ("tabel continuëren") om de rest van de "standaard"-instellingen voor een bepaalde gegevenssnelheid op te pikken.</p></div><div class=paragraph><p>Indien er een 28,8 kbps modem aanwezig is en/of het gewenst is om voordeel uit de compressie met een 14,4 kbps te halen, is het nodig om hogere communicatiesnelheden dan 19,2 kbps te gebruiken. Hieronder staat een voorbeeld van een regel voor <span class=filename>gettytab</span> die begint met 57,6 kbps.</p></div><div class="literalblock programlisting"><div class=content><pre>#
# Toevoegingen voor een V.32bis of V.34 modem
# beginnend bij 57,6 kbps
#
vm|VH300|Very High Speed Modem at 300,8-bit:\
	:nx=VH57600:tc=std.300:
vn|VH1200|Very High Speed Modem at 1200,8-bit:\
	:nx=VH300:tc=std.1200:
vo|VH2400|Very High Speed Modem at 2400,8-bit:\
	:nx=VH1200:tc=std.2400:
vp|VH9600|Very High Speed Modem at 9600,8-bit:\
	:nx=VH2400:tc=std.9600:
vq|VH57600|Very High Speed Modem at 57600,8-bit:\
	:nx=VH9600:tc=std.57600:</pre></div></div><div class=paragraph><p>Indien een CPU langzaam of een systeem zwaar belast is en er geen seriële poorten gebaseerd op 16550A aanwezig zijn, kunnen er <code>sio</code> "silo"-fouten optreden bij 57,6 kbps.</p></div></div></div><div class=sect4><h5 id=dialup-ttys>26.4.4.2. <span class=filename>/etc/ttys</span><a class=anchor href=#dialup-ttys></a></h5><div class=paragraph><p>Het instellen van het bestand <span class=filename>/etc/ttys</span> staat beschreven in <a href=#ex-etc-ttys>Terminalregels aan <span class=filename>/etc/ttys</span> toevoegen</a>. Het instellen van modems is vergelijkbaar maar er moet een ander argument aan <code>getty</code> doorgegeven worden en er moet een ander type terminal doorgegeven te worden. Het algemene formaat voor zowel vaste snelheid als overeenkomstige snelheid is:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyu0   &#34;/usr/libexec/getty xxx&#34;   dialup on</pre></div></div><div class=paragraph><p>Het eerste item op bovenstaande regel is het speciale apparaatbestand. <span class=filename>ttyu0</span> betekent dat <span class=filename>/dev/ttyu0</span> het bestand is dat door <code>getty</code> in de gaten wordt gehouden. Het tweede item, <code>"/usr/libexec/gettyxxx"</code> (<em>xxx</em> wordt vervangen door de initiële mogelijkheden van <span class=filename>gettytab</span>) is het proces dat door <code>init</code> op het apparaat gedraaid wordt. Het derde item, <code>dialup</code>, is het standaard terminaltype. De vierde parameter, <code>on</code>, geeft aan <code>init</code> aan dat de lijn operationeel is. Er kan een vijfde parameter zijn, <code>secure</code>, maar gebruik deze alleen voor terminals die fysiek veilig zijn (zoals de systeemconsole).</p></div><div class=paragraph><p>Het standaard terminaltype (<code>dialup</code> in bovenstaand voorbeeld) mag afhangen van lokale voorkeuren. Het traditionele standaard terminaltype voor inbellijnen is <code>dialup</code>, zodat gebruikers hun aanmeldscripts kunnen aanpassen om op te merken wanneer het terminal <code>dialup</code> is en automatisch hun terminaltype kunnen aanpassen. Wellicht is het makkelijker om <code>vt102</code> als het standaard terminaltype te specificeren, aangezien gebruikers gewoon VT102-emulatie op hun systemen-op-afstand gebruiken.</p></div><div class=paragraph><p>Nadat <span class=filename>/etc/ttys</span> gewijzigd is, kan aan het proces <code>init</code> een signaal HUP gestuurd worden om het bestand opnieuw te laten lezen. Gebruik volgende opdracht om het signaal te versturen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -HUP 1</span></code></pre></div></div><div class=paragraph><p>Indien een systeem voor de eerste keer wordt geïnstalleerd, is het verstandig te wachten totdat een modem juist ingesteld en verbonden is voordat het signaal aan <code>init</code> verstuurd wordt.</p></div><div class=sect5><h6 id=_vaste_snelheid_instellen_2>26.4.4.2.1. Vaste snelheid instellen<a class=anchor href=#_vaste_snelheid_instellen_2></a></h6><div class=paragraph><p>Voor het instellen van een vaste snelheid dient de regel in <span class=filename>ttys</span> een vaste snelheid door te geven aan <code>getty</code>. Voor een modem met een vaste poortsnelheid van 19,2 kbps kan de regel in <span class=filename>ttys</span> er als volgt uitzien:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyu0   &#34;/usr/libexec/getty std.19200&#34;   dialup on</pre></div></div><div class=paragraph><p>Indien een modem op een andere gegevenssnelheid is ingesteld, dient de juiste waarde voor <code>std.snelheid</code> in plaats van <code>std.19200</code> ingesteld te worden. Gebruik een geldig type dat in <span class=filename>/etc/gettytab</span> vermeld staat.</p></div></div><div class=sect5><h6 id=_overeenkomstige_snelheid_instellen_2>26.4.4.2.2. Overeenkomstige snelheid instellen<a class=anchor href=#_overeenkomstige_snelheid_instellen_2></a></h6><div class=paragraph><p>Voor het instellen van een overeenkomstige snelheid dient de regel in <span class=filename>ttys</span> te verwijzen naar regel met de juiste begin-"auto-baud" (sic). Indien bijvoorbeeld de boven voorgestelde regel voor een modem met een overeenkomstige snelheid die begint met 19,2 kbps wordt toegevoegd (de regel in <span class=filename>gettytab</span> die het beginpunt <code>V19200</code>), kan de regel in <span class=filename>ttys</span> er als volgt uitzien:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyu0   &#34;/usr/libexec/getty V19200&#34;   dialup on</pre></div></div></div></div><div class=sect4><h5 id=_etcrc_dserial>26.4.4.3. <span class=filename>/etc/rc.d/serial</span><a class=anchor href=#_etcrc_dserial></a></h5><div class=paragraph><p>Hogesnelheidsmodems, zoals V.32, V.32bis, en V.34 modems, moeten gebruik maken van hardwarematig (<code>RTS/CTS</code>) gegevensstroombeheer. Er kunnen <code>stty</code>-opdrachten aan <span class=filename>/etc/rc.d/serial</span> toegevoegd worden om de vlag voor hardwarematig gegevensstroombeheer in de kernel van FreeBSD voor modempoorten in te stellen.</p></div><div class=paragraph><p>Om bijvoorbeeld de <code>termios</code>-vlag <code>crtscts</code> op de apparaten die de in- en uitbelapparaten initialiseren op de eerste seriële poort (<span class=filename>COM2</span>) in te stellen, kunnen de volgende regels aan <span class=filename>/etc/rc.d/serial</span> worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre># Seriële poort initieel instellen
stty -f /dev/ttyu1.init crtscts
stty -f /dev/cuau1.init crtscts</pre></div></div></div></div><div class=sect3><h4 id=_modeminstellingen>26.4.5. Modeminstellingen<a class=anchor href=#_modeminstellingen></a></h4><div class=paragraph><p>Bij gebruik van een modem waarvan de parameters permanent in niet-vluchtig RAM ingesteld kunnen worden, is er een terminalprogramma (zoals Telix onder MS-DOS® of <code>tip</code> onder FreeBSD) nodig om parameters in te stellen. Maak een verbinding met een modem met dezelfde communicatiesnelheid als de initiële snelheid die door <code>getty</code> gebruikt wordt en stel het niet-vluchtige RAM van een modem in zodat aan deze voorwaarden voldaan wordt:</p></div><div class=ulist><ul><li><p>CD geldt tijdens verbindingen;</p></li><li><p>DTR geldt tijdens gebruik; het loslaten van DTR hangt de verbinding op en stelt het modem opnieuw in;</p></li><li><p>gegevensstroombeheer door CTS verzonden;</p></li><li><p>gegevensstroombeheer met XON/XOFF uitgezet;</p></li><li><p>gegevensstroombeheer door RTS ontvangen;</p></li><li><p>Stille modus (geen resultaatcodes);</p></li><li><p>Geen opdrachtecho.</p></li></ul></div><div class=paragraph><p>Kijk in de documentatie van een modem voor de benodigde opdrachten en/of instellingen van DIP-schakelaars.</p></div><div class=paragraph><p>Om de bovenstaande parameters bijvoorbeeld op een U.S. Robotics® Sportster® 14.400 extern modem in te stellen, kunnen de volgende opdrachten aan het modem gegeven worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ATZ
AT&amp;C1;&amp;D2&amp;H1&amp;I0&amp;R2&amp;W</pre></div></div><div class=paragraph><p>In deze fase kunnen ook andere modeminstellingen aangepast worden, zoals of het V.42bis en/of MNP5 compressie wordt gebruiken.</p></div><div class=paragraph><p>Een U.S. Robotics®Sportster® 14.400 externe modem heeft ook enkele DIP-schakelaars die ingesteld moeten worden. Voor andere modems kunnen deze instellingen wellicht als voorbeeld dienen:</p></div><div class=ulist><ul><li><p>Schakelaar 1: UP: DTR Normal</p></li><li><p>Schakelaar 2: N/A (Verbal Result Codes/Numeric Result Codes)</p></li><li><p>Schakelaar 3: UP: Suppress Result Codes</p></li><li><p>Schakelaar 4: DOWN: Geen echo, offline opdrachten</p></li><li><p>Schakelaar 5: UP: Auto Answer</p></li><li><p>Schakelaar 6: UP: Carrier Detect Normal</p></li><li><p>Schakelaar 7: UP: Load NVRAM Defaults</p></li><li><p>Schakelaar 8: N/A (Smart Mode/Dumb Mode)</p></li></ul></div><div class=paragraph><p>Schakel resultaatcodes voor alle inbelmodems uit of onderdruk ze om problemen te voorkomen die kunnen optreden als <code>getty</code> abusievelijk een prompt <code>login:</code> geeft aan een modem dat in opdrachtmodus staat en het modem de opdracht echoot of een resultaatcode teruggeeft. Deze sequentie kan tot een uitgebreide, onnozele discussie tussen <code>getty</code> en het modem leiden.</p></div><div class=sect4><h5 id=_vaste_snelheid_instellen_3>26.4.5.1. Vaste snelheid instellen<a class=anchor href=#_vaste_snelheid_instellen_3></a></h5><div class=paragraph><p>Stel voor een vaste snelheid een modem zodanig in dat die een constante gegevenssnelheid naar de computer, onafhankelijk van de communicatiesnelheid, behoudt. Op een U.S. Robotics® Sportster® 14.400 extern modem zetten de volgende opdrachten de gegevenssnelheid naar de computer vast op de snelheid die gebruikt werd om de opdrachten te geven:</p></div><div class="literalblock programlisting"><div class=content><pre>ATZ
AT&amp;B1&amp;W</pre></div></div></div><div class=sect4><h5 id=_overeenkomstige_snelheid_instellen_3>26.4.5.2. Overeenkomstige snelheid instellen<a class=anchor href=#_overeenkomstige_snelheid_instellen_3></a></h5><div class=paragraph><p>Stel voor een variabele snelheid een modem zodanig in dat het de gegevenssnelheid van zijn seriële poort aanpast aan de snelheid van een binnenkomende oproep. Op een U.S. Robotics® Sportster® 14.400 extern modem zetten de volgende opdrachten de gegevenssnelheid van het modem, die op fouten gecorrigeerd wordt, vast op de snelheid die gebruikt werd om de opdrachten te geven, maar staan ze toe dat de snelheid van de seriële poort varieert voor verbindingen die niet op fouten gecorrigeerd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ATZ
AT&amp;B2&amp;W</pre></div></div></div><div class=sect4><h5 id=_de_modeminstellingen_controleren>26.4.5.3. De modeminstellingen controleren<a class=anchor href=#_de_modeminstellingen_controleren></a></h5><div class=paragraph><p>De meeste modems die op hoge snelheid werken, bieden opdrachten om de huidige werkparameters van een modem in een min of meer voor mensen leesbare vorm te bekijken. Op het U.S. Robotics® Sportster® 14.400 extern modem beeldt de opdracht <code>ATI5</code> de instellingen af die in het niet-vluchtige RAM zijn opgeslagen. Gebruik om de werkelijke werkparameters van een modem te zien (zoals beïnvloed door de stand van de DIP-schakelaars van een modem) de opdrachten <code>ATZ</code> gevolgd door <code>ATI4</code>.</p></div><div class=paragraph><p>Kijk in de handleiding van een modem als er met een ander merk modem gewerkt wordt voor het controleren van de parameters voor het instellen van dat modem.</p></div></div></div><div class=sect3><h4 id=_problemen_oplossen_4>26.4.6. Problemen oplossen<a class=anchor href=#_problemen_oplossen_4></a></h4><div class=paragraph><p>Hier volgen wat stappen die gevolgd kunnen worden om een inbelmodem op een systeem te controleren.</p></div><div class=sect4><h5 id=_een_freebsd_systeem_controleren>26.4.6.1. Een FreeBSD-systeem controleren<a class=anchor href=#_een_freebsd_systeem_controleren></a></h5><div class=paragraph><p>Verbind een modem met een FreeBSD-systeem, start het systeem op en kijk, indien het modem lampjes bevat die de toestand aangeven, of de DTR-indicator oplicht als het prompt <code>login:</code> op de systeemconsole verschijnt. Als het oplicht zou dit betekenen dat FreeBSD een <code>getty</code>-proces heeft gestart op de juiste communicatiepoort en wacht op het modem om een gesprek aan te nemen.</p></div><div class=paragraph><p>Geef als de DTR-indicator niet oplicht, na aanmelden op de console, de opdracht <code>ps ax</code> om te zien of FreeBSD probeert een <code>getty</code>-proces op de juiste poort te draaien. Er dienen tussen de weergegeven processen regels zoals de onderstaande te verschijnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  114 ??  I      0:00.10 /usr/libexec/getty V19200 ttyu0
  115 ??  I      0:00.10 /usr/libexec/getty V19200 ttyu1</code></pre></div></div><div class=paragraph><p>Er kan ook iets als het volgende verschijnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  114 d0  I      0:00.10 /usr/libexec/getty V19200 ttyu0</code></pre></div></div><div class=paragraph><p>Als het modem nog geen gesprek heeft aangenomen, betekent dit dat <code>getty</code> het openen van de communicatiepoort voltooid heeft. Dit kan duiden op een probleem met de bekabeling of op een verkeerd ingesteld modem omdat <code>getty</code> niet in staat zou moeten zijn om de communicatiepoort te openen totdat CD (kiestoon) door het modem is bevestigd.</p></div><div class=paragraph><p>Indien er geen enkel <code>getty</code>-proces verschijnt dat wacht op het openen van de gewenste poort <span class=filename>ttyuN</span>, controleer dan de regels in <span class=filename>/etc/ttys</span> op vergissingen. Controleer ook het logboekbestand <span class=filename>/var/log/messages</span> om te zien of er logboekberichten van <code>init</code> of <code>getty</code> met betrekking tot problemen zijn. Indien er problemen zijn, controleer dan nogmaals de instellingenbestanden <span class=filename>/etc/ttys</span> en <span class=filename>/etc/gettytab</span>, alsook de betreffende speciale apparaatbestanden <span class=filename>/dev/ttyuN</span>, op vergissingen, ontbrekende regels of ontbrekende speciale apparaatbestanden.</p></div></div><div class=sect4><h5 id=_proberen_om_in_te_bellen>26.4.6.2. Proberen om in te bellen<a class=anchor href=#_proberen_om_in_te_bellen></a></h5><div class=paragraph><p>Probeer in te bellen op een systeem. Controleer of op het systeem-op-afstand 8 bits, geen pariteit en 1 stopbit gebruikt wordt. Probeer, indien er niet meteen een prompt verschijnt of als er rommel verschijnt, ongeveer eens per seconde op <kbd>Enter</kbd> te drukken. Probeer, indien er na een tijd nog geen prompt <code>login:</code> verschijnt, een <code>BREAK</code> te versturen. Probeer, indien er een modem wordt gebruikt dat op hoge snelheid werkt om te bellen, opnieuw in te bellen nadat de interfacesnelheid van het bellende modem is vastgezet (bijvoorbeeld via <code>AT&amp;B1</code> op een U.S. Robotics® Sportster® modem).</p></div><div class=paragraph><p>Controleer, indien er nog steeds geen prompt <code>login:</code> verschijnt, nogmaals <span class=filename>/etc/gettytab</span> en controleer of:</p></div><div class=ulist><ul><li><p>De initiële specificatie die in <span class=filename>/etc/ttys</span> voor de lijn staat overeenkomt met een naam van een specificatie in <span class=filename>/etc/gettytab</span>;</p></li><li><p>Elke regel <code>nx=</code> overeenkomt met een naam van een andere specificatie in <span class=filename>gettytab</span>;</p></li><li><p>Elke regel <code>tc=</code> overeenkomt met een naam van een andere specificatie in <span class=filename>gettytab</span>.</p></li></ul></div><div class=paragraph><p>Controleer, indien er gebeld wordt maar het modem op het FreeBSD-systeem niet reageert, of het modem ingesteld is om de telefoon te beantwoorden als DTR bevestigd is. Controleer, indien het modem juist ingesteld lijkt te zijn, of de DTR-lijn bevestigd is door de indicatielampjes van het modem te controleren (indien die aanwezig zijn).</p></div><div class=paragraph><p>Neem een pauze en probeer het later nog eens indien alles meerdere malen is geprobeerd en het nog steeds niet werkt. Indien het nog steeds niet werkt, stuur dan een e-mail naar de <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD algemene vragen mailinglijst</a> met een beschrijving van het modem en het probleem en de mensen op de lijst zullen proberen te helpen.</p></div></div></div></div><div class=sect2><h3 id=dialout>26.5. Uitbeldienst<a class=anchor href=#dialout></a></h3><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Vanaf FreeBSD 8.0 zijn de seriële poorten hernoemd van <span class=filename>/dev/cuadN</span> naar <span class=filename>/dev/cuauN</span> en van <span class=filename>/dev/ttydN</span> naar <span class=filename>/dev/ttyuN</span>. FreeBSD 7.X gebruikers moeten de documentatie aanpassen naar deze wijzigingen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De volgende tips dienen voor het maken van een verbinding met een andere computer per modem. Dit is geschikt voor het opzetten van een terminalsessie met een gast op afstand.</p></div><div class=paragraph><p>Dit is nuttig bij het aanmelden op een BBS.</p></div><div class=paragraph><p>Dit soort verbinding kan extreem behulpzaam zijn om een bestand op het Internet te krijgen indien er problemen zijn met PPP. Indien FTP ergens voor nodig is en PPP kapot is, kan de terminalsessie voor FTP gebruikt worden. Vervolgens kan zmodem gebruikt worden om het naar de machine te verzenden.</p></div><div class=sect3><h4 id=hayes-unsupported>26.5.1. Een gewone Hayes-modem wordt niet ondersteund, wat nu?<a class=anchor href=#hayes-unsupported></a></h4><div class=paragraph><p>In feite is de hulppagina voor <code>tip</code> verouderd. Er is al een generiek belprogramma voor Hayes ingebouwd. Gebruik <code>at=hayes</code> in het bestand <span class=filename>/etc/remote</span>.</p></div><div class=paragraph><p>Het stuurprogramma voor Hayes is niet slim genoeg om enkele geavanceerde eigenschappen van nieuwere modems te herkennen. Berichten als <code>BUSY</code> (in gesprek), <code>NO DIALTONE</code> (geen kiestoon) of <code>CONNECT 115200</code> (verbinden 115200) verwarren het stuurprogramma. Schakel deze berichten uit bij gebruik van <code>tip</code> (door middel van <code>ATX0&amp;W</code>).</p></div><div class=paragraph><p>Verder is de beltimeout voor <code>tip</code> 60 seconden. Het modem dient een lagere waarde te gebruiken om te voorkomen dat <code>tip</code> denkt dat er een probleem met de communicatie is. Probeer <code>ATS7=45&amp;W</code>.</p></div></div><div class=sect3><h4 id=direct-at>26.5.2. Hoe deze <code>AT</code>-commando’s in te geven?<a class=anchor href=#direct-at></a></h4><div class=paragraph><p>Maak een zogenaamde "directe" regel in het bestand <span class=filename>/etc/remote</span> aan. Als het modem bijvoorbeeld aan de eerste seriële poort, <span class=filename>/dev/cuau0</span>, is gekoppeld, voeg dan de volgende regel toe:</p></div><div class="literalblock programlisting"><div class=content><pre>cuau0:dv=/dev/cuau0:br#19200:pa=none</pre></div></div><div class=paragraph><p>Gebruik voor de mogelijkheid <code>br</code> de hoogst ondersteunde snelheid van het modem in bps. Typ hierna <code>tip cuau0</code> om een verbinding met het modem te maken.</p></div><div class=paragraph><p>Als alternatief kan <code>cu</code> als <code>root</code> met het volgende commando gebruikt worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu</span>
	  <span class=nt>-llijn</span>
	  <span class=nt>-ssnelheid</span></code></pre></div></div><div class=paragraph><p>De waarde <em>lijn</em> is de seriële poort (bijvoorbeeld <span class=filename>/dev/cuau0</span>) en <em>snelheid</em> is de snelheid (bijvoorbeeld <code>57600</code>). Als alle AT-commando’s zijn ingevoerd, voer dan <code>~.</code> in om het programma te verlaten.</p></div></div><div class=sect3><h4 id=gt-failure>26.5.3. Het teken <code>@</code> voor de optie pn werkt niet!<a class=anchor href=#gt-failure></a></h4><div class=paragraph><p>Het teken <code>@</code> in de telefoonnummermogelijkheid vertelt <code>tip</code> om in <span class=filename>/etc/phones</span> naar een telefoonnummer te kijken. Maar het teken <code>@</code> is ook een speciaal teken in specificatiebestanden als <span class=filename>/etc/remote</span>. Gebruik een backslash om hieraan te ontsnappen:</p></div><div class="literalblock programlisting"><div class=content><pre>pn=\@</pre></div></div></div><div class=sect3><h4 id=dial-command-line>26.5.4. Hoe een telefoonnummer op de opdrachtregel te draaien?<a class=anchor href=#dial-command-line></a></h4><div class=paragraph><p>Voeg een zogenaamde "generieke" regel aan het bestand <span class=filename>/etc/remote</span> toe. Bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>tip115200|Bel elk telefoonnummer met 115200 bps:\
        :dv=/dev/cuau0:br#115200:at=hayes:pa=none:du:
tip57600|Bel elk telefoonnummer met 57600 bps:\
        :dv=/dev/cuau0:br#57600:at=hayes:pa=none:du:</pre></div></div><div class=paragraph><p>Hierna zijn onder andere de volgende mogelijkheden beschikbaar:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tip -115200 5551234</span></code></pre></div></div><div class=paragraph><p>Indien <code>cu</code> boven <code>tip</code> geprefereerd wordt, dient een generieke regel voor <code>cu</code> gebruikt te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>cu115200|Gebruik cu om elk nummer met 115200bps te bellen:\
	:dv=/dev/cuau1:br#57600:at=hayes:pa=none:du:</pre></div></div><div class=paragraph><p>Voer in:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu 5551234 -s 115200</span></code></pre></div></div></div><div class=sect3><h4 id=set-bps>26.5.5. Dient de bps-snelheid telkens ingevoerd te worden?<a class=anchor href=#set-bps></a></h4><div class=paragraph><p>Voeg een regel toe voor <code>tip1200</code> of <code>cu1200</code>, maar gebruik een bps-snelheid die geschikt is voor de br-mogelijkheid. <code>tip</code> meent dat 1200 bps een goede standaardwaarde is, hierdoor zoekt het naar een regel <code>tip1200</code>. Uiteraard hoeft 1200 bps niet gebruikt te worden.</p></div></div><div class=sect3><h4 id=terminal-server>26.5.6. Een aantal hosts met een terminalserver benaderen<a class=anchor href=#terminal-server></a></h4><div class=paragraph><p>Om niet iedere keer te hoeven wachten totdat er verbinding is en <code>CONNECT host</code> in te typen, kan de mogelijkheid <code>cm</code> van <code>tip</code> gebruikt worden. Als voorbeeld bieden de onderstaande regels in <span class=filename>/etc/remote</span> de mogelijkheid om <code>tip pain</code> of <code>tip muffin</code> in te typen om met de hosts <code>pain</code> of <code>muffin</code> te verbinden, en <code>tip deep13</code> om naar de terminalserver te gaan:</p></div><div class="literalblock programlisting"><div class=content><pre>pain|pain.deep13.com|Forresters machine:\
        :cm=CONNECT pain\n:tc=deep13:
muffin|muffin.deep13.com|Franks machine:\
        :cm=CONNECT muffin\n:tc=deep13:
deep13:Gizmonics Institute terminalserver:\
        :dv=/dev/cuau2:br#38400:at=hayes:du:pa=none:pn=5551234:</pre></div></div></div><div class=sect3><h4 id=tip-multiline>26.5.7. Kan tip meer dan één lijn voor elke site proberen?<a class=anchor href=#tip-multiline></a></h4><div class=paragraph><p>Dit is een vaak een probleem als een universiteit een handvol modemlijnen en enkele duizenden studenten heeft die ze proberen te gebruiken.</p></div><div class=paragraph><p>Voeg een regel voor de universiteit toe in <span class=filename>/etc/remote</span> en gebruik <code>@</code> voor de mogelijkheid <code>pn</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>grote-universiteit:\
        :pn=\@:tc=dialout
dialout:\
        :dv=/dev/cuau3:br#9600:at=courier:du:pa=none:</pre></div></div><div class=paragraph><p>Voeg hierna de telefoonnummers voor de universiteit toe aan <span class=filename>/etc/phones</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>grote-universiteit 5551111
grote-universiteit 5551112
grote-universiteit 5551113
grote-universiteit 5551114</pre></div></div><div class=paragraph><p>Het commando <code>tip</code> probeert elk nummer in de volgorde van de lijst alvorens op te geven. Om de pogingen te herhalen, kan <code>tip</code> in een while-lus gedraaid worden.</p></div></div><div class=sect3><h4 id=multi-controlp>26.5.8. Waarom moet <span class=keyseq><kbd>Ctrl</kbd>+<kbd>P</kbd></span> tweemaal worden ingedrukt om <span class=keyseq><kbd>Ctrl</kbd>+<kbd>P</kbd></span> éénmaal te versturen?<a class=anchor href=#multi-controlp></a></h4><div class=paragraph><p><span class=keyseq><kbd>Ctrl</kbd>+<kbd>P</kbd></span> is het standaard "forceer"-karakter, dat gebruikt wordt om <code>tip</code> te vertellen dat het volgende karakter letterlijk genomen dient te worden. Het forceerkarakter kan met de ontsnapping <code>~s</code>, wat "stel een variabele in" betekent, op elk ander karakter ingesteld worden.</p></div><div class=paragraph><p>Typ <code>~sforce=enkel-karakter</code> in gevolgd door een nieuwe regel. <em>enkel-karakter</em> is elk enkel karakter. Indien <em>enkel-karakter</em> weggelaten wordt, is het forceerkarakter het nulkarakter, wat door middel van <span class=keyseq><kbd>Ctrl</kbd>+<kbd>2</kbd></span> of <span class=keyseq><kbd>Ctrl</kbd>+<kbd>spatie</kbd></span> verkregen kan worden. Een redelijke standaardwaarde voor <em>enkel-karakter</em> is <span class=keyseq><kbd>Shift</kbd>+<kbd>Ctrl</kbd>+<kbd>6</kbd></span>, die slechts op enkele terminalservers gebruikt wordt.</p></div><div class=paragraph><p>Het forceerkarakter kan op elk gewenst karakter ingesteld worden door het volgende op te nemen in het bestand <span class=filename>$HOME/.tiprc</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>force=enkel-karakter</pre></div></div></div><div class=sect3><h4 id=uppercase>26.5.9. Alle ingevoerde tekst staat opeens in hoofdletters?<a class=anchor href=#uppercase></a></h4><div class=paragraph><p>Waarschijnlijk is <span class=keyseq><kbd>Ctrl</kbd>+<kbd>A</kbd></span> ingedrukt, het "raisechar" van <code>tip</code>, dat speciaal voor mensen met een kapotte caps-lock toets is ontworpen. Gebruik <code>~s</code> zoals boven is aangegeven en stel de variabele <code>raisechar</code> op iets redelijks in. Het kan zelfs op hetzelfde als het forceerkarakter worden ingesteld, indien het onwaarschijnlijk is dat een van deze mogelijkheden ooit gebruikt wordt.</p></div><div class=paragraph><p>Hier volgt een voorbeeld voor het bestand <span class=filename>.tiprc</span> dat perfect is voor gebruikers van Emacs die <span class=keyseq><kbd>Ctrl</kbd>+<kbd>2</kbd></span> en <span class=keyseq><kbd>Ctrl</kbd>+<kbd>A</kbd></span> vaak moeten gebruiken:</p></div><div class="literalblock programlisting"><div class=content><pre>force=^^
raisechar=^^</pre></div></div><div class=paragraph><p>De <code>^^</code> is <span class=keyseq><kbd>Shift</kbd>+<kbd>Ctrl</kbd>+<kbd>6</kbd></span>.</p></div></div><div class=sect3><h4 id=tip-filetransfer>26.5.10. Hoe kan met <code>tip</code> bestanden worden verstuurd?<a class=anchor href=#tip-filetransfer></a></h4><div class=paragraph><p>In de communicatie met een ander UNIX®-systeem kunnen bestanden verzonden en ontvangen worden met de commando’s <code>~p</code> (put) en <code>~t</code> (take). Deze commando’s draaien <code>cat</code> en <code>echo</code> op een systeem op afstand om bestanden aan te nemen en te verzenden. De syntaxis is:</p></div><div class=paragraph><p><code>~p</code> lokaal-bestand [ bestand-op-afstand ]</p></div><div class=paragraph><p><code>~t</code> bestand-op-afstand [ lokaal-bestand ]</p></div><div class=paragraph><p>Er wordt niet op fouten gecontroleerd, het is dus verstandig om een ander protocol te gebruiken, zoals zmodem.</p></div></div><div class=sect3><h4 id=zmodem-tip>26.5.11. Hoe kan zmodem samen met <code>tip</code> draaien?<a class=anchor href=#zmodem-tip></a></h4><div class=paragraph><p>Start om bestanden te ontvangen het verstuurprogramma aan de andere kant. Typ daarna <code>~C rz</code> om ze lokaal te ontvangen.</p></div><div class=paragraph><p>Start om bestanden te versturen het ontvangprogramma aan de andere kant. Typ daarna <code>~C sz bestanden</code> om ze naar het systeem aan de andere kant te versturen.</p></div></div></div><div class=sect2><h3 id=serialconsole-setup>26.6. Seriële console opzetten<a class=anchor href=#serialconsole-setup></a></h3><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Vanaf FreeBSD 8.0 zijn de seriële poorten hernoemd van <span class=filename>/dev/cuadN</span> naar <span class=filename>/dev/cuauN</span> en van <span class=filename>/dev/ttydN</span> naar <span class=filename>/dev/ttyuN</span>. FreeBSD 7.X gebruikers moeten de documentatie aanpassen naar deze wijzigingen.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=serialconsole-intro>26.6.1. Inleiding<a class=anchor href=#serialconsole-intro></a></h4><div class=paragraph><p>FreeBSD biedt de mogelijkheid om op een systeem op te starten met slechts een domme terminal en een seriële poort als console. Dit soort opstellingen is handig voor twee soorten mensen: voor systeembeheerders die FreeBSD willen installeren op machines die geen toetsenbord of beeldscherm hebben en voor ontwikkelaars die de kernel of apparaatstuurprogramma’s willen debuggen.</p></div><div class=paragraph><p>Zoals beschreven in <a href=./#boot>Het FreeBSD opstartproces</a>, gebruikt FreeBSD drie fasen voor het opstarten. De eerste twee fasen bevinden zich in de code van het opstartblok dat zich aan het begin van de opstartslice van FreeBSD op de opstartschijf bevindt. Het opstartblok laadt vervolgens de opstartlader (<span class=filename>/boot/loader</span>) en draait als de code van de derde fase.</p></div><div class=paragraph><p>Om de seriële console gereed te maken moeten de code in het opstartblok, de code van de opstartlader en de kernel worden ingesteld.</p></div></div><div class=sect3><h4 id=serialconsole-howto-fast>26.6.2. De seriële console instellen, korte versie<a class=anchor href=#serialconsole-howto-fast></a></h4><div class=paragraph><p>Deze sectie neemt aan dat de standaard opstelling wordt gebruikt en dat een kort overzicht voor het opzetten van de seriële console gewenst is.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Verbind de seriële kabel met <span class=filename>COM1</span> en de leidende terminal;</p></li><li><p>Om alle opstartmeldingen op de seriële console te zien, dient het volgende commando als supergebruiker uitgevoerd te worden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;console=&#34;comconsole&#34;&#39; &gt;&gt; /boot/loader.conf</span></code></pre></div></div></li><li><p>Bewerk <span class=filename>/etc/ttys</span> en wijzig <code>off</code> in <code>on</code> en <code>dialup</code> in <code>vt100</code> voor de regel <span class=filename>ttyu0</span>. Indien dit niet gebeurt is er geen wachtwoord nodig om met de seriële console te verbinden, wat tot een mogelijk beveiligingslek leidt;</p></li><li><p>Start het systeem opnieuw op om te zien of de veranderingen effect hebben.</p></li></ol></div></div></div><div class=paragraph><p>Indien een andere instelling nodig is, is er een diepgaandere uitleg over instellingen beschikbaar in <a href=#serialconsole-howto>De seriële console instellen</a>.</p></div></div><div class=sect3><h4 id=serialconsole-howto>26.6.3. De seriële console instellen<a class=anchor href=#serialconsole-howto></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Bereid een seriële kabel voor.</p><div class=paragraph><p>Benodigd zijn een nulmodem-kabel òf een standaard seriële kabel samen met een nulmodem-adapter. Zie <a href=#serial-cables-ports>Kabels en poorten</a> voor een beschrijving van seriële kabels.</p></div></li><li><p>Ontkoppel het toetsenbord.</p><div class=paragraph><p>De meeste PC-systemen zoeken naar het toetsenbord tijdens de Power-On Self-Test (POST) en geven een foutmelding als het toetsenbord niet is gevonden. Sommige systemen klagen luid over het ontbreken van een toetsenbord en gaan niet verder met opstarten totdat het is aangesloten.</p></div><div class=paragraph><p>Indien de computer klaagt over de fout, maar desondanks opstart, is het niet nodig iets speciaals te doen. Sommige machines waarop Phoenix BIOS is geïnstalleerd melden enkel <code>Toetsenbord faalde</code> en gaan normaal door met opstarten.</p></div><div class=paragraph><p>Indien de machine weigert zonder toetsenbord op te starten dient het BIOS ingesteld te worden zodat het deze fout negeert (als het dit kan). Raadpleeg het handboek van het moederbord voor verdere aanwijzingen.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Stel het toetsenbord in op "Niet geïnstalleerd" in de BIOS-instellingen. Het is dan nog steeds mogelijk om het toetsenbord te gebruiken. Dit zorgt er alleen voor dat het BIOS niet naar een toetsenbord zoekt tijdens het aanzetten. Het BIOS dient niet te klagen als het toetsenbord ontbreekt. Het is mogelijk om het toetsenbord aangesloten te laten, zelfs als deze vlag is ingesteld op "Niet geïnstalleerd" en het toetsenbord werkt nog steeds. Kijk, als de bovenstaande optie niet in het BIOS aanwezig is, naar een optie "Halt on Error". Het instellen van deze optie op "All but keyboard" of zelfs op "No Errors" zal hetzelfde effect hebben.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als een systeem een PS/2®-muis heeft, is het goed mogelijk dat naast het toetsenbord ook de muis losgekoppeld moet worden. Dit komt doordat PS/2®-muizen wat hardware met het toetsenbord delen. Als de muis aangesloten blijft, kan het zoeken naar het toetsenbord als resultaat hebben dat het toetsenbord er nog steeds is. Een Gateway 2000 Pentium 90 MHz systeem met een AMI BIOS schijnt zich op deze manier te gedragen. Over het algemeen is dit geen probleem aangezien een muis zonder toetsenbord sowieso weinig nut heeft.</p></div></td></tr></tbody></table></div></li><li><p>Sluit een domme terminal aan op <span class=filename>COM1</span> (<span class=filename>sio0</span>).</p><div class=paragraph><p>Indien er geen domme terminal aanwezig is, kan een oude PC met een modemprogramma of de seriële poort van een andere UNIX® machine gebruikt worden. Indien er geen <span class=filename>COM1</span> (<span class=filename>sio0</span>) aanwezig is dient deze geregeld te worden. Op dit moment is er geen manier om een andere poort dan <span class=filename>COM1</span> voor de opstartblokken te selecteren, afgezien van deze opnieuw te compileren. Indien <span class=filename>COM1</span> al voor een ander apparaat gebruikt wordt, verwijder dat apparaat dan tijdelijk en installeer een nieuw opstartblok en een nieuwe kernel zodra FreeBSD werkt. Er wordt aangenomen dat <span class=filename>COM1</span> sowieso beschikbaar is op een bestands-/reken-/terminalserver. Als <span class=filename>COM1</span> ècht voor iets anders nodig is (en het niet mogelijk is om dat op <span class=filename>COM2</span> (<span class=filename>sio1</span>) over te zetten), is het sowieso al onverstandig om hiermee bezig te zijn.)</p></div></li><li><p>Controleer of het instellingenbestand van de kernel de juiste vlaggen ingesteld heeft voor <span class=filename>COM1</span> (<span class=filename>sio0</span>).</p><div class=paragraph><p>Relevante vlaggen zijn:</p></div><div class=dlist><dl><dt class=hdlist1><code>0x10</code></dt><dd><p>Zet console-ondersteuning voor deze eenheid aan. De andere consolevlaggen worden genegeerd tenzij deze is aangezet. Momenteel kan ten hoogste één eenheid console-ondersteuning hebben. De eerste (in de volgorde van het instellingenbestand) waarvan deze vlag is aangezet heeft de voorkeur. Deze optie zelf maakt de seriële poort geen console. Stel de volgende vlag in of gebruik de onderstaande optie <code>-h</code> samen met deze vlag.</p></dd><dt class=hdlist1><code>0x20</code></dt><dd><p>Dwingt deze eenheid om de console te zijn (tenzij er een andere console met hogere prioriteit is), ongeacht de onderstaande optie <code>-h</code>. De vlag <code>0x20</code> dient samen met de vlag <code>0x10</code> gebruikt te worden.</p></dd><dt class=hdlist1><code>0x40</code></dt><dd><p>Reserveert deze eenheid (in samenwerking met <code>0x10</code>) en maakt de eenheid ontoegankelijk voor normale toegang. Deze vlag dient niet aangezet te worden op de seriële poort van de eenheid die als seriële console gebruikt gaat worden. De enige functie van deze vlag is de eenheid voor het debuggen van de kernel op afstand aan te merken. Zie het <a href=https://docs.freebsd.org/en/books/developers-handbook/>Ontwikkelaarshandboek</a> voor meer informatie over debuggen op afstand.</p><div class=paragraph><p>Voorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>device sio0 at isa? port IO_COM1 flags 0x10 irq 4</pre></div></div><div class=paragraph><p>Zie de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> voor meer details.</p></div><div class=paragraph><p>Indien de vlaggen niet waren ingesteld, dient UserConfig gedraaid te worden (op een andere console) of de kernel opnieuw gecompileerd te worden.</p></div></dd></dl></div></li><li><p>Maak <span class=filename>boot.config</span> aan in de hoofdmap van de partitie <code>a</code> van de opstartschijf.</p><div class=paragraph><p>Dit bestand instrueert de code op het opstartblok hoe het systeem opgestart dient te worden. Om de seriële console te activeren, zijn één of meer van de volgende opties nodig. Indien meerdere opties gewenst zijn, dienen ze allemaal op dezelfde regel te staan:</p></div><div class=dlist><dl><dt class=hdlist1><code>-h</code></dt><dd><p>Wisselt tussen de interne en de seriële console. Indien bijvoorbeeld vanaf de interne (video)console opgestart wordt, kan <code>-h</code> gebruikt worden om het console-apparaat van de opstartlader en de kernel om te leiden naar de seriële console. Indien vanaf de seriële poort opgestart wordt, kan <code>-h</code> gebruikt worden om de opstartlader en de kernel het videoscherm als console te laten gebruiken.</p></dd><dt class=hdlist1><code>-D</code></dt><dd><p>Wisselt tussen opstellingen met een enkele en een dubbele console. In opstellingen met een enkele console is de console òfwel de interne console (videoscherm) òfwel de seriële poort, afhankelijk van bovenstaande optie <code>-h</code>. In opstellingen met een dubbele console worden zowel het videoscherm als de seriële poort tegelijkertijd console, ongeacht de toestand van de optie <code>-h</code>. De opstelling met een dubbele console heeft alleen effect als het opstartblok draait. Zodra de opstartlader het overneemt, wordt de console die met de optie <code>-h</code> gespecificeerd is de enige console.</p></dd><dt class=hdlist1><code>-P</code></dt><dd><p>Zorgt ervoor dat het opstartblok naar het toetsenbord zoekt. Als er geen toetsenbord wordt gevonden, worden de opties <code>-D</code> en <code>-h</code> automatisch ingesteld.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Vanwege ruimtebeperkingen in de huidige versie van het opstartblok, is de optie <code>-P</code> alleen in staat om uitgebreide toetsenborden te detecteren. Toetsenborden met minder dan 101 toetsen (en zonder de toetsen F11 en F12) worden mogelijk niet gedetecteerd. Toetsenborden op sommige laptops worden vanwege deze beperking mogelijk niet correct gevonden. Indien dit het geval is met een systeem, vermijd dan de optie <code>-P</code>. Helaas is er geen mogelijkheid om dit probleem te omzeilen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Gebruik om de console automatisch te selecteren òfwel de optie <code>-P</code> òfwel de optie <code>-h</code> om de seriële console te activeren.</p></div><div class=paragraph><p>De andere opties beschreven in <a href="https://man.freebsd.org/cgi/man.cgi?query=boot&amp;sektion=8&amp;format=html">boot(8)</a> kunnen ook gebruikt worden.</p></div><div class=paragraph><p>De opties, behalve <code>-P</code>, worden aan de opstartlader (<span class=filename>/boot/loader</span> doorgegeven. De opstartlader bepaalt of de interne videopoort of de seriële poort de console wordt door enkel naar de toestand van de optie <code>-h</code> te kijken. Dit betekent dat als de optie <code>-D</code>, maar niet de optie <code>-h</code> in <span class=filename>/boot.config</span> gespecificeerd wordt, de seriële poort alleen tijdens het opstartblok als console gebruikt kan worden, de opstartlader gebruikt het interne videoscherm als console.</p></div></dd></dl></div></li><li><p>Start de machine op.</p><div class=paragraph><p>Als FreeBSD gestart wordt, tonen de opstartblokken de inhoud van <span class=filename>/boot.config</span> op de console. Bijvoorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/boot.config: <span class=nt>-P</span>
Keyboard: no</code></pre></div></div><div class=paragraph><p>De tweede regel verschijnt alleen als <code>-P</code> in <span class=filename>/boot.config</span> staat en aangegeven wordt of het toetsenbord aanwezig of afwezig is. Deze berichten gaan of naar de seriële of interne console of naar beide, afhankelijk van de optie in <span class=filename>/boot.config</span>.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Opties</th><th class="tableblock halign-left valign-top">Bericht gaat naar</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>geen</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>interne console</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-h</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>seriële console</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-D</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>seriële en interne consoles</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-Dh</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>seriële en interne consoles</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, toetsenbord aanwezig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>interne console</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, toetsenbord afwezig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>seriële console</p></td></tr></tbody></table><div class=paragraph><p>Na de bovenstaande berichten is er een korte pauze voordat de opstartblokken doorgaan met het laden van de opstartlader en voordat er verdere berichten op de console worden afgebeeld. Normaalgesproken hoeven de opstartblokken niet onderbroken te worden, maar het kan gedaan worden om er zeker van te zijn dat alles goed is ingesteld.</p></div><div class=paragraph><p>Om het opstartproces te onderbreken, kan op elke andere toets dan <kbd>Enter</kbd> gedrukt worden. De opstartblokken vragen dan om verdere actie. Er verschijnt iets als het volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>&gt;&gt;</span> FreeBSD/i386 BOOT
Default: 0:ad<span class=o>(</span>0,a<span class=o>)</span>/boot/loader
boot:</code></pre></div></div><div class=paragraph><p>Controleer of de bovenstaande boodschap naar de seriële of interne console of beide gaat, naar gelang de opties in <span class=filename>/boot.config</span>. Indien de boodschap op de juiste console verschijnt kan op <kbd>Enter</kbd> gedrukt worden om het opstartproces voort te zetten.</p></div><div class=paragraph><p>Als de seriële console gewenst is maar de prompt niet op de seriële terminal verschijnt, is er iets mis met de instellingen. Voer in de tussentijd <code>-h</code> in en druk op <kbd>Enter</kbd> of <kbd>Return</kbd> (indien mogelijk) om aan het opstartblok (en vervolgens de opstartlader en de kernel) te vertellen dat de seriële poort console moet worden. Controleer als het systeem draait wat er verkeerd ging.</p></div></li></ol></div></div></div><div class=paragraph><p>Nadat de opstartlader is geladen en het derde stadium van het opstartproces bereikt is, kan er nog steeds gewisseld worden tussen de interne console en de seriële console door de juiste omgevingsvariabelen in de opstartlader in te stellen. Zie <a href=#serialconsole-loader>De console vanuit de opstartlader veranderen</a>.</p></div></div><div class=sect3><h4 id=serialconsole-summary>26.6.4. Samenvatting<a class=anchor href=#serialconsole-summary></a></h4><div class=paragraph><p>Hieronder volgt een samenvatting van de verschillende instellingen die in deze sectie en de uiteindelijk gekozen console beschreven zijn.</p></div><div class=sect4><h5 id=_geval_1_vlaggen_ingesteld_op_0x10_voor_sio>26.6.4.1. Geval 1: vlaggen ingesteld op 0x10 voor <span class=filename>sio</span><a class=anchor href=#_geval_1_vlaggen_ingesteld_op_0x10_voor_sio></a></h5><div class="literalblock programlisting"><div class=content><pre>device sio0 at isa? port IO_COM1 flags 0x10 irq 4</pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Opties in /boot.config</th><th class="tableblock halign-left valign-top">Console tijdens de opstartblokken</th><th class="tableblock halign-left valign-top">Console tijdens de opstartlader</th><th class="tableblock halign-left valign-top">Console in kernel</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>niets</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-h</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-D</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel en intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-Dh</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel en intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, toetsenbord aanwezig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, toetsenbord afwezig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel en intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td></tr></tbody></table></div><div class=sect4><h5 id=_geval_2_vlaggen_ingesteld_op_0x30_voor_sio>26.6.4.2. Geval 2: vlaggen ingesteld op 0x30 voor <span class=filename>sio</span><a class=anchor href=#_geval_2_vlaggen_ingesteld_op_0x30_voor_sio></a></h5><div class="literalblock programlisting"><div class=content><pre>device sio0 at isa? port IO_COM1 flags 0x30 irq 4</pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Opties in /boot.config</th><th class="tableblock halign-left valign-top">Console tijdens de opstartblokken</th><th class="tableblock halign-left valign-top">Console tijdens de opstartlader</th><th class="tableblock halign-left valign-top">Console in kernel</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>niets</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-h</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-D</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel en intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-Dh</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel en intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, toetsenbord aanwezig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, toetsenbord afwezig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel en intern</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>serieel</p></td></tr></tbody></table></div></div><div class=sect3><h4 id=serialconsole-tips>26.6.5. Tips voor de seriële console<a class=anchor href=#serialconsole-tips></a></h4><div class=sect4><h5 id=_een_hogere_snelheid_voor_de_seriële_poort_instellen>26.6.5.1. Een hogere snelheid voor de seriële poort instellen<a class=anchor href=#_een_hogere_snelheid_voor_de_seriële_poort_instellen></a></h5><div class=paragraph><p>Standaard zijn de instellingen van de seriële poort: 9600 baud, 8 bits, geen pariteit, en 1 stopbit. Indien het wenselijk is om de snelheid te veranderen, zijn de volgened opties beschikbaar:</p></div><div class=ulist><ul><li><p>Hercompileer de opstart blokken met <code>BOOT_COMCONSOLE_SPEED</code> ingesteld op de nieuwe console snelheid. Zie <a href=#serialconsole-com2>Een andere seriële poort dan <span class=filename>sio0</span> voor de console gebruiken</a> voor gedetailleerde instructies over het bouwen en installeren van nieuwe opstartblokken.</p><div class=paragraph><p>Als de seriële poort anders is gespecificeerd dan met <code>-h</code> bij het opstarten, of als de seriële console die gebruikt wordt door de kernel anders is dan die gebruikt wordt door de opstart blokken, dan moet de volgende optie aan het kernel instellingen bestand worden toegevoegd en moet de kernel opnieuw gecompileerd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>options CONSPEED=19200</pre></div></div></li><li><p>Gebruik de <code>-S</code> opstartoptie van de kernel. De optie <code>-S</code> kan worden toegevoegd aan het bestand <span class=filename>/boot.config</span>. Zie de handleiding <a href="https://man.freebsd.org/cgi/man.cgi?query=boot&amp;sektion=8&amp;format=html">boot(8)</a> voor een beschrijving over hoe opties kunnen worden toegevoegd aan <span class=filename>/boot.conf</span>, en welke opties ondersteund worden.</p></li><li><p>Zet de <code>comconsole_speed</code> optie in het <span class=filename>/boot/loader.conf</span> bestand.</p><div class=paragraph><p>Deze optie is ervan afhankelijk dat de <code>console</code>, <code>boot_serial</code> en <code>boot_multicons</code> ingesteld staan in <span class=filename>/boot/loader.conf</span>. Een voorbeeld van hoe <code>comconsole_speed</code> gebruikt kan worden om de console snelheid aan te passen:</p></div><div class="literalblock programlisting"><div class=content><pre>boot_multicons=&#34;YES&#34;
boot_serial=&#34;YES&#34;
console_speed=&#34;115200&#34;
console=&#34;comconsole,vidconsole&#34;</pre></div></div></li></ul></div></div><div class=sect4><h5 id=serialconsole-com2>26.6.5.2. Een andere seriële poort dan <span class=filename>sio0</span> voor de console gebruiken<a class=anchor href=#serialconsole-com2></a></h5><div class=paragraph><p>Het gebruik van een andere poort dan <span class=filename>sio</span> vergt wat hercompileren. Indien het gewenst is om een andere seriële poort te gebruiken, hercompileer dan de opstartblokken, de opstartlader en de kernel als volgt:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>De broncode van de kernel moet beschikbaar zijn. Zie <a href=./#updating-upgrading>FreeBSD updaten en upgraden</a>;</p></li><li><p>Bewerk <span class=filename>/etc/make.conf</span> en stel <code>BOOT_COMCONSOLE_PORT</code> in op het adres van de te gebruiken poort (0x3F8, 0x2F8, 0x3E8 of 0x2E8). Alleen <span class=filename>sio0</span> tot en met <span class=filename>sio3</span> (<span class=filename>COM1</span> tot en met <span class=filename>COM4</span>) zijn te gebruiken. Seriële kaarten met meerdere poorten werken niet. Interrupts instellen is niet nodig;</p></li><li><p>Maak een aangepast kernelinstellingenbestand aan en voeg de juiste vlaggen toe voor de te gebruiken seriële poort. Als bijvoorbeeld <span class=filename>sio1</span> (<span class=filename>COM2</span>) de console moet worden:</p><div class="literalblock programlisting"><div class=content><pre>device sio1 at isa? port IO_COM2 flags 0x10 irq 3</pre></div></div><div class=paragraph><p>Alternatief:</p></div><div class="literalblock programlisting"><div class=content><pre>device sio1 at isa? port IO_COM2 flags 0x30 irq 3</pre></div></div><div class=paragraph><p>Stel de consolevlaggen voor de andere seriële poorten niet in;</p></div></li><li><p>Hercompileer en installeer de opstartblokken en de opstartlader:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /sys/boot</span>
<span class=c># make clean</span>
<span class=c># make</span>
<span class=c># make install</span></code></pre></div></div></li><li><p>Herbouw en installeer de kernel;</p></li><li><p>Schrijf de opstartblokken met <a href="https://man.freebsd.org/cgi/man.cgi?query=disklabel&amp;sektion=8&amp;format=html">disklabel(8)</a> naar de opstartschijf en start met de nieuwe kernel op.</p></li></ol></div></div></div></div><div class=sect4><h5 id=serialconsole-ddb>26.6.5.3. De debugger DDB gebruiken via de seriële verbinding<a class=anchor href=#serialconsole-ddb></a></h5><div class=paragraph><p>Als het wenselijk is om vanuit de seriële console in de kerneldebugger te vallen - nuttig voor diagnose op afstand, maar ook gevaarlijk indien een onbedoelde BREAK op de seriële poort wordt gegenereerd! - compileer de kernel dan met de volgende opties:</p></div><div class="literalblock programlisting"><div class=content><pre>options BREAK_TO_DEBUGGER
options DDB</pre></div></div></div><div class=sect4><h5 id=_een_aanmeldprompt_op_de_seriële_console_krijgen>26.6.5.4. Een aanmeldprompt op de seriële console krijgen<a class=anchor href=#_een_aanmeldprompt_op_de_seriële_console_krijgen></a></h5><div class=paragraph><p>Hoewel dit niet nodig is, kan het gewenst zijn om een <em>aanmeld</em>prompt over de seriële lijn te krijgen, nu het mogelijk is om opstartboodschappen te zien en de kerneldebugsessie door de seriële console betreden kan worden. Hier volgt hoe het te doen.</p></div><div class=paragraph><p>Open het bestand <span class=filename>/etc/ttys</span> met een tekstverwerker en zoek de volgende regels:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyu0 &#34;/usr/libexec/getty std.9600&#34; unknown off secure
ttyu1 &#34;/usr/libexec/getty std.9600&#34; unknown off secure
ttyu2 &#34;/usr/libexec/getty std.9600&#34; unknown off secure
ttyu3 &#34;/usr/libexec/getty std.9600&#34; unknown off secure</pre></div></div><div class=paragraph><p><span class=filename>ttyu0</span> tot en met <span class=filename>ttyu3</span> komen overeen met <span class=filename>COM1</span> tot en met <span class=filename>COM4</span>. Wijzig <code>off</code> in <code>on</code> voor de gewenste poort. Als de snelheid van de seriële poort is gewijzigd, wijzig dan <code>std.9600</code> zodat het met de huidige instelling overeenkomt, bijvoorbeeld <code>std.19200</code>.</p></div><div class=paragraph><p>Het kan ook wenselijk zijn om het terminaltype te wijzigen van <code>unknown</code> naar het eigenlijke type van de seriële terminal.</p></div><div class=paragraph><p>Voer <code>kill -HUP 1</code> uit na het wijzigen van het bestand om de wijzigingen actief te maken.</p></div></div></div><div class=sect3><h4 id=serialconsole-loader>26.6.6. De console vanuit de opstartlader veranderen<a class=anchor href=#serialconsole-loader></a></h4><div class=paragraph><p>De vorige secties beschreven hoe de seriële console ingesteld kan worden door het instellen van het opstartblok. Deze sectie toont dat het mogelijk is om de console te specificeren door het invoeren van enkele opdrachten en omgevingsvariabelen in de opstartlader. Aangezien de opstartlader tijdens het derde stadium van het opstartproces wordt geactiveerd, na het opstartblok, overheersen de instellingen in de opstartlader de instellingen in het opstartblok.</p></div><div class=sect4><h5 id=_de_seriële_console_instellen>26.6.6.1. De seriële console instellen<a class=anchor href=#_de_seriële_console_instellen></a></h5><div class=paragraph><p>Het is mogelijk om de opstartlader en de kernel gebruik te laten maken van de seriële console door slechts één regel naar <span class=filename>/boot/loader.conf</span> te schrijven:</p></div><div class="literalblock programlisting"><div class=content><pre>console=&#34;comconsole&#34;</pre></div></div><div class=paragraph><p>Dit heeft effect ongeacht de instellingen in het opstartblok die in de vorige sectie zijn besproken.</p></div><div class=paragraph><p>Het is verstandig om bovenstaande regel de eerste regel van <span class=filename>/boot/loader.conf</span> te maken om de opstartboodschappen zo vroeg mogelijk op de seriële console te kunnen zien.</p></div><div class=paragraph><p>Evenzo kan de interne videoconsole worden gespecificeerd met:</p></div><div class="literalblock programlisting"><div class=content><pre>console=&#34;vidconsole&#34;</pre></div></div><div class=paragraph><p>Indien de omgevingsvariabele <code>console</code> van de opstartlader niet ingesteld wordt, gebruikt de opstartlader, en vervolgens de kernel, de console die door de optie <code>-h</code> in het opstartblok wordt aangegeven.</p></div><div class=paragraph><p>De console kan worden gespecificeerd in <span class=filename>/boot/looader.conf.local</span> of in <span class=filename>/boot/loader.conf</span>.</p></div><div class=paragraph><p>Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> voor meer informatie.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Momenteel heeft de opstartlader een optie die gelijk is aan de optie <code>-P</code> van het opstartblok en is er geen voorziening om automatisch de interne console en de seriële console te selecteren afhankelijk van de aanwezigheid van een toetsenbord.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_een_andere_seriële_poort_dan_sio_voor_de_console_gebruiken>26.6.6.2. Een andere seriële poort dan <span class=filename>sio</span> voor de console gebruiken<a class=anchor href=#_een_andere_seriële_poort_dan_sio_voor_de_console_gebruiken></a></h5><div class=paragraph><p>Compileer de opstartlader opnieuw om een andere seriële poort dan <span class=filename>sio</span> voor de seriële console te gebruiken. Volg de procedure zoals beschreven in <a href=#serialconsole-com2>Een andere seriële poort dan <span class=filename>sio0</span> voor de console gebruiken</a>.</p></div></div></div><div class=sect3><h4 id=serialconsole-caveats>26.6.7. Valkuilen<a class=anchor href=#serialconsole-caveats></a></h4><div class=paragraph><p>De doelstelling van dit stuk is beheerders in staat te stellen om toegewijde servers te installeren die geen grafische hardware of aangesloten toetsenborden nodig hebben. Hoewel de meeste systemen zonder toetsenbord opstarten, zijn er helaas aardig wat die niet zonder een grafische adapter opstarten. Machines met een AMI BIOS kunnen ingesteld worden om zonder grafische adapter op te starten door de instelling "graphics adapter" in de CMOS-instellingen te wijzigen in "Not installed".</p></div><div class=paragraph><p>De meeste systemen ondersteunen deze optie echter niet en weigeren om zonder weergavehardware op te starten. Voor deze machines is het nodig om een of andere grafische kaart in een systeem te laten (zelfs al is het een aftandse monochrome kaart) hoewel het niet nodig is om een beeldscherm aan te sluiten. Ook kan geprobeerd worden om een AMI BIOS te installeren.</p></div></div></div></div></div><div class=sect1><h2 id=ppp-and-slip>Hoofdstuk 27. PPP en SLIP<a class=anchor href=#ppp-and-slip></a></h2><div class=sectionbody><div class=sect2><h3 id=ppp-and-slip-synopsis>27.1. Overzicht<a class=anchor href=#ppp-and-slip-synopsis></a></h3><div class=paragraph><p>FreeBSD heeft een aantal manieren om de ene computer met de andere te verbinden. Om een netwerk of internet verbinding op te zetten door een inbelmodem, of om anderen toe te staan dit te doen door de machine heen vereist het gebruik van PPP en SLIP. Dit hoofdstuk beschrijft het opzetten van op modems gebaseerde diensten in meer detail.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet u:</p></div><div class=ulist><ul><li><p>Hoe gebruikers PPP opgezet kan worden.</p></li><li><p>Hoe kernel-PPP opgezet kan worden (alleen voor FreeBSD 7.X).</p></li><li><p>Hoe PPPoE opgezet kan worden (PPP over Ethernet).</p></li><li><p>Hoe PPPoA opgezet kan worden (PPP over ATM).</p></li><li><p>Hoe een SLIP-server en cliënt opgezet kan worden en hoe dat geconfigureerd wordt (alleen voor FreeBSD 7.X).</p></li></ul></div><div class=paragraph><p>Voordat dit hoofdstuk gelezen wordt, moet u:</p></div><div class=ulist><ul><li><p>Bekend zijn met basis netwerk terminologie.</p></li><li><p>De basis en doeleinden van een inbel verbinding en van PPP en/of SLIP.</p></li></ul></div><div class=paragraph><p>U kunt zich afvragen wat het verschil is tussen gebruiker-PPP en kernel-PPP. Het antwoord is simpel: gebruiker-PPP verwerkt inkomend en uitgaande data in het gebruikersland in plaats van in de kernel. Dit is duur in de zin van het kopiëren van de data tussen de kernel en het gebruikersland, maar levert meer mogelijkheden voor de PPP implementatie. Gebruikers PPP gebruikt het <span class=filename>tun</span> apparaat om te communiceren met de buitenwereld. Kernel-PPP maakt gebruik van het <span class=filename>ppp</span> apparaat.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voor de rest van dit hoofdstuk, zal gebruiker-PPP gebruikt worden als ppp tenzij er onderscheid gemaakt moet worden met andere PPP software zoals pppd. Tenzij anders vermeld moeten alle uitgelegde commando’s in dit hoofdstuk gestart worden als de <code>root</code> gebruiker.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=userppp>27.2. Gebruikmaken van gebruiker-PPP<a class=anchor href=#userppp></a></h3><div class=sect3><h4 id=_gebruiker_ppp>27.2.1. Gebruiker-PPP<a class=anchor href=#_gebruiker_ppp></a></h4><div class=sect4><h5 id=_vereisten>27.2.1.1. Vereisten<a class=anchor href=#_vereisten></a></h5><div class=paragraph><p>Dit document gaat er vanuit dat u de volgende punten beschikbaar heeft:</p></div><div class=ulist><ul><li><p>Een account bij een Internet Service Provider (ISP) waarmee verbinding gemaakt wordt door middel van PPP.</p></li><li><p>Een modem of een ander apparaat verbonden met uw PC en correct geconfigureerd zodat u verbinding kan maken met uw ISP.</p></li><li><p>De inbelnummers van uw ISP.</p></li><li><p>Uw loginnaam en wachtwoord (danwel een combinatie van een standaard UNIX®-stijl login en wachtwoord of een PAP of CHAP login en wachtwoordcombinatie).</p></li><li><p>Het IP-adres van één of meerdere naamservers. Normaal gesproken krijgt u twee IP adressen van uw ISP om te gebruiken. Als u er echter geen één gekregen heeft, kunt u het commando <code>enable dns</code> gebruiken in <span class=filename>ppp.conf</span> en ppp zal de naamservers voor u configureren. Deze optie is afhankelijk van de PPP implementatie van de ISP, welke DNS onderhandeling moet ondersteunen.</p></li></ul></div><div class=paragraph><p>De volgende informatie kan aangeleverd worden door uw ISP maar is niet echt noodzakelijk:</p></div><div class=ulist><ul><li><p>Het IP-adres van de router van uw ISP. De router is de machine waarmee u verbinding maakt en welke ingesteld wordt als de <em>standaard route</em>. Als u deze informatie niet heeft, kunt u een willekeurig adres verzinnen waarna de PPP server van de ISP het juiste adres vertelt zodra u verbinding maakt.</p><div class=paragraph><p>Dit IP-adres wordt door ppp <code>HISADDR</code> genoemd.</p></div></li><li><p>Het netwerkmasker wat gebruikt moet worden. Als uw ISP deze niet heeft opgegeven, kan <code>255.255.255.255</code> gebruikt worden.</p></li><li><p>Als uw ISP u een vast IP-adres en hostnaam levert, kunt u deze invoeren. In andere gevallen bepaalt de andere kant welk adres er uitgegeven wordt.</p></li></ul></div><div class=paragraph><p>Als u niet in bezit bent van de vereiste informatie, moet u contact opnemen met uw ISP.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Door de rest van dit hoofdstuk worden in veel van de voorbeelden configuratie bestanden genummerd per regel. Deze nummers dienen alleen als hulp voor de presentatie en discussie en zijn verder niet bedoeld om daadwerkelijk geïmplementeerd te worden. Een juiste inspringing met tabs en spaties zijn daarbij ook belangrijk.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_automatische_configuratie_van_ppp>27.2.1.2. Automatische configuratie van PPP<a class=anchor href=#_automatische_configuratie_van_ppp></a></h5><div class=paragraph><p>Zowel <code>ppp</code> als <code>pppd</code> (de implementatie van PPP op kernel niveau) gebruiken de configuratie bestanden die zich in de map <span class=filename>/etc/ppp</span> bevinden. Voorbeelden configuraties voor gebruiker-PPP kunnen gevonden worden in <span class=filename>/usr/shared/examples/ppp/</span>.</p></div><div class=paragraph><p>Het configureren van <code>ppp</code> vereist dat u een aantal bestanden bewerkt, afhankelijk van uw eisen. Wat u moet invoeren is deels afhankelijk van wat uw ISP u aanbied met oog op statische IP-adressen (lees u krijgt een statisch adres welke u altijd gebruikt) of dynamisch (lees: uw IP-adres veranderd elke keer als u verbinding maakt met uw ISP).</p></div><div class=sect5><h6 id=userppp-staticIP>27.2.1.2.1. PPP en statische IP-adressen<a class=anchor href=#userppp-staticIP></a></h6><div class=paragraph><p>U moet het <span class=filename>/etc/ppp/ppp.conf</span> bewerken. Het zou dan als volgend eruit moeten zien:</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Regels die eindigen met een <code>:</code> starten in de eerste kolom (het begin van de regel) - alle andere regels moeten inspringen zoals getoond door middel van spaties of tabs.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>1     default:
2       set log Phase Chat LCP IPCP CCP tun command
3       ident user-ppp VERSION (built COMPILATIONDATE)
4       set device /dev/cuau0
5       set speed 115200
6       set dial &#34;ABORT BUSY ABORT NO\\sCARRIER TIMEOUT 5 \
7                 \&#34;\&#34; AT OK-AT-OK ATE1Q0 OK \\dATDT\\T TIMEOUT 40 CONNECT&#34;
8       set timeout 180
9       enable dns
10
11    provider:
12      set phone &#34;(123) 456 7890&#34;
13      set authname foo
14      set authkey bar
15      set login &#34;TIMEOUT 10 \&#34;\&#34; \&#34;\&#34; gin:--gin: \\U word: \\P col: ppp&#34;
16      set timeout 300
17      set ifaddr x.x.x.x y.y.y.y 255.255.255.255 0.0.0.0
18      add default HISADDR</pre></div></div><div class=dlist><dl><dt class=hdlist1>Regel 1</dt><dd><p>Deze regel identificeert de standaard regel. Commando’s in deze regel worden automatisch gestart zodra ppp gestart wordt.</p></dd><dt class=hdlist1>Regel 2</dt><dd><p>Zet de log paramaters aan. Zodra de configuratie naar verwachting werkt, moet deze regel aangepast worden naar:</p><div class="literalblock programlisting"><div class=content><pre>set log phase tun</pre></div></div><div class=paragraph><p>om te voorkomen dat er extreem grote log files gemaakt worden.</p></div></dd><dt class=hdlist1>Regel 3</dt><dd><p>Vertelt PPP hoe het zich moet identificeren aan de router aan de andere kant, als deze problemen heeft met het onderhandelen en het opzetten van de link en het leveren van informatie die de beheerders van de andere kant nuttig kunnen vinden om zulke problemen te onderzoeken.</p></dd><dt class=hdlist1>Regel 4</dt><dd><p>Identificeert het apparaat waarmee het modem verbonden is. <span class=filename>COM1</span> is <span class=filename>/dev/cuau0</span> en <span class=filename>COM2</span> is <span class=filename>/dev/cuau1</span>.</p></dd><dt class=hdlist1>Regel 5</dt><dd><p>Stelt de snelheid in waarmee verbinding gemaakt wordt. Als 115200 niet werkt (wat wel zou moeten kunnen met elk nieuw modem), probeert u dan de instelling van 38400.</p></dd><dt class=hdlist1>Regels 6 & 7</dt><dd><p>De inbelregel. Gebruiker-PPP gebruikt een "expect-send" syntax wat vergelijkbaar is met het <a href="https://man.freebsd.org/cgi/man.cgi?query=chat&amp;sektion=8&amp;format=html">chat(8)</a> programma. Bekijk de handleiding voor meer informatie over de mogelijkheden van deze taal.</p><div class=paragraph><p>Let op dat dit commando doorgaat op de volgende regel zodat deze leesbaar blijft. Elk commando in <span class=filename>ppp.conf</span> kan dit doen als het laatste karakter op een regel, het \ karakter is.</p></div></dd><dt class=hdlist1>Regel 8</dt><dd><p>Stelt de idle timeout in voor een link. 180 seconden is standaard, dus deze regel is puur cosmetisch.</p></dd><dt class=hdlist1>Regel 9</dt><dd><p>Vertelt PPP om de andere kant te vragen om een bevestiging van de lokale naamserver instellingen. Als u een lokale naamserver draait moet deze regel uitgecommentarieërd of verwijderd worden.</p></dd><dt class=hdlist1>Regel 10</dt><dd><p>Een blanco regel voor de leesbaarheid. Blanco regels worden door PPP genegeerd.</p></dd><dt class=hdlist1>Regel 11</dt><dd><p>Identificeert een sectie voor de provider die "provider" genoemd wordt. Dit kan gewijzigd worden in de naam van uw provider zodat er later gebruik gemaakt van worden bij de optie <code>load <em>provider</em></code> om een verbinding op te zetten.</p></dd><dt class=hdlist1>Regel 12</dt><dd><p>Stelt het telefoonnummer in voor deze provider. Meerdere telefoonnummers kunnen gespecificeerd worden door gebruik te maken van de dubbele punt (<code>:</code>) of het pipe karakter (<code>|</code>) als scheidingsteken. Het verschil tussen de twee scheidingstekens wordt beschreven in de <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> handleiding. Om samen te vatten, als u wilt rouleren tussen de nummers gebruikt u dan een dubbelepunt. Als u altijd het eerste nummer als eerste wilt draaien en alleen de andere nummers wilt draaien als het eerste nummer niet werkt, gebruik dan het pipe karakter. Quote altijd de hele set van telefoonnummers zoals getoond.</p><div class=paragraph><p>U moet het telefoonnummer citeren met dubbele quotes (<code>"</code>) als er enige intentie is in het gebruik van spaties in het telefoonummer. Dit kan een simpele, maar subtiele fout creeëren.</p></div></dd><dt class=hdlist1>Regels 13 & 14</dt><dd><p>Identificeert de gebruikersnaam en het wachtwoord. Wanneer gebruik gemaakt wordt van een UNIX® stijl login worden deze waarden verwezen door het <code>set login</code> commando door gebruik te maken van de \U en \P variabelen. Wanneer er verbinding gemaakt wordt door PPP en CHAP worden deze waardes gebruikt tijdens het authenticeren.</p></dd><dt class=hdlist1>Regels 15</dt><dd><p>Als u gebruik maakt van PPP en CHAP, zal er geen login op dit moment zijn, en moet deze regel uitgecommentarieërd of verwijderd worden. Zie het <a href=#userppp-PAPnCHAP>PAP en CHAP authenticatie</a> hoofdstuk voor meer details.</p><div class=paragraph><p>De login regel is hetzelfde als de chat-achtige syntax van de inbelregel. In dit voorbeeld werkt de reegl voor een dienst wiens login sessie als volgt eruit ziet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>J. Random Provider
login: foo
password: bar
protocol: ppp</code></pre></div></div><div class=paragraph><p>U moet dit script aanpassen om aan uw behoeften te voldoen. Wanneer u dit script voor het eerst schrijft, moet u ervoor zorgen dat u de "chat" log optie heeft aangezet zodat u kunt bepalen of de communicatie gaat zoals verwacht.</p></div></dd><dt class=hdlist1>Regel 16</dt><dd><p>Selt de standaard idle timeout in (in seconden) voor de connectie. Hier wordt de connectie automatisch afgesloten na 300 seconden van inactiviteit. Als u nooit een timeout wilt krijgen, kunt u de waarde op nul zetten of gebruik maken van de optie <code>-ddial</code> op de commando regel.</p></dd><dt class=hdlist1>Regel 17</dt><dd><p>Stelt het interface adres in. De regel <em>x.x.x.x</em> moet vervangen worden door het IP-adres dat uw provider aan u heeft uitgegeven. De regel <em>y.y.y.y</em> moet vervangen worden door het IP-adres dat uw provider aan u heeft gegeven voor de router (de machine waarmee u verbinding maakt). Als uw ISP u geen router adres heeft gegeven, gebruik dan <code>10.0.0.2/0</code>. Als u gebruik moet maken van een "gegokt", zorg ervoor dat er een regel staat in <span class=filename>/etc/ppp/ppp.linkup</span> zoals beschreven in de instructies voor <a href=#userppp-dynamicIP>PPP en dynamische IP adressen</a>. Als deze regel weggelaten wordt kan <code>ppp</code> niet in <code>-auto</code> mode starten.</p></dd><dt class=hdlist1>Regel 18</dt><dd><p>Voegt een standaard routering toe naar uw providers router. Het speciale <code>HISADDR</code> woord, wordt vervangen door het router adres zoals gespecificeerd op regel 17. Het is belangrijk dat deze regel na regel 17 komt, anders is <code>HISADDR</code> nog niet geïnitialiseerd.</p><div class=paragraph><p>Als u ppp niet in <code>-auto</code> mode wilt draaien, moet deze regel verplaatst worden naar het <span class=filename>ppp.linkup</span> bestand.</p></div></dd></dl></div><div class=paragraph><p>Het is niet nodig om een regel toe te voegen aan <span class=filename>ppp.linkup</span> wanneer u een statisch IP-adres krijgt en ppp met de <code>-auto</code> mode gestart is omdat uw routerings tabel al correcte regels heeft voordat u verbinding maakt. U kunt echter een regel aanmaken om programma’s te starten nadat de verbinding opgezet is. Dit wordt later uitgelegd met een voorbeeld over sendmail.</p></div><div class=paragraph><p>Voorbeeld van configuratiebestanden kunnen gevonden worden in de map <span class=filename>usr/shared/examples/ppp</span>.</p></div></div><div class=sect5><h6 id=userppp-dynamicIP>27.2.1.2.2. PPP en dynamische IP-adressen<a class=anchor href=#userppp-dynamicIP></a></h6><div class=paragraph><p>Als uw provider geen statisch IP-adres aanlevert kan <code>ppp</code> geconfigureerd worden om het lokale en het remote adres te onderhandelen. Dit wordt gedaan door het "gokken" van een IP-adres en PPP toestaan dit adres te corrigeren door gebruik te maken van het IP Configuration Protocol (IPCP) nadat er een verbinding opgezet is. De <span class=filename>ppp.conf</span> configuratie is verders hetzelfde als voor de <a href=#userppp-staticIP>PPP en statische IP adressen</a>, met de volgende wijziging:</p></div><div class="literalblock programlisting"><div class=content><pre>17      set ifaddr 10.0.0.1/0 10.0.0.2/0 255.255.255.255 0.0.0.0</pre></div></div><div class=paragraph><p>Nogmaals, het regelnummer hoeft niet te worden toegevoegd, deze dient puur ter referentie. Indentatie van minstens één spatie is vereist.</p></div><div class=dlist><dl><dt class=hdlist1>Regel 17</dt><dd><p>Het nummer achter het <code>/</code> karakter is het aantal netwerk master bits van het adres die ppp eist. Het is mogelijk dat u IP-adressen wilt gebruiken die meer van toepassing zijn op uw situatie, maar bovenstaand voorbeeld zal altijd werken.</p><div class=paragraph><p>Het laatste argument (<code>0.0.0.0</code>) vertelt PPP om te onderhandelen met het adres <code>0.0.0.0</code> in plaats van met <code>10.0.0.1</code> en is benodigd voor sommige ISPs. Gebruik <code>0.0.0.0</code> niet als eerste argument voor het commando <code>set ifaddr</code>, omdat dit ervoor zorgt dat PPP geen initiële route kan opzetten in <code>-auto</code> mode.</p></div></dd></dl></div><div class=paragraph><p>Als u niet draait in <code>-auto</code> mode, moet u een nieuwe regel toevoegen aan <span class=filename>/etc/ppp/ppp.linkup</span>. <span class=filename>ppp.linkup</span> wordt uitgevoerd nadat een connectie is opgezet. Op dit moment krijgt <code>ppp</code> het interface adres en is het mogelijk om regels toe te voegen aan de route tabel:</p></div><div class="literalblock programlisting"><div class=content><pre>1     provider:
2      add default HISADDR</pre></div></div><div class=dlist><dl><dt class=hdlist1>Regel 1</dt><dd><p>Bij het tot stand brengen van een verbinding zal <code>ppp</code> kijken voor een corresponderende regel in <span class=filename>ppp.linkup</span> volgens de volgende criteria: Als eerste, probeert het hetzelfde label te vinden zoals gebruikt in <span class=filename>ppp.conf</span>. Als dat mislukt, zoek dan een regel waarin het IP-adres van onze router in voorkomt. Deze regel bevat een IP stijl van 4 octetten. Als nu nog steeds geen corresponderende regel gevonden is wordt er gezocht naar de <code>HISADDR</code> regel.</p></dd><dt class=hdlist1>Regel 2</dt><dd><p>Deze regel verteld <code>ppp</code> om een standaard routering toe te voegen die wijst richting <code>HISADDR</code>. <code>HISADDR</code> wordt vervangen door het IP-adres van de router zoals onderhandeld door IPCP.</p></dd></dl></div><div class=paragraph><p>Zie de <code>pmdemand</code> regel in de bestanden <span class=filename>/usr/shared/examples/ppp/ppp.conf.sample</span> en <span class=filename>/usr/shared/examples/ppp/ppp.linkup.sample</span> voor een gedetailleerd voorbeeld.</p></div></div><div class=sect5><h6 id=_het_ontvangen_van_binnenkomende_gesprekken>27.2.1.2.3. Het ontvangen van binnenkomende gesprekken<a class=anchor href=#_het_ontvangen_van_binnenkomende_gesprekken></a></h6><div class=paragraph><p>Wanneer ppp geconfigureerd is om inkomende gesprekken te ontvangen op een machine die verbonden is met een LAN, moet u beslissen of er pakketten worden doorgestuurd naar het LAN. Als u dat doet, moet u de andere kant een IP-adres geven uit het subnet van uw LAN, en zult u gebruik moeten maken van het command <code>enable proxy</code> in het <span class=filename>/etc/ppp/ppp.conf</span> bestand. U zult ook moeten controleren of het <span class=filename>/etc/rc.conf</span> bestand het volgende bevat:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;</pre></div></div></div><div class=sect5><h6 id=_welke_getty>27.2.1.2.4. Welke getty?<a class=anchor href=#_welke_getty></a></h6><div class=paragraph><p><a href=./#dialup>Het configureren van FreeBSD voor inbel diensten</a> levert een goede beschrijving van het inschakelen van inbeldiensten door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a>.</p></div><div class=paragraph><p>Een alternatief voor <code>getty</code> is <a href=http://mgetty.greenie.net/>mgetty</a> (van de port <a class=package href=https://cgit.freebsd.org/ports/tree/comms/mgetty+sendfax/>comms/mgetty+sendfax</a>), een betere versie van <code>getty</code> ontworpen voor onder andere inbellijnen.</p></div><div class=paragraph><p>De voordelen van het gebruik van <code>mgetty</code> is dat het actief <em>communiceert</em> met modems, wat betekent dat als de port uitgeschakeld is in <span class=filename>/etc/ttys</span>, het modem de telefoon niet zal beantwoorden.</p></div><div class=paragraph><p>Latere versies van <code>mgetty</code> (vanaf 0.99beta en later) ondersteunen ook het automatisch detecteren van PPP stromen waardoor cliënten zonder extra scripting toegang kunnen krijgen tot uw server.</p></div><div class=paragraph><p>Raadpleeg naar <a href=#userppp-mgetty>Mgetty en AutoPPP</a> voor meer informatie over <code>mgetty</code>.</p></div></div><div class=sect5><h6 id=_ppp_permissies>27.2.1.2.5. PPP Permissies<a class=anchor href=#_ppp_permissies></a></h6><div class=paragraph><p>Het <code>ppp</code> commando moet normaal gesproken gestart worden door de <code>root</code> gebruiker. Als u echter wilt toestaan dat <code>ppp</code> in server mode gestart wordt door een normale gebruiker door het uitvoeren van <code>ppp</code>, zoals beschreven hieronder, moet deze gebruiker permissie krijgen om <code>ppp</code> te starten. Dit kan gedaam worden door de gebruiker toe te voegen aan de <code>network</code> groep van het <span class=filename>/etc/group</span> bestand.</p></div><div class=paragraph><p>U moet de gebruiker ook toegang geven tot één of meerdere secties van het configuratie bestand door gebruik te maken van het <code>allow</code> commando:</p></div><div class="literalblock programlisting"><div class=content><pre>allow users fred mary</pre></div></div><div class=paragraph><p>Als dit commando wordt gebruikt in de <code>default</code> sectie, geeft ppp alle opgegeevn gebruikers toegang tot alle opties.</p></div></div><div class=sect5><h6 id=_ppp_shells_voor_dynamische_ip_gebruikers>27.2.1.2.6. PPP shells voor dynamische IP-gebruikers<a class=anchor href=#_ppp_shells_voor_dynamische_ip_gebruikers></a></h6><div class=paragraph><p>Creeër een bestand genaamd <span class=filename>/etc/ppp/ppp-shell</span> welke de volgende gegevens bevat:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
IDENT=`echo $0 | sed -e &#39;s/^.*-\(.*\)$/\1/&#39;`
CALLEDAS=&#34;$IDENT&#34;
TTY=`tty`

if [ x$IDENT = xdialup ]; then
        IDENT=`basename $TTY`
fi

echo &#34;PPP voor $CALLEDAS op $TTY&#34;
echo &#34;Starten van PPP voor $IDENT&#34;

exec /usr/sbin/ppp -direct $IDENT</pre></div></div><div class=paragraph><p>Dit script moet uitvoerbaar zijn. Ook moet er een symbolische link gemaakt worden naar dit script met de naam <span class=filename>ppp-dialup</span> door gebruik te maken van de volgende commando’s:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s ppp-shell /etc/ppp/ppp-dialup</span></code></pre></div></div><div class=paragraph><p>U moet dit script gebruiken als de <em>shell</em> voor al uw inbel gebruikers. Dit is een voorbeeld uit <span class=filename>/etc/passwd</span> voor een PPP inbelgebruiker met de gebruikersnaam <code>pchilds</code> (Let op, u mag niet direct het wachtwoord bestand bewerken, gebruik daarom het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a>).</p></div><div class="literalblock programlisting"><div class=content><pre>pchilds:*:1011:300:Peter Childs PPP:/home/ppp:/etc/ppp/ppp-dialup</pre></div></div><div class=paragraph><p>Creeër vervolgens een map <span class=filename>/home/ppp</span> die door iedereen gelezen en beschreven kan worden en zet daar de volgende 0 byte grote bestanden in:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>-r--r--r--</span>   1 root     wheel           0 May 27 02:23 .hushlogin
<span class=nt>-r--r--r--</span>   1 root     wheel           0 May 27 02:22 .rhosts</code></pre></div></div><div class=paragraph><p>welke voorkomen dat <span class=filename>/etc/motd</span> getoond wordt.</p></div></div><div class=sect5><h6 id=_ppp_shells_voor_statische_ip_gebruikers>27.2.1.2.7. PPP shells voor statische IP-gebruikers<a class=anchor href=#_ppp_shells_voor_statische_ip_gebruikers></a></h6><div class=paragraph><p>Creeër het <span class=filename>ppp-shell</span> bestand zoals hierboven, en voor elk account met een statisch toegewezen IP-adres creeërt u een symbolische link naar <span class=filename>ppp-shell</span>.</p></div><div class=paragraph><p>Als u bijvoorbeeld drie inbel gebruikers hebt genaamd <code>fred</code>, <code>sam</code> en <code>mary</code> waar u een /24 CIDR netwerk voor routeert, moet u het volgende typen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-fred</span>
<span class=c># ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-sam</span>
<span class=c># ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-mary</span></code></pre></div></div><div class=paragraph><p>Elk van deze inbelgebruikers moet de shell ingesteld hebben op de symbolische link die hierboven is gecreeërd (bijvoorbeeld <code>mary</code>'s shell moet zijn <span class=filename>/etc/ppp/ppp-mary</span>).</p></div></div><div class=sect5><h6 id=_het_instellen_van_ppp_conf_voor_dynamische_ip_gebruikers>27.2.1.2.8. Het instellen van <span class=filename>ppp.conf</span> voor dynamische IP-gebruikers<a class=anchor href=#_het_instellen_van_ppp_conf_voor_dynamische_ip_gebruikers></a></h6><div class=paragraph><p>Het <span class=filename>/etc/ppp/ppp.conf</span> bestand moet iets zoals hieronder bevatten:</p></div><div class="literalblock programlisting"><div class=content><pre>default:
  set debug phase lcp chat
  set timeout 0

ttyu0:
  set ifaddr 203.14.100.1 203.14.100.20 255.255.255.255
  enable proxy

ttyu1:
  set ifaddr 203.14.100.1 203.14.100.21 255.255.255.255
  enable proxy</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het inspringen is belangrijk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De <code>default:</code> sectie wordt altijd geladen. Voor elke inbellijn die ingeschakeld is in <span class=filename>/etc/ttys</span> moet een soortgelijke regel worden gemaakt als die voor <code>ttyu0:</code> hierboven. Elke regel moet een uniek IP-adres krijgen van uw pool van IP-adressen voor dynamische gebruikers.</p></div></div><div class=sect5><h6 id=_het_instellen_van_ppp_conf_voor_statische_ip_gebruikers>27.2.1.2.9. Het instellen van <span class=filename>ppp.conf</span> voor statische IP-gebruikers.<a class=anchor href=#_het_instellen_van_ppp_conf_voor_statische_ip_gebruikers></a></h6><div class=paragraph><p>Samen met de inhoud van het voorbeeld <span class=filename>/usr/shared/examples/ppp/ppp.conf</span> bestand hierboven moet een sectie aangemaakt worden voor elke van de statisch ingestelde inbelgebruikers. We gaan door met ons <code>fred</code>, <code>sam</code> en <code>mary</code> voorbeeld.</p></div><div class="literalblock programlisting"><div class=content><pre>fred:
  set ifaddr 203.14.100.1 203.14.101.1 255.255.255.255

sam:
  set ifaddr 203.14.100.1 203.14.102.1 255.255.255.255

mary:
  set ifaddr 203.14.100.1 203.14.103.1 255.255.255.255</pre></div></div><div class=paragraph><p>Het <span class=filename>/etc/ppp/ppp.linkup</span> bestand moet ook informatie over routeringen bevatten voor elke statische IP-gebruiker waar nodig. De regel hieronder voegt een routering toe voor het <code>203.14.201.0/24</code> netwerk via de ppp link van de gebruiker.</p></div><div class="literalblock programlisting"><div class=content><pre>fred:
  add 203.14.101.0 netmask 255.255.255.0 HISADDR

sam:
  add 203.14.102.0 netmask 255.255.255.0 HISADDR

mary:
  add 203.14.103.0 netmask 255.255.255.0 HISADDR</pre></div></div></div><div class=sect5><h6 id=userppp-mgetty>27.2.1.2.10. <code>mgetty</code> en AutoPPP<a class=anchor href=#userppp-mgetty></a></h6><div class=paragraph><p>Standaard staat de optie <code>AUTO_PPP</code> in de port <a class=package href=https://cgit.freebsd.org/ports/tree/comms/mgetty+sendfax/>comms/mgetty+sendfax</a> welke <code>mgetty</code> in staat stelt om de LCP fase van PPP connecties te detecteren en aan de hand daarvan automatisch een ppp shell te creeëren. Echter, de standaard login procedure vindt in deze mode niet plaats, waardoor het nodig is om de gebruikers te authenticeren door middel van PAP of CHAP.</p></div><div class=paragraph><p>De volgende sectie gaat er vanuit dat u succesvol de port <a class=package href=https://cgit.freebsd.org/ports/tree/comms/mgetty+sendfax/>comms/mgetty+sendfax</a> op uw systeem heeft gecompileerd en geïnstalleerd.</p></div><div class=paragraph><p>Zorg ervoor dat uw <span class=filename>/usr/local/etc/mgetty+sendfax/login.config</span> bestand de volgende inhoud heeft:</p></div><div class="literalblock programlisting"><div class=content><pre>/AutoPPP/ -     -		      /etc/ppp/ppp-pap-dialup</pre></div></div><div class=paragraph><p>Dit verteld <code>mgetty</code> om het <span class=filename>ppp-pap-dialup</span> script te starten wanneer er een PPP connectie gedetecteerd wordt.</p></div><div class=paragraph><p>Creeër een bestand genaamd <span class=filename>/etc/ppp/ppp-pap-dialup</span> met de volgende inhoud (het bestand moet uitvoerbaar zijn):</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
exec /usr/sbin/ppp -direct pap$IDENT</pre></div></div><div class=paragraph><p>Voor elke inbelregel die ingeschakeld is in <span class=filename>/etc/ttys</span>, creeër een corresponderende regel in <span class=filename>/etc/ppp/ppp.conf</span>. Dit gaat goed samen met de definities die hierboven gedaan zijn.</p></div><div class="literalblock programlisting"><div class=content><pre>pap:
  enable pap
  set ifaddr 203.14.100.1 203.14.100.20-203.14.100.40
  enable proxy</pre></div></div><div class=paragraph><p>Elke gebruiker die op deze manier inlogt moet een gebruikersnaam en wachtwoord hebben in het <span class=filename>/etc/ppp/ppp.secret</span> bestand of de volgende optie moet worden toegevoegd om gebruikers te authenticeren via PAP vanuit het <span class=filename>/etc/passwd</span> bestand.</p></div><div class="literalblock programlisting"><div class=content><pre>enable passwdauth</pre></div></div><div class=paragraph><p>Als u een aantal gebruikers een statisch IP-adres wilt geven, kan dat gespecificeerd worden als het derde argument in <span class=filename>/etc/ppp/ppp.secret</span>. Zie <span class=filename>/usr/shared/examples/ppp/ppp.secret.sample</span> voor een voorbeeld.</p></div></div><div class=sect5><h6 id=_microsoft_extensies>27.2.1.2.11. Microsoft® Extensies<a class=anchor href=#_microsoft_extensies></a></h6><div class=paragraph><p>Het is mogelijk om PPP dusdanig te configuren dat deze DNS en NetBIOS naamserver adressen meegeeft.</p></div><div class=paragraph><p>Om deze extensies in te schakelen met PPP versie 1.x kunnen de volgende regels toegevoegd worden aan de relevante sectie in <span class=filename>/etc/ppp/ppp.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>enable msext
set ns 203.14.100.1 203.14.100.2
set nbns 203.14.100.5</pre></div></div><div class=paragraph><p>en voor PPP versie 2 en hoger:</p></div><div class="literalblock programlisting"><div class=content><pre>accept dns
set dns 203.14.100.1 203.14.100.2
set nbns 203.14.100.5</pre></div></div><div class=paragraph><p>Dit verteld de cliënt het primaire en secundaire naamserver adres, en geeft een NetBIOS naamserver adres.</p></div><div class=paragraph><p>In versie 2 en hoger zal PPP gebruik maken van de instellingen in <span class=filename>/etc/resolv.conf</span> als de regel <code>set dns</code> niet wordt gevonden.</p></div></div><div class=sect5><h6 id=userppp-PAPnCHAP>27.2.1.2.12. PAP en CHAP authenticatie<a class=anchor href=#userppp-PAPnCHAP></a></h6><div class=paragraph><p>Sommige providers stellen hun systemen dusdanig in dat het authenticatie gedeelte van uw verbinding wordt afgehandeld door het PAP of CHAP authenticatie mechanisme. Als dit het geval is zal uw provider u niet voorzien van een <code>login:</code> prompt wanneer u verbinding maakt maar zal deze meteen gaan communiceren over het PPP protocol.</p></div><div class=paragraph><p>PAP is minder veilig dan CHAP, maar beveiliging is meestal geen probleem omdat wachtwoorden, ook al worden deze in platte tekst verstuurd met PAP, alleen worden verstuurd via een seriële lijn. Hier is maar weinig ruimte voor crackers om stiekem mee te luisteren.</p></div><div class=paragraph><p>Terug verwijzende naar de <a href=#userppp-staticIP>PPP en statische IP-adressen</a> of <a href=#userppp-dynamicIP>PPP en dynamische IP-adressen</a> secties moeten de volgende aanpassingen gedaan worden:</p></div><div class="literalblock programlisting"><div class=content><pre>13      set authname Mijngebruikersnaam
14      set authkey Mijnwachtwoord
15      set login</pre></div></div><div class=dlist><dl><dt class=hdlist1>Regel 13</dt><dd><p>Deze regel geeft uw PPP/CHAP gebruikersnaam aan. U moet de juiste waardes invullen voor <em>Mijngebruikersnaam</em>.</p></dd><dt class=hdlist1>Regel 14</dt><dd><p>Deze regel geeft uw PPP/CHAP wachtwoord aan. U moet de juiste waarde invullen voor <em>Mijnwachtwoord</em>. Misschien wilt u een extra regel toevoegen als:</p><div class="literalblock programlisting"><div class=content><pre>16      accept PAP</pre></div></div><div class=paragraph><p>of</p></div><div class="literalblock programlisting"><div class=content><pre>16      accept CHAP</pre></div></div><div class=paragraph><p>om duidelijk te maken op welke manier u wilt authenticeren, standaard worden zowel PAP als CHAP geaccepteerd.</p></div></dd><dt class=hdlist1>Regel 15</dt><dd><p>Uw ISP zal normaal gesprokken niet eisen dat u op de server aanlogt als u gebruik maakt van PAP of CHAP. Daarom moet u de "set login" regel uitschakelen.</p></dd></dl></div></div><div class=sect5><h6 id=_het_aanpassen_van_uw_ppp_configuratie_terwijl_deze_in_gebruik_is>27.2.1.2.13. Het aanpassen van uw <code>ppp</code> configuratie terwijl deze in gebruik is<a class=anchor href=#_het_aanpassen_van_uw_ppp_configuratie_terwijl_deze_in_gebruik_is></a></h6><div class=paragraph><p>Het is mogelijk om tegen met het <code>ppp</code> programma te communiceren terwijl deze in gebruik is op de achtergrond, maar dat kan alleen als er een geschikte diagnostische poort ingesteld is. Om dit te kunnen doen moet de volgende regel worden toegevoegd aan de configuratie:</p></div><div class="literalblock programlisting"><div class=content><pre>set server /var/run/ppp-tun%d DiagnosticPassword 0177</pre></div></div><div class=paragraph><p>Dit vertelt PPP om te luisteren naar het gespecificeerde UNIX® domein socket, waarbij de cliënten gevraagd worden om het opgegeven wachtwoord voordat toegang verleend kan worden. Het <code>%d</code> in de naam wordt vervangen door het <span class=filename>tun</span> apparaat dat gebruikt wordt voor de verbinding.</p></div><div class=paragraph><p>Zodra een socket ingesteld is kan het <a href="https://man.freebsd.org/cgi/man.cgi?query=pppctl&amp;sektion=8&amp;format=html">pppctl(8)</a> programma gebruikt worden in scripts die het draaiende programma willen bewerken.</p></div></div></div><div class=sect4><h5 id=userppp-nat>27.2.1.3. De vertaalmogelijkheden van PPP voor netwerkadressen gebruiken<a class=anchor href=#userppp-nat></a></h5><div class=paragraph><p>PPP heeft de mogelijkheid om interne NAT te gebruiken zonder dat de kernel hiervoor iets hoeft te doen. Deze functionaliteit kan worden ingeschakeld door de volgende regel in <span class=filename>/etc/ppp/ppp.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>nat enable yes</pre></div></div><div class=paragraph><p>Ook kan PPP NAT ingeschakeld worden door de optie <code>-nat</code>. Er is ook een <span class=filename>/etc/rc.conf</span> optie genaamd <code>ppp_nat</code> welke standaard ingeschakeld is.</p></div><div class=paragraph><p>Als u gebruik wilt maken van deze optie, kunt u de volgende <span class=filename>/etc/ppp/ppp.conf</span> opties ook nuttig vinden om binnenkomende connecties door te sturen:</p></div><div class="literalblock programlisting"><div class=content><pre>nat port tcp 10.0.0.2:ftp ftp
nat port tcp 10.0.0.2:http http</pre></div></div><div class=paragraph><p>of als u niets vertrouwd vanaf buitenaf:</p></div><div class="literalblock programlisting"><div class=content><pre>nat deny_incoming yes</pre></div></div></div><div class=sect4><h5 id=userppp-final>27.2.1.4. Laatste systeemconfiguratie<a class=anchor href=#userppp-final></a></h5><div class=paragraph><p>U heeft nu <code>ppp</code> geconfigurerd, maar er moeten nog een aantal dingen gedaan worden voordat deze klaar is om te kunnen werken. Hiervoor moeten een aantal aanpassingen gedaan worden in het bestand <span class=filename>/etc/rc.conf</span>.</p></div><div class=paragraph><p>Van boven naar beneden kijkende zorgen we er als eerste voor dat de <code>hostname=</code> regel ingesteld is met bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;foo.example.com&#34;</pre></div></div><div class=paragraph><p>Als uw provider u een statisch adres en een naam heeft gegeven is het waarschijnlijk handig dat u deze naam gebruikt als uw hostnaam.</p></div><div class=paragraph><p>Zoek naar de <code>network_interfaces</code> variabele. Als u uw systeem wilt configuren om in te bellen bij uw provider wanneer nodig, zorg er dan voor dat het <span class=filename>tun0</span> apparaat is toegevoegd aan deze lijst. Haal deze anders weg.</p></div><div class="literalblock programlisting"><div class=content><pre>network_interfaces=&#34;lo0 tun0&#34;
ifconfig_tun0=</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De <code>ifconfig_tun0</code> variabele moet leeg zijn, en een bestand genaamd <span class=filename>/etc/start_if.tun0</span> moet aangemaakt worden met de volgende inhoud:</p></div><div class="literalblock programlisting"><div class=content><pre>ppp -auto mysystem</pre></div></div><div class=paragraph><p>Dit script wordt uitgevoerd tijdens de netwerk configuratie, waarbij uw ppp daemon wordt gestart in automatische mode. Als u een LAN heeft waarvoor deze machine een router is wilt u wellicht ook de <code>-alias</code> meegeven. Bekijk de handleiding voor verdere details.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Zorg ervoor dat het router programma is ingesteld op <code>NO</code> door middel van de volgende regel in uw <span class=filename>/etc/rc.conf</span> bestand:</p></div><div class="literalblock programlisting"><div class=content><pre>router_enable=&#34;NO&#34;</pre></div></div><div class=paragraph><p>Het is belangrijk dat de <code>routed</code> daemon niet gestart wordt, omdat <code>routed</code> de neiging heeft om de standaard routeringtabel regels die gemaakt worden door <code>ppp</code> te verwijderen.</p></div><div class=paragraph><p>Het is waarschijnlijk een goed idee om te zorgen dat de <code>sendmail_flags</code> regel de <code>-q</code> optie niet wordt meegenomen, anders zal <code>sendmail</code> periodiek een zoek actie verrichten op het netwerk, wat ervoor zorgt dat uw machine gaat uitbellen. U kunt het volgende instellen:</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail_flags=&#34;-bd&#34;</pre></div></div><div class=paragraph><p>Het nadeel hiervan is dat u <code>sendmail</code> moet forceren om de mailqueue periodiek te bekijken zodra de ppp link op is door het typen van:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/sbin/sendmail -q</span></code></pre></div></div><div class=paragraph><p>U wilt wellicht gebruik maken van het <code>!bg</code> commando in <span class=filename>ppp.linkup</span> om dit automatisch te doen:</p></div><div class="literalblock programlisting"><div class=content><pre>1     provider:
2       delete ALL
3       add 0 0 HISADDR
4       !bg sendmail -bd -q30m</pre></div></div><div class=paragraph><p>Als u dit niet wilt doen, is het mogelijk om een "dfiler" in te stellen welke SMTP verkeer blokkeert. Raadpleeg naar de voorbeeld bestanden voor verdere details.</p></div><div class=paragraph><p>Alles wat nu nog nodig is, is het herstarten van de machine. Na het herstarten kunt het volgende typen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ppp</span></code></pre></div></div><div class=paragraph><p>en daarna <code>dial provider</code> om de PPP sessie te starten, of u indien u dat wilt kan <code>ppp</code> automatisch sessies opzetten wanneer er uitgaand verkeer is (en wanneer u geen <span class=filename>start_if.tun0</span> script heeft aangemaakt), typt u:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ppp -auto provider</span></code></pre></div></div></div><div class=sect4><h5 id=_samenvatting>27.2.1.5. Samenvatting<a class=anchor href=#_samenvatting></a></h5><div class=paragraph><p>Om samen te vatten zijn de volgende stappen benodigd om PPP voor de eerste keer in te stellen:</p></div><div class=paragraph><p>Aan de cliënt zijde:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Zorg ervoor dat het <span class=filename>tun</span> apparaat is ingeschakeld in uw kernel.</p></li><li><p>Zorg ervoor dat het apparaatbestand <span class=filename>tunN</span> beschikbaar is in de map <span class=filename>/dev</span>.</p></li><li><p>Creeër een regel in <span class=filename>/etc/ppp/ppp.conf</span>. Het <span class=filename>pmdemand</span> voorbeeld zou moeten volstaand voor de meeste providers.</p></li><li><p>Als u dynamische IP-adressen heeft, creeër een regel in <span class=filename>/etc/ppp/ppp.linkup</span>.</p></li><li><p>Update uw <span class=filename>/etc/rc.conf</span> bestand.</p></li><li><p>Creeër een <span class=filename>start_if.tun0</span> script als u op verzoek wilt inbellen.</p></li></ol></div></div></div><div class=paragraph><p>Aan de server zijde:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Zorg ervoor dat het <span class=filename>tun</span> apparaat is ingeschakeld in uw kernel.</p></li><li><p>Zorg ervoor dat het apparaatbestand <span class=filename>tunN</span> beschikbaar is in de map <span class=filename>/dev</span>.</p></li><li><p>Creeër een regel in <span class=filename>/etc/passwd</span> (door gebruik te maken van het <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> programma).</p></li><li><p>Creeër een profiel in deze gebruikers home directory die <code>ppp -direct direct-server</code> start of iets in die trant.</p></li><li><p>Creeër een regel in <span class=filename>/etc/ppp/ppp.conf</span>. Het <span class=filename>direct-server</span> voorbeeld zou moeten volstaan.</p></li><li><p>Creeër een regel in <span class=filename>/etc/ppp/ppp.linkup</span>.</p></li><li><p>Update uw <span class=filename>/etc/rc.conf</span> bestand.</p></li></ol></div></div></div></div></div></div><div class=sect2><h3 id=ppp>27.3. Kernel-PPP gebruiken<a class=anchor href=#ppp></a></h3><div class=sect3><h4 id=_het_opzetten_van_kernel_ppp>27.3.1. Het opzetten van kernel-PPP<a class=anchor href=#_het_opzetten_van_kernel_ppp></a></h4><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Deze sectie geldt en is alleen geldig voor FreeBSD 7.X.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Voordat u begint met het opzetten van PPP op uw machine, zorg ervoor dat het <code>pppd</code> commando zich bevindt in de map <span class=filename>/usr/sbin</span> en dat de map <span class=filename>/etc/ppp</span> bestaat.</p></div><div class=paragraph><p><code>pppd</code> kan in twee verschillende modes werken:</p></div><div class="olist arabic"><ol class=arabic><li><p>Als een "cliënt" - u wilt uw machine verbinden met de buitenwereld via een seriële PPP-verbinding of een modemlijn.</p></li><li><p>Als een "server" - uw machine bevind zich in het netwerk en wordt gebruikt om andere computers te verbinden door middel van PPP.</p></li></ol></div><div class=paragraph><p>In beide gevallen moet u een bestand met opties instellen (<span class=filename>/etc/ppp/options</span> of <span class=filename>~/.ppprc</span> als er meer dan één gebruiker is op uw machine die gebruik maakt van PPP).</p></div><div class=paragraph><p>U heeft ook enige modem/seriële software nodig (<a class=package href=https://cgit.freebsd.org/ports/tree/comms/kermit/>comms/kermit</a> wordt aanbevolen), zodat u de andere kant kunt bellen en een verbinding kunt opzetten.</p></div></div><div class=sect3><h4 id=_gebruik_maken_van_pppd_als_cliënt>27.3.2. Gebruik maken van <code>pppd</code> als cliënt<a class=anchor href=#_gebruik_maken_van_pppd_als_cliënt></a></h4><div class=paragraph><p>De volgende <span class=filename>/etc/ppp/options</span> kan gebruikt worden om met een Cisco terminal server PPP lijn verbinding te maken.</p></div><div class="literalblock programlisting"><div class=content><pre>crtscts         # Schakel hardware flow controle in
modem           # modem controle lijn
noipdefault     # De PPP-server aan de andere kant moet uw IP-adres
                # opgeven, als de machine aan de andere kant uw IP
                # adres niet meegeeft tijdens de IPCP onderhandeling
                # moet deze optie worden verwijderd
passive         # Wacht op LCP pakketten
domain ppp.foo.com      # Vul uw domein naam hier in

:remote_ip    # Vul het IP-adres van de PPP
                # server in deze wordt gebruikt om pakketten te
                # routeren via de PPP link.  Als u de noipdefault optie
                # niet heeft aangegeven verander dan deze regel in
                # local_ip:remote_ip

defaultroute    # Vul dit in als u wilt dat de PPP server de standaard
                # router wordt</pre></div></div><div class=paragraph><p>Om verbinding te maken:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Bel naar de machine aan de andere kant door middel van Kermit (of een ander modem programma), en vul uw gebruikersnaam en wachtwoord in (of wat er ook nodig is om de verbinding op te brengen met de machine aan de andere kant).</p></li><li><p>Stop Kermit (zonder de lijn op te hangen).</p></li><li><p>Type het volgende:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/sbin/pppd /dev/tty01 19200</span></code></pre></div></div><div class=paragraph><p>Wees er zeker van dat de juiste snelheid en het juiste apparaat wordt aangesproken.</p></div></li></ol></div></div></div><div class=paragraph><p>Uw computer is nu verbonden met PPP. Als de connectie faalt, kan de <code>debug</code> optie worden meegegeven in het <span class=filename>/etc/ppp/options</span> bestand waarna op de console berichten kunnen worden geraadpleegd om het probleem te achterhalen.</p></div><div class=paragraph><p>Het volgende <span class=filename>/etc/ppp/pppup</span> script zal alle drie de stappen automatisch doen:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing pppd, PID=&#39; ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing kermit, PID=&#39; ${pid}
        kill -9 ${pid}
fi

ifconfig ppp0 down
ifconfig ppp0 delete

kermit -y /etc/ppp/kermit.dial
pppd /dev/tty01 19200</pre></div></div><div class=paragraph><p><span class=filename>/etc/ppp/kermit.dial</span> is een Kermit script dat belt en alle benodigde authorisaties doet op de machine aan de andere kant (een voorbeeld van zo’n script is bijgevoegd aan het einde van dit document).</p></div><div class=paragraph><p>Gebruik het volgende <span class=filename>/etc/ppp/pppdown</span> script om de PPP lijn af te breken:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
pid=`pgrep pppd`
if [ X${pid} != &#34;X&#34; ] ; then
        echo &#39;killing pppd, PID=&#39; ${pid}
        kill -TERM ${pid}
fi

pgrep -l kermit
pid=`pgrep kermit`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing kermit, PID=&#39; ${pid}
        kill -9 ${pid}
fi

/sbin/ifconfig ppp0 down
/sbin/ifconfig ppp0 delete
kermit -y /etc/ppp/kermit.hup
/etc/ppp/ppptest</pre></div></div><div class=paragraph><p>Controleer of <code>pppd</code> nog steeds draait door het uitvoeren van <span class=filename>/usr/etc/ppp/ppptest</span>, welke er als volgend uitziet:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
pid=`pgrep pppd`
if [ X${pid} != &#34;X&#34; ] ; then
        echo &#39;pppd running: PID=&#39; ${pid-NONE}
else
        echo &#39;No pppd running.&#39;
fi
set -x
netstat -n -I ppp0
ifconfig ppp0</pre></div></div><div class=paragraph><p>Om het modem op te hangen, voer het <span class=filename>/etc/ppp/kermit.hup</span> script uit welke het volgende bevat:</p></div><div class="literalblock programlisting"><div class=content><pre>set line /dev/tty01	; vul hier uw modem in
set speed 19200
set file type binary
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none

pau 1
out +++
inp 5 OK
out ATH0\13
echo \13
exit</pre></div></div><div class=paragraph><p>Hier is een alternatieve methode welke gebruik maakt van <code>chat</code> in plaats van <code>kermit</code>:</p></div><div class=paragraph><p>De volgende twee regels zijn voldoende om een <code>pppd</code> verbinding op te zetten.</p></div><div class=paragraph><p><span class=filename>/etc/ppp/options</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/cuad1 115200

crtscts         # Schakel hardware flow controle in
modem           # modem controle lijn
connect &#34;/usr/bin/chat -f /etc/ppp/login.chat.script&#34;
noipdefault     # De PPP server aan de andere kant moet uw IP-adres
                # opgeven, als de machine aan de andere kant uw IP
                # adres niet meegeeft tijdens de IPCP onderhandeling
                # moet deze optie worden verwijderd
passive         # Wacht op LCP pakketten
domain your.domain   # Vul uw domein naam hier in

:remote_ip    # Vul het IP-adres van de PPP
                # server in deze wordt gebruikt om pakketten te
                # routeren via de PPP link.  Als u de noipdefault optie
                # niet heeft aangegeven verander dan deze regel in
                # local_ip:remote_ip

defaultroute    # Vul dit in als u wilt dat de PPP server de standaard
                # router wordt</pre></div></div><div class=paragraph><p><span class=filename>/etc/ppp/login.chat.script</span>:</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het volgende moet op één regel.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>ABORT BUSY ABORT &#39;NO CARRIER&#39; &#34;&#34; AT OK ATDTtelefoon.nummer
  CONNECT &#34;&#34; TIMEOUT 10 ogin:-\\r-ogin: login-id
  TIMEOUT 5 sword: password</pre></div></div><div class=paragraph><p>Zodra deze zijn geïnstalleerd en correct aangepast is het enige dat gedaan moet worden, het starten van <code>pppd</code> zoals volgt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pppd</span></code></pre></div></div></div><div class=sect3><h4 id=_gebruik_maken_van_pppd_als_server>27.3.3. Gebruik maken van <code>pppd</code> als server<a class=anchor href=#_gebruik_maken_van_pppd_als_server></a></h4><div class=paragraph><p><span class=filename>/etc/ppp/options</span> moet ongeveer het volgende bevatten:</p></div><div class="literalblock programlisting"><div class=content><pre>crtscts                         # Hardware flow controle
netmask 255.255.255.0           # netmask (niet vereist)
192.114.208.20:192.114.208.165  # IP&#39;s van lokale en niet lokale hosten
                                # het lokale IP moet anders zijn dan
                                # degeen die is toegewezen aan de
                                # Ethernet (of andere) interface op uw
                                # machine.  remote IP is het IP-adres
                                # dat wordt toegewezen aan de machine
                                # aan de andere kant
domain ppp.foo.com              # uw domein
passive                         # Wacht op LCP
modem                           # modem lijn</pre></div></div><div class=paragraph><p>Het volgende <span class=filename>/etc/ppp/pppserv</span> script zal pppd vertellen zich te gedragen als server:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing pppd, PID=&#39; ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing kermit, PID=&#39; ${pid}
        kill -9 ${pid}
fi

# reset ppp interface
ifconfig ppp0 down
ifconfig ppp0 delete

# enable autoanswer mode
kermit -y /etc/ppp/kermit.ans

# run ppp
pppd /dev/tty01 19200</pre></div></div><div class=paragraph><p>Gebruik dit <span class=filename>/etc/ppp/pppservdown</span> script om de server te stoppen:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing pppd, PID=&#39; ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing kermit, PID=&#39; ${pid}
        kill -9 ${pid}
fi
ifconfig ppp0 down
ifconfig ppp0 delete

kermit -y /etc/ppp/kermit.noans</pre></div></div><div class=paragraph><p>Het volgende Kermit script (<span class=filename>/etc/ppp/kermit.ans</span>) zal het automatisch beantwoorden van uw modem in of uitschakelen. Het moet eruit zien als volgend:</p></div><div class="literalblock programlisting"><div class=content><pre>set line /dev/tty01
set speed 19200
set file type binary
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none

pau 1
out +++
inp 5 OK
out ATH0\13
inp 5 OK
echo \13
out ATS0=1\13   ; Verander dit in out ATS0=0\13 als u automatisch
                ; beantwoorden wilt uitschakelen
inp 5 OK
echo \13
exit</pre></div></div><div class=paragraph><p>Een script genaamd <span class=filename>/etc/ppp/kermit.dial</span> wordt gebruikt voor het bellen en authenticeren van de machine aan de andere kant. U moet deze aanpassen aan uw wensen. Vul in dit script uw inlognaam en wachtwoord in, u moet ook het input statement aanpassen afhankelijk hoe uw modem antwoordt en de communicatie van de machine aan de andere kant.</p></div><div class="literalblock programlisting"><div class=content><pre>;
; Vul de seriële lijn in welke verbonden is met het modem
;
set line /dev/tty01
;
; Stel het modem snelheid in:
;
set speed 19200
set file type binary            ; volledige 8 bit bestands xfer
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none
set modem hayes
set dial hangup off
set carrier auto                ; Daarna stel SET CARRIER in indien nodig
set dial display on             ; Stel daarna SET DIAL in indien nodig
set input echo on
set input timeout proceed
set input case ignore
def \%x 0                       ; login prompt teller
goto slhup

:slcmd                          ; stel het modem in op commandomodus
echo Stel het modem in op commandomodus.
clear                           ; Verwijder ongelezen karakters uit de input buffer
pause 1
output +++                      ; hayes escape sequence
input 1 OK\13\10                ; wacht op OK
if success goto slhup
output \13
pause 1
output at\13
input 1 OK\13\10
if fail goto slcmd              ; Als het modem niet antwoordt met OK, probeer het opnieuw

:slhup                          ; hang de telefoon op
clear                           ; Verwijder ongelezen karakters uit de input buffer
pause 1
echo De telefoon wordt opgehangen.
output ath0\13                  ; hayes command voo on hook
input 2 OK\13\10
if fail goto slcmd              ; Als er geen OK antwoord is, stel het modem in op commandomodus

:sldial                         ; Draai het nummer
pause 1
echo Bellen.
output atdt9,550311\13\10               ; put phone number here
assign \%x 0                    ; zero the time counter

:look
clear                           ; Verwijder ongelezen karakters uit de input buffer
increment \%x                   ; Tel de seconden
input 1 {CONNECT }
if success goto sllogin
reinput 1 {NO CARRIER\13\10}
if success goto sldial
reinput 1 {NO DIALTONE\13\10}
if success goto slnodial
reinput 1 {\255}
if success goto slhup
reinput 1 {\127}
if success goto slhup
if &lt; \%x 60 goto look
else goto slhup

:sllogin                        ; login
assign \%x 0                    ; Stel de tijd teller in op nul
pause 1
echo Zoeken naar de login prompt

:slloop
increment \%x                   ; Tel de seconden
clear                           ; Verwijder ongelezen karakters uit de input buffer
output \13
;
; Stel hier de verwachte login prompt in:
;
input 1 {Username: }
if success goto sluid
reinput 1 {\255}
if success goto slhup
reinput 1 {\127}
if success goto slhup
if &lt; \%x 10 goto slloop         ; Probeer 10 x om een login prompt te krijgen
else goto slhup                 ; Hang op en probeer het nogmaals als er 10 mislukte pogingen zijn

:sluid
;
; Vul hier uw gebruikersnaam in:
;
output ppp-login\13
input 1 {Password: }
;
; Vul hier uw wachtwoord in:
;
output ppp-password\13
input 1 {Entering SLIP mode.}
echo
quit

:slnodial
echo \7Er is geen kiestoon, controleer de telefoon lijn!\7
exit 1

; local variables:
; mode: csh
; comment-start: &#34;; &#34;
; comment-start-skip: &#34;; &#34;
; end:</pre></div></div></div></div><div class=sect2><h3 id=ppp-troubleshoot>27.4. Het problemen oplossen van PPP-verbindingen<a class=anchor href=#ppp-troubleshoot></a></h3><div class=paragraph><p>Deze sectie behandelt een paar problemen die kunnen optreden wanneer PPP wordt gebruikt over een modemverbinding. Bijvoorbeeld, misschien moet u exact weten wat de prompt is die het systeem waarop u inbelt presenteert. Sommige providers presenteren de <code>ssword</code> prompt terwijl anderen <code>password</code> tonen als het <code>ppp</code> script niet goed geschreven is en de inlogin poging faalt. De meest standaard manier om <code>ppp</code> verbindingen te onderzoeken op problemen is door handmatig een connectie op te zetten. De volgende informatie helpt u om stap voor stap een handmatige connectie op te zetten.</p></div><div class=sect3><h4 id=_controleer_de_apparaatknooppunten>27.4.1. Controleer de apparaatknooppunten<a class=anchor href=#_controleer_de_apparaatknooppunten></a></h4><div class=paragraph><p>Als er een eigen kernel gebruikt wordt, vergeet dan niet om de volgende regel in uw kernelinstellingenbestand op te nemen:</p></div><div class="literalblock programlisting"><div class=content><pre>device	uart</pre></div></div><div class=paragraph><p>Het apparaat <span class=filename>uart</span> is al in de kernel <code>GENERIC</code> opgenomen, dus zijn er in dit geval geen extra stappen nodig. Controleer de resultaten van het commando <code>dmesg</code> voor het modemapparaat door middel van:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dmesg | grep uart</span></code></pre></div></div><div class=paragraph><p>U zou enige informatie moeten ontvangen over de <span class=filename>uart</span> apparaten. Deze bevinden zich op de COM-poorten die we nodig hebben. Als uw modem zich gedraagt als een standaard seriële poort zou u deze moeten vinden als zijnde <span class=filename>uart1</span> of <span class=filename>COM2</span>. Als dat klopt hoeft u de kernel niet opnieuw te bouwen. Wanneer u de sio-apparaten controleert en het modem is op <span class=filename>uart1</span> te vinden of als <span class=filename>COM2</span> als u zich onder MS-DOS® bevindt, dan is uw modemapparaat <span class=filename>/dev/cuau1</span>.</p></div></div><div class=sect3><h4 id=_handmatig_verbinding_maken>27.4.2. Handmatig verbinding maken<a class=anchor href=#_handmatig_verbinding_maken></a></h4><div class=paragraph><p>Verbinding maken met het internet door handmatig controle te hebben over <code>ppp</code> is snel, makkelijk en een geweldige manier om problemen te vinden bij een verbinding of zelfs voor alleen het verkrijgen van inforamtie over hoe uw provider de <code>ppp</code> cliënt verbindingen behandelt. Laten we starten met PPP vanaf de commando regel. Let op dat in al onze voorbeelden we gebruik maken van <em>example</em> als hostnaam van de machine die PPP draait. U start <code>ppp</code> door enkel het commando <code>ppp</code> te typen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ppp</span></code></pre></div></div><div class=paragraph><p>We hebben nu <code>ppp</code> gestart.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON example&gt; <span class=nb>set </span>device /dev/cuau1</code></pre></div></div><div class=paragraph><p>We stellen ons modem in, in dit geval is dat <span class=filename>cuau1</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON example&gt; <span class=nb>set </span>speed 115200</code></pre></div></div><div class=paragraph><p>We stellen de verbindings snelheid in, in dit geval gebruiken we 115,200 kbps.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON example&gt; <span class=nb>enable </span>dns</code></pre></div></div><div class=paragraph><p>Vertel <code>ppp</code> om onze naam vertaler te configuren, en de juiste naamserver regels toe te voegen aan <span class=filename>/etc/resolv.conf</span>. Als <code>ppp</code> onze hostnaam niet kan bepalen, kunnen we deze later instellen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON example&gt; term</code></pre></div></div><div class=paragraph><p>Wissel naar "terminal" mode zodat we handmatig het modem kunnen bedienen.</p></div><div class="literalblock programlisting"><div class=content><pre>deflink: Entering terminal mode on /dev/cuau1
type &#39;~h&#39; for help</pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>at
OK
atdt123456789</code></pre></div></div><div class=paragraph><p>Gebruik <code>at</code> om het modem te initialiseren, en daarna <code>atdt</code> en het nummer voor uw provider om het inbel proces te beginnen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>CONNECT</code></pre></div></div><div class=paragraph><p>Bevestiging van de verbinding, als we tegen problemen aanlopen met de verbinding, welke niet gerelateerd zijn aan de hardware, is dit de plek om te beginnen om de problemen op te lossen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>provider login:myusername</code></pre></div></div><div class=paragraph><p>Hier wordt u gevraagd om een gebruikersnaam. Geef de gebruikersnaam op welke aangeleverd is door de provider.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>provider pass:mypassword</code></pre></div></div><div class=paragraph><p>Deze keer worden we gevraagd voor een wachtwoord. Vul uw wachtwoord in welke u is aangeleverd door de provider. Net zoals het aanloggen op FreeBSD zal het wachtwoord niet getoond worden.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Shell or PPP:ppp</code></pre></div></div><div class=paragraph><p>Afhankelijk van uw provider wordt deze prompt wellicht nooit getoond. Hier wordt ons gevraagd of we een shell willen starten op de host van de provider, of dat we <code>ppp</code> willen starten. In dit geval is er gekozen voor <code>ppp</code> omdat we een internet verbinding willen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Ppp ON example&gt;</code></pre></div></div><div class=paragraph><p>Let op dat in dit voorbeeld de eerste <code>p</code> een hoofdletter geworden is. Dit geeft aan dat we succesvol verbonden zijn met de provider.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>PPp ON example&gt;</code></pre></div></div><div class=paragraph><p>We hebben ons succesvol geauthenticeerd bij onze provider en we wachten op een IP-adres dat ons wordt toegewezen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>PPP ON example&gt;</code></pre></div></div><div class=paragraph><p>We hebben een IP adres verkregen en hebben succesvol een verbinding opgebouwd.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>PPP ON example&gt;add default HISADDR</code></pre></div></div><div class=paragraph><p>Hier wordt een standaard route toegevoegd. Deze moet worden toegevoegd voordat we kunnen communiceren met de buitenwereld aangezien de enige verbinding op dit moment met de andere machine is. Als dit niet lukt omdat er al een route bestaat, kan er een "bang" karakter (<code>!</code>) geplaatst worden voor de <code>add</code> optie. Als alternatief kan dit ook gedaan worden voordat de verbinding opgezet wordt, waarna een nieuwe route onderhandeld wordt.</p></div><div class=paragraph><p>Als alles goed gegaan is, zou er nu een actieve verbinding moeten zijn met het internet, welke in de achtergrond gezet kan worden door <span class=keyseq><kbd>CTRL</kbd>+<kbd>z</kbd></span> te gebruiken. Als u ziet dat het commando <code>PPP</code> terugkeert naar <code>ppp</code> is de verbinding afgebroken. Dit is goed om te weten, aangezien dit de status van de verbinding toont. Hoofdletter P’s betekenen dat er een verbinding is met de provider, en kleine letters betekend dat de verbinding verloren is gegaan om welke reden dan ook. <code>ppp</code> kent alleen deze twee statussen.</p></div><div class=sect4><h5 id=_debuggen>27.4.2.1. Debuggen<a class=anchor href=#_debuggen></a></h5><div class=paragraph><p>Als u een directe lijn heeft en geen verbinding kan maken, zet dan hardware flow CTS/RTS uit met de <code>set ctsrts off</code> optie. Dit is meestal het geval voor een PPP terminal server waar PPP hangt wanneer deze probeert te schrijven naar uw communicatie link, dus moet deze wachten op een CTS of een Clear To Send signaal welke misschien nooit komt. Als u deze optie gebruikt, moet u ook de <code>set accmap</code> optie gebruiken welke benodigd kan zijn om hardware afhankelijkheden te omzeilen door bepaalde karakters over en weer te sturen, meestal XON/XOFF. Zie de <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> handleiding voor meer informatie over deze optie en hoe deze gebruikt kan worden.</p></div><div class=paragraph><p>Als u een ouder modem heeft, kan het voorkomen dat u ook de <code>set parity even</code> optie moet gebruiken. De parity is standaard ingesteld op none maar wordt gebruikt voor fout controle (met als gevolg een grote verhoging van de hoeveelheid data) bij oudere modems en sommige providers. Dit is bijvoorbeeld een benodigde optie bij de Compuserve provider.</p></div><div class=paragraph><p>Het kan voorkomen dat PPP niet terugkeert naar de commando mode, wat meestal betekent dat er een onderhandelings fout is waarbij de provider wacht op uw kant om de onderhandeling te kunnen beginnen. Op dit moment kunt u gebruik maken van het <code>~p</code> commando om ppp te forceren om de configuratie informatie te versturen.</p></div><div class=paragraph><p>Als u nooit een inlogin prompt krijgt is het zeer waarschijnlijk dat u PAP of CHAP authenticatie moet gebruiken in plaats van de UNIX® stijl in het voorbeeld hierboven. Om gebruik te maken van PAP of CHAP voegt u het volgende opties toe aan PPP voordat u de terminal mode ingaat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON example&gt; <span class=nb>set </span>authname mijngebruikersnaam</code></pre></div></div><div class=paragraph><p>Waarbij <em>mijngebruikersnaam</em> moet worden vervangen met de gebruikersnaam die wordt toegewezen door de provider.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON example&gt; <span class=nb>set </span>authkey mijnwachtwoord</code></pre></div></div><div class=paragraph><p>Waarbij <em>mijnwachtwoord</em> moet worden vervangen door het wachtwoord wat u is toegewezen door de provider.</p></div><div class=paragraph><p>Als u een goed werkende verbinding kunt maken maar het onmogelijk lijkt om een domeinnaam te vinden, probeert u dan <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> te gebruiken met een IP adres en kijk of er enige informatie terugkomt. Als u 100 procent (100%) packet loss ziet is het zeer waarschijnlijk dat u geen default route heeft gekregen. Controleer nogmaals of de optie <code>add default HISADDR</code> ingesteld is tijdens de connectie. Als u verbinding kunt maken met een extern IP adres is het mogelijk dat een naamserver niet is toegevoegd aan het <span class=filename>/etc/resolv.conf</span> bestand. Dit bestand moet er uitzien als volgend:</p></div><div class="literalblock programlisting"><div class=content><pre>domain example.com
nameserver x.x.x.x
nameserver y.y.y.y</pre></div></div><div class=paragraph><p>Waar <em>x.x.x.x</em> en <em>y.y.y.y</em> moet worden vervangen door het IP adres van uw providers naamservers. Deze informatie kan mogelijk wel of niet geleverd zijn toen u zich inschreef, maar een snel telefoontje naar uw provider zou hierin uitkomst kunnen bieden.</p></div><div class=paragraph><p>U kunt ook <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> gebruiken om een log functie voor PPP aan te maken. Voeg het volgende toe aan <span class=filename>/etc/syslog.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>!ppp
*.*     /var/log/ppp.log</pre></div></div><div class=paragraph><p>Deze functionaliteit bestaat in de meeste gevallen al.</p></div></div></div></div><div class=sect2><h3 id=pppoe>27.5. PPP gebruiken over Ethernet (PPPoE)<a class=anchor href=#pppoe></a></h3><div class=paragraph><p>Deze sectie beschrijft hoe PPP over Ethernet opgezet kan worden (PPPoE).</p></div><div class=sect3><h4 id=_het_configureren_van_de_kernel>27.5.1. Het configureren van de kernel<a class=anchor href=#_het_configureren_van_de_kernel></a></h4><div class=paragraph><p>Inmiddels is het niet langer benodigd om de kernel configuratie aan te passen voor PPPoE. Als de benodigde netgraph ondersteuning niet in de kernel aanwezig is zal deze dynamisch geladen worden door ppp.</p></div></div><div class=sect3><h4 id=_het_instellen_van_ppp_conf>27.5.2. Het instellen van <span class=filename>ppp.conf</span><a class=anchor href=#_het_instellen_van_ppp_conf></a></h4><div class=paragraph><p>Hieronder volgt een voorbeeld van een werkende <span class=filename>ppp.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>default:
  set log Phase tun command # Er kan meer gedetailleerde logging ingeschakeld worden indien gewenst
  set ifaddr 10.0.0.1/0 10.0.0.2/0

name_of_service_provider:
  set device PPPoE:xl1 # Vervang x11 met uw ethernet apparaat
  set authname UWLOGINNAAM
  set authkey UWWACHTWOORD
  set dial
  set login
  add default HISADDR</pre></div></div></div><div class=sect3><h4 id=_het_draaien_van_ppp>27.5.3. Het draaien van ppp<a class=anchor href=#_het_draaien_van_ppp></a></h4><div class=paragraph><p>Als de <code>root</code> gebruiker kunt u het volgende draaien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ppp -ddial name_of_service_provider</span></code></pre></div></div></div><div class=sect3><h4 id=_het_pstarten_van_ppp_tijdens_het_opstarten>27.5.4. Het pstarten van ppp tijdens het opstarten<a class=anchor href=#_het_pstarten_van_ppp_tijdens_het_opstarten></a></h4><div class=paragraph><p>Voeg het volgende toe aan uw <span class=filename>/etc/rc.conf</span> bestand:</p></div><div class="literalblock programlisting"><div class=content><pre>ppp_enable=&#34;YES&#34;
ppp_mode=&#34;ddial&#34;
ppp_nat=&#34;YES&#34;	# Indien u nat wilt inschakelen voor het lokale netwerk, gebruik anders NO
ppp_profile=&#34;naam_van_service_provider&#34;</pre></div></div></div><div class=sect3><h4 id=_gebruik_maken_van_een_pppoe_service_label>27.5.5. Gebruik maken van een PPPoE service label<a class=anchor href=#_gebruik_maken_van_een_pppoe_service_label></a></h4><div class=paragraph><p>Soms is het nodig om een service tag te gebruiken om verbinding te kunnen maken. Service tags worden gebruikt om onderscheid te maken tussen de verschillende PPPoE servers die verbonden zijn met een netwerk.</p></div><div class=paragraph><p>Uw provider zou u de juiste service tag gegevens verstrekt moeten hebben in de documentatie die opgeleverd is. Als u deze niet kunt vinden in de documentatie moet u deze opvragen bij uw technische support afdeling van uw provider.</p></div><div class=paragraph><p>Als allerlaatste optie kunt u de aangerade methode gebruiken van het <a href=http://www.roaringpenguin.com/pppoe/>Roaring Penguin PPPoE</a> programma welke gevonden kan worden in de <a href=./#ports>Ports Collectie</a>. Houd u echter in uw achterhoofd dat dit uw modem ernstige schade kan toebrengen, dus denkt u er goed over na voordat u het uitprobeert. Installeer simpelweg het programma dat is meegeleverd bij het modem door uw provider. Open hierna het <b class=menuref>System</b> menu vanuit het programma. De naam van uw profiel moet hier te vinden zijn. Meestal is deze <em>ISP</em>.</p></div><div class=paragraph><p>De naam van het profiel (servicetag) zal worden gebruikt in de PPPoE configuratie regel van <span class=filename>ppp.conf</span> in het provider gedeelte van het <code>set device</code> commando (zie de <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> handleiding voor meer informatie hierover). Dit zou er als volgend uit moeten zien:</p></div><div class="literalblock programlisting"><div class=content><pre>set device PPPoE:xl1:ISP</pre></div></div><div class=paragraph><p>Vergeet u niet om <em>xl1</em> te vervangen door het juiste apparaat voor uw Ethernet kaart.</p></div><div class=paragraph><p>Vergeet u niet om <em>ISP</em> te vergangen door het profiel wat hierboven ingesteld is.</p></div><div class=paragraph><p>Voor meer informatie zie:</p></div><div class=ulist><ul><li><p><a href=http://renaud.waldura.com/doc/freebsd/pppoe/>Cheaper Broadband with FreeBSD on DSL</a> door Renaud Waldura.</p></li></ul></div></div><div class=sect3><h4 id=ppp-3com>27.5.6. PPPoE met een 3Com® HomeConnect™ ADSL Modem Dual Link<a class=anchor href=#ppp-3com></a></h4><div class=paragraph><p>Dit modem volgt <a href=http://www.faqs.org/rfcs/rfc2516.html>RFC 2516</a> niet (<em>Een methode voor het versturen van PPP over Ethernet (PPPoE)</em> geschreven door by L. Mamakos, K. Lidl, J. Evarts, D. Carrel, D. Simone, and R. Wheeler). Daarentegen is een ander type pakket code gebruikt voor de Ethernet frames. Klaagt u alstublift bij <a href=http://www.3com.com/>3Com</a> als u vind dat ze zich aan de PPPoE specificatie moeten houden.</p></div><div class=paragraph><p>Om FreeBSD in staat te stellen om te communiceren met dit apparaat, moet er een sysctl ingesteld worden. Dit kan automatisch tijdens het opstarten gedaan worden door het bewerken van <span class=filename>/etc/sysctl.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>net.graph.nonstandard_pppoe=1</pre></div></div><div class=paragraph><p>Dit kan ook direct gedaan worden met het commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl net.graph.nonstandard_pppoe=1</span></code></pre></div></div><div class=paragraph><p>Helaas is het, doordat dit een systeem brede instelling is, niet mogelijk om tegelijkertijd met een normale PPPoE cliënt of server en een 3Com® HomeConnect™ ADSL-modem te communiceren.</p></div></div></div><div class=sect2><h3 id=pppoa>27.6. Gebruik maken van PPP over ATM (PPPoA)<a class=anchor href=#pppoa></a></h3><div class=paragraph><p>Het volgende beschrijft hoe PPP over ATM (PPPoA) opgezet kan worden. PPPoA is een populaire keuze binnen Europese DSL providers.</p></div><div class=sect3><h4 id=_gebruik_maken_van_pppoa_met_de_alcatel_speedtouch_usb>27.6.1. Gebruik maken van PPPoA met de Alcatel SpeedTouch™ USB<a class=anchor href=#_gebruik_maken_van_pppoa_met_de_alcatel_speedtouch_usb></a></h4><div class=paragraph><p>PPPoA ondersteuning voor dit apparaat wordt geleverd door middel van een port in FreeBSD omdat de firmware wordt gedistribueerd onder <a href=http://www.speedtouchdsl.com/disclaimer_lx.htm>Alcatel’s licentie overeenkomst</a> en mag derhalve niet vrijelijk verspreid worden met het basis systeem van FreeBSD.</p></div><div class=paragraph><p>Om de software te installeren, wordt simpelweg de <a href=#ports>Ports Collectie</a> gebruikt. Installeer de <a class=package href=https://cgit.freebsd.org/ports/tree/net/pppoa/>net/pppoa</a> port en volg de instructies die meegeleverd worden.</p></div><div class=paragraph><p>Zoals de meeste USB apparaten moet de Alcatel SpeedTouch™ USB zijn firmware downloaden van de host computer om correct te kunnen werken. Het is mogelijk om dit proces te automatiseren binnen FreeBSD zodat deze overdracht elke keer gebeurd als het apparaat in een USB poort wordt gestoken. De volgende informatie kan worden toegevoegd aan het <span class=filename>/etc/usbd.conf</span> bestand om deze automatische overdracht in te schakelen. Dit bestand moet bewerkt worden door de <code>root</code> gebruiker.</p></div><div class="literalblock programlisting"><div class=content><pre>device &#34;Alcatel SpeedTouch USB&#34;
    devname &#34;ugen[0-9]+&#34;
    vendor 0x06b9
    product 0x4061
    attach &#34;/usr/local/sbin/modem_run -f /usr/local/libdata/mgmt.o&#34;</pre></div></div><div class=paragraph><p>Om de USB daemon, usbd, te starten moet de volgende regel toegevoegd worden aan <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>usbd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het is ook mogelijk om ppp op te zetten om in te bellen tijdens het opstarten. Om dit te doen moet de volgende regel worden toegevoegd aan <span class=filename>/etc/rc.conf</span>. Voor deze procedure moet er ook aangelogt zijn als de <code>root</code> gebruiker.</p></div><div class="literalblock programlisting"><div class=content><pre>ppp_enable=&#34;YES&#34;
ppp_mode=&#34;ddial&#34;
ppp_profile=&#34;adsl&#34;</pre></div></div><div class=paragraph><p>Om dit correct te laten werken moet het voorbeeld <span class=filename>ppp.conf</span> bestand gebruikt worden welke geleverd wordt door de <a class=package href=https://cgit.freebsd.org/ports/tree/net/pppoa/>net/pppoa</a> port.</p></div></div><div class=sect3><h4 id=_gebruik_maken_van_mpd>27.6.2. Gebruik maken van mpd<a class=anchor href=#_gebruik_maken_van_mpd></a></h4><div class=paragraph><p>U kunt mpd gebruiken om met een variateit aan diensten verbinding te maken, in het bijzonder PPTP diensten. U kunt mpd vinden in de Ports Collectie, <a class=package href=https://cgit.freebsd.org/ports/tree/net/mpd/>net/mpd</a>. Veel ADSL-modems vereisen dat er een PPTP tunnel wordt gecreeërd tussen het modem en de computer, een voorbeeld van zo’n modem is de Alcatel SpeedTouch™ Home.</p></div><div class=paragraph><p>Eerst moet u de port installeren waarna mpd geconfigureerd kan worden om uw eisen en provider instellingen op te geven. De port plaatst een verzameling voorbeeldconfiguratiebestanden welke goed gedocumenteerd zijn in <span class=filename>PREFIX/etc/mpd/</span>. Let op dat <em>PREFIX</em> betekend dat dit de directory is waar uw ports in worden geïnstalleerd. Standaard is dit <span class=filename>/usr/local/</span>. Een complete handleiding om mpd te configureren is beschikbaar in HTML formaat zodra de port geïnstalleerd is. Deze wordt geplaatst in <span class=filename>PREFIX/shared/doc/mpd/</span>. Hieronder staat een voorbeeld configuratie om verbinding te maken met een ADSL dienstverlener door het gebruik van mpd. De configuratie is verspreid over twee bestanden, allereerst het <span class=filename>mpd.conf</span> bestand:</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Dit voorbeeld van het bestand <span class=filename>mpd.conf</span> werkt alleen met mpd 4.X.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>default:
    load adsl

adsl:
    new -i ng0 adsl adsl
    set bundle authname gebruikersnaam <i class=conum data-value=1></i><b>(1)</b>
    set bundle password wachtwoord <i class=conum data-value=2></i><b>(2)</b>
    set bundle disable multilink

    set link no pap acfcomp protocomp
    set link disable chap
    set link accept chap
    set link keep-alive 30 10

    set ipcp no vjcomp
    set ipcp ranges 0.0.0.0/0 0.0.0.0/0

    set iface route default
    set iface disable on-demand
    set iface enable proxy-arp
    set iface idle 0

    open</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>De gebruikersnaam die gebruikt wordt om uzelf te authenticeren aan uw provider.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Het wachtwoord wat gebruikt wordt om uzelf te authenticeren aan uw provider.</td></tr></tbody></table></div><div class=paragraph><p>Het <span class=filename>mpd.links</span> bestand bevat informatie over de link, of linken waarmee u verbinding wilt maken. Een voorbeeld <span class=filename>mpd.links</span> wat bij bovenstaand voorbeeld hoort is hieronder gegeven:</p></div><div class="literalblock programlisting"><div class=content><pre>adsl:
    set link type pptp
    set pptp mode active
    set pptp enable originate outcall
    set pptp self 10.0.0.1 <i class=conum data-value=1></i><b>(1)</b>
    set pptp peer 10.0.0.138 <i class=conum data-value=2></i><b>(2)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Het IP-adres van uw FreeBSD computer waar vanaf mpd gebruikt wordt.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Het IP-adres van uw ADSL-modem. Voor de Alcatel SpeedTouch™ Home is dit adres standaard <code>10.0.0.138</code>.</td></tr></tbody></table></div><div class=paragraph><p>Het is mogelijk om de verbinding makkelijk te initialiseren door het volgende commando als <code>root</code> uit te voeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mpd -b adsl</span></code></pre></div></div><div class=paragraph><p>U kunt de status van de verbinding zien met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ifconfig ng0
ng0: <span class=nv>flags</span><span class=o>=</span>88d1&lt;UP,POINTOPOINT,RUNNING,NOARP,SIMPLEX,MULTICAST&gt; mtu 1500
     inet 216.136.204.117 <span class=nt>--</span><span class=o>&gt;</span> 204.152.186.171 netmask 0xffffffff</code></pre></div></div><div class=paragraph><p>Het gebruik van mpd is de aangeraden manier om met een ADSL dienst te verbinden met FreeBSD.</p></div></div><div class=sect3><h4 id=_gebruik_maken_van_pptpclient>27.6.3. Gebruik maken van pptpclient<a class=anchor href=#_gebruik_maken_van_pptpclient></a></h4><div class=paragraph><p>Het is ook mogelijk om FreeBSD te gebruiken om naar een andere PPPoA dienstenm verbinding te maken door middel van de <a class=package href=https://cgit.freebsd.org/ports/tree/net/pptpclient/>net/pptpclient</a> port.</p></div><div class=paragraph><p>Om gebruik te maken van <a class=package href=https://cgit.freebsd.org/ports/tree/net/pptpclient/>net/pptpclient</a> om naar een DSL dienst verbinding te maken, installeert u de port of package en bewerkt u <span class=filename>/etc/ppp/ppp.conf</span> U moet dit onder de <code>root</code> gebruiker doen, om beide acties uit te voeren. Een voorbeeld sectie van <span class=filename>ppp.conf</span> is hieronder gegeven. Voor meer informatie over <span class=filename>ppp.conf</span> consulteert u de <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> handleiding.</p></div><div class="literalblock programlisting"><div class=content><pre>adsl:
 set log phase chat lcp ipcp ccp tun command
 set timeout 0
 enable dns
 set authname gebruikersnaam <i class=conum data-value=1></i><b>(1)</b>
 set authkey wachtwoord <i class=conum data-value=2></i><b>(2)</b>
 set ifaddr 0 0
 add default HISADDR</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>De gebruikersnaam van uw account bij uw DSL provider.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Het wachtwoord voor uw account.</td></tr></tbody></table></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Omdat u het wachtwoord van uw account in het <span class=filename>ppp.conf</span> bestand in leesbare vorm moet plaatsen, moet u ervoor zorgen dat niemand anders de inhoud van dit bestand kan lezen. De volgende serie van commando’s zorgt ervoor dat het bestand alleen leesbaar is door de <code>root</code> gebruiker. Raadpleeg de handleidingen van <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=chown&amp;sektion=8&amp;format=html">chown(8)</a> voor verdere informatie.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chown root:wheel /etc/ppp/ppp.conf</span>
<span class=c># chmod 600 /etc/ppp/ppp.conf</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Dit opent een tunnel voor een PPP sessie naar uw DSL router. Ethernet DSL-modems hebben een voor geconfigureerd LAN IP adres waarmee u verbinding maakt. In het geval van de Alcatel SpeedTouch™ home is <code>10.0.0.138</code> het adres. Uw router documentatie vertelt u welk adres uw apparaat gebruikt. Om de tunnel te openen en om een PPP sessie op te zetten, start u het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pptp address adsl</span></code></pre></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Het kan wenselijk zijn om een ampersand ("&") toe te voegen aan het einde van het vorige commando, omdat pptp uw prompt niet teruggeeft.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Er wordt een <span class=filename>tun</span> virtueel tunnel apparaat gecreeërd voor interactie tussen de pptp en ppp processen. Zodra u terugbent op uw prompt, of als pptp bevestigd dat er een verbinding is, kunt u de tunnel als volgend inzien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ifconfig tun0
tun0: <span class=nv>flags</span><span class=o>=</span>8051&lt;UP,POINTOPOINT,RUNNING,MULTICAST&gt; mtu 1500
        inet 216.136.204.21 <span class=nt>--</span><span class=o>&gt;</span> 204.152.186.171 netmask 0xffffff00
        Opened by PID 918</code></pre></div></div><div class=paragraph><p>Als het niet mogelijk is om verbinding te maken, controleert u de configuratie van uw router, welke meestal bereikbaar is door middel van telnet of via een web browser. Als u nog steeds geen verbinding kunt maken moet u de resultaten van het <code>pptp</code> onderzoeken en de inhoud van het ppp log bestand, <span class=filename>/var/log/ppp.log</span> voor meer hints over wat er mis kan zijn.</p></div></div></div><div class=sect2><h3 id=slip>27.7. Gebruik maken van SLIP<a class=anchor href=#slip></a></h3><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Deze sectie geldt en is alleen geldig voor FreeBSD 7.X.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=slipc>27.7.1. Het opzetten van een SLIP-cliënt<a class=anchor href=#slipc></a></h4><div class=paragraph><p>Het volgende is één manier om een FreeBSD machine in te stellen voor gebruik met SLIP op een statisch host netwerk. Voor dynamische hostnaam toewijzing (uw adres veranderd elke keer als u inbelt), heeft u waarschijnlijk een meer complexe opzet nodig.</p></div><div class=paragraph><p>Bepaal eerst aan welke seriële poort uw modem verbonden is. Veel mensen gebruiken hiervoor een symbolische link zoals <span class=filename>/dev/modem</span> welke verwijst naar de echte naam van het apparaat <span class=filename>/dev/cuadN</span>. Dit geeft de mogelijkheid om naam abstract te houden, voor het geval het modem ooit verplaatst wordt naar een andere poort. Het kan best een vervelende klus zijn wanneer er een aantal bestanden in <span class=filename>/etc</span> en <span class=filename>.kermrc</span> bestanden verspreid over het gehele systeem gerepareerd moeten worden!</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><span class=filename>/dev/cuad0</span> is <span class=filename>COM1</span>, <span class=filename>cuad1</span> is <span class=filename>COM2</span>, etc.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Zorg ervoor dat u het volgende in uw kernel configuratie bestand hebt:</p></div><div class="literalblock programlisting"><div class=content><pre>device   sl</pre></div></div><div class=paragraph><p>Deze is standaard opgenomen in de <span class=filename>GENERIC</span> kernel, dus dat zou geen problemen moeten opleveren tenzij u deze verwijderd heeft.</p></div><div class=sect4><h5 id=_dingen_die_u_maar_eenmalig_hoeft_uit_te_voeren>27.7.1.1. Dingen die u maar eenmalig hoeft uit te voeren<a class=anchor href=#_dingen_die_u_maar_eenmalig_hoeft_uit_te_voeren></a></h5><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Voeg uw machine, de router en de naamservers toe aan uw <span class=filename>/etc/hosts</span> bestand. Ons bestand ziet er als volgend uit:</p><div class="literalblock programlisting"><div class=content><pre>127.0.0.1               localhost loghost
136.152.64.181          water.CS.Example.EDU water.CS water
136.152.64.1            inr-3.CS.Example.EDU inr-3 slip-gateway
128.32.136.9            ns1.Example.EDU ns1
128.32.136.12           ns2.Example.EDU ns2</pre></div></div></li><li><p>Zorg ervoor dat u <code>files</code> voor <code>dns</code> in de <code>hosts:</code> sectie van uw <span class=filename>/etc/nsswitch.conf</span> bestand. Zonder deze parameters zouden er interessante dingen kunnen gebeuren.</p></li><li><p>Bewerk het <span class=filename>/etc/rc.conf</span> bestand.</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>Stel uw hostnaam in door de regel te bewerken die aangeeft:</p><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;myname.my.domain&#34;</pre></div></div><div class=paragraph><p>De volledig gekwalificeerde internet hostnaam moet hier geplaatst worden.</p></div></li><li><p>Stel de standaard router in door het aanpassen van de volgende regel van:</p><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;NO&#34;</pre></div></div><div class=paragraph><p>naar:</p></div><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;slip-gateway&#34;</pre></div></div></li></ol></div></li><li><p>Creeër en bestand genaamd <span class=filename>/etc/resolv.conf</span> welke het volgende bevat:</p><div class="literalblock programlisting"><div class=content><pre>domain CS.Example.EDU
nameserver 128.32.136.9
nameserver 128.32.136.12</pre></div></div><div class=paragraph><p>Zoals u kunt zien, stellen deze de naamserver hosten in. Uiteraard is het echte domein en adres afhankelijk van uw omgeving.</p></div></li><li><p>Stel het wachtwoord in voor de <code>root</code> en de <code>toor</code> gebruikers (en elke andere gebruiker die geen wachtwoord heeft).</p></li><li><p>Herstart de machine en controleeer of deze opkomt met de correcte hostnaam.</p></li></ol></div></div></div></div><div class=sect4><h5 id=_het_opzetten_van_een_slip_verbinding>27.7.1.2. Het opzetten van een SLIP-verbinding<a class=anchor href=#_het_opzetten_van_een_slip_verbinding></a></h5><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Bel in, type <code>slip</code> op de prompt en voer uw machine naam en wachtwoord in. Wat is vereist, is afhankelijk van uw omgeving. Als u gebruik maakt van Kermit kan een script als de volgende gebruikt worden:</p><div class="literalblock programlisting"><div class=content><pre># kermit setup
set modem hayes
set line /dev/modem
set speed 115200
set parity none
set flow rts/cts
set terminal bytesize 8
set file type binary
# De volgende macro zal inbellen en ons inloggen.
define slip dial 643-9600, input 10 =&gt;, if failure stop, -
output slip\x0d, input 10 Username:, if failure stop, -
output silvia\x0d, input 10 Password:, if failure stop, -
output ***\x0d, echo \x0aCONNECTED\x0a</pre></div></div><div class=paragraph><p>Uiteraard moet u uw gebruikersnaam en wachtwoord wijzigen zodat deze overeenkomen met die van u. Nadat dit gedaan is kunt u <code>slip</code> invullen op de Kermit prompt om verbinding te maken.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het achterlaten van uw wachtwoord in leesbare tekst waar dan ook op het bestandssysteem is zeker een <em>slecht</em> idee. Doe dit op eigen risico.</p></div></td></tr></tbody></table></div></li><li><p>Laat Kermit daar (het programma kan tijdelijk uitgeschakeld worden door <span class=keyseq><kbd>Ctrl</kbd>+<kbd>z</kbd></span>) en type vervolgens als <code>root</code>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># slattach -h -c -s 115200 /dev/modem</span></code></pre></div></div><div class=paragraph><p>Als u in staat bent om andere hosten met <code>ping</code> te benaderen aan de andere kant van de router, bent u verbonden! Als dit niet werkt kunt u wellicht de <code>-a</code> gebruiken in plaats van de <code>-c</code> als argument voor <code>slattach</code>.</p></div></li></ol></div></div></div></div><div class=sect4><h5 id=_hoe_de_verbinding_afgebroken_moet_worden>27.7.1.3. Hoe de verbinding afgebroken moet worden<a class=anchor href=#_hoe_de_verbinding_afgebroken_moet_worden></a></h5><div class=dlist><dl><dt class=hdlist1>Doe het volgende</dt></dl></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -INT `cat /var/run/slattach.modem.pid`</span></code></pre></div></div><div class=paragraph><p>om <code>slattach</code> te stoppen. Houd in uw achterhoofd dat u dit als <code>root</code> moet doen. Ga hierna terug naar <code>kermit</code> (door het intypen van <code>fg</code> als u deze tijdelijk uitgeschakeld had) en verlaat de applicatie (<kbd>q</kbd>).</p></div><div class=paragraph><p>De <a href="https://man.freebsd.org/cgi/man.cgi?query=slattach&amp;sektion=8&amp;format=html">slattach(8)</a> handleiding zegt dat <code>ifconfig sl0 down</code> uitgevoerd moet worden om de interface uit te schakelen, maar dit lijkt geen verschil op te leveren. (<code>ifconfig sl0</code> lijkt hetzelfde resultaat te geven.)</p></div><div class=paragraph><p>Soms kan het gebeuren dat het modem weigert om de carrier los te laten. Start in dat geval simpelweg <code>kermit</code> en stop deze wederom. Meestal stopt het met de tweede poging.</p></div></div><div class=sect4><h5 id=_problemen_oplossen_5>27.7.1.4. Problemen oplossen<a class=anchor href=#_problemen_oplossen_5></a></h5><div class=paragraph><p>Als dit niet werkt, voelt u zich dan vrij om rond te vragen op de <a href=https://lists.FreeBSD.org/subscription/freebsd-net>freebsd-net</a> mailing lijst. De volgende dingen zijn mensen al eens tegen aangelopen:</p></div><div class=ulist><ul><li><p>Het niet gebruiken van de <code>-c</code> of <code>-a</code> optie voor <code>slattach</code> (Dit zou niet fataal moeten zijn, maar sommige mensen hebben aangegeven dat het de problemen oplostte.)</p></li><li><p>Het intypen van <code>s10</code> in plaats van <code>sl0</code> (het verschil is wellicht lastig te zien met sommige fonts).</p></li><li><p>Probeer <code>ifconfig sl0</code> uit te voeren om de interface status te zien. U kunt bijvoorbeeld krijgen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig sl0</span>
sl0: <span class=nv>flags</span><span class=o>=</span>10&lt;POINTOPOINT&gt;
        inet 136.152.64.181 <span class=nt>--</span><span class=o>&gt;</span> 136.152.64.1 netmask ffffff00</code></pre></div></div></li><li><p>Als u <code>no route to host</code> krijgt van het <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> commando, is er mogelijk een probleem met uw route tabel. U kunt het <code>netstat -r</code> commando uitvoeren om de huidige routes te zien:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># netstat -r</span>
Routing tables
Destination      Gateway            Flags     Refs     Use  IfaceMTU    Rtt    Netmasks:

<span class=o>(</span>root node<span class=o>)</span>
<span class=o>(</span>root node<span class=o>)</span>

Route Tree <span class=k>for </span>Protocol Family inet:
<span class=o>(</span>root node<span class=o>)</span> <span class=o>=&gt;</span>
default          inr-3.Example.EDU  UG          8   224515  sl0 -      -
localhost.Exampl localhost.Example. UH          5    42127  lo0 -       0.438
inr-3.Example.ED water.CS.Example.E UH          1        0  sl0 -      -
water.CS.Example localhost.Example. UGH        34 47641234  lo0 -       0.438
<span class=o>(</span>root node<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Het voorgaand voorbeeld komt van een relatief druk systeem. De getallen op uw systeem zullen anders zijn naar gelang de netwerk activiteiten.</p></div></li></ul></div></div></div><div class=sect3><h4 id=slips>27.7.2. Het opzetten van een SLIP-server<a class=anchor href=#slips></a></h4><div class=paragraph><p>Dit document levert suggesties voor het opzetten van een SLIP-server op een FreeBSD systeem, welke meestal betekent het configureren van uw systeem om automatisch verbindingen op te zetten wanneer er wordt ingelogt met remote SLIP cliënten.</p></div><div class=sect4><h5 id=slips-prereqs>27.7.2.1. Eisen vooraf<a class=anchor href=#slips-prereqs></a></h5><div class=paragraph><p>Deze sectie is vrij technisch van aard, dus achtergrond informatie is vereist. Er wordt aangenomen dat u bekend bent met het TCP/IP-netwerk protocol, en in dan in het bijzonder met netwerk en node adresseringen, netwerk adres maskers, subnetten, routes en dynamische routering protocollen zoals RIP. Het configureren van een SLIP-dienst op een inbel server vereist kennis van deze concepten en als u daarmee niet bekend bent, leest u dan aub een versie van of Craig Hunt’s <em>TCP/IP Network Administration</em> gepubliceerd door O’Reilly & Associates, Inc. (ISBN Number 0-937175-82-X), of Douglas Comer’s boeken over het TCP/IP protocol.</p></div><div class=paragraph><p>Daarnaast wordt er vanuit gegaan dat u reeds uw modem(s) heeft geconfigureerd en dat u de juiste systeem bestanden heeft aangepast zodat er logins mogelijk zijn door uw modem(s) heen. Als u dat nog niet heeft gedaan, zie dan <a href=./#dialup>Inbeldienst</a> voor details over het opzetten van inbel diensten. Wellicht wilt u ook de handleiding bekijken voor <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> voor meer informatie over de seriële port device driver en de <a href="https://man.freebsd.org/cgi/man.cgi?query=ttys&amp;sektion=5&amp;format=html">ttys(5)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a>, & <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> handleidingen voor informatie die relevant zijn voor het configureren van het systeem zodat logins mogelijk worden op modems, en wellicht <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a> voor informatie over het instellen van de seriële poort (zoals <code>clocal</code> voor direct verbonden seriële interfaces).</p></div></div><div class=sect4><h5 id=_snel_overzicht_2>27.7.2.2. Snel overzicht<a class=anchor href=#_snel_overzicht_2></a></h5><div class=paragraph><p>In een typische configuratie, werkt het gebruik van FreeBSD als een SLIP-server als volgend: een SLIP-gebruiker belt in op uw FreeBSD SLIP-server systeem en logt in met een speciaal SLIP-login ID dat gebruik maakt van <span class=filename>/usr/sbin/sliplogin</span>. Het <code>sliplogin</code> programma leest door het <span class=filename>/etc/sliphome/slip.hosts</span> bestand om een corresponderende regel te vinden voor de speciale gebruiker en als deze een match vindt verbind het de seriële lijn met een beschikbare SLIP-interface waarna het shellscript <span class=filename>/etc/sliphome/slip.login</span> wordt uitgevoerd om de SLIP-interface te configureren.</p></div><div class=sect5><h6 id=_een_voorbeeld_van_slip_server_login>27.7.2.2.1. Een voorbeeld van SLIP-server login<a class=anchor href=#_een_voorbeeld_van_slip_server_login></a></h6><div class=paragraph><p>Bijvoorbeeld, als een SLIP-user-ID <code>Shelmerg</code> is, kan <code>Shelmerg</code>'s regel in <span class=filename>/etc/master.passwd</span> er als volgt uitzien:</p></div><div class="literalblock programlisting"><div class=content><pre>Shelmerg:password:1964:89::0:0:Guy Helmer - SLIP:/usr/users/Shelmerg:/usr/sbin/sliplogin</pre></div></div><div class=paragraph><p>Wanneer <code>Shelmerg</code> inlogt, zoekt het <code>sliplogin</code> programma in het <span class=filename>/etc/sliphome/slip.hosts</span> bestand voor een regel dat een corresponderende user ID heeft, er kan bijvoorbeeld een regel staan in <span class=filename>/etc/sliphome/slip.hosts</span> dat eruit ziet als volgend:</p></div><div class="literalblock programlisting"><div class=content><pre>Shelmerg        dc-slip sl-helmer       0xfffffc00		  autocomp</pre></div></div><div class=paragraph><p><code>sliplogin</code> zal de corresponderende regel vinden en de seriële lijn koppelen aan de eerste beschikbare SLIP-interface, waarna <span class=filename>/etc/sliphome/slip.login</span> wordt uitgevoerd zoals volgend:</p></div><div class="literalblock programlisting"><div class=content><pre>/etc/sliphome/slip.login 0 19200 Shelmerg dc-slip sl-helmer 0xfffffc00 autocomp</pre></div></div><div class=paragraph><p>Als alles goed gaat, zal <span class=filename>/etc/sliphome/slip.login</span> een <code>ifconfig</code> commando uitvoeren voor de SLIP interface waaraan <code>sliplogin</code> zichzelf koppelt (SLIP-interface 0 zoals in bovenstaand voorbeeld was de eerste parameter in de lijst welke gegeven is aan <span class=filename>slip.login</span>) om een lokaal IP-adres in te stellen (<code>dc-slip</code>), een remote IP adres (<code>sl-helmer</code>), een netwerk master voor de SLIP-interface (<code>0xfffffc00</code>), en enkele additionele vlaggen (<code>autocomp</code>). Als er iets misgaat zal <code>sliplogin</code> meestal voldoende goede informatie loggen via de syslogd daemon faciliteiten, welke meestal logt naar <span class=filename>/var/log/messages</span> (zie de handleidingen van <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog.conf&amp;sektion=5&amp;format=html">syslog.conf(5)</a> en controleer het <span class=filename>/etc/syslog.conf</span> bestand om te zien wat syslogd logt en waar dit naartoe gelogt wordt).</p></div></div></div><div class=sect4><h5 id=_kernel_configuratie>27.7.2.3. Kernel-configuratie<a class=anchor href=#_kernel_configuratie></a></h5><div class=paragraph><p>FreeBSD’s standaard kernel (<span class=filename>GENERIC</span>) heeft reeds ondersteuning voor SLIP (<a href="https://man.freebsd.org/cgi/man.cgi?query=sl&amp;sektion=4&amp;format=html">sl(4)</a>), in het geval van een custom kernel moet de volgende regel worden toegevoegd aan de kernel configuratie:</p></div><div class="literalblock programlisting"><div class=content><pre>device   sl</pre></div></div><div class=paragraph><p>Standaard zal uw FreeBSD machine geen pakketten doorsturen. Als u wilt dat uw FreeBSD SLIP-server zich gedraagt als router zult u het bestand <span class=filename>/etc/rc.conf</span> moeten bewerken en de instelling van de <code>gateway_enable</code> variabele moeten aanpassen naar <code>YES</code>. Dit zorgt ervoor dat de machine na een herstart zich zal blijven gedragen als router.</p></div><div class=paragraph><p>Om de instellingen meteen actief te maken kunt u het volgende commando als <code>root</code> uitvoeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service routing start</span></code></pre></div></div><div class=paragraph><p>Raadpleeg aub <a href=./#kernelconfig>De FreeBSD-kernel instellen</a> over het configureren van de FreeBSD kernel voor meer hulp over het herconfigureren van uw kernel.</p></div></div><div class=sect4><h5 id=_sliplogin_configuratie>27.7.2.4. Sliplogin-configuratie<a class=anchor href=#_sliplogin_configuratie></a></h5><div class=paragraph><p>Zoals eerder vermeld, zijn er drie bestanden in de map <span class=filename>/etc/sliphome</span> die onderdeel zijn van de configuratie voor <span class=filename>/usr/sbin/sliplogin</span> (zie <a href="https://man.freebsd.org/cgi/man.cgi?query=sliplogin&amp;sektion=8&amp;format=html">sliplogin(8)</a> voor de actuele handleiding voor <code>sliplogin</code>): <span class=filename>slip.hosts</span>, welke de SLIP-gebruikers definieert en de gekoppelde IP adressen; <span class=filename>slip.login</span>, welke meestal de SLIP-interface configureert en (optioneel) <span class=filename>slip.logout</span>, welke de effecten van <span class=filename>slip.login</span> ongedaan maakt wanneer de seriële verbinding verbroken wordt.</p></div><div class=sect5><h6 id=_slip_hosts_configuratie>27.7.2.4.1. <span class=filename>slip.hosts</span> configuratie<a class=anchor href=#_slip_hosts_configuratie></a></h6><div class=paragraph><p><span class=filename>/etc/sliphome/slip.hosts</span> bevat regels welke minstens vier onderdelen heeft die gescheiden worden door een spatie:</p></div><div class=ulist><ul><li><p>SLIP-gebruikers login ID</p></li><li><p>Lokale adres (lokaal voor de SLIP-server) van de SLIP-link</p></li><li><p>Remote adres van de SLIP-link</p></li><li><p>Netwerk masker</p></li></ul></div><div class=paragraph><p>De lokale en remote adressen mogen host namen zijn (Welke naar IP-adressen vertaald kunnen worden door <span class=filename>/etc/hosts</span> of door de DNS diensten, afhankelijk van uw specificaties in het <span class=filename>/etc/nsswitch.conf</span>, het netwerk masker mag een naam zijn dat vertaald kan worden door een zoek opdracht in <span class=filename>/etc/networks</span>. Op een voorbeeld systeem ziet het <span class=filename>/etc/sliphome/slip.hosts</span> bestand er als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# login local-addr      remote-addr     mask            opt1    opt2
#                                               (normal,compress,noicmp)
#
Shelmerg  dc-slip       sl-helmerg      0xfffffc00      autocomp</pre></div></div><div class=paragraph><p>Aan het einde van deze regel staan één of meerdere opties:</p></div><div class=ulist><ul><li><p><code>normal</code> - geen compressie van de header</p></li><li><p><code>compress</code> - comprimeer headers</p></li><li><p><code>autocomp</code> - comprimeer de headers als de remote kant dit accepteert</p></li><li><p><code>noicmp</code> - schakelt ICMP pakketten uit (dus alle "ping" pakketten worden geweigerd in plaats van dat deze bandbreedte verbruiken)</p></li></ul></div><div class=paragraph><p>Uw keuze van een lokaal en remote adres voor uw SLIP verbindingen is afhankelijk van of u een speciaal toegewezen TCP/IP-subnet gebruikt, of dat u gebruik gaat maken van "proxy ARP" op uw SLIP-server (het is geen echte "proxy ARP", maar het is de terminologie welke in deze sectie gebruikt wordt om het te beschrijven). Als u niet zeker bent welke methode u moet kiezen, of hoe u IP-adressen moet toewijzen, raadpleegt u dan de TCP/IP boeken die vermeld worden in de SLIP vereisten (<a href=#slips-prereqs>Eisen vooraf</a>) en/of vraag uw IP-netwerk manager om hulp.</p></div><div class=paragraph><p>Als u gebruik gaat maken van een separaat subnet voor uw SLIP-cliënten, moet u een subnet alloceren uit de voor u toegewezen IP-ruimte, en elke SLIP-cliënt een IP-adres geven uit dat subnet. Daarna moet u waarschijnlijk een statische route configureren voor uw SLIP-subnet via uw SLIP-server naar de dichtsbijzijnde IP-router.</p></div><div class=paragraph><p>In het andere geval moet u gebruik maken van de "proxy ARP" methode, u moet elke SLIP cliënt een IP-adres geven uit het Ethernet-subnet van uw SLIP-server, daarnaast moet u het <span class=filename>/etc/sliphome/slip.login</span> en het <span class=filename>/etc/sliphome/slip.logout</span> script aanpassen om gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=arp&amp;sektion=8&amp;format=html">arp(8)</a> om de "proxy ARP" regels te beheren in de SLIP servers ARP tabel.</p></div></div><div class=sect5><h6 id=_slip_login_configuratie>27.7.2.4.2. <span class=filename>slip.login</span> configuratie<a class=anchor href=#_slip_login_configuratie></a></h6><div class=paragraph><p>Een typisch <span class=filename>/etc/sliphome/slip.login</span> bestand ziet er als volgend uit:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh -
#
#       @(#)slip.login  5.1 (Berkeley) 7/1/90

#
# generiek loginbestand voor een SLIP-lijn.  sliplogin voert deze uit
# met de volgende parameters:
#      1        2         3        4          5         6     7-n
#   slipunit ttyspeed loginname local-addr remote-addr mask opt-args
#
/sbin/ifconfig sl$1 inet $4 $5 netmask $6</pre></div></div><div class=paragraph><p>Dit <span class=filename>slip.login</span> bestand start alleen het <code>ifconfig</code> commando voor de betreffende SLIP-interace met het lokale en remote adres met het netwerkmasker van de SLIP-interface.</p></div><div class=paragraph><p>Als u besloten heeft om gebruik te maken van de "proxy ARP" methode (in plaats van het gebruiken van een apart subnet voor uw SLIP-cliënten) moet u het <span class=filename>/etc/sliphome/slip.login</span> bestand aanpassen zodat deze er ongeveer als volgend uitziet:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh -
#
#       @(#)slip.login  5.1 (Berkeley) 7/1/90

#
# generiek loginbestand voor een SLIP-lijn.  sliplogin voert deze uit
# met de volgende parameters:
#      1        2         3        4          5         6     7-n
#   slipunit ttyspeed loginname local-addr remote-addr mask opt-args
#
/sbin/ifconfig sl$1 inet $4 $5 netmask $6
# Beantwoord ARP Verzoeken voor de SLIP-cliënt met ons Ethernet
# adres
/usr/sbin/arp -s $5 00:11:22:33:44:55 pub</pre></div></div><div class=paragraph><p>De extra regel in het <span class=filename>slip.login</span> bestand, <code>arp -s $5 00:11:22:33:44:55 pub</code>, creeërt een ARP-regel in de ARP-tabel van de SLIP-server. Deze ARP regel zorgt ervoor dat de SLIP-server antwoord geeft met het Ethernet MAC adres van de SLIP-server wanneer een andere IP-node op het Ethernet vraagt om te communiceren met het IP-adres van de SLIP-cliënt.</p></div><div class=paragraph><p>Wanneer u gebruik maakt van het voorbeeld hierboven, wees u er dan zeker van dat u het Ethernet MAC adres (<code>00:11:22:33:44:55</code>) veranderd in het MAC adres van uw systeem’s Ethernet kaart, anders werkt uw "proxy ARP" zeker niet! U kunt het Ethernet MAC adres van uw SLIP-server achterhalen door het bekijken van het resultaat van <code>netstat -i</code>; de tweede regel met resultaten moet er ongeveer als volgend uitzien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ed0   1500  &lt;Link&gt;0.2.c1.28.5f.4a         191923	0   129457     0   116</code></pre></div></div><div class=paragraph><p>Dit geeft aan dat het specifieke Ethernet MAC adres van het systeem is <code>00:02:c1:28:5f:4a</code> - de punten in het Ethernet MAC adres welke gegeven wordt door <code>netstat -i</code> moet worden veranderd in dubbele punten (":") en voorloop nullen moeten worden toegevoegd aan elk enkel hexadecimaal getal om het adres te converteren naar de vorm die <a href="https://man.freebsd.org/cgi/man.cgi?query=arp&amp;sektion=8&amp;format=html">arp(8)</a> wenst; zie de handleiding van <a href="https://man.freebsd.org/cgi/man.cgi?query=arp&amp;sektion=8&amp;format=html">arp(8)</a> voor een compleet overzicht van het gebruik hiervan.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Wanneer u <span class=filename>/etc/sliphome/slip.login</span> en <span class=filename>/etc/sliphome/slip.logout</span>, aanmaakt moet het "uitvoerbare" bitje gezet zijn (bijvoorbeeld <code>chmod 755 /etc/sliphome/slip.login /etc/sliphome/slip.logout</code>) anders is <code>sliplogin</code> niet in staat om deze uit te voeren.</p></div></td></tr></tbody></table></div></div><div class=sect5><h6 id=_slip_logout_configuratie>27.7.2.4.3. <span class=filename>slip.logout</span> configuratie<a class=anchor href=#_slip_logout_configuratie></a></h6><div class=paragraph><p><span class=filename>/etc/sliphome/slip.logout</span> is niet strict noodzakelijk (tenzij u "proxy ARP" implementeert), maar als beslist om deze aan te maken is dit een voorbeeld basis <span class=filename>slip.logout</span> script:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh -
#
#       slip.logout

#
# uitlogbestand voor een SLIP-regel.  sliplogin voert deze uit met de
# parameters:
#      1        2         3        4          5         6     7-n
#   slipunit ttyspeed loginname local-addr remote-addr mask opt-args
#
/sbin/ifconfig sl$1 down</pre></div></div><div class=paragraph><p>Als u gebruik maakt van "proxy ARP" wilt u waarschijnlijk dat het <span class=filename>/etc/sliphome/slip.logout</span> bestand de ARP regel weghaalt voor de SLIP-cliënt:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh -
#
#       @(#)slip.logout

#
# uitlogbestand voor een SLIP-regel.  sliplogin voert deze uit met de
# parameters:
#      1        2         3        4          5         6     7-n
#   slipunit ttyspeed loginname local-addr remote-addr mask opt-args
#
/sbin/ifconfig sl$1 down
# Stop met het beantwoorden van ARP verzoeken voor de SLIP-cliënt
/usr/sbin/arp -d $5</pre></div></div><div class=paragraph><p>Het <code>arp -d $5</code> verwijderd de ARP regel, die "proxy ARP" heeft toegevoegd toen de SLIP-cliënt inlogde.</p></div><div class=paragraph><p>Het is belangrijk om dit te herhalen: zorg ervoor <span class=filename>/etc/sliphome/slip.logout</span> het uitvoerbare bitje heeft gezet nadat deze gecreeërd is (b.v. <code>chmod 755 /etc/sliphome/slip.logout</code>).</p></div></div></div><div class=sect4><h5 id=_routering_overwegingen>27.7.2.5. Routering-overwegingen<a class=anchor href=#_routering_overwegingen></a></h5><div class=paragraph><p>Als u geen gebruik maakt van de "proxy ARP" voor het routeren van pakketten tussen uw SLIP-cliënten en de rest van uw netwerk (en wellicht het internet), moeten er misschien een aantal statische routeringen naar de best bereikbare standaard router ingesteld worden om uw SLIP cliënts te routeren via uw SLIP0server.</p></div><div class=sect5><h6 id=_statische_routeringen>27.7.2.5.1. Statische routeringen<a class=anchor href=#_statische_routeringen></a></h6><div class=paragraph><p>Het toevoegen van statische routeringen naar de dichts bijzijnde router kan problematisch zijn (of zelfs onmogelijk als u niet de bevoegdheden heft om dit te doen). Als u een netwerk heeft met meerdere routers binnen uw organisatie kan het zijn dat sommige routers, zoals die van Cisco en Proteon , niet alleen geconfigureerd moeten worden met de statische route naar het SLIP-subnet, maar deze moeten dan ook geconfigureerd worden over welke statische routes aan andere routers verteld moeten worden. Enige expertise en fine tunen kan nodig zijn om statische routing te laten werken.</p></div></div></div></div></div></div></div><div class=sect1><h2 id=mail>Hoofdstuk 28. Elektronische mail<a class=anchor href=#mail></a></h2><div class=sectionbody><div class=sect2><h3 id=mail-synopsis>28.1. Overzicht<a class=anchor href=#mail-synopsis></a></h3><div class=paragraph><p>"Elektronische Mail", beter bekend als email, is tegenwoordig een van de meest gebruikte vormen van communicatie. Dit hoofdstuk geeft een algemene inleiding in het opzetten van een mailserver op FreeBSD, alsmede een introductie in het verzenden en ontvangen van email op FreeBSD; het is echter geen complete referentie en veel belangrijke overwegingen zullen buiten beschouwing worden gelaten. Voor een completere behandeling wordt de lezer gewezen op de vele uitstekende boeken welke worden vermeld in <a href=./#bibliography>Bibliografie</a>.</p></div><div class=paragraph><p>In dit hoofdstuk wordt behandeld:</p></div><div class=ulist><ul><li><p>Welke software (componenten) gebruikt wordt(en) bij het verzenden en ontvangen van email.</p></li><li><p>Waar algemene sendmail instellingsbestanden worden opgeslagen in FreeBSD.</p></li><li><p>Het verschil tussen lokale en postbussen op-afstand.</p></li><li><p>Hoe spammers te verhinderen dat ze de mailserver illegaal gebruiken als "relay".</p></li><li><p>Hoe een andere MTA (Mail Transfer Agent) te installeren en configureren op het systeem, ter vervanging van sendmail.</p></li><li><p>Hoe veel voorkomende problemen met mail servers worden opgelost.</p></li><li><p>Hoe SMTP met UUCP te gebruiken.</p></li><li><p>Hoe een systeem in te stellen om alleen mail te verzenden.</p></li><li><p>Hoe email te gebruiken met een inbelverbinding.</p></li><li><p>Hoe SMTP Authenticatie in te stellen voor verhoogde beveiliging.</p></li><li><p>Hoe een Mail User Agent zoals mutt te installeren om email te verzenden en te ontvangen.</p></li><li><p>Hoe mail te downloaden van een POP of IMAP server op afstand.</p></li><li><p>Hoe automatisch filters en sorteerregels op inkomende email toe te passen.</p></li></ul></div><div class=paragraph><p>Voordat dit hoofdstuk gelezen wordt, dienen:</p></div><div class=ulist><ul><li><p>De netwerkverbindingen correct ingesteld te zijn (<a href=./#advanced-networking>Geavanceerd netwerken</a>).</p></li><li><p>De juiste DNS-informatie ingesteld te zijn voor de mailserver (<a href=./#network-servers>Netwerkdiensten</a>).</p></li><li><p>Bekend te zijn hoe software van derde partijen te installeren (<a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></li></ul></div></div><div class=sect2><h3 id=mail-using>28.2. Gebruik maken van elektronische mail<a class=anchor href=#mail-using></a></h3><div class=paragraph><p>Er zijn vijf belangrijke componenten betrokken bij het uitwisselen van email. Dit zijn: <a href=#mail-mua>het gebruikersprogramma</a>, <a href=#mail-mta>de serverdaemon</a>, <a href=#mail-dns>DNS</a>, <a href=#mail-receive>"een postbus, lokaal of op afstand "</a>, en natuurlijk <a href=#mail-host>de mailhost zelf</a>.</p></div><div class=sect3><h4 id=mail-mua>28.2.1. Het gebruikersprogramma<a class=anchor href=#mail-mua></a></h4><div class=paragraph><p>Dit omvat opdrachtregelprogramma’s zoals mutt, alpine, elm, en <code>mail</code>, en GUI programma’s zoals balsa, xfmail, en iets "geavanceerders" zoals een webbrowser. Deze programma’s doen niets anders dan de mail bezorgen bij de lokale <a href=#mail-host>"mailhost"</a>, door deze af te leveren of bij een van de beschikbare <a href=#mail-mta>serverdiensten</a>, of via TCP.</p></div></div><div class=sect3><h4 id=mail-mta>28.2.2. Mailhost Server Daemon<a class=anchor href=#mail-mta></a></h4><div class=paragraph><p>FreeBSD wordt standaard geleverd met de sendmail, maar ondersteunt meerdere andere mailserver daemons, zoals:</p></div><div class=ulist><ul><li><p>exim;</p></li><li><p>postfix;</p></li><li><p>qmail.</p></li></ul></div><div class=paragraph><p>De server daemon heeft meestal twee functies-het is verantwoordelijk voor het ontvangen van inkomende mail en het bezorgen van uitgaande mail. Het is <em>niet</em> verantwoordelijk voor het verzamelen van mail door gebruik te maken van protocollen zoals POP of IMAP om mail te lezen, noch staat het toe om een verbinding te maken met een lokale <span class=filename>mbox</span> of Maildir postbus. Het is mogelijk dat daarvoor een extra <a href=#mail-receive>daemon</a> voor nodig is.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Oudere versies van sendmail hebben serieuze beveiligingslekken welke kunnen leiden tot een situatie waarbij een aanvaller lokale of toegang van afstand tot de machine kan verkrijgen. Draai een actuele versie om deze problemen te voorkomen. Optioneel kan een alternatieve MTA van de <a href=./#ports>FreeBSD Portscollectie</a> geïnstalleerd worden.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=mail-dns>28.2.3. Email en DNS<a class=anchor href=#mail-dns></a></h4><div class=paragraph><p>Het Domein Naam Systeem (DNS) en de daemon <code>named</code> spelen een grote rol in het bezorgen van email. Om het mogelijk te maken email van de deze lokatie naar een andere lokatie te bezorgen, zal de serverdaemon de andere lokatie opzoeken in het DNS om zo de host te bepalen die de email voor de bestemming in ontvangst zal nemen. Dit gebeurt ook als email verzonden wordt vanaf een andere host naar de lokale mailserver.</p></div><div class=paragraph><p>DNS is verantwoordelijk voor het koppelen van hostnamen aan IP-adressen, en voor het opslaan van specifieke informatie voor het bezorgen van mail, bekend als MX-regels. De MX-regel (Mail eXchanger) specificeert welke host(s) mail zullen ontvangen voor een specifiek domein. Als er geen MX-regel is voor deze hostnaam of dit domein, dan zal de mail direct bij de host worden afgeleverd, mits er een A-regel is die deze hostnaam aan dit IP-adres koppelt.</p></div><div class=paragraph><p>De MX-regels van een willekeurig domein kunnen worden bekeken door gebruik te maken van het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=host&amp;sektion=1&amp;format=html">host(1)</a>, zoals te zien is in het onderstaande voorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% host <span class=nt>-t</span> mx FreeBSD.org
FreeBSD.org mail is handled <span class=o>(</span><span class=nv>pri</span><span class=o>=</span>10<span class=o>)</span> by mx1.FreeBSD.org</code></pre></div></div></div><div class=sect3><h4 id=mail-receive>28.2.4. Mail ontvangen<a class=anchor href=#mail-receive></a></h4><div class=paragraph><p>De mailhost verzorgt het ontvangen van mail voor het domein. Deze zal alle mail verzonden aan het domein verzamelen en deze afhankelijk van de configuratie opslaan in òf <span class=filename>mbox</span> (de standaardmanier om mail op te slaan) òf in Maildir-formaat. Wanneer de mail eenmaal is opgeslagen, kan het òf lokaal gelezen worden door toepassingen als <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> of mutt , of op afstand bekeken en verzameld worden middels protocollen als POP of IMAP. Dit betekent, dat als mail alleen lokaal wordt gelezen, er geen POP- of IMAP-server geïnstalleerd hoeft te worden.</p></div><div class=sect4><h5 id=pop-and-imap>28.2.4.1. Op afstand toegang tot de postbus krijgen door gebruik te maken van POP en IMAP<a class=anchor href=#pop-and-imap></a></h5><div class=paragraph><p>Om op afstand toegang te krijgen tot postbussen is het nodig toegang te hebben tot een POP- of IMAP -server. Deze protocollen stellen gebruikers in staat hun postbus gemakkelijk op afstand te benaderen. Hoewel zowel POP als IMAP gebruikers in staat stellen op afstand een postbus te bereiken, biedt IMAP veel voordelen, waaronder:</p></div><div class=ulist><ul><li><p>IMAP kan berichten zowel op de server op afstand opslaan als ze ophalen.</p></li><li><p>IMAP ondersteunt gelijktijdig actualiseren.</p></li><li><p>IMAP kan uitstekend worden gebruikt over langzame verbindingen omdat het gebruikers in staat stelt de structuur van berichten te bekijken zonder deze binnen te halen; het kan ook worden gebruikt om te zoeken op de server om zo de gegevensoverdracht tussen client en server te minimaliseren.</p></li></ul></div><div class=paragraph><p>Om een POP- of IMAP- server te installeren, zijn de volgende stappen nodig:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Kies een IMAP- of POP -server die het beste aan de eisen voldoet. De volgende POP- en IMAP -servers zijn zeer bekend en zijn goede voorbeelden:</p><div class=ulist><ul><li><p>qpopper;</p></li><li><p>teapop;</p></li><li><p>imap-uw;</p></li><li><p>courier-imap;</p></li><li><p>dovecot;</p></li></ul></div></li><li><p>Installeer de gewenste POP- of IMAP-daemon vanuit de Portscollectie.</p></li><li><p>Wijzig indien nodig <span class=filename>/etc/inetd.conf</span> om de POP- of IMAP - server te laden.</p></li></ol></div></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Let er wel op dat zowel POP en IMAP informatie, waaronder gegevens over gebruikersnaam en wachtwoord, onversleuteld versturen. Dit betekent, dat wanneer het gewenst is dat de uitwisseling van gegevens over deze protocollen versleuteld is, het verstandig is om te overwegen de sessies over <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> te tunnelen of SSL te gebruiken. Het tunnelen van sessies wordt beschreven in <a href=./#security-ssh-tunneling>SSH tunnels</a> en SSL in <a href=./#openssl>OpenSSL</a>.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=local>28.2.4.2. Toegang tot lokale postbussen<a class=anchor href=#local></a></h5><div class=paragraph><p>Postbussen kunnen lokaal benaderd worden door direct op de server waarop de postbus wordt bewaard MUAs te gebruiken. Dit kan gedaan worden door programma’s zoals mutt of <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> te gebruiken.</p></div></div></div><div class=sect3><h4 id=mail-host>28.2.5. De mailhost<a class=anchor href=#mail-host></a></h4><div class=paragraph><p>De mailhost is de naam van de server welke verantwoordelijk is voor het afleveren en ontvangen van mail voor de server en mogelijk voor het netwerk.</p></div></div></div><div class=sect2><h3 id=sendmail>28.3. sendmail instellen<a class=anchor href=#sendmail></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> is de standaard Mail Transfer Agent (MTA) in FreeBSD. sendmail’s taak is het accepteren van mail van gebruikersprogramma’s (MUA ) en deze te bezorgen bij de juiste mailer zoals gedefinieerd in het betreffende configuratiebestand. sendmail kan ook netwerkverbindingen accepteren en mail in lokale postbussen afleveren of bezorgen bij een ander programma.</p></div><div class=paragraph><p>sendmail gebruikt de volgende configuratiebestanden:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Bestandsnaam</th><th class="tableblock halign-left valign-top">Functie</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/access</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>bestand met de toegangsdatabase van sendmail</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/aliases</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Aliases voor postbussen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/local-host-names</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lijst van servers waarvoor sendmail mail accepteert</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/mailer.conf</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Configuratie voor het mailerprogramma</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/mailertable</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Aflevertabel voor de mailer</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/sendmail.cf</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Hoofdconfiguratiebestand van sendmail</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/virtusertable</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Tabellen voor virtuele gebruikers en domeinen</p></td></tr></tbody></table><div class=sect3><h4 id=_etcmailaccess>28.3.1. <span class=filename>/etc/mail/access</span><a class=anchor href=#_etcmailaccess></a></h4><div class=paragraph><p>De toegangsdatabase definieert welke host(s) of IP-adressen toegang hebben tot de lokale mailserver en wat voor soort toegang ze hebben. Hosts kunnen in de lijst als <code>OK</code>, <code>REJECT</code>, of <code>RELAY</code> staan, of worden doorgevoerd naar de foutafhandelingsprocedure van sendmail met een bepaalde mailerfout. Hosts welke vermeld staan als <code>OK</code>, wat de standaard is, kunnen mail versturen naar deze host zolang de eindbestemming van de mail de lokale machine is. Hosts welke vermeld staan als <code>REJECT</code> worden voor alle verbindingen geweigerd. Hosts met een <code>RELAY</code> vermelding wordt toegestaan om via deze server mail naar elke bestemming te sturen.</p></div><div class=exampleblock><div class=title>Voorbeeld 30. Configureren van de sendmail toegangsdatabase</div><div class=content><div class="literalblock programlisting"><div class=content><pre>cyberspammer.com	550 We accepteren geen mail van spammers
FREE.STEALTH.MAILER@	550 We accepteren geen mail van spammers
another.source.of.spam	REJECT
okay.cyberspammer.com	OK
128.32	RELAY</pre></div></div></div></div><div class=paragraph><p>In dit voorbeeld staan vijf vermeldingen. Mailafzenders die overeenkomen met de linkerzijde van de tabel worden beïnvloed door de actie die vermeld staan aan de rechterzijde van de tabel. De eerste twee voorbeelden geven een foutcode af aan de foutafhandelingsroutine van sendmail. Het bericht wordt bij de externe host bekend gemaakt wanneer een mail voldoet aan de linkerzijde van de tabel. De volgende regel weigert mail van een specifieke host op het Internet, <code>another.source.of.spam</code>. De volgende regel accepteert mailverbindingen van een host <code>okay.cyberspammer.com</code>, welke nauwkeuriger is dan de regel met <code>cyberspammer.com</code> erboven. Specifiekere regels vervangen minder specifieke. De laatste regel staat het doorsturen van elektronische mail toe vanaf hosts waarvan de IP-adressen beginnen met <code>128.32</code>. Deze hosts zijn dan in staat om via deze mailserver naar een andere bestemming mail te versturen.</p></div><div class=paragraph><p>Wanneer dit bestand is bijgewerkt, dient <code>make</code> in <span class=filename>/etc/mail/</span> te gedraaid te worden om de database bij te werken.</p></div></div><div class=sect3><h4 id=_etcmailaliases>28.3.2. <span class=filename>/etc/mail/aliases</span><a class=anchor href=#_etcmailaliases></a></h4><div class=paragraph><p>De aliasdatabase bevat een lijst met virtuele postbussen die verwijzen naar andere gebruiker(s), bestand(en), programma('s) of andere aliassen. Hier zijn een paar voorbeelden die gebruikt kunnen worden in <span class=filename>/etc/mail/aliases</span>:</p></div><div class=exampleblock><div class=title>Voorbeeld 31. Mailaliassen</div><div class=content><div class="literalblock programlisting"><div class=content><pre>root: localuser
ftp-bugs: joe,eric,paul
bit.bucket:  /dev/null
procmail: &#34;|/usr/local/bin/procmail&#34;</pre></div></div></div></div><div class=paragraph><p>Het bestandsformaat is simpel; de postbusnaam aan de linkerzijde van de dubbele punt wordt verder uitgewerkt naar de doel(en) aan de rechterzijde. Het eerste voorbeeld breidt de postbus van <code>root</code> uit naar de postbus <code>localuser</code>, welke dan vervolgens weer wordt opgezocht in de aliasdatabase. Als er geen verdere overeenkomst wordt gevonden, dan wordt het bericht afgeleverd bij de lokale gebruiker <code>localuser</code>. Het volgende voorbeeld toont een mailinglijst. Mail voor de postbus <code>ftp-bugs</code> wordt doorverwezen naar de drie lokale postbussen <code>joe</code>, <code>eric</code> en <code>paul</code>. Merk op dat een externe postbus gespecificeerd kan worden als <a href=mailto:user@example.com>user@example.com</a>. Het volgende voorbeeld toont het schrijven van mail naar een bestand, in dit geval <span class=filename>/dev/null</span>. Het laatste voorbeeld toont het sturen van mail naar een programma, in dit geval wordt het mailbericht doorgestuurd naar de standaard invoer van <span class=filename>/usr/local/bin/procmail</span> via een UNIX® pijp.</p></div><div class=paragraph><p>Wanneer dit bestand is bijgewerkt, dient <code>make</code> in <span class=filename>/etc/mail/</span> gedraaid te worden om de database bij te werken.</p></div></div><div class=sect3><h4 id=_etcmaillocal_host_names>28.3.3. <span class=filename>/etc/mail/local-host-names</span><a class=anchor href=#_etcmaillocal_host_names></a></h4><div class=paragraph><p>Dit is een lijst van hostnamen die <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> moet accepteren als de lokale hostnaam. Hierin dienen alle hostnamen geplaatst te worden waarvoor sendmail mail moet ontvangen. Als deze mailserver mail moet ontvangen voor het domein <code>example.com</code> en de hostnaam is <code>mail.example.com</code>, dan ziet <span class=filename>local-host-names</span> er ongeveer zo uit:</p></div><div class="literalblock programlisting"><div class=content><pre>example.com
mail.example.com</pre></div></div><div class=paragraph><p>Wanneer dit bestand is bijgewerkt, dient <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> opnieuw gestart te worden zodat het de veranderingen kan lezen.</p></div></div><div class=sect3><h4 id=_etcmailsendmail_cf>28.3.4. <span class=filename>/etc/mail/sendmail.cf</span><a class=anchor href=#_etcmailsendmail_cf></a></h4><div class=paragraph><p>Het hoofdinstellingenbestand van sendmail , <span class=filename>sendmail.cf</span> controleert het algemene gedrag van sendmail, inclusief alles van het herschrijven van emailadressen tot het sturen van weigeringsberichten naar externe mailservers. Met zo’n diverse rol is dit instellingenbestand redelijk complex en vallen de details buiten het bereik van dit hoofdstuk. Gelukkig hoeft dit bestand maar zelden aangepast te worden voor standaard mailservers.</p></div><div class=paragraph><p>Het hoofdinstellingenbestand van sendmail kan gebouwd worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=m4&amp;sektion=1&amp;format=html">m4(1)</a> macro’s die het gedrag en de mogelijkheden van sendmail specificeren. Lees <span class=filename>/usr/src/contrib/sendmail/cf/README</span> voor meer details.</p></div><div class=paragraph><p>Wanneer dit bestand is bijgewerkt, dient <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> opnieuw gestart te worden om de wijzigingen door te voeren.</p></div></div><div class=sect3><h4 id=_etcmailvirtusertable>28.3.5. <span class=filename>/etc/mail/virtusertable</span><a class=anchor href=#_etcmailvirtusertable></a></h4><div class=paragraph><p>De <span class=filename>virtusertable</span> verbindt mailadressen voor virtuele domeinen en postbussen met echte postbussen. Deze postbussen kunnen lokaal, op afstand, aliassen gedefinieerd in <span class=filename>/etc/mail/aliases</span>, of bestanden zijn.</p></div><div class=exampleblock><div class=title>Voorbeeld 32. Voorbeeld van een mailtabel voor een virtueel domein</div><div class=content><div class="literalblock programlisting"><div class=content><pre>root@example.com	root
postmaster@example.com	postmaster@noc.example.net
@example.com	joe</pre></div></div></div></div><div class=paragraph><p>In het voorbeeld hierboven staat een tabel voor een domein <code>example.com</code>. Dit bestand wordt van boven naar beneden verwerkt, en de eerste overeenkomende regel wordt gebruikt. De eerste regel verbindt <a href=mailto:root@example.com>root@example.com</a> met de lokale postbus <code>root</code>. De volgende regel verbindt <a href=mailto:postmaster@example.com>postmaster@example.com</a> met de postbus <code>postmaster</code> op de host <code>noc.example.net</code>. Als geen van de vorige regels van <code>example.com</code> overeenkomen, zal de laatste regel gebruikt worden, die alle andere post geadresseerd aan iemand bij <code>example.com</code> opvangt en naar de lokale postbus <code>joe</code> stuurt.</p></div></div></div><div class=sect2><h3 id=mail-changingmta>28.4. De Mail Transfer Agent vervangen<a class=anchor href=#mail-changingmta></a></h3><div class=paragraph><p>Zoals eerder vermeld wordt FreeBSD geleverd met sendmail voorgeïnstalleerd als MTA (Mail Transfer Agent). Daarom regelt het standaard uitgaande en binnenkomende mail.</p></div><div class=paragraph><p>In sommige gevallen willen systeembeheerders wegens uiteenlopende redenen hun MTA vervangen. Deze redenen variëren van het uitproberen van een andere MTA tot het installeren van een bepaalde functionaliteit of pakket dat afhankelijk is van een andere MTA.</p></div><div class=sect3><h4 id=_een_nieuwe_mta_installeren>28.4.1. Een nieuwe MTA installeren<a class=anchor href=#_een_nieuwe_mta_installeren></a></h4><div class=paragraph><p>Er is een waaier van MTA’s beschikbaar. Een goed startpunt is de <a href=./#ports>FreeBSD Ports Collectie</a> waar er veel gevonden kunnen worden. Het is natuurlijk mogelijk iedere MTA te gebruiken vanaf iedere locatie, zolang het draait op FreeBSD.</p></div><div class=paragraph><p>Begin met het installeren van de nieuwe MTA. Als de MTA eenmaal geïnstalleerd is wordt er de kans gegeven te beslissen of de nieuwe MTA echt voldoet aan de eisen, en is het mogelijk de nieuwe software te configureren voordat deze het werk van sendmail overneemt. Bevestig voordat de MTA geïnstalleerd wordt dat de nieuwe software geen poging onderneemt systeemtoepassingen zoals <span class=filename>/usr/bin/sendmail</span> te overschrijven, anders wordt de nieuwe software onmiddellijk in gebruik genomen voordat het is geconfigureerd.</p></div><div class=paragraph><p>Neem de documentatie van de gekozen MTA door voor meer informatie over het configureren van de software.</p></div></div><div class=sect3><h4 id=mail-disable-sendmail>28.4.2. sendmail uitschakelen<a class=anchor href=#mail-disable-sendmail></a></h4><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Als sendmail’s uitgaande emaildienst uitgeschakeld wordt, is het belangrijk dat het vervangen wordt door een alternatief systeem. Als ervoor gekozen wordt dit niet te doen, zullen systeemfunctionaliteiten zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a> niet in staat zijn hun resultaten te bezorgen per email, zoals ze normaliter verwachten te kunnen doen. Vele delen van het systeem zullen verwachten een werkend systeem aan te treffen dat compatibel is met sendmail. Als toepassingen binaries van sendmail blijven gebruiken om mail te versturen nadat deze uitgeschakeld werden, kan de mail in een inactieve sendmail wachtrij geplaatst worden, en nooit bezorgd worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om sendmail volledig uit te schakelen, inclusief de uitgaande emaildienst, dient</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail_enable=&#34;NO&#34;
sendmail_submit_enable=&#34;NO&#34;
sendmail_outbound_enable=&#34;NO&#34;
sendmail_msp_queue_enable=&#34;NO&#34;</pre></div></div><div class=paragraph><p>toegevoegd te worden aan <span class=filename>/etc/rc.conf</span>.</p></div><div class=paragraph><p>Als enkel sendmail’s ingaande emaildienst uitgeschakeld dient te worden, dient</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail_enable=&#34;NO&#34;</pre></div></div><div class=paragraph><p>toegevoegd te worden aan <span class=filename>/etc/rc.conf</span>. Meer informatie over de opstartopties van sendmail is beschikbaar in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.sendmail&amp;sektion=8&amp;format=html">rc.sendmail(8)</a>.</p></div></div><div class=sect3><h4 id=_de_nieuwe_mta_starten_tijdens_het_opstarten>28.4.3. De nieuwe MTA starten tijdens het opstarten<a class=anchor href=#_de_nieuwe_mta_starten_tijdens_het_opstarten></a></h4><div class=paragraph><p>De nieuwe MTA kan gestart worden door deze instellingsregel toe te voegen aan <span class=filename>/etc/rc.conf</span>, zoals het volgende voorbeeld voor postfix:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;postfix_enable=“YES”&#39; &gt;&gt; /etc/rc.conf</span></code></pre></div></div><div class=paragraph><p>De MTA zal nu automatisch tijdens het opstarten worden gestart.</p></div></div><div class=sect3><h4 id=_sendmail_vervangen_als_de_standaard_systeemmailer>28.4.4. sendmail vervangen als de standaard systeemmailer<a class=anchor href=#_sendmail_vervangen_als_de_standaard_systeemmailer></a></h4><div class=paragraph><p>Het programma sendmail is zo vanzelfsprekend als standaard software op UNIX® systemen dat sommige softwarepakketten ervan uitgaan dat sendmail reeds geïnstalleerd en geconfigureerd is. Daarom voorzien vele alternatieve MTA’s in compatibele implementaties van de opdrachtregelinterface van sendmail; dit vergemakkelijkt het gebruik van alternatieve MTA’s als vervanging voor sendmail.</p></div><div class=paragraph><p>Bij het gebruiken van een alternatieve MTA moet men er zeker van zijn dat software die probeert de standaardtoepassingen van sendmail zoals <span class=filename>/usr/bin/sendmail</span> te gebruiken, ook daadwerkelijk de gekozen alternatieve mailer gebruikt. Gelukkig heeft FreeBSD hiervoor een systeem, <a href="https://man.freebsd.org/cgi/man.cgi?query=mailwrapper&amp;sektion=8&amp;format=html">mailwrapper(8)</a>, dat deze taak van de systeembeheerder overneemt.</p></div><div class=paragraph><p>Als sendmail werkt zoals origineel geïnstalleerd, bevat <span class=filename>/etc/mail/mailer.conf</span> bij benadering het volgende:</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail	/usr/libexec/sendmail/sendmail
send-mail	/usr/libexec/sendmail/sendmail
mailq		/usr/libexec/sendmail/sendmail
newaliases	/usr/libexec/sendmail/sendmail
hoststat	/usr/libexec/sendmail/sendmail
purgestat	/usr/libexec/sendmail/sendmail</pre></div></div><div class=paragraph><p>Dit wil zeggen dat wanneer een van deze algemene opdrachten (zoals <span class=filename>sendmail</span> zelf) uitgevoerd wordt, het systeem in werkelijkheid een kopie van de mailwrapper genaamd <span class=filename>sendmail</span> uitvoert, dat <span class=filename>mailer.conf</span> controleert en <span class=filename>/usr/libexec/sendmail/sendmail</span> uitvoert. Dit systeem maakt het eenvoudiger te specificeren welke toepassingen daadwerkelijk uitgevoerd worden wanneer deze standaard <span class=filename>sendmail</span> functies aangeroepen worden.</p></div><div class=paragraph><p>Als men bijvoorbeeld wil dat <span class=filename>/usr/local/supermailer/bin/sendmail-compat</span> uitgevoerd wordt in plaats van sendmail, kan men <span class=filename>/etc/mail/mailer.conf</span> als volgt aanpassen:</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail	/usr/local/supermailer/bin/sendmail-compat
send-mail	/usr/local/supermailer/bin/sendmail-compat
mailq		/usr/local/supermailer/bin/mailq-compat
newaliases	/usr/local/supermailer/bin/newaliases-compat
hoststat	/usr/local/supermailer/bin/hoststat-compat
purgestat	/usr/local/supermailer/bin/purgestat-compat</pre></div></div></div><div class=sect3><h4 id=_afwerking>28.4.5. Afwerking<a class=anchor href=#_afwerking></a></h4><div class=paragraph><p>Wanneer alles correct geconfigureerd is, dienen ofwel alle ongebruikte sendmail processen gestopt te worden en de processen behorend aan de nieuwe software gestart te worden, ofwel dient het systeem opnieuw gestart te worden. Herstarten geeft ook de mogelijkheid te controleren of de nieuwe MTA correct geconfigureerd is om tijdens het opstartproces gestart te worden.</p></div></div></div><div class=sect2><h3 id=mail-trouble>28.5. Problemen oplossen<a class=anchor href=#mail-trouble></a></h3><div class=sect3><h4 id=_waarom_is_het_nodig_om_de_fqdn_te_gebruiken_voor_hosts_op_de_site>28.5.1. Waarom is het nodig om de FQDN te gebruiken voor hosts op de site?<a class=anchor href=#_waarom_is_het_nodig_om_de_fqdn_te_gebruiken_voor_hosts_op_de_site></a></h4><div class=paragraph><p>Het is waarschijnlijk dat de host zich in een ander domein bevindt; bijvoorbeeld als het gewenst is om host <code>mompel</code> in het domein <code>bar.edu</code> vanuit domein <code>foo.bar.edu</code> te bereiken, is het nodig om er met de volledig gekwalificeerde domeinnaam naar te verwijzen, <code>mompel.bar.edu</code>, in plaats van slechts <code>mompel</code>.</p></div><div class=paragraph><p>Traditioneel werd dit door BSD BIND resolvers toegestaan. De huidige versie van BIND die met FreeBSD wordt geleverd levert niet langer standaard afkortingen voor onvolledig gekwalificeerde domeinnamen anders dan het huidige domein. Dus moet een ongekwalificeerde host <code>mompel</code> òf als <code>mompel.foo.bar.edu</code> gevonden worden, òf wordt er naar gezocht in het root-domein.</p></div><div class=paragraph><p>Dit verschilt van het vorige gedrag, waar de zoektocht doorging over <code>mompel.bar.edu</code>, en <code>bar.edu</code>. Zie RFC 1535 voor de redenen waarom dit als een slechte gewoonte en zelfs als beveiligingslek werd beschouwd.</p></div><div class=paragraph><p>Als een goede tussenoplossing kan deze regel:</p></div><div class="literalblock programlisting"><div class=content><pre>search foo.bar.edu bar.edu</pre></div></div><div class=paragraph><p>in plaats van het voorgaande:</p></div><div class="literalblock programlisting"><div class=content><pre>domain foo.bar.edu</pre></div></div><div class=paragraph><p>in <span class=filename>/etc/resolv.conf</span> geplaatst worden. Ben er echter zeker van dat de zoekvolgorde niet verder gaat dan de "grens tussen lokale en publieke regelgeving", zoals RFC 1535 het noemt.</p></div></div><div class=sect3><h4 id=_sendmail_zegt_mail_loops_back_to_myself>28.5.2. sendmail zegt mail loops back to myself<a class=anchor href=#_sendmail_zegt_mail_loops_back_to_myself></a></h4><div class=paragraph><p>Dit wordt in de FAQ van sendmail als volgt beantwoord:</p></div><div class="literalblock programlisting"><div class=content><pre>Deze foutmeldingen verschijnen:

553 MX list for domain.net points back to relay.domain.net
554 &lt;user@domain.net&gt;... Local configuration error

Hoe kan dit probleem worden opgelost?

Er is gevraagd om mail van het domein (bijvoorbeeld domain.net) naar een
specifieke host door te sturen (in dit geval relay.domain.net) door
gebruik te maken van een MX-regel, maar de machine die het door moet
sturen herkent zichzelf niet als domain.net.  Voeg domain.net toe aan
/etc/mail/local-host-names [bekend als /etc/sendmail.cw voor versies
eerder dan 8.10] (als FEATURE(use_cw_file) gebruikt wordt) of voeg
Cw domain.net toe aan /etc/mail/sendmail.cf.</pre></div></div><div class=paragraph><p>De FAQ van sendmail is te vinden op <a href=http://www.sendmail.org/faq/>http://www.sendmail.org/faq/</a> en wordt aangeraden om te lezen indien enig "tweaken " van de mailinstallatie gewenst is.</p></div></div><div class=sect3><h4 id=_hoe_kan_een_mailserver_op_een_inbel_ppp_host_gedraaid_worden>28.5.3. Hoe kan een mailserver op een inbel-PPP-host gedraaid worden?<a class=anchor href=#_hoe_kan_een_mailserver_op_een_inbel_ppp_host_gedraaid_worden></a></h4><div class=paragraph><p>Het is gewenst om een FreeBSD-computer in een LAN met het Internet te verbinden. De FreeBSD-computer zal en mail-gateway voor het LAN zijn. De PPP-verbinding is niet toegewijd.</p></div><div class=paragraph><p>Er zijn minstens twee manieren om dit te doen. Eén manier is om UUCP te gebruiken.</p></div><div class=paragraph><p>Een andere manier is ervoor te zorgen dat een server die altijd met het Internet verbonden is secundaire MX-diensten voor het domein biedt. Als het domein bijvoorbeeld <code>example.com</code> is en de internetprovider <code>example.net</code> heeft ingesteld om secundaire MX-diensten voor het domein te bieden:</p></div><div class="literalblock programlisting"><div class=content><pre>example.com.		MX	10	example.com.
			MX	20	example.net.</pre></div></div><div class=paragraph><p>Er dient slechts één host als de uiteindelijke ontvanger gespecificeerd te worden (voeg <code>CW example.com</code> toe aan <span class=filename>/etc/mail/sendmail.cf</span> op <code>example.com></code>).</p></div><div class=paragraph><p>Wanneer de verzendende <code>sendmail</code> probeert om mail af te leveren zal het proberen met <code>example.com</code> te verbinden via de modemverbinding. Waarschijnlijk zal dit een time-out geven omdat de computer niet online is. Het programma sendmail zal het automatisch aan de secundaire MX-site, de internetprovider (<code>example.net</code>) afleveren. De secundaire MX zal dan periodiek proberen om een verbinding te maken met de computer en de mail aan de primaire MX-host leveren (<code>example.com</code>).</p></div><div class=paragraph><p>Het kan wenselijk zijn om iets als het onderstaande als inlogscript te gebruiken:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
# Zet mij in /usr/local/bin/pppmyisp
( sleep 60 ; /usr/sbin/sendmail -q ) &amp;
/usr/sbin/ppp -direct pppmyisp</pre></div></div><div class=paragraph><p>Indien er een apart inlogscript voor een gebruiker wordt aangemaakt, kan <code>sendmail -qRexample.com</code> gebruikt worden in plaats van het bovenstaande script. Dit zorgt ervoor dat alle mail in de mailrij voor <code>example.com</code> onmiddellijk verwerkt wordt.</p></div><div class=paragraph><p>Een verdere verfijning van de situatie is deze:</p></div><div class=paragraph><p>Bericht gestolen van de <a href=https://lists.FreeBSD.org/subscription/freebsd-isp>FreeBSD Internet service provider mailinglijst</a>.</p></div><div class="literalblock programlisting"><div class=content><pre>&gt; we bieden de secundaire MX voor een klant.
&gt; De klant maakt automatisch verschillende keren per dag een verbinding
&gt; met onze diensten om de mailberichten naar zijn primaire MX te
&gt; sturen (we bellen zijn site niet indien er een mail voor zijn
&gt; domein arriveert).  Onze sendmail verstuurt de mailrij om de 30
&gt; minuten.  Op het moment moet de klant 30 minuten online blijven om
&gt; er zeker van te zijn dat alle mail naar de primaire MX is gegaan.
&gt;
&gt; Is er een commando dat sendmail er toe aanzet om alle mailberichten
&gt; nu te versturen?  De gebruiker heeft uiteraard geen root-rechten op
&gt; onze machine.

In de sectie privacy flags van sendmail.cf staat een
definitie Opgoaway,restrictqrun

Verwijder restrictqrun om niet-root-gebruikers toe te staan te beginnen
de rij te verwerken.  Het kan ook wenselijk zijn om de MXs opnieuw te
rangschikken.  Wij zijn zo de eerste MX voor onze klanten, en we hebben
dit gedefinieerd:

# Als we de beste MX voor een host zijn, probeer direct in plaats van
# een lokale configuratiefout te genereren.
OwTrue

Op deze manier zal een site op afstand rechtstreeks hier afleveren,
zonder de verbinding van de klant te proberen.  Vervolgens wordt er naar
de klant verstuurd.  Dit werkt alleen voor hosts, dus
dient de klant hun mailcomputer customer.com te noemen en
hostname.customer.com in de DNS de plaatsen.  Plaats een
A-regel in de DNS voor customer.com.</pre></div></div></div><div class=sect3><h4 id=_waarom_blijven_er_fouten_als_relaying_denied_verchijnen_wanneer_er_mail_van_andere_hosts_wordt_verstuurd>28.5.4. Waarom blijven er fouten als Relaying Denied verchijnen wanneer er mail van andere hosts wordt verstuurd?<a class=anchor href=#_waarom_blijven_er_fouten_als_relaying_denied_verchijnen_wanneer_er_mail_van_andere_hosts_wordt_verstuurd></a></h4><div class=paragraph><p>In standaard FreeBSD-installaties is sendmail geconfigureerd om alleen mail te versturen van de host waarop het draait. Als bijvoorbeeld een POP-server beschikbaar is, kunnen gebruikers mail controleren vanuit school, werk, of andere lokaties op afstand, maar zullen ze nog steeds niet in staat zijn om uitgaande emails van lokaties van buitenaf te versturen. Gewoonlijk zal er na enkele ogenblikken na de poging een email van MAILER-DAEMON worden verzonden met een foutbericht <code>5.7 Relaying Denied</code>.</p></div><div class=paragraph><p>Er zijn verschillende manieren om dit te omzeilen. De oplossing die het meest voor de hand ligt, is om het adres van de internetprovider in een bestand relay-domains op <span class=filename>/etc/mail/relay-domains</span> te zetten. Een snelle manier om dit te doen is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#34;your.isp.example.com&#34; &gt; /etc/mail/relay-domains</span></code></pre></div></div><div class=paragraph><p>Nadat dit bestand is aangemaakt of bewerkt dient sendmail opnieuw gestart te worden. Dit werkt prima indien u een serverbeheerder bent en het niet wenselijk is om mail lokaal te verzenden, of indien het gewenst is om een point-en-click client/systeem op een andere machine of zelfs bij een andere internetprovider te gebruiken. Het is ook erg bruikbaar indien er slechts enkele email-accounts zijn aangemaakt. Als er een groot aantal adressen dient te worden toegevoegd, kan dit bestand in een tekstverwerker worden geopend en de domeinen worden toegevoegd, één per regel:</p></div><div class="literalblock programlisting"><div class=content><pre>your.isp.example.com
other.isp.example.net
users-isp.example.org
www.example.org</pre></div></div><div class=paragraph><p>Nu zal het verzenden van elke mail door dit systeem, verstuurd door elke host in deze lijst, lukken (aangenomen dat de gebruiker een account op het systeem heeft). Dit is een aardige manier om gebruikers toe te staan op afstand mail vanaf het systeem te verzenden zonder dat mensen wordt toegestaan om spam vanaf het systeem te verzenden.</p></div></div></div><div class=sect2><h3 id=mail-advanced>28.6. Geavanceerde onderwerpen<a class=anchor href=#mail-advanced></a></h3><div class=paragraph><p>De volgende sectie behandelt meer ervaren onderwerpen zoals mailinstellingen en het instellen van mail voor het gehele domein.</p></div><div class=sect3><h4 id=mail-config>28.6.1. Basisinstellingen<a class=anchor href=#mail-config></a></h4><div class=paragraph><p>Het verzenden van email naar externe hosts zou onmiddellijk moeten werken, zolang <span class=filename>/etc/resolv.conf</span> is aangemaakt of zolang er een nameserver wordt gedraaid. Indien het gewenst is dat mail voor de host aan de MTA (bijvoorbeeld sendmail) geleverd dient te worden op de FreeBSD-host, zijn er twee methoden:</p></div><div class=ulist><ul><li><p>Draai een eigen nameserver op een eigen domein, bijvoorbeeld <code>FreeBSD.org</code></p></li><li><p>Zorg ervoor dat mail direct aan de host geleverd wordt. Dit wordt gedaan door mail direct aan de huidige DNS-naam voor de machine, bijvoorbeeld <code>example.FreeBSD.org</code>, te leveren.</p></li></ul></div><div class=paragraph><p>Onafhankelijk van de hierboven gekozen methode, dient de host, om er direct mail aan geleverd te krijgen, een permanent statisch IP-adres te hebben (niet een dynamisch adres, zoals dat bij de meeste PPP-inbelverbindingen het geval is). Indien er een firewall actief is, dient het SMTP-verkeer naar de host door te geven. Indien het gewenst is dat de host direct mail ontvangt, dient één van de twee onderstaande dingen geregeld te zijn:</p></div><div class=ulist><ul><li><p>Zorg ervoor dat de (laagstgenummerde) MX-regel in het DNS naar het IP-adres van de host wijst.</p></li><li><p>Zorg ervoor dat er geen MX-regel in het DNS is voor de host.</p></li></ul></div><div class=paragraph><p>Met elk van de bovenstaanden kan mail direct op de host ontvangen worden.</p></div><div class=paragraph><p>Probeer dit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hostname</span>
example.FreeBSD.org
<span class=c># host example.FreeBSD.org</span>
example.FreeBSD.org has address 204.216.27.XX</code></pre></div></div><div class=paragraph><p>Indien dit verschijnt, zal mail die direct naar <a href=mailto:yourlogin@example.FreeBSD.org>yourlogin@example.FreeBSD.org</a> zonder problemen moeten werken (aangenomen dat sendmail correct werkt op <code>example.FreeBSD.org</code>).</p></div><div class=paragraph><p>Indien in plaats daarvan zoiets als dit verschijnt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># host example.FreeBSD.org</span>
example.FreeBSD.org has address 204.216.27.XX
example.FreeBSD.org mail is handled <span class=o>(</span><span class=nv>pri</span><span class=o>=</span>10<span class=o>)</span> by hub.FreeBSD.org</code></pre></div></div><div class=paragraph><p>zal alle mail die naar de host (<code>example.FreeBSD.org</code>) verzameld worden op <code>hub</code> onder dezelfde gebruikersnaam in plaats van direct naar de host verstuurd te worden.</p></div><div class=paragraph><p>Bovenstaande informatie wordt door de DNS-server afgehandeld. De DNS-regel die informatie over het routen van mail bevat is de <em>M</em>ail e<em>X</em>change regel. Indien er geen MX-regel is, zal mail direct aan de host worden afgeleverd door middel van het IP-adres.</p></div><div class=paragraph><p>De MX-regel voor <code>freefall.FreeBSD.org</code> zag er eens als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>freefall		MX	30	mail.crl.net
freefall		MX	40	agora.rdrop.com
freefall		MX	10	freefall.FreeBSD.org
freefall		MX	20	who.cdrom.com</pre></div></div><div class=paragraph><p>Te zien is dat <code>freefall</code> vele MX-regels had. Het laagste MX-getal hoort bij de host die de mail direct ontvangt indien beschikbaar; indien het om een of andere reden niet beschikbaar is, accepteren de anderen (soms " reserve-MXs" genoemd) tijdelijk berichten en geven ze die door wanneer een lager-genummerde host beschikbaar is, om uiteindelijk aan de laagstgenummerde host af te leveren.</p></div><div class=paragraph><p>Alternatieve MX-sites zouden andere Internetverbindingen dan die van de host moeten hebben om het nuttigst te zijn. De internetprovider of een andere vriendelijke site zouden geen problemen moeten hebben met het leveren van deze dienst.</p></div></div><div class=sect3><h4 id=mail-domain>28.6.2. Mail voor het domein<a class=anchor href=#mail-domain></a></h4><div class=paragraph><p>Om een "mailhost" (ook bekend als een mailserver) te installeren, is het nodig om mail die verzonden wordt naar de verschillende werkstations ernaar toe te leiden. In principe dient alle mail voor elke hostnaam in het domein (in dit geval <code>*.FreeBSD.org</code>) geclaimd te worden en naar de mailserver omgeleid te worden zodat gebruikers hun mail op de hoofdmailserver kunnen ontvangen.</p></div><div class=paragraph><p>Het gemakkelijkste is het indien er een gebruikersaccount met dezelfde <em>gebruikersnaam</em> op beide machines bestaat. Hiervoor dient <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a> gebruikt te worden.</p></div><div class=paragraph><p>De mailhost die het meest gebruikt zal worden is de toegewezen mailuitwisselaar voor elk werkstation in het netwerk. Dit wordt in de DNS-instellingen als volgt gedaan:</p></div><div class="literalblock programlisting"><div class=content><pre>example.FreeBSD.org	A	204.216.27.XX	; werkstation
		MX	10	hub.FreeBSD.org	; mailhost</pre></div></div><div class=paragraph><p>Dit zal mail voor het werkstation naar de mailhost leiden onafhankelijk van waar de A-regel naar toe wijst. De mail wordt naar de MX-host verzonden.</p></div><div class=paragraph><p>Om dit te doen is het nodig om een eigen DNS-server te draaien. Neem, indien dit niet het geval is of het niet mogelijk is om een eigen DNS-server te draaien, contact op met degene die de DNS levert.</p></div><div class=paragraph><p>De volgende informatie is nuttig indien email virtueel gehost wordt. In dit voorbeeld wordt aangenomen dat er een klant is met een eigen domein, in dit geval <code>customer1.org</code>, en dat alle mail voor <code>customer1.org</code> naar de mailhost <code>mail.myhost.com</code> verzonden dient te worden. De regel in het DNS dient er als volgt uit te zien:</p></div><div class="literalblock programlisting"><div class=content><pre>customer1.org		MX	10	mail.myhost.com</pre></div></div><div class=paragraph><p>Het is <em>niet</em> nodig om een A-regel voor <code>customer1.org</code> te hebben als er voor dat domein alleen email afgehandeld dient te worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Let erop dat <code>customer1.org</code> pingen niet werkt tenzij er een A-regel voor bestaat.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als laatste dient sendmail op de mailhost te weten voor welke domeinen en/of hostnamen het mail dient te accepteren. Er bestaan enkele verschillende manieren om dit te doen. Elk van de volgende manieren zal werken:</p></div><div class=ulist><ul><li><p>Voeg de hosts toe aan het bestand <span class=filename>/etc/mail/local-host-names</span> indien <code>FEATURE(use_cw_literal)</code>. Indien er een versie van sendmail wordt gebruikt die ouder is dan 8.10, is het te gebruiken bestand <span class=filename>/etc/sendmail.cw</span>.</p></li><li><p>Voeg een regel met <code>Cwyour.host.com</code> toe aan <span class=filename>/etc/sendmail.cf</span> of aan <span class=filename>/etc/mail/sendmail.cf</span> indien versie 8.10 of nieuwer van sendmail wordt gebruikt.</p></li></ul></div></div></div><div class=sect2><h3 id=SMTP-UUCP>28.7. SMTP met UUCP<a class=anchor href=#SMTP-UUCP></a></h3><div class=paragraph><p>De instellingen van sendmail die met FreeBSD worden geleverd zijn ontworpen voor sites die een directe verbinding met het Internet hebben. Sites waarvoor de mail via UUCP willen uitwisselen dienen een ander instellingenbestand voor sendmail te installeren.</p></div><div class=paragraph><p>Het handmatig bijstellen van <span class=filename>/etc/mail/sendmail.cf</span> is een geavanceerd onderwerp. Versie 8 van sendmail genereert instellingenbestanden via <a href="https://man.freebsd.org/cgi/man.cgi?query=m4&amp;sektion=1&amp;format=html">m4(1)</a> preprocessing, waarbij het eigenlijke instellen op een hoger abstractieniveau plaatsvindt. De instellingenbestanden voor <a href="https://man.freebsd.org/cgi/man.cgi?query=m4&amp;sektion=1&amp;format=html">m4(1)</a> kunnen onder <span class=filename>/usr/shared/sendmail/cf</span> gevonden worden. Het bestand <span class=filename>README</span> in de map <span class=filename>cf</span> kan dienen als een basisintroductie tot het instellen van <a href="https://man.freebsd.org/cgi/man.cgi?query=m4&amp;sektion=1&amp;format=html">m4(1)</a>.</p></div><div class=paragraph><p>De beste manier om UUCP te ondersteunen is het gebruiken van de eigenschap <code>mailertable</code>. Dit maakt een database aan die sendmail kan gebruiken om beslissingen over routes te nemen.</p></div><div class=paragraph><p>Als eerste dient het <span class=filename>.mc</span>-bestand aangemaakt te worden. De map <span class=filename>/usr/shared/sendmail/cf/cf</span> bevat enkele voorbeelden. Indien het bestand <span class=filename>foo.mc</span> heet, hoeft slechts het volgende gedaan te worden om het in een geldig <span class=filename>sendmail.cf</span> om te zetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /etc/mail</span>
<span class=c># make foo.cf</span>
<span class=c># cp foo.cf /etc/mail/sendmail.cf</span></code></pre></div></div><div class=paragraph><p>Een typisch <span class=filename>.mc</span>-bestand kan er als volgt uitzien:</p></div><div class="literalblock programlisting"><div class=content><pre>VERSIONID(`Uw versienummer&#39;) OSTYPE(bsd4.4)

FEATURE(accept_unresolvable_domains)
FEATURE(nocanonify)
FEATURE(mailertable, `hash -o /etc/mail/mailertable&#39;)

define(`UUCP_RELAY&#39;, uw.uucp.relay)
define(`UUCP_MAX_SIZE&#39;, 200000)
define(`confDONT_PROBE_INTERFACES&#39;)

MAILER(local)
MAILER(smtp)
MAILER(uucp)

Cw	uw.alias.host.naam
Cw	uwuucpnodenaam.UUCP</pre></div></div><div class=paragraph><p>De regels die de eigenschappen <code>accept_unresolvable_domains</code>, <code>nocanonify</code>, en <code>confDONT_PROBE_INTERFACES</code> bevatten zorgen ervoor dat er geen gebruik wordt gemaakt van het DNS tijdens het afleveren van mail. De clausule <code>UUCP_REPLAY</code> is nodig om UUCP-aflevering te ondersteunen. Hier dient een hostnaam op het Internet ingevuld te worden die .UUCP pseudo-domeinadressen kan afhandelen, waarschijnlijk zal dit de mailrelay van de Internetprovider zijn.</p></div><div class=paragraph><p>Nadat dit gedaan is, is er een bestand <span class=filename>/etc/mail/mailertable</span> nodig. Indien er slechts één verbinding naar buiten is die voor alle mails gebruikt wordt, zal het volgende bestand volstaan:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# makemap hash /etc/mail/mailertable.db &lt; /etc/mail/mailertable
.				uucp-dom:uw.uucp.relay</pre></div></div><div class=paragraph><p>Een complexer voorbeeld kan er als volgt uitzien:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# makemap hash /etc/mail/mailertable.db &lt; /etc/mail/mailertable
#
horus.interface-business.de    uucp-dom:horus
.interface-business.de         uucp-dom:if-bus
interface-business.de          uucp-dom:if-bus
.heep.sax.de                   smtp8:%1
horus.UUCP                     uucp-dom:horus
if-bus.UUCP                    uucp-dom:if-bus
.                              uucp-dom:</pre></div></div><div class=paragraph><p>De eerste drie regels behandelen speciale gevallen waarbij domein-geadresseerde mail niet naar de standaardroute verzonden dient te worden, maar in plaats daarvan naar een UUCP-buur om het afleverpad "af te snijden". De volgende regel handelt mail naar het lokale Ethernetdomein die met SMTP afgeleverd kan worden af. Als laatste worden UUCP-buren in de .UUCP-pseudodomeinnotatie genoemd, om een <code>uucp-buur!ontvanger</code>-overname toe te staan. De laatste regel bestaat altijd uit een enkele punt, dat met al het andere matcht, met UUCP-aflevering naar een UUCP-buur die als universele mail-gateway naar de wereld dient. Alle nodenamen achter het sleutelwoord <code>uucp-dom:</code> dienen geldige UUCP-buren te zijn, dat met het commando <code>uuname</code> gecontroleerd kan worden.</p></div><div class=paragraph><p>Dit bestand dient naar een DBM-database omgezet te worden voor gebruik. De opdrachtregel om dit te doen kan het beste als commentaar bovenaan het bestand <span class=filename>mailertable</span> gezet worden. Deze opdracht dient telkens wanneer het bestand <span class=filename>mailertable</span> wordt gewijzigd uitgevoerd te worden.</p></div><div class=paragraph><p>Laatste tip: indien de werking van een zekere mailroute niet zeker is, kan de optie <code>-bt</code> van sendmail gebruikt worden. Het start sendmail in <em>adrestestmodus</em> op; voer <code>3,0</code> gevolgd door het adres dat voor de mailrouting getest dient te worden in. De laatste regel bevat de gebruikte interne mailagent, de bestemmingshost waarmee deze agent aangeroepen wordt, en het (mogelijk vertaalde) adres. Deze modus kan door het typen van <span class=keyseq><kbd>Ctrl</kbd>+<kbd>D</kbd></span> verlaten worden.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sendmail <span class=nt>-bt</span>
ADDRESS TEST MODE <span class=o>(</span>ruleset 3 NOT automatically invoked<span class=o>)</span>
Enter &lt;ruleset&gt; &lt;address&gt;
<span class=o>&gt;</span> 3,0 foo@example.com
canonify           input: foo @ example <span class=nb>.</span> com
...
parse            returns: <span class=nv>$# </span>uucp-dom <span class=nv>$@</span> uw.uucp.relay <span class=nv>$:</span> foo &lt; @ example <span class=nb>.</span> com <span class=nb>.</span> <span class=o>&gt;</span>
<span class=o>&gt;</span> ^D</code></pre></div></div></div><div class=sect2><h3 id=outgoing-only>28.8. Instellen om alleen te versturen<a class=anchor href=#outgoing-only></a></h3><div class=paragraph><p>Er zijn veel gevallen waarbij het gewenst is om enkel mail te verzenden via een relay. Voorbeelden hiervan zijn:</p></div><div class=ulist><ul><li><p>De computer is een desktop, maar het is gewenst om programma’s als <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> te gebruiken. Hiervoor dient de mailrelay van de internetprovider gebruikt te worden.</p></li><li><p>De computer is een server welke mail niet lokaal verwerkt, maar alle mail voor verwerking doorstuurt.</p></li></ul></div><div class=paragraph><p>Zowat elke MTA kan deze specifieke taak vervullen. Helaas kan het erg moeilijk zijn om een MTA met alle mogelijkheden correct in te stellen om alleen uitgaande mail te behandelen. Programma’s als sendmail en postfix zijn hiervoor grotendeels overbodig.</p></div><div class=paragraph><p>Ook kan het zijn dat de overeenkomst van een typisch internetabonnement het draaien van een "mail server" verbiedt.</p></div><div class=paragraph><p>De gemakkelijkste manier om aan deze behoeften te voldoen is door de port <a class=package href=https://cgit.freebsd.org/ports/tree/mail/ssmtp/>mail/ssmtp</a> te installeren. Voer als <code>root</code> de volgende opdrachten uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/mail/ssmtp</span>
<span class=c># make install replace clean</span></code></pre></div></div><div class=paragraph><p>Eenmaal geïnstalleerd kan <a class=package href=https://cgit.freebsd.org/ports/tree/mail/ssmtp/>mail/ssmtp</a> door middel van het vier-regelige bestand <span class=filename>/usr/local/etc/ssmtp/ssmtp.conf</span> ingesteld worden:</p></div><div class="literalblock programlisting"><div class=content><pre>root=uwechteemail@example.com
mailhub=mail.example.com
rewriteDomain=example.com
hostname=_HOSTNAME_</pre></div></div><div class=paragraph><p>Let erop dat het echte emailadres voor <code>root</code> gebruikt wordt. Vervang <code>mail.example.com</code> door de uitgaande mail relay van de internetprovider (ook wel de "uitgaande mailserver" of "SMTP-server" genoemd).</p></div><div class=paragraph><p>Let erop dat sendmail uitgeschakeld wordt, inclusief de uitgaande maildienst. Raadpleeg <a href=#mail-disable-sendmail>sendmail uitschakelen</a> voor details.</p></div><div class=paragraph><p><a class=package href=https://cgit.freebsd.org/ports/tree/mail/ssmtp/>mail/ssmtp</a> heeft nog meer mogelijkheden. Raadpleeg het voorbeeldinstelbestand <span class=filename>/usr/local/etc/ssmtp</span> of de hulppagina van ssmtp voor enkele voorbeelden en meer informatie.</p></div><div class=paragraph><p>Door ssmtp op deze manier in te stellen kan alle software op de computer welke mail dient te versturen correct functioneren, zonder dat het beleid van de internetprovider geschonden wordt of dat de computer gekaapt kan worden om spam mee te versturen.</p></div></div><div class=sect2><h3 id=SMTP-dialup>28.9. Mail gebruiken met een inbelverbinding<a class=anchor href=#SMTP-dialup></a></h3><div class=paragraph><p>Indien het IP-adres statisch is, is het niet nodig om de standaardwaarden aan te passen. De toegewezen Internetnaam dient als hostnaam gebruikt te worden waarna sendmail de rest kan doen.</p></div><div class=paragraph><p>Indien het IP-adres dynamisch is en er een inbelverbinding naar het Internet gebruikt wordt, is de postbus waarschijnlijk op de mailserver van de Internetprovider geplaatst. Stel dat het domein van de Internetprovider <code>example.net</code> is, dat de gebruikersnaam <code>gebruiker</code> is, dat de machine <code>bsd.home</code> is, en dat volgens de Internetprovider <code>relay.example.net</code> als mailrelay gebruikt kan worden.</p></div><div class=paragraph><p>Om mail van de postbus te ontvangen, dient er een ontvangstagent geïnstalleerd te worden. Het gereedschap fetchmail is een goede keuze omdat het veel verschillende protocollen ondersteunt. Dit programma is als pakket of vanuit de Portscollectie ( <a class=package href=https://cgit.freebsd.org/ports/tree/mail/fetchmail/>mail/fetchmail</a>) beschikbaar. Normaliter levert de Internetprovider POP. Indien gebruikers-PPP gebruikt wordt, kan de mail automatisch worden opgehaald wanneer er een verbinding met Internet tot stand is gebracht door middel van de volgende regel in <span class=filename>/etc/ppp/ppp.linkup</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>MYADDR:
!bg su gebruiker -c fetchmail</pre></div></div><div class=paragraph><p>Indien sendmail gebruikt wordt ( zoals hieronder te zien is) om mail aan niet-lokale accounts af te leveren, is het waarschijnlijk gewenst dat sendmail de mailrij verwerkt zodra er een Internetverbinding tot stand is gebracht. Hiervoor dient de volgende opdracht na de <code>fetchmail</code>-opdracht in <span class=filename>/etc/ppp/ppp.linkup</span> geplaatst te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>  !bg su gebruiker -c &#34;sendmail -q&#34;</pre></div></div><div class=paragraph><p>Aangenomen wordt dat er een account voor <code>gebruiker</code> op <code>bsd.home</code> aanwezig is. In de thuismap van <code>gebruiker</code> op <code>bsd.home</code> dient een bestand <span class=filename>.fetchmailrc</span> aangemaakt te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>poll example.net protocol pop3 fetchall pass MijnGeheim</pre></div></div><div class=paragraph><p>Dit bestand dient alleen voor <code>gebruiker</code> leesbaar te zijn aangezien dit bestand het wachtwoord <code>MijnGeheim</code> bevat.</p></div><div class=paragraph><p>Om mail met de correcte <code>from:</code>-header te versturen, dient sendmail <a href=mailto:gebruiker@example.net>gebruiker@example.net</a> in plaats van <a href=mailto:gebruiker@bsd.home>gebruiker@bsd.home</a> te gebruiken. Het kan ook wenselijk zijn om sendmail alle mail via <code>relay.example.net</code> te versturen, om sneller mail te verzenden.</p></div><div class=paragraph><p>Het volgende <span class=filename>.mc</span> zou voldoende moeten zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>VERSIONID(`bsd.home.mc version 1.0&#39;)
OSTYPE(bsd4.4)dnl
FEATURE(nouucp)dnl
MAILER(local)dnl
MAILER(smtp)dnl
Cwlocalhost
Cwbsd.home
MASQUERADE_AS(`example.net&#39;)dnl
FEATURE(allmasquerade)dnl
FEATURE(masquerade_envelope)dnl
FEATURE(nocanonify)dnl
FEATURE(nodns)dnl
define(`SMART_HOST&#39;, `relay.example.net&#39;)
Dmbsd.home
define(`confDOMAIN_NAME&#39;, `bsd.home&#39;)dnl
define(`confDELIVERY_MODE&#39;, `deferred&#39;)dnl</pre></div></div><div class=paragraph><p>In de vorige sectie staan de details over het omzetten van een <span class=filename>.mc</span>-bestand in bestand <span class=filename>sendmail.cf</span>. Ook dient sendmail herstart te worden na het wijzigen van <span class=filename>sendmail.cf</span>.</p></div></div><div class=sect2><h3 id=SMTP-Auth>28.10. SMTP-authenticatie<a class=anchor href=#SMTP-Auth></a></h3><div class=paragraph><p>Het hebben van SMTP-authenticatie op een mailserver heeft een aantal voordelen. SMTP- authenticatie kan een extra beveiligingslaag toevoegen aan sendmail, en het geeft mobiele gebruikers die van hosts wisselen de mogelijkheid om dezelfde mailserver te gebruiken zonder dat ze telkens de instellingen van hun mailclient moeten veranderen.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Installeer <a class=package href=https://cgit.freebsd.org/ports/tree/security/cyrus-sasl2/>security/cyrus-sasl2</a> vanuit de ports. Deze port is te vinden in <a class=package href=https://cgit.freebsd.org/ports/tree/security/cyrus-sasl2/>security/cyrus-sasl2</a>. De port <a class=package href=https://cgit.freebsd.org/ports/tree/security/cyrus-sasl2/>security/cyrus-sasl2</a> ondersteund een aantal opties tijdens de compilatie. Voor de SMTP-authenticatiemethode die hier gebruikt wordt, dient de optie <code>LOGIN</code> te zijn uitgezet.</p></li><li><p>Voeg nadat <a class=package href=https://cgit.freebsd.org/ports/tree/security/cyrus-sasl2/>security/cyrus-sasl2</a> is geïnstalleerd deze regel toe aan <span class=filename>/usr/local/lib/sasl2/Sendmail.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>pwcheck_method: saslauthd</pre></div></div></li><li><p>Installeer vervolgens <a class=package href=https://cgit.freebsd.org/ports/tree/security/cyrus-sasl2-saslauthd/>security/cyrus-sasl2-saslauthd</a>, en voeg de volgende regel toe aan <span class=filename>/etc/rc.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>saslauthd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>en start vervolgens het saslauthd-daemon op:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service saslauthd start</span></code></pre></div></div><div class=paragraph><p>Deze daemon fungeert als een onderhandelaar voor sendmail die zich tegen de FreeBSD <span class=filename>passwd</span>-database authenticeert. Dit bespaart de moeite van het opnieuw creëren van een nieuwe verzameling gebruikersnamen en wachtwoorden voor elke gebruiker die SMTP-authenticatie nodig heeft, en het houdt de wachtwoorden voor het inloggen en de mail hetzelfde.</p></div></li><li><p>Voeg de volgende regels toe aan <span class=filename>/etc/make.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>SENDMAIL_CFLAGS=-I/usr/local/include/sasl -DSASL
SENDMAIL_LDFLAGS=-L/usr/local/lib
SENDMAIL_LDADD=-lsasl2</pre></div></div><div class=paragraph><p>Deze regels geven sendmail de juiste instelopties om tijdens het compileren met <a class=package href=https://cgit.freebsd.org/ports/tree/cyrus-sal2/>cyrus-sal2</a> te linken. Zorg ervoor dat <a class=package href=https://cgit.freebsd.org/ports/tree/cyrus-sasl2/>cyrus-sasl2</a> is geïnstalleerd voordat sendmail wordt gehercompileerd.</p></div></li><li><p>Hercompileer sendmail door de volgende opdrachten uit te voeren:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/lib/libsmutil</span>
<span class=c># make cleandir &amp;&amp; make obj &amp;&amp; make</span>
<span class=c># cd /usr/src/lib/libsm</span>
<span class=c># make cleandir &amp;&amp; make obj &amp;&amp; make</span>
<span class=c># cd /usr/src/usr.sbin/sendmail</span>
<span class=c># make cleandir &amp;&amp; make obj &amp;&amp; make &amp;&amp; make install</span></code></pre></div></div><div class=paragraph><p>Het compileren van sendmail zou geen problemen moeten geven indien <span class=filename>/usr/src</span> niet veel veranderd is en dat de benodigde gedeelde bibliotheken aanwezig zijn.</p></div></li><li><p>Nadat sendmail is gecompileerd en opnieuw is gecompileerd, dient <span class=filename>/etc/mail/freebsd.mc</span> (of het plaatselijke <span class=filename>.mc</span>-bestand) gewijzigd te worden. Veel beheerders kiezen ervoor om de uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=hostname&amp;sektion=1&amp;format=html">hostname(1)</a> als <span class=filename>.mc</span>-bestandsnaam te gebruiken vanwege de uniciteit. Voeg deze regels toe:</p><div class="literalblock programlisting"><div class=content><pre>dnl set SASL options
TRUST_AUTH_MECH(`GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN&#39;)dnl
define(`confAUTH_MECHANISMS&#39;, `GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN&#39;)dnl</pre></div></div><div class=paragraph><p>Deze opties stellen de verschillende beschikbare methoden voor sendmail in om gebruikers te authenticeren. Gebruik de bijgeleverde documentatie indien een andere methode dan pwcheck gewenst is.</p></div></li><li><p>Voer als laatste <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> in <span class=filename>/etc/mail</span> uit. Hierdoor wordt het nieuwe <span class=filename>.mc</span>-bestand uitgevoerd en wordt een bestand <span class=filename>freebsd.cf</span> (of de plaatselijke variant ervan) aangemaakt. Voer hierna de opdracht <code>make install restart</code> uit, wat het bestand naar <span class=filename>sendmail.cf</span> kopieert en sendmail op de juiste manier herstart. In <span class=filename>/etc/mail/Makefile</span> staat meer informatie over dit proces.</p></li></ol></div></div></div><div class=paragraph><p>Indien alles goed is gegaan, moet het mogelijk zijn om de inloginformatie in de mailclient in te voeren en een testbericht te versturen. Zet voor verdere onderzoekingen de <code>LogLevel</code> van sendmail op 13 en houdt <span class=filename>/var/log/maillog</span> in de gaten voor foutmeldingen.</p></div><div class=paragraph><p>Refereer naar de sendmail-pagina betreffende <a href=http://www.sendmail.org/~ca/email/auth.html>SMTP-authenticatie</a> voor meer informatie.</p></div></div><div class=sect2><h3 id=mail-agents>28.11. Mail User Agents<a class=anchor href=#mail-agents></a></h3><div class=paragraph><p>Een mail user agent (MUA) is een toepassing die wordt gebruikt om email te versturen en te ontvangen. Bovendien, omdat email "evolueert" en steeds complexer wordt, worden MUAs steeds krachtiger in de manier waarop ze met email omgaan; dit biedt gebruikers verhoogde functionaliteit en flexibiliteit. FreeBSD ondersteunt verschillende mail user agents die allemaal eenvoudig geïnstalleerd kunnen worden door de <a href=./#ports>FreeBSD Ports Collectie</a> te gebruiken. Gebruikers kunnen kiezen tussen grafische emailclients zoals evolution of balsa, op de console gebaseerde clients zoals mutt, alpine of <code>mail</code>, of de webinterface die door sommige grote organisaties wordt gebruikt.</p></div><div class=sect3><h4 id=mail-command>28.11.1. mail<a class=anchor href=#mail-command></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> is de standaard mail user agent (MUA) in FreeBSD. Het is een consolegebaseerde MUA die alle basisfunctionaliteit biedt die nodig is om tekstgebaseerde email te verzenden en te ontvangen, maar het is beperkt in de mogelijkheden om met bijlagen om te gaan en het ondersteunt alleen plaatselijke postbussen.</p></div><div class=paragraph><p>Hoewel <code>mail</code> van huis uit geen ondersteuning voor POP- of IMAP -servers biedt, kunnen deze postbussen gedownload worden naar een lokaal <span class=filename>mbox</span>-bestand door een toepassing als fetchmail te gebruiken, welke later in dit hoofdstuk behandeld wordt (<a href=#mail-fetchmail>fetchmail gebruiken</a>).</p></div><div class=paragraph><p>Draai <code>mail</code> om email te versturen en te ontvangen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mail</code></pre></div></div><div class=paragraph><p>De inhoud van de gebruikerspostbus in <span class=filename>/var/mail</span> wordt automatisch gelezen door het programma <code>mail</code>. Indien de postbus leeg is, eindigt het programma het een melding dat er geen mail gevonden kon worden. Wanneer de postbus is gelezen, wordt de applicatie-interface gestart, en wordt er een berichtenlijst weergegeven. Berichten worden automatisch genummerd, zoals in het volgende voorbeeld te zien is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Mail version 8.1 6/6/93.  Type ? <span class=k>for </span>help.
<span class=s2>&#34;/var/mail/marcs&#34;</span>: 3 messages 3 new
<span class=o>&gt;</span>N  1 root@localhost        Mon Mar  8 14:05  14/510   <span class=s2>&#34;test&#34;</span>
 N  2 root@localhost        Mon Mar  8 14:05  14/509   <span class=s2>&#34;user account&#34;</span>
 N  3 root@localhost        Mon Mar  8 14:05  14/509   <span class=s2>&#34;sample&#34;</span></code></pre></div></div><div class=paragraph><p>Berichten kunnen nu worden gelezen door middel van het commando <kbd>t</kbd> van <code>mail</code>, gevolgd door het gewenste berichtnummer. In dit voorbeeld wordt de eerste email gelezen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&amp; t 1
Message 1:
From root@localhost  Mon Mar  8 14:05:52 2004
X-Original-To: marcs@localhost
Delivered-To: marcs@localhost
To: marcs@localhost
Subject: <span class=nb>test
</span>Date: Mon,  8 Mar 2004 14:05:52 +0200 <span class=o>(</span>SAST<span class=o>)</span>
From: root@localhost <span class=o>(</span>Charlie Root<span class=o>)</span>

This is a <span class=nb>test </span>message, please reply <span class=k>if </span>you receive it.</code></pre></div></div><div class=paragraph><p>Zoals in bovenstaand voorbeeld te zien is, zorgt de toets <kbd>t</kbd> ervoor dat het bericht met volledige headers wordt getoond. Om de berichtenlijst nogmaals weer te geven, dient de toets <kbd>h</kbd> gebruikt te worden.</p></div><div class=paragraph><p>Er kan met <code>mail</code> op een email gereageerd worden, door gebruik te maken één van de toetsen <kbd>R</kbd> of <kbd>r</kbd>. De toets <kbd>R</kbd> vertelt <code>mail</code> dat er alleen aan de verzender van het bericht geantwoord dient te worden, terwijl de toets <kbd>r</kbd> niet alleen aan de verzender antwoordt, maar ook aan andere ontvangers van het bericht. Het is ook mogelijk om achter deze commando’s het berichtnummer te plaatsen waarop gereageerd dient te worden. Nadat dit gedaan is , dient het antwoord gegeven te worden, en dient het einde van het bericht aangegeven te worden met een enkele <kbd>.</kbd> op een nieuwe regel. Een voorbeeld staat hieronder:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&amp; R 1
To: root@localhost
Subject: Re: <span class=nb>test

</span>Thank you, I did get your email.
<span class=nb>.</span>
EOT</code></pre></div></div><div class=paragraph><p>Om een nieuwe email te verzenden, dient de toets <kbd>m</kbd> gebruikt te worden, gevolgd door het adres van de ontvanger. Er kunnen meerdere ontvangers gespecificeerd worden door ze met een <kbd>,</kbd> te scheiden. Hierna kan het onderwerp van het bericht worden gegeven, gevolgd door de inhoud van het bericht. Het einde van het bericht dient te worden aangegeven door een enkele <kbd>.</kbd> op een nieuwe regel te plaatsen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&amp; mail root@localhost
Subject: I mastered mail

Now I can send and receive email using mail ... :<span class=o>)</span>
<span class=nb>.</span>
EOT</code></pre></div></div><div class=paragraph><p>Binnen het programma <code>mail</code> kan op elk moment de opdracht <kbd>?</kbd> gebruikt worden om hulp weer te geven, hiervoor kan ook de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> worden geraadpleegd.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Zoals eerder is aangegeven, is het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> van origine niet ontworpen om met bijlagen om te gaan, dus behandelt het deze slecht. Nieuwere MUAs zoals mutt gaan veel intelligenter met bijlagen om. Maar indien het programma <code>mail</code> nog steeds geprefereerd wordt, kan de port <a class=package href=https://cgit.freebsd.org/ports/tree/converters/mpack/>converters/mpack</a> van aanzienlijk nut zijn.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=mutt-command>28.11.2. mutt<a class=anchor href=#mutt-command></a></h4><div class=paragraph><p>mutt is een kleine doch zeer krachtige mail user agent, met uitstekende mogelijkheden, waaronder:</p></div><div class=ulist><ul><li><p>De mogelijkheid om berichten te threaden;</p></li><li><p>PGP-ondersteuning voor het digitaal ondertekenen en versleutelen van email;</p></li><li><p>MIME-ondersteuning;</p></li><li><p>Maildir-ondersteuning;</p></li><li><p>Erg goed aan te passen.</p></li></ul></div><div class=paragraph><p>Al deze eigenschappen zorgen ervoor dat mutt een van de meest geavanceerde beschikbare mail user agents is. Op <a href=http://www.mutt.org>http://www.mutt.org</a> staat meer informatie.</p></div><div class=paragraph><p>De stabiele versie van mutt kan geïnstalleerd worden door de port <a class=package href=https://cgit.freebsd.org/ports/tree/mail/mutt/>mail/mutt</a> te gebruiken, terwijl de huidige ontwikkelaarsversie geïnstalleerd kan worden via de port <a class=package href=https://cgit.freebsd.org/ports/tree/mail/mutt-devel/>mail/mutt-devel</a>. Nadat de port is geïnstalleerd, kan mutt gestart worden met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mutt</code></pre></div></div><div class=paragraph><p>mutt zal automatisch de inhoud van de gebruikerspostbus in <span class=filename>/var/mail</span> lezen en de inhoud weergeven indien van toepassing. Indien er geen mails gevonden zijn in de gebruikerspostbus, zal mutt wachten voor opdrachten van de gebruiker. Het onderstaande voorbeeld laat zien hoe mutt een lijst berichten weergeeft:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/mutt1.png alt=mutt1></div></div><div class=paragraph><p>Selecteer om een email te lezen deze met de cursortoetsen, en sla de toets <kbd>Enter</kbd> aan. Een voorbeeld waarbij mutt email laat zien staat hieronder:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/mutt2.png alt=mutt2></div></div><div class=paragraph><p>Net zoals het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> staat mutt gebruikers toe om alleen de afzender alsook alle ontvangers te beantwoorden. Om alleen de afzender van de email te antwoorden, wordt de toets <kbd>r</kbd> gebruikt. Om aan een groep te antwoorden, welke aan zowel de originele afzender als aan alle berichtontvangers wordt gestuurd, wordt de toets <kbd>g</kbd> gebruikt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>mutt maakt gebruikt van het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a> als tekstverwerker voor het aanmaken en beantwoorden van emails. De gebruiker kan dit aanpassen door een eigen <span class=filename>.muttrc</span> aan te maken in hun thuismap en de variabele <code>editor</code> of de omgevingsvariabele <code>EDITOR</code> aan te passen. Zie <a href=http://www.mutt.org/>http://www.mutt.org/</a> voor meer informatie over het instellen van mutt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Voor het opstellen van een nieuw mailbericht wordt de toets <kbd>m</kbd> gebruikt. Nadat er een geldig bericht is gegeven, start mutt <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a> op en kan de mail geschreven worden. Nadat de inhoud van de mail is geschreven, zal mutt nadat <code>vi</code> verlaten is, zichzelf hervatten en een overzichtsscherm van de te verzenden mail afbeelden. Om de mail te versturen wordt de toets <kbd>y</kbd> gebruikt. Een voorbeeld van het overzichtsscherm is hieronder te zien:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/mutt3.png alt=mutt3></div></div><div class=paragraph><p>mutt bevat ook uitgebreide hulp, welke in de meeste menu’s geactiveerd kan worden door de toets <kbd>?</kbd> aan te slaan. De bovenste regel geeft ook de relevante toetsen aan.</p></div></div><div class=sect3><h4 id=alpine-command>28.11.3. alpine<a class=anchor href=#alpine-command></a></h4><div class=paragraph><p>alpine richt zich op de beginnende gebruiker, maar bevat ook geavanceerde mogelijkheden.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Er zijn in het verleden verschillende kwetsbaarheden voor alpine ontdekt, welke aanvallers op afstand in staat stelden om willekeurige code als gebruikers op het lokale systeem uit te voeren, door een speciaal voorbereide email te versturen. Alle <em>bekende</em> problemen van dit type zijn gerepareerd, maar de code van alpine is op een zeer onveilige manier geschreven en de beveiligingsofficier van FreeBSD gelooft dat het waarschijnlijk is dat er nog meer onontdekte kwetsbaarheden zijn. Installeer alpine op eigen risico.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De huidige versie van alpine kan door middel van de port <a class=package href=https://cgit.freebsd.org/ports/tree/mail/alpine/>mail/alpine</a> geïnstalleerd worden. Wanneer de port geïnstalleerd is, kan alpine met het volgende commando gestart worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% alpine</code></pre></div></div><div class=paragraph><p>De eerste keer dat alpine wordt gedraaid geeft het een welkomstpagina met een korte introductie weer, alsmede een verzoek van het ontwikkelteam van alpine om een anoniem emailbericht te versturen wat ze in staat stelt om te beoordelen hoeveel gebruikers hun client gebruiken. Druk op <kbd>Enter</kbd> om dit anonieme bericht te versturen, of druk op <kbd>E</kbd> om het welkomstscherm te verlaten zonder een anoniem bericht te versturen. Een voorbeeld van het welkomstscherm is hieronder te zien:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/pine1.png alt=pine1></div></div><div class=paragraph><p>Vervolgens wordt het hoofdmenu getoond, waarin gemakkelijk met de cursortoetsen kan worden genavigeerd. Dit hoofdmenu biedt afkortingen voor het schrijven van nieuwe mail, het doorbladeren van mailmappen, en zelfs het beheren van het adresboek. Onder het hoofdmenu worden relevante toetscombinaties voor de huidige taak getoond.</p></div><div class=paragraph><p>De standaardmap die door alpine wordt geopend is de <span class=filename>inbox</span>. Gebruik de toets <kbd>I</kbd> om de berichtenindex te zien, of selecteer de optie <span class=guimenuitem>MESSAGE INDEX</span> zoals hieronder te zien is:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/pine2.png alt=pine2></div></div><div class=paragraph><p>De berichtenindex geeft de berichten in de huidige map weer, en kan met de cursortoetsen worden genavigeerd. Gemarkeerde berichten kunnen worden gelezen door op <kbd>Enter</kbd> te drukken.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/pine3.png alt=pine3></div></div><div class=paragraph><p>In onderstaand screenshot wordt een voorbeeldbericht door alpine weergegeven. Toetsencombinaties worden ter referentie aan de onderkant van het scherm weergegeven. Een voorbeeld van een van deze combinaties is de toets <kbd>r</kbd>, welke de MUA vertelt op het huidige bericht te antwoorden.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/pine4.png alt=pine4></div></div><div class=paragraph><p>Voor het beantwoorden van een bericht wordt in alpine gebruikt gemaakt van de tekstverwerker pico, welke standaard bij alpine wordt geïnstalleerd. Het programma pico maakt het gemakkelijk om in het bericht te navigeren en is meer vergevingsgezind voor nieuwe gebruikers dan <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a>. Wanneer het antwoord voltooid is, kan het bericht worden verzonden door <span class=keyseq><kbd>Ctrl</kbd>+<kbd>X</kbd></span> te gebruiken. Het programma alpine zal om bevestiging vragen.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/pine5.png alt=pine5></div></div><div class=paragraph><p>Het programma alpine kan worden aangepast door de optie <span class=guimenuitem>SETUP</span> van het hoofdmenu te gebruiken. Raadpleeg <a href=http://www.washington.edu/pine/>http://www.washington.edu/pine/</a> voor meer informatie.</p></div></div></div><div class=sect2><h3 id=mail-fetchmail>28.12. fetchmail gebruiken<a class=anchor href=#mail-fetchmail></a></h3><div class=paragraph><p>fetchmail is een volwaardige client voor IMAP en POP welke gebruikers in staat stelt om automatisch mail van IMAP- en POP-servers op afstand naar plaatselijke postbussen te downloaden; daar kan het gemakkelijker worden benaderd. fetchmail kan met de port <a class=package href=https://cgit.freebsd.org/ports/tree/mail/fetchmail/>mail/fetchmail</a> worden geïnstalleerd, en biedt verschillende mogelijkheden, waaronder:</p></div><div class=ulist><ul><li><p>Ondersteuning voor POP3, APOP, KPOP, IMAP, ETRN, en ODMR protocollen.</p></li><li><p>De mogelijkheid om mail via SMTP door te sturen, wat filteren, doorsturen, en aliassen toestaat om normaal te functioneren.</p></li><li><p>Kan in daemon-modus gedraaid worden om periodiek op nieuwe berichten te controleren.</p></li><li><p>Kan verschillende postbussen ophalen en ze afhankelijk van de instellingen naar verschillende plaatselijke gebruikers doorsturen.</p></li></ul></div><div class=paragraph><p>Hoewel het niet de bedoeling van dit document is om alle mogelijkheden van fetchmail uit te leggen, zullen sommige basismogelijkheden worden uitgelegd. Het gereedschap fetchmail heeft een instellingenbestand <span class=filename>.fetchmailrc</span> nodig om correct te kunnen werken. Dit bestand bevat zowel informatie over de server als de inloggegevens. Vanwege de gevoelige aard van de inhoud van dit bestand is het aan te raden om het met het volgende commando alleen leesbaar te maken voor de eigenaar ervan :</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>chmod </span>600 .fetchmailrc</code></pre></div></div><div class=paragraph><p>Het volgende <span class=filename>.fetchmailrc</span> dient als een voorbeeld voor het downloaden van een postbus van een enkele gebruiker via POP. Het vertelt fetchmail om met <code>example.com</code> te verbinden als gebruiker <code>joesoap</code> met wachtwoord <code>XXX</code>. Dit voorbeeld gaat ervan uit dat de gebruiker <code>joesoap</code> ook een gebruiker is op het plaatselijke systeem.</p></div><div class="literalblock programlisting"><div class=content><pre>poll example.com protocol pop3 username &#34;joesoap&#34; password &#34;XXX&#34;</pre></div></div><div class=paragraph><p>Het volgende voorbeeld legt verbinding met meerdere POP- en IMAP-servers en stuurt de mail door naar verschillende plaatselijke gebruikers indien van toepassing:</p></div><div class="literalblock programlisting"><div class=content><pre>poll example.com proto pop3:
user &#34;joesoap&#34;, with password &#34;XXX&#34;, is &#34;jsoap&#34; here;
user &#34;andrea&#34;, with password &#34;XXXX&#34;;
poll example2.net proto imap:
user &#34;john&#34;, with password &#34;XXXXX&#34;, is &#34;myth&#34; here;</pre></div></div><div class=paragraph><p>Het gereedschap fetchmail kan in daemon-modus worden gedraaid met de vlag <code>-d</code> gevolgd door het interval (in seconden) waarmee fetchmail de servers die in het bestand <span class=filename>.fetchmailrc</span> vermeld staan dient te vragen. Het volgende voorbeeld zorgt ervoor dat fetchmail elke 600 seconden vraagt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% fetchmail <span class=nt>-d</span> 600</code></pre></div></div><div class=paragraph><p>Meer informatie over fetchmail is te vinden op <a href=http://fetchmail.berlios.de/>http://fetchmail.berlios.de/</a>.</p></div></div><div class=sect2><h3 id=mail-procmail>28.13. procmail gebruiken<a class=anchor href=#mail-procmail></a></h3><div class=paragraph><p>Het gereedschap procmail is een zeer krachtig gereedschap voor het filteren van binnenkomende mail. Het stelt gebruikers in staat om "regels" te definiëren welke aan binnenkomende mail gekoppeld kunnen worden om specifieke taken uit te voeren of om de mail naar alternatieve postbussen en/of emailadressen door te sturen. procmail kan met de port <a class=package href=https://cgit.freebsd.org/ports/tree/mail/procmail/>mail/procmail</a> geïnstalleerd worden. Eenmaal geïnstalleerd kan het direct met de meeste MTAs geïntegreerd worden; raadpleeg de documentatie van de MTA voor meer informatie. Als alternatief kan procmail geïntegreerd worden door de volgende regel aan het bestand <span class=filename>.forward</span> in de thuismap van de gebruiker die procmail gebruikt toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>&#34;|exec /usr/local/bin/procmail || exit 75&#34;</pre></div></div><div class=paragraph><p>De volgende sectie geeft wat basisregels van procmailmet een korte beschrijving ervan. Deze, en andere, regels dienen in het bestand <span class=filename>.procmailrc</span> geplaatst te worden, welke zich in de thuismap van de gebruiker dient te bevinden.</p></div><div class=paragraph><p>De meerderheid van deze regels kan ook in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=procmailex&amp;sektion=5&amp;format=html">procmailex(5)</a> gevonden worden.</p></div><div class=paragraph><p>Stuur alle mail van <a href=mailto:user@example.com>user@example.com</a> door naar het externe adres <a href=mailto:goodmail@example2.com>goodmail@example2.com</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>:0
* ^From.*user@example.com
! goodmail@example2.com</pre></div></div><div class=paragraph><p>Stuur alle mails korten dan 1000 bytes door naar het externe adres <a href=mailto:goodmail@example2.com>goodmail@example2.com</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>:0
* &lt; 1000
! goodmail@example2.com</pre></div></div><div class=paragraph><p>Stuur alle mail verzonden aan <a href=mailto:alternate@example.com>alternate@example.com</a> door naar een postbus <span class=filename>alternate</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>:0
* ^TOalternate@example.com
alternate</pre></div></div><div class=paragraph><p>Stuur alle mail met het onderwerp "Spam" door naar <span class=filename>/dev/null</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>:0
^Subject:.*Spam
/dev/null</pre></div></div><div class=paragraph><p>Een handig recept dat binnenkomende <code>FreeBSD.org</code> mailinglijsten parseert en elke lijst in en eigen postbus plaatst:</p></div><div class="literalblock programlisting"><div class=content><pre>:0
* ^Sender:.owner-freebsd-\/[^@]+@FreeBSD.ORG
{
	LISTNAME=${MATCH}
	:0
	* LISTNAME??^\/[^@]+
	FreeBSD-${MATCH}
}</pre></div></div></div></div></div><div class=sect1><h2 id=network-servers>Hoofdstuk 29. Netwerkdiensten<a class=anchor href=#network-servers></a></h2><div class=sectionbody><div class=sect2><h3 id=network-servers-synopsis>29.1. Overzicht<a class=anchor href=#network-servers-synopsis></a></h3><div class=paragraph><p>Dit hoofdstuk behandelt een aantal veelgebruikte netwerkdiensten op UNIX® systemen. Er wordt ingegaan op de installatie, het instellen, testen en beheren van verschillende typen netwerkdiensten. Overal in dit hoofdstuk staan voorbeeldbestanden met instellingen waar de lezer zijn voordeel mee kan doen.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe om te gaan met de inetd daemon;</p></li><li><p>Hoe een netwerkbestandssysteem opgezet kan worden;</p></li><li><p>Hoe een netwerkinformatiedienst (NIS) opgezet kan worden voor het delen van gebruikersaccounts;</p></li><li><p>Hoe automatische netwerkinstellingen gemaakt kunnen worden met DHCP;</p></li><li><p>Hoe een domeinnaam server opgezet kan worden;</p></li><li><p>Hoe een Apache HTTP Server opgezet kan worden;</p></li><li><p>Hoe een File Transfer Protocol (FTP) Server opgezet kan worden;</p></li><li><p>Hoe een bestand-- en printserver voor Windows® cliënten opgezet kan worden met Samba;</p></li><li><p>Hoe datum en tijd gesynchroniseerd kunnen worden en hoe een tijdserver opgezet kan worden met het NTP-protocol.</p></li><li><p>Hoe het standaard log-daemon <code>syslogd</code> in te stellen om logs van hosts op afstand te accepteren.</p></li></ul></div><div class=paragraph><p>Veronderstelde voorkennis:</p></div><div class=ulist><ul><li><p>Basisbegrip van de scripts in <span class=filename>/etc/rc</span>;</p></li><li><p>Bekend zijn met basis netwerkterminologie;</p></li><li><p>Kennis van de installatie van software van derde partijen (<a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></li></ul></div></div><div class=sect2><h3 id=network-inetd>29.2. De inetd"Super-Server"<a class=anchor href=#network-inetd></a></h3><div class=sect3><h4 id=network-inetd-overview>29.2.1. Overzicht<a class=anchor href=#network-inetd-overview></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> wordt soms de "Internet Super-Server" genoemd, omdat het verbindingen voor meerdere diensten beheert. Als door inetd een verbinding wordt ontvangen, bepaalt die voor welk programma de verbinding bedoeld is, splitst het dat proces af en delegeert de socket (het programma wordt gestart met de socket van de dienst als zijn standaardinvoer, -uitvoer en -foutbeschrijvingen). Het draaien van inetd voor servers die niet veel gebruikt worden kan de algehele werklast verminderen in vergelijking met het draaien van elke daemon individueel in stand-alone modus.</p></div><div class=paragraph><p>inetd wordt primair gebruikt om andere daemons aan te roepen, maar het handelt een aantal triviale protocollen direct af, zoals chargen, auth en daytime.</p></div><div class=paragraph><p>In deze paragraaf worden de basisinstellingen van inetd behandeld met de opties vanaf de commandoregel en met het instellingenbestand <span class=filename>/etc/inetd.conf</span>.</p></div></div><div class=sect3><h4 id=network-inetd-settings>29.2.2. Instellingen<a class=anchor href=#network-inetd-settings></a></h4><div class=paragraph><p>inetd wordt gestart door het <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>-systeem. De optie <code>inetd_enable</code> staat standaard op <code>NO</code>, maar kan tijdens de installatie door sysinstall worden aangezet. Door het plaatsen van</p></div><div class="literalblock programlisting"><div class=content><pre>inetd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>of</p></div><div class="literalblock programlisting"><div class=content><pre>inetd_enable=&#34;NO&#34;</pre></div></div><div class=paragraph><p>in <span class=filename>/etc/rc.conf</span> wordt inetd bij het opstarten van een systeem wel of niet ingeschakeld. Het commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd rcvar</span></code></pre></div></div><div class=paragraph><p>kan gedraaid worden om de huidige effectieve instellingen weer te geven.</p></div><div class=paragraph><p>Dan kunnen er ook nog een aantal commandoregelopties aan inetd meegegeven worden met de optie <code>inetd_flags</code>.</p></div></div><div class=sect3><h4 id=network-inetd-cmdline>29.2.3. Commandoregelopties<a class=anchor href=#network-inetd-cmdline></a></h4><div class=paragraph><p>Zoals de meeste serverdaemons heeft inetd een aantal opties die doorgegeven kunnen worden om het gedrag aan te passen. Zie de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> voor een volledige lijst van de opties.</p></div><div class=paragraph><p>Opties kunnen door middel van de optie <code>inetd_flags</code> in <span class=filename>/etc/rc.conf</span> aan inetd worden doorgegeven. Standaard staat <code>inetd_flags</code> ingesteld op <code>-wW -C 60</code>, dat TCP-wrapping aanzet voor de diensten van inetd, en voorkomt dat elk enkelvoudig IP-adres enige dienst meer dan 60 keer per minuut opvraagt.</p></div><div class=paragraph><p>Ook al worden er hieronder rate-limiting opties besproken, beginnende gebruikers kunnen blij zijn met het feit dat deze parameters gewoonlijk niet hoeven te worden aangepast. Deze opties kunnen interessant zijn wanneer er een buitensporige hoeveelheid verbindingen worden opgezet. Een volledige lijst van opties staat in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a>.</p></div><div class=dlist><dl><dt class=hdlist1>-c maximum</dt><dd><p>Geeft het maximale aantal gelijktijdige verzoeken voor iedere dienst aan. De standaard is ongelimiteerd. Kan per dienst ter zijde geschoven worden met de parameter <code>max-child</code>.</p></dd><dt class=hdlist1>-C rate</dt><dd><p>Geeft het maximale aantal keren aan dat een dienst vanaf een bepaald IP-adres per minuut aangeroepen kan worden. Kan per dienst ter zijde geschoven worden met de parameter <code>max-connections-per-ip-per-minute</code>.</p></dd><dt class=hdlist1>-R rate</dt><dd><p>Geeft het maximale aantal keren aan dat een dienst per minuut aangeroepen kan worden. De standaard is 256. De instelling <code>0</code> geeft aan dat er geen limiet is.</p></dd><dt class=hdlist1>-s maximum</dt><dd><p>Specificeert het maximaal aantal keer per minuut dat een dienst aangeroepen kan worden vanuit een enkelvoudig IP-adres; de standaard is onbeperkt. Kan worden overstemd op een per-dienst-basis met de parameter <code>max-child-per-ip</code>.</p></dd></dl></div></div><div class=sect3><h4 id=network-inetd-conf>29.2.4. <span class=filename>inetd.conf</span><a class=anchor href=#network-inetd-conf></a></h4><div class=paragraph><p>De instellingen van inetd worden beheerd in <span class=filename>/etc/inetd.conf</span>.</p></div><div class=paragraph><p>Als er een wijziging wordt aangebracht in <span class=filename>/etc/inetd.conf</span>, dan kan inetd gedwongen worden om de instellingen opnieuw in te lezen door dit commando te draaien:</p></div><div id=network-inetd-reread class=exampleblock><div class=title>Voorbeeld 33. Het instellingenbestand van inetd herladen</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd reload</span></code></pre></div></div></div></div><div class=paragraph><p>Iedere regel in het bestand met instellingen heeft betrekking op een individuele daemon. Commentaar wordt vooraf gegaan door een <code>#</code>. De opmaak van elke regel van <span class=filename>/etc/inetd.conf</span> is als volgt:</p></div><div class="literalblock programlisting"><div class=content><pre>service-name
socket-type
protocol
{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]
user[:group][/login-class]
server-program
server-program-arguments</pre></div></div><div class=paragraph><p>Een voorbeeldregel voor de daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpd&amp;sektion=8&amp;format=html">ftpd(8)</a> met IPv4 kan eruit zien als:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp     stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -l</pre></div></div><div class=dlist><dl><dt class=hdlist1>service-name</dt><dd><p>Dit is de dienstnaam van een daemon. Die moet overeenkomen met een dienst uit <span class=filename>/etc/services</span>. Hiermee kan de poort waarop inetd moet luisteren aangegeven worden. Als er een nieuwe dienst wordt gemaakt, moet die eerst in <span class=filename>/etc/services</span> gezet worden.</p></dd><dt class=hdlist1>socket-type</dt><dd><p>Dit is <code>stream</code>, <code>dgram</code>, <code>raw</code> of <code>seqpacket</code>. <code>stream</code> moet gebruikt worden voor verbindingsgebaseerde TCP-daemons, terwijl <code>dgram</code> wordt gebruikt voor daemons die gebruik maken van het transportprotocol UDP.</p></dd><dt class=hdlist1>protocol</dt><dd><p>Een van de volgende:</p><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Protocol</th><th class="tableblock halign-left valign-top">Toelichting</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp, tcp4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TCP IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp, udp4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UDP IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TCP IPv6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UDP IPv6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp46</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Zowel TCP IPv4 als v6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp46</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Zowel UDP IPv4 als v6</p></td></tr></tbody></table></dd><dt class=hdlist1>{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]</dt><dd><p><code>wait|nowait</code> geeft aan of de daemon die door inetd wordt aangesproken zijn eigen sockets kan afhandelen of niet. <code>dgram</code> sockettypen moeten de optie <code>wait</code> gebruiken, terwijl streamsocket daemons, die meestal multi-threaded zijn, de optie <code>nowait</code> horen te gebruiken. <code>wait</code> geeft meestal meerdere sockets aan een daemon, terwijl <code>nowait</code> een kinddaemon draait voor iedere nieuwe socket.</p><div class=paragraph><p>Het maximum aantal kinddaemons dat inetd mag voortbrengen kan ingesteld worden met de optie <code>max-child</code>. Als een limiet van tien instanties van een bepaalde daemon gewenst is, dan zou er <code>/10</code> achter <code>nowait</code> gezet worden. Door <code>/0</code> wordt een onbeperkt aantal kinderen toegestaan.</p></div><div class=paragraph><p>Naast <code>max-child</code> zijn er nog twee andere opties waarmee het maximale aantal verbindingen van een bepaalde plaats naar een daemon ingesteld kan worden. <code>max-connections-per-ip-per-minute</code> beperkt het aantal verbindingen per minuut voor enig IP-adres, een waarde van tien betekent hier dat er van ieder IP-adres maximaal tien verbindingen naar een bepaalde dienst tot stand gebracht kunnen worden. <code>max-child-per-ip</code> beperkt het aantal kindprocessen dat namens enig IP-adres op enig moment gestart kan worden. Deze opties kunnen zijn nuttig om bedoeld en onbedoeld buitensporig bronnengebruik van en Denial of Service (DoS) aanvallen op een machine te voorkomen.</p></div><div class=paragraph><p>In dit veld is één van <code>wait</code> of <code>nowait</code> verplicht. <code>max-child</code>, <code>max-connections-per-ip-per-minute</code> en <code>max-child-per-ip</code> zijn optioneel.</p></div><div class=paragraph><p>Een stream-type multi-threaded daemon zonder één van de limieten <code>max-child</code>, <code>max-connections-per-ip-per-minute</code> of <code>max-child-per-ip</code> is eenvoudigweg: <code>nowait</code>.</p></div><div class=paragraph><p>Dezelfde daemon met een maximale limiet van tien daemons zou zijn: <code>nowait/10</code>.</p></div><div class=paragraph><p>Dezelfde instellingen met een limiet van twintig verbindingen per IP-adres per minuut en een totaal maximum van tien kinddaemons zou zijn: <code>nowait/10/20</code>.</p></div><div class=paragraph><p>Deze opties worden allemaal gebruikt door de standaardinstellingen van de daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=fingerd&amp;sektion=8&amp;format=html">fingerd(8)</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>finger stream  tcp     nowait/3/10 nobody /usr/libexec/fingerd fingerd -s</pre></div></div><div class=paragraph><p>Als afsluiting, een voorbeeld in dit veld met een maximum van 100 kinderen in totaal, met een maximum van 5 voor enig IP-adres zou zijn: <code>nowait/100/0/5</code>.</p></div></dd><dt class=hdlist1>user</dt><dd><p>Dit is de gebruikersnaam waar een daemon onder draait. Daemons draaien meestal als de gebruiker <code>root</code>. Om veiligheidsredenen draaien sommige daemons onder de gebruiker <code>daemon</code> of de gebruiker met de minste rechten: <code>nobody</code>.</p></dd><dt class=hdlist1>server-program</dt><dd><p>Het volledige pad van de daemon die uitgevoerd moet worden als er een verbinding wordt ontvangen. Als de daemon een dienst is die door inetd intern wordt geleverd, dan moet de optie <code>internal</code> gebruikt worden.</p></dd><dt class=hdlist1>server-program-arguments</dt><dd><p>Deze optie werkt samen met de optie <code>server-program</code> en hierin worden de argumenten ingesteld, beginnend met <code>argv[0]</code>, die bij het starten aan de daemon worden meegegeven. Als <code>mijndaemon -d</code> de commandoregel is, dan zou <code>mijndaemon -d</code> de waarde van <code>server-program-arguments</code> zijn. Hier geldt ook dat als de daemon een interne dienst is, hier de optie <code>internal</code> moet worden.</p></dd></dl></div></div><div class=sect3><h4 id=network-inetd-security>29.2.5. Beveiliging<a class=anchor href=#network-inetd-security></a></h4><div class=paragraph><p>Afhankelijk van keuzes gemaakt tijdens de installatie, kunnen veel van de diensten van inetd standaard ingeschakeld zijn. Het is verstandig te overwegen om een daemon dat niet noodzakelijk is uit te schakelen. Plaats een <code>#</code> voor de daemon in <span class=filename>/etc/inetd.conf</span> en <a href=#network-inetd-reread>herlaad vervolgens de instellingen van inetd</a>. Sommige daemons, zoals fingerd, zijn wellicht helemaal niet gewenst omdat ze informatie geven die nuttig kan zijn voor een aanvaller.</p></div><div class=paragraph><p>Sommige daemons zijn zich niet echt bewust van beveiliging en hebben lange of niet bestaande timeouts voor verbindingspogingen. Hierdoor kan een aanvaller langzaam veel verbindingen maken met een daemon en zo beschikbare bronnen verzadigen. Het is verstandig voor die daemons de limietopties <code>max-connections-per-ip-per-minute</code>, <code>max-child</code> of <code>max-child-per-ip</code> te gebruiken als ze naar uw smaak teveel verbindingen hebben.</p></div><div class=paragraph><p>TCP-wrapping staat standaard aan. Er staat meer informatie over het zetten van TCP-restricties op de verschillende daemons die door inetd worden aangesproken in <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a>.</p></div></div><div class=sect3><h4 id=network-inetd-misc>29.2.6. Allerlei<a class=anchor href=#network-inetd-misc></a></h4><div class=paragraph><p>daytime, time, echo, discard, chargen en auth zijn allemaal interne diensten van inetd.</p></div><div class=paragraph><p>De dienst auth biedt identiteitsnetwerkdiensten en is tot op een bepaald niveau instelbaar, terwijl de anderen eenvoudigweg aan of uit staan.</p></div><div class=paragraph><p>Meer diepgaande informatie staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a>.</p></div></div></div><div class=sect2><h3 id=network-nfs>29.3. Netwerkbestandssysteem (NFS)<a class=anchor href=#network-nfs></a></h3><div class=paragraph><p>Het Netwerkbestandssysteem (Network File System) is een van de vele bestandssystemen die FreeBSD ondersteunt. Het staat ook wel bekend als NFS. Met NFS is het mogelijk om mappen en bestanden met anderen in een netwerk te delen. Door het gebruik van NFS kunnen gebruikers en programma’s bij bestanden op andere systemen op bijna dezelfde manier als bij hun eigen lokale bestanden.</p></div><div class=paragraph><p>De grootste voordelen van NFS zijn:</p></div><div class=ulist><ul><li><p>Lokale werkstations gebruiken minder schijfruimte omdat veel gebruikte data op één machine opgeslagen kan worden en nog steeds toegankelijk is voor gebruikers via het netwerk;</p></li><li><p>Gebruikers hoeven niet op iedere machine een thuismap te hebben. Thuismappen kunnen op de NFS server staan en op het hele netwerk beschikbaar zijn;</p></li><li><p>Opslagapparaten als floppydisks, CD-ROM drives en Zip® drives kunnen door andere machines op een netwerk gebruikt worden. Hierdoor kan het aantal drives met verwijderbare media in een netwerk verkleind worden.</p></li></ul></div><div class=sect3><h4 id=_hoe_nfs_werkt>29.3.1. Hoe NFS werkt<a class=anchor href=#_hoe_nfs_werkt></a></h4><div class=paragraph><p>NFS bestaat uit tenminste twee hoofdonderdelen: een server en een of meer cliënten. De cliënt benadert de gegevens die op een servermachine zijn opgeslagen via een netwerk. Om dit mogelijk te maken moeten er een aantal processen ingesteld en gestart worden.</p></div><div class=paragraph><p>Op de server moeten de volgende daemons draaien:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Daemon</th><th class="tableblock halign-left valign-top">Beschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>nfsd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De NFS-daemon die verzoeken van de NFS cliënten afhandelt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>mountd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De NFS koppeldaemon die doorgestuurde verzoeken van <a href="https://man.freebsd.org/cgi/man.cgi?query=nfsd&amp;sektion=8&amp;format=html">nfsd(8)</a> uitvoert.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rpcbind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Deze daemon geeft voor NFS-cliënten aan welke poort de NFS-server gebruikt.</p></td></tr></tbody></table><div class=paragraph><p>Op de cliënt kan ook een daemon draaien: nfsiod. De daemon nfsiod handelt verzoeken van de NFS-server af. Dit is optioneel en kan de prestaties verbeteren, maar het is niet noodzakelijk voor een normale en correcte werking. Meer informatie staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=nfsiod&amp;sektion=8&amp;format=html">nfsiod(8)</a>.</p></div></div><div class=sect3><h4 id=network-configuring-nfs>29.3.2. NFS instellen<a class=anchor href=#network-configuring-nfs></a></h4><div class=paragraph><p>NFS instellen gaat redelijk rechtlijnig. Alle processen die moeten draaien kunnen meestarten bij het opstarten door een paar wijzigingen in <span class=filename>/etc/rc.conf</span>.</p></div><div class=paragraph><p>Op de NFS server dienen de volgende opties in <span class=filename>/etc/rc.conf</span> te staan:</p></div><div class="literalblock programlisting"><div class=content><pre>rpcbind_enable=&#34;YES&#34;
nfs_server_enable=&#34;YES&#34;
mountd_flags=&#34;-r&#34;</pre></div></div><div class=paragraph><p>mountd start automatisch als de NFS server is ingeschakeld.</p></div><div class=paragraph><p>Op de cliënt dient de volgende optie in <span class=filename>/etc/rc.conf</span> te staan:</p></div><div class="literalblock programlisting"><div class=content><pre>nfs_client_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>In het bestand <span class=filename>/etc/exports</span> staat beschreven welke bestandssystemen NFS moet exporteren (soms heet dat ook wel delen of "sharen"). Iedere regel in <span class=filename>/etc/exports</span> slaat op een bestandssysteem dat wordt geëxporteerd en welke machines toegang hebben tot dat bestandssysteem. Samen met machines die toegang hebben, kunnen ook toegangsopties worden aangegeven. Er zijn veel opties beschikbaar, maar hier worden er maar een paar beschreven. Alle opties staan beschreven in <a href="https://man.freebsd.org/cgi/man.cgi?query=exports&amp;sektion=5&amp;format=html">exports(5)</a>.</p></div><div class=paragraph><p>Nu volgen een aantal voorbeelden voor <span class=filename>/etc/exports</span>:</p></div><div class=paragraph><p>Het volgende voorbeeld geeft een beeld van hoe een bestandssysteem te exporteren, hoewel de instellingen afhankelijk zijn van de omgeving en het netwerk. Om bijvoorbeeld de map <span class=filename>/cdrom</span> te exporteren naar drie machines die dezelfde domeinnaam hebben als de server (vandaar dat de machinenamen geef domeinachtervoegsel hebben) of in <span class=filename>/etc/hosts</span> staan. De vlag <code>-ro</code> exporteert het bestandssysteem als alleen-lezen. Door die vlag kan een ander systeem niet schrijven naar het geëxporteerde bestandssysteem.</p></div><div class="literalblock programlisting"><div class=content><pre>/cdrom -ro host1 host2 host3</pre></div></div><div class=paragraph><p>Het volgende voorbeeld exporteert <span class=filename>/home</span> naar drie hosts op basis van IP-adres. Dit heeft zin als er een privaat netwerk bestaat, zonder dat er een DNS server is ingesteld. Optioneel kan <span class=filename>/etc/hosts</span> gebruikt worden om interne hostnamen in te stellen. Er is meer informatie te vinden in <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts&amp;sektion=5&amp;format=html">hosts(5)</a>. Met de vlag <code>-alldirs</code> mogen submappen ook koppelpunten zijn. De submap wordt dan niet feitelijk aangekoppeld, maar de cliënt koppelt dan alleen de submappen aan die verplicht of nodig zijn.</p></div><div class="literalblock programlisting"><div class=content><pre>/home  -alldirs  10.0.0.2 10.0.0.3 10.0.0.4</pre></div></div><div class=paragraph><p>Het volgende voorbeeld exporteert <span class=filename>/a</span> zo dat twee cliënten uit verschillende domeinen bij het bestandssysteem mogen. Met de vlag <code>-maproot=root</code> mag de gebruiker op het andere systeem gegevens naar het geëxporteerde bestandssysteem schrijven als <code>root</code>. Als de vlag <code>-maproot=root</code> niet wordt gebruikt, dan kan een gebruiker geen bestanden wijzigen op het geëxporteerde bestandssysteem, zelfs niet als een gebruiker daar <code>root</code> is.</p></div><div class="literalblock programlisting"><div class=content><pre>/a  -maproot=root  host.example.com box.example.org</pre></div></div><div class=paragraph><p>Om een cliënt toegang te geven tot een geëxporteerd bestandssysteem, moet die cliënt daar rechten voor hebben. De cliënt moet daarvoor genoemd worden in <span class=filename>/etc/exports</span>.</p></div><div class=paragraph><p>In <span class=filename>/etc/exports</span> staat iedere regel voor de exportinformatie van één bestandssysteem naar één host. Per bestandssysteem mag een host maar één keer genoemd worden en mag maar één standaard hebben. Stel bijvoorbeeld dat <span class=filename>/usr</span> een enkel bestandssysteem is. Dan is de volgende <span class=filename>/etc/exports</span> niet geldig:</p></div><div class="literalblock programlisting"><div class=content><pre># Werkt niet als /usr 1 bestandssysteem is
/usr/src   client
/usr/ports client</pre></div></div><div class=paragraph><p>Eén bestandssysteem, <span class=filename>/usr</span>, heeft twee regels waarin exports naar dezelfde host worden aangegeven, <code>client</code>. In deze situatie is de juiste instelling:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr/src /usr/ports  client</pre></div></div><div class=paragraph><p>De eigenschappen van een bestandssysteem dat naar een bepaalde host wordt geëxporteerd moeten allemaal op één regel staan. Regels waarop geen cliënt wordt aangegeven worden behandeld als een enkele host. Dit beperkt hoe bestandssysteem geëxporteerd kunnen worden, maar dat blijkt meestal geen probleem te zijn.</p></div><div class=paragraph><p>Het volgende voorbeeld is een geldige exportlijst waar <span class=filename>/usr</span> en <span class=filename>/exports</span> lokale bestandssystemen zijn:</p></div><div class="literalblock programlisting"><div class=content><pre># Exporteer src en ports naar client01 en client02,
# maar alleen client01 heeft er rootprivileges
/usr/src /usr/ports -maproot=root    client01
/usr/src /usr/ports               client02
# De cliëntmachines hebben rootrechten en kunnen overal aankoppelen
# op /exports. Iedereen in de wereld kan /exports/obj als alleen-lezen aankoppelen.
/exports -alldirs -maproot=root      client01 client02
/exports/obj -ro</pre></div></div><div class=paragraph><p>De daemon mountd moet gedwongen worden om het bestand <span class=filename>/etc/exports</span> te controleren steeds wanneer het is aangepast, zodat de veranderingen effectief kunnen worden. Dit kan worden bereikt door òfwel een HUP-signaal naar de draaiende daemon te sturen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -HUP `cat /var/run/mountd.pid`</span></code></pre></div></div><div class=paragraph><p>of door het <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> script <code>mountd</code> met de juiste parameter aan te roepen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service mountd onereload</span></code></pre></div></div><div class=paragraph><p>Raadpleeg <a href=./#configtuning-rcd>Gebruik van rc met FreeBSD</a> voor meer informatie over het gebruik van rc-scripts.</p></div><div class=paragraph><p>Het is ook mogelijk een machine te herstarten, zodat FreeBSD alles netjes in kan stellen, maar dat is niet nodig. Het uitvoeren van de volgende commando’s als <code>root</code> hoort hetzelfde resultaat te hebben.</p></div><div class=paragraph><p>Op de NFS server:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rpcbind</span>
<span class=c># nfsd -u -t -n 4</span>
<span class=c># mountd -r</span></code></pre></div></div><div class=paragraph><p>Op de NFS cliënt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># nfsiod -n 4</span></code></pre></div></div><div class=paragraph><p>Nu is alles klaar om feitelijk het netwerkbestandssysteem aan te koppelen. In de volgende voorbeelden is de naam van de server <code>server</code> en de naam van de cliënt is <code>client</code>. Om een netwerkbestandssysteem slechts tijdelijk aan te koppelen of om alleen te testen, kan een commando als het onderstaande als <code>root</code> op de cliënt uitgevoerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount server:/home /mnt</span></code></pre></div></div><div class=paragraph><p>Hiermee wordt de map <span class=filename>/home</span> op de server aangekoppeld op <span class=filename>/mnt</span> op de cliënt. Als alles juist is ingesteld, zijn nu in <span class=filename>/mnt</span> op de cliënt de bestanden van de server zichtbaar.</p></div><div class=paragraph><p>Om een netwerkbestandssysteem iedere keer als een computer opstart aan te koppelen, kan het bestandssysteem worden toegevoegd aan het bestand <span class=filename>/etc/fstab</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>server:/home	/mnt	nfs	rw	0	0</pre></div></div><div class=paragraph><p>Alle beschikbare opties staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a>.</p></div></div><div class=sect3><h4 id=_op_slot_zetten>29.3.3. Op slot zetten<a class=anchor href=#_op_slot_zetten></a></h4><div class=paragraph><p>Voor sommige applicaties (b.v. mutt) is het nodig dat bestanden op slot staan om correct te werken. In het geval van NFS, kan rpc.lockd worden gebruikt voor het op slot zetten van bestanden. Voeg het volgende toe aan het bestand <span class=filename>/etc/rc.conf</span> op zowel de cliënt als de server om het aan te zetten (het wordt aangenomen dat de NFS-cliënt en -server reeds zijn geconfigureerd):</p></div><div class="literalblock programlisting"><div class=content><pre>rpc_lockd_enable=&#34;YES&#34;
rpc_statd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Start de applicatie met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service lockd start</span>
<span class=c># service statd start</span></code></pre></div></div><div class=paragraph><p>Als echt op slot zetten tussen de NFS-cliënten en de NFS-server niet nodig is, is het mogelijk om de NFS-cliënt bestanden lokaal op slot te laten zetten door <code>-L</code> aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8&amp;format=html">mount_nfs(8)</a> door te geven. In de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8&amp;format=html">mount_nfs(8)</a> staan verdere details.</p></div></div><div class=sect3><h4 id=_mogelijkheden_voor_gebruik>29.3.4. Mogelijkheden voor gebruik<a class=anchor href=#_mogelijkheden_voor_gebruik></a></h4><div class=paragraph><p>NFS is voor veel doeleinden in te zetten. Een aantal voorbeelden:</p></div><div class=ulist><ul><li><p>Een aantal machines een CD-ROM of andere media laten delen. Dat is goedkoper en vaak ook handiger, bijvoorbeeld bij het installeren van software op meerdere machines;</p></li><li><p>Op grote netwerken kan het praktisch zijn om een centrale NFS server in te richten, waarop alle thuismappen staan. Die thuismappen kunnen dan geëxporteerd worden, zodat gebruikers altijd dezelfde thuismap hebben, op welk werkstation ze ook aanmelden;</p></li><li><p>Meerdere machines kunnen een gezamenlijke map <span class=filename>/usr/ports/distfiles</span> hebben. Dan is het mogelijk om een port op meerdere machines te installeren, zonder op iedere machine de broncode te hoeven downloaden.</p></li></ul></div></div><div class=sect3><h4 id=network-amd>29.3.5. Automatisch aankoppelen met amd<a class=anchor href=#network-amd></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a> (de automatic mounter daemon) koppelt automatisch netwerkbestandssystemen aan als er aan een bestand of map binnen dat bestandssysteem wordt gerefereerd. amd ontkoppelt ook bestandssystemen die een bepaalde tijd niet gebruikt worden. Het gebruikt van amd is een aantrekkelijk en eenvoudig alternatief ten opzichte van permanente koppelingen, die meestal in <span class=filename>/etc/fstab</span> staan.</p></div><div class=paragraph><p>amd werkt door zichzelf als NFS-server te koppelen aan de mappen <span class=filename>/host</span> en <span class=filename>/net</span>. Als binnen die mappen een bestand wordt geraadpleegd, dan zoekt amd de bijbehorende netwerkkoppeling op en koppelt die automatisch aan. <span class=filename>/net</span> wordt gebruikt om een geëxporteerd bestandssysteem van een IP-adres aan te koppelen, terwijl <span class=filename>/host</span> wordt gebruikt om een geëxporteerd bestandssysteem van een hostnaam aan te koppelen.</p></div><div class=paragraph><p>Het raadplegen van een bestand in <span class=filename>/host/foobar/usr</span> geeft amd aan dat die moet proberen de <span class=filename>/usr</span> export op de host <code>foobar</code> aan te koppelen.</p></div><div class=exampleblock><div class=title>Voorbeeld 34. Een export aankoppelen met amd</div><div class=content><div class=paragraph><p>De beschikbare koppelingen van een netwerkhost zijn te bekijken met <code>showmount</code>. Om bijvoorbeeld de koppelingen van de host <code>foobar</code> te bekijken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% showmount <span class=nt>-e</span> foobar
Exports list on foobar:
/usr                               10.10.10.0
/a                                 10.10.10.0
% <span class=nb>cd</span> /host/foobar/usr</code></pre></div></div></div></div><div class=paragraph><p>Zoals in het bovenstaande voorbeeld te zien is, toont <code>showmount</code><span class=filename>/usr</span> als een export. Als er naar de map <span class=filename>/host/foobar/usr</span> wordt gegaan, probeert amd de hostnaam <code>foobar</code> te resolven en de gewenste export automatisch aan te koppelen.</p></div><div class=paragraph><p>amd kan gestart worden door de opstartscript door de volgende regel in <span class=filename>/etc/rc.conf</span> te plaatsen:</p></div><div class="literalblock programlisting"><div class=content><pre>amd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Er kunnen ook nog opties meegegeven worden aan amd met de optie <code>amd_flags</code>. Standaard staat <code>amd_flags</code> ingesteld op:</p></div><div class="literalblock programlisting"><div class=content><pre>amd_flags=&#34;-a /.amd_mnt -l syslog /host /etc/amd.map /net /etc/amd.map&#34;</pre></div></div><div class=paragraph><p>In het bestand <span class=filename>/etc/amd.map</span> staan de standaardinstellingen waarmee exports aangekoppeld worden. In het bestand <span class=filename>/etc/amd.conf</span> staan een aantal van de meer gevorderde instellingen van amd.</p></div><div class=paragraph><p>In <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=amd.conf&amp;sektion=8&amp;format=html">amd.conf(8)</a> staat meer informatie.</p></div></div><div class=sect3><h4 id=network-nfs-integration>29.3.6. Problemen bij samenwerking met andere systemen<a class=anchor href=#network-nfs-integration></a></h4><div class=paragraph><p>Bepaalde Ethernet adapters voor ISA PC systemen kennen limieten die tot serieuze netwerkproblemen kunnen leiden, in het bijzonder met NFS. Dit probleem is niet specifiek voor FreeBSD, maar het kan op FreeBSD wel voor komen.</p></div><div class=paragraph><p>Het probleem ontstaat bijna altijd als (FreeBSD) PC-systemen netwerken met hoog presterende werkstations, zoals van Silicon Graphics, Inc. en Sun Microsystems, Inc. De NFS-koppeling werkt prima en wellicht lukken een aantal acties ook, maar dan ineens lijkt de server niet meer te reageren voor de cliënt, hoewel verzoeken van en naar andere systemen gewoon verwerkt worden. Dit gebeurt op een cliëntsysteem, of de cliënt nu het FreeBSD systeem is of het werkstation. Op veel systemen is er geen manier om de cliënt netjes af te sluiten als dit probleem is ontstaan. Vaak is de enige mogelijkheid een reset van de cliënt, omdat het probleem met NFS niet opgelost kan worden.</p></div><div class=paragraph><p>Hoewel de enige "correcte" oplossing de aanschaf van een snellere en betere Ethernet adapter voor het FreeBSD systeem is, is er zo om het probleem heen te werken dat het werkbaar is. Als FreeBSD de <em>server</em> is, kan de optie <code>-w=1024</code> gebruikt worden bij het aankoppelen door de cliënt. Als het FreeBSD systeem de <em>cliënt</em> is, dan dient het NFS-bestandssysteem aangekoppeld te worden met de optie <code>r=1024</code>. Deze opties kunnen het vierde veld zijn in een regel in <span class=filename>fstab</span> voor automatische aankoppelingen en bij handmatige aankoppelingen met <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> kan de parameter <code>-o</code> gebruikt worden.</p></div><div class=paragraph><p>Soms wordt een ander probleem voor dit probleem versleten, als servers en cliënten zich op verschillende netwerken bevinden. Als dat het geval is, dan dient <em>vastgesteld</em> te worden dat routers de UDP informatie op de juiste wijze routeren, omdat er anders nooit NFS-verkeer gerouteerd kan worden.</p></div><div class=paragraph><p>In de volgende voorbeelden is <code>fastws</code> de host(interface)naam van een hoog presterend werkstation en <code>freebox</code> is de host(interface)naam van een FreeBSD systeem met een Ethernet adapter die mindere prestaties levert. <span class=filename>/sharedfs</span> wordt het geëxporteerde NFS-bestandssysteem (zie <a href="https://man.freebsd.org/cgi/man.cgi?query=exports&amp;sektion=5&amp;format=html">exports(5)</a>) en <span class=filename>/project</span> wordt het koppelpunt voor het geëxporteerde bestandssysteem op de cliënt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In sommige gevallen kunnen applicaties beter draaien als extra opties als <code>hard</code> of <code>soft</code> en <code>bg</code> gebruikt worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Voorbeelden voor het FreeBSD systeem (<code>freebox</code>) als de cliënt in <span class=filename>/etc/fstab</span> op <code>freebox</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>fastws:/sharedfs /project nfs rw,-r=1024 0 0</pre></div></div><div class=paragraph><p>Als een handmatig aankoppelcommando op <code>freebox</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t nfs -o -r=1024 fastws:/sharedfs /project</span></code></pre></div></div><div class=paragraph><p>Voorbeelden voor het FreeBSD systeem als de server in <span class=filename>/etc/fstab</span> op <code>fastws</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>freebox:/sharedfs /project nfs rw,-w=1024 0 0</pre></div></div><div class=paragraph><p>Als een handmatig aankoppelcommando op <code>fastws</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t nfs -o -w=1024 freebox:/sharedfs /project</span></code></pre></div></div><div class=paragraph><p>Bijna iedere 16-bit Ethernet adapter werkt zonder de hierboven beschreven restricties op de lees- en schrijfgrootte.</p></div><div class=paragraph><p>Voor wie het wil weten wordt nu beschreven wat er gebeurt als de fout ontstaan, wat ook duidelijk maakt waarom het niet hersteld kan worden. NFS werkt meestal met een "block"grootte van 8 K (hoewel het mogelijk is dat er kleinere fragmenten worden verwerkt). Omdat de maximale grootte van een Ethernet pakket rond de 1500 bytes ligt, wordt een "block" opgesplitst in meerdere Ethernetpakketten, hoewel het hoger in de code nog steeds één eenheid is, en wordt ontvangen, samengevoegd en <em>bevestigd</em> als een eenheid. De hoog presterende werkstations kunnen de pakketten waaruit een NFS-eenheid bestaat bijzonder snel naar buiten pompen. Op de kaarten met minder capaciteit worden de eerdere pakketten door de latere pakketten van dezelfde eenheid ingehaald voordat ze bij die host zijn aangekomen en daarom kan de eenheid niet worden samengesteld en bevestigd. Als gevolg daarvan ontstaat er op het werkstation een timeout en probeert die de eenheid opnieuw te sturen, maar dan weer de hele eenheid van 8 K, waardoor het proces wordt herhaald, ad infinitum.</p></div><div class=paragraph><p>Door de grootte van de eenheid kleiner te houden dan de grootte van een Ethernet pakket, is het zeker dat elk Ethernetpakket dat compleet is aangekomen bevestigd kan worden, zodat de deadlock niet ontstaat.</p></div><div class=paragraph><p>Toch kan een PC systeem nog wel overrompeld worden als hoog presterende werkstations er op inhakken, maar met de betere netwerkkaarten valt het dan in ieder geval niet om door de NFS "eenheden". Als het systeem toch wordt overrompeld, dan worden de betrokken eenheden opnieuw verstuurd en dan is de kans groot dat ze worden ontvangen, samengevoegd en bevestigd.</p></div></div></div><div class=sect2><h3 id=network-nis>29.4. Netwerkinformatiesysteem (NIS/YP)<a class=anchor href=#network-nis></a></h3><div class=sect3><h4 id=_wat_is_het>29.4.1. Wat is het?<a class=anchor href=#_wat_is_het></a></h4><div class=paragraph><p>NIS, dat staat voor Netwerkinformatiediensten (Network Information Services), is ontwikkeld door Sun Microsystems om het beheer van UNIX® (origineel SunOS™) systemen te centraliseren. Tegenwoordig is het eigenlijk een industriestandaard geworden. Alle grote UNIX® achtige systemen (Solaris™, HP-UX, AIX®, Linux®, NetBSD, OpenBSD, FreeBSD, enzovoort) ondersteunen NIS.</p></div><div class=paragraph><p>NIS stond vroeger bekend als Yellow Pages, maar vanwege problemen met het handelsmerk heeft Sun de naam veranderd. De oude term, en yp, wordt nog steeds vaak gebruikt.</p></div><div class=paragraph><p>Het is een op RPC-gebaseerd cliënt/serversysteem waarmee een groep machines binnen een NIS-domein een gezamenlijke verzameling met instellingenbestanden kan delen. Hierdoor kan een beheerder NIS-systemen opzetten met een minimaal aantal instellingen en vanaf een centrale lokatie instellingen toevoegen, verwijderen en wijzigen.</p></div><div class=paragraph><p>Het is te vergelijken met het Windows NT® domeinsysteem en hoewel de interne implementatie van de twee helemaal niet overeenkomt, is de basisfunctionaliteit vergelijkbaar.</p></div></div><div class=sect3><h4 id=_termen_en_processen_om_te_onthouden>29.4.2. Termen en processen om te onthouden<a class=anchor href=#_termen_en_processen_om_te_onthouden></a></h4><div class=paragraph><p>Er zijn een aantal termen en belangrijke gebruikersprocessen die een rol spelen bij het implementeren van NIS op FreeBSD, zowel bij het maken van een NIS-server als bij het maken van een systeem dan NIS-cliënt is:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Term</th><th class="tableblock halign-left valign-top">Beschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>NIS-domeinnaam</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een NIS-masterserver en al zijn cliënten (inclusief zijn slave master) hebben een NIS-domeinnaam. Vergelijkbaar met een Windows NT® domeinnaam, maar de NIS-domeinnaam heeft niets te maken met DNS.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rpcbind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Moet draaien om RPC (Remote Procedure Call in te schakelen, een netwerkprotocol dat door NIS gebruikt wordt). Als rpcbind niet draait, dan kan er geen NIS-server draaien en kan een machine ook geen NIS-cliënt zijn.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ypbind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>"Verbindt" een NIS-cliënt aan zijn NIS-server. Dat gebeurt door met de NIS-domeinnaam van het systeem en door het gebruik van RPC te verbinden met de server. ypbind is de kern van cliënt-server communicatie in een NIS-omgeving. Als ypbind op een machine stopt, dan kan die niet meer bij de NIS-server komen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ypserv</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Hoort alleen te draaien op NIS-servers. Dit is het NIS-serverproces zelf. Als <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> stopt, dan kan de server niet langer reageren op NIS-verzoeken (hopelijk is er dan een slaveserver om het over te nemen). Er zijn een aantal implementaties van NIS, maar niet die op FreeBSD, die geen verbinding met een andere server proberen te maken als de server waarmee ze verbonden waren niet meer reageert. In dat geval is vaak het enige dat werkt het serverproces herstarten (of zelfs de hele server) of het ypbind-proces op de cliënt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rpc.yppasswdd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nog een proces dat alleen op NIS-masterservers hoort te draaien. Dit is een daemon waarbij NIS-cliënten hun NIS-wachtwoorden kunnen wijzigen. Als deze daemon niet draait, moeten gebruikers zich aanmelden op de NIS-masterserver en daar hun wachtwoord wijzigen.</p></td></tr></tbody></table></div><div class=sect3><h4 id=_hoe_werkt_het_2>29.4.3. Hoe werkt het?<a class=anchor href=#_hoe_werkt_het_2></a></h4><div class=paragraph><p>Er zijn drie typen hosts in een NIS-omgeving: master servers, slaveservers en cliënten. Servers zijn het centrale depot voor instellingen voor een host. Masterservers bevatten de geautoriseerd kopie van die informatie, terwijl slaveservers die informatie spiegelen voor redundantie. Cliënten verlaten zich op de servers om hun die informatie ter beschikking te stellen.</p></div><div class=paragraph><p>Op deze manier kan informatie uit veel bestanden gedeeld worden. De bestanden <span class=filename>master.passwd</span>, <span class=filename>group</span> en <span class=filename>hosts</span> worden meestal via NIS gedeeld. Als een proces op een cliënt informatie nodig heeft die normaliter in een van die lokale bestanden staat, dan vraagt die het in plaats daarvan aan de NIS-servers waarmee hij verbonden is.</p></div><div class=sect4><h5 id=_soorten_machines>29.4.3.1. Soorten machines<a class=anchor href=#_soorten_machines></a></h5><div class=ulist><ul><li><p>Een <em>NIS-masterserver</em>. Deze server onderhoudt, analoog aan een Windows NT® primaire domeincontroller, de bestanden die door alle NIS-cliënten gebruikt worden. De bestanden <span class=filename>passwd</span>, <span class=filename>group</span> en andere bestanden die door de NIS-cliënten gebruikt worden staan op de masterserver.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is mogelijk om één machine master server te laten zijn voor meerdere NIS-domeinen. Dat wordt in deze inleiding echter niet beschreven, omdat die uitgaat van een relatief kleine omgeving.</p></div></td></tr></tbody></table></div></li><li><p><em>NIS-slaveservers</em>. Deze zijn te vergelijken met Windows NT® backup domain controllers. NIS-slaveservers beheren een kopie van de bestanden met gegevens op de NIS-master. NIS-slaveservers bieden redundantie, die nodig is in belangrijke omgevingen. Ze helpen ook om de belasting te verdelen met de master server: NIS-cliënten maken altijd een verbinding met de NIS-server die het eerst reageert en dat geldt ook voor antwoorden van slaveservers.</p></li><li><p><em>NIS-cliënten</em>. NIS-cliënten authenticeren, net als de meeste Windows NT® werkstations, tegen de NIS-server (of de Windows NT® domain controller in het geval van Windows NT® werkstations) bij het aanmelden.</p></li></ul></div></div></div><div class=sect3><h4 id=_nisyp_gebruiken>29.4.4. NIS/YP gebruiken<a class=anchor href=#_nisyp_gebruiken></a></h4><div class=paragraph><p>Dit onderdeel behandelt het opzetten van een NIS-voorbeeldomgeving.</p></div><div class=sect4><h5 id=_plannen>29.4.4.1. Plannen<a class=anchor href=#_plannen></a></h5><div class=paragraph><p>Er wordt uitgegaan van een beheerder van een klein universiteitslab. Dat lab, dat bestaat uit FreeBSD machines, kent op dit moment geen centraal beheer. Iedere machine heeft zijn eigen <span class=filename>/etc/passwd</span> en <span class=filename>/etc/master.passwd</span>. Die bestanden worden alleen met elkaar in lijn gehouden door handmatige handelingen. Als er op dit moment een gebruiker aan het lab wordt toegevoegd, moet <code>adduser</code> op alle 15 machines gedraaid worden. Dat moet natuurlijk veranderen en daarom is besloten het lab in te richten met NIS, waarbij twee machines als server worden gebruikt.</p></div><div class=paragraph><p>Het lab ziet er ongeveer als volgt uit:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Machinenaam</th><th class="tableblock halign-left valign-top">IP-adres</th><th class="tableblock halign-left valign-top">Rol Machine</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ellington</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.2</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>NIS-master</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>coltrane</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.3</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>NIS-slave</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>basie</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.4</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Wetenschappelijk werkstation</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bird</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.5</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Cliënt machine</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cli[1-11]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.[6-17]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Andere cliënt machines</p></td></tr></tbody></table><div class=paragraph><p>Bij het voor de eerste keer instellen van een NIS-schema is het verstandig eerst na te denken over hoe dat opgezet moet worden. Hoe groot een netwerk ook is, er moeten een aantal beslissingen gemaakt worden.</p></div><div class=sect5><h6 id=_een_nis_domeinnaam_kiezen>29.4.4.1.1. Een NIS-domeinnaam kiezen<a class=anchor href=#_een_nis_domeinnaam_kiezen></a></h6><div class=paragraph><p>Dit is wellicht niet de bekende "domeinnaam". Daarom wordt het ook de "NIS-domeinnaam" genoemd. Bij de broadcast van een cliënt om informatie wordt ook de naam van het NIS-domein waar hij onderdeel van uitmaakt meegezonden. Zo kunnen meerdere servers op een netwerk bepalen of er antwoord gegeven dient te worden op een verzoek. De NIS-domeinnaam kan voorgesteld worden als de naam van een groep hosts die op een of andere manier aan elkaar gerelateerd zijn.</p></div><div class=paragraph><p>Sommige organisaties kiezen hun Internet-domeinnaam als NIS-domeinnaam. Dat wordt niet aangeraden omdat het voor verwarring kan zorgen bij het debuggen van netwerkproblemen. De NIS-domeinnaam moet uniek zijn binnen een netwerk en het is handig als die de groep machines beschrijft waarvoor hij geldt. Zo kan bijvoorbeeld de financiële afdeling van Acme Inc. als NIS-domeinnaam "acme-fin" hebben. In dit voorbeeld wordt de naam <code>test-domain</code> gekozen.</p></div><div class=paragraph><p>Sommige besturingssystemen gebruiken echter (met name SunOS™) hun NIS-domeinnaam als hun Internet-domeinnaam. Als er machines zijn op een netwerk die deze restrictie kennen, dan <em>moet</em> de Internet-domeinnaam als de naam voor het NIS-domeinnaam gekozen worden.</p></div></div><div class=sect5><h6 id=_systeemeisen>29.4.4.1.2. Systeemeisen<a class=anchor href=#_systeemeisen></a></h6><div class=paragraph><p>Bij het kiezen van een machine die als NIS-server wordt gebruikt zijn er een aantal aandachtspunten. Een van de onhandige dingen aan NIS is de afhankelijkheid van de cliënten van de server. Als een cliënt de server voor zijn NIS-domein niet kan bereiken, dan wordt die machine vaak onbruikbaar. Door het gebrek aan gebruiker- en groepsinformatie bevriezen de meeste systemen. Daarom moet er een machine gekozen worden die niet vaak herstart hoeft te worden of wordt gebruikt voor ontwikkeling. De NIS-server is in het meest ideale geval een alleenstaande server die als enige doel heeft NIS-server te zijn. Als een netwerk niet zwaar wordt gebruikt, kan de NIS-server op een machine die ook andere diensten aanbiedt gezet worden, maar het blijft belangrijk om ervan bewust te zijn dat als de NIS-server niet beschikbaar is, dat nadelige invloed heeft op <em>alle</em> NIS-cliënten.</p></div></div></div><div class=sect4><h5 id=_nis_servers>29.4.4.2. NIS-servers<a class=anchor href=#_nis_servers></a></h5><div class=paragraph><p>De hoofdversies van alle NIS-informatie staan opgeslagen op één machine die de NIS-masterserver heet. De databases waarin de informatie wordt opgeslagen heten NIS-afbeeldingen. In FreeBSD worden die afbeeldingen opgeslagen in <span class=filename>/var/yp/[domeinnaam]</span> waar <span class=filename>[domeinnaam]</span> de naam is van het NIS-domein dat wordt bediend. Een enkele NIS-server kan tegelijkertijd meerdere NIS-domeinen ondersteunen en het is dus mogelijk dat er meerdere van zulke mappen zijn, een voor ieder ondersteund domein. Ieder domein heeft zijn eigen onafhankelijke verzameling afbeeldingen.</p></div><div class=paragraph><p>In NIS-master- en -slaveservers worden alle NIS-verzoeken door de daemon <code>ypserv</code> afgehandeld. <code>ypserv</code> is verantwoordelijk voor het ontvangen van inkomende verzoeken van NIS-cliënten, het vertalen van de gevraagde domeinnaam en mapnaam naar een pad naar het corresponderende databasebestand en het terugsturen van de database naar de cliënten.</p></div><div class=sect5><h6 id=_een_nis_masterserver_opzetten>29.4.4.2.1. Een NIS-masterserver opzetten<a class=anchor href=#_een_nis_masterserver_opzetten></a></h6><div class=paragraph><p>Het opzetten van een master NIS-server kan erg eenvoudig zijn, afhankelijk van de behoeften. FreeBSD heeft ondersteuning voor NIS als basisfunctie. Alleen de volgende regels hoeven aan <span class=filename>/etc/rc.conf</span> toegevoegd te worden en FreeBSD doet de rest:</p></div><div class="exampleblock procedure"><div class=content><div class="literalblock programlisting"><div class=content><pre>nisdomainname=&#34;test-domain&#34;</pre></div></div><div class="olist arabic"><ol class=arabic><li><p>Deze regel stelt de NIS-domeinnaam in op <code>test-domain</code> bij het instellen van het netwerk (bij het opstarten).</p><div class="literalblock programlisting"><div class=content><pre>nis_server_enable=&#34;YES&#34;</pre></div></div></li><li><p>Dit geeft FreeBSD aan de NIS-serverprocessen te starten als het netwerk de volgende keer wordt opgestart.</p><div class="literalblock programlisting"><div class=content><pre>nis_yppasswdd_enable=&#34;YES&#34;</pre></div></div></li><li><p>Dit schakelt de daemon <code>rpc.yppasswdd</code> in die, zoals al eerder aangegeven, cliënten toestaat om hun NIS-wachtwoord vanaf een cliënt-machine te wijzigen.</p></li></ol></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Afhankelijk van de inrichting van NIS, kunnen er nog meer instellingen nodig zijn. In het onderdeel <a href=#network-nis-server-is-client>NIS-servers die ook NIS-cliënten zijn</a> staan meer details.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Draai na het instellen van bovenstaande regels het commando <code>/etc/netstart</code> als supergebruiker. Het zal alles voor u instellen, gebruikmakende van de waarden die u in <span class=filename>/etc/rc.conf</span> heeft ingesteld. Start als laatste stap, voor het initialiseren van de NIS-afbeeldingen, de daemon ypserv handmatig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service ypserv start</span></code></pre></div></div></div><div class=sect5><h6 id=_nis_afbeeldingen_initialiseren>29.4.4.2.2. NIS-afbeeldingen initialiseren<a class=anchor href=#_nis_afbeeldingen_initialiseren></a></h6><div class=paragraph><p>Die <em>NIS-afbeeldingen</em> zijn databasebestanden die in de map <span class=filename>/var/yp</span> staan. Ze worden gemaakt uit de bestanden met instellingen uit de map <span class=filename>/etc</span> van de NIS-master, met één uitzondering: <span class=filename>/etc/master.passwd</span>. Daar is een goede reden voor, want het is niet wenselijk om de wachtwoorden voor <code>root</code> en andere administratieve accounts naar alle servers in het NIS-domein te sturen. Daar moet voor het initialiseren van de NIS-afbeeldingen het volgende uitgevoerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp /etc/master.passwd /var/yp/master.passwd</span>
<span class=c># cd /var/yp</span>
<span class=c># vi master.passwd</span></code></pre></div></div><div class=paragraph><p>Dan horen alle systeemaccounts verwijderd te worden (<code>bin</code>, <code>tty</code>, <code>kmem</code>, <code>games</code>, enzovoort) en alle overige accounts waarvoor het niet wenselijk is dat ze op de NIS-cliënten terecht komen (bijvoorbeeld <code>root</code> en alle andere UID 0 (supergebruiker) accounts).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><span class=filename>/var/yp/master.passwd</span> hoort niet te lezen te zijn voor een groep of voor de wereld (dus modus 600)! Voor het aanpassen van de rechten kan <code>chmod</code> gebruikt worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als dat is gedaan, kunnen de NIS-afbeeldingen geïnitialiseerd worden. Bij FreeBSD zit een script <code>ypinit</code> waarmee dit kan (in de hulppagina staat meer informatie). Dit script is beschikbaar op de meeste UNIX® besturingssystemen, maar niet op allemaal. Op Digital UNIX/Compaq Tru64 UNIX heet het <code>ypsetup</code>. Omdat er afbeeldingen voor een NIS-master worden gemaakt, wordt de optie <code>-m</code> meegegeven aan <code>ypinit</code>. Aangenomen dat de voorgaande stappen zijn uitgevoerd, kunnen de NIS-afbeeldingen gemaakt worden op de volgende manier:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# ypinit <span class=nt>-m</span> test-domain
Server Type: MASTER Domain: test-domain
Creating an YP server will require that you answer a few questions.
Questions will all be asked at the beginning of the procedure.
Do you want this procedure to quit on non-fatal errors? <span class=o>[</span>y/n: n] n
Ok, please remember to go back and redo manually whatever fails.
If you don<span class=s1>&#39;t, something might not work.
At this point, we have to construct a list of this domains YP servers.
rod.darktech.org is already known as master server.
Please continue to add any slave servers, one per line. When you are
done with the list, type a &lt;control D&gt;.
master server   :  ellington
next host to add:  coltrane
next host to add:  ^D
The current list of NIS servers looks like this:
ellington
coltrane
Is this correct?  [y/n: y] y

[..uitvoer van het maken van de afbeeldingen..]

NIS Map update completed.
ellington has been setup as an YP master server without any errors.</span></code></pre></div></div><div class=paragraph><p><code>ypinit</code> hoort <span class=filename>/var/yp/Makefile</span> gemaakt te hebben uit <span class=filename>/var/yp/Makefile.dist</span>. Als dit bestand is gemaakt, neemt dat bestand aan dat er in een omgeving met een enkele NIS-server wordt gewerkt met alleen FreeBSD-machines. Omdat <code>test-domain</code> ook een slaveserver bevat, dient <span class=filename>/var/yp/Makefile</span> gewijzigd te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# vi /var/yp/Makefile</code></pre></div></div><div class=paragraph><p>Als de onderstaande regel niet al uitgecommentarieerd is, dient dat alsnog te gebeuren:</p></div><div class="literalblock programlisting"><div class=content><pre>NOPUSH = &#34;True&#34;</pre></div></div></div><div class=sect5><h6 id=_een_nis_slaveserver_opzetten>29.4.4.2.3. Een NIS-slaveserver opzetten<a class=anchor href=#_een_nis_slaveserver_opzetten></a></h6><div class=paragraph><p>Het opzetten van een NIS-slaveserver is nog makkelijker dan het opzetten van de master. Dit kan door aan te melden op de slaveserver en net als voor de masterserver <span class=filename>/etc/rc.conf</span> te wijzigen. Het enige verschil is dat nu de optie <code>-s</code> gebruikt wordt voor het draaien van <code>ypinit</code>. Met de optie <code>-s</code> moet ook de naam van de NIS-master meegegeven worden. Het commando ziet er dus als volgt uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>coltrane# ypinit <span class=nt>-s</span> ellington test-domain

Server Type: SLAVE Domain: test-domain Master: ellington

Creating an YP server will require that you answer a few questions.
Questions will all be asked at the beginning of the procedure.

Do you want this procedure to quit on non-fatal errors? <span class=o>[</span>y/n: n]  n

Ok, please remember to go back and redo manually whatever fails.
If you don<span class=s1>&#39;t, something might not work.
There will be no further questions. The remainder of the procedure
should take a few minutes, to copy the databases from ellington.
Transferring netgroup...
ypxfr: Exiting: Map successfully transferred
Transferring netgroup.byuser...
ypxfr: Exiting: Map successfully transferred
Transferring netgroup.byhost...
ypxfr: Exiting: Map successfully transferred
Transferring master.passwd.byuid...
ypxfr: Exiting: Map successfully transferred
Transferring passwd.byuid...
ypxfr: Exiting: Map successfully transferred
Transferring passwd.byname...
ypxfr: Exiting: Map successfully transferred
Transferring group.bygid...
ypxfr: Exiting: Map successfully transferred
Transferring group.byname...
ypxfr: Exiting: Map successfully transferred
Transferring services.byname...
ypxfr: Exiting: Map successfully transferred
Transferring rpc.bynumber...
ypxfr: Exiting: Map successfully transferred
Transferring rpc.byname...
ypxfr: Exiting: Map successfully transferred
Transferring protocols.byname...
ypxfr: Exiting: Map successfully transferred
Transferring master.passwd.byname...
ypxfr: Exiting: Map successfully transferred
Transferring networks.byname...
ypxfr: Exiting: Map successfully transferred
Transferring networks.byaddr...
ypxfr: Exiting: Map successfully transferred
Transferring netid.byname...
ypxfr: Exiting: Map successfully transferred
Transferring hosts.byaddr...
ypxfr: Exiting: Map successfully transferred
Transferring protocols.bynumber...
ypxfr: Exiting: Map successfully transferred
Transferring ypservers...
ypxfr: Exiting: Map successfully transferred
Transferring hosts.byname...
ypxfr: Exiting: Map successfully transferred

coltrane has been setup as an YP slave server without any errors.
Don&#39;</span>t forget to update map ypservers on ellington.</code></pre></div></div><div class=paragraph><p>Nu hoort er een map <span class=filename>/var/yp/test-domain</span> te zijn waarin kopieë van de NIS-masterserver afbeeldingen staan. Die moeten bijgewerkt blijven. De volgende regel in <span class=filename>/etc/crontab</span> op de slaveservers regelt dat:</p></div><div class="literalblock programlisting"><div class=content><pre>20      *       *       *       *       root   /usr/libexec/ypxfr passwd.byname
21      *       *       *       *       root   /usr/libexec/ypxfr passwd.byuid</pre></div></div><div class=paragraph><p>Met de bovenstaande twee regels wordt de slave gedwongen zijn afbeeldingen met de afbeeldingen op de masterserver te synchroniseren. Dit is niet verplicht omdat de masterserver automatisch probeert veranderingen aan de NIS-afbeeldingen door te geven aan zijn slaves. Echter, vanwege het belang van correcte wachtwoordinformatie op andere cliënten die van de slaveserver afhankelijk zijn, is het aanbevolen om specifiek de wachtwoordafbeeldingen vaak tot bijwerken te dwingen. Dit is des te belangrijker op drukke netwerken, omdat daar het bijwerken van afbeeldingen niet altijd compleet afgehandeld hoeft te worden.</p></div><div class=paragraph><p>Nu kan ook op de slaveserver het commando <code>/etc/netstart</code> uitgevoerd worden, dat op zijn beurt de NIS-server start.</p></div></div></div><div class=sect4><h5 id=_nis_cliënten>29.4.4.3. NIS-cliënten<a class=anchor href=#_nis_cliënten></a></h5><div class=paragraph><p>Een NIS-cliënt maakt wat heet een verbinding (binding) met een NIS-server met de daemon <code>ypbind</code>. <code>ypbind</code> controleert het standaarddomein van het systeem (zoals ingesteld met <code>domainname</code>) en begint met het broadcasten van RPC-verzoeken op het lokale netwerk. Die verzoeken bevatten de naam van het domein waarvoor <code>ypbind</code> een binding probeert te maken. Als een server die is ingesteld om het gevraagde domein te bedienen een broadcast ontvangt, dan antwoordt die aan <code>ypbind</code> dat dan het IP-adres van de server opslaat. Als er meerdere servers beschikbaar zijn, een master en bijvoorbeeld meerdere slaves, dan gebruikt <code>ypbind</code> het adres van de eerste server die antwoord geeft. Vanaf dat moment stuurt de cliënt alle NIS-verzoeken naar die server. <code>ypbind</code> "pingt" de server zo nu en dan om te controleren of die nog draait. Als er na een bepaalde tijd geen antwoord komt op een ping, dan markeert <code>ypbind</code> het domein als niet verbonden en begint het broadcasten opnieuw, in de hoop dat er een andere server wordt gelocaliseerd.</p></div><div class=sect5><h6 id=_een_nis_cliënt_opzetten>29.4.4.3.1. Een NIS-cliënt opzetten<a class=anchor href=#_een_nis_cliënt_opzetten></a></h6><div class=paragraph><p>Het opzetten van een FreeBSD machine als NIS-cliënt is redelijk doorzichtig:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Wijzig <span class=filename>/etc/rc.conf</span> en voeg de volgende regels toe om de NIS-domeinnaam in te stellen en <code>ypbind</code> mee te laten starten bij het starten van het netwerk:</p><div class="literalblock programlisting"><div class=content><pre>nisdomainname=&#34;test-domain&#34;
nis_client_enable=&#34;YES&#34;</pre></div></div></li><li><p>Om alle mogelijke regels voor accounts uit de NIS-server te halen, dienen alle gebruikersaccounts uit <span class=filename>/etc/master.passwd</span> verwijderd te worden en dient met <code>vipw</code> de volgende regel aan het einde van het bestand geplaatst te worden:</p><div class="literalblock programlisting"><div class=content><pre>+:::::::::</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Door deze regel wordt alle geldige accounts in de wachtwoordafbeelding van de NIS-server toegang gegeven. Er zijn veel manieren om de NIS-cliënt in te stellen door deze regel te veranderen. In het onderdeel <a href=#network-netgroups>netgroepen</a> hieronder staat meer informatie. Zeer gedetailleerde informatie staat in het boek <code>NFS en NIS beheren</code> van O’Reilly.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er moet tenminste één lokale account behouden blijven (dus niet geïmporteerd via NIS) in <span class=filename>/etc/master.passwd</span> en die hoort ook lid te zijn van de groep <code>wheel</code>. Als er iets mis is met NIS, dan kan die account gebruikt worden om via het netwerk aan te melden, <code>root</code> te worden en het systeem te repareren.</p></div></td></tr></tbody></table></div></li><li><p>Om alle groepen van de NIS-server te importeren, kan de volgende regel aan <span class=filename>/etc/group</span> toegevoegd worden:</p><div class="literalblock programlisting"><div class=content><pre>+:*::</pre></div></div></li></ol></div></div></div><div class=paragraph><p>Voer, om de NIS-cliënt onmiddelijk te starten, de volgende commando’s als supergebruiker uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/netstart</span>
<span class=c># service ypbind start</span></code></pre></div></div><div class=paragraph><p>Na het afronden van deze stappen zou met <code>ypcat passwd</code> de passwd map van de NIS-server te zien moeten zijn.</p></div></div></div></div><div class=sect3><h4 id=_nis_beveiliging>29.4.5. NIS-beveiliging<a class=anchor href=#_nis_beveiliging></a></h4><div class=paragraph><p>In het algemeen kan iedere netwerkgebruiker een RPC-verzoek doen uitgaan naar <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> en de inhoud van de NIS-afbeeldingen ontvangen, mits die gebruiker de domeinnaam kent. Omdat soort ongeautoriseerde transacties te voorkomen, ondersteunt <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> de optie "securenets", die gebruikt kan worden om de toegang te beperken tot een opgegeven aantal hosts. Bij het opstarten probeert <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> de securenets informatie te laden uit het bestand <span class=filename>/var/yp/securenets</span>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Dit pad kan verschillen, afhankelijk van het pad dat opgegeven is met de optie <code>-p</code>. Dit bestand bevat regels die bestaan uit een netwerkspecificatie en een netwerkmasker, gescheiden door witruimte. Regels die beginnen met <code>#</code> worden als commentaar gezien. Een voorbeeld van een securenetsbestand zou er zo uit kunnen zien:</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre># allow connections from local host -- mandatory
127.0.0.1     255.255.255.255
# allow connections from any host
# on the 192.168.128.0 network
192.168.128.0 255.255.255.0
# allow connections from any host
# between 10.0.0.0 to 10.0.15.255
# this includes the machines in the testlab
10.0.0.0      255.255.240.0</pre></div></div><div class=paragraph><p>Als <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> een verzoek ontvangt van een adres dat overeenkomt met een van de bovenstaande regels, dan wordt dat verzoek normaal verwerkt. Als er geen enkele regel op het verzoek van toepassing is, dan wordt het verzoek genegeerd en wordt er een waarschuwing gelogd. Als het bestand <span class=filename>/var/yp/securenets</span> niet bestaat, dan accepteert <code>ypserv</code> verbindingen van iedere host.</p></div><div class=paragraph><p>Het programma <code>ypserv</code> ondersteunt ook het pakket TCP Wrapper van Wietse Venema. Daardoor kan een beheerder de instellingenbestanden van TCP Wrapper gebruiken voor toegangsbeperking in plaats van <span class=filename>/var/yp/securenets</span>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Hoewel beide methoden van toegangscontrole enige vorm van beveiliging bieden, zijn ze net als de geprivilegieerde poorttest kwetsbaar voor "IP spoofing" aanvallen. Al het NIS-gerelateerde verkeer hoort door een firewall tegengehouden te worden.</p></div><div class=paragraph><p>Servers die gebruik maken van <span class=filename>/var/yp/securenets</span> kunnen wellicht legitieme verzoeken van NIS-cliënten weigeren als die gebruik maken van erg oude TCP/IP-implementaties. Sommige van die implementaties zetten alle host bits op nul als ze een broadcast doen en/of kijken niet naar het subnetmasker als ze het broadcastadres berekenen. Hoewel sommige van die problemen opgelost kunnen worden door de instellingen op de cliënt aan te passen, zorgen andere problemen voor het noodgedwongen niet langer kunnen gebruiker van NIS voor die cliënt of het niet langer gebruiken van <span class=filename>/var/yp/securenets</span>.</p></div><div class=paragraph><p>Het gebruik van <span class=filename>/var/yp/securenets</span> op een server met zo’n oude implementatie van TCP/IP is echt een slecht idee en zal leiden tot verlies van NIS-functionaliteit voor grote delen van een netwerk.</p></div><div class=paragraph><p>Het gebruik van het pakket TCP Wrapper leidt tot langere wachttijden op de NIS-server. De extra vertraging kan net lang genoeg zijn om een timeout te veroorzaken in cliëntprogramma’s, in het bijzonder als het netwerk druk is of de NIS-server traag is. Als een of meer cliënten last hebben van dat symptoom, dan is het verstandig om de cliëntsysteem in kwestie NIS-slaveserver te maken en naar zichzelf te laten wijzen.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_aanmelden_voor_bepaalde_gebruikers_blokkeren>29.4.6. Aanmelden voor bepaalde gebruikers blokkeren<a class=anchor href=#_aanmelden_voor_bepaalde_gebruikers_blokkeren></a></h4><div class=paragraph><p>In het lab staat de machine <code>basie</code>, die alleen faculteitswerkstation hoort te zijn. Het is niet gewenst die machine uit het NIS-domein te halen, maar het <span class=filename>passwd</span> bestand op de master NIS-server bevat nu eenmaal accounts voor zowel de faculteit als de studenten. Hoe kan dat opgelost worden?</p></div><div class=paragraph><p>Er is een manier om het aanmelden van specifieke gebruikers op een machine te weigeren, zelfs als ze in de NIS-database staan. Daarvoor hoeft er alleen maar <code>-gebruikersnaam</code> met het juiste aantal dubbele punten (zoals bij andere regels) aan het einde van <span class=filename>/etc/master.passwd</span> op de cliëntmachine toegevoegd te worden, waar <em>gebruikersnaam</em> de gebruikersnaam van de gebruiker die niet mag aanmelden is. De regel met de geblokkeerde gebruiker moet voor de regel met <code>+</code> staan om NIS-gebruikers toe te staan. Dit gebeurt bij voorkeur met <code>vipw</code>, omdat <code>vipw</code> de wijzigingen aan <span class=filename>/etc/master.passwd</span> controleert en ook de wachtwoord database opnieuw bouwt na het wijzigen. Om bijvoorbeeld de gebruiker <code>bill</code> te kunnen laten aanmelden op <code>basie</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>basie# vipw
<span class=o>[</span>voeg <span class=nt>-bill</span>::::::::: aan het einde toe, <span class=nb>exit</span><span class=o>]</span>
vipw: rebuilding the database...
vipw: <span class=k>done

</span>basie# <span class=nb>cat</span> /etc/master.passwd

root:[password]:0:0::0:0:The super-user:/root:/bin/csh
toor:[password]:0:0::0:0:The other super-user:/root:/bin/sh
daemon:<span class=k>*</span>:1:1::0:0:Owner of many system processes:/root:/sbin/nologin
operator:<span class=k>*</span>:2:5::0:0:System &amp;:/:/sbin/nologin
bin:<span class=k>*</span>:3:7::0:0:Binaries Commands and Source,,,:/:/sbin/nologin
<span class=nb>tty</span>:<span class=k>*</span>:4:65533::0:0:Tty Sandbox:/:/sbin/nologin
kmem:<span class=k>*</span>:5:65533::0:0:KMem Sandbox:/:/sbin/nologin
games:<span class=k>*</span>:7:13::0:0:Games pseudo-user:/usr/games:/sbin/nologin
news:<span class=k>*</span>:8:8::0:0:News Subsystem:/:/sbin/nologin
man:<span class=k>*</span>:9:9::0:0:Mister Man Pages:/usr/shared/man:/sbin/nologin
<span class=nb>bind</span>:<span class=k>*</span>:53:53::0:0:Bind Sandbox:/:/sbin/nologin
uucp:<span class=k>*</span>:66:66::0:0:UUCP pseudo-user:/var/spool/uucppublic:/usr/libexec/uucp/uucico
xten:<span class=k>*</span>:67:67::0:0:X-10 daemon:/usr/local/xten:/sbin/nologin
pop:<span class=k>*</span>:68:6::0:0:Post Office Owner:/nonexistent:/sbin/nologin
nobody:<span class=k>*</span>:65534:65534::0:0:Unprivileged user:/nonexistent:/sbin/nologin
<span class=nt>-bill</span>:::::::::
+:::::::::

basie#</code></pre></div></div></div><div class=sect3><h4 id=network-netgroups>29.4.7. Netgroups gebruiken<a class=anchor href=#network-netgroups></a></h4><div class=paragraph><p>De methode uit het vorige onderdeel werkt prima als er maar voor een beperkt aantal gebruikers en/of machines speciale regels nodig zijn. Op grotere netwerken <em>gebeurt</em> het gewoon dat er wordt vergeten om een aantal gebruikers de aanmeldrechten op gevoelige machines te ontnemen of dat zelfs iedere individuele machine aangepast moet worden, waardoor het voordeel van NIS teniet wordt gedaan: <em>centraal</em> beheren.</p></div><div class=paragraph><p>De ontwikkelaars van NIS hebben dit probleem opgelost met <em>netgroepen</em>. Het doel en de semantiek kunnen vergeleken worden met de normale groepen die gebruikt worden op UNIX® bestandssystemen. De belangrijkste verschillen zijn de afwezigheid van een numeriek ID en de mogelijkheid om een netgroep aan te maken die zowel gebruikers als andere netgroepen bevat.</p></div><div class=paragraph><p>Netgroepen zijn ontwikkeld om gebruikt te worden voor grote, complexe netwerken met honderden gebruikers en machines. Aan de ene kant is dat iets Goeds. Aan de andere kant is het wel complex en bijna onmogelijk om netgroepen met een paar eenvoudige voorbeelden uit te leggen. Dat probleem wordt in de rest van dit onderdeel duidelijk gemaakt.</p></div><div class=paragraph><p>Stel dat de succesvolle implementatie van NIS in het lab de interesse heeft gewekt van een centrale beheerclub. De volgende taak is het uitbreiden van het NIS-domein met een aantal andere machines op de campus. De onderstaande twee tabellen bevatten de namen van de nieuwe gebruikers en de nieuwe machines met een korte beschijving.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Gebruikersnamen</th><th class="tableblock halign-left valign-top">Beschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>alpha</code>, <code>beta</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gewone medewerkers van de IT-afdeling</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>charlie</code>, <code>delta</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Junior medewerkers van de IT-afdeling</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>echo</code>, <code>foxtrott</code>, <code>golf</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gewone medewerkers</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>able</code>, <code>baker</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Stagiairs</p></td></tr></tbody></table><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Machinenamen</th><th class="tableblock halign-left valign-top">Beschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>war</code>, <code>death</code>, <code>famine</code>, <code>pollution</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De belangrijkste servers. Alleen senior medewerkers van de IT-afdeling mogen hierop aanmelden.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pride</code>, <code>greed</code>, <code>envy</code>, <code>wrath</code>, <code>lust</code>, <code>sloth</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Minder belangrijke servers. Alle leden van de IT-afdeling mogen aanmelden op deze machines.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>one</code>, <code>two</code>, <code>three</code>, <code>four</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gewone werkstations. Alleen <em>echte</em> medewerkers mogen zich op deze machines aanmelden.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>trashcan</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een erg oude machine zonder kritische data. Zelfs de stagiair mag deze doos gebruiken.</p></td></tr></tbody></table><div class=paragraph><p>Als deze restricties ingevoerd worden door iedere gebruiker afzonderlijk te blokkeren, dan wordt er een <code>-user</code> regel per systeem toegevoegd aan de <span class=filename>passwd</span> voor iedere gebruiker die niet mag aanmelden op dat systeem. Als er maar één regel wordt vergeten, kan dat een probleem opleveren. Wellicht lukt het nog dit juist in te stellen bij de bouw van een machine, maar het wordt <em>echt</em> vergeten de regels toe te voegen voor nieuwe gebruikers in de productiefase. Murphy was tenslotte een optimist.</p></div><div class=paragraph><p>Het gebruik van netgroepen biedt in deze situatie een aantal voordelen. Niet iedere gebruiker hoeft separaat afgehandeld te worden. Een gebruik kan aan een of meer groepen worden toegevoegd en aanmelden kan voor alle leden van zo’n groep worden toegestaan of geweigerd. Als er een nieuwe machine wordt toegevoegd, dan hoeven alleen de aanmeldrestricties voor de netgroepen te worden ingesteld. Als er een nieuwe gebruiker wordt toegevoegd, dan hoeft die alleen maar aan de juiste netgroepen te worden toegevoegd. Die veranderingen zijn niet van elkaar afhankelijk: geen "voor iedere combinatie van gebruiker en machine moet het volgende …​". Als de NIS-opzet zorgvuldig is gepland, dan hoeft er maar één instellingenbestand gewijzigd te worden om toegang tot machines te geven of te ontnemen.</p></div><div class=paragraph><p>De eerst stap is het initialiseren van de NIS-afbeelding netgroup. <a href="https://man.freebsd.org/cgi/man.cgi?query=ypinit&amp;sektion=8&amp;format=html">ypinit(8)</a> van FreeBSD maakt deze map niet standaard, maar als die is gemaakt, ondersteunt de NIS-implementatie hem wel. Een lege map wordt als volgt gemaakt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# vi /var/yp/netgroup</code></pre></div></div><div class=paragraph><p>Nu kan hij gevuld worden. In het gebruikte voorbeeld zijn tenminste vier netgroepen: IT-medewerkers, IT-junioren, gewone medewerkers en stagiars.</p></div><div class="literalblock programlisting"><div class=content><pre>IT_MW   (,alpha,test-domain)    (,beta,test-domain)
IT_APP  (,charlie,test-domain)  (,delta,test-domain)
USERS   (,echo,test-domain)     (,foxtrott,test-domain) \
        (,golf,test-domain)
STAGS   (,able,test-domain)     (,baker,test-domain)</pre></div></div><div class=paragraph><p><code>IT_MW</code>, <code>IT_APP</code> enzovoort, zijn de namen van de netgroepen. Iedere groep tussen haakjes bevat een of meer gebruikersnamen voor die groep. De drie velden binnen een groep zijn:</p></div><div class="olist arabic"><ol class=arabic><li><p>De naam van de host of namen van de hosts waar de volgende onderdelen geldig zijn. Als er geen hostnaam wordt opgegeven dan is de regel geldig voor alle hosts. Als er wel een hostnaam wordt opgegeven, dan wordt een donker, spookachtig en verwarrend domein betreden.</p></li><li><p>De naam van de account die bij deze netgroep hoort.</p></li><li><p>Het NIS-domein voor de account. Er kunnen accounts uit andere NIS-domeinen geïmporteerd worden in een netgroep als een beheerder zo ongelukkig is meerdere NIS-domeinen te hebben.</p></li></ol></div><div class=paragraph><p>Al deze velden kunnen jokerkarakters bevatten. Details daarover staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=netgroup&amp;sektion=5&amp;format=html">netgroup(5)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De naam van een netgroep mag niet langer zijn dan acht karakters, zeker niet als er andere besturingssystemen binnen een NIS-domein worden gebruikt. De namen zijn hoofdlettergevoelig: alleen hoofdletters gebruiken voor de namen van netgroepen is een makkelijke manier om onderscheid te kunnen maken tussen gebruikers-, machine- en netgroepnamen.</p></div><div class=paragraph><p>Sommige NIS-cliënten (andere dan die op FreeBSD draaien) kunnen niet omgaan met netgroepen met veel leden. Sommige oudere versies van SunOS™ gaan bijvoorbeeld lastig doen als een netgroep meer dan 15 <em>leden</em> heeft. Dit kan omzeild worden door meerdere subnetgroepen te maken met 15 gebruikers of minder en een echte netgroep die de subnetgroepen bevat:</p></div><div class="literalblock programlisting"><div class=content><pre>BIGGRP1  (,joe1,domain)  (,joe2,domain)  (,joe3,domain) [...]
BIGGRP2  (,joe16,domain)  (,joe17,domain) [...]
BIGGRP3  (,joe31,domain)  (,joe32,domain)
BIGGROUP  BIGGRP1 BIGGRP2 BIGGRP3</pre></div></div><div class=paragraph><p>Dit proces kan herhaald worden als er meer dan 225 gebruikers in een netgroep moeten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het activeren en distribueren van de nieuwe NIS-map is eenvoudig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# <span class=nb>cd</span> /var/yp
ellington# make</code></pre></div></div><div class=paragraph><p>Hiermee worden drie nieuwe NIS-afbeeldingen gemaakt: <span class=filename>netgroup</span>, <span class=filename>netgroup.byhost</span> en <span class=filename>netgroup.byuser</span>. Met <a href="https://man.freebsd.org/cgi/man.cgi?query=ypcat&amp;sektion=1&amp;format=html">ypcat(1)</a> kan bekeken worden op de nieuwe NIS-afbeeldingen beschikbaar zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington% ypcat <span class=nt>-k</span> netgroup
ellington% ypcat <span class=nt>-k</span> netgroup.byhost
ellington% ypcat <span class=nt>-k</span> netgroup.byuser</code></pre></div></div><div class=paragraph><p>De uitvoer van het eerste commando hoort te lijken op de inhoud van <span class=filename>/var/yp/netgroup</span>. Het tweede commando geeft geen uitvoer als er geen host-specifieke netgroepen zijn ingesteld. Het derde commando kan gebruikt worden om een lijst van netgroepen voor een gebruiker op te vragen.</p></div><div class=paragraph><p>Het instellen van de cliënt is redelijk eenvoudig. Om de server <code>war</code> in te stellen hoeft alleen met <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> de volgende regel in de regel daarna vervangen te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>+:::::::::</pre></div></div><div class=paragraph><p>Vervang de bovenstaande regel in de onderstaande.</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_MW:::::::::</pre></div></div><div class=paragraph><p>Nu worden alleen de gebruikers die in de netgroep <code>IT_MW</code> geïmporteerd in de wachtwoorddatabase van de host <code>war</code>, zodat alleen die gebruikers zich kunnen aanmelden.</p></div><div class=paragraph><p>Helaas zijn deze beperkingen ook van toepassing op de functie <code>~</code> van de shell en alle routines waarmee tussen gebruikersnamen en numerieke gebruikers ID’s wordt gewisseld. Met andere woorden: <code>cd ~user</code> werkt niet, <code>ls -l</code> toont het numerieke ID in plaats van de gebruikersnaam en <code>find . -user joe -print</code> faalt met de foutmelding <code>No such user</code>. Om dit te repareren moeten alle gebruikers geïmporteerd worden, <em>zonder ze het recht te geven aan te melden op een server</em>.</p></div><div class=paragraph><p>Dit kan gedaan worden door nog een regel aan <span class=filename>/etc/master.passwd</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>+:::::::::/sbin/nologin</pre></div></div><div class=paragraph><p>Dit betekent "importeer alle gebruikers, maar vervang de shell door <span class=filename>/sbin/nologin</span>". Ieder veld in een <code>passwd</code> regel kan door een standaardwaarde vervangen worden in <span class=filename>/etc/master.passwd</span>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>De regel <code>:::::::::/sbin/nologin` moet na `@IT_MW:::::::::</code> komen. Anders krijgen alle gebruikers die uit NIS-komen <span class=filename>/sbin/nologin</span> als aanmeldshell.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Na deze wijziging hoeft er nog maar één NIS-afbeelding gewijzigd te worden als er een nieuwe medewerker komt bij de IT-afdeling. Dezelfde aanpak kan gebruikt worden voor de minder belangrijke servers door de oude regel <code>+:::::::::</code> in de lokale versie van <span class=filename>/etc/master.passwd</span> door iets als het volgende te vervangen:</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_MW:::::::::
+@IT_APP:::::::::
+:::::::::/sbin/nologin</pre></div></div><div class=paragraph><p>Voor normale werkstations zijn het de volgende regels:</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_MW:::::::::
+@USERS:::::::::
+:::::::::/sbin/nologin</pre></div></div><div class=paragraph><p>En dat zou allemaal leuk en aardig zijn als er niet na een paar weken een beleidsverandering komt: de IT-afdeling gaat stagiairs aannemen. De IT-stagiairs mogen de normale werkstations en de minder belangrijke servers gebruiken en de juniorbeheerders mogen gaan aanmelden op de hoofdservers. Dat kan door een nieuwe groep <code>IT_STAG</code> te maken en de nieuwe IT-stagiairs toe te voegen aan die netgroep en dan de instellingen op iedere machine te gaan veranderen. Maar zoals het spreekwoord zegt: "Fouten in een centrale planning leiden tot complete chaos."</p></div><div class=paragraph><p>Deze situaties kunnen voorkomen worden door gebruik te maken van de mogelijkheid in NIS om netgroepen in netgroepen op te nemen. Het is mogelijk om rolgebaseerde netgroepen te maken. Er kan bijvoorbeeld een netgroep <code>BIGSRV</code> gemaakt worden om het aanmelden op de belangrijke servers te beperken en er kan een andere netgroep <code>SMALLSRV</code> voor de minder belangrijke servers zijn en een derde netgroep met de naam <code>USERBOX</code> voor de normale werkstations. Al die netgroepen kunnen de netgroepen bevatten die op die machines mogen aanmelden. De nieuwe regels in de NIS-afbeelding netgroup zien er dan zo uit:</p></div><div class="literalblock programlisting"><div class=content><pre>BIGSRV    IT_MW  IT_APP
SMALLSRV  IT_MW  IT_APP  ITSTAG
USERBOX   IT_MW  ITSTAG USERS</pre></div></div><div class=paragraph><p>Deze methode voor het instellen van aanmeldbeperkingen werkt redelijk goed als er groepen van machines gemaakt kunnen worden met identieke beperkingen. Helaas blijkt dat eerder uitzondering dan regel. Meestal moet het mogelijk zijn om per machine in te stellen wie zich wel en wie zich niet mogen aanmelden.</p></div><div class=paragraph><p>Daarom is het ook mogelijk om via machinespecifieke netgroepen de hierboven aangegeven beleidswijziging op te vangen. In dat scenario bevat <span class=filename>/etc/master.passwd</span> op iedere machine twee regels die met "+" beginnen. De eerste voegt de netgroep toe met de accounts die op de machine mogen aanmelden en de tweede voegt alle andere accounts toe met <span class=filename>/sbin/nologin</span> als shell. Het is verstandig om als naam van de netgroep de machinenaam in "HOOFDLETTERS" te gebruiken. De regels zien er ongeveer als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>+@MACHINENAAM:::::::::
+:::::::::/sbin/nologin</pre></div></div><div class=paragraph><p>Als dit voor alle machines is gedaan, dan hoeven de lokale versies van <span class=filename>/etc/master.passwd</span> nooit meer veranderd te worden. Alle toekomstige wijzigingen kunnen dan gemaakt worden door de NIS-afbeelding te wijzigen. Hieronder staat een voorbeeld van een mogelijke netgroep map voor het beschreven scenario met een aantal toevoegingen:</p></div><div class="literalblock programlisting"><div class=content><pre># Definieer eerst de gebruikersgroepen
IT_MW     (,alpha,test-domain)    (,beta,test-domain)
IT_APP    (,charlie,test-domain)  (,delta,test-domain)
DEPT1     (,echo,test-domain)     (,foxtrott,test-domain)
DEPT2     (,golf,test-domain)     (,hotel,test-domain)
DEPT3     (,india,test-domain)    (,juliet,test-domain)
ITSTAG    (,kilo,test-domain)     (,lima,test-domain)
D_STAGS   (,able,test-domain)     (,baker,test-domain)
#
# En nu een aantal groepen op basis van rollen
USERS     DEPT1   DEPT2     DEPT3
BIGSRV    IT_MW   IT_APP
SMALLSRV  IT_MW   IT_APP    ITSTAG
USERBOX   IT_MW   ITSTAG    USERS
#
# Een een groep voor speciale taken.
# Geef echo en golf toegang tot de anti-virus machine.
SECURITY  IT_MW   (,echo,test-domain)  (,golf,test-domain)
#
# Machinegebaseerde netgroepen
# Hoofdservers
WAR       BIGSRV
FAMINE    BIGSRV
# Gebruiker india heeft toegang tot deze server nodig.
POLLUTION  BIGSRV  (,india,test-domain)
#
# Deze is erg belangrijk en heeft strengere toegangseisen nodig.
DEATH     IT_MW
#
# De anti-virus machine als hierboven genoemd.
ONE       SECURITY
#
# Een machine die maar door 1 gebruiker gebruikt mag worden.
TWO       (,hotel,test-domain)
# [...hierna volgen de andere groepen]</pre></div></div><div class=paragraph><p>Als er een soort database wordt gebruikt om de gebruikersaccounts te beheren, dan is het in ieder geval nodig dat ook het eerste deel van de afbeelding met de databaserapportagehulpmiddelen gemaakt kan worden. Dan krijgen nieuwe gebruikers automatisch toegang tot de machines.</p></div><div class=paragraph><p>Nog een laatste waarschuwing: het is niet altijd aan te raden gebruik te maken van machinegebaseerde netgroepen. Als er tientallen of zelfs honderden gelijke machines voor bijvoorbeeld studentenruimtes worden uitgerold, dan is het verstandiger rolgebaseerde netgroepen te gebruiken in plaats van machinegebaseerde netgroepen om de grootte van de NIS-afbeelding binnen de perken te houden.</p></div></div><div class=sect3><h4 id=_belangrijk_om_te_onthouden>29.4.8. Belangrijk om te onthouden<a class=anchor href=#_belangrijk_om_te_onthouden></a></h4><div class=paragraph><p>In een NIS-omgeving werken een aantal dingen wel anders.</p></div><div class=ulist><ul><li><p>Als er een gebruiker toegevoegd moet worden, dan moet die <em>alleen</em> toegevoegd worden aan de master NIS-server en <em>mag niet vergeten worden dat de NIS-afbeeldingen herbouwd moeten worden</em>. Als dit wordt vergeten, dan kan de nieuwe gebruiker nergens anders aanmelden dan op de NIS-master. Als bijvoorbeeld een nieuwe gebruiker <code>jsmith</code> toegevoegd moet worden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw useradd jsmith</span>
<span class=c># cd /var/yp</span>
<span class=c># make test-domain</span></code></pre></div></div><div class=paragraph><p>Er kan ook <code>adduser jsmith</code> in plaats van <code>pw useradd jsmith</code> gebruikt worden.</p></div></li><li><p><em>De beheeraccounts moeten buiten de NIS-afbeeldingen gehouden worden</em>. Het is niet handig als de beheeraccounts en wachtwoorden naar machines waarop gebruikers zich aanmelden die geen toegang tot die informatie horen te hebben zouden gaan.</p></li><li><p><em>De NIS-master en slave moeten veilig blijven en zo min mogelijk niet beschikbaar zijn</em>. Als de machine wordt gehackt of als hij wordt uitgeschakeld, dan kunnen er in theorie nogal wat mensen niet meer aanmelden.</p><div class=paragraph><p>Dit is de belangrijkste zwakte van elk gecentraliseerd beheersysteem. Als de NIS-servers niet goed beschermd worden, dan worden veel gebruikers boos!</p></div></li></ul></div></div><div class=sect3><h4 id=_nis_v1_compatibiliteit>29.4.9. NIS v1-compatibiliteit<a class=anchor href=#_nis_v1_compatibiliteit></a></h4><div class=paragraph><p>ypserv voor FreeBSD biedt wat ondersteuning voor NIS v1 cliënten. De NIS-implementatie van FreeBSD gebruikt alleen het NIS v2 protocol, maar andere implementaties bevatten ondersteuning voor het v1 protocol voor achterwaartse compatibiliteit met oudere systemen. De ypbind-daemons die bij deze systemen zitten proberen een binding op te zetten met een NIS v1 server, hoewel dat niet per se ooit nodig is (en ze gaan misschien nog wel door met broadcasten nadat ze een antwoord van een v2 server hebben ontvangen). Het is belangrijk om te melden dat hoewel ondersteuning voor gewone cliëntoproepen aanwezig is, deze versie van ypserv geen overdrachtsverzoeken voor v1-afbeeldingen af kan handelen. Daarom kan ypserv niet gebruikt worden als master of slave in combinatie met oudere NIS-servers die alleen het v1 protocol ondersteunen. Gelukkig worden er in deze tijd niet meer zoveel van deze servers gebruikt.</p></div></div><div class=sect3><h4 id=network-nis-server-is-client>29.4.10. NIS-servers die ook NIS-cliënten zijn<a class=anchor href=#network-nis-server-is-client></a></h4><div class=paragraph><p>Het is belangrijk voorzichtig om te gaan met het draaien van ypserv in een multi-server domein waar de server machines ook NIS-cliënten zijn. Het is in het algemeen verstandiger om de servers te dwingen met zichzelf te binden dan ze toe te staan een bindverzoek te broadcasten en het risico te lopen dat ze een binding met elkaar maken. Er kunnen vreemde fouten optreden als een van de servers plat gaat als er andere servers van die server afhankelijk zijn. Na verloop van tijd treedt op de cliënten wel een timeout op en verbinden ze met een andere server, maar de daarmee gepaard gaande vertraging kan aanzienlijk zijn en de foutmodus is nog steeds van toepassing, omdat de servers dan toch weer opnieuw een verbinding met elkaar kunnen vinden.</p></div><div class=paragraph><p>Het is mogelijk een host aan een specifieke server te binden door aan <code>ypbind</code> de vlag <code>-S</code> mee te geven. Om dit niet iedere keer handmatig na een herstart te hoeven uitvoeren, kan de volgende regel worden opgenomen in <span class=filename>/etc/rc.conf</span> van de NIS-server:</p></div><div class="literalblock programlisting"><div class=content><pre>nis_client_enable=&#34;YES&#34;	# start ook het cliënt gedeelte
nis_client_flags=&#34;-S NIS domain,server&#34;</pre></div></div><div class=paragraph><p>In <a href="https://man.freebsd.org/cgi/man.cgi?query=ypbind&amp;sektion=8&amp;format=html">ypbind(8)</a> staat meer informatie.</p></div></div><div class=sect3><h4 id=_wachtwoordformaten>29.4.11. Wachtwoordformaten<a class=anchor href=#_wachtwoordformaten></a></h4><div class=paragraph><p>Een van de meest voorkomende problemen bij het implementeren van NIS is de compatibiliteit van het wachtwoordformaat. Als een NIS-server wachtwoorden gebruikt die met DES gecodeerd zijn, dan kunnen alleen cliënten die ook DES gebruiken ondersteund worden. Als er bijvoorbeeld Solaris™ NIS-cliënten in een netwerk zijn, dan moet er vrijwel zeker gebruik gemaakt worden van met DES gecodeerde wachtwoorden.</p></div><div class=paragraph><p>Van welk formaat cliënten en servers gebruik maken is te zien in <span class=filename>/etc/login.conf</span>. Als een host gebruik maakt van met DES gecodeerde wachtwoorden, dan staat er in de klasse <code>default</code> een regel als de volgende:</p></div><div class="literalblock programlisting"><div class=content><pre>default:\
	:passwd_format=des:\
	:copyright=/etc/COPYRIGHT:\
	[Overige regels weggelaten]</pre></div></div><div class=paragraph><p>Andere mogelijke waarden voor <code>passwd_format</code> zijn <code>blf</code> en <code>md5</code> (respectievelijk voor Blowfish en MD5 gecodeerde wachtwoorden).</p></div><div class=paragraph><p>Als er wijzigingen gemaakt zijn aan <span class=filename>/etc/login.conf</span> dan moet de login capability database herbouwd worden door het volgende commando als <code>root</code> uit te voeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het formaat van de wachtwoorden die al in <span class=filename>/etc/master.passwd</span> staan worden niet bijgewerkt totdat een gebruiker zijn wachtwoord voor de eerste keer wijzigt <em>nadat</em> de login capability database is herbouwd.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om te zorgen dat de wachtwoorden in het gekozen formaat zijn gecodeerd, moet daarna gecontroleerd worden of de waarde <code>crypt_default</code> in <span class=filename>/etc/auth.conf</span> de voorkeur geeft aan het gekozen formaat. Om dat te realiseren dient het gekozen formaat vooraan gezet te worden in de lijst. Als er bijvoorbeeld gebruik gemaakt wordt van DES gecodeerde wachtwoorden, dan hoort de regel er als volgt uit te zien:</p></div><div class="literalblock programlisting"><div class=content><pre>crypt_default	=	des blf md5</pre></div></div><div class=paragraph><p>Als de bovenstaande stappen op alle FreeBSD gebaseerde NIS-servers en cliënten zijn uitgevoerd, dan is het zeker dat ze het allemaal eens zijn over welk wachtwoordformaat er op het netwerk wordt gebruikt. Als er problemen zijn bij de authenticatie op een NIS-cliënt, dan is dit een prima startpunt voor het uitzoeken waar de problemen vandaan komen. Nogmaals: als er een NIS-server in een heterogene omgeving wordt geplaatst, dan is het waarschijnlijk dat er gebruik gemaakt moet worden van DES op alle systemen, omdat dat de laagst overeenkomende standaard is.</p></div></div></div><div class=sect2><h3 id=network-dhcp>29.5. Automatisch netwerk instellen (DHCP)<a class=anchor href=#network-dhcp></a></h3><div class=sect3><h4 id=_wat_is_dhcp>29.5.1. Wat is DHCP?<a class=anchor href=#_wat_is_dhcp></a></h4><div class=paragraph><p>DHCP, het Dynamic Host Configuration Protocol, schrijft voor hoe een systeem verbinding kan maken met een netwerk en hoe het de benodigde informatie kan krijgen om met dat netwerk te communiceren. FreeBSD gebruikt de OpenBSD <code>dhclient</code> welke uit OpenBSD 3.7 komt. Alle informatie over <code>dhclient</code> kan zowel voor de ISC als de OpenBSD DHCP-cliënt gebruikt worden. De DHCP-server zit bij de ISC-distributie.</p></div></div><div class=sect3><h4 id=_wat_behandeld_wordt>29.5.2. Wat behandeld wordt<a class=anchor href=#_wat_behandeld_wordt></a></h4><div class=paragraph><p>In dit onderdeel worden de cliëntcomponenten van de ISC en OpenBSD DHCP-cliënt en de servercomponenten van het ISC DHCP-systeem beschreven. Het programma voor de cliënt, <code>dhclient</code>, zit standaard in FreeBSD en de server is beschikbaar via de port <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-server/>net/isc-dhcp42-server</a>. Naast de onderstaande informatie, zijn de hulppagina’s van <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcp-options&amp;sektion=5&amp;format=html">dhcp-options(5)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.conf&amp;sektion=5&amp;format=html">dhclient.conf(5)</a> bruikbare bronnen.</p></div></div><div class=sect3><h4 id=_hoe_het_werkt>29.5.3. Hoe het werkt<a class=anchor href=#_hoe_het_werkt></a></h4><div class=paragraph><p>Als <code>dhclient</code>, de DHCP-cliënt, wordt uitgevoerd op een cliëntmachine, dan begint die met het broadcasten van verzoeken om instellingeninformatie. Standaard worden deze verzoeken op UDP poort 68 gedaan. De server antwoordt op UDP 67 en geeft de cliënt een IP-adres en andere relevante netwerkinformatie, zoals een netmasker, router en DNS-servers. Al die informatie komt in de vorm van een DHCP "lease" en is voor een bepaalde tijd geldig (die is ingesteld door de beheerder van de DHCP-server). Op die manier kunnen IP-adressen voor cliënten die niet langer met het netwerk verbonden zijn (stale) automatisch weer ingenomen worden.</p></div><div class=paragraph><p>DHCP-cliënten kunnen veel informatie van de server krijgen. Er staat een uitputtende lijst in <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcp-options&amp;sektion=5&amp;format=html">dhcp-options(5)</a>.</p></div></div><div class=sect3><h4 id=_freebsd_integratie>29.5.4. FreeBSD integratie<a class=anchor href=#_freebsd_integratie></a></h4><div class=paragraph><p>FreeBSD integreert de OpenBSD DHCP-cliënt <code>dhclient</code> volledig. Er is ondersteuning voor de DHCP-cliënt in zowel het installatieprogramma als in het basissysteem, waardoor het niet noodzakelijk is om kennis te hebben van het maken van netwerkinstellingen voor het netwerk waar een DHCP-server draait.</p></div><div class=paragraph><p>DHCP wordt ondersteund door sysinstall. Bij het instellen van een netwerkinterface binnen sysinstall is de tweede vraag: "Wil je proberen de interface met DHCP in te stellen?" Als het antwoord bevestigend luidt, dan wordt <code>dhclient</code> uitgevoerd en als dat succesvol verloopt, dan worden de netwerkinstellingen automatisch ingevuld.</p></div><div class=paragraph><p>Voor het gebruiken van DHCP bij het opstarten van het systeem zijn twee instellingen nodig:</p></div><div class=ulist><ul><li><p>Het apparaat <span class=filename>bpf</span> moet in de kernel gecompileerd zijn. Dit kan door <code>device bpf</code> aan het bestand met kernelinstellingen toe te voegen en de kernel te herbouwen. Meer informatie over het bouwen van een kernel staat in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>.</p><div class=paragraph><p>Het apparaat <span class=filename>bpf</span> is al onderdeel van de <span class=filename>GENERIC</span> kernel die bij FreeBSD zit, dus als er geen sprake is van een aangepaste kernel, dan hoeft er geen nieuwe gemaakt te worden om DHCP aan te praat te krijgen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voor de lezer die bijzonder begaan is met beveiliging, is het belangrijk aan te geven dat <span class=filename>bpf</span> ook het apparaat is waardoor pakketsnuffelaars hun werk kunnen doen (hoewel ze nog steeds als <code>root</code> moeten draaien). <span class=filename>bpf</span><em>is</em> noodzakelijk voor DHCP, maar als beveiliging bijzonder belangrijk is, dan hoort <span class=filename>bpf</span> waarschijnlijk niet in een kernel te zitten omdat de verwachting dat er in de toekomst ooit DHCP gebruikt gaat worden.</p></div></td></tr></tbody></table></div></li><li><p>Standaard draait de DHCP-synchronisatie op FreeBSD in de achtergrond, of <em>asynchroon</em>. Andere opstartscripten gaan verder terwijl DHCP wordt voltooid, wat het opstarten van het systeem versnelt.</p><div class=paragraph><p>DHCP in de achtergrond werkt goed als de DHCP-server snel op verzoeken reageert en het DHCP-configuratieproces snel gaat. Op sommige systemen kan het lang duren voordat DHCP klaar is. Als netwerkdiensten proberen te draaien voordat DHCP voltooid is, zullen ze falen. Door DHCP in <em>synchrone</em> modus te draaien wordt dit probleem voorkomen en wordt het opstarten gepauzeerd totdat de DHCP-configuratie voltooid is.</p></div><div class=paragraph><p>Gebruik om in de achtergrond verbinding te maken met een DHCP-server terwijl andere opstartscripts verder gaan (asynchrone modus) de waarde “DHCP” in <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;DHCP&#34;</pre></div></div><div class=paragraph><p>Gebruik om het opstarten te pauzeren totdat DHCP voltooid is de synchrone modus met waarde “SYNDHCP”:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;SYNDHCP&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Vervang <em>fxp0</em> zoals getoond in deze voorbeelden met de naam van de interface dat dynamisch geconfigureerd moet worden, zoals getoond in <a href=./#config-network-setup>Netwerkkaarten instellen</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als er een andere lokatie voor <code>dhclient</code> wordt gebruikt of als er extra parameters aan <code>dhclient</code> meegegeven moeten worden, dan dient ook iets als het volgende toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>dhclient_program=&#34;/sbin/dhclient&#34;
dhclient_flags=&#34;&#34;</pre></div></div></li></ul></div><div class=paragraph><p>De DHCP-server, dhcpd, zit bij de port <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-server/>net/isc-dhcp42-server</a> in de Portscollectie. Deze port bevat de ISC DHCP-server en documentatie.</p></div></div><div class=sect3><h4 id=_bestanden>29.5.5. Bestanden<a class=anchor href=#_bestanden></a></h4><div class=ulist><ul><li><p><span class=filename>/etc/dhclient.conf</span></p><div class=paragraph><p>Voor <code>dhclient</code> is een instellingenbestand <span class=filename>/etc/dhclient.conf</span> nodig. Dat bestand bevat meestal alleen maar commentaar, omdat de standaardinstellingen redelijk zinvol zijn. Dit bestand wordt beschreven in <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.conf&amp;sektion=5&amp;format=html">dhclient.conf(5)</a>.</p></div></li><li><p><span class=filename>/sbin/dhclient</span></p><div class=paragraph><p><code>dhclient</code> is statisch gelinkt en staat in <span class=filename>/sbin</span>. Er staat meer informatie over <code>dhclient</code> in <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a>.</p></div></li><li><p><span class=filename>/sbin/dhclient-script</span></p><div class=paragraph><p><code>dhclient-script</code> is het FreeBSD-specifieke DHCP-cliënt instellingenscript. Het wordt beschreven in <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient-script&amp;sektion=8&amp;format=html">dhclient-script(8)</a>, maar het is niet nodig het te wijzigen om goed te werken.</p></div></li><li><p><span class=filename>/var/db/dhclient.leases.interface</span></p><div class=paragraph><p>De DHCP-cliënt houdt in dit bestand een database bij van geldige leases, die naar een logboekbestand worden geschreven. In <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.leases&amp;sektion=5&amp;format=html">dhclient.leases(5)</a> staat een iets uitgebreidere beschrijving.</p></div></li></ul></div></div><div class=sect3><h4 id=_verder_lezen>29.5.6. Verder lezen<a class=anchor href=#_verder_lezen></a></h4><div class=paragraph><p>Het DHCP-protocol staat volledig beschreven in <a href=http://www.freesoft.org/CIE/RFC/2131/>RFC 2131</a>. Er is nog een bron van informatie ingesteld op <a href=http://www.dhcp.org/>http://www.dhcp.org/</a>.</p></div></div><div class=sect3><h4 id=network-dhcp-server>29.5.7. Een DHCP-server installeren en instellen<a class=anchor href=#network-dhcp-server></a></h4><div class=sect4><h5 id=_wat_behandeld_wordt_2>29.5.7.1. Wat behandeld wordt<a class=anchor href=#_wat_behandeld_wordt_2></a></h5><div class=paragraph><p>In dit onderdeel wordt beschreven hoe een FreeBSD systeem zo ingesteld kan worden dat het opereert als DHCP-server door gebruik te maken van de ISC (Internet Systems Consortium) implementatie van de DHCP-server.</p></div><div class=paragraph><p>De server wordt niet geleverd als deel van FreeBSD en om deze dienst aan te bieden dient de port <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-server/>net/isc-dhcp42-server</a> geïnstalleerd te worden. In <a href=./#ports>Applicaties installeren. pakketten en ports</a> staat meer informatie over de Portscollectie.</p></div></div><div class=sect4><h5 id=_dhcp_serverinstallatie>29.5.7.2. DHCP-serverinstallatie<a class=anchor href=#_dhcp_serverinstallatie></a></h5><div class=paragraph><p>Om een FreeBSD systeem in te stellen als DHCP-server moet het apparaat <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> in de kernel zijn opgenomen. Om dit te doen dient <code>device bpf</code> aan het bestand met kernelinstellingen toegevoegd te worden en dient de kernel herbouwd te worden. Meer informatie over het bouwen van kernels staat in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div><div class=paragraph><p>Het apparaat <span class=filename>bpf</span> is al onderdeel van de <span class=filename>GENERIC</span> kernel die bij FreeBSD, dus het is meestal niet nodig om een aangepaste kernel te bouwen om DHCP aan de praat te krijgen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is belangrijk te vermelden dat <span class=filename>bpf</span> ook het apparaat is waardoor pakketsnuffelaars kunnen werken (hoewel de programma’s die er gebruik van maken wel bijzondere toegang nodig hebben). <span class=filename>bpf</span><em>is</em> verplicht voor DHCP, maar als beveiliging van belang is, dan is het waarschijnlijk niet verstandig om <span class=filename>bpf</span> in een kernel op te nemen alleen omdat er in de toekomst misschien ooit DHCP gebruikt gaat worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Hierna dient het standaardbestand <span class=filename>dhcpd.conf</span> dat door de port <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-server/>net/isc-dhcp42-server</a> is geïnstalleerd gewijzigd te worden. Standaard is dit <span class=filename>/usr/local/etc/dhcpd.conf.sample</span> en dit bestand dient gekopieerd te worden naar <span class=filename>/usr/local/etc/dhcpd.conf</span> voordat de wijzigingen worden gemaakt.</p></div></div><div class=sect4><h5 id=_de_dhcp_server_instellen>29.5.7.3. De DHCP-server instellen<a class=anchor href=#_de_dhcp_server_instellen></a></h5><div class=paragraph><p><span class=filename>dhcpd.conf</span> is opgebouwd uit declaraties over subnetten en hosts en is wellicht het meest eenvoudig te beschrijven met een voorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>option domain-name &#34;example.com&#34;; <i class=conum data-value=1></i><b>(1)</b>
option domain-name-servers 192.168.4.100; <i class=conum data-value=2></i><b>(2)</b>
option subnet-mask 255.255.255.0; <i class=conum data-value=3></i><b>(3)</b>

default-lease-time 3600; <i class=conum data-value=4></i><b>(4)</b>
max-lease-time 86400; <i class=conum data-value=5></i><b>(5)</b>
ddns-update-style none; <i class=conum data-value=6></i><b>(6)</b>

subnet 192.168.4.0 netmask 255.255.255.0 {
  range 192.168.4.129 192.168.4.254; <i class=conum data-value=7></i><b>(7)</b>
  option routers 192.168.4.1; <i class=conum data-value=8></i><b>(8)</b>
}

host mailhost {
  hardware ethernet 02:03:04:05:06:07; <i class=conum data-value=9></i><b>(9)</b>
  fixed-address mailhost.example.com; <i class=conum data-value=10></i><b>(10)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Deze optie geeft het domein aan dat door cliënten als standaard zoekdomein wordt gebruikt. In <a href="https://man.freebsd.org/cgi/man.cgi?query=resolv.conf&amp;sektion=5&amp;format=html">resolv.conf(5)</a> staat meer over wat dat betekent.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Deze optie beschrijft een door komma’s gescheiden lijst met DNS-servers die de cliënt moet gebruiken.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Het netmasker dat aan de cliënten wordt voorgeschreven.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Een cliënt kan om een bepaalde duur vragen die een lease geldig is. Anders geeft de server aan wanneer de lease vervalt (in seconden).</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Dit is de maximale duur voor een lease die de server toestaat. Als een cliënt vraagt om een langere lease, dan wordt die wel verstrekt, maar is de maar geldig gedurende <code>max-lease-time</code> seconden.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Deze optie geeft aan of de DHCP-server moet proberen de DNS-server bij te werken als een lease is geaccepteerd of wordt vrijgegeven. In de ISC implementatie is deze optie <em>verplicht</em>.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>Dit geeft aan welke IP-adressen in de groep met adressen zitten die zijn gereserveerd om uitgegeven te worden aan cliënten. Alle IP-adressen tussen de aangegeven adressen en die adressen zelf worden aan cliënten uitgegeven.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>Geeft de default gateway aan die aan de cliënten wordt voorgeschreven.</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>Het hardware MAC-adres van een host, zodat de DHCP-server een host kan herkennen als die een verzoek doet.</td></tr><tr><td><i class=conum data-value=10></i><b>10</b></td><td>Geeft een host aan die altijd hetzelfde IP-adres moet krijgen. Hier kan een hostnaam gebruikt worden, omdat de DHCP-server de hostnaam zelf opzoekt voordat de lease-informatie terug wordt gegeven.</td></tr></tbody></table></div><div class=paragraph><p>Wanneer u klaar bent met het schrijven van uw <span class=filename>dhcpd.conf</span>, dient u de DHCP-server in <span class=filename>/etc/rc.conf</span> aan te zetten, door het volgende toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>dhcpd_enable=&#34;YES&#34;
dhcpd_ifaces=&#34;dc0&#34;</pre></div></div><div class=paragraph><p>Vervang de interfacenaam <code>dc0</code> door de interface (of interfaces, gescheiden door witruimtes) waarop uw DHCP-server moet luisteren naar DHCP-verzoeken van cliënten.</p></div><div class=paragraph><p>Daarna kunt u doorgaan met het starten van de server door het volgende commando te geven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service isc-dhcpd start</span></code></pre></div></div><div class=paragraph><p>Als er later wijzigingen in de instellingen gemaakt moeten worden, dan is het belangrijk te onthouden dat het sturen van een <code>SIGHUP</code> signaal naar dhcpd_niet_ resulteert in het opnieuw laden van de instellingen, zoals voor de meeste daemons geldt. Voor deze daemon dient een signaal <code>SIGTERM</code> gestuurd te worden om het proces te stoppen. Daarna dient de daemon met het hiervoor beschreven commando weer gestart worden.</p></div></div><div class=sect4><h5 id=_bestanden_2>29.5.7.4. Bestanden<a class=anchor href=#_bestanden_2></a></h5><div class=ulist><ul><li><p><span class=filename>/usr/local/sbin/dhcpd</span></p><div class=paragraph><p>dhcpd is statisch gelinkt en staat in <span class=filename>/usr/local/sbin</span>. In de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd&amp;sektion=8&amp;format=html">dhcpd(8)</a> die meekomt met de port staat meer informatie over dhcpd.</p></div></li><li><p><span class=filename>/usr/local/etc/dhcpd.conf</span></p><div class=paragraph><p>dhcpd heeft een instellingenbestand, <span class=filename>/usr/local/etc/dhcpd.conf</span>, nodig voordat de daemon diensten aan cliënten kan leveren. Het bestand moet alle informatie bevatten die aan cliënten gegeven moet worden en de informatie die nodig is voor het draaien van de dienst. Dit instellingenbestand staat beschreven in de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd.conf&amp;sektion=5&amp;format=html">dhcpd.conf(5)</a> die meekomt met de port.</p></div></li><li><p><span class=filename>/var/db/dhcpd.leases</span></p><div class=paragraph><p>De DHCP-server houdt in dit bestand een database bij met leases die zijn uitgegeven en die naar een logboek worden geschreven. In de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd.leases&amp;sektion=5&amp;format=html">dhcpd.leases(5)</a> die bij de port zit wordt dit uitvoeriger beschreven.</p></div></li><li><p><span class=filename>/usr/local/sbin/dhcrelay</span></p><div class=paragraph><p>dhcrelay wordt in uitgebreidere omgevingen gebruikt waar de ene DHCP-server een verzoek van een cliënt naar een andere DHCP-server op een ander netwerk doorstuurt. Als deze functionaliteit nodig is, kan die beschikbaar komen door de port <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-relay/>net/isc-dhcp42-relay</a> te installeren. De hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcrelay&amp;sektion=8&amp;format=html">dhcrelay(8)</a> die bij de port zit bevat meer details.</p></div></li></ul></div></div></div></div><div class=sect2><h3 id=network-dns>29.6. Domeinnaamsysteem (DNS)<a class=anchor href=#network-dns></a></h3><div class=sect3><h4 id=_overzicht_3>29.6.1. Overzicht<a class=anchor href=#_overzicht_3></a></h4><div class=paragraph><p>FreeBSD gebruikt standaard een versie van BIND (Berkeley Internet Name Domain), wat de meest gebruikte implementatie van het DNS-protocol is. DNS is het protocol waarmee namen aan IP-adressen gebonden worden en vice versa. Zo wordt bijvoorbeeld op een zoekopdracht voor <code>www.FreeBSD.org</code> geantwoord met het IP-adres van de webserver van het FreeBSD Project en op een zoekopdracht voor <code>ftp.FreeBSD.org</code> wordt geantwoord met het IP-adres van de bijbehorende FTP-machine. Het tegenovergestelde kan ook gebeuren. Een zoekopdracht voor een IP-adres kan de bijbehorende hostnaam opleveren. Het is niet nodig om een naamserver te draaien om op een systeem zoekopdrachten met DNS uit te voeren.</p></div><div class=paragraph><p>FreeBSD wordt momenteel standaard geleverd met de BIND9 DNS-serversoftware. Onze installatie biedt verbeterde beveilingsmogelijkheden, een nieuwe indeling van het bestandssysteem en geautomatiseerde configuratie van <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a>.</p></div><div class=paragraph><p>DNS wordt op Internet onderhouden door een enigszins complex systeem van autoritaire root, Top Level Domain (TLD), en andere kleinschaligere naamservers die individuele domeininformatie hosten en cachen.</p></div><div class=paragraph><p>Op dit moment wordt BIND beheerd door het Internet Systems Consortium <a href=https://www.isc.org/>https://www.isc.org/</a>.</p></div></div><div class=sect3><h4 id=_terminologie>29.6.2. Terminologie<a class=anchor href=#_terminologie></a></h4><div class=paragraph><p>Om dit document te begrijpen moeten een aantal termen gerelateerd aan DNS begrepen worden.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Term</th><th class="tableblock halign-left valign-top">Definitie</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Voorwaartse DNS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het afbeelden van hostnamen op IP-adressen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Herkomst (origin)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Verwijst naar het domein dat door een bepaald zonebestand wordt gedekt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>named, BIND</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vaak gebruikte namen voor het naamserverpakket BIND in FreeBSD.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Resolver</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een systeemproces waarmee een machine zoekopdrachten om zoneinformatie aan een naamserver geeft.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Reverse DNS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het afbeelden van IP-adressen op hostnamen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Rootzone</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het begin van de Internet zonehiërarchie. Alle zones vallen onder de rootzone, net zoals alle bestanden in een bestandssysteem onder de rootmap vallen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Zone</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een individueel domein, subdomein of een deel van de DNS die door dezelfde autoriteit wordt beheerd.</p></td></tr></tbody></table><div class=paragraph><p>Voorbeelden van zones:</p></div><div class=ulist><ul><li><p><code>.</code> is hoe de rootzone normaliter in de documentatie genoemd wordt.</p></li><li><p><code>org.</code> is een Top Level Domain (TLD) onder de rootzone.</p></li><li><p><code>example.org.</code> is een zone onder het TLD <code>org.</code>.</p></li><li><p><code>1.168.192.in-addr.arpa</code> is een zone die naar alle IP-adressen verwijst die onder de IP-adresruimte <code>192.168.1.*</code> vallen.</p></li></ul></div><div class=paragraph><p>Zoals te zien is staat het specifiekere deel van een hostnaam aan de linkerkant. Zo is bijvoorbeeld <code>example.org.</code> specifieker dan <code>org.</code> en is <code>org.</code> specifieker dan de rootzone. De indeling van ieder deel van een hostnaam lijkt veel op een bestandssysteem: de map <span class=filename>/dev</span> valt onder de root, enzovoort.</p></div></div><div class=sect3><h4 id=_redenen_om_een_naamserver_te_draaien>29.6.3. Redenen om een naamserver te draaien<a class=anchor href=#_redenen_om_een_naamserver_te_draaien></a></h4><div class=paragraph><p>Naamservers bestaan in het algemeen in twee smaken: autoratieve naamservers en caching (ook bekend als resolving) naamservers.</p></div><div class=paragraph><p>Er is een autoratieve naamserver nodig als:</p></div><div class=ulist><ul><li><p>Het gewenst is om DNS-informatie aan te bieden aan de wereld om met autoriteit op verzoeken te antwoorden.</p></li><li><p>Een domein, zoals <code>example.org</code>, is geregistreerd en er IP-adressen aan hostnamen die daaronder liggen toegewezen moeten worden.</p></li><li><p>Een IP-adresblok omgekeerde DNS-ingangen nodig heeft (IP naar hostnaam).</p></li><li><p>Een omgekeerde of tweede naamserver, die een slaaf wordt genoemd, moet antwoorden op verzoeken.</p></li></ul></div><div class=paragraph><p>Er is een caching naamserver nodig als:</p></div><div class=ulist><ul><li><p>Een lokale DNS-server kan cachen en wellicht sneller kan antwoorden dan een naamserver die verder weg staat.</p></li></ul></div><div class=paragraph><p>Als er een verzoek wordt gedaan voor <code>www.FreeBSD.org</code>, dan doet de resolver meestal een verzoek bij de naamserver van de ISP die de uplink levert en ontvangt daarop een antwoord. Met een lokale, caching DNS-server hoeft het verzoek maar één keer door de caching DNS-server naar de buitenwereld gedaan te worden. Voor aanvullende verzoeken hoeft niet buiten het lokale netwerk te gaan omdat het al lokaal in de cache staat.</p></div></div><div class=sect3><h4 id=_hoe_het_werkt_2>29.6.4. Hoe het werkt<a class=anchor href=#_hoe_het_werkt_2></a></h4><div class=paragraph><p>De daemon BIND heet in FreeBSD named.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Bestand</th><th class="tableblock halign-left valign-top">Beschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De daemon BIND.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=rndc&amp;sektion=8&amp;format=html">rndc(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Naamserverbeheerprogramma.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/namedb</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Map waar zoneinformatie van BIND staat.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/namedb/named.conf</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Instellingenbestand van de daemon.</p></td></tr></tbody></table><div class=paragraph><p>Afhankelijk van hoe en gegeven zone op de server is geconfigureerd, staan de bestanden gerelateerd aan die zone in de submappen <span class=filename>master</span>, <span class=filename>slave</span>, of <span class=filename>dynamic</span> van de map <span class=filename>/etc/namedb</span>. Deze bestanden bevatten de DNS-informatie die door de naamserver als antwoord op zoekopdrachten gegeven zal worden.</p></div></div><div class=sect3><h4 id=_bind_starten>29.6.5. BIND starten<a class=anchor href=#_bind_starten></a></h4><div class=paragraph><p>Omdat BIND standaard wordt geïnstalleerd, is het instellen relatief eenvoudig.</p></div><div class=paragraph><p>De standaardconfiguratie van named is die van een eenvoudige resolverende naamserver, draaiende in een <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a>-omgeving, en beperkt tot het luisteren op het lokale IPv4-teruglusadres (127.0.0.1). Gebruik het volgende commando om de server eenmaal met deze configuratie te starten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service named onestart</span></code></pre></div></div><div class=paragraph><p>Om er zeker van te zijn dat de daemon named elke keer bij het opstarten gestart wordt, moet de volgende regel in <span class=filename>/etc/rc.conf</span> gezet worden:</p></div><div class="literalblock programlisting"><div class=content><pre>named_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het is duidelijk dat er vele instelopties voor <span class=filename>/etc/namedb/named.conf</span> zijn die buiten het bereik van dit document vallen. Als u echter geïnteresseerd bent in de opstartopties voor named op FreeBSD, bekijk dan de <code>named_*</code>-vlaggen in <span class=filename>/etc/defaults/rc.conf</span> en raadpleeg de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a>. De sectie <a href=./#configtuning-rcd>Gebruik van rc met FreeBSD</a> is ook nuttig om te lezen.</p></div></div><div class=sect3><h4 id=_instellingenbestanden_2>29.6.6. Instellingenbestanden<a class=anchor href=#_instellingenbestanden_2></a></h4><div class=paragraph><p>Instellingenbestanden voor named bevinden zich momenteel in <span class=filename>/etc/namedb</span> en moeten gewijzigd worden voor gebruik, tenzij er alleen een eenvoudige resolver nodig is. Hier vindt de meeste configuratie plaats.</p></div><div class=sect4><h5 id=_etcnamedbnamed_conf>29.6.6.1. <span class=filename>/etc/namedb/named.conf</span><a class=anchor href=#_etcnamedbnamed_conf></a></h5><div class="literalblock programlisting"><div class=content><pre>// $FreeBSD$
//
// In de handleidingpagina&#39;s named.conf(5) en named(8), en in de
// documentatie in /usr/shared/doc/bind9 zijn meer details te vinden.
//
// Voor het opzetten van een autoratieve server is een grondig begrip
// van de werking van DNS noodzakelijk.  Zelfs eenvoudige fouten kunnen // de werking verstoren voor beïnvloede partijen of veel onnodig
// Internetverkeer veroorzaken.

options {
       // Alle namen van bestanden en paden zijn relatief aan de chroot-map,
       // indien aanwezig, en moeten volledig gekwalificeerd zijn.
       directory       &#34;/etc/namedb/working&#34;;
       pid-file        &#34;/var/run/named/pid&#34;
       dump-file       &#34;/var/dump/named_dump.db&#34;
       statistics-file &#34;/var/stats/named.stats&#34;

// Als named alleen als een lokale resolver gebruikt wordt, is dit een
// veilige standaardinstelling.  Om named toegang tot het netwerk te
// verschaffen, dient deze optie gecommentarieerd te worden, het
// juiste IP-adres opgegeven te worden, of dient deze optie verwijderd
// te worden.
       listen-on       { 127.0.0.1; };

// Als u IPv6 aan heeft staan op dit systeem, dient deze optie
// uitgecommentarieerd te worden om als lokale resolver te dienen.  Om
// toegang tot het netwerk te verschaffen, dient een IPv6-adres of het
// sleutelwoord &#34;any&#34; gegeven te worden.
//     listen-on-v6    { ::1; };

// Deze zones zijn reeds opgenomen door de lege zones die hieronder
// staan.  Als u de gerelateerde lege zones hieronder verwijdert,
// dienen deze regels uitgecommentarieerd te worden.
        disable-empty-zone &#34;255.255.255.255.IN-ADDR.ARPA&#34;;
        disable-empty-zone &#34;0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.IP6.ARPA&#34;;
        disable-empty-zone &#34;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.IP6.ARPA&#34;;

// Als er een DNS-server beschikbaar is bij een upstream provider dan
// kan het IP-adres op de regel hieronder ingegeven worden en kan die
// geactiveerd worden.  Hierdoor wordt voordeel gehaald uit de cache,
// waardoor het algehele DNS-verkeer op het Internet vermindert.
/*
       forwarders {
               127.0.0.1;
       };

*/

// Als de &#39;forwarders&#39;-clausule niet leeg is, is de standaard om &#34;forward
// first&#34; te gebruiken, welke terug zal vallen op het versturen van een
// verzoek naar uw lokale server als de naamservers in &#39;forwarders&#39; het
// antwoord niet weten.  Als alternatief kunt u uw naamserver dwingen om
// nooit zelf verzoeken in te dienen door de volgende regel aan te
// zetten:
//     forward only;

// Als u forwarding automatisch wilt configureren gebaseerd op de regels
// in /etc/resolv.conf, verwijder dan het commentaar van de volgende
// regel en stel in /etc/rc.conf named_auto_forward=yes in.  U kunt ook
// named_auto_forward_only aanzetten (het effect hiervan is hierboven
// beschreven).
//      include &#34;/etc/namedb/auto_forward.conf&#34;;</pre></div></div><div class=paragraph><p>Zoals al in het commentaar staat kan van een cache in de uplink geprofiteerd worden als <code>forwarders</code> ingeschakeld worden. Onder normale omstandigheden maakt een naamserver recursief verzoeken tot het Internet op zoek naar zekere naamservers tot er een antwoord komt waar het naar op zoek is. Door de bovenstaande optie in te schakelen wordt eerst de uplink naamserver (of de opgegeven naamserver) gevraagd, waardoor er gebruik gemaakt kan worden van de cache van die server. Als die uplink naamserver een drukke, snelle naamserver is, kan het erg de moeite waard zijn om dit aan te zetten.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p><code>127.0.0.1</code> werkt hier <em>niet</em>. Verander dit IP-adres in een naamserver in de uplink.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>/*
	  Moderne versies van BIND gebruiken standaard een random
	  UDP-poort voor elk uitgaand verzoek om de kans op cache
	  poisoning drastisch te verminderen.  Alle gebruikers wordt met
	  klem verzocht om deze mogelijkheid te gebruiken en hun
	  firewalls overeenkomstig aan te passen.

	  ALS EEN LAATSTE UITVLUCHT om een beperkende firewall te
	  omzeilen kunt u proberen om onderstaande optie aan te zetten.
	  Het gebruik van deze optie vermindert uw kans om een cache
	  poisoning aanval te weerstaan aanzienlijk, en dient indien
	  mogelijk te worden vermeden.

	  Vervang NNNNN in het voorbeeld door een getal tussen 49160 en
	  65530.
	*/
	// query-source address * port NNNNN;
};

// Als er een lokale naamserver wordt gebruikt, vergeet dan niet om
// eerst 127.0.0.1 in /etc/resolv.conf te zetten zodat die gevraagd
// wordt.  Controleer ook dat het in /etc/rc.conf is aangezet.

// Het traditionele root-hint-mechanisme.  Gebruik dit OF de
// onderstaande slaafzones.
zone &#34;.&#34; { type hint; file &#34;/etc/namedb/named.root&#34;; };

/*	Het slaaf maken van de volgende zones vanaf de root-naamservers
	heeft een aantal aanzienlijke voordelen:
	1. Snellere lokale resolutie voor uw gebruikers
	2. Geen vals verkeer dat vanaf uw netwerk naar de roots wordt verzonden
	3. Betere weerstand tegen elke mogelijk falen van de rootserver/DDoS

	Wel is het zo dat deze methode meer toezicht vraagt dan het
	hintbestand om er zeker van te zijn dat een onverwachte
	faalmodus uw server niet heeft lamgelegd.  Naamservers die
	veel clienten serveren zullen meer voordeel uit deze aanpak
	halen dan individuele hosts.  Met zorg gebruiken.

	Verwijder het commentaar uit de onderstaande regels en
	commentarieer de bovenstaande hintzone om dit mechanisme te
	gebruiken.

	Zoals gedocumenteerd op http://dns.icann.org/services/axfr/ zijn deze
	zones: &#34;.&#34; (de root), ARPA, IN-ADDR.ARPA, IP6.ARPA en ROOT-SERVERS.NET
	beschikbaar voor AXFR van deze servers op IPv4 en IPv6:
	xfr.lax.dns.icann.org, xfr.cjr.dns.icann.org
*/

zone &#34;.&#34; {
	type slave;
	file &#34;/etc/namedb/slave/root.slave&#34;;
	masters {
		192.5.5.241;	// F.ROOT-SERVERS.NET.
	};
	notify no;
};

zone &#34;arpa&#34; {
	type slave;
	file &#34;/etc/namedb/slave/arpa.slave&#34;;
	masters {
		192.5.5.241;	// F.ROOT-SERVERS.NET.
	};
	notify no;
};

/*	Het lokaal serveren van de volgende zones voorkomt dat enig
	verzoek voor deze zones uw netwerk verlaat en naar de
	root-naamservers gaat.  Dit heeft twee aanzienlijke voordelen:
	1. Snellere lokale resolutie voor uw gebruikers
	2. Er zal geen vals verkeer vanaf uw netwerk naar de roots worden verzonden
*/
// RFCs 1912 en 5735 (en BCP32 voor localhost)
zone &#34;localhost&#34;	{ type master; file &#34;/etc/namedb/master/localhost-forward.db&#34;; };
zone &#34;127.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/localhost-reverse.db&#34;; };
zone &#34;255.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// RFC 1912-stijl zone voor IPv6 localhost adres
zone &#34;0.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/localhost-reverse.db&#34;; };

// &#34;Dit&#34; netwerk (RFCs 1912 en 5735)
zone &#34;0.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// Netwerken voor privaat gebruik (RFC 1918 en 5735)
zone &#34;10.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;16.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;17.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;18.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;19.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;20.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;21.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;22.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;23.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;24.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;25.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;26.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;27.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;28.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;29.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;30.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;31.172.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;168.192.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// Lokale link/APIPA (RFCs 3927 en 5735)
zone &#34;254.169.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// IETF protocol-toewijzingen (RFCs 5735 en 5736)
zone &#34;0.0.192.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// TEST-NET-[1-3] voor documentatie (RFCs 5735 en 5737)
zone &#34;2.0.192.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;100.51.198.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;113.0.203.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// IPv6-bereik voor documentatie (RFC 3849)
zone &#34;8.b.d.0.1.0.0.2.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// Domeinnamen voor documentatie en testen (BCP 32)
zone &#34;test&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;example&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;invalid&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;example.com&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;example.net&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;example.org&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// Router benchmarken (RFC 2544 en 5735)
zone &#34;18.198.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;19.198.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }

// Gereserveerd door IANA - oude ruimte van klasse E (RFC 5735)
zone &#34;240.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;241.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;242.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;243.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;244.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;245.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;246.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;247.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;248.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;249.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;250.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;251.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;252.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;253.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;254.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }

// Niet-toegewezen IPv6-adressen (RFC 4291)
zone &#34;1.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;2.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;3.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;4.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;5.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;6.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;7.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;8.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;9.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;a.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;b.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;c.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;d.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;e.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;0.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;1.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;2.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;3.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;4.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;5.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;6.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;7.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;8.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;9.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;a.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;b.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;0.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;1.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;2.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;3.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;4.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;5.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;6.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;7.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }

// IPv6 ULA (RFC 4193)
zone &#34;c.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;d.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }

// IPv6 lokale link (RFC 4291)
zone &#34;8.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;9.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;a.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;b.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }

// IPv6 verouderde site-lokale adressen (RFC 3879)
zone &#34;c.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;d.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;e.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }
zone &#34;f.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }

// IP6.INT is verouderd (RFC 4159)
zone &#34;ip6.int&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; }

// NB: De IP-adressen hieronder zijn bedoeld als voorbeeld en dienen
//     niet gebruikt te worden!
//
// Voorbeeld instellingen voor slaafzones.  Het kan handig zijn om
// tenminste slaaf te worden voor de zone waar de host onderdeel van
// uitmaakt.  Bij uw netwerkbeheerder kan het IP-adres van de
// verantwoordelijke meester-naamserver nagevraagd worden.
//
// Vergeet niet om de omgekeerde lookup-zone op te nemen!
// Dit is genoemd na de eerste bytes van het IP-adres, in omgekeerde
// volgorde, met daarachter &#34;.IN-ADDR.ARPA&#34;, of &#34;IP6.ARPA&#34; voor IPv6.
//
// Het is van groot belang om de werking van DNS en BIND te begrijpen
// voordat er een meester-zone wordt opgezet.  Er zijn nogal wat
// onverwachte valkuilen.  Het opzetten van een slaafzone is
// gewoonlijk eenvoudiger.
//
// NB: Zet de onderstaande voorbeelden niet blindelings aan. :-)
// Gebruik in plaats hiervan echte namen en adressen.
/* Een voorbeeld van een dynamische zone
key &#34;exampleorgkey&#34; {
       algorithm hmac-md5;
       secret &#34;sf87HJqjkqh8ac87a02lla==&#34;;
};

zone &#34;example.org&#34; {
       type master;
       allow-update {
               key &#34;exampleorgkey&#34;;
       };
       file &#34;/etc/namedb/dynamic/example.org&#34;;
};
*/

/* Voorbeeld van een omgekeerde slaafzone
zone &#34;1.168.192.in-addr.arpa&#34; {
       type slave;
       file &#34;/etc/namedb/slave/1.168.192.in-addr.arpa&#34;;
       masters {
               192.168.1.1;
       };
};
*/</pre></div></div><div class=paragraph><p>In <span class=filename>named.conf</span> zijn dit voorbeelden van slaafregels voor een voorwaartse en een omgekeerde zone.</p></div><div class=paragraph><p>Voor iedere nieuwe zone die wordt aangeboden dient een nieuwe instelling voor de zone aan <span class=filename>named.conf</span> toegevoegd te worden.</p></div><div class=paragraph><p>De eenvoudigste instelling voor de zone <code>example.org</code> kan er als volgt uitzien:</p></div><div class="literalblock programlisting"><div class=content><pre>zone &#34;example.org&#34; {
	type master;
	file &#34;master/example.org&#34;;
};</pre></div></div><div class=paragraph><p>De zone is een master, zoals aangegeven door het statement <code>type</code>, waarvan de zoneinformatie in <span class=filename>/etc/namedb/example.org</span> staat, zoals het statement <code>file</code> aangeeft.</p></div><div class="literalblock programlisting"><div class=content><pre>zone &#34;example.org&#34; {
	type slave;
	file &#34;slave/example.org&#34;;
};</pre></div></div><div class=paragraph><p>In het geval van de slaaf wordt de zoneinformatie voor een zone overgedragen van de master naamserver en opgeslagen in het ingestelde bestand. Als de masterserver het niet meer doet of niet bereikbaar is, dan heeft de slaveserver de overgedragen zoneinformatie nog en kan het die aanbieden.</p></div></div><div class=sect4><h5 id=_zonebestanden>29.6.6.2. Zonebestanden<a class=anchor href=#_zonebestanden></a></h5><div class=paragraph><p>Een voorbeeldbestand voor een masterzone voor <code>example.org</code> (bestaande binnen <span class=filename>/etc/namedb/master/example.org</span>) ziet er als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>$TTL 3600        ; 1 uur standaard TTL
example.org.     IN      SOA      ns1.example.org. admin.example.org. (
                                 2006051501      ; Serienummer
                                 10800           ; Verversen
                                 3600            ; Opnieuw proberen
                                 604800          ; Verlopen
                                 300             ; Negatieve antwoord-TTL
                         )

; DNS Servers
                 IN      NS      ns1.example.org.
                 IN      NS      ns2.example.org.

; MX Records
                 IN      MX 10   mx.example.org.
                 IN      MX 20   mail.example.org.

                 IN      A       192.168.1.1

; Machinenamen
localhost        IN      A       127.0.0.1
ns1              IN      A       192.168.1.2
ns2              IN      A       192.168.1.3
mail             IN      A       192.168.1.4
mx               IN      A       192.168.1.5

; Aliases
www              IN      CNAME   example.org.</pre></div></div><div class=paragraph><p>Iedere hostnaam die eindigt op een "." is een exacte hostnaam, terwijl alles zonder een "." op het einde relatief is aan de oorsprong. Zo wordt <code>ns1</code> bijvoorbeeld vertaald naar <code>ns1.example.org.</code>.</p></div><div class=paragraph><p>De regels in een zonebestand volgen de volgende opmaak:</p></div><div class="literalblock programlisting"><div class=content><pre>recordnaam      IN recordtype   waarde</pre></div></div><div class=paragraph><p>De meest gebruikte DNS-records:</p></div><div class=dlist><dl><dt class=hdlist1>SOA</dt><dd><p>begin van autoriteit (start of authority)</p></dd><dt class=hdlist1>NS</dt><dd><p>een bevoegde (autoratieve) name server</p></dd><dt class=hdlist1>A</dt><dd><p>een hostadres</p></dd><dt class=hdlist1>CNAME</dt><dd><p>de canonieke naam voor een alias</p></dd><dt class=hdlist1>MX</dt><dd><p>mail exchanger</p></dd><dt class=hdlist1>PTR</dt><dd><p>een domeinnaam pointer (gebruikt in omgekeerde DNS)</p></dd></dl></div><div class="literalblock programlisting"><div class=content><pre>example.org. IN SOA ns1.example.org. admin.example.org. (
                        2006051501      ; Serienummer
                        10800           ; Ververs na 3 uur
                        3600            ; Opnieuw proberen na 1 uur
                        604800          ; Verlopen na 1 week
                        300             ; Negatieve antwoord-TTL</pre></div></div><div class=dlist><dl><dt class=hdlist1><code>example.org.</code></dt><dd><p>de domeinnaam, ook de oorsprong voor dit zonebestand.</p></dd><dt class=hdlist1><code>ns1.example.org.</code></dt><dd><p>de primaire/bevoegde naamserver voor deze zone.</p></dd><dt class=hdlist1><code>admin.example.org.</code></dt><dd><p>de persoon die verantwoordelijk is voor deze zone, emailadres met "@" vervangen. <a href=mailto:admin@example.org>admin@example.org</a> wordt <code>admin.example.org</code>.</p></dd><dt class=hdlist1><code>2006051501</code></dt><dd><p>het serienummer van het bestand. Dit moet iedere keer als het zonebestand wordt aangepast opgehoogd worden. Tegenwoordig geven veel beheerders de voorkeur aan de opmaak <code>yyyymmddrr</code> voor het serienummer. <code>2006051501</code> betekent dan dat het voor het laatst is aangepast op 15-05-2006, de laatste <code>01</code> betekent dat het zonebestand die dag voor het eerst is aangepast. Het serienummer is belangrijk omdat het slaafnaamservers aangeeft dat een zone is bijgewerkt.</p></dd></dl></div><div class="literalblock programlisting"><div class=content><pre>       IN NS           ns1.example.org.</pre></div></div><div class=paragraph><p>Hierboven staat een NS-regel. Voor iedere naamserver die bevoegde antwoorden moet geven voor de zone hoort er zo’n regel te zijn.</p></div><div class="literalblock programlisting"><div class=content><pre>localhost       IN      A       127.0.0.1
ns1             IN      A       192.168.1.2
ns2             IN      A       192.168.1.3
mx              IN      A       192.168.1.4
mail            IN      A       192.168.1.5</pre></div></div><div class=paragraph><p>Een A-record geeft een machinenaam aan. Hierboven is te zien dat <code>ns1.example.org</code> zou resolven naar <code>192.168.1.2</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>       IN      A       192.168.1.1</pre></div></div><div class=paragraph><p>Deze regel kent IP-adres <code>192.168.1.1</code> toe aan de huidige oorsprong, in dit geval <code>example.org</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>www             IN CNAME        @</pre></div></div><div class=paragraph><p>Een canoniek naamrecord wordt meestal gebruikt voor het geven van aliassen aan een machine. In het voorbeeld is <code>www</code> een alias naar de "master" machine waarvan de naam gelijk is aan de domeinnaam <code>example.org</code> (<code>192.168.1.1</code>). CNAME’s kunnen nooit samen met een ander soort record voor dezelfde hostnaam gebruikt worden.</p></div><div class="literalblock programlisting"><div class=content><pre>               IN MX   10      mail.example.org.</pre></div></div><div class=paragraph><p>MX records geven aan welke mailservers verantwoordelijk zijn voor het afhandelen van inkomende mail voor de zone. <code>mail.example.org</code> is de hostnaam van een mailserver en 10 is de prioriteit voor die mailserver.</p></div><div class=paragraph><p>Het is mogelijk meerdere mailservers in te stellen met prioriteiten 10, 20, enzovoorts. Een mailserver die probeert mail af te leveren voor <code>example.org</code> probeert dat eerst bij de MX met de hoogste prioriteit (het record met het laagste prioriteitsnummer), daarna de tweede hoogste, enzovoort, totdat de mail afgeleverd kan worden.</p></div><div class=paragraph><p>Voor in-addr.arpa zonebestanden (omgekeerd DNS) wordt dezelfde opmaak gebruikt, maar dan met PTR-regels in plaats van A of CNAME.</p></div><div class="literalblock programlisting"><div class=content><pre>$TTL 3600

1.168.192.in-addr.arpa. IN SOA ns1.example.org. admin.example.org. (
                        2006051501      ; Serienummer
                        10800           ; Ververs
                        3600            ; Opnieuw proberen
                        604800          ; Verlopen
                        300 )           ; Negatieve antwoord-TTL

        IN      NS      ns1.example.org.
        IN      NS      ns2.example.org.

1       IN      PTR     example.org.
2       IN      PTR     ns1.example.org.
3       IN      PTR     ns2.example.org.
4       IN      PTR     mx.example.org.
5       IN      PTR     mail.example.org.</pre></div></div><div class=paragraph><p>Dit bestand geeft de juiste IP-adressen voor hostnamen in het voorbeelddomein hierboven.</p></div><div class=paragraph><p>Het is het vernoemen waard dat alle namen aan de rechterkant van een PTR-record volledig gekwalificeerd dienen te zijn (i.e., met een "." eindigen).</p></div></div></div><div class=sect3><h4 id=_caching_naamserver>29.6.7. Caching naamserver<a class=anchor href=#_caching_naamserver></a></h4><div class=paragraph><p>Een caching naamserver is een naamserver wiens primaire rol het oplossen van recursieve verzoeken is. Het dient simpelweg zelf verzoeken in en onthoudt de antwoorden voor later gebruik.</p></div></div><div class=sect3><h4 id=_dnssec>29.6.8. DNSSEC<a class=anchor href=#_dnssec></a></h4><div class=paragraph><p>Domain Name Security System Extensions, ofwel DNSSEC, is een verzameling van specificaties om resolvende naamservers te beschermen tegen valse DNS-gegevens, zoals vervalste DNS-records. Door digitale handtekeningen te gebruiken kan een resolver de integriteit van een record controleren. Merk op dat DNSSEC alleen integriteit biedt via het digitaal ondertekenen van het Resource Record (RRs). Het biedt noch betrouwbaarheid noch bescherming tegen onjuiste aannames van eindgebruikers. Dit betekent dat het mensen niet kan beschermen tegen het bezoeken van <code>example.net</code> in plaats van <code>example.com</code>. Het enige wat DNSSEC doet is authenticeren dat de gegevens niet tijdens het transport zijn gecompromitteerd. De beveiliging van DNSSEC is een belangrijke stap in het beveiligen van het internet in het algemeen. De relevante RFCs zijn een goed beginpunt voor meer gedetailleerde gegevens over hoe DNSSEC werkt. Raadpleeg de lijst in <a href=#dns-read>Verder lezen</a>.</p></div><div class=paragraph><p>De volgende secties laten zien hoe DNSSEC voor een autoratieve DNS-server en een recursieve (of caching) DNS-server die BIND 9 draait kan worden bewerkstelligd. Hoewel alle versies van BIND 9 DNSSEC ondersteunen, is tenminste versie 9.6.2 nodig om gebruik te kunnen maken van de ondertekende rootzones tijdens het valideren van DNS-verzoeken. Dit komt doordat eerdere versies de benodigde algoritmes om validatie met de sleutel voor de rootzone te uit te voeren niet hebben. Het wordt sterk aangeraden om de nieuwste versie van BIND 9.7 te gebruiken om gebruik te kunnen maken van automatische sleutel-updates voor de rootsleutel en van andere mogelijkheden om zones ondertekend en sleutel up-to-date te houden. Wanneer configuraties tussen 9.6.2 en 9.7 en later verschillen, zullen deze worden toegelicht.</p></div><div class=sect4><h5 id=_configuratie_van_een_recursieve_dns_server>29.6.8.1. Configuratie van een recursieve DNS-server<a class=anchor href=#_configuratie_van_een_recursieve_dns_server></a></h5><div class=paragraph><p>Het aanzetten van DNSSEC-validatie van verzoeken die door een recursieve DNS-server worden uitgevoerd heeft enkele aanpassingen aan <span class=filename>named.conf</span> nodig. Voordat deze wijzigingen worden gemaakt dient de rootzone-sleutel, of vertrouwensanker, te worden opgehaald. Momenteel is de rootzone-sleutel niet beschikbaar in een bestandsformaat dat BIND begrijpt, dus moet het handmatig in het juiste formaat omgezet worden. De sleutel zelf kan verkregen worden door de rootzone ervoor met dig te ondervragen. Door</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% dig +multi +noall +answer DNSKEY <span class=nb>.</span> <span class=o>&gt;</span> root.dnskey</code></pre></div></div><div class=paragraph><p>te draaien, wordt de sleutel in <span class=filename>root.dnskey</span> opgeslagen. De inhoud dient er ongeveer als volgt uit te zien:</p></div><div class="literalblock programlisting"><div class=content><pre>. 93910 IN DNSKEY 257 3 8 (
	AwEAAagAIKlVZrpC6Ia7gEzahOR+9W29euxhJhVVLOyQ
	bSEW0O8gcCjFFVQUTf6v58fLjwBd0YI0EzrAcQqBGCzh
	/RStIoO8g0NfnfL2MTJRkxoXbfDaUeVPQuYEhg37NZWA
	JQ9VnMVDxP/VHL496M/QZxkjf5/Efucp2gaDX6RS6CXp
	oY68LsvPVjR0ZSwzz1apAzvN9dlzEheX7ICJBBtuA6G3
	LQpzW5hOA2hzCTMjJPJ8LbqF6dsV6DoBQzgul0sGIcGO
	Yl7OyQdXfZ57relSQageu+ipAdTTJ25AsRTAoub8ONGc
	LmqrAmRLKBP1dfwhYB4N7knNnulqQxA+Uk1ihz0=
	) ; key id = 19036
. 93910 IN DNSKEY 256 3 8 (
	AwEAAcaGQEA+OJmOzfzVfoYN249JId7gx+OZMbxy69Hf
	UyuGBbRN0+HuTOpBxxBCkNOL+EJB9qJxt+0FEY6ZUVjE
	g58sRr4ZQ6Iu6b1xTBKgc193zUARk4mmQ/PPGxn7Cn5V
	EGJ/1h6dNaiXuRHwR+7oWh7DnzkIJChcTqlFrXDW3tjt
	) ; key id = 34525</pre></div></div><div class=paragraph><p>Schrik niet als de verkregen sleutels anders zijn dan in dit voorbeeld. Ze kunnen zijn veranderd nadat deze instructies voor het laatst waren bijgewerkt. De uitvoer bevat in feite twee sleutels. De eerste sleutel, met de waarde 257 na het DNSKEY-recordtype, is degene die nodig is. Deze waarde geeft aan dat dit een Secure Entry Point ( SEP) is, beter bekend als een Key Signing Key (KSK). De tweede sleutel, met de waarde 256, is een deelsleutel, beter bekend als een Zone Signing Key (ZSK). Meer over de verschillende soorten sleutels komt aan bod in <a href=#dns-dnssec-auth>Configuratie van een autoratieve DNS-server</a>.</p></div><div class=paragraph><p>Nu moet de sleutel gecontroleerd en geformatteerd worden zodat BIND deze kan gebruiken. Maak om de sleutel te controleren een DS - RR-paar aan. Maak een bestand aan dat deze RRs bevat aan met</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% dnssec-dsfromkey <span class=nt>-f</span> root-dnskey <span class=nb>.</span> <span class=o>&gt;</span> root.ds</code></pre></div></div><div class=paragraph><p>Deze records gebruiken respectievelijk SHA-1 en SHA-256, en dienen er als het volgende voorbeeld uit te zien, waarbij het langere record SHA-256 gebruikt.</p></div><div class="literalblock programlisting"><div class=content><pre>. IN DS 19036 8 1 B256BD09DC8DD59F0E0F0D8541B8328DD986DF6E
. IN DS 19036 8 2 49AAC11D7B6F6446702E54A1607371607A1A41855200FD2CE1CDDE32F24E8FB5</pre></div></div><div class=paragraph><p>Het SHA-256 RR kan nu worden vergeleken met de digest in <a href=https://data.iana.org/root-anchors/root-anchors.xml>https://data.iana.org/root-anchors/root-anchors.xml</a>. Om er absoluut zeker van te zijn dat er niet geknoeid is met de sleutel kunnen de gegevens in het XML-bestand worden gecontroleerd met de PGP-handtekening in <a href=https://data.iana.org/root-anchors/root-anchors.asc>https//data.iana.org/root-anchors/root-anchors.asc</a>.</p></div><div class=paragraph><p>Vervolgens dient de sleutel juist geformateerd te worden. Dit verschilt een beetje tussen versie 9.6.2 en versie 9.7 en later van BIND. In versie 9.7 is ondersteuning toegevoegd om automatisch veranderingen aan de sleutel te volgen en deze bij te werken indien nodig. Dit wordt gedaan met <code>managed-keys</code> zoals in het volgende voorbeeld te zien is. Als de oudere versie gebruikt wordt, wordt de sleutel toegevoegd met een commando <code>trusted-keys</code> en dient deze handmatig bijgewerkt te worden. Voor BIND 9.6.2 ziet het formaat er uit als:</p></div><div class="literalblock programlisting"><div class=content><pre>trusted-keys {
	&#34;.&#34; 257 3 8
	&#34;AwEAAagAIKlVZrpC6Ia7gEzahOR+9W29euxhJhVVLOyQbSEW0O8gcCjF
	FVQUTf6v58fLjwBd0YI0EzrAcQqBGCzh/RStIoO8g0NfnfL2MTJRkxoX
	bfDaUeVPQuYEhg37NZWAJQ9VnMVDxP/VHL496M/QZxkjf5/Efucp2gaD
	X6RS6CXpoY68LsvPVjR0ZSwzz1apAzvN9dlzEheX7ICJBBtuA6G3LQpz
	W5hOA2hzCTMjJPJ8LbqF6dsV6DoBQzgul0sGIcGOYl7OyQdXfZ57relS
	Qageu+ipAdTTJ25AsRTAoub8ONGcLmqrAmRLKBP1dfwhYB4N7knNnulq
	QxA+Uk1ihz0=&#34;;
};</pre></div></div><div class=paragraph><p>Voor versie 9.7 ziet het formaat er echter zo uit:</p></div><div class="literalblock programlisting"><div class=content><pre>managed-keys {
	&#34;.&#34; initial-key 257 3 8
	&#34;AwEAAagAIKlVZrpC6Ia7gEzahOR+9W29euxhJhVVLOyQbSEW0O8gcCjF
	FVQUTf6v58fLjwBd0YI0EzrAcQqBGCzh/RStIoO8g0NfnfL2MTJRkxoX
	bfDaUeVPQuYEhg37NZWAJQ9VnMVDxP/VHL496M/QZxkjf5/Efucp2gaD
	X6RS6CXpoY68LsvPVjR0ZSwzz1apAzvN9dlzEheX7ICJBBtuA6G3LQpz
	W5hOA2hzCTMjJPJ8LbqF6dsV6DoBQzgul0sGIcGOYl7OyQdXfZ57relS
	Qageu+ipAdTTJ25AsRTAoub8ONGcLmqrAmRLKBP1dfwhYB4N7knNnulq
	QxA+Uk1ihz0=&#34;;
};</pre></div></div><div class=paragraph><p>De rootsleutel kan nu aan <span class=filename>named.conf</span> worden toegevoegd, ofwel direct of door een bestand dat de sleutel bevat te includen. Stel na deze stappen BIND in zodat het DNSSEC-validatie uitvoert op verzoeken door <span class=filename>named.conf</span> te bewerken en het volgende aan de directief <code>options</code> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>dnssec-enable yes;
dnssec-validation yes;</pre></div></div><div class=paragraph><p>Om te controleren dat het ook echt werkt, kan dig gebruikt worden om een verzoek op een ondertekende zone uit te voeren met de zojuist geconfigureerde resolver. Een succesvol antwoord zal de vlag <code>AD</code> bevatten om aan te geven dat de gegevens zijn geautenticeerd. Een verzoek als</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% dig @resolver +dnssec se ds</code></pre></div></div><div class=paragraph><p>zou het DSRR paar voor de <code>.se</code>-zone moeten teruggeven. In de sectie <code>flags:</code> moet de vlag <code>AD</code> te zien zijn, als in:</p></div><div class="literalblock programlisting"><div class=content><pre>...
;; flags: qr rd ra ad; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 1
...</pre></div></div><div class=paragraph><p>De resolver is nu in staat om DNS-verzoeken te autenticeren.</p></div></div><div class=sect4><h5 id=dns-dnssec-auth>29.6.8.2. Configuratie van een autoratieve DNS-server<a class=anchor href=#dns-dnssec-auth></a></h5><div class=paragraph><p>Om een autoratieve naamserver een met DNSSEC ondertekende zone te laten serveren is wat meer werk nodig. Een zone wordt ondertekend met cryptografische sleutels die aangemaakt moeten worden. Het is mogelijk om hier slechts één sleutel voor te gebruiken. De methode die de voorkeur verdient is echter om een sterke, goed beschermde Key Signing Key (KSK) die niet vaak wordt geroteerd en een Zone Signing Key (ZSK) die vaker wordt geroteerd te hebben. Informatie over aanbevolen procedures staat in <a href=http://tools.ietf.org/rfc/rfc4641.txt>RFC 4641: DNSSEC Operational Practices</a>. Procedures betreffende de rootzone staan in <a href=http://www.root-dnssec.org/wp-content/uploads/2010/06/icann-dps-00.txt>DNSSEC Practice Statement for the Root Zone KSK operator</a> en <a href=http://www.root-dnssec.org/wp-content/uploads/2010/06/vrsn-dps-00.txt>DNSSEC Practice Statement for the Root Zone ZSK operator</a>. De KSK wordt gebruikt om een autoriteitsketen voor de te valideren gegevens op te bouwen en wordt daarom ook een Secure Entry Point (SEP)-sleutel genoemd. Een bericht-digest van deze sleutel, dat Delegation Signer (DS)-record genoemd wordt, moet gepubliceerd zijn in de ouderzone om een vertrouwensketen op te bouwen. Hoe dit bereikt wordt hangt af van de eigenaar van de ouderzone. De ZSK wordt gebruikt om de zone te ondertekenen, en hoeft alleen daar gepubliceerd te worden.</p></div><div class=paragraph><p>Om DNSSEC aan te zetten voor de zone <code>example.com</code> zoals beschreven in de voorgaande voorbeelden, dient als eerste dnssec-keygen gebruikt te worden om het sleutelpaar met de KSK en ZSK te genereren. Dit sleutelpaar kan verschillende cryptografische algoritmes gebruiken. Het wordt aanbevolen om RSA/SHA-256 voor de sleutels te gebruiken, een sleutellengte van 2048 bits zou voldoende moeten zijn. Om de KSK voor <code>example.com</code> te genereren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% dnssec-keygen <span class=nt>-f</span> KSK <span class=nt>-a</span> RSASHA256 <span class=nt>-b</span> 2048 <span class=nt>-n</span> ZONE example.com</code></pre></div></div><div class=paragraph><p>en om de ZSK te genereren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% dnssec-keygen <span class=nt>-a</span> RSASHA256 <span class=nt>-b</span> 2048 <span class=nt>-n</span> ZONE example.com</code></pre></div></div><div class=paragraph><p>dnssec-keygen maakt twee bestanden, de publieke en private sleutels in bestanden met namen als <span class=filename>Kexample.com.+005+nnnnn.key</span> (publiek) en <span class=filename>Kexample.com.+005+nnnnn.private</span> (privaat). Het gedeelte <code>nnnnn</code> van de bestandsnaam is een sleutel-ID van vijf cijfers. Houd bij welke sleutel-ID bij welke sleutel hoort. Dit is in het bijzonder van belang wanneer er meerdere sleutels per zone zijn. Het is ook mogelijk om de sleutels te hernoemen. Voor elk KSK-bestand:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>mv </span>Kexample.com.+005+nnnnn.key Kexample.com.+005+nnnn.KSK.key
% <span class=nb>mv </span>Kexample.com.+005+nnnnn.private Kexample.com.+005+nnnnn.KSK.private</code></pre></div></div><div class=paragraph><p>Voor ZSK-bestanden dient <code>KSK</code> waar nodig door <code>ZSK</code> vervangen te worden. De bestanden kunnen nu worden opgenomen in het zonebestand, door de opdracht <code>$include</code> te gebruiken. Het zou er ongeveer als volgt uit moeten zien:</p></div><div class="literalblock programlisting"><div class=content><pre>$include Kexample.com.+005+nnnnn.KSK.key ; KSK
$include Kexample.com.+005+nnnnn.ZSK.key ; ZSK</pre></div></div><div class=paragraph><p>Onderteken tenslotte de zone en vertel BIND om het ondertekende zonebestand te gebruiken. Voor het ondertekenen van een zone wordt dnssec-signzone gebruikt. Het commando om de zone <code>example.com</code>, dat zich in <span class=filename>example.com.db</span> bevindt, zou er ongeveer zo uit moeten zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% dnssec-signzone <span class=nt>-o</span> example.com <span class=nt>-k</span> Kexample.com.+005+nnnnn.KSK example.com.db Kexample.com.+005+nnnnn.ZSK.key</code></pre></div></div><div class=paragraph><p>De sleutel die aan het argument <code>-k</code> wordt meegegeven is de KSK en het andere sleutelbestand is de ZSK dat bij het ondertekenen gebruikt moet worden. Het is mogelijk om meer dan één KSK en ZSK op te geven, wat tot gevolg heeft dat de zone met alle meegegeven sleutels wordt ondertekend. Dit kan nodig zijn om zonegegevens aan te leveren die met meerdere algoritmes zijn ondertekend. De uitvoer van dnssec-signzone is een zonebestand met daarin alle RRs ondertekend. Deze uitvoer komt in een bestand met de extensie <code>.signed</code> terecht, zoals <span class=filename>example.com.db.signed</span>. De DS-records worden ook naar een apart bestand <span class=filename>dsset-example.com</span> geschreven. Om deze ondertekende zone te gebruiken hoeft alleen de zone-directief in <span class=filename>named.conf</span> veranderd te worden om <span class=filename>example.com.db.signed</span>. Standaard zijn de ondertekeningen slechts 30 dagen geldig, wat betekent dat de zone over ongeveer 15 dagen hertekend moet worden om er zeker van te zijn dat resolvers geen records met oude ondertekeningen cachen. Het is mogelijk om hiervoor een script en een crontaak te maken. Bekijk de relevante handleidingen voor details.</p></div><div class=paragraph><p>Zorg ervoor dat de private sleutels veilig blijven, zoals met alle cryptografische sleutels. Bij het veranderen van een sleutel kan het beste de nieuwe sleutel in de zone opgenomen worden, en nog met de oude sleutel te ondertekenen, en om daarna over te stappen op de nieuwe sleutel. Nadat deze handelingen zijn voltooid kan de oude sleutel uit de zone worden verwijderd. Wanneer dit niet wordt gedaan kunnen de DNS-gegevens tijdelijk onbeschikbaar zijn totdat de nieuwe sleutel door de DNS-hiërarchie is gepropageerd. Meer informatie over sleutelwisselingen en andere praktijken rondom DNSSEC staan in <a href=http://www.ietf.org/rfc/rfc4641.txt>RFC 4641: DNSSEC Operational practices</a>.</p></div></div><div class=sect4><h5 id=_automatisering_met_bind_9_7_of_nieuwer>29.6.8.3. Automatisering met BIND 9.7 of nieuwer<a class=anchor href=#_automatisering_met_bind_9_7_of_nieuwer></a></h5><div class=paragraph><p>In versie 9.7 van BIND is een nieuwe mogelijkheid genaamd <em>Smart Signing</em> geïntroduceerd. Deze mogelijkheid heeft als doel om het sleutelbeheer en ondertekenproces eenvoudiger te maken door delen van deze taken te automatiseren. Door de sleutels in een <em>sleutelreservoir</em> te stoppen en de nieuwe optie <code>auto-dnssec</code> te gebruiken, is het mogelijk om een dynamische zone aan te maken welke opnieuw getekend wordt indien dat nodig is. Gebruik om deze zone bij te werken nsupdate met de nieuwe <code>-l</code>. rndc kan nu ook zones ondertekenen met sleutels uit het sleutelreservoir door de optie <code>sign</code> te gebruiken. Voeg, om BIND dit automatische ondertekenen en bijwerken van zones te laten gebruiken voor <code>example.com</code>, het volgende aan <span class=filename>named.conf</span> toe:</p></div><div class="literalblock programlisting"><div class=content><pre>zone example.com {
	type master;
	key-directory &#34;/etc/named/keys&#34;;
	update-policy local;
	auto-dnssec maintain;
	file &#34;/etc/named/dynamic/example.com.zone&#34;;
};</pre></div></div><div class=paragraph><p>Nadat deze veranderingen gemaakt zijn, dienen de sleutels voor de zone aangemaakt te worden zoals uitgelegd in <a href=#dns-dnssec-auth>Configuratie van een autoratieve DNS-server</a>, deze sleutels in het sleutelreservoir gestopt te worden dat als argument aan de <code>key-directory</code> in het zoneconfiguratie is meegegeven, waarna de zone automatisch zal worden ondertekend. Zones die op deze manier zijn geconfigureerd dienen met nsupdate te worden gedaan, dat voor het opnieuw ondertekenen van de zone met de nieuw toegevoegde gegevens zal zorgen. Zie voor meer details <a href=#dns-read>Verder lezen</a> en de BIND-documentatie.</p></div></div></div><div class=sect3><h4 id=_beveiliging>29.6.9. Beveiliging<a class=anchor href=#_beveiliging></a></h4><div class=paragraph><p>Hoewel BIND de meest gebruikte implementatie van DNS is, is er altijd nog het beveiligingsvraagstuk. Soms worden er mogelijke en te misbruiken beveiligingsgaten gevonden.</p></div><div class=paragraph><p>Hoewel FreeBSD named automatisch in een <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a>-omgeving plaatst; zijn er verschillende andere beveiligingsmechanismen actief die zouden kunnen helpen om mogelijke aanvallen op de DNS-dienst af te wenden.</p></div><div class=paragraph><p>Het is altijd verstandig om de <a href=http://www.cert.org/>CERT</a> beveiligingswaarschuwingen te lezen en een abonnement te nemen op de <a href=https://lists.FreeBSD.org/subscription/freebsd-security-notifications>FreeBSD beveiligingswaarschuwingen mailinglijst</a> om bij te blijven met de beveiligingsproblemen wat betreft Internet en FreeBSD.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Als er problemen ontstaan, kan het bijwerken van broncode en het opnieuw bouwen van named hulp bieden.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=dns-read>29.6.10. Verder lezen<a class=anchor href=#dns-read></a></h4><div class=paragraph><p>BIND/named hulppagina’s: <a href="https://man.freebsd.org/cgi/man.cgi?query=rndc&amp;sektion=8&amp;format=html">rndc(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=named.conf&amp;sektion=8&amp;format=html">named.conf(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=nsupdate&amp;sektion=8&amp;format=html">nsupdate(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=dnssec-signzone&amp;sektion=8&amp;format=html">dnssec-signzone(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=dnssec-keygen&amp;sektion=8&amp;format=html">dnssec-keygen(8)</a></p></div><div class=ulist><ul><li><p><a href=https://www.isc.org/software/bind/>Officiële ISC BIND pagina</a></p></li><li><p><a href=https://www.isc.org/software/guild/>Officieel ISC BIND Forum</a></p></li><li><p><a href=http://www.oreilly.com/catalog/dns5/>O’Reilly DNS en BIND 5e Editie</a></p></li><li><p><a href=http://www.root-dnssec.org/documentation/>Root DNSSEC</a></p></li><li><p><a href=http://data.iana.org/root-anchors/draft-icann-dnssec-trust-anchor.html>DNSSEC Trust Anchor Publication for the Root Zone</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc1034>RFC1034 - Domain Names - Concepts and Facilitities</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc1035>RFC1035 - Domain Names - Implementation and Specification</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc4033>RFC4033 - DNS Security Introduction and Requirements</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc4034>RFC4034 - Resource Records for the DNS Security Extensions</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc4035>RFC4035 - Protocol Modifications for the DNS Security Extensions</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc4641>RFC4641 - DNSSEC Operational Practices</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc5011>RFC5011 - Automated Updates of DNS Security (DNSSEC Trust Anchors)</a></p></li></ul></div></div></div><div class=sect2><h3 id=network-apache>29.7. Apache HTTP server<a class=anchor href=#network-apache></a></h3><div class=sect3><h4 id=_overzicht_4>29.7.1. Overzicht<a class=anchor href=#_overzicht_4></a></h4><div class=paragraph><p>FreeBSD wordt gebruikt om een paar van de drukste websites ter wereld te draaien. De meeste webservers op Internet maken gebruik van de Apache HTTP Server. Apache softwarepakketten staan op de FreeBSD installatiemedia. Als Apache niet bij de oorspronkelijke installatie van FreeBSD is meegeïnstalleerd, dan kan dat vanuit de port <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache22/>www/apache22</a>.</p></div><div class=paragraph><p>Als Apache succesvol is geïnstalleerd, moeten er instellingen gemaakt worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In dit onderdeel wordt versie 2.2.X van de Apache HTTP Server behandeld omdat die het meest gebruikt wordt op FreeBSD. Meer gedetailleerde informatie over Apache 2.X dat buiten het bereik van dit document valt is te vinden op <a href=http://httpd.apache.org/>http://httpd.apache.org/</a>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_instellen_3>29.7.2. Instellen<a class=anchor href=#_instellen_3></a></h4><div class=paragraph><p>Het belangrijkste bestand met instellingen voor de Apache HTTP Server op FreeBSD is <span class=filename>/usr/local/etc/apache22/httpd.conf</span>. Dit bestand is een typisch UNIX® tekstgebaseerd instellingenbestand waarin regels met commentaar beginnen met het karakter <code>#</code>. Het uitputtend beschrijven van alle mogelijke instellingen valt buiten het bereik van dit boek, dus worden alleen de meest gebruikte directieven beschreven.</p></div><div class=dlist><dl><dt class=hdlist1><code>ServerRoot "/usr/local"</code></dt><dd><p>Hierin wordt de standaard mappenhiërarchie voor de Apache installatie aangegeven. Binaire bestanden staan in de submappen <span class=filename>bin</span> en <span class=filename>sbin</span> van de serverroot en bestanden met instellingen staan in <span class=filename>etc/apache</span>.</p></dd><dt class=hdlist1><code>ServerAdmin <a href=mailto:beheerder@beheer.adres>beheerder@beheer.adres</a></code></dt><dd><p>Het adres waaraan problemen met de server gemaild kunnen worden. Dit adres verschijnt op een aantal door de server gegenereerde pagina’s, zoals documenten met foutmeldingen.</p></dd><dt class=hdlist1><code>ServerName www.example.com</code></dt><dd><p>Met <code>ServerName</code> kan een hostnaam ingesteld worden die wordt teruggezonden aan de cliënten als de naam van de server anders is dan diegene is ingesteld (gebruik bijvoorbeeld <code>www</code> in plaats van de echte hostnaam).</p></dd><dt class=hdlist1><code>DocumentRoot "/usr/local/www/apache22/data"</code></dt><dd><p><code>DocumentRoot</code>: de map waaruit de documenten worden geserveerd. Standaard worden alle verzoeken uit deze map gehaald, maar er kunnen symbolische links en aliassen gebruikt worden om naar andere locaties te wijzen.</p></dd></dl></div><div class=paragraph><p>Het is altijd een goed idee om reservekopieën te maken van het instellingenbestand voor Apache vóór het maken van wijzigingen. Als de juiste instellingen gemaakt zijn, kan Apache gestart worden.</p></div></div><div class=sect3><h4 id=_apache_draaien>29.7.3. Apache draaien<a class=anchor href=#_apache_draaien></a></h4><div class=paragraph><p>De port <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache2/>www/apache2</a> installeert een <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>-script dat helpt met het starten, stoppen en herstarten van Apache en is te vinden in <span class=filename>/usr/local/etc/rc.d/</span>.</p></div><div class=paragraph><p>Om Apache met het systeem mee te starten kan de volgende regel aan <span class=filename>/etc/rc.conf</span> worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>apache22_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Als het nodig is Apache met afwijkende opties op te starten, kan de volgende regel aan <span class=filename>/etc/rc.conf</span> worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>apache22_flags=&#34;&#34;</pre></div></div><div class=paragraph><p>De configuratie van Apache kan worden getest op fouten voordat het daemon <code>httpd</code> voor de eerste keer wordt gestart, of na het maken van wijzigingen aan de instellingen terwijl <code>httpd</code> draait. Dit kan direct door het <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>-script worden gedaan, of door het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a> door één van de volgende commando’s op te geven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service apache22 configtest</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is belangrijk om op te merken dat <code>configtest</code> geen <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>-standaard is, verwacht niet dat het met alle <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>-opstartscripts werkt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als Apache geen instellingsfouten meldt, kan Apache <code>httpd</code> gestart worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service apache22 start</span></code></pre></div></div><div class=paragraph><p>De dienst <code>httpd</code> kan getest worden door <code><a href=http://localhost class=bare>http://localhost</a></code> in een webbrowser te typen, waarbij <em>localhost</em> door de volledig gekwalificeerde domeinnaam wordt vervangen van de machine die <code>httpd</code> draait, als het niet de lokale machine is. De standaard webpagina die afgebeeld wordt is <span class=filename>/usr/local/www/apache22/data/index.html</span>.</p></div></div><div class=sect3><h4 id=_virtuele_hosting>29.7.4. Virtuele hosting<a class=anchor href=#_virtuele_hosting></a></h4><div class=paragraph><p>Apache ondersteunt twee verschillende manieren van Virtuele Hosting. De eerste methode is Naamgebaseerde Virtuele Hosting. Naamgebaseerde Virtuele Hosting gebruikt de HTTP/1.1 headers van de cliënten om de hostnaam uit te zoeken. Hierdoor kunnen meerdere domeinen hetzelfde IP-adres delen.</p></div><div class=paragraph><p>Om Apache gebruik te laten maken van Naamgebaseerde Virtuele Hosting kan een regel als de volgende in <span class=filename>httpd.conf</span> worden opgenomen:</p></div><div class="literalblock programlisting"><div class=content><pre>NameVirtualHost *</pre></div></div><div class=paragraph><p>Als een webserver <code>www.domein.tld</code> heet en er moet een virtueel domein voor <code>www.anderdomein.tld</code> gaan draaien, dan kunnen de volgende regels aan <span class=filename>httpd.conf</span> worden toegevoegd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&lt;VirtualHost <span class=k>*</span><span class=o>&gt;</span>
    ServerName www.domein.tld
    DocumentRoot /www/domein.tld
&lt;/VirtualHost&gt;

&lt;VirtualHost <span class=k>*</span><span class=o>&gt;</span>
    ServerName www.anderdomein.tld
    DocumentRoot /www/anderdomein.tld
&lt;/VirtualHost&gt;</code></pre></div></div><div class=paragraph><p>De adressen en de paden uit dit voorbeeld kunnen in echte implementaties uiteraard gewijzigd worden.</p></div><div class=paragraph><p>Meer informatie over het opzetten van virtuele hosts staat in de officiële documentatie voor Apache op <a href=http://httpd.apache.org/docs/vhosts/>http://httpd.apache.org/docs/vhosts/</a></p></div></div><div class=sect3><h4 id=_apache_modules>29.7.5. Apache modules<a class=anchor href=#_apache_modules></a></h4><div class=paragraph><p>Er zijn veel verschillende Apache modules die functionaliteit toevoegen aan de basisdienst. De FreeBSD Portscollectie biedt op een eenvoudige manier de mogelijkheid om Apache samen met de meeste populaire add-on modules te installeren.</p></div><div class=sect4><h5 id=_mod_ssl>29.7.5.1. mod_ssl<a class=anchor href=#_mod_ssl></a></h5><div class=paragraph><p>De module mod_ssl gebruikt de bibliotheek OpenSSL om sterke cryptografie te leveren via de protocollen Secure Sockets Layer (SSL v2/v3) en Transport Layer Security (TLS v1). Deze module levert alles wat nodig is om een getekend certificaat aan te vragen bij een vertrouwde certificaatautoriteit om een veilige webserver onder FreeBSD te kunnen draaien.</p></div><div class=paragraph><p>De module mod_ssl wordt standaard gebouwd, maar kan worden aangezet door tijdens het compileren <code>-DWITH_SSL</code> op te geven.</p></div></div><div class=sect4><h5 id=_taalbindingen>29.7.5.2. Taalbindingen<a class=anchor href=#_taalbindingen></a></h5><div class=paragraph><p>Er zijn Apache-modules beschikbare voor de meeste grote scriptingtalen. Deze modules maken het typisch mogelijk om Apache-modules geheel in een scriptingtaal te schrijven. Ze worden ook vaak gebruikt als een persistente interpreter die in de server zit en die de rompslomp van het starten van een externe interpreter en de opstartvertraging voor dynamische websites vermijdt, zoals beschreven in de volgende sectie.</p></div></div></div><div class=sect3><h4 id=_dynamische_websites>29.7.6. Dynamische websites<a class=anchor href=#_dynamische_websites></a></h4><div class=paragraph><p>In het afgelopen decennium hebben steeds meer bedrijven zich op Internet gericht om hun omzet te verhogen en hun zichtbaarheid te vergroten. Hiermee is ook de behoefte aan interactieve webinhoud toegenomen. Hoewel sommige bedrijven zoals Microsoft® oplossingen hebben geïntroduceerd voor hun eigen (propriëtaire) producten, heeft ook de open source gemeenschap een antwoord op de vraag gegeven. Moderne opties voor dynamische webinhoud zijn onder andere Django, Ruby on Rails, mod_perl2, en mod_php.</p></div><div class=sect4><h5 id=_django>29.7.6.1. Django<a class=anchor href=#_django></a></h5><div class=paragraph><p>Django is een BSD-gelicenseerd raamwerk ontworpen om ontwikkelaars in staat te stellen om snel hoog presterende, elegante webapplicaties te schrijven. Het biedt een vertaling van objecten naar relaties zodat datatypes ontwikkeld kunnen worden als Python-objecten, en er een rijke dynamische databasetoegang voor die objecten kan worden geboden zonder dat de ontwikkelaar ooit SQL hoeft te schrijven. Het biedt ook een uitbreidbaar sjabloonsysteem zodat de applicatielogica is gescheiden van de HTML-presentatie.</p></div><div class=paragraph><p>Django is afhankelijk van mod_python, Apache, en een SQL-database-engine naar keuze. De FreeBSD-port zal al deze vereisten met de juiste vlaggen voor u installeren.</p></div><div id=network-www-django-install class=exampleblock><div class=title>Voorbeeld 35. Django installeren met Apache2, mod_python3 en PostgreSQL</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/py-django; make all install clean -DWITH_MOD_PYTHON3 -DWITH_POSTGRESQL</span></code></pre></div></div></div></div><div class=paragraph><p>Als Django en deze vereisten eenmaal zijn geïnstalleerd, dient u een Django-projectmap te maken en vervolgens Apache te configureren om de ingebakken Python-interpreter te gebruiken om uw applicatie voor specifieke URL’s op uw site aan te roepen.</p></div><div id=network-www-django-apache-config class=exampleblock><div class=title>Voorbeeld 36. Apache-configuratie voor Django/mod_python</div><div class=content><div class=paragraph><p>U moet een regel aan het Apache-bestand <span class=filename>httpd.conf</span> toevoegen om Apache in te stellen om verzoeken voor bepaalde URL’s aan uw webapplicatie door te geven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&lt;Location <span class=s2>&#34;/&#34;</span><span class=o>&gt;</span>
    SetHandler python-program
    PythonPath <span class=s2>&#34;[&#39;/map/naar/uw/django-pakketten/&#39;] + sys.path&#34;</span>
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE mijnsite.settings
    PythonAutoReload On
    PythonDebug On
&lt;/Location&gt;</code></pre></div></div></div></div></div><div class=sect4><h5 id=_ruby_on_rails>29.7.6.2. Ruby on Rails<a class=anchor href=#_ruby_on_rails></a></h5><div class=paragraph><p>Ruby on Rails is een ader opensource webraamwerk dat een volledige ontwikkelstack biedt en geoptimaliseerd is om webontwikkelaars productiever te maken en snel krachtige applicaties te laten ontwikkelen. Het kan eenvoudig vanuit het portssysteem geïnstalleerd worden.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/rubygem-rails; make all install clean</span></code></pre></div></div></div><div class=sect4><h5 id=_mod_perl2>29.7.6.3. mod_perl2<a class=anchor href=#_mod_perl2></a></h5><div class=paragraph><p>Het Apache/Perl integratieproject brengt de volledige kracht van de programmeertaal Perl en de Apache HTTP Server samen. Met de module mod_perl2 is het mogelijk om Apache-modules volledig in Perl te schrijven. Daarnaast voorkomt een ingebouwde persistente interpreter in de server de rompslomp van het starten van een externe interpreter en de nadelen van de opstarttijd van Perl.</p></div><div class=paragraph><p>mod_perl2 is beschikbaar in de port <a class=package href=https://cgit.freebsd.org/ports/tree/www/mod_perl2/>www/mod_perl2</a>.</p></div></div><div class=sect4><h5 id=_mod_php>29.7.6.4. mod_php<a class=anchor href=#_mod_php></a></h5><div class=paragraph><p>PHP, ook bekend als "PHP: Hypertext Preprocessor", is een algemene scripttaal die bijzonder geschikt is voor webontwikkeling. Het is mogelijk de taal in te bedden in HTML en de syntaxis is afgeleid van C, Java™ en Perl met de bedoeling webontwikkelaars in staat te stellen om snel dynamisch samengestelde pagina’s te schrijven.</p></div><div class=paragraph><p>Om ondersteuning voor PHP5 toe te voegen aan de Apache webserver kan eerst de port <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a> geïnstalleerd worden.</p></div><div class=paragraph><p>Als de port <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a> voor het eerst geïnstalleerd wordt, worden automatisch de beschikbare <code>OPTIONS</code> weergegeven. Als er geen menu wordt weergegeven, omdat de port <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a> reeds in het verleden is geïnstalleerd, is het altijd mogelijk om het optiedialoog weer te laten verschijnen door</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make config</span></code></pre></div></div><div class=paragraph><p>uit te voeren in de map van de port.</p></div><div class=paragraph><p>Controleer in het optiedialoog dat de optie <code>APACHE</code> mod_php5 als een laadbare module voor de webserver Apache bouwt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Een heleboel sites draaien nog steeds PHP4 om verschillende redenen (compatibiliteitszaken of reeds in gebruik genomen webapplicaties). Als mod_php4 nodig is in plaats van mod_php5, gebruik dan de port <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php4/>lang/php4</a>. De port <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php4/>lang/php4</a> ondersteunt een groot deel van de configuratie- en bouwopties van de port <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Hiermee worden de modules die nodig zijn voor de ondersteuning van dynamische PHP-applicaties geïnstalleerd en ingesteld. Controleer dat de volgende secties aan <span class=filename>/usr/local/etc/apache22/httpd.conf</span> zijn toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>LoadModule php5_module        libexec/apache/libphp5.so</pre></div></div><div class="literalblock programlisting"><div class=content><pre>AddModule mod_php5.c
    IfModule mod_php5.c
        DirectoryIndex index.php index.html
    /IfModule
    IfModule mod_php5.c
        AddType application/x-httpd-php .php
        AddType application/x-httpd-php-source .phps
    /IfModule</pre></div></div><div class=paragraph><p>Na voltooiing is een eenvoudige aanroep van het commando <code>apachectl</code> voor een nette herstart nodig om de module PHP te laden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># apachectl graceful</span></code></pre></div></div><div class=paragraph><p>Voor toekomstig bijwerken van PHP zal het commando <code>make config</code> niet nodig zijn; de geselecteerde <code>OPTIONS</code> worden automatisch bewaard door het FreeBSD Ports raamwerk.</p></div><div class=paragraph><p>De ondersteuning voor PHP in FreeBSD is extreem modulair waardoor de basisinstallatie zeer beperkt is. Het is heel gemakkelijk om ondersteuning toe te voegen door de port <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5-extensions/>lang/php5-extensions</a> te gebruiken. Deze port biedt een menugestuurde interface voor de installatie van PHP-uitbreidingen. Als alternatief kunnen individuele uitbreidingen worden geïnstalleerd door de juiste port te gebruiken.</p></div><div class=paragraph><p>Om bijvoorbeeld ondersteuning voor de MySQL databaseserver aan PHP5 toe te voegen kan gewoonweg de port <span class=filename>databases/php5-mysql</span> geïnstalleerd worden:</p></div><div class=paragraph><p>Na de installatie van een uitbreiding moet de Apache-server herladen worden om de nieuwe veranderingen in de configuratie op te pikken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># apachectl graceful</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=network-ftp>29.8. File Transfer Protocol (FTP)<a class=anchor href=#network-ftp></a></h3><div class=sect3><h4 id=_overzicht_5>29.8.1. Overzicht<a class=anchor href=#_overzicht_5></a></h4><div class=paragraph><p>Het File Transfer Protocol (FTP) biedt gebruikers een eenvoudige manier om bestanden van en naar een FTP server te verplaatsen. FreeBSD bevat FTP server software, ftpd, in het basissysteem. Hierdoor is het opzetten en beheren van een FTP server op FreeBSD erg overzichtelijk.</p></div></div><div class=sect3><h4 id=_instellen_4>29.8.2. Instellen<a class=anchor href=#_instellen_4></a></h4><div class=paragraph><p>De belangrijkste stap bij het instellen is de beslissing welke accounts toegang krijgen tot de FTP server. Een normaal FreeBSD systeem heeft een aantal systeemaccounts die gebruikt worden voor daemons, maar onbekende gebruikers mag niet toegestaan worden van die accounts gebruikt te maken. In <span class=filename>/etc/ftpusers</span> staat een lijst met gebruikers die geen FTP toegang hebben. Standaard staan daar de voorgenoemde accounts in, maar het is ook mogelijk om daar gebruikers toe te voegen die geen FTP toegang mogen hebben.</p></div><div class=paragraph><p>Het kan ook wenselijk zijn de FTP toegang voor sommige gebruikers te beperken, maar niet onmogelijk te maken. Dit kan met <span class=filename>/etc/ftpchroot</span>. In dat bestand staan gebruikers en groepen waarop FTP toegangsbeperkingen van toepassing zijn. In <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpchroot&amp;sektion=5&amp;format=html">ftpchroot(5)</a> staan alle details die hier niet beschreven zijn.</p></div><div class=paragraph><p>Om anonieme FTP toegang voor een server in te schakelen, dient er een gebruiker <code>ftp</code> op een FreeBSD systeem aangemaakt te worden. Dan kunnen gebruikers op de server aanmelden met de gebruikersnaam <code>ftp</code> of <code>anonymous</code> en met ieder wachtwoord (de geldende conventie schrijft voor dat dit een emailadres van de gebruiker is). De FTP server roep bij een anonieme aanmelding <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> aan, zodat er alleen toegang is tot de thuismap van de gebruiker <code>ftp</code>.</p></div><div class=paragraph><p>Er zijn twee tekstbestanden waarin welkomstberichten voor de FTP-cliënten gezet kunnen worden. De inhoud van <span class=filename>/etc/ftpwelcome</span> wordt getoond voordat gebruikers een aanmeldprompt zien. Na een succesvolle aanmelding wordt de inhoud van <span class=filename>/etc/ftpmotd</span> getoond. Het genoemde pad is relatief ten opzichte van de aanmeldomgeving, dus voor anonieme gebruikers wordt <span class=filename>~ftp/etc/ftpmotd</span> getoond.</p></div><div class=paragraph><p>Als een FTP server eenmaal correct is ingesteld, moet die ingeschakeld worden in <span class=filename>/etc/inetd.conf</span>. Daar moet het commentaarkarakter <code>#</code> voor de bestaande ftpd regel verwijderd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp	stream	tcp	nowait	root	/usr/libexec/ftpd	ftpd -l</pre></div></div><div class=paragraph><p>Zoals is uitgelegd in <a href=#network-inetd-reread>Het instellingenbestand van inetd herladen</a>, moet de configuratie van inetd worden herladen nadat dit instellingenbestand is gewijzigd. Details over het aanzetten van inetd op uw systeem staan in <a href=#network-inetd-settings>Instellingen</a>.</p></div><div class=paragraph><p>Als alternatief kan ftpd ook gestart worden als een op zichzelf staande dienst. In dat geval volstaat het om de juiste variabele in te stellen in <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>ftpd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Na het instellen van de bovenstaande variabele zal de op zichzelf staande server gestart worden nadat de computer opnieuw is opgestart, of het kan handmatig worden gestart door het volgende commando als <code>root</code> uit te voeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service ftpd start</span></code></pre></div></div><div class=paragraph><p>Nu kan aangemeld worden op de FTP-server met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ftp localhost</code></pre></div></div></div><div class=sect3><h4 id=_beheren>29.8.3. Beheren<a class=anchor href=#_beheren></a></h4><div class=paragraph><p>De ftpd daemon gebruikt <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> om berichten te loggen. Standaard plaatst de systeemlogdaemon berichten over FTP in <span class=filename>/var/log/xferlog</span>. De lokatie van het FTP logboek kan gewijzigd worden door de volgende regels in <span class=filename>/etc/syslog.conf</span> te wijzigen:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp.info      /var/log/xferlog</pre></div></div><div class=paragraph><p>Het is verstandig na te denken over de gevaren die op de loer liggen bij het draaien van een anonieme FTP server. Dat geldt in het bijzonder voor het laten uploaden ven bestanden. Het is dan goed mogelijk dat een FTP site een forum wordt om commerciële software zonder licenties uit te wisselen of erger. Als anonieme uploads toch nodig zijn, dan horen de rechten op die bestanden zo te staan dat ze niet door andere anonieme gebruikers gelezen kunnen worden tot er door een beheerder naar gekeken is.</p></div></div></div><div class=sect2><h3 id=network-samba>29.9. Bestands- en printdiensten voor Microsoft® Windows® cliënten (Samba)<a class=anchor href=#network-samba></a></h3><div class=sect3><h4 id=_overzicht_6>29.9.1. Overzicht<a class=anchor href=#_overzicht_6></a></h4><div class=paragraph><p>Samba is een populair open source softwarepakket dat bestands- en printdiensten voor Microsoft® Windows® cliënten biedt. Die cliënten kunnen dan ruimte op een FreeBSD bestandssysteem gebruiken alsof het een lokale schijf is en FreeBSD printers gebruiken alsof het lokale printers zijn.</p></div><div class=paragraph><p>Samba softwarepakketten horen op de FreeBSD installatiemedia te staan. Als Samba bij de basisinstallatie niet mee is geïnstalleerd, dan kan dat alsnog via de <a class=package href=https://cgit.freebsd.org/ports/tree/net/samba34/>net/samba34</a> port of met het pakket.</p></div></div><div class=sect3><h4 id=_instellen_5>29.9.2. Instellen<a class=anchor href=#_instellen_5></a></h4><div class=paragraph><p>Een standaardbestand met instellingen voor Samba wordt geïnstalleerd als <span class=filename>/usr/local/shared/examples/samba34/smb.conf.default</span>. Dit bestand dient gekopieerd te worden naar <span class=filename>/usr/local/etc/smb.conf</span> en voordat Samba gebruikt kan worden, moeten er aanpassingen aan worden gemaakt.</p></div><div class=paragraph><p><span class=filename>smb.conf</span> bevat de instellingen voor Samba, zoals die voor de printers en de "gedeelde bestandssystemen" die gedeeld worden met Windows® cliënten. Het pakket Samba bevat een webgebaseerde beheermodule die swat heet, waarmee <span class=filename>smb.conf</span> op een eenvoudige manier ingesteld kan worden.</p></div><div class=sect4><h5 id=_de_samba_webbeheermodule_gebruiken_swat>29.9.2.1. De Samba webbeheermodule gebruiken (SWAT)<a class=anchor href=#_de_samba_webbeheermodule_gebruiken_swat></a></h5><div class=paragraph><p>De Samba Webbeheermodule (SWAT) draait als een daemon vanuit inetd. Daarom dient inetd aangezet te worden zoals beschreven in <a href=#network-inetd>De inetd"Super-Server"</a> en dient voor de volgende regel uit <span class=filename>/etc/inetd.conf</span> het commentaarkarakter verwijderd te worden voordat swat gebruikt kan worden om Samba in te stellen:</p></div><div class="literalblock programlisting"><div class=content><pre>swat   stream  tcp     nowait/400      root    /usr/local/sbin/swat    swat</pre></div></div><div class=paragraph><p>Zoals is uitgelegd in <a href=#network-inetd-reread>Het instellingenbestand van inetd herladen</a>, moet de configuratie van inetd worden herladen nadat dit instellingenbestand is gewijzigd.</p></div><div class=paragraph><p>Als swat is ingeschakeld in <span class=filename>inetd.conf</span>, kan de module gebruikt worden door met een browser een verbinding te maken met <a href=http://localhost:901>http://localhost:901</a>. Er dient aangemeld te worden met het <code>root</code> account van het systeem.</p></div><div class=paragraph><p>Na succesvol aanmelden op de hoofdpagina voor de Samba instellingen, is het mogelijk de systeemdocumentatie te bekijken of te starten door op het tabblad <b class=menuref>Globals</b> te klikken. Het onderdeel <b class=menuref>Globals</b> correspondeert met de sectie <code>[global]</code> in <span class=filename>/usr/local/etc/smb.conf</span>.</p></div></div><div class=sect4><h5 id=_systeembrede_instellingen>29.9.2.2. Systeembrede instellingen<a class=anchor href=#_systeembrede_instellingen></a></h5><div class=paragraph><p>Of Samba nu wordt ingesteld door <span class=filename>/usr/local/etc/smb.conf</span> direct te bewerken of met swat, de eerste instellingen die gemaakt moeten worden zijn de volgende:</p></div><div class=dlist><dl><dt class=hdlist1><code>workgroup</code></dt><dd><p>NT Domeinnaam of Werkgroepnaam voor de computers die verbinding gaan maken met de server.</p></dd><dt class=hdlist1><code>netbiosnaam</code></dt><dd><p>Hiermee wordt de NetBIOS naam waaronder de Samba server bekend zal zijn ingesteld. Standaard is de naam het eerste gedeelte van de DNS-naam van een host.</p></dd><dt class=hdlist1><code>server string</code></dt><dd><p>Hiermee wordt de string ingesteld die te zien is als het commando <code>net view</code> en een aantal andere commando’s die gebruik maken van de beschrijvende tekst voor de server gebruikt worden.</p></dd></dl></div></div><div class=sect4><h5 id=_beveiligingsinstellingen>29.9.2.3. Beveiligingsinstellingen<a class=anchor href=#_beveiligingsinstellingen></a></h5><div class=paragraph><p>Twee van de belangrijkste instellingen in <span class=filename>/usr/local/etc/smb.conf</span> zijn het gekozen beveiligingsmodel en het wachtwoord voor cliëntgebruikers. Deze worden met de volgende instellingen gemaakt:</p></div><div class=dlist><dl><dt class=hdlist1><code>security</code></dt><dd><p>De twee meest gebruikte mogelijkheden hier zijn <code>security = share</code> en <code>security = user</code>. Als de cliënten gebruikersnamen hebben die overeenkomen met hun gebruikersnaam op de FreeBSD machine, dan is het verstandig om te kiezen voor beveiliging op gebruikersniveau. Dit is het standaard beveiligingsbeleid en kent als voorwaarde dat gebruikers zich eerst moeten aanmelden voordat ze toegang krijgen tot gedeelde bronnen.</p><div class=paragraph><p>Bij beveiliging op shareniveau hoeft een cliënt niet met een geldige gebruikersnaam en wachtwoord aan te melden op de server voor het mogelijk is om een verbinding te proberen te krijgen met een gedeelde bron. Dit was het standaardbeveiligingsmodel voor oudere versies van Samba.</p></div></dd><dt class=hdlist1><code>passdb backend</code></dt><dd><p>Samba kent aan de achterkant verschillende authenticatiemodellen. Cliënten kunnen authenticeren met LDAP, NIS+, een SQL-database of een aangepast wachtwoordbestand. De standaard authenticatiemethode is <code>smbpasswd</code>. Meer wordt hier niet behandeld.</p></dd></dl></div><div class=paragraph><p>Als aangenomen wordt dat de standaard achterkant <code>smbpasswd</code> wordt gebruikt, dan moet <span class=filename>/usr/local/etc/samba/smbpasswd</span> gemaakt worden om Samba in staat te stellen cliënten te authenticeren. Als het gewenst is om uw UNIX® gebruikersaccounts toegang te geven vanaf Windows® cliënten, gebruik dan het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># smbpasswd -a gebruikersnaam</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De aanbevolen backend is nu <code>tdbsam</code>, en het volgende command moet gebruikt worden om gebruikersaccounts toe te voegen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pdbedit -a -u gebruikersnaam</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>In de <a href=http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection>Official Samba HOWTO</a> staat meer informatie over instelopties. Met de hier gegeven basisuitleg moet het mogelijk zijn Samba draaiende te krijgen.</p></div></div></div><div class=sect3><h4 id=_samba_starten>29.9.3. Samba starten<a class=anchor href=#_samba_starten></a></h4><div class=paragraph><p>De port <a class=package href=https://cgit.freebsd.org/ports/tree/net/samba34/>net/samba34</a> voegt een nieuw opstartscript toe, dat gebruikt kan worden om Samba te beheren. Om dit script te activeren, zodat het bijvoorbeeld gebruikt kan worden om Samba te starten, stoppen, of te herstarten, dient de volgende regel aan <span class=filename>/etc/rc.conf</span> toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>samba_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Of, voor fijnkorrelig beheer:</p></div><div class="literalblock programlisting"><div class=content><pre>nmbd_enable=&#34;YES&#34;</pre></div></div><div class="literalblock programlisting"><div class=content><pre>smbd_enable=&#34;YES&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Dit stelt Samba ook in om automatisch tijdens het opstarten te starten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Vervolgens is het mogelijk om Samba op elk moment te starten door dit te typen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service samba start</span>
Starting SAMBA: removing stale tdbs :
Starting nmbd.
Starting smbd.</code></pre></div></div><div class=paragraph><p>Refereer aan <a href=./#configtuning-rcd>Gebruik van rc met FreeBSD</a> voor meer informatie over het gebruikt van rc-scripts.</p></div><div class=paragraph><p>Samba bestaat feitelijk uit drie afzonderlijke daemons. Het script <span class=filename>samba</span> start de daemons nmbd en smbd. Als de winbind naamresolutiediensten in <span class=filename>smb.conf</span> zijn ingeschakeld, dan start ook de daemon winbindd.</p></div><div class=paragraph><p>Samba kan op ieder moment gestopt worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service samba stop</span></code></pre></div></div><div class=paragraph><p>Samba is een complexe softwaresuite met functionaliteit waarmee verregaande integratie met Microsoft® Windows® netwerken mogelijk wordt. Informatie die verder gaat dan de basisinstallatie staat op <a href=http://www.samba.org>http://www.samba.org</a>.</p></div></div></div><div class=sect2><h3 id=network-ntp>29.10. Tijd synchroniseren met NTP<a class=anchor href=#network-ntp></a></h3><div class=sect3><h4 id=_overzicht_7>29.10.1. Overzicht<a class=anchor href=#_overzicht_7></a></h4><div class=paragraph><p>Na verloop van tijd gaat de tijd van een computer meestal uit de pas lopen. Het Netwerk Tijd Protocol (NTP) kan ervoor zorgen dat de tijd accuraat blijft.</p></div><div class=paragraph><p>Veel diensten op Internet zijn afhankelijk, of hebben veel voordeel, van het betrouwbaar zijn van de tijd. Zo ontvangt een webserver bijvoorbeeld veel verzoeken om een bestand te sturen als dat gewijzigd is sinds een bepaald moment. In een LAN-omgeving is het van groot belang dat computers die bestanden delen van eenzelfde server gesynchroniseerde tijd hebben zodat de tijdstempels consistent blijven. Diensten zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> zijn ook afhankelijk van een betrouwbare systeemtijd om commando’s op het ingestelde moment uit te voeren.</p></div><div class=paragraph><p>Bij FreeBSD zit de <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> NTP server die gebruikt kan worden om bij andere NTP servers de tijd op te vragen om de eigen klok gelijk te zetten of om de juiste tijd te verstrekken aan andere apparaten.</p></div></div><div class=sect3><h4 id=_passende_ntp_servers_kiezen>29.10.2. Passende NTP-servers kiezen<a class=anchor href=#_passende_ntp_servers_kiezen></a></h4><div class=paragraph><p>Om de tijd te synchroniseren moeten er één of meer NTP-servers beschikbaar zijn. Een lokale systeembeheerder of een ISP heeft wellicht een NTP-server voor dit doel opgezet. Het is verstandig om documentatie te raadplegen en te bekijken of dat het geval is. Er is een <a href=http://support.ntp.org/bin/view/Servers/WebHome>online lijst van publiek toegankelijke NTP-servers</a> waarop een NTP-server gezocht kan worden die in geografische zin dichtbij een te synchroniseren computer ligt. Het is belangrijk te voldoen aan het beleid voor de betreffende server en toestemming te vragen als dat in de voorwaarden staat.</p></div><div class=paragraph><p>Het is verstandig meerdere, niet van elkaar afhankelijke, NTP-servers te kiezen voor het geval een van de servers niet langer betrouwbaar is of niet bereikbaar is. <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> gebruikt de antwoorden die van andere servers ontvangen worden op intelligente wijze: betrouwbare servers krijgen voorrang boven onbetrouwbare servers.</p></div></div><div class=sect3><h4 id=_machine_instellen>29.10.3. Machine instellen<a class=anchor href=#_machine_instellen></a></h4><div class=sect4><h5 id=_basisinstellingen>29.10.3.1. Basisinstellingen<a class=anchor href=#_basisinstellingen></a></h5><div class=paragraph><p>Als het alleen de bedoeling is de tijd te synchroniseren bij het opstarten van een machine, dan kan <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> gebruikt worden. Dit kan van toepassing zijn op desktops die regelmatig herstart worden en niet echt regelmatig gesynchroniseerd hoeven te worden. Op sommige machines hoort echter <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> te draaien.</p></div><div class=paragraph><p>Het gebruik van <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> bij het opstarten is ook een goed idee voor machines waarop <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> draait. De <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> wijzigt de tijd geleidelijk, terwijl <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> gewoon de tijd instelt, hoe groot het verschil tussen de bestaande tijd van een machine en de correcte tijd ook is.</p></div><div class=paragraph><p>Om <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> tijdens het opstarten in te schakelen kan <code>ntpdate_enable="YES"</code> aan <span class=filename>/etc/rc.conf</span> worden toegevoegd. Alle voor de synchronisatie te gebruiken servers moeten dan, samen met eventuele opties voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a>, in <code>ntpdate_flags</code> aangegeven worden.</p></div></div><div class=sect4><h5 id=_algemene_instellingen>29.10.3.2. Algemene instellingen<a class=anchor href=#_algemene_instellingen></a></h5><div class=paragraph><p>NTP wordt ingesteld met het bestand <span class=filename>/etc/ntp.conf</span> in het formaat dat beschreven staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a>. Hieronder volgt een eenvoudig voorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>server ntplocal.example.com prefer
server timeserver.example.org
server ntp2a.example.net

driftfile /var/db/ntp.drift</pre></div></div><div class=paragraph><p>De optie <code>server</code> geeft aan welke servers er gebruikt moeten worden, met op elke regel een server. Als de server wordt ingesteld met het argument <code>prefer</code>, zoals bij <code>ntplocal.example.com</code>, dan krijgt die server de voorkeur boven de andere. Een antwoord van een voorkeursserver wordt genegeerd als dat significant afwijkt van de antwoorden van de andere servers. In andere gevallen wordt het gebruikt zonder rekening te houden met de andere antwoorden. Het argument <code>prefer</code> wordt meestal gebruikt voor NTP-servers waarvan bekend is dat ze erg betrouwbaar zijn, zoals die met speciale tijdbewakingshardware.</p></div><div class=paragraph><p>De optie <code>driftfile</code> geeft aan welk bestand gebruikt wordt om de offset van de klokfrequentie van het systeem op te slaan. <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> gebruikt die om automatisch te compenseren voor het natuurlijke afwijken van de tijd, zodat er zelfs bij gebrek aan externe bronnen een redelijke accurate tijdsinstelling mogelijk is.</p></div><div class=paragraph><p>De optie <code>driftfile</code> geeft aan welk bestand gebruikt wordt om informatie over eerdere antwoorden van NTP-servers die gebruikt worden op te slaan. Dit bestand bevat interne informatie voor NTP. Het hoort niet door andere processen gewijzigd te worden.</p></div></div><div class=sect4><h5 id=_toegang_tot_een_server_instellen>29.10.3.3. Toegang tot een server instellen<a class=anchor href=#_toegang_tot_een_server_instellen></a></h5><div class=paragraph><p>Een NTP-server is standaard toegankelijk voor alle hosts op een netwerk. De optie <code>restrict</code> in <span class=filename>/etc/ntp.conf</span> maakt het mogelijk om aan te geven welke machines de dienst mogen benaderen.</p></div><div class=paragraph><p>Voor het blokkeren van toegang voor alle andere machines kan de volgende regel aan <span class=filename>/etc/ntp.conf</span> toegevoegd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>restrict default ignore</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Dit zal ook toegang van uw server naar alle servers die vermeld staan in uw lokale configuratie verhinderen. Als u uw NTP-server moet synchroniseren met een externe NTP-server, dient u deze specifieke server toe te staan. Lees de handleiding voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a> voor meer informatie.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om alleen machines op bijvoorbeeld het lokale netwerk toe te staan hun tijd te synchroniseren met een server, maar ze tegelijkertijd niet toe te staan om de server te draaien of de server als referentie voor synchronisatie te gebruiken, kan de volgende regel toegevoegd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap</pre></div></div><div class=paragraph><p>Hierboven is <code>192.168.1.0</code> een IP-adres op een LAN en <code>255.255.255.0</code> is het bijbehorende netwerkmasker.</p></div><div class=paragraph><p><span class=filename>/etc/ntp.conf</span> mag meerdere regels met <code>restrict</code> bevatten. Meer details staan in het onderdeel <code>Access Control Support</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a>.</p></div></div></div><div class=sect3><h4 id=_de_ntp_server_draaien>29.10.4. De NTP-server draaien<a class=anchor href=#_de_ntp_server_draaien></a></h4><div class=paragraph><p>De NTP-server kan bij het opstarten gestart worden door de regel <code>ntpd_enable="YES"</code> aan <span class=filename>/etc/rc.conf</span> toe te voegen. Om extra opties aan <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> mee te geven kan de parameter <code>ntpd_flags</code> in <span class=filename>/etc/rc.conf</span> gebruikt worden.</p></div><div class=paragraph><p>Om de server zonder een herstart van de machine te starten kan <code>ntpd</code> uitgevoerd worden, met toevoeging van de parameters uit <code>ntpd_flags</code> in <span class=filename>/etc/rc.conf</span>. Bijvoorbeeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ntpd -p /var/run/ntpd.pid</span></code></pre></div></div></div><div class=sect3><h4 id=_ntpd_gebruiken_met_een_tijdelijke_internetverbinding>29.10.5. ntpd gebruiken met een tijdelijke Internetverbinding<a class=anchor href=#_ntpd_gebruiken_met_een_tijdelijke_internetverbinding></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> heeft geen permanente verbinding met een netwerk nodig om goed te werken. Maar als er gebruik gemaakt wordt van een inbelverbinding, is het wellicht verstandig om ervoor te zorgen dat uitgaande NTP-verzoeken geen uitgaande verbinding kunnen starten. Als er gebruik gemaakt wordt van gebruikers-PPP, kunnen er <code>filter</code> commando’s ingesteld worden in <span class=filename>/etc/ppp/ppp.conf</span>. Bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>set filter dial 0 deny udp src eq 123
# NTP-verkeer zorgt niet voor uitbellen
set filter dial 1 permit 0 0
set filter alive 0 deny udp src eq 123
# Inkomend NTP-verkeer houdt de verbinding niet open
set filter alive 1 deny udp dst eq 123
# Uitgaand NTP-verkeer houdt de verbinding niet open
set filter alive 2 permit 0/0 0/0</pre></div></div><div class=paragraph><p>Meer details staan in de sectie <code>PACKET FILTERING</code> in <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> en in de voorbeelden in <span class=filename>/usr/shared/examples/ppp/</span>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige Internetproviders blokkeren lage poorten, waardoor NTP niet kan werken omdat er nooit een antwoord ontvangen kan worden door een machine.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_meer_informatie_3>29.10.6. Meer informatie<a class=anchor href=#_meer_informatie_3></a></h4><div class=paragraph><p>HTML-documentatie voor de NTP-server staat in <span class=filename>/usr/shared/doc/ntp/</span>.</p></div></div></div><div class=sect2><h3 id=network-syslogd>29.11. Hosts op afstand loggen met <code>syslogd</code><a class=anchor href=#network-syslogd></a></h3><div class=paragraph><p>Het omgaan met systeemlogs is een cruciaal aspect van zowel beveiligings- als systeembeheer. Het in de gaten houden van logbestanden van meerdere hosts kan nogal onhandelbaar worden als deze hosts over (middel)grote netwerken zijn verspreid, of wanneer ze deel zijn van verschillende soorten netwerken. In deze gevallen kan het op afstand loggen het gehele proces een stuk aangenamer maken.</p></div><div class=paragraph><p>Het centraal loggen naar een specifieke loghost kan wat van de administratieve last van het beheren van logbestanden wegnemen. Het aggregeren, samenvoegen, en roteren van logbestanden kan op één enkele plaats worden ingesteld, door gebruik te maken van de eigen gereedschappen van FreeBSD, zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a>. In de volgende voorbeeldconfiguratie zal host <code>A</code>, genaamd <code>logserv.example.com</code>, loginformatie voor het plaatselijke netwerk verzamelen. Host <code>B</code>, genaamd <code>logclient.example.com</code>, zal loginformatie aan het serversysteem doorgeven. In echte configuraties hebben beide hosts degelijke voor- en terugwaartse DNS of regels in <span class=filename>/etc/hosts</span> nodig. Anders worden de gegevens geweigerd door de server.</p></div><div class=sect3><h4 id=_configuratie_van_de_logserver>29.11.1. Configuratie van de logserver<a class=anchor href=#_configuratie_van_de_logserver></a></h4><div class=paragraph><p>Logservers zijn machines die zijn geconfigureerd om loginformatie van hosts op afstand te accepteren. In de meeste gevallen is dit om de configuratie te vergemakkelijken, in andere gevallen kan het gewoon een beheersbeslissing zijn. Ongeacht de reden zijn er enkele eisen voordat er verder wordt gegaan.</p></div><div class=paragraph><p>Een juist geconfigureerde logserver voldoet aan de volgende minimale eisen:</p></div><div class=ulist><ul><li><p>De regels van de firewall staan toe dat UDP wordt doorgegeven op poort 514 van zowel de cliënt als de server;</p></li><li><p>syslogd is ingesteld om berichten op afstand van cliëntmachines te accepteren;</p></li><li><p>De syslogd-server en alle cliëntmachines moeten geldige regels hebben voor zowel voorwaartse als terugwaartse DNS, of correct zijn geconfigureerd in <span class=filename>/etc/hosts</span>.</p></li></ul></div><div class=paragraph><p>Om de logserver te configureren, moet de cliënt vermeld zijn in <span class=filename>/etc/syslog.conf</span>, en moet de logfaciliteit zijn gespecificeerd:</p></div><div class="literalblock programlisting"><div class=content><pre>+logclient.example.com
*.*	/var/log/logclient.log</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Meer informatie over de verschillende ondersteunde en beschikbare <em>faciliteiten</em> kan gevonden worden in de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog.conf&amp;sektion=5&amp;format=html">syslog.conf(5)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Eenmaal toegevoegd worden alle <code>faciliteits</code>-berichten gelogd naar het eerder gespecificeerde bestand, <span class=filename>/var/log/logclient.log</span>.</p></div><div class=paragraph><p>De servermachine moet ook het volgende in <span class=filename>/etc/rc.conf</span> hebben staan:</p></div><div class="literalblock programlisting"><div class=content><pre>syslogd_enable=&#34;YES&#34;
syslogd_flags=&#34;-a logclient.example.com -v -v&#34;</pre></div></div><div class=paragraph><p>De eerste optie zet de daemon <code>syslogd</code> aan tijdens het opstarten, en de tweede regel staat toe dat gegevens van de cliënt op deze server worden geaccepteerd. Het laatste gedeelte, dat <code>-v -v</code> gebruikt, verhoogt de verbositeit van gelogde berichten. Dit is extreem handig voor het optimaal instellen van faciliteiten aangezien beheerders kunnen zien welk soort berichten onder welke faciliteit worden gelogd.</p></div><div class=paragraph><p>Er kunnen meerdere opties <code>-a</code> worden gespecificeerd om logging vanuit meerdere cliënten toe te staan. IP-adressen en hele netblokken mogen ook worden gespecificeerd, bekijk de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> voor een volledige lijst van mogelijke opties.</p></div><div class=paragraph><p>Als laatste dient het logbestand gecreëerd te worden. De gebruikte manier maakt niet uit, maar <a href="https://man.freebsd.org/cgi/man.cgi?query=touch&amp;sektion=1&amp;format=html">touch(1)</a> werkt prima in dit soort situaties:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/log/logclient.log</span></code></pre></div></div><div class=paragraph><p>Nu dient het <code>syslogd</code>-daemon herstart en geverifieerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service syslogd restart</span>
<span class=c># pgrep syslog</span></code></pre></div></div><div class=paragraph><p>Als er een PID wordt teruggegeven, dan is de server succesvol herstart, en kan er begonnen worden met de configuratie van de cliënt. Raadpleeg de log <span class=filename>/var/log/messages</span> voor uitvoer als de server niet is herstart.</p></div></div><div class=sect3><h4 id=_configuratie_van_de_logcliënt>29.11.2. Configuratie van de logcliënt<a class=anchor href=#_configuratie_van_de_logcliënt></a></h4><div class=paragraph><p>Een logcliënt is een machine die loginformatie naar een logserver verstuurt en daarnaast lokale kopieën bewaart.</p></div><div class=paragraph><p>Net als logservers moeten logcliënten ook aan enkele minimumeisen voldoen:</p></div><div class=ulist><ul><li><p><a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> moet zijn ingesteld om berichten van bepaalde soorten naar een logserver te sturen, die ze moet accepteren;</p></li><li><p>De firewall moet UDP-pakketten doorlaten op poort 514;</p></li><li><p>Zowel voorwaartse als terugwaartse DNS moeten geconfigureerd zijn of juiste regels in <span class=filename>/etc/hosts</span> hebben.</p></li></ul></div><div class=paragraph><p>De configuratie van cliënten is wat soepeler dan die van servers. De cliëntmachine moet de volgende regels in <span class=filename>/etc/rc.conf</span> hebben:</p></div><div class="literalblock programlisting"><div class=content><pre>syslogd_enable=&#34;YES&#34;
syslogd_flags=&#34;-s -v -v&#34;</pre></div></div><div class=paragraph><p>Net als eerder zullen deze regels de daemon <code>syslogd</code> tijdens het opstarten aanzetten, en de verbositeit van gelogde berichten verhogen. De optie <code>-s</code> voorkomt dat logs van deze cliënt vanuit andere hosts worden geaccepteerd.</p></div><div class=paragraph><p>Faciliteiten beschrijven het systeemgedeelte waarvoor een bericht is gegenereerd. ftp en ipfw bijvoorbeeld zijn beide faciliteiten. Wanneer er logberichten worden gegenereerd voor deze twee diensten, zullen ze normaalgesproken deze twee gereedschappen in elk logbericht opnemen. Faciliteiten worden vergezeld van een prioriteit of niveau, welke wordt gebruikt om aan te geven hoe belangrijk een logbericht is. De meest voorkomende zullen <code>warning</code> en <code>info</code> zijn. Bekijk de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> voor een volledige lijst van beschikbare faciliteiten en prioriteiten.</p></div><div class=paragraph><p>De logserver moet in <span class=filename>/etc/syslog.conf</span> van de cliënt zijn gedefinieerd. In dit geval wordt het symbool <code>@</code> gebruikt om loggegevens naar een server op afstand te sturen en zou er ongeveer als de volgende regel uit moeten zien:</p></div><div class="literalblock programlisting"><div class=content><pre>*.*	@logserv.example.com</pre></div></div><div class=paragraph><p>Eenmaal toegevoegd moet <code>syslogd</code> worden herstart zodat de veranderingen effect hebben:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service syslogd restart</span></code></pre></div></div><div class=paragraph><p>Om te testen of logberichten over het netwerk worden verzonden, wordt <a href="https://man.freebsd.org/cgi/man.cgi?query=logger&amp;sektion=1&amp;format=html">logger(1)</a> op de cliënt gebruikt om een bericht naar <code>syslogd</code> te sturen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># logger &#34;Testbericht van logclient&#34;</span></code></pre></div></div><div class=paragraph><p>Dit bericht dient nu zowel in <span class=filename>/var/log/messages</span> op de cliënt als <span class=filename>/var/log/logclient.log</span> op de logserver te staan.</p></div></div><div class=sect3><h4 id=_logservers_debuggen>29.11.3. Logservers debuggen<a class=anchor href=#_logservers_debuggen></a></h4><div class=paragraph><p>In bepaalde gevallen kan het nodig zijn om te debuggen als berichten niet door de logserver worden ontvangen. Er zijn verschillende redenen waarom dit kan gebeuren; de twee meest voorkomende zijn echter voorvallen met de netwerkverbinding en DNS. Om deze gevallen te testen, dient te worden nagegaan dat beide hosts elkaar kunnen bereiken door de hostnaam in <span class=filename>/etc/rc.conf</span> te gebruiken. Als dit juist lijkt te werken, dient de optie <code>syslogd_flags</code> in <span class=filename>/etc/rc.conf</span> te worden veranderd.</p></div><div class=paragraph><p>In het volgende voorbeeld is <span class=filename>/var/log/logclient.log</span> leeg, en noemt <span class=filename>/var/log/messages</span> geen reden waarom het mislukt. Verander de optie <code>syslogd_flags</code> zoals in het volgende voorbeeld en herstart om de debuguitvoer te verhogen:</p></div><div class="literalblock programlisting"><div class=content><pre>syslogd_flags=&#34;-d -a logclien.example.com -v -v&#34;</pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service syslogd restart</span></code></pre></div></div><div class=paragraph><p>Debuggegevens zoals de volgende zullen meteen na de herstart over het scherm vliegen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>logmsg: pri 56, flags 4, from logserv.example.com, msg syslogd: restart
syslogd: restarted
logmsg: pri 6, flags 4, from logserv.example.com, msg syslogd: kernel boot file is /boot/kernel/kernel
Logging to FILE /var/log/messages
syslogd: kernel boot file is /boot/kernel/kernel
cvthname<span class=o>(</span>192.168.1.10<span class=o>)</span>
validate: dgram from IP 192.168.1.10, port 514, name logclient.example.com<span class=p>;</span>
rejected <span class=k>in </span>rule 0 due to name mismatch.</code></pre></div></div><div class=paragraph><p>Het is duidelijk dat de berichten worden geweigerd wegens een niet-overeenkomende naam. Na de configuratie grondig te hebben herzien, lijkt het of een typefout in de volgende regel in <span class=filename>/etc/rc.conf</span> een probleem heeft:</p></div><div class="literalblock programlisting"><div class=content><pre>syslogd_flags=&#34;-d -a logclien.example.com -v -v&#34;</pre></div></div><div class=paragraph><p>De regel dient <code>logclient</code>, niet <code>logclien</code> te bevatten. Nadat de juiste wijzigingen zijn gemaakt, wordt er herstart met de verwachte resultaten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service syslogd restart</span>
logmsg: pri 56, flags 4, from logserv.example.com, msg syslogd: restart
syslogd: restarted
logmsg: pri 6, flags 4, from logserv.example.com, msg syslogd: kernel boot file is /boot/kernel/kernel
syslogd: kernel boot file is /boot/kernel/kernel
logmsg: pri 166, flags 17, from logserv.example.com,
msg Dec 10 20:55:02 &lt;syslog.err&gt; logserv.example.com syslogd: exiting on signal 2
cvthname<span class=o>(</span>192.168.1.10<span class=o>)</span>
validate: dgram from IP 192.168.1.10, port 514, name logclient.example.com<span class=p>;</span>
accepted <span class=k>in </span>rule 0.
logmsg: pri 15, flags 0, from logclient.example.com, msg Dec 11 02:01:28 trhodes: Test message 2
Logging to FILE /var/log/logclient.log
Logging to FILE /var/log/messages</code></pre></div></div><div class=paragraph><p>Nu worden de berichten juist ontvangen en in het correcte bestand geplaatst.</p></div></div><div class=sect3><h4 id=_beveiligingsoverwegingen>29.11.4. Beveiligingsoverwegingen<a class=anchor href=#_beveiligingsoverwegingen></a></h4><div class=paragraph><p>Zoals bij alle netwerkdiensten, dienen beveiligingseisen in acht te worden genomen voordat deze configuratie wordt geïmplementeerd. Soms kunnen logbestanden gevoelige gegevens bevatten over diensten die aanstaan op de lokale host, gebruikersaccounts, en configuratiegegevens. Netwerkgegevens die van de cliënt naar de server worden verzonden worden niet versleuteld noch met een wachtwoord beveiligd. Als versleuteling nodig is, kan <a class=package href=https://cgit.freebsd.org/ports/tree/security/stunnel/>security/stunnel</a> worden gebruikt, wat gegevens over een versleutelde tunnel verstuurt.</p></div><div class=paragraph><p>Aan lokale beveiliging moet ook gedacht worden. Logbestanden worden niet versleuteld tijdens gebruik of na logrotatie. Lokale gebruikers kunnen deze bestanden benaderen om aanvullende inzichten over de systeemconfiguratie op te doen. In deze gevallen is het van kritiek belang om de juiste rechten op deze bestanden in te stellen. Het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> ondersteunt het instellen van rechten op nieuw aangemaakte en geroteerde logbestanden. Het instellen van logbestanden op modus <code>600</code> dient al het ongewenste spieken door lokale gebruikers te verhinderen.</p></div></div></div></div></div><div class=sect1><h2 id=firewalls>Hoofdstuk 30. Firewalls<a class=anchor href=#firewalls></a></h2><div class=sectionbody><div class=sect2><h3 id=firewalls-intro>30.1. Inleiding<a class=anchor href=#firewalls-intro></a></h3><div class=paragraph><p>Firewalls bieden de mogelijkheid om inkomend en uitgaand verkeer op een systeem te filteren. Een firewall gebruikt daarvoor een of meer groepen regels ("rules") om netwerkpakketten te inspecteren als ze binnenkomen of weggaan door netwerkverbindingen en staat dat verkeer dan toe of blokkeert het. De regels van een firewall kunnen één of meerdere eigenschappen van pakketten onderzoeken waaronder, maar niet uitsluitend, het protocol, het bron- of bestemmingsadres en de bron- en bestemmingspoort.</p></div><div class=paragraph><p>Firewalls kunnen de veiligheid van een host of netwerk enorm vergroten. Ze kunnen één of meer van de volgende dingen doen:</p></div><div class=ulist><ul><li><p>Applicaties, diensten en machines op een intern netwerk te beschermen tegen ongewild verkeer van het Internet.</p></li><li><p>Toegang tot Internet voor interne hosts te limiteren of uitschakelen.</p></li><li><p>Ondersteuning bieden voor netwerkadres vertaling ("network address translation" of NAT), waarmee er vanaf een intern netwerk met private IP adressen een Internetverbinding gedeeld kan worden met één IP adres of met een groep van publieke adressen die automatisch wordt toegewezen.</p></li></ul></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe pakketfilteringsregels op de juiste wijze samengesteld kunnen worden;</p></li><li><p>De verschillen tussen de firewalls die bij FreeBSD worden geleverd;</p></li><li><p>Hoe de OpenBSD firewall PF te gebruiken en in te stellen;</p></li><li><p>Hoe IPFILTER te gebruiken en in te stellen;</p></li><li><p>Hoe IPFW te gebruiken en in te stellen.</p></li></ul></div><div class=paragraph><p>Er wordt aangenomen dat de lezer van dit hoofdstuk:</p></div><div class=ulist><ul><li><p>Basisbegrip heeft van FreeBSD en Internetconcepten.</p></li></ul></div></div><div class=sect2><h3 id=firewalls-concepts>30.2. Firewallconcepten<a class=anchor href=#firewalls-concepts></a></h3><div class=paragraph><p>Er zijn twee basismogelijkheden om sets met regels te maken voor firewalls: "inclusief" of "exclusief". Een exclusieve firewall staat al het verkeer door behalve het verkeer dat past bij de set met regels. Een inclusieve firewall doet het tegenovergestelde. Die staat alleen verkeer toe dat past bij de regels en blokkeert al het overige verkeer.</p></div><div class=paragraph><p>Een inclusieve firewall biedt veel betere controle over het uitgaande verkeer, waardoor het een betere keuze is voor systemen die diensten op het publieke Internet aanbieden. Het beheert ook het type verkeer dat van het publieke Internet afkomt en toegang heeft tot uw privé-netwerk. Al het verkeer dat niet aan de regels voldoet wordt geblokkeerd en gelogd, dat is zo ontworpen. Inclusieve firewalls zijn over het algemeen veiliger dan exclusieve firewalls omdat ze het risico dat ongewenst verkeer door ze heen gaat aanzienlijk verminderen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Tenzij anders aangegeven, creëeren alle configuraties en voorbeelden van regelverzamelingen in dit hoofdstuk inclusieve firewalls.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De beveiliging kan nog verder vergroot worden met een "stateful firewall". Dit type firewall houdt bij welke connecties er door de firewall tot stand zijn gekomen en laat alleen verkeer door dat bij een bestaande connectie hoort of onderdeel is van een connectie in opbouw. Het nadeel van een stateful firewall is dat die kwetsbaar kan zijn voor Ontzegging van Dienst (DoS) aanvallen als er een groot aantal nieuwe verbindingen binnen korte tijd wordt opgezet. Met de meeste firewalls is het mogelijk een combinatie te maken van stateful en niet stateful gedrag om een optimale firewall voor een site te maken.</p></div></div><div class=sect2><h3 id=firewalls-apps>30.3. Firewallsoftware<a class=anchor href=#firewalls-apps></a></h3><div class=paragraph><p>FreeBSD heeft drie soorten firewallsoftware in de basisinstallatie. Dat zijn: IPFILTER (ook bekend als IPF), IPFIREWALL (ook bekend als IPFW) en de pakketfilter van OpenBSD (ook bekend als PF). FreeBSD heeft ook twee ingebouwde pakketten voor het regelen van verkeer (in de basis het beheersen van bandbreedtegebruik): <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a>. Dummynet is traditioneel sterk verbonden met IPFW en ALTQ met PF. Het vormgeven van verkeer voor IPFILTER kan momenteel gedaan worden met IPFILTER voor NAT en filtering en IPFW met <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a> <em>of</em> door PF met ALTQ te gebruiken. IPFW en PF gebruiken allemaal regels om de toegang van pakketten tot een systeem te regelen, hoewel ze dat op andere manieren doen en ze een andere regelsyntaxis hebben.</p></div><div class=paragraph><p>De reden dat er meerdere firewallpakketten in FreeBSD zitten is dat verschillende mensen verschillende eisen en voorkeuren hebben. Geen enkel firewallpakket is het beste.</p></div><div class=paragraph><p>De schrijver van dit artikel geeft de voorkeur aan IPFILTER omdat daarmee stateful regels minder complex zijn toe te passen in een omgeving waar NAT wordt gebruikt en IPF heeft een ingebouwde FTP proxy waardoor de regels voor het veilig gebruiken van FTP eenvoudiger worden.</p></div><div class=paragraph><p>Omdat alle firewalls gebaseerd zijn op het inspecteren van aangegeven controlevelden in pakketten, moet iemand die sets van firewallregels opstelt begrijpen hoe TCP/IP werkt, welke waarde de controlevelden kunnen hebben en hoe die waarden gebruikt worden in normaal verkeer. Op de volgende webpagina wordt een prima uitleg gegeven: <a href=http://www.ipprimer.com/overview.cfm>http://www.ipprimer.com/overview.cfm</a>.</p></div></div><div class=sect2><h3 id=firewalls-pf>30.4. De OpenBSD Packet Filter (PF) en ALTQ<a class=anchor href=#firewalls-pf></a></h3><div class=paragraph><p>Vanaf juli 2003 is de OpenBSD firewalltoepassing PF geporteerd naar FreeBSD en beschikbaar gekomen in de FreeBSD Portscollectie. In 2004 was FreeBSD 5.3 de eerste release die PF bevatte is integraal onderdeel van het basissysteem. PF is een complete en volledige firewall die optioneel ALTQ bevat (Alternate Queuing). ALTQ biedt Quality of Service (QoS) functionaliteit.</p></div><div class=paragraph><p>het OpenBSD Project levert een uitstekend werk wat betreft het onderhouden van de <a href=http://www.openbsd.org/faq/pf/>PF FAQ</a>. Zodoende zal deze sectie van het handboek zich richten op PF met betrekking tot FreeBSD terwijl het ook wat algemene informatie over het gebruik zal geven. Voor gedetailleerde gebruikersinformatie wordt naar de <a href=http://www.openbsd.org/faq/pf/>PF FAQ</a> verwezen.</p></div><div class=paragraph><p>Meer informatie over PF voor FreeBSD staat op <a href=http://pf4freebsd.love2party.net/>http://pf4freebsd.love2party.net/</a>.</p></div><div class=sect3><h4 id=_de_laadbare_kernelmodules_voor_pf_gebruiken>30.4.1. De laadbare kernelmodules voor PF gebruiken<a class=anchor href=#_de_laadbare_kernelmodules_voor_pf_gebruiken></a></h4><div class=paragraph><p>Voeg de volgende regel toe aan <span class=filename>/etc/rc.conf</span> om de kernelmodule PF te laden:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Draai vervolgens het opstartscript om de module te laden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service pf start</span></code></pre></div></div><div class=paragraph><p>Merk op dat de PF module niet laadt als het het instellingenbestand met de regelverzameling niet kan vinden. De standaardlocatie is <span class=filename>/etc/pf.conf</span>. Als de regelverzameling voor PF zich elders bevindt, kan PF worden verteld om daar te kijken een regel analoog aan de volgende aan <span class=filename>/etc/rc.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_rules=&#34;/pad/naar/pf.conf&#34;</pre></div></div><div class=paragraph><p>Het voorbeeld <span class=filename>pf.conf</span> bestand kan gevonden worden in <span class=filename>/usr/shared/examples/pf</span></p></div><div class=paragraph><p>De module PF kan ook handmatig vanaf de opdrachtregel geladen worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload pf.ko</span></code></pre></div></div><div class=paragraph><p>Logondersteuning voor PF wordt geleverd door <code>pflog.ko</code> en kan worden geladen door de volgende regel aan <span class=filename>/etc/rc.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>pflog_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Draai vervolgens het opstartscript om de module te laden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service pflog start</span></code></pre></div></div><div class=paragraph><p>Als u andere mogelijkheden van PF nodig heeft dient u ondersteuning voor PF in de kernel te compileren.</p></div></div><div class=sect3><h4 id=_kernelopties_voor_pf>30.4.2. Kernelopties voor PF<a class=anchor href=#_kernelopties_voor_pf></a></h4><div class=paragraph><p>Hoewel het niet nodig is om ondersteuning voor PF in de kernel te compileren, biedt dit wel de mogelijkheid om van een van PF’s geavanceerde mogelijkheden gebruik te maken die niet in de laadbare module zitten, namelijk <a href="https://man.freebsd.org/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;format=html">pfsync(4)</a>, dat een pseudo-apparaat is dat zekere veranderingen aan de toestandstabel die door PF wordt gebruikt prijsgeeft. Het kan worden gecombineerd met <a href="https://man.freebsd.org/cgi/man.cgi?query=carp&amp;sektion=4&amp;format=html">carp(4)</a> om failover firewalls aan te maken die gebruik maken van PF. Meer informatie over CARP kan gevonden worden in <a href=./#carp>Common Address Redundancy Protocol (CARP)</a> van het Handboek.</p></div><div class=paragraph><p>De kernelopties voor PF kunnen gevonden worden in <span class=filename>/usr/src/sys/conf/NOTES</span> en zijn hieronder gereproduceerd:</p></div><div class="literalblock programlisting"><div class=content><pre>device pf
device pflog
device pfsync</pre></div></div><div class=paragraph><p>De optie <code>device pf</code> schakelt ondersteuning voor de "Packet Filter" firewall (<a href="https://man.freebsd.org/cgi/man.cgi?query=pf&amp;sektion=4&amp;format=html">pf(4)</a>) in.</p></div><div class=paragraph><p>De optie <code>device pflog</code> schakelt het optionele <a href="https://man.freebsd.org/cgi/man.cgi?query=pflog&amp;sektion=4&amp;format=html">pflog(4)</a> pseudo-netwerkapparaat in dat gebruikt kan worden om verkeer te loggen naar een <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> descriptor. De <a href="https://man.freebsd.org/cgi/man.cgi?query=pflogd&amp;sektion=8&amp;format=html">pflogd(8)</a> daemon kan gebruikt worden om de logboekinformatie naar schijf te schrijven.</p></div><div class=paragraph><p>De optie <code>device pfsync</code> schakelt het optionele <a href="https://man.freebsd.org/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;format=html">pfsync(4)</a> pseudo netwerkapparaat in waarmee de toestandswijzigingen gemonitord kunnen worden.</p></div></div><div class=sect3><h4 id=_beschikbare_opties_voor_rc_conf>30.4.3. Beschikbare opties voor <span class=filename>rc.conf</span><a class=anchor href=#_beschikbare_opties_voor_rc_conf></a></h4><div class=paragraph><p>De volgende <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> statements stellen PF en <a href="https://man.freebsd.org/cgi/man.cgi?query=pflog&amp;sektion=4&amp;format=html">pflog(4)</a> in tijdens het opstarten:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_enable=&#34;YES&#34;                 # Schakel PF in (laad module als nodig)
pf_rules=&#34;/etc/pf.conf&#34;         # bestand met regels voor pf
pf_flags=&#34;&#34;                     # aanvullende vragen voor opstarten pfctl
pflog_enable=&#34;YES&#34;              # start pflogd(8)
pflog_logfile=&#34;/var/log/pflog&#34;  # waar pflogd het logboekbestand moet opslaan
pflog_flags=&#34;&#34;                  # aanvullende vlaggen voor opstarten pflogd</pre></div></div><div class=paragraph><p>Als er een LAN achter de firewall staat en er pakketten doorgestuurd moeten worden naar computers op het LAN of als NAT actief is, dan is de volgende optie ook nodig:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;            # Schakel in als LAN gateway</pre></div></div></div><div class=sect3><h4 id=_filterregels_aanmaken>30.4.4. Filterregels aanmaken<a class=anchor href=#_filterregels_aanmaken></a></h4><div class=paragraph><p>PF leest de instelregels van <a href="https://man.freebsd.org/cgi/man.cgi?query=pf.conf&amp;sektion=5&amp;format=html">pf.conf(5)</a> (standaard <span class=filename>/etc/pf.conf</span>) en het verandert, verwijdert, of geeft pakketten door aan de hand van de regels of definities die daar zijn gespecificeerd. De FreeBSD-installatie bevat een aantal voorbeeldbestanden in <span class=filename>/usr/shared/examples/pf/</span>. In de <a href=http://www.openbsd.org/faq/pf/>PF FAQ</a> staat een complete behandeling van de PF regels.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Houd tijdens het doornemen van de <a href=http://www.openbsd.org/faq/pf>PF FAQ</a> in de gaten dat verschillende versies van FreeBSD verschillende versies van PF kunnen bevatten. Momenteel gebruikt FreeBSD 8.<em>X</em> dezelfde versie van PF als OpenBSD 4.1. FreeBSD 9.<em>X</em> en hoger gebruiken dezelfde versie van PF als OpenBSD 4.5.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De <a href=https://lists.FreeBSD.org/subscription/freebsd-pf>FreeBSD pakketfilter mailinglijst</a> is een goede plaats om vragen over het instellen en draaien van de PF firewall te stellen. Vergeet niet de mailinglijstarchieven te controleren alvorens vragen te stellen!</p></div></div><div class=sect3><h4 id=_werken_met_pf>30.4.5. Werken met PF<a class=anchor href=#_werken_met_pf></a></h4><div class=paragraph><p>Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;format=html">pfctl(8)</a> om PF te beheren. Hieronder staan wat nuttige commando’s (bekijk de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;format=html">pfctl(8)</a> voor alle beschikbare opties):</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Commando</th><th class="tableblock halign-left valign-top">Doel</th><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top"></th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -e</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PF aanzetten</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -d</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PF uitzetten</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -F all -f /etc/pf.conf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Spoel alle regels door (nat, filter, toestand, tabel, etc.) en herlaad vanuit het bestand <span class=filename>/etc/pf.conf</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -s [ rules | nat | state ]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Rapporteer over de filterregels, NAT-regels, of toestandstabel</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -vnf /etc/pf.conf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Controleer <span class=filename>/etc/pf.conf</span> op fouten, maar laad de regelverzameling niet</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table></div><div class=sect3><h4 id=_altq_inschakelen>30.4.6. ALTQ inschakelen<a class=anchor href=#_altq_inschakelen></a></h4><div class=paragraph><p>ALTQ is alleen beschikbaar ondersteuning ervoor in de FreeBSD Kernel te compileren. ALTQ wordt niet door alle netwerkkaartstuurprogramma’s ondersteund. In <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> staat een lijst met ondersteunde stuurprogramma’s voor de betreffende versie.</p></div><div class=paragraph><p>Met de volgende opties wordt ALTQ ingeschakeld en additionele functionaliteit toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>options         ALTQ
options         ALTQ_CBQ        # Class Bases Queuing (CBQ)
options         ALTQ_RED        # Random Early Detection (RED)
options         ALTQ_RIO        # RED In/Out
options         ALTQ_HFSC       # Hierarchical Packet Scheduler (HFSC)
options         ALTQ_PRIQ       # Priority Queuing (PRIQ)
options         ALTQ_NOPCC      # Required for SMP build</pre></div></div><div class=paragraph><p><code>options ALTQ</code> schakelt het ALTQ raamwerk in.</p></div><div class=paragraph><p><code>options ALTQ_CBQ</code> schakelt <em>Class Based Queuing</em> (CBQ) in. Met CBQ kan de bandbreedte van een verbinding worden opgedeeld in verschillende klassen of wachtrijen om verkeer te prioriteren op basis van filterregels.</p></div><div class=paragraph><p><code>options ALTQ_RED</code> schakelt <em>Random Early Detection</em> (RED) in. RED wordt gebruikt om netwerkverstopping te voorkomen. RED doet dit door de lengte van de wachtrij te meten en die te vergelijken met de minimale en maximale drempelwaarden voor de wachtrij. Als de wachtrij groter is dan de maximale waarde worden alle nieuwe pakketten genegeerd. Het werkt naar zijn naam, dus RED negeert willekeurig pakketten van verschillende verbindingen.</p></div><div class=paragraph><p><code>options ALTQ_RIO</code> schakelt <em>Random Early Detection In and Out</em> in.</p></div><div class=paragraph><p><code>options ALTQ_HFSC</code> schakelt de <em>Hierarchical Fair Service Curve Packet Scheduler</em> in. Meer informatie over HFSC staat op <a href=http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html>http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html</a>.</p></div><div class=paragraph><p><code>options ALTQ_PRIQ</code> schakelt <em>Priority Queuing</em> (PRIQ) in. PRIQ laat verkeer dat in een hogere wachtrij staat altijd eerder door.</p></div><div class=paragraph><p><code>options ALTQ_NOPCC</code> schakelt SMP ondersteuning voor ALTQ in. Deze optie is verplicht op SMP systemen.</p></div></div></div><div class=sect2><h3 id=firewalls-ipf>30.5. De IPFILTER (IPF) firewall<a class=anchor href=#firewalls-ipf></a></h3><div class=paragraph><p>Darren Reed is de auteur van IPFILTER, dat niet afhankelijk is van één besturingssysteem. Het is een open source applicatie die is geporteerd naar FreeBSD, NetBSD, OpenBSD, SunOS, HP/UX en Solaris besturingssystemen. IPFILTER wordt actief ondersteund en onderhouden en er worden regelmatig nieuwe versies uigebracht.</p></div><div class=paragraph><p>IPFILTER is gebaseerd op een firewall aan de kernelkant en een NAT mechanisme dat gecontroleerd en gemonitord kan worden door programma’s in userland. De firewallregels kunnen ingesteld of verwijderd worden met het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a>. De NAT regels kunnen ingesteld of verwijderd worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=8&amp;format=html">ipnat(8)</a>. Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> kan actuele statistieken leveren voor de kernelonderdelen van IPFILTER. <a href="https://man.freebsd.org/cgi/man.cgi?query=ipmon&amp;sektion=8&amp;format=html">ipmon(8)</a> kan acties van IPFILTER wegschrijven naar logboekbestanden van het systeem.</p></div><div class=paragraph><p>IPF is oorspronkelijk geschreven met logica die regels verwerkte volgens het principe "de laatst passende regel wint" en gebruikte toen alleen staatloze regels. In de loop der tijd is IPF verbeterd en zijn de opties <code>quick</code> en <code>keep state</code> toegevoegd waarmee de logica van het verwerken van regels drastisch is gemoderniseerd. In de officiële documentatie van IPF worden alleen de regels en verwerkingslogica behandeld. De moderne functies worden alleen behandeld als opties, waardoor hun nut dat er een veel betere en veiligere firewall mee te maken volledig onderbelicht blijft.</p></div><div class=paragraph><p>De instructies in dit hoofdstuk zijn gebaseerd op regels die gebruik maken van de optie <code>quick</code> en de stateful optie <code>keep state</code>. Dit is het raamwerk waarmee een set van inclusieve firewallregels wordt samengesteld.</p></div><div class=paragraph><p>Voor een gedetailleerde uitleg over de verwerking van de verouderde regels zie <a href=http://www.munk.me.uk/ipf/ipf-howto.html>http://www.munk.me.uk/ipf/ipf-howto.html</a> en <a href=http://coombs.anu.edu.au/~avalon/ip-filter.html>http://coombs.anu.edu.au/~avalon/ip-filter.html</a>.</p></div><div class=paragraph><p>De IPF FAQ is te vinden op <a href=http://www.phildev.net/ipf/index.html>http://www.phildev.net/ipf/index.html</a>.</p></div><div class=paragraph><p>Een doorzoekbaar archief van de open-source IPFilter mailing lijst is beschikbaar op <a href="http://marc.theaimsgroup.com/?l=ipfilter">http://marc.theaimsgroup.com/?l=ipfilter</a>.</p></div><div class=sect3><h4 id=_ipf_inschakelen>30.5.1. IPF inschakelen<a class=anchor href=#_ipf_inschakelen></a></h4><div class=paragraph><p>IPF zit in de basisinstallatie van FreeBSD als een aparte "run time" laadbare module. Een systeem laadt de IPF kernel laadbare module dynamisch als <code>ipfilter_enable="YES"</code> in <span class=filename>rc.conf</span> staat. Voor de laadbare module zijn de opties <code>logging</code> en <code>default pass all</code> ingeschakeld. IPF hoeft niet in de kernel gecompileerd te worden om het standaardgedrag te wijzigen naar <code>block all</code>. Dat is mogelijk door op het einde van de regelverzameling een regel <code>block all</code> toe te voegen die al het verkeer blokkeert.</p></div></div><div class=sect3><h4 id=_kernelopties>30.5.2. Kernelopties<a class=anchor href=#_kernelopties></a></h4><div class=paragraph><p>Het is niet verplicht om IPF in te schakelen door de volgende opties in de FreeBSD kernel te compileren. Dit wordt alleen beschreven als achtergrondinformatie. Door IPF in de kernel te compileren wordt de laadbare module niet gebruikt.</p></div><div class=paragraph><p>Voorbeeld kernelinstellingen voor IPF staan beschreven in de <span class=filename>/usr/src/sys/i386/conf/LINT</span> in de kernelbroncode en worden hier beschreven:</p></div><div class="literalblock programlisting"><div class=content><pre>options IPFILTER
options IPFILTER_LOG
options IPFILTER_DEFAULT_BLOCK</pre></div></div><div class=paragraph><p><code>options IPFILTER</code> schakelt ondersteuning voor de "IPFILTER" firewall in.</p></div><div class=paragraph><p><code>options IPFILTER_LOG</code> schakelt de optie in waarmee IPF verkeer kan loggen door het naar het <span class=filename>ipl</span> pakketloggende pseudo-apparaat te schrijven voor iedere regel met het sleutelwoord <code>log</code> erin.</p></div><div class=paragraph><p><code>options IPFILTER_DEFAULT_BLOCK</code> wijzigt het standaardgedrag zodat ieder pakket waarop geen enkele <code>pass</code> regel van toepassing is wordt geblokkeerd.</p></div><div class=paragraph><p>Deze instelling worden pas actief nadat een kernel waarvoor deze instellingen zijn gemaakt is gebouwd en geïnstalleerd.</p></div></div><div class=sect3><h4 id=_beschikbare_opties_voor_rc_conf_2>30.5.3. Beschikbare opties voor <span class=filename>rc.conf</span><a class=anchor href=#_beschikbare_opties_voor_rc_conf_2></a></h4><div class=paragraph><p>De volgende instellingen moeten in <span class=filename>/etc/rc.conf</span> staan om IPF bij het opstarten te activeren:</p></div><div class="literalblock programlisting"><div class=content><pre>ipfilter_enable=&#34;YES&#34;             # Start ipf firewall
ipfilter_rules=&#34;/etc/ipf.rules&#34;   # laad regels uit het doelbestand
ipmon_enable=&#34;YES&#34;                # Start IP monitor log
ipmon_flags=&#34;-Ds&#34;                 # D = start als daemon
                                  # s = log naar syslog
                                  # v = log tcp window, ack, seq
                                  # n = vertaal IP &amp; poort naar namen</pre></div></div><div class=paragraph><p>Als er een LAN achter de firewall staat dat gebruik maakt van IP-adressen uit de private reeks, dan moet de volgende optie ook ingesteld worden om NAT-functionaliteit in te schakelen:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;              # Schakel in als LAN gateway
ipnat_enable=&#34;YES&#34;                # Start ipnat functie
ipnat_rules=&#34;/etc/ipnat.rules&#34;    # bestand met regels voor ipnat</pre></div></div></div><div class=sect3><h4 id=_ipf>30.5.4. IPF<a class=anchor href=#_ipf></a></h4><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> wordt gebruikt om het bestand met firewallregels te laden. Gewoonlijk wordt er een bestand aangemaakt waarin de situatieafhankelijke regels staan waarmee in één keer de bestaande regels kunnen worden vervangen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipf -Fa -f /etc/ipf.rules</span></code></pre></div></div><div class=paragraph><p><code>-Fa</code>: verwijder alle interne tabellen met regels.</p></div><div class=paragraph><p><code>-f</code>: laad het aangegeven bestand met regels.</p></div><div class=paragraph><p>Hiermee wordt het mogelijk wijzigingen te maken aan het bestand met eigen regels en met <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> de firewall aan te passen met verse regels zonder het systeem te booten. Deze methode is erg handig om nieuwe regels te testen omdat dit zo vaak als nodig gedaan kan worden.</p></div><div class=paragraph><p>In <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> worden alle opties die beschikbaar zijn toegelicht.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> verwacht dat het bestand met regels een standaard tekstbestand is. Het accepteert geen bestand met regels dat is opgesteld als een script dat gebruik maakt van substitutie.</p></div><div class=paragraph><p>Er is wel een mogelijkheid om IPF regels op te stellen en gebruik te maken van substitutie. Meer informatie staat in <a href=#firewalls-ipf-rules-script>Script met regels met substitutie bouwen</a>.</p></div></div><div class=sect3><h4 id=_ipfstat>30.5.5. IPFSTAT<a class=anchor href=#_ipfstat></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> haalt de totalen van de statistieken op die horen bij de firewall sinds die is gestart en toont deze. Het kan ook zijn dat de tellers in tussentijd op nul zijn gesteld met <code>ipf -Z</code>.</p></div><div class=paragraph><p>In <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> worden alle details behandeld.</p></div><div class=paragraph><p>Standaard ziet <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> uitvoer er ongeveer als volgt uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>input packets: blocked 99286 passed 1255609 nomatch 14686 counted 0
output packets: blocked 4200 passed 1284345 nomatch 14687 counted 0
input packets logged: blocked 99286 passed 0
output packets logged: blocked 0 passed 0
packets logged: input 0 output 0
log failures: input 3898 output 0
fragment state<span class=o>(</span><span class=k>in</span><span class=o>)</span>: kept 0 lost 0
fragment state<span class=o>(</span>out<span class=o>)</span>: kept 0 lost 0
packet state<span class=o>(</span><span class=k>in</span><span class=o>)</span>: kept 169364 lost 0
packet state<span class=o>(</span>out<span class=o>)</span>: kept 431395 lost 0
ICMP replies: 0 TCP RSTs sent: 0
Result cache hits<span class=o>(</span><span class=k>in</span><span class=o>)</span>: 1215208 <span class=o>(</span>out<span class=o>)</span>: 1098963
IN Pullups succeeded: 2 failed: 0
OUT Pullups succeeded: 0 failed: 0
Fastroute successes: 0 failures: 0
TCP <span class=nb>cksum </span>fails<span class=o>(</span><span class=k>in</span><span class=o>)</span>: 0 <span class=o>(</span>out<span class=o>)</span>: 0
Packet log flags <span class=nb>set</span>: <span class=o>(</span>0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Als er als optie <code>-i</code> voor inkomend of <code>-o</code> voor uitgaand wordt meegegeven, dan zal het commando de juiste lijst met regels die de kernel op dat moment gebruikt wordt weergeven.</p></div><div class=paragraph><p><code>ipfstat -in</code> toont de tabel met regels voor inkomend verkeer met regelnummers</p></div><div class=paragraph><p><code>ipfstat -on</code> toont de tabel met regels voor uitgaand verkeer met regelnummers</p></div><div class=paragraph><p>De uitvoer ziet er ongeveer als volgt uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>@1 pass out on xl0 from any to any
@2 block out on dc0 from any to any
@3 pass out quick on dc0 proto tcp/udp from any to any keep state</code></pre></div></div><div class=paragraph><p><code>ipfstat -ih</code> toont de tabel met regels voor inkomend verkeer, waarbij voor iedere regel staat hoe vaak die van toepassing was.</p></div><div class=paragraph><p><code>ipfstat -oh</code> toont de tabel met regels voor uitgaand verkeer, waarbij voor iedere regel staat hoe vaak die van toepassing was.</p></div><div class=paragraph><p>De uitvoer ziet er ongeveer als volgt uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>2451423 pass out on xl0 from any to any
354727 block out on dc0 from any to any
430918 pass out quick on dc0 proto tcp/udp from any to any keep state</code></pre></div></div><div class=paragraph><p>Een van de belangrijkste functies van <code>ipfstat</code> is de vlag <code>-t</code> waarmee de staat-tabel wordt getoond op een wijze die vergelijkbaar is met de wijze waarop <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> de draaiende FreeBSD procestabel toont. Als een firewall wordt aangevallen, dan geeft deze functie de mogelijkheid om de pakketten van de aanvaller te identificeren en nader te onderzoeken. De optionele subvlaggen bieden de mogelijkheid om een bron of bestemmings IP adres, poort of protocol aan te geven dat gemonitord moet worden. Details zijn na te lezen in <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a>.</p></div></div><div class=sect3><h4 id=_ipmon>30.5.6. IPMON<a class=anchor href=#_ipmon></a></h4><div class=paragraph><p>Om <a href="https://man.freebsd.org/cgi/man.cgi?query=ipmon&amp;sektion=8&amp;format=html">ipmon(8)</a> te laten werken zoals bedoeld, moet de kerneloptie <code>IPFILTER_LOG</code> aan staan. Dit commando kan op twee verschillende wijzen gebruikt worden. De standaard is van toepassing als het commando op de commandoregel wordt ingegeven zonder de optie <code>-D</code>.</p></div><div class=paragraph><p>De daemon wordt gebruikt als continu een systeemlogboek bijgewerkt moet worden zodat het mogelijk is om gebeurtenissen in het verleden te bekijken. Zo zijn FreeBSD en IPFILTER ingesteld om samen te werken. FreeBSD heeft ingebouwde mogelijkheden om automatisch syslogs te roteren. Daarom is het beter om de uitvoer naar <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> te schrijven dan naar een gewoon bestand. In de standaardversie van <span class=filename>rc.conf</span> is te zien dat de instelling <code>ipmon_flags</code> de waarde <code>-Ds</code> heeft:</p></div><div class="literalblock programlisting"><div class=content><pre>ipmon_flags=&#34;-Ds&#34; # D = start als daemon
                  # s = log naar syslog
                  # v = log tcp window, ack, seq
                  # n = vertaal IP &amp; poort naar namen</pre></div></div><div class=paragraph><p>De voordelen van loggen zijn duidelijk. Het biedt de mogelijkheid om na het feit informatie na te zien als: welke pakketten heeft de firewall laten vallen, waar kwamen ze vandaan en waar gingen ze heen? Dit zijn allemaal voordelen als het gaat om uitvinden waar een aanvaller vandaan komt en wat deze heeft geprobeerd.</p></div><div class=paragraph><p>Zelfs als loggen is ingeschakeld, logt IPF nog niets uit zichzelf. De beheerder van de firewall beslist welke regels in de regelverzameling iets weg moeten schrijven door het sleutelwoord <code>log</code> aan die regels toe te voegen. Gewoonlijk worden alleen <code>deny</code> regels gelogd.</p></div><div class=paragraph><p>Het is heel normaal om als laatste regel een <code>deny</code> regel aan de set met regels toe te voegen waar het sleutelwoord <code>log</code> in staat. Zo krijgt een beheerder alle pakketten te zien waarop geen enkele regel van toepassing was.</p></div></div><div class=sect3><h4 id=_loggen_met_ipmon>30.5.7. Loggen met IPMON<a class=anchor href=#_loggen_met_ipmon></a></h4><div class=paragraph><p>Syslogd heeft een eigen methode om logboekgegevens te scheiden. Het maakt gebruik van speciale groepen die "facility" en "level" heten. <a href="https://man.freebsd.org/cgi/man.cgi?query=ipmon&amp;sektion=8&amp;format=html">ipmon(8)</a> in <code>-Ds</code> mode gebruikt <code>local0</code> als "facility"naam. Alle door <a href="https://man.freebsd.org/cgi/man.cgi?query=ipmon&amp;sektion=8&amp;format=html">ipmon(8)</a> gelogde gegevens gaan standaard naar de naam <code>security</code>. De nu volgende levels kunnen gebruikt worden om de gelogde gegevens nog verder uit elkaar te trekken als dat gewenst is.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>LOG_INFO – pakketten gelogd met het sleutelwoord <span class=s2>&#34;log&#34;</span> als actie <span class=k>in </span>plaats van pass of block.
LOG_NOTICE – gelogde pakketten die ook zijn doorgelaten
LOG_WARNING – gelogde pakketten die ook geblokkeerd zijn
LOG_ERR – gelogde pakketten die een verkeerde opbouw hebben, <span class=s2>&#34;short&#34;</span></code></pre></div></div><div class=paragraph><p>Om IPFILTER alle gelogde gegevens naar <span class=filename>/var/log/ipfilter.log</span> te laten schrijven, dient dat bestand vooraf te bestaan. Dat kan met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/log/ipfilter.log</span></code></pre></div></div><div class=paragraph><p>De functionaliteit van <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> wordt beheerd met instellingen in <span class=filename>/etc/syslog.conf</span>. Dit bestand biedt aanzienlijke flexibiliteit in hoe syslog omgaat met systeemberichten die door softwaretoepassingen als IPF worden gegeven.</p></div><div class=paragraph><p>Zo kan de volgende instelling toegevoegd worden aan <span class=filename>/etc/syslog.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>local0.* /var/log/ipfilter.log</pre></div></div><div class=paragraph><p>Het deel <code>local0.*</code> betekent dat alle logberichten naar de aangegeven plaats geschreven moeten worden.</p></div><div class=paragraph><p>Om de wijzigingen in <span class=filename>/etc/syslog.conf</span> actief te maken kan er opnieuw opgestart worden of is het mogelijk de daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> een schop te geven zodat <span class=filename>/etc/syslog.conf</span> opnieuw wordt ingelezen met <code>/etc/rc.d/syslogd reload</code>. Het PID (procesnummer) is te achterhalen door een overzicht van taken te tonen met <code>ps -ax</code>. Het PID is het nummer in de linker kolom voor de regel waarop "syslog" staat.</p></div><div class=paragraph><p>Vaak wordt vergeten <span class=filename>/etc/newsyslog.conf</span> te wijzigen om het nieuw aangemaakte logboekbestand te laten roteren.</p></div></div><div class=sect3><h4 id=_de_opmaak_van_gelogde_berichten>30.5.8. De opmaak van gelogde berichten<a class=anchor href=#_de_opmaak_van_gelogde_berichten></a></h4><div class=paragraph><p>Berichten die door <code>ipmon</code> wordt gezonden bestaan uit velden die gescheiden worden door een spatie. Velden die in alle berichten zitten zijn:</p></div><div class="olist arabic"><ol class=arabic><li><p>De datum waarop het pakket is ontvangen.</p></li><li><p>De tijd waarop het pakket is ontvangen weergegeven als HH:MM:SS.F voor uren, minuten, seconden en fracties van een seconde. De fractie kan meerdere cijfers lang zijn.</p></li><li><p>De naam van de interface waarop het pakket is ontvangen, bijvoorbeeld <span class=filename>dc0</span>.</p></li><li><p>De groep en regelnummer van de regel, bijvoorbeeld <code>@0:17</code>.</p></li></ol></div><div class=paragraph><p>Deze kunnen ingezien worden met <code>ipfstat -in</code>.</p></div><div class="olist arabic"><ol class=arabic><li><p>De acties: <code>p</code> voor doorgelaten ("passed"), <code>b</code> voor geblokkeerd ("blocked"), <code>S</code> voor een verkeerd pakket ("short packet"), <code>n</code> voor dat er geen enkele regel van toepassing was, <code>L</code> voor een logboekregel. De volgorde waarin deze acties getoond worden is: S, p, b, n, L. Een hoofdletter <code>P</code> of <code>B</code> betekent dat het pakket gelogd is vanwege een globale instelling, niet vanwege één regel in het bijzonder.</p></li><li><p>De adressen. Dit zijn eigenlijk drie velden: het bronadres en poort gescheiden door een komma, het symbool → en het bestemmingsadres en poort, bijvoorbeeld: <code>209.53.17.22,80 → 198.73.220.17,1722</code>.</p></li><li><p>Achter <code>PR</code> staat de naam van het protocol of het nummer, bijvoorbeeld <code>PR tcp</code>.</p></li><li><p>Achter <code>len</code> staan de lengte van de pakketkop en de totale lengte van het pakket, bijvoorbeeld <code>len 20 40</code>.</p></li></ol></div><div class=paragraph><p>Als het pakket een TCP pakket is, dan is er nog een veld dat begint met een verbindingsstreepje met daarachter letters die overeenkomen met vlaggen die ingeschakeld waren. In <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=5&amp;format=html">ipf(5)</a> is een lijst met letters en bijbehorende vlaggen te vinden.</p></div><div class=paragraph><p>Als het pakket een ICMP pakket is, dan worden aan het einde twee velden toegevoegd. Het eerste is altijd <code>ICMP</code> en het volgende het ICMP bericht en subbericht type, gescheiden door een slash, bijvoorbeeld <code>ICMP 3/3</code> voor "een poort niet bereikbaar" bericht.</p></div></div><div class=sect3><h4 id=firewalls-ipf-rules-script>30.5.9. Script met regels met substitutie bouwen<a class=anchor href=#firewalls-ipf-rules-script></a></h4><div class=paragraph><p>Geoefende gebruikers van IPF maken een bestand dat de regels bevat en stellen dat op zo’n manier op dat het uitgevoerd kan worden als een script met substitutie. Het grote voordeel van deze werkwijze is dat er dan alleen de waarde geassocieerd met een symbolische naam gewijzigd hoeft te worden en dat als het script opnieuw wordt uitgevoerd, op alle plaatsen waar de variabele wordt gebruikt, de nieuwe waarde in de regels wordt opgenomen. Omdat het een script is, kan substitutie gebruik worden om vaak voorkomende waarden de definiëren zodat ze in meerdere regels vervangen kunnen worden. Dit wordt geïllustreerd in het onderstaande voorbeeld.</p></div><div class=paragraph><p>De syntaxis die in het script wordt gebruikt is compatibel met de shells <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=tcsh&amp;sektion=1&amp;format=html">tcsh(1)</a>.</p></div><div class=paragraph><p>Velden waarvoor substitutie van toepassing is worden vooraf gegaan door het dollarteken <code>$</code>.</p></div><div class=paragraph><p>Definities worden niet vooraf gegaan door het voorvoegsel $.</p></div><div class=paragraph><p>De waarden van een definitie moet omsloten worden door dubbele aanhalingstekens (<code>"</code>).</p></div><div class=paragraph><p>Een set regels begint wellicht als volgt:</p></div><div class="literalblock programlisting"><div class=content><pre>############## Begin IPF regels script #########################
oif=&#34;dc0&#34;            # naam van de uitgaande interface
odns=&#34;192.0.2.11&#34;    # IP adres van DNS server ISP
myip=&#34;192.0.2.7&#34;     # statische IP adres gekregen van ISP
ks=&#34;keep state&#34;
fks=&#34;flags S keep state&#34;

# Er kan gekozen worden om dit script te gebruiken om een eigen
# /etc/ipf.rules script te maken of dit script kan gebruikt worden
# &#34;as is&#34;
#
# Haal bij één van deze regels het commentaarteken weg
# en plaats hem bij de ander.
#
# 1) Deze kan gebruikt worden om /etc/ipf.rules te maken:
#cat &gt; /etc/ipf.rules &lt;&lt; EOF
# 2) Deze kan gebruikt worden om het script &#34;as is&#34; te starten:
# Let op: er moet een lege regel zijn na het EOF teken.
/sbin/ipf -Fa -f - &lt;&lt; EOF

# Verleen toegang tot de DNS van de ISP.
pass out quick on $oif proto tcp from any to $odns port = 53 $fks
pass out quick on $oif proto udp from any to $odns port = 53 $ks

# Sta uitgaand verkeer voor niet beveiligd www verkeer toe
pass out quick on $oif proto tcp from $myip to any port = 80 $fks

# Sta uitgaand verkeer voor beveiligd www verkeer toe (https over TLS SSL)
pass out quick on $oif proto tcp from $myip to any port = 443 $fks
EOF
################## Einde IPF regels script ########################</pre></div></div><div class=paragraph><p>Dat is alles. De regels zijn niet van belang in dit voorbeeld, maar tonen hoe substitutievelden worden gedefinieerd en hoe ze worden gebruikt. Als het bovenstaande voorbeeld de inhoud van <span class=filename>/etc/ipf.rules.script</span> was, dan konden deze regels herladen worden door het vanaf de commandoregel aan te roepen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sh /etc/ipf.rules.script</span></code></pre></div></div><div class=paragraph><p>Er is wel een probleem met het gebruik van regels in combinatie met substitutie. IPF snapt het niet en kan deze scripts niet direct lezen.</p></div><div class=paragraph><p>Dit script kan gebruikt worden op één van de volgende twee manieren:</p></div><div class=ulist><ul><li><p>Haal het commentaarteken weg bij de regel die begint met <code>cat</code> en zet het commentaarteken bij de regel die begint met <code>/sbin/ipf</code>. Plaats <code>ipfilter_enable="YES"</code> in <span class=filename>/etc/rc.conf</span> zoals gewoonlijk en start het script eenmalig na elke wijziging om <span class=filename>/etc/ipf.rules</span> te maken of bij te werken.</p></li><li><p>Schakel IPFILTER uit in de systeem opstart scripts door <code>ipfilter_enable="NO"</code> toe te voegen aan <span class=filename>/etc/rc.conf</span> (dit is de standaardwaarde).</p><div class=paragraph><p>Voeg een script zoals de volgende toe aan de opstartmap <span class=filename>/usr/local/etc/rc.d</span>. Het script zou een duidelijke naam moeten hebben zoals <span class=filename>ipf.loadrules.sh</span>. De uitbreiding <span class=filename>.sh</span> is noodzakelijk.</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
sh /etc/ipf.rules.script</pre></div></div><div class=paragraph><p>De permissies op dit script moeten zijn: lezen,schrijven en uitvoeren voor de gebruiker <code>root</code>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 700 /usr/local/etc/rc.d/ipf.loadrules.sh</span></code></pre></div></div></li></ul></div><div class=paragraph><p>Als het systeem nu herstart, worden de regels via het script gestart.</p></div></div><div class=sect3><h4 id=_sets_van_ipf_regels>30.5.10. Sets van IPF regels<a class=anchor href=#_sets_van_ipf_regels></a></h4><div class=paragraph><p>Een set regels is een groep IPF-regels die is gemaakt om pakketten toe te staan of te blokkeren op basis van de eigenschappen van dat pakket. De bi-directionele uitwisseling van pakketten tussen hosts bestaat uit een gesprek dat een sessie heet. De set van firewallregels verwerkt zowel de pakketten die arriveren van het publieke Internet, als de pakketten die door het systeem zijn geproduceerd als een antwoord erop. Elke TCP/IP-dienst (telnet, www, mail, enzovoorts) is vooraf gedefinieerd door een protocol en bevoorrechte (luister)poort. Pakketten bedoeld voor een speciale dienst beginnen bij het bronadres gebruik makend van een onbevoorrechte (hogere orde) poort en komen aan bij de specifieke dienstpoort op het bestemmingsadres. Alle bovengenoemde parameters (poorten en adressen) kunnen gebruikt worden als selectiecriteria om regels aan te maken die diensten zullen toestaan of blokkeren.</p></div><div class=paragraph><p>IPF is oorspronkelijk geschreven met logica die regels verwerkte volgens het principe "de laatst passende regel wint" en gebruikte toen alleen staatloze regels. In de loop der tijd is IPF verbeterd en zijn de opties "quick" en "keep state" toegevoegd waarmee de logica van het verwerken van regels drastisch is gemoderniseerd.</p></div><div class=paragraph><p>De instructies in dit hoofdstuk zijn gebaseerd op regels die gebruik maken van de optie "quick" en de stateful optie "keep state". Dit is het raamwerk waarmee een set van inclusieve firewallregels wordt samengesteld.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Werk bij het wijzigen van firewallregels <em>zeer voorzichtig</em>. Met sommige instellingen is een server <em>niet meer bereikbaar</em>. Om het veilig te spelen is het aan te raden de eerste instellingen vanaf het console te maken, in plaats van via ssh.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_regelsyntaxis>30.5.11. Regelsyntaxis<a class=anchor href=#_regelsyntaxis></a></h4><div class=paragraph><p>De regelsyntaxis die hier wordt besproken is versimpeld door alleen de moderne stateful regels en de "eerste van toepassing zijnde regel wint" te belichten. De complete regelsyntaxis is na te lezen in <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a>.</p></div><div class=paragraph><p>Het karakter <code>#</code> wordt gebruikt om het begin van een opmerking te markeren en zowel op een eigen regel als achter een firewallregel staan. Lege regels worden genegeerd.</p></div><div class=paragraph><p>Regels bevatten sleutelwoorden die in een bepaalde volgorde van links naar rechts op een regel horen te staan. Sleutelwoorden worden vet weergegeven. Sommige sleutelwoorden hebben subopties die zelf ook weer sleutelwoorden hebben die ook weer subopties kunnen hebben. Alle opties die hier direct onder staan, worden daaronder uitgebreid weergegeven en verderop in dit hoofdstuk in een aparte paragraaf behandeld.</p></div><div class=paragraph><p><em>ACTIE IN/UIT OPTIES SELECTIE STATEFUL PROTO BRON_ADR,BEST_ADR OBJECT POORT_NUM TCP_VLAG STATEFUL</em></p></div><div class=paragraph><p><em>ACTIE</em> = block | pass</p></div><div class=paragraph><p><em>IN/UIT</em> = in | out</p></div><div class=paragraph><p><em>OPTIES</em> = log | quick | on interfacenaam</p></div><div class=paragraph><p><em>SELECTIE</em> = protowaarde | bron/bestemming IP | poort = nummer | flags flag-value</p></div><div class=paragraph><p><em>PROTO</em> = tcp/udp | udp | tcp | icmp</p></div><div class=paragraph><p><em>BRON_ADR,BEST_ADR</em> = all | from object to object</p></div><div class=paragraph><p><em>OBJECT</em> = IP adres | any</p></div><div class=paragraph><p><em>POORT_NUM</em> = poortnummer</p></div><div class=paragraph><p><em>TCP_VLAG</em> = S</p></div><div class=paragraph><p><em>STATEFUL</em> = keep state</p></div><div class=sect4><h5 id=_actie>30.5.11.1. ACTIE<a class=anchor href=#_actie></a></h5><div class=paragraph><p>De actie geeft aan wat er met het pakket gedaan moet worden als het van toepassing is op de rest van de filterregel. Iedere regel <em>moet</em> een actie hebben. De volgende acties zijn mogelijk:</p></div><div class=paragraph><p><code>block</code> geeft aan dat het pakket moet verdwijnen als de parameters van toepassing zijn op het pakket.</p></div><div class=paragraph><p><code>pass</code> geeft aan dat het pakket doorgelaten moet worden als de parameters van toepassing zijn op het pakket.</p></div></div><div class=sect4><h5 id=_inuit>30.5.11.2. IN/UIT<a class=anchor href=#_inuit></a></h5><div class=paragraph><p>Een verplicht onderdeel voor iedere filterregel waarin expliciet wordt aangegeven op welke zijde van de in/uit deze van toepassing is. Het volgende sleutelwoord moet <code>in</code> of <code>out</code> zijn en één van de twee moet gecodeerd worden, anders is de regel syntactisch onjuist.</p></div><div class=paragraph><p><code>in</code> betekent dat de regel van toepassing is op inkomende pakketten.</p></div><div class=paragraph><p><code>out</code> betekent dat de regel van toepassing is op inkomende pakketten.</p></div></div><div class=sect4><h5 id=_opties>30.5.11.3. OPTIES<a class=anchor href=#_opties></a></h5><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Deze opties moeten in de volgorde waarin ze hier beschreven staan gebruikt worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p><code>log</code> geeft aan dat het pakket naar het <span class=filename>ipl</span> logboekbestand geschreven moeten worden (zoals verderop beschreven staat in de paragraaf "Loggen") als de regel van toepassing is op het pakket.</p></div><div class=paragraph><p><code>quick</code> geeft aan dat als een regel van toepassing is, dat de laatste regel moet zijn die wordt gecontroleerd, waardoor er een pad wordt "kortgesloten" waardoor de volgende regels voor dat pakket niet meer gecontroleerd worden. Deze optie is voor de moderne regels eigenlijk verplicht.</p></div><div class=paragraph><p><code>on</code> geeft de interface aan die in de parameters meegenomen moet worden. De namen van interfaces kunnen getoond worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a>. Als deze optie wordt gebruikt, kan een regel alleen van toepassing zijn als het pakket door de aangegeven interface gaat in de richting die is aangegeven (<code>in</code>/<code>out</code>). Ook deze optie is verplicht voor de moderne regels.</p></div><div class=paragraph><p>Als een pakket wordt gelogd, dan worden de koppen van het pakket weggeschreven naar het ipl pakketloggende pseudo-apparaat. Direct na het sleutelwoord <code>log</code> mogen de volgende opties gebruikt worden (in de aangegeven volgorde):</p></div><div class=paragraph><p><code>body</code> geeft aan dat de eerste 128 bytes van de inhoud van het pakket worden opgeslagen na de kop.</p></div><div class=paragraph><p><code>first</code>; als het sleutelwoord <code>log</code> samen met een optie <code>keep state</code> wordt gebruikt, wordt het aangeraden om deze optie ook te gebruiken zodat alleen het pakket dat als eerste in de sessie van toepassing was en niet ook alle pakketten die daarna in de sessie volgens <code>keep state</code> van toepassing zijn.</p></div></div><div class=sect4><h5 id=_selectie>30.5.11.4. SELECTIE<a class=anchor href=#_selectie></a></h5><div class=paragraph><p>De sleutelwoorden in deze paragraaf worden gebruikt om attributen van het pakket dat wordt geïnspecteerd te beschrijven om te bepalen of een regel wel of niet van toepassing is. Er is een sleutelwoord <code>subject</code> en er zijn subopties waarvan er één of meer gekozen moeten worden. De volgende attributen zijn beschikbaar voor het proces en moeten in de aangegeven volgorde worden gebruikt:</p></div></div><div class=sect4><h5 id=_proto>30.5.11.5. PROTO<a class=anchor href=#_proto></a></h5><div class=paragraph><p><code>proto</code> is het <code>subject</code> sleutelwoord dat moet worden aangegeven samen met een van de sleutelwoorden uit de subopties. De waarde geeft een bepaald protocol aan dat van toepassing moet zijn. Ook deze optie is verplicht voor de moderne regels.</p></div><div class=paragraph><p><code>tcp/udp</code>, <code>tcp</code>, <code>udp</code>, <code>icmp</code> of ieder ander protocol dat in <span class=filename>/etc/protocols</span> staat wordt herkend en kan gebruikt worden. Het bijzondere protocolsleutelwoord <code>tcp/udp</code> kan gebruikt worden om zowel voor TCP- als UDP-pakketten van toepassing te laten zijn. Het is toegevoegd voor het gemak om vrijwel gelijke regels te voorkomen.</p></div></div><div class=sect4><h5 id=_bron_adrbest_adr>30.5.11.6. BRON_ADR/BEST_ADR<a class=anchor href=#_bron_adrbest_adr></a></h5><div class=paragraph><p>Het sleutelwoord <code>all</code> is in feite hetzelfde als <code>from any to any</code> zonder overige parameters.</p></div><div class=paragraph><p><code>from bron to bestemming</code>; de sleutelwoorden <code>from</code> en <code>to</code> worden gebruikt om te testen op IP-adressen. In regels moet <em>zowel</em> een bron- <em>als</em> bestemmings-IP-adres aangegeven worden. <code>any</code> is een bijzonder sleutelwoord dat van toepassing is op ieder IP-adres. Voorbeelden van gebruik: <code>from any to any</code> of <code>from 0.0.0.0/0 to any</code> of <code>from any to 0.0.0.0/0</code> of <code>from 0.0.0.0 to any</code> of <code>from any to 0.0.0.0</code>.</p></div><div class=paragraph><p>Het is vaak lastig om te komen tot een reeks IP-adressen die zich niet gemakkelijk laten uitdrukken met de gepunte numerieke vorm/ maskerlengte notatie. De port <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/ipcalc/>net-mgmt/ipcalc</a> kan gebruikt worden om de berekeningen te vereenvoudigen. Aanvullende informatie is beschikbaar op de webpagina van het gereedschap: <a href=http://jodies.de/ipcalc>http://jodies.de/ipcalc</a>.</p></div></div><div class=sect4><h5 id=_poort>30.5.11.7. POORT<a class=anchor href=#_poort></a></h5><div class=paragraph><p>Als in een regel op een poort wordt gecontroleerd, voor bron- of bestemmingspoort of beiden, dan is dat alleen van toepassing op TCP- en UDP-pakketten. Bij het maken van poortvergelijkingen kunnen zowel de dienstnamen uit <span class=filename>/etc/services</span> als een uit een natuurlijk getal bestaand poortnummer ingesteld worden. Als de poort onderdeel is van het <code>from</code> object dan wordt het vergeleken met het poortnummer van de bron en als het onderdeel is van het <code>to</code> object, dan wordt het vergeleken met het poortnummer van de bestemming. Het gebruik van het <code>to</code> object is in de moderne regels verplicht en neemt de vorm aan van <code>from any to any port = 80</code>.</p></div><div class=paragraph><p>Enkelvoudige poortvergelijkingen kunnen op verschillende manieren gedaan worden met een aantal verschillende operatoren. Er kunnen ook reeksen van poorten ingesteld worden.</p></div><div class=paragraph><p>poort "=" | "!=" | "&lt;" | ">" | "⇐" | ">=" | "eq" | "ne" | "lt" | "gt" | "le" | "ge"</p></div><div class=paragraph><p>Reeksen van poorten worden met de volgende optie aangegeven: poort &lt;> | >&lt;</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>De volgende twee parameters die betrekking hebben op bron en bestemming, zijn verplicht in de moderne regels.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_tcp_vlag>30.5.11.8. TCP_VLAG<a class=anchor href=#_tcp_vlag></a></h5><div class=paragraph><p>Vlaggen zijn alleen beschikbaar voor het filteren van TCP. De letters staan voor de mogelijke vlaggen die bekeken kunnen worden in de kop van een TCP-pakket.</p></div><div class=paragraph><p>In de moderne regels wordt de optie <code>flags S</code> gebruikt om het verzoek tot het starten van een TCP sessie.</p></div></div><div class=sect4><h5 id=_stateful>30.5.11.9. STATEFUL<a class=anchor href=#_stateful></a></h5><div class=paragraph><p><code>keep state</code> geeft aan dat in een regel met <code>pass</code> voor alle pakketten die van toepassing zijn stateful gefilterd moet worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Deze optie is voor moderne regels verplicht.</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=_stateful_filteren>30.5.12. Stateful filteren<a class=anchor href=#_stateful_filteren></a></h4><div class=paragraph><p>Met stateful filteren wordt verkeer benaderd als een uitwisseling van pakketten tussen twee kanten die een sessie zijn. Als het is ingeschakeld, dan maakt het <code>keep state</code> mechanisme dynamisch interne regels voor pakketten die in de sessie horen te volgen. Het kan bekijken of de karakteristieken van de sessie tussen verzender en ontvanger de juiste procedure volgen. Alle pakketten die niet passen in de sessie, worden automatisch geblokkeerd.</p></div><div class=paragraph><p><code>keep state</code> staat ook ICMP-pakketten toe die gerelateerd zijn aan een TCP- of UDP-sessie. Dus als er een ICMP-type 3 code 4 komt in antwoord op websurfen, dat wordt toegestaan van binnen naar buiten door een <code>keep state</code> regel, dan wordt dat toegelaten. Pakketten waarvan IPF zeker is dat ze onderdeel zijn van de sessie worden toegelaten, zelfs als ze van een ander protocol zijn.</p></div><div class=paragraph><p>Wat er gebeurt: pakketten die naar buiten gaan op de interface die met Internet is verbonden worden eerst vergeleken met de dynamische staattabel. Als een pakket voldoet aan de verwachting van het volgende pakket in de sessie, dan mag het de firewall verlaten en wordt de toestand van de sessie in de dynamische toestandstabel bijgewerkt. Pakketten die niet bij een reeds actieve sessie horen, worden tegen de uitgaande regelverzameling gecontroleerd.</p></div><div class=paragraph><p>Pakketten die binnenkomen op de interface die met Internet is verbonden worden eerst vergeleken met de dynamische staattabel. Als een pakket voldoet aan de verwachting van het volgende pakket in de sessie, dan mag het de firewall verlaten en wordt de toestand van de sessie in de dynamische toestandstabel bijgewerkt. Pakketten die niet bij een reeds actieve sessie horen, worden vergeleken met de regelverzameling voor binnenkomend verkeer.</p></div><div class=paragraph><p>Als de sessie wordt beëindigd wordt het uit de dynamische staattabel verwijderd.</p></div><div class=paragraph><p>Met stateful filteren is het mogelijk om de focus te leggen op het blokkeren of toestaan van nieuwe sessies. Als een nieuwe sessie tot stand mag komen, dan worden alle volgende pakketten automatisch doorgelaten en al het vervalste verkeer wordt automatisch tegengehouden. Als een nieuwe sessie wordt geweigerd, dan wordt geen enkel pakket doorgelaten. Met stateful filteren zijn er uitgebreide mogelijkheden voor onderzoek om bescherming te bieden tegen de veelheid aan aanvallen die tegenwoordig door aanvallers worden uitgevoerd.</p></div></div><div class=sect3><h4 id=_voorbeeld_van_inclusieve_regels>30.5.13. Voorbeeld van inclusieve regels<a class=anchor href=#_voorbeeld_van_inclusieve_regels></a></h4><div class=paragraph><p>De onderstaande regels zijn een voorbeeld van hoe een erg veilige inclusieve firewall opgezet kan worden. Een inclusieve firewall staat alleen diensten toe die passen bij de <code>pass</code>-regels en blokkeert al het overige verkeer. Firewalls die bedoeld zijn om andere machines te beschermen, ook wel "netwerk-firewalls" genoemd, dienen tenminste twee interfaces te hebben, die over het algemeen zijn ingesteld om de ene kant te vertrouwen (het LAN) maar niet de andere (het publieke Internet). Ook kan een firewall worden ingesteld om alleen het systeem te beschermen waarop het draait-dit wordt een "host-gebaseerde firewall" genoemd, en is in het bijzonder geschikt voor servers op een onvertrouwd netwerk.</p></div><div class=paragraph><p>Alle UNIX® systemen en dus ook FreeBSD zijn zo ontworpen dat ze voor interne communicatie de interface <span class=filename>lo0</span> en IP adres <code>127.0.0.1</code> gebruiken. De firewall moet dit interne verkeer gewoon doorgang laten vinden.</p></div><div class=paragraph><p>Voor de interface die is verbonden met het publieke Internet worden regels gemaakt waarmee de toegang voor uitgaande en binnenkomende verbindingen worden geautoriseerd en beheerst. Dit kan de PPP-interface <span class=filename>tun0</span> zijn of de netwerkkaart die is verbonden met een xDSL- of kabelmodem.</p></div><div class=paragraph><p>In gevallen dat er één of meer netwerkkaarten zijn aangesloten op private netwerksegmenten kunnen er regels op de firewall nodig zijn om pakketten die van die LAN-interfaces afkomen vrije doorgang te geven naar elkaar en/of naar buiten (het Internet).</p></div><div class=paragraph><p>De regels worden opgedeeld in drie onderdelen: eerst de vertrouwde interfaces, dan het publieke uitgaande interface en als laatste het onvertrouwde publieke binnenkomende interfaces.</p></div><div class=paragraph><p>In iedere sectie moeten zo staan dat de regels die het meest gebruikt worden vóór de regels die minder vaak gebruikt worden staan. De laatste regel van een onderdeel geeft aan dat al het overige verkeer op die interface in die richting geblokkeerd en gelogd moet worden.</p></div><div class=paragraph><p>In het onderdeel Uitgaand staan alleen regels met <code>pass</code> die parameters bevatten om uniek individuele diensten identificeren die het publieke Internet mogen benaderen. Bij al die regels staan de opties <code>quick</code>, <code>on</code>, <code>proto</code>, <code>port</code> en <code>keep state</code> aan. De regels met <code>proto tcp</code> maken ook gebruik van de optie <code>flag</code> om te bekijken of het een pakket betreft voor het opzetten van een sessie om de stateful functionaliteit aan te sturen.</p></div><div class=paragraph><p>In het onderdeel Inkomend staan eerst alle regels voor het blokkeren van ongewenste pakketten, om twee redenen. Als eerste kan het zo zijn dat kwaadaardige pakketten gedeeltelijk overeenkomen met legitiem verkeer. Deze pakketten moeten worden weggegooid in plaats van binnengelaten te worden, gebaseerd op hun gedeeltelijke match met de <code>allow</code>-regels. De tweede reden is dat bekende en oninteressante verwerpingen stil geblokkeerd kunnen worden in plaats van gevangen en gelogd te worden door de laatste regels in de sectie. De laatste regel in elke sectie blokkeert en logt alle pakketten en kan worden gebruikt voor het wettelijke bewijs nodig om degenen die uw systeem aanvallen aan te klagen.</p></div><div class=paragraph><p>Waar ook gezorgd voor moet worden is dat al het verkeer dat wordt geweigerd geen antwoord verstuurd. Ongeldige pakketten dienen gewoon te verdwijnen. Zo weet een aanvaller niet of een pakket het doelsysteem wel heeft bereikt. Zo kan een aanvaller geen informatie verzamelen over een systeem: hoe minder informatie er over een systeem beschikbaar is, hoe meer tijd iemand erin moet steken voordat er iets slechts gedaan kan worden. Regels die een optie <code>log first</code> bevatten, zullen alleen de eerste keer dat de gebeurtenis voorkomt de gebeurtenis loggen. Deze optie is opgenomen in de voorbeeldregel <code>nmap OS fingerpint</code>. Het gereedschap <a class=package href=https://cgit.freebsd.org/ports/tree/security/nmap/>security/nmap</a> wordt vaak door aanvallers gebruikt om het besturingssysteem van uw server proberen te achterhalen.</p></div><div class=paragraph><p>We raden aan om telkens als er logmeldingen van een regel met de optie <code>log first</code> komen, <code>ipfstat -hio</code> uit te voeren om te bekijken hoe vaak de regel van toepassing is geweest. Een groot aantal overeenkomsten geeft gewoonlijk aan dat de firewall overspoeld wordt, met andere woorden aangevallen wordt.</p></div><div class=paragraph><p>Het bestand <span class=filename>/etc/services</span> kan gebruikt worden om onbekende poortnummers op te zoeken. Ook kan <a href=http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers>http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers</a> worden bezocht en het poortnummer worden opgezocht om het doel van een bepaalde poort uit te vinden.</p></div><div class=paragraph><p>Op de volgende link worden poortnummers van Trojans beschreven: <a href=http://www.sans.org/security-resources/idfaq/oddports.php>http://www.sans.org/security-resources/idfaq/oddports.php</a>.</p></div><div class=paragraph><p>De onderstaande set regels is een complete en erg veilige <code>inclusieve</code> set met regels voor een firewall die is getest op productiesystemen. Deze set met regels is eenvoudig aan te passen voor uw eigen systeem. Maak gewoon commentaar van elke <code>pass</code>-regel voor een dienst die niet gewenst is.</p></div><div class=paragraph><p>Logberichten die niet gewenst zijn, zijn uit te sluiten door een <code>block</code>-regel toe te voegen in het begin van het onderdeel Inkomend.</p></div><div class=paragraph><p>Voor de onderstaande regels dient de <span class=filename>dc0</span> interfacenaam in iedere regel vervangen te worden door de echte interfacenaam van de netwerkkaart in het systeem die met het publieke Internet is verbonden. Voor gebruikers van PPP zou dat <span class=filename>tun0</span> zijn.</p></div><div class=paragraph><p>Dit zou de inhoud van <span class=filename>/etc/ipf.rules</span> kunnen zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>#################################################################
# Geen beperkingen op de interface aan de LAN kant.
# Niet nodig als er geen LAN is.
################################################################

#pass out quick on xl0 all
#pass in quick on xl0 all

#################################################################
# Geen beperkingen op de loopback interface
#################################################################
pass in quick on lo0 all
pass out quick on lo0 all

#################################################################
# Interface aan het publieke Internet (onderdeel Uitgaand).
# Inspecteer verzoeken om een sessie te starten van achter de
# firewall op het private netwerk of vanaf deze gateway-server
# naar het publieke Internet.
#################################################################

# Geef toegang tot de DNS server van de ISP.
# xxx moet het IP adres van de DNS van de ISP zijn.
# Dupliceer deze regels als een ISP meerdere DNS servers heeft.
# Haal het IP adres evt. uit /etc/resolv.conf.
pass out quick on dc0 proto tcp from any to xxx port = 53 flags S keep state
pass out quick on dc0 proto udp from any to xxx port = 53 keep state

# Geef toegang tot de DHCP server van de ISP voor kabel- en
# xDSL-netwerken. Deze regel is niet nodig als gebruik gemaakt worden
# van PPP naar het publieke Internet. In dat geval kan de hele groep
# verwijderd worden. Gebruik de volgende regel en controleer het
# logboek voor het IP adres. Wijzig dan het IP adres in de regel
# commentaar hieronder en verwijder de eerste regel.
pass out log quick on dc0 proto udp from any to any port = 67 keep state
#pass out quick on dc0 proto udp from any to z.z.z.z port = 67 keep state

# Sta niet beveiligd www verkeer toe.
pass out quick on dc0 proto tcp from any to any port = 80 flags S keep state

# Sta beveiligd www verkeer over TLS SSL toe.
pass out quick on dc0 proto tcp from any to any port = 443 flags S keep state

# Sta het verzenden en ontvangen van e-mail toe.
pass out quick on dc0 proto tcp from any to any port = 110 flags S keep state
pass out quick on dc0 proto tcp from any to any port = 25 flags S keep state

# Sta Time toe.
pass out quick on dc0 proto tcp from any to any port = 37 flags S keep state

# Sta uitgaand NNTP nieuws toe.
pass out quick on dc0 proto tcp from any to any port = 119 flags S keep state

# Sta uitgaande lokale niet beveiligde FTP (ook van LAN-gebruikers) toe
# (zowel passieve als actieve modes).  Deze functie maakt gebruik van
# de in IP-NAT ingebouwde FTP-proxy die in het bestand met NAT-regels
# staat om dit in één regel te laten werken. Als er met
# pkg_add pakketten toegevoegd moeten kunnen worden op een systeem, dan
# is deze regel nodig.
pass out quick on dc0 proto tcp from any to any port = 21 flags S keep state

# Sta uitgaande SSH/SFTP/SCP toe (vervangingen van telnet/rlogin/FTP)
# Deze functie maakt gebruik van SSH (secure shell)
pass out quick on dc0 proto tcp from any to any port = 22 flags S keep state

# Sta uitgaande niet beveiligde telnet toe.
pass out quick on dc0 proto tcp from any to any port = 23 flags S keep state

# Sta de FreeBSD CVSUP-functie toe.
pass out quick on dc0 proto tcp from any to any port = 5999 flags S keep state

# Sta ping toe naar het publieke Internet.
pass out quick on dc0 proto icmp from any to any icmp-type 8 keep state

# Sta whois toe vanaf het LAN naar het publieke Internet.
pass out quick on dc0 proto tcp from any to any port = 43 flags S keep state

# Blokkeer en log het eerste voorkomen van al het andere dat probeert
# buiten te komen. Deze regel implementeert de standaard-blokkade.
block out log first quick on dc0 all

#################################################################
# Interface aan het publieke Internet (onderdeel Inkomend).
# Inspecteert pakketten die van het publieke Internet komen
# met als bestemming deze gateway-server of het private netwerk.
#################################################################

# Blokkeer al het verkeer voor niet-routeerbare of gereserveerde
# adresreeksen.
block in quick on dc0 from 192.168.0.0/16 to any    #RFC 1918 privaat IP
block in quick on dc0 from 172.16.0.0/12 to any     #RFC 1918 privaat IP
block in quick on dc0 from 10.0.0.0/8 to any        #RFC 1918 privaat IP
block in quick on dc0 from 127.0.0.0/8 to any       #loopback
block in quick on dc0 from 0.0.0.0/8 to any         #loopback
block in quick on dc0 from 169.254.0.0/16 to any    #DHCP auto-config
block in quick on dc0 from 192.0.2.0/24 to any      #gereserveerd voor documentatie
block in quick on dc0 from 204.152.64.0/23 to any   #Sun cluster interconnect
block in quick on dc0 from 224.0.0.0/3 to any       #Klasse D &amp; E multicast

##### Blokkeer wat vervelende dingen ############
# die niet in de logboeken moeten komen.

# Blokkeer fragmenten.
block in quick on dc0 all with frags

# Block korte TCP pakketten.
block in quick on dc0 proto tcp all with short

# Blokkeer source gerouteerde pakketten.
block in quick on dc0 all with opt lsrr
block in quick on dc0 all with opt ssrr

# Blokkeer pogingen voor nmap OS fingerprint.
# Blokkeer het eerste voorkomen ervan voor de IP-adressen
block in log first quick on dc0 proto tcp from any to any flags FUP

# Blokkeer alles met speciale opties.
block in quick on dc0 all with ipopts

# Blokkeer publieke pings.
block in quick on dc0 proto icmp all icmp-type 8

# Blokkeer ident.
block in quick on dc0 proto tcp from any to any port = 113

# Blokkeer alle Netbios diensten. 137=naam, 138=datagram, 139=sessie.
# Netbios is de Windows(R) bestandsdeeldienst.
# Blokkeer Windows(R) hosts2 name server verzoeken 81.
block in log first quick on dc0 proto tcp/udp from any to any port = 137
block in log first quick on dc0 proto tcp/udp from any to any port = 138
block in log first quick on dc0 proto tcp/udp from any to any port = 139
block in log first quick on dc0 proto tcp/udp from any to any port = 81

# Sta inkomend verkeer toe van de DHCP server van de ISP. Deze regel
# moet het IP adres van de DHCP server van de ISP bevatten omdat die
# de enige toegestane bron van dit type pakketten moet zijn. Alleen
# van belang voor kabel en xDSL instellingen. Deze regel is niet nodig
# voor PPP verbindingen naar het publieke Internet.  Dit is hetzelfde
# IP adres dat in het Uitgaande onderdeel is opgezocht.
pass in quick on dc0 proto udp from z.z.z.z to any port = 68 keep state

# Sta inkomend webverkeer toe omdat er een Apache server draait.
pass in quick on dc0 proto tcp from any to any port = 80 flags S keep state

# Sta niet beveiligde telnet sessie toe vanaf het publieke Internet.
# Dit heeft het label niet veilig omdat gebruikersnaam en
# wachtwoord als platte tekst over Internet gaan. Als er geen telnet
# server draait, hoeft deze regel niet actief te zijn.
#pass in quick on dc0 proto tcp from any to any port = 23 flags S keep state

# Sta beveiligde FTP, telnet en SCP toe vanaf Internet.
# Deze functie gebruikt SSH (secure shell).
pass in quick on dc0 proto tcp from any to any port = 22 flags S keep state

# Blokkeer en log het eerste voorkomen van al het andere dat probeert
# binnen te komen. Het loggen van alleen het eerste voorkomen stopt
# een ontzegging van dienst aanval die gericht is op het laten
# vollopen van de partitie waarop de logboeken staan. Deze regel implementeert
# de standaard blokkade.
block in log first quick on dc0 all
################### Einde van de regels ###################################</pre></div></div></div><div class=sect3><h4 id=_nat>30.5.14. NAT<a class=anchor href=#_nat></a></h4><div class=paragraph><p>NAT staat voor <em>Network Address Translation</em> (netwerkadres vertaling). In Linux® heet dit IP Masquerading. Een van de vele mogelijkheden die IPF NAT kan bieden is het delen van één IP adres op het publieke Internet met een LAN achter een firewall.</p></div><div class=paragraph><p>De vraag zou kunnen rijzen waarom iemand dat zou willen. ISP’s wijzen normaliter namelijk dynamisch een IP adres toe aan hun niet-commerciële gebruikers. Dynamisch betekent hier dat het IP-adres iedere dat er wordt ingebeld of dat het kabel- of xDSL-modem uit- en aangeschakeld wordt anders kan zijn. Dit dynamische IP-adres wordt gebruikt om uw systeem op het publieke Internet te identificeren.</p></div><div class=paragraph><p>Stel dat er vijf PC’s in een huis staan en iedere computer in dat huis heeft toegang tot Internet nodig. Dan zouden er bij een ISP vijf individuele accounts moeten zijn en vijf telefoonlijnen om dat te realiseren.</p></div><div class=paragraph><p>Met NAT is er maar één account bij een ISP nodig. De andere vier PC’s moeten met kabels op een switch worden aangesloten waarop ook een FreeBSD systeem is aangesloten dat binnen uw LAN als gateway gaat opereren. NAT zal automatisch de private LAN IP adressen van alle PC’s vertalen naar een enkel publiek IP-adres als de pakketten de firewall naar het Internet verlaten.</p></div><div class=paragraph><p>Er is een speciale reeks van IP-adressen gereserveerd voor NAT op private LANs. Volgens RFC 1918 kunnen de volgende reeksen IP-adressen gebruikt worden op private netwerken die nooit direct op het publieke Internet gerouteerd worden.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Eerste IP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Laatste IP</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.255.255.255</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>172.16.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>172.31.255.255</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.255.255</code></p></td></tr></tbody></table></div><div class=sect3><h4 id=_ipnat>30.5.15. IPNAT<a class=anchor href=#_ipnat></a></h4><div class=paragraph><p>NAT regels worden geladen met <code>ipnat</code>. De NAT regels worden vaak opgeslagen in <span class=filename>/etc/ipnat.rules</span>. Meer details staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=8&amp;format=html">ipnat(8)</a>.</p></div><div class=paragraph><p>Bij het maken van wijzigingen aan de NAT-regels nadat NAT gestart is, wordt aangeraden de wijziging aan het bestand met regels te maken en daarna <code>ipnat -CF</code> te gebruiken om alle actieve NAT-regels te wissen. Daarna kunnen de regels uit het bestand weer als volgt geladen worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -CF -f /etc/ipnat.rules</span></code></pre></div></div><div class=paragraph><p>Gebruiksgegevens over NAT kunnen getoond worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -s</span></code></pre></div></div><div class=paragraph><p>De huidige inhoud van de NAT tabellen kan getoond worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -l</span></code></pre></div></div><div class=paragraph><p>Met het volgende commando kan de uitgebreide rapportage worden ingeschakeld en dan wordt informatie over het verwerken van verkeer en de actieve regels getoond:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -v</span></code></pre></div></div></div><div class=sect3><h4 id=_ipnat_regels>30.5.16. IPNAT regels<a class=anchor href=#_ipnat_regels></a></h4><div class=paragraph><p>NAT regels zijn erg flexibel en er kunnen veel dingen mee gedaan worden om behoeften van bedrijven en thuisgebruikers in te vullen.</p></div><div class=paragraph><p>De syntaxis van de regels die hier wordt toegelicht is vereenvoudigd om te passen bij een niet-commerciële omgeving. De complete syntaxis is na te lezen in <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=5&amp;format=html">ipnat(5)</a>.</p></div><div class=paragraph><p>De syntaxis voor een NAT regel ziet er ongeveer als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>map IF LAN_IP_REEKS -&gt; PUBLIEK_ADRES</pre></div></div><div class=paragraph><p>De regel begint met het sleutelwoord <code>map</code>.</p></div><div class=paragraph><p><em>IF</em> dient vervangen te worden door de aanduiding van de externe interface.</p></div><div class=paragraph><p><em>LAN_IP_REEKS</em> is de reeks die clients op een LAN gebruiken, meestal iets van <code>192.168.1.0/24</code>.</p></div><div class=paragraph><p><em>PUBLIEK_ADRES</em> kan het publieke IP adres zijn of een speciaal sleutelwoord <code>0.32</code>, wat betekent dat het IP adres van <em>IF</em> gebruikt moet worden.</p></div></div><div class=sect3><h4 id=_hoe_nat_werkt>30.5.17. Hoe NAT werkt<a class=anchor href=#_hoe_nat_werkt></a></h4><div class=paragraph><p>Een pakket komt vanaf het LAN aan bij de firewall en heeft een publieke bestemming. Het wordt verwerkt door de filterregels voor inkomend verkeer en daarna krijgt NAT de kans zijn regels op het pakket toe te passen. De regels worden van boven naar beneden toegepast en de eerste regel die van toepassing is wint. NAT controleert voor alle regels het pakket op interfacenaam en bron IP adres. Als de interfacenaam van een pakket past bij een NAT regel dan wordt het bron IP adres van dat pakket gecontroleerd, dat is dus een IP adres op het private LAN, om te bekijken of het valt in de reeks die is opgegeven aan de linkerkant van een NAT regel. Als ook dat klopt, dan wordt het bron IP adres van het pakket vervangen ("rewritten") door een publiek IP adres dat verkregen kan zijn met het sleutelwoord <code>0.32</code>. NAT werkt dan zijn interne NAT tabel bij, zodat als er een pakket uit die sessie terugkomt van het publieke Internet, dat pakket weer gepast kan worden bij het originele private IP adres en door de firewallregels gefilterd kan worden om daarna, als dat mag, naar een client gestuurd te worden.</p></div></div><div class=sect3><h4 id=_ipnat_inschakelen>30.5.18. IPNAT inschakelen<a class=anchor href=#_ipnat_inschakelen></a></h4><div class=paragraph><p>Voor IPNAT zijn de onderstaande instellingen in <span class=filename>/etc/rc.conf</span> beschikbaar.</p></div><div class=paragraph><p>Om verkeer tussen interfaces te kunnen routeren:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Om IPNAT automatisch te starten:</p></div><div class="literalblock programlisting"><div class=content><pre>ipnat_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Om aan te geven waar de IPNAT regels staan:</p></div><div class="literalblock programlisting"><div class=content><pre>ipnat_rules=&#34;/etc/ipnat.rules&#34;</pre></div></div></div><div class=sect3><h4 id=_nat_voor_een_groot_lan>30.5.19. NAT voor een groot LAN<a class=anchor href=#_nat_voor_een_groot_lan></a></h4><div class=paragraph><p>Voor netwerken met grote aantallen PC’s of netwerken met meerdere LAN’s kan het een probleem worden om al die private IP adressen met één enkel publiek IP adres te vervangen, omdat vaak dezelfde poortnummers gebruikt worden. Er zijn twee manieren om dit probleem op te lossen.</p></div><div class=sect4><h5 id=_aangeven_welke_poorten_te_gebruiken>30.5.19.1. Aangeven welke poorten te gebruiken<a class=anchor href=#_aangeven_welke_poorten_te_gebruiken></a></h5><div class=paragraph><p>Een normale regel voor NAT ziet er als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0.32</pre></div></div><div class=paragraph><p>Met de bovenstaande regel blijft de bronpoort ongewijzigd als het pakket door IPNAT gaat. Door gebruik te maken van het sleutelwoord <code>portmap</code> kan IPNAT ingesteld worden om alleen bronpoorten in de aangegeven reeks te gebruiken. Zo stelt de onderstaande regel in dat IPNAT de bronpoort aanpast naar een poortnummer dat in de aangegeven reeks valt:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0.32 portmap tcp/udp 20000:60000</pre></div></div><div class=paragraph><p>Het kan nog eenvoudiger door gebruik te maken van het sleutelwoord <code>auto</code> zodat IPNAT zelf bepaalt welke poorten gebruikt kunnen worden:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0.32 portmap tcp/udp auto</pre></div></div></div><div class=sect4><h5 id=_meerdere_publieke_adressen_gebruiken>30.5.19.2. Meerdere publieke adressen gebruiken<a class=anchor href=#_meerdere_publieke_adressen_gebruiken></a></h5><div class=paragraph><p>In grote netwerken komt er een moment waarop er gewoon te veel adressen zijn om te bedienen met één IP adres. Als er een blok van publiekelijke IP adressen beschikbaar is, dan kunnen deze adressen gebruikt worden in een "poel", welke door IPNAT gebruikt kan worden om één van de adressen te gebruiken als uitgaand adres.</p></div><div class=paragraph><p>Bijvoorbeeld om alle pakketten te verstoppen achter één een enkel IP adres:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.1</pre></div></div><div class=paragraph><p>Een reeks van publiekelijke IP adressen kan gespecificeerd worden met een netwerkmasker:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.1-10</pre></div></div><div class=paragraph><p>of door gebruik van de CIDR notatie:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.0/24</pre></div></div></div></div><div class=sect3><h4 id=_poorten_omleiden>30.5.20. Poorten omleiden<a class=anchor href=#_poorten_omleiden></a></h4><div class=paragraph><p>Het is erg gebruikelijk om een webserver, mailserver, database server en DNS server op verschillende computers op een LAN te draaien. Het uitgaande verkeer van die servers kan dan met NAT afgehandeld worden, maar er moet ook ingesteld worden dat inkomend verkeer bij de juiste computer terecht komt. IPNAT gebruikt daarvoor de opties in NAT waarmee verkeer omgeleid kan worden. Als bijvoorbeeld een webserver op het LAN-adres <code>10.0.10.25</code> draait en het enkele publieke IP adres zou <code>20.20.20.5</code> zijn, dan zou de regel er als volgt uit zien:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 20.20.20.5/32 port 80 -&gt; 10.0.10.25 port 80</pre></div></div><div class=paragraph><p>of:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 0.0.0.0/32 port 80 -&gt; 10.0.10.25 port 80</pre></div></div><div class=paragraph><p>Voor een DNS server op een LAN die ook vanuit Internet bereikbaar met zijn en die draait op <code>10.0.10.33</code> zou de regel er als volgt uit zien:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 20.20.20.5/32 port 53 -&gt; 10.0.10.33 port 53 udp</pre></div></div></div><div class=sect3><h4 id=_ftp_en_nat>30.5.21. FTP en NAT<a class=anchor href=#_ftp_en_nat></a></h4><div class=paragraph><p>FTP is dinosaurus uit het tijdperk van voor Internet was zoals het nu is, toen onderzoeksinstellingen met elkaar verbonden waren via huurlijnen en FTP de aangewezen methode was om bestanden met elkaar uit te wisselen. Maar bij het gebruik van FTP worden gebruikersnaam en wachtwoord als platte tekst verzonden en het protocol is nooit aangepast. FTP is er in twee smaken: actief en passief. Het verschil zit 'm in hoe het datakanaal wordt opgezet. De passieve variant is veiliger voor een gebruiker omdat bij deze variant beide communicatiekanalen door de cliënt zelf worden opgezet. Op de volgende pagina zijn details over FTP na te lezen: <a href=http://www.slacksite.com/other/ftp.html>http://www.slacksite.com/other/ftp.html</a>.</p></div><div class=sect4><h5 id=_ipnat_regels_2>30.5.21.1. IPNAT-regels<a class=anchor href=#_ipnat_regels_2></a></h5><div class=paragraph><p>IPNAT heeft een speciale FTP-proxy ingebouwd die kan worden ingeschakeld met een NAT-<code>map</code>-regel. Die kan al het uitgaande verkeer monitoren wat betreft opstartverzoeken voor sessies voor actieve en passieve FTP en dynamisch tijdelijke filterregels maken die alleen het poortnummer dat echt in gebruik is voor het datakanaal doorlaten. Hiermee wordt een veiligheidsrisico dat normaal gepaard gaat met FTP, namelijk het toestaan van grote reeksen hoge poortnummers, weggenomen.</p></div><div class=paragraph><p>De volgende regel handelt al het FTP verkeer van het LAN af:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 10.0.10.0/29 -&gt; 0/32 proxy port 21 ftp/tcp</pre></div></div><div class=paragraph><p>De regel hieronder handelt het FTP verkeer van de gateway zelf af:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 0.0.0.0/0 -&gt; 0/32 proxy port 21 ftp/tcp</pre></div></div><div class=paragraph><p>Deze laatste regel handelt al het niet-FTP verkeer voor het LAN af:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 10.0.10.0/29 -&gt; 0/32</pre></div></div><div class=paragraph><p>De FTP-afbeeldregel hoort voor de normale regels te staan. Alle pakketten worden als eerste vergeleken met de eerste regel en zo verder. Eerst wordt gekeken over de interfacenaam overeenkomt, daarna het bron IP adres van het LAN en dan of het een FTP pakket is. Als dat allemaal klopt, dan maakt de speciale FTP proxy een tijdelijke filterregel die de pakketten uit de FTP sessie naar binnen en buiten doorlaat en ook NAT toepast op de FTP pakketten. Alle pakketten van het LAN die niet van het protocoltype FTP zijn en dus niet bij de eerste regel passen, worden tegen de derde regel gehouden die van toepassing is vanwege de interface en bron IP adres, zodat er dan NAT op toegepast wordt.</p></div></div><div class=sect4><h5 id=_ipnat_ftp_filterregels>30.5.21.2. IPNAT FTP filterregels<a class=anchor href=#_ipnat_ftp_filterregels></a></h5><div class=paragraph><p>Als de NAT-FTP-proxy wordt gebruikt is er maar één filterregel voor FTP nodig. Zonder de FTP-proxy zouden er drie regels nodig zijn:</p></div><div class="literalblock programlisting"><div class=content><pre># Sta LAN client toe te FTP-en naar Internet
# Actieve en passieve modes
pass out quick on rl0 proto tcp from any to any port = 21 flags S keep state

# Sta opzetten van het datakanaal voor passieve mode toe voor hoge poorten
pass out quick on rl0 proto tcp from any to any port &gt; 1024 flags S keep state

# Laat het datakanaal van de FTP server binnen voor actieve mode
pass in quick on rl0 proto tcp from any to any port = 20 flags S keep state</pre></div></div></div></div></div><div class=sect2><h3 id=firewalls-ipfw>30.6. IPFW<a class=anchor href=#firewalls-ipfw></a></h3><div class=paragraph><p>IPFIREWALL (IPFW) is een firewall die binnen FreeBSD wordt ontwikkeld en onderhouden door vrijwillige leden van de staf. Het maakt gebruik van verouderde staatloze regels en een verouderde techniek om te realiseren wat eenvoudige stateful logica zou kunnen heten.</p></div><div class=paragraph><p>De verzameling voorbeeldregels van IPFW (die in <span class=filename>/etc/rc.firewall</span> en <span class=filename>/etc/rc.firewall6</span> staan) uit de standaard FreeBSD-installatie is redelijk eenvoudig en niet voorbereid om zonder wijzigingen gebruikt te worden. Het voorbeeld maakt geen gebruik van stateful filteren, wat een voordeel is in de meeste situaties. Daarom worden deze regels niet als basis gebruikt in dit onderdeel.</p></div><div class=paragraph><p>De staatloze syntaxis van IPFW is krachtig door de technisch geavanceerde mogelijkheden van de regelsyntaxis die de kennis van de gemiddelde gebruiker van firewalls ver overstijgt. IPFW is gericht op de professionele gebruiker of de gevorderde thuisgebruiker die hoge eisen stelt aan de wijze waarop er met pakketten wordt omgegaan. Voordat de kracht van de IPFW regels echt ingezet kan worden, moet de gebruiker veel weten over de verschillende protocollen en de wijze waarop pakketten in elkaar zitten. Het tot op dat niveau behandelen van stof valt buiten de doelstellingen van dit Handboek.</p></div><div class=paragraph><p>IPFW bestaat uit zeven componenten: de verwerkingseenheid voor de firewallregels, verantwoording, loggen, regels met <code>divert</code> (omleiden) waarmee NAT gebruikt kan worden en de speciale gevorderde mogelijkheden voor bandbreedtebeheer met DUMMYNET, de <code>fwd rule</code> forward-mogelijkheid, de bridge-mogelijkheden en de ipstealth-mogelijkheden. IPFW ondersteunt zowel IPv4 als IPv6.</p></div><div class=sect3><h4 id=firewalls-ipfw-enable>30.6.1. IPFW inschakelen<a class=anchor href=#firewalls-ipfw-enable></a></h4><div class=paragraph><p>IPFW zit bij de basisinstallatie van FreeBSD als een losse tijdens runtime laadbare module. Het systeem laadt de kernelmodule dynamisch als in <span class=filename>rc.conf</span> de regel <code>firewall_enable="YES"</code> staat. IPFW hoeft niet in de FreeBSD kernel gecompileerd te worden.</p></div><div class=paragraph><p>Na het rebooten van een systeem met <code>firewall_enable="YES"</code> in <span class=filename>rc.conf</span> is het volgende bericht op het scherm te zien tijdens het booten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ipfw2 initialized, divert disabled, rule-based forwarding disabled, default to deny, logging disabled</code></pre></div></div><div class=paragraph><p>In de laadbare module zit de mogelijkheid om te loggen gecompileerd. Er is een knop in <span class=filename>/etc/sysctl.conf</span> om loggen aan te zetten en de uitgebreide loglimiet in te stellen. Door deze regels toe te voegen, staat loggen aan bij toekomstige herstarts:</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.verbose=1
net.inet.ip.fw.verbose_limit=5</pre></div></div></div><div class=sect3><h4 id=firewalls-ipfw-kernel>30.6.2. Kernelopties<a class=anchor href=#firewalls-ipfw-kernel></a></h4><div class=paragraph><p>Het is niet verplicht om IPFW in te schakelen door het mee te compileren in de FreeBSD kernel. Dit wordt alleen beschreven als achtergrondinformatie.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL</pre></div></div><div class=paragraph><p>Met <code>IPFIREWALL</code> wordt IPFW ingeschakeld als deel van de kernel.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_VERBOSE</pre></div></div><div class=paragraph><p>Met <code>IPFIREWALL_VERBOSE</code> wordt het loggen van pakketten die worden verwerkt met IPFW mogelijk die het sleutelwoord <code>log</code> in een regel hebben staan.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_VERBOSE_LIMIT=5</pre></div></div><div class=paragraph><p>Limiteert het aantal pakketten dat per regel wordt gelogd via <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a>. Deze optie kan gebruikt worden in vijandige omgevingen waar de activiteit van een firewall gelogd moet worden. Hierdoor kan een mogelijke ontzegging van dienst aanval door het vol laten lopen van syslog voorkomen worden.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_DEFAULT_TO_ACCEPT</pre></div></div><div class=paragraph><p>Met <code>IPFIREWALL_DEFAULT_TO_ACCEPT</code> wordt standaard alles door de firewall doorgelaten. Dit wordt aangeraden als iemand voor het eerst een firewall opzet.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPDIVERT</pre></div></div><div class=paragraph><p>Met <code>IPDIVERT</code> wordt de NAT functionaliteit ingeschakeld.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De firewall zal alle binnenkomende en uitgaande pakketten blokkeren als de kerneloptie <code>IPFIREWALL_DEFAULT_TO_ACCEPT</code> of een regel om deze verbindingen expliciet toe te staan ontbreekt.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=firewalls-ipfw-rc>30.6.3. <span class=filename>/etc/rc.conf</span> opties<a class=anchor href=#firewalls-ipfw-rc></a></h4><div class=paragraph><p>Start de firewall:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Om één van de standaard firewall types die geleverd wordt door FreeBSD te selecteren, lees <span class=filename>/etc/rc.firewall</span>, maak een selectie en plaats het in de volgende regel:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_type=&#34;open&#34;</pre></div></div><div class=paragraph><p>Beschikbare waardes voor deze instelling zijn:</p></div><div class=ulist><ul><li><p><code>open</code> - laat al het verkeer door.</p></li><li><p><code>client</code> - beschermt alleen deze machine.</p></li><li><p><code>simple</code> - beschermt het hele netwerk.</p></li><li><p><code>closed</code> - blokkeert alle IP-verkeer, behalve voor lokaal verkeer.</p></li><li><p><code>UNKNOWN</code> - voorkomt het laden de firewall-regels.</p></li><li><p><span class=filename>bestandsnaam</span> - absoluut pad naar een bestand dat firewall-regels bevat.</p></li></ul></div><div class=paragraph><p>Het is mogelijk om twee verschillende manieren te gebruiken voor speciaal gemaakte regels voor de ipfw firewall. één daarvan is door het zetten van de <code>firewall_type</code> variabele naar een absoluut pad van een bestand, welke <em>firewall-regels</em> bevat, zonder enige specifieke opties voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a>. Het volgende is een eenvoudig voorbeeld van een bestand met regelverzamelingen dat al het inkomend en uitgaand verkeer blokkeert:</p></div><div class="literalblock programlisting"><div class=content><pre>add deny in
add deny out</pre></div></div><div class=paragraph><p>Aan de andere kant is het mogelijk om de variabele <code>firewall_script</code> in te stellen op een absoluut pad van een uitvoerbaar script, welke inclusief <code>ipfw</code> commando’s uitgevoerd wordt tijdens het opstarten van het systeem. Een geldig script met regels dat gelijkwaardig is aan het bestand met regels hierboven, zou het volgende zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh

ipfw -q flush

ipfw add deny in
ipfw add deny out</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als <code>firewall_type</code> is gezet naar <code>client</code> of <code>simple</code> moeten de standaard regels die gevonden kunnen worden in <span class=filename>/etc/rc.firewall</span> gecontroleerd worden om te zien of deze configuratie voldoet voor de machine. Let ook op dat alle voorbeelden die gebruikt zijn in dit hoofdstuk ervan uitgaan dat de <code>firewall_script</code> variabele gezet is naar <span class=filename>/etc/ipfw.rules</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om loggen in te schakelen:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_logging=&#34;YES&#34;</pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Het enige dat de variabele <code>firewall_logging</code> doet is de sysctl variabele <code>net.inet.ip.fw.verbose</code> op de waarde <code>1</code> zetten (zie <a href=#firewalls-ipfw-enable>IPFW inschakelen</a>). Er is geen variabele in <span class=filename>rc.conf</span> om logboeklimieten in te stellen, maar dat kan ingesteld worden via een sysctl variabele, handmatig of via <span class=filename>/etc/sysctl.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.verbose_limit=5</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Als de machine in kwestie een gateway is, dus Network Address Translation (NAT) diensten levert via <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a>, dan staat in <a href=./#network-natd>Network Address Translation</a> meer informatie over de benodigde instellingen voor <span class=filename>/etc/rc.conf</span>.</p></div></div><div class=sect3><h4 id=firewalls-ipfw-cmd>30.6.4. Het commando <code>IPFW</code><a class=anchor href=#firewalls-ipfw-cmd></a></h4><div class=paragraph><p>Gewoonlijk wordt <code>ipfw</code> gebruikt om met de hand enkelvoudige regels toe te voegen of te verwijderen als IPFW actief is. Het probleem met deze methode is dat, als het systeem wordt uitgezet alle regels die gewijzigd of verwijderd zijn verloren gaan. Door alle regels in een bestand op te nemen dat bij het booten wordt geladen of door het bestand waarin de wijzigingen zijn gemaakt als een machine draait te laden bestaat die probleem niet.</p></div><div class=paragraph><p>Met <code>ipfw</code> kunnen de actieve regels van de firewall op het scherm getoond worden. De verantwoordingsmogelijkeden van <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> maken dynamisch tellers aan voor iedere regel en houden die bij voor alle pakketten die van toepassing zijn op die regel. Tijdens het testen van een regel is het afbeelden van de regel met zijn teller een van de manieren om te bepalen of de regel werkt.</p></div><div class=paragraph><p>Om alle regels in volgorde te tonen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw list</span></code></pre></div></div><div class=paragraph><p>Om alle regels te tonen met de tijd waarop deze voor het laatst van toepassing was:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -t list</span></code></pre></div></div><div class=paragraph><p>Het volgende commando kan gebruikt worden om de verantwoordingsinformatie, pakkettellers en de regel zelf te tonen. De eerste kolom is het regelnummer met daarachter het aantal keren dat de regel van toepassing was voor inkomend verkeer, gevolgd door het aantal keren dat de regel van toepassing was voor uitgaand verkeer. Als laatste wordt de regel zelf getoond:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -a list</span></code></pre></div></div><div class=paragraph><p>Ook kunnen onder de statische regels de dynamische regels getoond worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -d list</span></code></pre></div></div><div class=paragraph><p>En de dynamische regels die verlopen zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -d -e list</span></code></pre></div></div><div class=paragraph><p>De tellers op nul gesteld worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw zero</span></code></pre></div></div><div class=paragraph><p>Alleen de tellers voor regel met nummer <em>NUM</em> op nul stellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw zero NUM</span></code></pre></div></div></div><div class=sect3><h4 id=firewalls-ipfw-rules>30.6.5. Sets van IPFW regels<a class=anchor href=#firewalls-ipfw-rules></a></h4><div class=paragraph><p>Een verzameling regels is een groep IPFW-regels die is gemaakt om pakketten toe te staan of te blokkeren op basis van de inhoud van dat pakket. De bi-directionele uitwisseling van pakketten tussen hosts bestaat uit een gesprek dat een sessie heet. De verzameling van firewallregels beoordeelt zowel de pakketten die aankomen van de host op het publieke Internet als de pakketten die op het systeem ontstaan als antwoord daarop. Iedere TCP/IP-dienst als telnet, www, mail, etc, heeft zijn eigen protocol en bevoorrechte (luister)poort. Pakketten bestemd voor een specifieke poort verlaten het bronadres via een onbevoorrechte (hogere) poort en doelen op de specifieke dienstpoort op het bestemmingsadres. Alle bovenstaande parameters (poorten en adressen) kunnen gebruikt worden als selectiecriteria om regels aan te maken die diensten doorlaten of blokkeren.</p></div><div class=paragraph><p>Als een pakket de firewall binnenkomt wordt het vergeleken met de eerste regel in de set regels en zo gaat dat voor iedere regel vanaf boven tot beneden. Als een regel van toepassing is op een pakket, dan wordt het actieveld van de regel uitgevoerd. Dit wordt de "de eerst passende regel wint" zoekmethode genoemd. Als een pakket bij geen enkele regel past, dan wordt de verplichte standaardregel 65535 van IPFW toegepast, die alle pakketten weigert zonder een antwoord terug te sturen naar de verzender.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het zoeken gaat door na regels met <code>count</code>, <code>skipto</code> en <code>tee</code>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De instructies in dit onderdeel zijn gebaseerd op regels die gebruik maken van de stateful opties <code>keep state</code>, <code>limit</code>, <code>in</code>, <code>out</code> en <code>via</code>. Dit is het raamwerk waarmee een set van inclusieve firewallregels wordt samengesteld.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Wees voorzichtig tijdens het werken met firewall-regels, het is gemakkelijk om uzelf uit te sluiten.</p></div></td></tr></tbody></table></div><div class=sect4><h5 id=firewalls-ipfw-rules-syntax>30.6.5.1. Regelsyntaxis<a class=anchor href=#firewalls-ipfw-rules-syntax></a></h5><div class=paragraph><p>De regelsyntaxis zoals hier toegelicht is vereenvoudigd door alleen te tonen wat nodig is om een standaard inclusieve set met firewallregels te maken. De complete beschrijving van alle mogelijkheden staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a>.</p></div><div class=paragraph><p>Regels bevatten sleutelwoorden die in een bepaalde volgorde van links naar rechts op een regel horen te staan. Sleutelwoorden worden vet weergegeven. Sommige sleutelwoorden hebben subopties die zelf ook weer sleutelwoorden hebben die ook weer subopties kunnen hebben.</p></div><div class=paragraph><p>Het karakter <code>#</code> wordt gebruikt om het begin van een opmerking te markeren en kan zowel op een eigen regel als achter een firewallregel staan. Lege regels worden genegeerd.</p></div><div class=paragraph><p><em>CMD REGEL_NUMMER ACTIE LOGGEN SELECTIE STATEFUL</em></p></div><div class=sect5><h6 id=_cmd>30.6.5.1.1. CMD<a class=anchor href=#_cmd></a></h6><div class=paragraph><p>Iedere regel moet beginnen met <span class=parameter>add</span> om hem toe te voegen aan de tabel met regels.</p></div></div><div class=sect5><h6 id=_regel_nummer>30.6.5.1.2. REGEL_NUMMER<a class=anchor href=#_regel_nummer></a></h6><div class=paragraph><p>Elke regel is geassocieerd met een regel_nummer van 1 tot en met 65535.</p></div></div><div class=sect5><h6 id=_actie_2>30.6.5.1.3. ACTIE<a class=anchor href=#_actie_2></a></h6><div class=paragraph><p>Bij een regel kunnen één of meer acties horen die worden uitgevoerd als een regel geldt voor een pakket.</p></div><div class=paragraph><p><span class=parameter>allow | accept | pass | permit</span></p></div><div class=paragraph><p>Deze opties betekenen allemaal hetzelfde: als de regel geldt voor een pakket, laat dat pakket dan door en stop met het zoeken naar geldende regels.</p></div><div class=paragraph><p><span class=parameter>check-state</span></p></div><div class=paragraph><p>Vergelijkt het pakket met de tabel met dynamische regels. Als het erin staat, dan wordt de actie van de dynamisch door deze regel gemaakte regel uitgevoerd. Anders wordt er verder gezocht door de regels. Een regel met check-state heeft geen selectiecriteria. Als er geen regel met check-state in de set met regels staat, dan wordt de tabel met dynamische regels bij het eerste voorkomen van keep-state of limit gecontroleerd.</p></div><div class=paragraph><p><span class=parameter>deny | drop</span></p></div><div class=paragraph><p>Deze opties betekenen hetzelfde: als de regel geldt voor een pakket, blokkeer dat pakket dan en stop met het zoeken naar geldende regels.</p></div></div><div class=sect5><h6 id=_loggen>30.6.5.1.4. Loggen<a class=anchor href=#_loggen></a></h6><div class=paragraph><p><span class=parameter>log</span> of <span class=parameter>logamount</span></p></div><div class=paragraph><p>Als een regel met het sleutelwoord <code>log</code> van toepassing is op een pakket, dan wordt er een bericht naar <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> geschreven met de faciliteitsnaam SECURITY. Er wordt alleen een bericht geschreven als het aantal voor die regel gelogde pakketten niet groter is dan de instelling van de parameter logamount. Als er geen <code>logamount</code> is ingesteld, dan wordt de limiet uit de <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> variabele <code>net.inet.ip.fw.verbose_limit</code> gehaald. In beide gevallen bestaat er in het geval de waarde nul is geen limiet. Als de limiet is bereikt, dan kan het loggen weer ingeschakeld worden door de teller voor het loggen weer op nul te zetten voor die regel met <code>ipfw reset log</code>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er wordt gelogd als een pakket zeker past bij een regel, maar voordat de actie (bijvoorbeeld <span class=parameter>accept</span> of <code>deny</code>) op een pakket wordt toegepast. Uiteindelijk bepaalt de gebruiker zelf voor welke regels loggen wordt ingeschakeld.</p></div></td></tr></tbody></table></div></div><div class=sect5><h6 id=_selectie_2>30.6.5.1.5. Selectie<a class=anchor href=#_selectie_2></a></h6><div class=paragraph><p>De sleutelwoorden in deze paragraaf beschrijven de attributen van een pakket die gecontroleerd worden bij het bepalen of een regel wel of niet op een pakket van toepassing is. De attributen waarop gecontroleerd kan worden moeten in de beschreven volgorde gebruikt worden.</p></div><div class=paragraph><p><span class=parameter>udp | tcp | icmp</span></p></div><div class=paragraph><p>Naast de hierboven aangegeven protocollen kunnen alle in <span class=filename>/etc/protocols</span> beschreven protocollen gebruikt worden. De waarde die wordt opgegeven is het protocol dat van toepassing moet zijn. Dit attribuut is verpicht.</p></div><div class=paragraph><p><span class=parameter>from bron to best</span></p></div><div class=paragraph><p>De sleutelwoorden <code>from</code> en <code>to</code> worden gebruikt om te bekijken of een regel van toepassing is op IP-adressen. Een regel moet <em>zowel</em> bron- als bestemmingsadressen bevatten. <code>any</code> is een bijzonder sleutelwoord dat van toepassing is op alle IP-adressen. <code>me</code> is een bijzonder sleutelwoord dat van toepassing is op alle IP-adressen die ingesteld zijn op interfaces van een FreeBSD systeem om de PC waarop de firewall draait te vertegenwoordigen (deze machine). Zo kan dit onderdeel bijvoorbeeld de volgende vormen aannemen: <code>from me to any</code>, <code>from any to me</code>, <code>from 0.0.0.0/0 to any</code>, <code>from any to 0.0.0.0/0</code>, <code>from 0.0.0.0 to any</code>, <code>from any to 0.0.0.0</code> of <code>from me to 0.0.0.0</code>. IP-adressen mogen ingevoerd worden in de vorm numeriek, door punten gescheiden adres/maskerlengte (CIDR-notatie) of als een enkelvoudig IP-adres in de vorm numeriek, door punten gescheiden. De port <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/ipcalc/>net-mgmt/ipcalc</a> kan gebruikt worden om de berekeningen e vereenvoudigen. Aanvullende informatie is beschikbaar op de webpagina van het programma: <a href=http://jodies.de/ipcalc>http://jodies.de/ipcalc</a>.</p></div><div class=paragraph><p><span class=parameter>poortnummer</span></p></div><div class=paragraph><p>Wordt gebruikt voor protocollen die poortnummers ondersteunen (als TCP en UDP). Het gebruik van een poortnummer is verplicht. Er mogen ook dienstnamen uit <span class=filename>/etc/services</span> gebruikt worden in plaats van nummers.</p></div><div class=paragraph><p><span class=parameter>in | out</span></p></div><div class=paragraph><p>Is op respectievelijk inkomende of uitgaande pakketten van toepassing. De sleutelwoorden <code>in</code> of <code>out</code> zijn verplicht in een regel.</p></div><div class=paragraph><p><span class=parameter>via IF</span></p></div><div class=paragraph><p>Deze parameter geeft aan op welke interface de regel van toepassing is, waarbij <code>IF</code> de exacte naam van de bedoelde interface is.</p></div><div class=paragraph><p><span class=parameter>setup</span></p></div><div class=paragraph><p>Dit is een verplicht sleutelwoord waarmee wordt aangegeven dat er gezocht wordt naar een pakket met het verzoek tot het opstarten van een TCP sessie.</p></div><div class=paragraph><p><span class=parameter>keep-state</span></p></div><div class=paragraph><p>Dit is een verplicht sleutelwoord. Als er een pakket op een regel met <span class=parameter>keep-state</span> van toepassing is, dan wordt er door de firewall een dynamische regel gemaakt die bi-directioneel verkeer zal toestaan tussen bron en bestemming en de bijbehorende poorten voor hetzelfde protocol.</p></div><div class=paragraph><p><span class=parameter>limit {bron-adr | bron-poort | best-adr | best-poort}</span></p></div><div class=paragraph><p>De firewall staat maar <em>N</em> verbindingen toe met dezelfde groep parameters uit een regel. Er kunnen één of meer van de parameters bron- of bestemmingsadres en bron- en bestemmingspoort gebruikt worden. <span class=parameter>limit</span> en <span class=parameter>keep-state</span> kunnen niet in dezelfde regel gebruikt worden. De optie <span class=parameter>limit</span> geeft dezelfde mogelijkheden als <span class=parameter>keep-state</span> en voegt daar zijn eigen mogelijkheden aan toe.</p></div></div></div><div class=sect4><h5 id=_regeloptie_stateful>30.6.5.2. Regeloptie stateful<a class=anchor href=#_regeloptie_stateful></a></h5><div class=paragraph><p>Bij stateful filteren wordt verkeer bekeken als bi-directioneel verkeer dat samen een sessie vormt. Het heeft de mogelijkheid om te bepalen of de sessie tussen de zender en de ontvanger op de juiste wijze voortgaat. Alle pakketten die niet precies in de verwachting van een sessie passen worden automatisch als fout geblokkeerd.</p></div><div class=paragraph><p>De optie <code>check-state</code> wordt gebruikt om aan te geven waar IPFW-regels tegen de mogelijkheden voor dynamische regels gehouden moeten worden. Als er een passende regel bij een pakket wordt gevonden, dan kan dat pakket de firewall verlaten en wordt een nieuwe regel gemaakt voor het volgende pakket dat wordt verwacht in de sessie. Als er geen regel van toepassing is op het pakket, dan wordt de volgende regel in de groep regels getest.</p></div><div class=paragraph><p>De mogelijkheden voor dynamische regels zijn kwetsbaar voor een aanval die SYN-flood heet, waarmee wordt geprobeerd een zeer groot aantal regels aan te laten maken. Om deze aanval tegen te gaan, is de optie <code>limit</code> beschikbaar. Met deze optie kan het maximaal aantal simultane sessies geregeld worden op basis van bron en bestemmingsvelden. Als het aantal sessies gelijk aan het maximale aantal sessies is, wordt een pakket voor een nieuwe sessie geweigerd.</p></div></div><div class=sect4><h5 id=_firewallberichten_loggen>30.6.5.3. Firewallberichten loggen<a class=anchor href=#_firewallberichten_loggen></a></h5><div class=paragraph><p>De voordelen van loggen zijn duidelijk. Het biedt de mogelijkheid om na het feit informatie na te zien als: welke pakketten heeft de firewall laten vallen, waar kwamen ze vandaan en waar gingen ze heen. Dit zijn allemaal voordelen als het gaat om uitvinden waar een aanvaller vandaan komt en wat hij heeft geprobeerd.</p></div><div class=paragraph><p>Zelfs als logging is ingeschakeld logt IPFW nog niets uit zichzelf. De beheerder van de firewall beslist welke actieve regels iets weg moeten schrijven door het sleutelwoord <code>log</code> aan die regels toe te voegen. Gewoonlijk worden alleen <code>deny</code>-regels gelogd. Dit geldt bijvoorbeeld voor de <code>deny</code>-regel voor inkomende ICMP pings. Het is gebruikelijk om de standaardregel "ipfw default deny everything" te dupliceren, daar <code>log</code> in op te nemen, en deze als laatste in de verzameling met regels te plaatsen. Zo zijn alle pakketten te zien die niet voldeden aan ook maar één regel.</p></div><div class=paragraph><p>Loggen heeft ook mogelijke nadelen. Het is mogelijk om te veel te loggen en dan om te komen in logboekgegevens die uiteindelijk een schijf kunnen vullen. Een DoS aanval om een schijf met logs te vullen is een van de oudst bekende typen DoS aanvallen. Logberichten van de firewall worden niet alleen naar syslogd geschreven, maar ook op het <code>root</code> console getoond waar ze snel erg vervelend kunnen worden.</p></div><div class=paragraph><p>De kerneloptie <code>IPFIREWALL_VERBOSE_LIMIT=5</code> beperkt het aantal opeenvolgende berichten dat naar <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> wordt geschreven voor één specifieke regel. Als deze optie is ingeschakeld, worden in dit geval maximaal vijf berichten voor dezelfde regel gemeld. Als er meer berichten op dezelfde regel zouden zijn, zou dat als volgt aan syslogd gemeld worden:</p></div><div class="literalblock programlisting"><div class=content><pre>last message repeated 45 times</pre></div></div><div class=paragraph><p>Standaard worden alle gelogde pakketten weggeschreven naar <span class=filename>/var/log/security</span>, wat is ingesteld in <span class=filename>/etc/syslog.conf</span>.</p></div></div><div class=sect4><h5 id=firewalls-ipfw-rules-script>30.6.5.4. Regelscript bouwen<a class=anchor href=#firewalls-ipfw-rules-script></a></h5><div class=paragraph><p>De meeste ervaren gebruikers van IPFW maken een bestand waarin de regels staan en stellen dat zo op dat het als script uitgevoerd kan worden. Het grootste voordeel van deze methode is dat de firewallregels allemaal vervangen kunnen worden zonder dat het systeem opnieuw gestart moet worden. Deze methode is ook erg geschikt voor het testen van regels omdat de procedure zo vaak als nodig uitgevoerd kan worden. Omdat het een script is, kan er gebruik gemaakt worden van substitutie zodat veel gebruikte waarden verduidelijkt en in meerdere regels toegepast kunnen worden. In het volgende voorbeeld wordt hier gebruik van gemaakt.</p></div><div class=paragraph><p>De syntaxis die in het script wordt gebruikt is compatibel met de shells <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=tcsh&amp;sektion=1&amp;format=html">tcsh(1)</a>. Velden waarvoor substitutie van toepassing is worden vooraf gegaan door het dollarteken $. Definities worden niet vooraf gegaan door het voorvoegsel $. De waarden van een substitutie moet omsloten worden door "dubbele aanhalingstekens".</p></div><div class=paragraph><p>Een bestand met regels kan als volgt beginnen:</p></div><div class="literalblock programlisting"><div class=content><pre>############### begin voorbeeldscript ipfw regels ##############
#
ipfw -q -f flush       # Verwijder alle bestaande regels.
# Stel standaarden in.
oif=&#34;tun0&#34;             # uitgaande interface.
odns=&#34;192.0.2.11&#34;      # IP adres DNS server ISP.
cmd=&#34;ipfw -q add &#34;     # Voorvoegsel voor regel.
ks=&#34;keep-state&#34;        # Te lui om iedere keer in te typen.
$cmd 00500 check-state
$cmd 00502 deny all from any to any frag
$cmd 00501 deny tcp from any to any established
$cmd 00600 allow tcp from any to any 80 out via $oif setup $ks
$cmd 00610 allow tcp from any to $odns 53 out via $oif setup $ks
$cmd 00611 allow udp from any to $odns 53 out via $oif $ks
################### einde voorbeeldscript ipfw regels ###########</pre></div></div><div class=paragraph><p>Dat is alles. De feitelijke functie van de regels is in dit voorbeeld van ondergeschikt belang. Dit was slechts een voorbeeld om het gebruik van substitutie te illustreren.</p></div><div class=paragraph><p>Als het bovenstaande voorbeeld de inhoud van <span class=filename>/etc/ipfw.rules</span> was, dan kon het herladen worden met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sh /etc/ipfw.rules</span></code></pre></div></div><div class=paragraph><p><span class=filename>/etc/ipfw.rules</span> zou overal kunnen staan met iedere gewenste naam.</p></div><div class=paragraph><p>Wat in het bovenstaande voorbeeld met een bestand is gerealiseerd, kan ook met de hand:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -q -f flush</span>
<span class=c># ipfw -q add 00500 check-state</span>
<span class=c># ipfw -q add 00502 deny all from any to any frag</span>
<span class=c># ipfw -q add 00501 deny tcp from any to any established</span>
<span class=c># ipfw -q add 00600 allow tcp from any to any 80 out via tun0 setup keep-state</span>
<span class=c># ipfw -q add 00610 allow tcp from any to 192.0.2.11 53 out via tun0 setup keep-state</span>
<span class=c># ipfw -q add 00611 allow udp from any to 192.0.2.11 53 out via tun0 keep-state</span></code></pre></div></div></div><div class=sect4><h5 id=_verzameling_van_stateful_regels>30.6.5.5. Verzameling van stateful regels<a class=anchor href=#_verzameling_van_stateful_regels></a></h5><div class=paragraph><p>De volgende verzameling van regels, waarin geen gebruik gemaakt wordt van NAT, is een voorbeeld van hoe een erg veilige inclusieve firewall kan worden opgezet. Een inclusieve firewall laat alleen diensten toe waarvoor <code>pass</code> regels van toepassing zijn en blokkeert al het andere verkeer. Firewalls die ontworpen zijn om hele netwerksegmenten te beschermen hebben tenminste twee interfaces waarvoor regels moeten zijn die de firewall in staat stellen zijn werk te doen.</p></div><div class=paragraph><p>Alle UNIX® systemen en dus ook FreeBSD zijn zo ontworpen dat ze voor interne communicatie de interface <span class=filename>lo0</span> en IP adres <code>127.0.0.1</code> gebruiken. De firewall moet dit interne verkeer gewoon doorgang laten vinden.</p></div><div class=paragraph><p>Voor de interface die is verbonden met het publieke Internet worden regels gemaakt waarmee sessies naar het Internet mogelijk gemaakt worden en toegang wordt gegeven voor pakketten die uit die sessies terug komen. Dit kan de gebruikers-PPP-interface <span class=filename>tun0</span> zijn of de netwerkkaart die is verbonden met een xDSL of kabelmodem.</p></div><div class=paragraph><p>In gevallen dat er meer dan één netwerkkaart is aangesloten op het private netwerk achter de firewall, moeten er op de firewall-regels zijn om het verkeer tussen die interfaces vrije doorgang te geven.</p></div><div class=paragraph><p>De regels worden opgedeeld in drie onderdelen: alle interfaces met vrije doorgang, uitgaand op publieke interfaces en inkomend op publieke interfaces.</p></div><div class=paragraph><p>De volgorde van de regels in iedere sectie voor publieke interfaces moet zo zijn dat de regels die het meest gebruikt worden vóór de regels staan die minder vaak gebruikt worden. De laatste regel van een onderdeel geeft aan dat al het overige verkeer op die interface in die richting geblokkeerd en gelogd moet worden.</p></div><div class=paragraph><p>In het onderdeel Uitgaand van de volgende verzameling regels staan alleen regels met <code>allow</code> die parameters bevatten om individuele diensten beschikbaar te maken die publieke toegang tot Internet mogen hebben Al die regels moeten gebruik maken van de opties <code>proto</code>, <code>port</code>, <code>in/out</code>, <code>via</code> en <code>keep-state</code>. De regels met <code>proto tcp</code> maken ook gebruik van <code>setup</code> om te bekijken of het een pakket betreft voor het opzetten van een sessie om de stateful functionaliteit aan te sturen.</p></div><div class=paragraph><p>In het onderdeel Inkomend staan als eerste alle regels voor het blokkeren van ongewenste pakketten, om twee redenen. Als eerste kan het zo zijn dat kwaadaardige pakketten gedeeltelijk overeenkomen met legitiem verkeer. Deze regels moeten worden geblokkeerd in plaats van te worden binnengelaten, gebaseerd op hun gedeeltelijke overeenkomst met <code>allow</code>-regels. De tweede reden is dat nu ongewenste pakketten die vaak voorkomen en die bij voorkeur niet in de logboeken voorkomen niet meer van toepassing zijn op de laatste regel van het onderdeel waarin ze zouden worden gelogd. Met de laatste regel van dit onderdeel worden alle overige pakketten geblokkeerd en gelogd en ze kunnen bewijsmateriaal zijn in een zaak tegen iemand die heeft geprobeerd een systeem aan te vallen.</p></div><div class=paragraph><p>Iets waarop u ook moet letten is dat voor al het verkeer dat wordt geweigerd geen antwoord wordt gestuurd. Die pakketten verdwijnen gewoon. Zo weet een aanvaller niet of een pakket het doelsysteem wel heeft bereikt. Zo kan een aanvaller geen informatie verzamelen over een systeem: hoe minder informatie er over een systeem beschikbaar is, hoe veiliger het is. Als er pakketten gelogd worden met een onbekend poortnummer, dan is de functie van dat poortnummer na te zoeken in <span class=filename>/etc/services</span> of op <a href=http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers>http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers</a>. Op de volgende link worden poortnummers van Trojans beschreven: <a href=http://www.sans.org/security-resources/idfaq/oddports.php>http://www.sans.org/security-resources/idfaq/oddports.php</a>.</p></div></div><div class=sect4><h5 id=_voorbeeld_van_een_set_inclusieve_regels>30.6.5.6. Voorbeeld van een set inclusieve regels<a class=anchor href=#_voorbeeld_van_een_set_inclusieve_regels></a></h5><div class=paragraph><p>Het volgende voorbeeld is een complete inclusieve verzameling van regels die geen gebruik maakt van NAT. Deze verzameling van regels is veilig om deze regels op uw eigen systemen te gebruiken. Dit kan door commentaar te maken van een <code>pass</code>-regel voor een dienst die niet gewenst is. Logberichten die niet gewenst zijn, zijn uit te sluiten door een <code>deny</code>-regel toe te voegen aan het onderdeel Inkomend. Voor de onderstaande regels dient de interfacenaam <span class=filename>dc0</span> in iedere regel vervangen te worden door de interfacenaam van de netwerkkaart in het systeem die met het publieke Internet is verbonden. Voor gebruikers van PPP zou dat <span class=filename>tun0</span> zijn.</p></div><div class=paragraph><p>Er zit een merkbare structuur in het gebruik van deze regels:</p></div><div class=ulist><ul><li><p>Alle regels die een verzoek zijn voor het opzetten van een sessie gebruiken <code>keep-state</code>.</p></li><li><p>Alle diensten die vanaf Internet bereikbaar zijn gebruiken de optie <code>limit</code> om "flooding" te voorkomen.</p></li><li><p>Alle regels gebruiken <code>in</code> of <code>out</code> om de richting aan te geven.</p></li><li><p>Alle regels gebruiken <code>via <em>interfacenaam</em></code> om aan te geven op welke interface de regel van toepassing is.</p></li></ul></div><div class=paragraph><p>De volgende regels zouden in <span class=filename>/etc/ipfw.rules</span> kunnen staan:</p></div><div class="literalblock programlisting"><div class=content><pre>################ Begin bestand met IPFW regels ###############################
# Verwijder eerst de bestaande regels.
ipfw -q -f flush

# Stel commando voorvoegsel in.
cmd=&#34;ipfw -q add&#34;
pif=&#34;dc0&#34;     # Interfacenaam van NIC die verbinding
              # met het publieke Internet heeft.

#################################################################
# Geen beperkingen op de interface aan de LAN kant. Alleen nodig
# als er een LAN is. Wijzig xl0 naar de gebruikte interfacenaam.
#################################################################
#$cmd 00005 allow all from any to any via xl0

#################################################################
# Geen beperkingen op de loopback interface.
#################################################################
$cmd 00010 allow all from any to any via lo0

#################################################################
# Sta het pakket toe als het aan de tabel met dynamische regels
# was toegevoegd met een &#39;allow keep-state&#39; commando.
#################################################################
$cmd 00015 check-state

#################################################################
# Interface aan het publieke Internet (onderdeel Uitgaand).
# Inspecteer verzoeken om een sessie te starten van achter de
# firewall op het private netwerk of vanaf de server zelf naar
# het publieke Internet.
#################################################################

# Geef toegang tot de DNS server van de ISP.
# x.x.x.x moet het IP adres van de DNS van de ISP zijn.
# Dupliceer deze regels als een ISP meerdere DNS servers heeft.
# Haal het IP adres evt. uit /etc/resolv.conf
$cmd 00110 allow tcp from any to x.x.x.x 53 out via $pif setup keep-state
$cmd 00111 allow udp from any to x.x.x.x 53 out via $pif keep-state

# Geef toegang tot de DHCP server van de ISP voor kabel- en
# xDSL-netwerken. Deze regel is niet nodig als gebruik gemaakt worden
# van PPP naar het publieke Internet. In dat geval kan de hele groep
# verwijderd worden. Gebruik de volgende regel en controleer het
# logboek voor het IP adres. Wijzig dan het IP adres in de regel
# commentaar hieronder en verwijder de eerste regel.
$cmd 00120 allow log udp from any to any 67 out via $pif keep-state
#$cmd 00120 allow udp from any to x.x.x.x 67 out via $pif keep-state

# Sta niet beveiligd www verkeer toe.
$cmd 00200 allow tcp from any to any 80 out via $pif setup keep-state

# Sta beveiligd www verkeer over TLS SSL toe.
$cmd 00220 allow tcp from any to any 443 out via $pif setup keep-state

# Sta het verzenden en ontvangen van e-mail toe.
$cmd 00230 allow tcp from any to any 25 out via $pif setup keep-state
$cmd 00231 allow tcp from any to any 110 out via $pif setup keep-state

# Sta de FreeBSD CVSUP functie toe voor uid root.
$cmd 00240 allow tcp from me to any out via $pif setup keep-state uid root

# Sta ping toe.
$cmd 00250 allow icmp from any to any out via $pif keep-state

# Sta Time toe naar buiten.
$cmd 00260 allow tcp from any to any 37 out via $pif setup keep-state

# Sta NNTP nieuws toe naar buiten.
$cmd 00270 allow tcp from any to any 119 out via $pif setup keep-state

# Sta beveiligde FTP, Telnet en SCP toe naar buiten.
# Deze functie maakt gebruik van SSH (secure shell).
$cmd 00280 allow tcp from any to any 22 out via $pif setup keep-state

# Sta whois toe naar buiten.
$cmd 00290 allow tcp from any to any 43 out via $pif setup keep-state

# Blokkeer en log al het andere dat probeert buiten te komen.
# Deze regel dwingt de &#39;block all&#39; logica af.
$cmd 00299 deny log all from any to any out via $pif

#################################################################
# Interface aan het publieke Internet (onderdeel Inkomend).
# Inspecteert pakketten die van het publieke Internet komen
# met als bestemming de host zelf of het private netwerk.
#################################################################

# Blokkeer al het verkeer voor niet-routeerbare of gereserveerde
# adresreeksen.
$cmd 00300 deny all from 192.168.0.0/16 to any in via $pif   #RFC 1918 privaat IP
$cmd 00301 deny all from 172.16.0.0/12 to any in via $pif     #RFC 1918 privaat IP
$cmd 00302 deny all from 10.0.0.0/8 to any in via $pif        #RFC 1918 privaat IP
$cmd 00303 deny all from 127.0.0.0/8 to any in via $pif       #loopback
$cmd 00304 deny all from 0.0.0.0/8 to any in via $pif         #loopback
$cmd 00305 deny all from 169.254.0.0/16 to any in via $pif    #DHCP auto-config
$cmd 00306 deny all from 192.0.2.0/24 to any in via $pif      #gereserveerd voor documentatie
$cmd 00307 deny all from 204.152.64.0/23 to any in via $pif   #Sun cluster interconnect
$cmd 00308 deny all from 224.0.0.0/3 to any in via $pif       #Klasse D &amp; E multicast

# Blokkeer publieke pings.
$cmd 00310 deny icmp from any to any in via $pif

# Blokkeer ident.
$cmd 00315 deny tcp from any to any 113 in via $pif

# Blokkeer alle Netbios diensten. 137=naam, 138=datagram, 139=sessie.
# Netbios is de Windows(R) bestandsdeeldienst.
# Blokkeer Windows hosts2 name server verzoeken 81.
$cmd 00320 deny tcp from any to any 137 in via $pif
$cmd 00321 deny tcp from any to any 138 in via $pif
$cmd 00322 deny tcp from any to any 139 in via $pif
$cmd 00323 deny tcp from any to any 81 in via $pif

# Blokkeer gefragmenteerde pakketten.
$cmd 00330 deny all from any to any frag in via $pif

# Blokkeer ACK pakketten die niet in de tabel met dynamische regels
# staan.
$cmd 00332 deny tcp from any to any established in via $pif

# Geef toegang tot de DHCP server van de ISP voor kabel- en
# xDSL-netwerken. Deze regel is niet nodig als gebruik gemaakt worden
# van PPP naar het publieke Internet. In dat geval kan de hele groep
# verwijderd worden. Hier wordt hetzelfde IP adres gebruikt als in de
# sectie voor Uitgaand verkeer.
#$cmd 00360 allow udp from any to x.x.x.x 67 in via $pif keep-state

# Sta inkomend webverkeer toe omdat er een Apache server draait.
$cmd 00400 allow tcp from any to me 80 in via $pif setup limit src-addr 2

# Sta beveiligde FTP, telnet en SCP toe vanaf Internet.
$cmd 00410 allow tcp from any to me 22 in via $pif setup limit src-addr 2

# Sta niet beveiligde telnet sessie toe vanaf het publieke Internet.
# Dit heeft het label ``niet veilig&#39;&#39; omdat gebruikersnaam en
# wachtwoord als platte tekst over Internet gaan. Als er geen telnet
# server draait, hoeft deze regel niet actief te zijn.
$cmd 00420 allow tcp from any to me 23 in via $pif setup limit src-addr 2

# Weiger en log alle niet toegestane inkomende verbindingen van buiten.
$cmd 00499 deny log all from any to any in via $pif

# Al het andere verkeer wordt standaard geblokkeerd. Weiger en log alle
# pakketten die tot hier zijn gekomen om te bekijken welke het waren.
$cmd 00999 deny log all from any to any
################ Einde bestand met IPFW regels ########################</pre></div></div></div><div class=sect4><h5 id=_voorbeeld_nat_en_stateful_regels>30.6.5.7. Voorbeeld NAT en stateful regels<a class=anchor href=#_voorbeeld_nat_en_stateful_regels></a></h5><div class=paragraph><p>Om NAT met IPFW te gebruiken moeten een extra aantal instellingen gemaakt worden. In het instellingenbestand voor de kernel moet <code>option IPDIVERT</code> toegevoegd worden aan de andere opties van IPFIREWALL.</p></div><div class=paragraph><p>Naast de normale IPFW opties in <span class=filename>/etc/rc.conf</span> zijn de volgende nodig:</p></div><div class="literalblock programlisting"><div class=content><pre>natd_enable=&#34;YES&#34;                   # Schakel NATD in
natd_interface=&#34;rl0&#34;                # interfacenaam voor de publieke Internet NIC
natd_flags=&#34;-dynamic -m&#34;            # -m = behoud poortnummers als mogelijk</pre></div></div><div class=paragraph><p>Stateful regels samen met de regel <code>divert natd</code> (Network Address Translation) gebruiken maakt het schrijven van regels veel gecompliceerder. De plaats van de regels met <code>check-state</code> en <code>divert natd</code> zijn van kritiek belang. De logica bestaat niet langer uit het eenvoudigweg van boven naar beneden doorwerken van de regels. Er wordt dan ook een nieuw type actie gebruik: <code>skipto</code>. Bij het gebruik van <code>skipto</code> is het verplicht iedere regel te nummeren zodat duidelijk is waar een <code>skipto</code> precies heen springt.</p></div><div class=paragraph><p>Hieronder staat een groep regels zonder commentaar waarin een manier om pakketten door de groep regels te leiden wordt aangegeven.</p></div><div class=paragraph><p>De verwerking begint met de eerste regel en er wordt steeds een volgende regel gecontroleerd tot het einde wordt bereikt of totdat een regel op het gecontroleerde pakket van toepassing is, en het pakket uit de firewall wordt vrijgelaten. In het voorbeeld zijn de regels 100, 101, 450, 500, en 510 van belang. Die regels regelen de vertaling van inkomende en uitgaande pakketten zodat er in de tabel met de dynamische <code>keep-state</code>-regels altijd het private IP-adres staat. Daarnaast is het van belang op te merken dat er in alle <code>allow</code>- en <code>deny</code>-regels de richting van het pakket wordt gecontroleerd (inkomend of uitgaand) en over welke interface het pakket gaat. Merk ook op dat alle uitgaande verzoeken voor het starten van een sessie met een <code>skipto</code> naar regel 500 gaan voor NAT.</p></div><div class=paragraph><p>Stel dat een gebruiker zijn webbrowser gebruikt om een webpagina op te halen. Webpagina’s worden over poort 80 verzonden. Er komt een pakket de firewall binnen dat niet past bij regel 100 omdat het naar buiten gaat en niet naar binnen. Het komt voorbij regel 101 omdat dit het eerste pakket is en er dus nog niets over in de dynamische keep-state tabel staat. Als het pakket bij 125 aankomt blijkt het te passen bij die regel. Het gaat naar buiten door de interface aan het publieke Internet. Het pakket heeft dan nog steeds het bron-IP-adres van het private LAN. Als blijkt dat deze regel geldt, dan gebeuren er twee dingen: door <code>keep-state</code> wordt er een regel in de dynamische keep-state tabel gezet en wordt de aangegeven actie uitgevoerd. De actie is onderdeel van de informatie uit de dynamische tabel. In dit geval is het <code>skipto rule 500</code>. In regel 500 wordt NAT op het IP-adres van het pakket toegepast en dan kan het weg. Dit is van groot belang. Dit pakket komt aan op zijn bestemming en als er een pakket als antwoord terug komt, dan begint de verwerking van het antwoordpakket weer van voor af aan. Nu voldoet het aan regel 100 en dus wordt het bestemmingsadres vertaald naar het bijbehorende IP-adres op het LAN. Daarna past het bij de <code>check-state</code>-regel en wordt een vermelding in de tabel gevonden wat betekent dat er een bestaande sessie is en wordt het doorgelaten naar het LAN. Het gaat dan naar de PC op het LAN die als eerste een pakket heeft verzonden en die verstuurt een nieuw pakket met de vraag om een volgend segment met gegevens naar de server. Nu blijkt bij controle van de <code>check-state</code>-regel dat die op het pakket van toepassing moet zijn en er staat een vermelding in de tabel voor uitgaand verkeer. Daarom wordt de bijbehorende actie <code>skipto rule 500</code> uitgevoerd. Het pakket springt naar regel 500, er wordt NAT op toegepast en het kan zijn weg vervolgen.</p></div><div class=paragraph><p>Wat betreft binnenkomende pakketten wordt alles dat onderdeel is van een bestaande sessie automatisch afgehandeld door de <code>check-state</code>-regel en de correct geplaatste <code>divert natd</code>-regels. Nu hoeven alleen de foute pakketten nog geweigerd te worden en moeten de inkomende geauthoriseerde diensten doorgelaten worden. In dit geval draait er een Apache server op de firewall-machine die vanaf Internet bereikbaar moet zijn. Het nieuwe inkomende pakket past bij regel 100 en het IP-adres wordt aangepast aan het interne IP-adres van de firewall-machine. Dat pakket wordt dan gecontroleerd op alle ongewenste eigenschappen en komt uiteindelijk aan bij regel 425 die van toepassing blijkt te zijn. In dat geval kunnen er twee dingen gebeuren: de pakketregel wordt in de dynamische keep-state tabel gezet, maar nu wordt het aantal nieuwe sessies dat van het bron IP-adres komt gelimiteerd tot twee. Dit is een bescherming tegen DoS-aanvallen op de dienst die op dat poortnummer wordt aangeboden. De actie is <code>allow</code>, dus het pakket wordt tot het LAN toegelaten. Voor het pakket dat als antwoord wordt verstuurd herkent de <code>check-state</code> regel dat het pakket bij een bestaande sessie hoort. Het stuurt het naar regel 500 voor NAT en stuurt het via de uitgaande interface weg.</p></div><div class=paragraph><p>Voorbeeld Set Regels #1:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
cmd=&#34;ipfw -q add&#34;
skip=&#34;skipto 500&#34;
pif=rl0
ks=&#34;keep-state&#34;
good_tcpo=&#34;22,25,37,43,53,80,443,110,119&#34;

ipfw -q -f flush

$cmd 002 allow all from any to any via xl0  # exclude LAN traffic
$cmd 003 allow all from any to any via lo0  # exclude loopback traffic

$cmd 100 divert natd ip from any to any in via $pif
$cmd 101 check-state

# Toegestaan uitgaand verkeer.
$cmd 120 $skip udp from any to xx.168.240.2 53 out via $pif $ks
$cmd 121 $skip udp from any to xx.168.240.5 53 out via $pif $ks
$cmd 125 $skip tcp from any to any $good_tcpo out via $pif setup $ks
$cmd 130 $skip icmp from any to any out via $pif $ks
$cmd 135 $skip udp from any to any 123 out via $pif $ks

# Blokkeer al het verkeer voor niet-routeerbare of gereserveerde
# adresreeksen.
$cmd 300 deny all from 192.168.0.0/16  to any in via $pif  #RFC 1918 privaat IP
$cmd 301 deny all from 172.16.0.0/12   to any in via $pif  #RFC 1918 privaat IP
$cmd 302 deny all from 10.0.0.0/8      to any in via $pif  #RFC 1918 privaat IP
$cmd 303 deny all from 127.0.0.0/8     to any in via $pif  #loopback
$cmd 304 deny all from 0.0.0.0/8       to any in via $pif  #loopback
$cmd 305 deny all from 169.254.0.0/16  to any in via $pif  #DHCP auto-config
$cmd 306 deny all from 192.0.2.0/24    to any in via $pif  #gereserveerd voor documentatie
$cmd 307 deny all from 204.152.64.0/23 to any in via $pif  #Sun cluster
$cmd 308 deny all from 224.0.0.0/3     to any in via $pif  #Klasse D &amp; E multicast

# Toegestaan inkomend verkeer.
$cmd 400 allow udp from xx.70.207.54 to any 68 in $ks
$cmd 420 allow tcp from any to me 80 in via $pif setup limit src-addr 1

$cmd 450 deny log ip from any to any

# Dit is de &#39;skipto&#39; locatie voor de uitgaande stateful regels.
$cmd 500 divert natd ip from any to any out via $pif
$cmd 510 allow ip from any to any

######################## Einde regels  ##################</pre></div></div><div class=paragraph><p>Het volgende voorbeeld doet vrijwel hetzelfde als het bovenstaande, maar volgt een zelfdocumenterende stijl voor het opstellen van regels en commentaar waardoor minder ervaren gebruikers beter kunnen begrijpen wat de regels doen.</p></div><div class=paragraph><p>Voorbeeld Set Regels #2:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
################ Begin bestand met IPFW regels ###############################
# Verwijder eerst de bestaande regels.
ipfw -q -f flush

# Stel commando voorvoegsel in.
cmd=&#34;ipfw -q add&#34;
skip=&#34;skipto 800&#34;
pif=&#34;rl0&#34;     # Interfacenaam van NIC die verbinding
              # met het publieke Internet heeft.

#################################################################
# Geen beperkingen op de interface aan de LAN kant.
# Wijzig xl0 naar de gebruikte interfacenaam.
#################################################################
$cmd 005 allow all from any to any via xl0

#################################################################
# Geen beperkingen op de loopback interface.
#################################################################
$cmd 010 allow all from any to any via lo0

#################################################################
# Controleer of pakket inkomend is. NAT in dat geval.
#################################################################
$cmd 014 divert natd ip from any to any in via $pif

#################################################################
# Sta het pakket toe als het aan de tabel met dynamische regels
# was toegevoegd met een &#39;allow keep-state&#39; commando.
#################################################################
$cmd 015 check-state

#################################################################
# Interface aan het publieke Internet (onderdeel Uitgaand).
# Inspecteer verzoeken om een sessie te starten van achter de
# firewall op het private netwerk of vanaf de server zelf naar
# het publieke Internet.
#################################################################

# Geef toegang tot de DNS server van de ISP.
# x.x.x.x moet het IP adres van de DNS van de ISP zijn.
# Dupliceer deze regels als een ISP meerdere DNS servers heeft.
# Haal het IP adres evt. uit /etc/resolv.conf
$cmd 020 $skip tcp from any to x.x.x.x 53 out via $pif setup keep-state

# Geef toegang tot de DHCP server van de ISP voor kabel en xDSL.
$cmd 030 $skip udp from any to x.x.x.x 67 out via $pif keep-state

# Sta niet beveiligd www verkeer toe.
$cmd 040 $skip tcp from any to any 80 out via $pif setup keep-state

# Sta beveiligd www verkeer over TLS SSL toe.
$cmd 050 $skip tcp from any to any 443 out via $pif setup keep-state

# Sta het verzenden en ontvangen van e-mail toe.
$cmd 060 $skip tcp from any to any 25 out via $pif setup keep-state
$cmd 061 $skip tcp from any to any 110 out via $pif setup keep-state

# Sta de FreeBSD CVSUP functie toe voor uid root.
$cmd 070 $skip tcp from me to any out via $pif setup keep-state uid root

# Sta ping toe naar het publieke Internet.
$cmd 080 $skip icmp from any to any out via $pif keep-state

# Sta Time toe.
$cmd 090 $skip tcp from any to any 37 out via $pif setup keep-state

# Sta NNTP nieuws toe.
$cmd 100 $skip tcp from any to any 119 out via $pif setup keep-state

# Sta beveiligde FTP, Telnet en SCP toe.
# Deze functie maakt gebruik van SSH (secure shell).
$cmd 110 $skip tcp from any to any 22 out via $pif setup keep-state

# Sta whois toe.
$cmd 120 $skip tcp from any to any 43 out via $pif setup keep-state

# Sta NPT tijdserver toe.
$cmd 130 $skip udp from any to any 123 out via $pif keep-state

#################################################################
# Interface aan het publieke Internet (onderdeel Inkomend).
# Inspecteert pakketten die van het publieke Internet komen met
# als bestemming deze gateway-server zelf of het private netwerk.
#################################################################

# Blokkeer al het verkeer voor niet-routeerbare of gereserveerde
# adresreeksen.
$cmd 300 deny all from 192.168.0.0/16  to any in via $pif  #RFC 1918 privaat IP
$cmd 301 deny all from 172.16.0.0/12   to any in via $pif  #RFC 1918 privaat IP
$cmd 302 deny all from 10.0.0.0/8      to any in via $pif  #RFC 1918 privaat IP
$cmd 303 deny all from 127.0.0.0/8     to any in via $pif  #loopback
$cmd 304 deny all from 0.0.0.0/8       to any in via $pif  #loopback
$cmd 305 deny all from 169.254.0.0/16  to any in via $pif  #DHCP auto-config
$cmd 306 deny all from 192.0.2.0/24    to any in via $pif  #gereserveerd voor documentatie
$cmd 307 deny all from 204.152.64.0/23 to any in via $pif  #Sun cluster
$cmd 308 deny all from 224.0.0.0/3     to any in via $pif  #Klasse D &amp; E multicast

# Blokkeer ident.
$cmd 315 deny tcp from any to any 113 in via $pif

# Blokkeer alle Netbios diensten. 137=naam, 138=datagram, 139=sessie.
# Netbios is de Windows® bestandsdeeldienst.
# Blokkeer Windows hosts2 name server verzoeken 81.
$cmd 320 deny tcp from any to any 137 in via $pif
$cmd 321 deny tcp from any to any 138 in via $pif
$cmd 322 deny tcp from any to any 139 in via $pif
$cmd 323 deny tcp from any to any 81  in via $pif

# Blokkeer gefragmenteerde pakketten.
$cmd 330 deny all from any to any frag in via $pif

# Blokkeer ACK pakketten die niet in de tabel met dynamische regels
# staan.
$cmd 332 deny tcp from any to any established in via $pif

# Geef toegang tot de DHCP server van de ISP voor kabel- en
# xDSL-netwerken. Deze regel is niet nodig als gebruik gemaakt worden
# van PPP naar het publieke Internet. In dat geval kan de hele groep
# verwijderd worden. Hier wordt hetzelfde IP adres gebruikt als in de
# sectie voor Uitgaand verkeer.
$cmd 360 allow udp from x.x.x.x to any 68 in via $pif keep-state

# Sta inkomend webverkeer toe omdat er een Apache server draait.
$cmd 370 allow tcp from any to me 80 in via $pif setup limit src-addr 2

# Sta beveiligde FTP, telnet en SCP toe vanaf Internet.
$cmd 380 allow tcp from any to me 22 in via $pif setup limit src-addr 2

# Sta niet beveiligde telnet sessie toe vanaf het publieke Internet.
# Dit heeft het label ``niet veilig&#39;&#39; omdat gebruikersnaam en
# wachtwoord als platte tekst over Internet gaan. Als er geen telnet
# server draait, hoeft deze regel niet actief te zijn.
#$cmd 390 allow tcp from any to me 23 in via $pif setup limit src-addr 2

# Weiger en log alle niet toegestane inkomende verbindingen vanaf het
# publieke Internet.
$cmd 400 deny log all from any to any in via $pif

# Weiger en log alle niet toegestane uitgaande verbindingen naar
# Internet.
$cmd 450 deny log all from any to any out via $pif

# Dit is de &#39;skipto&#39; locatie voor de uitgaande stateful regels
$cmd 800 divert natd ip from any to any out via $pif
$cmd 801 allow ip from any to any

# Al het andere verkeer wordt standaard geblokkeerd. Weiger en log alle
# pakketten die tot hier zijn gekomen om te bekijken welke het waren.
$cmd 999 deny log all from any to any
################ Einde bestand met IPFW regels ########################</pre></div></div></div></div></div></div></div><div class=sect1><h2 id=advanced-networking>Hoofdstuk 31. Geavanceerde netwerken<a class=anchor href=#advanced-networking></a></h2><div class=sectionbody><div class=sect2><h3 id=advanced-networking-synopsis>31.1. Samenvatting<a class=anchor href=#advanced-networking-synopsis></a></h3><div class=paragraph><p>Dit hoofdstuk zal een aantal onderwerpen over geavanceerde netwerken behandelen.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk is bekend:</p></div><div class=ulist><ul><li><p>De beginselen van gateways en routes.</p></li><li><p>Hoe IEEE® 802.11- en Bluetooth®-apparaten te installeren.</p></li><li><p>Hoe FreeBSD als een bridge te laten werken.</p></li><li><p>Hoe een schijfloze machine vanaf het netwerk op te starten.</p></li><li><p>Hoe opstarten met netwerk-PXE en een NFS-root-bestandssysteem te installeren.</p></li><li><p>Hoe Network Address Translation te installeren.</p></li><li><p>Hoe IPv6 op een FreeBSD-machine te installeren.</p></li><li><p>Hoe ATM in te stellen.</p></li><li><p>Hoe de mogelijkheden van CARP, het Common Address Redundancy Protocol, aan te zetten en te benutten.</p></li></ul></div><div class=paragraph><p>Voordat dit hoofdstuk gelezen wordt, dient de lezer:</p></div><div class=ulist><ul><li><p>De beginselen van de scripts in <span class=filename>/etc/rc</span> te begrijpen.</p></li><li><p>Bekend te zijn met basisnetwerktermen.</p></li><li><p>Te weten hoe een nieuwe FreeBSD-kernel in te stellen en te installeren (<a href=./#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li><li><p>Te weten hoe aanvullende software van derde partijen te installeren (<a href=./#ports>Applicaties installeren. pakketten en ports</a>).</p></li></ul></div></div><div class=sect2><h3 id=network-routing>31.2. Gateways en routes<a class=anchor href=#network-routing></a></h3><div class=paragraph><p>Indien een machine een andere machine over een netwerk wil vinden, dient er een mechanisme te zijn dat beschrijft hoe van de ene naar de andere machine te gaan. Dit wordt <em>routen</em> genoemd. Een "route" is een gedefinieerd adressenpaar: een "bestemming" en een "gateway". Het paar geeft aan dat door deze <em>gateway</em> gecommuniceerd moet worden om bij deze <em>bestemming</em> aan te komen. Er zijn drie soorten bestemmingen: individuele host, subnetten en "standaard". De "standaardroute" wordt gebruikt indien geen van de andere routes van toepassing zijn. Verderop wordt verder op standaardroutes ingegaan. Er zijn ook drie soorten gateways: individuele hosts, interfaces (ook wel "verbindingen " genoemd), en Ethernet-hardware-adressen (MAC-adressen).</p></div><div class=sect3><h4 id=_een_voorbeeld>31.2.1. Een voorbeeld<a class=anchor href=#_een_voorbeeld></a></h4><div class=paragraph><p>Om de verschillende aspecten van routen te illustreren, wordt het volgende voorbeeld van <code>netstat</code> gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% netstat <span class=nt>-r</span>
Routing tables

Destination      Gateway            Flags     Refs     Use     Netif Expire

default          outside-gw         UGSc       37      418      ppp0
localhost        localhost          UH          0      181       lo0
test0            0:e0:b5:36:cf:4f   UHLW        5    63288       ed0     77
10.20.30.255     <span class=nb>link</span><span class=c>#1             UHLW        1     2421</span>
example.com      <span class=nb>link</span><span class=c>#1             UC          0        0</span>
host1            0:e0:a8:37:8:1e    UHLW        3     4601       lo0
host2            0:e0:a8:37:8:1e    UHLW        0        5       lo0 <span class=o>=&gt;</span>
host2.example.com <span class=nb>link</span><span class=c>#1             UC          0        0</span>
224              <span class=nb>link</span><span class=c>#1             UC          0        0</span></code></pre></div></div><div class=paragraph><p>De eerste twee regels geven de standaardroute (die behandeld wordt in de <a href=#network-routing-default>volgende sectie</a>) en de <code>localhost</code>-route aan.</p></div><div class=paragraph><p>De interface (kolom <code>Netif</code>) dat deze routeertabel aangeeft om voor <code>localhost</code> te gebruiken is <span class=filename>lo0</span>, ook bekend als het teruglusapparaat. Dit geeft aan dat alle verkeer voor deze bestemming intern gehouden moet worden, in plaats van het over het LAN te sturen, aangezien het alleen aankomt op de plaats waar het verzonden werd.</p></div><div class=paragraph><p>Het volgende dat opvalt zijn de adressen die beginnen met <code>0:e0:</code>. Dit zijn Ethernet-hardware adressen, ook bekend als MAC-adressen. FreeBSD zal automatisch elke host (<code>test0</code> in het voorbeeld) op het lokale Ethernet identificeren en een route voor die host toevoegen, direct van deze host over de Ethernet-interface, <span class=filename>ed0</span>. Er is ook een timeout (kolom <code>Expire</code>) met deze routesoort geassocieerd, die gebruikt wordt indien er binnen een bepaalde tijd geen bericht komt van de host. Indien dit gebeurt, wordt de route naar deze host automatisch verwijderd. Deze hosts worden geïdentificeerd door middel van een mechanisme dat bekend staat als RIP (Routing Information Protocol), dat routes naar lokale hosts bepaald door middel van een kortste-pad algoritme.</p></div><div class=paragraph><p>FreeBSD zal ook subnetroutes voor het lokale subnet toevoegen (<code>10.20.30.255</code> is het broadcast-adres voor het subnet <code>10.20.30</code>, en <code>example.com</code> is de domeinnaam die bij dat subnet hoort). De aanduiding <code>link#1</code> verwijst naar de eerste Ethernetkaart in de machine. Merk op dat voor hen geen aanvullende interface is gespecificeerd.</p></div><div class=paragraph><p>Voor beide groepen (lokale netwerkhosts en lokale subnetten) worden de routes automatisch ingesteld door een daemon genaamd routed. Indien dit niet draait, zullen alleen routes die statisch gedefinieerd (i.e., expliciet vermeld zijn) bestaan.</p></div><div class=paragraph><p>De regel met <code>host1</code> verwijst naar deze host, het kent deze door het Ethernetadres. Aangezien het de zendende host is, weet FreeBSD dat het de teruglus-interface (<span class=filename>lo0</span>) moet gebruiken, in plaats van het over de Ethernet-interface te verzenden.</p></div><div class=paragraph><p>De twee regels met <code>host2</code> geven een voorbeeld van wat er gebeurt als een alias met <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> gebruikt wordt (in de sectie over Ethernet staan redenen waarom dit gedaan wordt). Het symbool <code>⇒</code> na de interface <span class=filename>lo0</span> zegt dat niet alleen de teruglus gebruikt wordt (aangezien dit adres ook verwijst naar de lokale host), maar specifiek dat dit een alias is. Zulke routes verschijnen alleen op de hosts die de alias ondersteunen; alle andere hosts op het lokale netwerk vermelden simpelweg een regel met <code>link#1</code> voor zulke routes.</p></div><div class=paragraph><p>De laatste regel (bestemming subnet <code>224</code>) heeft te maken met multicasten, wat in een andere sectie besproken wordt.</p></div><div class=paragraph><p>Als laatste staan in de kolom <code>Flags</code> verschillende attributen. Hieronder staat een korte tabel met enkele van deze vlaggen en hun betekenis:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>U</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Up: De route is actief.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>H</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Host: De bestemming van de route is een enkele host.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>G</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gateway: Stuur alles voor deze bestemming door naar dit verre systeem, dat zoekt daar uit waar het verder naar te sturen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>S</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Statisch: Deze route was handmatig ingesteld, dus niet automatisch door het systeem aangemaakt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>C</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Kloon: Maakt op basis van deze route een nieuwe route aan voor machines waarmee verbinding wordt gemaakt. Dit soort routes wordt gewoonlijk in lokale netwerken gebruikt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>W</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>WasGekloond: Geeft aan dat een route automatisch was ingesteld gebaseerd op een LAN (kloon)-route.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>L</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Verbinding: De route maakt gebruik van verwijzingen naar Ethernet-hardware.</p></td></tr></tbody></table></div><div class=sect3><h4 id=network-routing-default>31.2.2. Standaardroutes<a class=anchor href=#network-routing-default></a></h4><div class=paragraph><p>Wanneer het lokale systeem een verbinding met een verre host moet maken, controleert het de routeertabel op reeds bekende paden. Indien de verre host binnen een subnet valt waarvan bekend is hoe het bereikt kan worden (gekloonde routes), controleert het systeem of het met de daarbij behorende interface verbinding kan maken.</p></div><div class=paragraph><p>Indien alle bekende paden falen, heeft het systeem één laatste mogelijkheid: de "standaardroute". Deze route is een speciaal soort gateway-route (gewoonlijk de enig aanwezige in het systeem) en is altijd gemarkeerd met een <code>c</code> in het vlaggenveld. Voor hosts op een LAN staat deze gateway ingesteld op de machine die een directe verbinding met de buitenwereld heeft (via een PPP-verbinding, DSL, kabelmodem, T1, of een ander netwerkinterface).</p></div><div class=paragraph><p>Indien de standaardroute wordt ingesteld voor een machine die zelf als gateway naar de buitenwereld werkt, zal de standaardroute de gateway-machine van de internetprovider zijn.</p></div><div class=paragraph><p>Hieronder volgt een voorbeeld van standaardroutes. Dit is een veelgebruikte opstelling:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/net-routing.png alt="net routing"></div></div><div class=paragraph><p>De hosts <code>Lokaal1</code> en <code>Lokaal2</code> staan op deze site. <code>Lokaal1</code> is verbonden met een internetprovider via een inbel-PPP-verbinding. Deze PPP-server is door een LAN verbonden met een andere gateway-computer door een externe interface naar de Internet-feed van de internetprovider.</p></div><div class=paragraph><p>De standaardroutes voor de machines zijn:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Host</th><th class="tableblock halign-left valign-top">Standaard gateway</th><th class="tableblock halign-left valign-top">Interface</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ethernet</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>T1-GW</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PPP</p></td></tr></tbody></table><div class=paragraph><p>Een veelvoorkomende vraag is "Waarom (of hoe) moet worden ingesteld dat <code>T1-GW</code> de standaard gateway is voor <code>Lokaal1</code>, in plaats van de server van de internetprovider waarmee het verbonden is?".</p></div><div class=paragraph><p>Onthoud dat, aangezien de PPP-interface een adres gebruikt op het lokale netwerk van de internetprovider voor deze kant van de verbinding, routes voor alle andere machines op het lokale netwerk van de internetprovider automatisch aangemaakt worden. Daarom is het al bekend hoe de machine <code>T1-GW</code> bereikt kan worden, dus is de tussenstap dat het verkeer eerst naar de server van de internetprovider gestuurd wordt niet nodig.</p></div><div class=paragraph><p>Het is gebruikelijk om het adres <code>X.X.X.1</code> te gebruiken als het gateway-adres voor het lokale netwerk. Dus (gebruikmakend van hetzelfde voorbeeld), indien de lokale klasse-C adresruimte <code>10.20.30</code> was en de internetprovider <code>10.9.9</code> gebruikte, zouden de standaardroutes als volgt zijn:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Host</th><th class="tableblock halign-left valign-top">Standaardroute</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal2 (10.20.30.2)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal1 (10.20.30.1)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal1 (10.20.30.1, 10.9.9.30)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>T1-GW (10.9.9.1)</p></td></tr></tbody></table><div class=paragraph><p>De standaardroute kan eenvoudig in <span class=filename>/etc/rc.conf</span> gedefinieerd worden. In dit voorbeeld werd de volgende regel aan <span class=filename>/etc/rc.conf</span> van <code>Lokaal2</code> toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;10.20.30.1&#34;</pre></div></div><div class=paragraph><p>Het is ook mogelijk dit met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=route&amp;sektion=8&amp;format=html">route(8)</a> direct vanaf de opdrachtregel te doen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add default 10.20.30.1</span></code></pre></div></div><div class=paragraph><p>Voor meer informatie over het handmatig manipuleren van netwerkrouteertabellen kan de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=route&amp;sektion=8&amp;format=html">route(8)</a> geraadpleegd worden.</p></div></div><div class=sect3><h4 id=network-dual-homed-hosts>31.2.3. Dual Homed machines<a class=anchor href=#network-dual-homed-hosts></a></h4><div class=paragraph><p>Er is nog één andere soort opstelling die behandeld dient te worden, en dat is een host die in twee verschillende netwerken zit. Technisch gezien telt elke machine die als gateway dienst doet (in bovenstaand voorbeeld door een PPP-verbinding te gebruiken) als een dual-homed host. Maar de term wordt echt alleen gebruikt om naar een machine te verwijzen die in twee LAN’s zit.</p></div><div class=paragraph><p>In het ene geval heeft de machine twee Ethernetkaarten, waarbij elke kaart een adres op de gescheiden subnetten heeft. Een alternatief is dat de machine slechts één Ethernetkaart heeft en gebruikt maakt van <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> aliasing. Het eerste wordt gebruikt indien er twee fysiek gescheiden Ethernet-netwerken in gebruik zijn, het laatste indien er één fysiek netwerksegment is, maar er twee logisch gescheiden subnetten zijn.</p></div><div class=paragraph><p>In beide gevallen worden er routeertabellen aangemaakt zodat elk subnet weet dat deze machine de gedefinieerde gateway (ingaande route) naar het andere subnet is. Deze opstelling, waarbij de machine dienst doet als router tussen de twee subnetten, wordt vaak gebruikt voor het implementeren van pakketfilters of firewall-beveiliging in één of beide richtingen.</p></div><div class=paragraph><p>Om deze machine daadwerkelijk pakketten te laten forwarden tussen de twee interfaces, moet aan FreeBSD verteld worden dat het deze mogelijkheid aan moet zetten. In de volgende sectie staan meer details over hoe dit te doen.</p></div></div><div class=sect3><h4 id=network-dedicated-router>31.2.4. Een router bouwen<a class=anchor href=#network-dedicated-router></a></h4><div class=paragraph><p>Een netwerkrouter is simpelweg een systeem dat pakketten van de ene naar de andere interface doorstuurt. Internetstandaarden en goede ontwerppraktijken verhinderen het FreeBSD Project dit standaard in FreeBSD aan te zetten. Deze mogelijkheid kan worden aangezet door de volgende variabele in <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> op <code>YES</code> in te stellen:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;	# Op YES instellen indien deze host een gateway is</pre></div></div><div class=paragraph><p>Deze optie stelt de <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> variabele <code>net.inet.ip.forwarding</code> in op <code>1</code>. Indien het nodig is om het routen tijdelijk te stoppen, kan deze variabele tijdelijk op <code>0</code> worden teruggezet.</p></div><div class=paragraph><p>De nieuwe router heeft routes nodig om te weten waar het het verkeer naar toe moet sturen. Voor een eenvoudig netwerk kunnen statische routes gebruikt worden. FreeBSD wordt met het standaard BSD routeer-daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=routed&amp;sektion=8&amp;format=html">routed(8)</a> geleverd, dat RIP (zowel versie 1 en versie 2) en IRDP spreekt. Ondersteuning voor BGP v4, OSPF v2, en andere slimme routeerprotocollen is beschikbaar via het pakket <a class=package href=https://cgit.freebsd.org/ports/tree/net/zebra/>net/zebra</a>. Ook zijn commerciële producten als GateD® beschikbaar voor complexere netwerkrouteer-oplossingen.</p></div></div><div class=sect3><h4 id=network-static-routes>31.2.5. Statische routes opzetten<a class=anchor href=#network-static-routes></a></h4><div class=sect4><h5 id=_handmatige_configuratie>31.2.5.1. Handmatige configuratie<a class=anchor href=#_handmatige_configuratie></a></h5><div class=paragraph><p>Er wordt van het volgende netwerk uitgegaan:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/static-routes.png alt="static routes"></div></div><div class=paragraph><p>In dit scenario is <code>RouterA</code> een FreeBSD-machine die dienst doet als router naar de rest van het Internet. Het heeft een standaardroute ingesteld op <code>10.0.0.1</code>, dat het in staat stelt om verbindingen met de buitenwereld te maken. Er wordt aangenomen dat <code>RouterB</code> reeds juist is ingesteld en dat het weet hoe het waar naar toe moet gaan. (In dit plaatje is dit simpel. Voeg een standaardroute op <code>RouterB</code> toe door <code>192.168.1.1</code> als gateway te gebruiken.)</p></div><div class=paragraph><p>De routeertabel voor <code>RouterA</code> zou er ongeveer als volgt uitzien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% netstat <span class=nt>-nr</span>
Routing tables

Internet:
Destination        Gateway            Flags    Refs      Use  Netif  Expire
default            10.0.0.1           UGS         0    49378    xl0
127.0.0.1          127.0.0.1          UH          0        6    lo0
10.0.0.0/24          <span class=nb>link</span><span class=c>#1             UC          0        0    xl0</span>
192.168.1.0/24       <span class=nb>link</span><span class=c>#2             UC          0        0    xl1</span></code></pre></div></div><div class=paragraph><p>Met de huidige routeertabel is <code>RouterA</code> niet in staat om Intern Net 2 te bereiken. Het heeft geen route voor <code>192.168.2.0/24</code>. Een manier om dit te verhelpen is om de route handmatig toe te voegen. Het volgende commando voegt het netwerk Intern Net 2 toe aan de routeertabel van <code>RouterA</code> door <code>192.168.1.2</code> als de volgende hop te gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add -net 192.168.2.0/24 192.168.1.2</span></code></pre></div></div><div class=paragraph><p>Nu kan <code>RouterA</code> elke host op het netwerk <code>192.168.2.0/24</code> bereiken.</p></div></div><div class=sect4><h5 id=_persistente_configuratie>31.2.5.2. Persistente configuratie<a class=anchor href=#_persistente_configuratie></a></h5><div class=paragraph><p>Bovenstaand voorbeeld is perfect voor het instellen van een statische route op een draaiend systeem. Een probleem is dat de routeerinformatie verdwijnt indien de FreeBSD-machine opnieuw wordt opgestart. Aanvullende statische routes kunnen in <span class=filename>/etc/rc.conf</span> opgenomen worden:</p></div><div class="literalblock programlisting"><div class=content><pre># Voeg Intern Net 2 als een statische route toe
static_routes=&#34;internnet2&#34;
route_internnet2=&#34;-net 192.168.2.0/24 192.168.1.2&#34;</pre></div></div><div class=paragraph><p>De instellingsvariabele <code>static_routes</code> is een lijst van strings gescheiden door een spatie. Elke string verwijst naar een routenaam. Bovenstaand voorbeeld heeft slechts één string in <code>static_routes</code>. Dit is de string <em>internnet2</em>. Vervolgens wordt een instellingsvariabele <code>route_internnet2</code> toegevoegd waarin alle instellingsparameters staan die aan het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=route&amp;sektion=8&amp;format=html">route(8)</a> moeten worden doorgegeven. Voor bovenstaand voorbeeld zou het volgende commando zijn gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add -net 192.168.2.0/24 192.168.1.2</span></code></pre></div></div><div class=paragraph><p>Dus is <code>"-net 192.168.2.0/24 192.168.1.2"</code> nodig.</p></div><div class=paragraph><p>Zoals hierboven is vermeld is het mogelijk om meerdere strings in <code>static_routes</code> te hebben. Dit maakt het mogelijk om meerdere statische routes aan te maken. De volgende regels geven een voorbeeld van het toevoegen van statische routes voor de netwerken <code>192.168.0.0/24</code> en <code>192.168.1.0/24</code> op een denkbeeldige router:</p></div><div class="literalblock programlisting"><div class=content><pre>static_routes=&#34;net1 net2&#34;
route_net1=&#34;-net 192.168.0.0/24 192.168.0.1&#34;
route_net2=&#34;-net 192.168.1.0/24 192.168.1.1&#34;</pre></div></div></div></div><div class=sect3><h4 id=network-routing-propagation>31.2.6. Routes propageren<a class=anchor href=#network-routing-propagation></a></h4><div class=paragraph><p>Er is al gesproken over hoe routes naar de buitenwereld te definiëren, maar niet over hoe de buitenwereld ons kan vinden.</p></div><div class=paragraph><p>Het is al bekend dat routeertabellen aangemaakt kunnen worden zodat al het verkeer voor een bepaalde adresruimte (in ons voorbeeld een klasse-C subnet) naar een bepaalde host op dat netwerk gezonden kan worden, dat de ingaande pakketten doorgeeft.</p></div><div class=paragraph><p>Wanneer een adresruimte aan een site wordt toegewezen, stelt de serviceprovider al hun routeertabellen zodanig in dat al het verkeer voor het bijhorende subnet naar de PPP-verbinding van de site gezonden wordt. Maar hoe weten sites door het land heen hoe naar de internetprovider van deze site te versturen?</p></div><div class=paragraph><p>Er bestaat een systeem (dat veel lijkt op de gedistribueerde DNS-informatie) dat alle toegewezen adresruimtes bijhoudt, en hun verbindingspunt met de Internet Backbone definieert. De "Backbone" zijn de grote kabels die Internetverkeer door het land en over de wereld sturen. Elke backbone-machine heeft een kopie van een master-verzameling van tabellen, die verkeer voor een bepaald netwerk naar een bepaalde backbone-carrier sturen, en van daaruit naar een keten van serviceproviders totdat het netwerk van de site bereikt is.</p></div><div class=paragraph><p>Het is de taak van de serviceprovider om bij de backbone-sites aan te geven dat zij het verbindingspunt (en dus het ingaande pad) zijn voor de site. Dit staat bekend als routepropagatie.</p></div></div><div class=sect3><h4 id=network-routing-troubleshooting>31.2.7. Problemen oplossen<a class=anchor href=#network-routing-troubleshooting></a></h4><div class=paragraph><p>Soms is er een probleem met routepropagatie en kunnen sommige sites geen verbinding maken. Misschien is het nuttigste commando om proberen uit te zoeken waar het routen misgaat <a href="https://man.freebsd.org/cgi/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a>. Het is ook nuttig als er geen verbinding mogelijk lijkt met een verre machine (dus als <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> faalt).</p></div><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a> wordt gedraaid met de naam van de verre host waarmee geprobeerd wordt te verbinden. Het laat de gateway-hosts zien langs het gepoogde pad, dat uiteindelijk de doelhost bereikt, of wegens een gebrek aan verbinding afgebroken wordt.</p></div><div class=paragraph><p>Raadpleeg voor meer informatie de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a>.</p></div></div><div class=sect3><h4 id=network-routing-multicast>31.2.8. Multicast routen<a class=anchor href=#network-routing-multicast></a></h4><div class=paragraph><p>FreeBSD ondersteunt zowel multicast-applicaties als multicast routen van huis uit. Voor multicast-applicaties is geen speciale configuratie van FreeBSD nodig; applicaties draaien over het algemeen als geleverd. Voor multicast routen dient ondersteuning in de kernel gecompileerd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>options MROUTING</pre></div></div><div class=paragraph><p>Ook dient de multicast-routeer-daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a> ingesteld worden zodat het tunnels en DVMRP via <span class=filename>/etc/mrouted.conf</span> aanmaakt. Kijk voor meer details over multicast-instellingen in de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a> multicast-routeer-daemon implementeert het multicast-routeer-protocol DVRMP welke in veel multicast-installaties grotendeels is vervangen door <a href="https://man.freebsd.org/cgi/man.cgi?query=pim&amp;sektion=4&amp;format=html">pim(4)</a>. <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a> en de gerelateerde <a href="https://man.freebsd.org/cgi/man.cgi?query=map-mbone&amp;sektion=8&amp;format=html">map-mbone(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=mrinfo&amp;sektion=8&amp;format=html">mrinfo(8)</a> gereedschappen zijn beschikbaar in de FreeBSD Ports Collectie als <a class=package href=https://cgit.freebsd.org/ports/tree/net/mrouted/>net/mrouted</a>.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=network-wireless>31.3. Draadloze netwerken<a class=anchor href=#network-wireless></a></h3><div class=sect3><h4 id=_de_beginselen_van_draadloos_netwerken>31.3.1. De beginselen van draadloos netwerken<a class=anchor href=#_de_beginselen_van_draadloos_netwerken></a></h4><div class=paragraph><p>De meeste draadloze netwerken zijn op de IEEE® 802.11 standaarden gebaseerd. Een eenvoudig draadloos netwerk bestaat uit meerdere stations die met radio’s communiceren die in de 2,4GHz of de 5GHz band uitzenden (alhoewel dit regionaal varieert en het ook verandert om communicatie in de 2,3GHz en de 4,9GHz banden mogelijk te maken).</p></div><div class=paragraph><p>802.11-netwerken zijn op twee manieren georganiseerd: in <em>infrastructuurmodus</em> treedt één station als meester op, alle andere stations associëren met dit station; dit netwerk staat bekend als een BSS en het meesterstation heet een toegangspunt (AP). In een BSS gaat alle communicatie via het AP; zelfs als een station met een ander draadloos station wil communiceren gaan de boodschappen door het AP. In de tweede netwerkvorm is er geen meester en communiceren de stations direct. Deze netwerkvorm is een IBSS en staat gewoonlijk bekend als een <em>ad-hoc netwerk</em>.</p></div><div class=paragraph><p>802.11 netwerken begonnen in de 2,4GHz band waarbij gebruik werd gemaakt van protocollen die door de IEEE® 802.11 en 802.11b standaarden worden gedefinieerd. Deze specificaties omvatten de werkfrequenties, karakteristieken van de MAC-lagen waaronder frame- en zendsnelheden (communicatie kan met verschillende snelheden plaatsvinden). Later definieerde de 802.11a-standaard het werken in de 5GHz band, inclusief andere mechanismen voor signalering en hogere zendsnelheden. Nog later werd de 802.11g-standaard gedefinieerd om gebruik te kunnen maken van de signalerings- en zendmechanismen van 802.11a in de 2,4GHz band zodanig dat het met terugwerkende kracht werkt op 802.11b-netwerken.</p></div><div class=paragraph><p>Afgezien van de onderliggende zendtechnieken beschikken 802.11-netwerken over een verscheidenheid aan beveiligingstechnieken. De originele 802.11-specificaties definieerden een eenvoudig beveiligingsprotocol genaamd WEP. Dit protocol maakt gebruik van een vaste, van te voren gedeelde sleutel en het cryptografische algoritme RC4 om de gegevens die over het netwerk verstuurd worden te coderen. Alle stations dienen dezelfde sleutel te gebruiken om te kunnen communiceren. Het is bewezen dat dit mechanisme eenvoudig te kraken is en wordt nu, afgezien om voorbijgaande gebruikers te ontmoedigen het netwerk te gebruiken, nog zelden gebruikt. De huidige beveiligingsmethoden worden gegeven door de IEEE® 802.11i specificatie dat nieuwe cryptografische algoritmen en een aanvullend protocol om stations aan een toegangspunt te authenticeren en om sleutels voor gegevenscommunicatie uit te wisselen definieert. Verder worden cryptografische sleutels periodiek ververst en zijn er mechanismen om indringpogingen te detecteren (en om indringpogingen tegen te gaan). Een andere specificatie van een veelgebruikt beveiligingsprotocol in draadloze netwerken is WPA. Dit was een voorloper op 802.11i en gedefinieerd door een industriegroep als een tussenmaatregel terwijl er gewacht werd op de ratificatie van 802.11i. WPA specificeert een deel van de eisen van 802.11i en is ontworpen voor implementatie op verouderde hardware. In het bijzonder vereist WPA alleen de TKIP-sleutel die van de originele WEP-sleutel is afgeleid. 802.11i staat het gebruik van TKIP toe maar vereist ook ondersteuning voor een sterkere sleutel, AES-CCM, om gegevens te versleutelen. (De AES-sleutel was niet nodig in WPA omdat het rekenkundig te kostbaar werd geacht voor implementatie op verouderde hardware.)</p></div><div class=paragraph><p>Afgezien van de bovenstaande protocolstandaarden is de andere belangrijke standaard waarvan bewustzijn belangrijk is 802.11e. Deze standaard definieert het opstellen van multimediatoepassingen zoals gestroomde video en voice over IP (VoIP) binnen een 802.11-netwerk. Net als 802.11i heeft ook 802.11e een voorgaande specificatie genaamd WME (later hernoemd tot WMM) die door een industriegroep is gedefinieerd als een deelverzameling van 802.11e die nu kan worden gebruikt om multimediatoepassingen mogelijk te maken terwijl er gewacht wordt op de uiteindelijke ratificatie van 802.11e. Het belangrijkste om over 802.11e en WME/WMM te weten is dat ze gepriotiseerd verkeersgebruik van een draadloos netwerk mogelijk maken door middel van Quality of Service (QoS) protocollen en protocollen voor verbeterde mediatoegang. Een juiste implementatie van deze protocollen maken snelle gegevensbursts en gepriotiseerde verkeersstromen mogelijk.</p></div><div class=paragraph><p>FreeBSD ondersteunt netwerken die met 802.11a, 802.11b, en 802.11g werken. Ook worden de veiligheidsprotocollen WPA en 802.11i ondersteund (samen met 11a, 11b, of 11g) en QoS en de verkeerspriorisatieprotocollen die nodig zijn voor de protocollen WME/WMM worden voor een beperkte verzameling draadloze apparatuur ondersteund.</p></div></div><div class=sect3><h4 id=network-wireless-basic>31.3.2. Basisinstallatie<a class=anchor href=#network-wireless-basic></a></h4><div class=sect4><h5 id=_kernelinstellingen_2>31.3.2.1. Kernelinstellingen<a class=anchor href=#_kernelinstellingen_2></a></h5><div class=paragraph><p>Om van een draadloos netwerk gebruik te maken is het nodig om een draadloze netwerkkaart te hebben en om de kernel met de juiste ondersteuning voor draadloze netwerken in te stellen. Het laatste is verdeeld in meerdere modulen zodat alleen de software ingesteld hoeft te worden die daadwerkelijk gebruikt zal worden.</p></div><div class=paragraph><p>Ten eerste is een draadloos netwerkapparaat nodig. De meestgebruikte apparaten zijn degenen die onderdelen van Atheros gebruiken. Deze apparaten worden ondersteund door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a> en voor hen dient de volgende regel aan <span class=filename>/boot/loader.conf</span> toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>if_ath_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het stuurprogramma voor Atheros is opgedeeld in drie verschillende delen: het eigenlijke stuurprogramma (<a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a>), de ondersteuningslaag voor de hardware die chip-specifieke functies afhandelt (<a href="https://man.freebsd.org/cgi/man.cgi?query=ath_hal&amp;sektion=4&amp;format=html">ath_hal(4)</a>), en een algoritme om de snelheid om frames te verzenden te kiezen uit een reeks mogelijke waarden (hier ath_rate_sample). Indien deze ondersteuning als kernelmodules wordt geladen, zullen de afhankelijkheden automatisch afgehandeld worden. Voor andere apparaten dan die van Atheros dient de module voor dat stuurprogramma geladen te worden; bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>if_wi_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>voor apparaten die op onderdelen van Intersil Prism zijn gebaseerd (stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=wi&amp;sektion=4&amp;format=html">wi(4)</a>).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In de rest van dit document zal een <a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a> apparaat gebruikt worden, de naam van het apparaat in de voorbeelden dient aangepast te worden aan de lokale installatie. Een lijst van beschikbare draadloze stuurprogramma’s en ondersteunde adapters staat in de FreeBSD Hardware Notes. Kopieën hiervan voor verschillende uitgaven en architecturen zijn beschikbaar op de <a href=http://www.FreeBSD.org/releases/>Uitgave Informatie</a> pagina van de FreeBSD website. Indien er geen origineel stuurprogramma voor het draadloze apparaat bestaat, is het mogelijk om te proberen om direct het stuurprogramma van Windows® proberen te gebruiken met behulp van de stuurprogramma-wrapper <a href=./#config-network-ndis>NDIS</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Daarvoor zijn ook de modules nodig die cryptografische ondersteuning implementeren voor de te gebruiken veiligheidsprotocollen. Het is de bedoeling dat ze dynamisch door de module <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan&amp;sektion=4&amp;format=html">wlan(4)</a> worden geladen maar momenteel dienen ze handmatig ingesteld te worden. De volgende modules zijn beschikbaar: <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_wep&amp;sektion=4&amp;format=html">wlan_wep(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_ccmp&amp;sektion=4&amp;format=html">wlan_ccmp(4)</a>, en <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_tkip&amp;sektion=4&amp;format=html">wlan_tkip(4)</a>. Zowel de stuurprogramma’s <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_ccmp&amp;sektion=4&amp;format=html">wlan_ccmp(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_tkip&amp;sektion=4&amp;format=html">wlan_tkip(4)</a> zijn alleen nodig indien het veiligheidsprotocol WPA en/of 802.11i gebruikt wordt. Indien het netwerk encryptieloos dient te zijn, is de ondersteuning van <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_wep&amp;sektion=4&amp;format=html">wlan_wep(4)</a> niet nodig. Om deze modules tijdens het opstarten te laden, dienen de volgende regels aan <span class=filename>/boot/loader.conf</span> toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>wlan_wep_load=&#34;YES&#34;
wlan_ccmp_load=&#34;YES&#34;
wlan_tkip_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Nadat deze informatie aan het instellingenbestand om het systeem op te starten (i.e., <span class=filename>/boot/loader.conf</span>) is toegevoegd, is het noodzakelijk om de FreeBSD-computer opnieuw op te starten. Indien het ongewenst is om de computer nu opnieuw op te starten, kunnen de modules ook handmatig worden geladen door <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> te gebruiken.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien het gebruik van modules ongewenst is, kunnen deze stuurprogramma’s in de kernel worden gecompileerd door de volgende regels aan het kernelinstellingenbestand toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>device wlan              # 802.11 ondersteuning
device wlan_wep          # 802.11 WEP-ondersteuning
device wlan_ccmp         # 802.11 CCMP-ondersteuning
device wlan_tkip         # 802.11 TKIP-ondersteuning
device wlan_amrr	 # AMRR controle-algoritme voor zendsnelheid
device ath	         # Atheros PCI/Cardbus netwerkkaarten
device ath_hal		 # Ondersteuning voor PCI/cardbus chips
options AH_SUPPORT_AR5146 # zet AR5146 tx/rx descriptors aan
device ath_rate_sample   # SampleRate verzendsnelheid-controle voor ath</pre></div></div><div class=paragraph><p>Met deze informatie in het kernelinstellingenbestand kan de kernel opnieuw gecompileerd en de FreeBSD-computer opnieuw opgestart worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Wanneer het systeem draait, is het mogelijk om enige informatie over de draadloze apparaten in de opstartboodschappen te vinden, zoals:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ath0: &lt;Atheros 5212&gt; mem 0x88000000-0x8800ffff irq 11 at device 0.0 on cardbus1
ath0: <span class=o>[</span>ITHREAD]
ath0: AR2413 mac 7.9 RF2413 phy 4.5</code></pre></div></div></div></div><div class=sect3><h4 id=_infrastructuurmodus>31.3.3. Infrastructuurmodus<a class=anchor href=#_infrastructuurmodus></a></h4><div class=paragraph><p>De infrastructuur- of BSS-modus is de modus die normaliter gebruikt wordt. In deze modus zijn een aantal draadloze toegangspunten verbonden met een bedraad netwerk. Elk draadloos netwerk heeft een eigen naam, deze naam wordt de SSID van het netwerk genoemd. Draadloze cliënten verbinden zich met de draadloze toegangspunten.</p></div><div class=sect4><h5 id=_freebsd_cliënten>31.3.3.1. FreeBSD cliënten<a class=anchor href=#_freebsd_cliënten></a></h5><div class=sect5><h6 id=_hoe_toegangspunten_te_vinden>31.3.3.1.1. Hoe toegangspunten te vinden<a class=anchor href=#_hoe_toegangspunten_te_vinden></a></h6><div class=paragraph><p>Voor het scannen van netwerken wordt het commando <code>ifconfig</code> gebruikt. Het kan even duren voordat dit verzoek is afgehandeld aangezien het systeem op elke beschikbare draadloze frequentie naar toegangspunten moet zoeken. Alleen de super-gebruiker kan zo’n scan opzetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 up scan</span>
SSID/MESH ID  BSSID              CHAN RATE   S:N     INT CAPS
dlinkap       00:13:46:49:41:76   11   54M <span class=nt>-90</span>:96 100 EPS  WPA WME
freebsdap     00:11:95:c3:0d:ac    1   54M <span class=nt>-83</span>:96 100 EPS  WPA</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De interface dient als up te worden gemarkeerd voordat het scannen begint. Voor verdere scans is het niet nodig om de interface als up te markeren.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De uitvoer van een scanverzoek vermeld elk gevonden BSS/IBSS-netwerk. Naast de naam van het netwerk, <code>SSID</code>, staat het <code>BSSID</code>, wat het MAC-adres van het toegangspunt is. Het veld <code>CAPS</code> identificeert het type van elk netwerk en de mogelijkheden van de stations die daar werkzaam zijn:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 11. Station Capability Codes</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Capability Code</th><th class="tableblock halign-left valign-top">Betekenis</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>E</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Uitgebreide dienstenverzameling (ESS). Geeft aan dat het station deel uitmaakt van een infrastructuurnetwerk (in tegenstelling tot een IBSS-/ ad-hoc-netwerk).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>I</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IBSS-/ad-hoc-netwerk. Geeft aan dat het station deel uitmaakt van een ad-hoc-netwerk (in tegenstelling tot een ESS-netwerk).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>P</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Privacy. Vertrouwelijkheid is vereist voor alle gegevensframes die binnen het BSS worden uitgewisseld. Dit betekent dat dit BSS eist dat het station cryptografische middelen als WEP, TKIP of AES-CCMP dient te gebruiken om de gegevensframes die met anderen worden uitgewisseld te versleutelen en te ontsleutelen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>S</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Korte preambule. Geeft aan dat het netwerk korte preambules gebruikt (gedefinieerd in 802.11b Hoge Snelheid/DSSS PHY, korte preambule gebruikt een 56-bits synchronisatieveld in tegenstelling tot een 128-bits dat bij lange preambules wordt gebruikt).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>s</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Korte slottijd. Geeft aan dat het 802.11g-netwerk een korte slottijd gebruikt omdat er geen verouderde (802.11b) stations aanwezig zijn.</p></td></tr></tbody></table><div class=paragraph><p>Het is ook mogelijk om de huidige lijst van bekende netwerken weer te geven met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig scan0 list scan</span></code></pre></div></div><div class=paragraph><p>Deze informatie kan automatisch bijgewerkt worden door de adapter of handmatig met een <code>scan</code> verzoek. Oude gegevens worden automatisch uit de cache verwijderd, dus kan deze lijst na verloop van tijd korter worden tenzij er meer scanverzoeken gedaan worden.</p></div></div><div class=sect5><h6 id=_basisinstellingen_2>31.3.3.1.2. Basisinstellingen<a class=anchor href=#_basisinstellingen_2></a></h6><div class=paragraph><p>Deze sectie geeft een eenvoudig voorbeeld hoe de draadloze netwerkadapter in FreeBSD zonder encryptie aan de praat te krijgen. Nadat deze concepten bekend zijn, wordt het sterk aangeraden om <a href=#network-wireless-wpa>WPA</a> te gebruiken om de draadloze netwerken op te zetten.</p></div><div class=paragraph><p>Er zijn drie basisstappen om een draadloos netwerk in te stellen: een toegangspunt kiezen, het station authenticeren, en een IP-adres instellen. De volgende secties behandelen elk een stap.</p></div><div class=sect6><h7 id=_een_toegangspunt_kiezen>31.3.3.1.2.1. Een toegangspunt kiezen<a class=anchor href=#_een_toegangspunt_kiezen></a></h7><div class=paragraph><p>In de meeste gevallen is het voldoende om het systeem een toegangspunt gebaseerd op de ingebouwde heuristieken te laten kiezen. Dit is het standaardgedrag wanneer een interface als up wordt gemarkeerd of als een interface wordt ingesteld door het te noemen in <span class=filename>/etc/rc.conf</span>, bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;DHCP&#34;</pre></div></div><div class=paragraph><p>Indien er meerdere toegangspunten zijn en het gewenst is om een specifieke te kiezen, kan dit met het SSID:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;ssid uw_ssid_hier DHCP&#34;</pre></div></div><div class=paragraph><p>In een omgeving waar meerdere toegangspunten hetzelfde SSID hebben (vaak gedaan om roamen eenvoudiger te maken) kan het nodig zijn om met één specifiek apparaat te associëren. In dit geval kan ook het BSSID van het toegangspunt gespecificeerd worden (het SSID kan ook weggelaten worden):</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;ssid uw_ssid_hier bssid xx:xx:xx:xx:xx:xx DHCP</pre></div></div><div class=paragraph><p>Er zijn andere manieren om de keuze van een toegangspunt te beperken zoals het beperken van het aantal frequenties waarop het systeem scant. Dit kan handig zijn bij multi-band-netwerkkaarten aangezien het scannen van alle mogelijke kanalen tijdrovend kan zijn. Om de werking tot een specifieke band te beperken kan de parameter <code>mode</code> gebruikt worden; bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;mode 11g ssid uw_ssid_hier DHCP&#34;</pre></div></div><div class=paragraph><p>zal de kaart forceren om te werken in 802.11g welke alleen voor 2,4GHz frequenties is gedefinieerd dus de 5GHz kanalen blijven buiten beschouwing. Andere manieren om dit te doen zijn de parameter <code>channel</code>, om bewerkingen op één specifieke frequentie vast te zetten, en de parameter <code>chanlist</code>, om een lijst van te scannen kanalen te specificeren. Meer informatie over deze parameters kan in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> gevonden worden.</p></div></div><div class=sect6><h7 id=_authenticatie>31.3.3.1.2.2. Authenticatie<a class=anchor href=#_authenticatie></a></h7><div class=paragraph><p>Nadat er een toegangspunt is gekozen moet het station zich authenticeren voordat het gegevens kan versturen. Authenticatie kan op verschillende manieren gebeuren. Het meest gebruikte schema wordt open authenticatie genoemd en staat doe dat elk station aan het netwerk deelneemt en communiceert. Deze manier van authenticatie dient gebruikt te worden voor testdoeleinden tijdens het voor de eerste keer opzetten van een draadloos netwerk. Andere schema’s vereisen dat cryptografische overeenkomsten voltooid worden voordat gegevensverkeer kan stromen; ofwel door vooraf gedeelde sleutels of geheimen te gebruiken, of door complexere schema’s te gebruiken welke achterliggende diensten zoals RADIUS betrekken. De meeste gebruikers zullen open authenticatie gebruiken welke de standaardinstelling is. De dan meest voorkomende opstelling is WPA-PSK, ook bekend als WPA Personal, welke <a href=#network-wireless-wpa-wpa-psk>hieronder</a> beschreven is.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien er een Apple® AirPort® Extreme basisstation als toegangspunt wordt gebruikt kan het nodig zijn om gedeelde-sleutel-authenticatie samen met een WEP-sleutel in te stellen. Dit kan gedaan worden in het bestand <span class=filename>/etc/rc.conf</span> of door het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant&amp;sektion=8&amp;format=html">wpa_supplicant(8)</a> te gebruiken. Indien er een enkel AirPort® basisstation wordt gebruikt kan de toegang met zoiets als het volgende worden ingesteld:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;authmode shared wepmode on weptxkey 1 wepkey 01234567 DHCP&#34;</pre></div></div><div class=paragraph><p>Over het algemeen dient authenticatie via gedeelde sleutels worden voorkomen omdat het materiaal van de WEP-sleutel op een zeer afgedwongen manier gebruikt wordt wat het zelfs gemakkelijker maakt om de sleutel te kraken. Indien WEP gebruikt moet worden (bijvoorbeeld voor compatibiliteit met verouderde apparaten) is het beter om WEP met <code>open</code> authenticatie te gebruiken. Meer informatie met betrekking tot WEP kan gevonden worden in <a href=#network-wireless-wep>WEP</a>.</p></div></td></tr></tbody></table></div></div><div class=sect6><h7 id=_een_ip_adres_verkrijgen_met_dhcp>31.3.3.1.2.3. Een IP-adres verkrijgen met DHCP<a class=anchor href=#_een_ip_adres_verkrijgen_met_dhcp></a></h7><div class=paragraph><p>Nadat het toegangspunt is gekozen en de parameters voor de authenticatie zijn ingesteld, dient er een IP-adres ter communicatie verkregen worden. In de meeste gevallen wordt het draadloze IP-adres verkregen via DHCP. Om dat te bereiken, dient <span class=filename>/etc/rc.conf</span> bewerkt te worden en <code>DHCP</code> aan de instellingen voor het apparaat toegevoegd te worden zoals in de verschillende bovenstaande voorbeelden is laten zien:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;DHCP&#34;</pre></div></div><div class=paragraph><p>Op dit moment kan de draadloze interface geactiveerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif start</span></code></pre></div></div><div class=paragraph><p>Wanneer de interface draait, kan <code>ifconfig</code> gebruikt worden om de status van de interface <span class=filename>ath0</span> te zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        ether 00:11:95:d5:43:62
	inet 192.168.1.00 netmask 0xffffff00 broadcast 192.168.1.255
        media: IEEE 802.11 Wireless Ethernet OFDM/54Mbps mode 11g
        status: associated
        ssid dlinkap channel 11 <span class=o>(</span>2462 Mhz 11g<span class=o>)</span> bssid 00:13:46:49:41:76
	country US ecm authmode OPEN privacy OFF txpower 21.5 bmiss 7
	scanvalid 60 bgscan bgscanintvl 300 bgscanidle 250 roam:rssi 7
	roam:rate 5 protmode CTS wme burst</code></pre></div></div><div class=paragraph><p>Het <code>status: associated</code> betekent dat er verbinding is met een draadloos netwerk (in dit geval met het netwerk <code>dlinkap</code>). Het gedeelte <code>bssid 00:13:46:49:41:76</code> is het MAC-adres van het toegangspunt; de gedeelte met <code>authmode</code> vertelt dat de communicatie niet versleuteld is.</p></div></div><div class=sect6><h7 id=_statisch_ip_adres>31.3.3.1.2.4. Statisch IP-adres<a class=anchor href=#_statisch_ip_adres></a></h7><div class=paragraph><p>In het geval dat het niet mogelijk is om een IP-adres van een DHCP-server te krijgen, kan er een vast IP-adres worden ingesteld. Vervang het sleutelwoord <code>DHCP</code> van hierboven met de adresinformatie. Zorg ervoor dat de andere parameters voor het selecteren van een toegangspunt behouden blijven:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;inet 192.168.1.100 netmask 255.255.255.0 ssid uw_ssid_hier&#34;</pre></div></div></div></div><div class=sect5><h6 id=network-wireless-wpa>31.3.3.1.3. WPA<a class=anchor href=#network-wireless-wpa></a></h6><div class=paragraph><p>WPA (Wi-Fi Protected Access) is een beveiligingsprotocol dat samen met 802.11-netwerken wordt gebruikt om het gebrek aan degelijke authenticatie en de zwakte van <a href=#network-wireless-wep>WEP</a> te benadrukken. WPA verbetert het 802.1X-authenticatieprotocol en gebruikt een sleutel gekozen uit meerdere in plaats van WEP voor gegevensintegriteit. De enige sleutel welke WPA vereist is TKIP (Temporary Key Integrity Protocol). TKIP is een sleutel dat de basis-RC4-sleutel welke door WEP wordt gebruikt uitbreidt door integriteitscontroles, knoeidetectie, en maatregelen om op elke gedetecteerde inbraak te reageren toe te voegen. TKIP is ontworpen om op verouderde hardware met enkel wijzigingen in software te draaien; het representeert een compromis dat de veiligheid verbetert maar nog steeds niet geheel immuun is tegen aanvallen. WPA specificeert ook de sleutel AES-CCMP als een alternatief voor TKIP welke te verkiezen is indien mogelijk; voor deze specificatie wordt gewoonlijk de term WPA2 (of RSN) gebruikt.</p></div><div class=paragraph><p>WPA definieert protocollen voor authenticatie en versleuteling. Authenticatie gebeurt het meeste door één van deze twee technieken te gebruiken: door 802.1X en een achterliggende authenticatiedienst zoals RADIUS, of door een minimale overeenkomst tussen het station en het toegangspunt door een van te voren gedeeld geheim te gebruiken. Het eerste wordt vaak WPA Enterprise genoemd en het laatste staat bekend als WPA Personal. Aangezien de meeste mensen geen achterliggende RADIUS-server voor hun draadloos netwerk zullen opzetten, is WPA-PSK veruit de meest gebruikte configuratie voor WPA.</p></div><div class=paragraph><p>Het beheer van de draadloze verbinding en de authenticatie (sleutelonderhandeling of authenticatie met een server) gebeurt met het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant&amp;sektion=8&amp;format=html">wpa_supplicant(8)</a>. Dit programma vereist dat er een instellingenbestand, <span class=filename>/etc/wpa_supplicant.conf</span>, draait. Meer informatie over dit bestand kan in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant.conf&amp;sektion=5&amp;format=html">wpa_supplicant.conf(5)</a> worden gevonden.</p></div><div class=sect6><h7 id=network-wireless-wpa-wpa-psk>31.3.3.1.3.1. WPA-PSK<a class=anchor href=#network-wireless-wpa-wpa-psk></a></h7><div class=paragraph><p>WPA-PSK, ook bekend als WPA-Personal, is gebaseerd op een vooraf gedeelde sleutel (PSK) gegenereerd vanuit een gegeven wachtwoord die gebruikt zal worden als de hoofdsleutel in het draadloze netwerk. Dit betekent dat alle draadloze gebruikers dezelfde sleutel zullen delen. WPA-PSK is bedoeld voor kleine netwerken waar het gebruik van een authenticatieserver niet mogelijk of gewenst is.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Gebruik altijd sterke wachtwoorden welke voldoende lang zijn en opgebouwd zijn uit een grote tekenverzameling zodat ze niet gemakkelijk worden geraden of aangevallen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De eerste stap is het instellen van het bestand <span class=filename>/etc/wpa_supplicant.conf</span> met het SSID en de vooraf gedeelde sleutel van het netwerk:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34;
  psk=&#34;freebsdmall&#34;
}</pre></div></div><div class=paragraph><p>Daarna zal in <span class=filename>/etc/rc.conf</span> worden aangegeven dat de draadloze configuratie met WPA zal gebeuren en dat het IP-adres met DHCP zal worden verkregen:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>Hierna kan de interface geactiveerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif start</span>
Starting wpa_supplicant.
DHCPDISCOVER on wlan0 to 255.255.255.255 port 67 interval 5
DHCPDISCOVER on wlan0 to 255.255.255.255 port 67 interval 6
DHCPOFFER from 192.168.0.1
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.1
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet OFDM/36Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class=paragraph><p>Ook kan gepoogd worden dit handmatig in te stellen door hetzelfde <span class=filename>/etc/wpa_supplicant.conf</span> als <a href=#network-wireless-wpa-wpa-psk>hierboven</a> te gebruiken, en dit te draaien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># wpa_supplicant -i wlan0 -c /etc/wpa_supplicant.conf</span>
Trying to associate with 00:11:95:c3:0d:ac <span class=o>(</span><span class=nv>SSID</span><span class=o>=</span><span class=s1>&#39;freebsdap&#39;</span> <span class=nv>freq</span><span class=o>=</span>2412 MHz<span class=o>)</span>
Associated with 00:11:95:c3:0d:ac
WPA: Key negotiation completed with 00:11:95:c3:0d:ac <span class=o>[</span><span class=nv>PTK</span><span class=o>=</span>CCMP <span class=nv>GTK</span><span class=o>=</span>CCMP]
CTRL-EVENT-CONNECTED - Connection to 00:11:95:c3:0d:ac completed <span class=o>(</span>auth<span class=o>)</span> <span class=o>[</span><span class=nb>id</span><span class=o>=</span>0 <span class=nv>idstr</span><span class=o>=]</span></code></pre></div></div><div class=paragraph><p>De volgende stap is het lanceren van het commando <code>dhclient</code> om een IP-adres van de DHCP-server te krijgen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dhclient wlan0</span>
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.1
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
<span class=c># ifconfig wlan0</span>
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet OFDM/36Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON defxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><span class=filename>/etc/rc.conf</span> heeft een regel <code>ifconfig_wlan0</code> met de tekst <code>DHCP</code> (zoals <code>ifconfig_wlan0="DHCP"</code>), <code>dhclient</code> zal automatisch gestart worden nadat <code>wpa_supplicant</code> geassocieerd is met het toegangspunt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als DHCP niet mogelijk of gewenst is, kan een statisch IP-adres worden ingesteld nadat <code>wpa_supplicant</code> het station heeft geauthenticeerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 inet 192.168.0.100 netmask 255.255.255.0</span>
<span class=c># ifconfig wlan0</span>
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.100 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet OFDM/36Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class=paragraph><p>Indien DHCP niet wordt gebruikt, dienen ook de standaard gateway en de naamserver handmatig ingesteld te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add default uw_standaard_router</span>
<span class=c># echo &#34;nameserver uw_DNS_server&#34; &gt;&gt; /etc/resolv.conf</span></code></pre></div></div></div><div class=sect6><h7 id=network-wireless-wpa-eap-tls>31.3.3.1.3.2. WPA met EAP-TLS<a class=anchor href=#network-wireless-wpa-eap-tls></a></h7><div class=paragraph><p>De tweede manier om WPA te gebruiken is met een achterliggende 802.1X-authenticatieserver. In dit geval wordt het WPA-Enterprise genoemd om het verschil met het minder veilige WPA-Personal met de vooraf gedeelde sleutel aan te duiden. Authenticatie is in WPA-Enterprise gebaseerd op EAP (Extensible Authentication Protocol).</p></div><div class=paragraph><p>EAP wordt niet met een encryptiemethode geleverd. In plaats daarvan was het besloten om EAP in een versleutelde tunnel te omsluiten. Er bestaan vele EAP-authenticatiemethodes, de meest voorkomende zijn EAP-TLS, EAP-TTLS, en EAP-PEAP.</p></div><div class=paragraph><p>EAP-TLS (EAP met Transport Layer Security) is een zeer goed ondersteund authenticatieprotocol in de draadloze wereld aangezien het de eerste EAP-methode was die gecertificeerd werd door de <a href=http://www.wi-fi.org>Wi-Fi alliantie</a>. EAP-TLS vereist dat er drie certificaten draaien: het CA-certificaat (geïnstalleerd op alle machines), het servercertificaat voor de authenticatieserver, en een cliëntcertificaat voor elke draadloze cliënt. Bij deze EAP-methode authenticeren zowel de authenticatieserver als de draadloze cliënt elkaar door hun respectievelijke certificaten te laten zien, en ze controleren dat deze certificaten zijn getekend door de certificatenauthoriteit (CA) van de organisatie.</p></div><div class=paragraph><p>Zoals voorheen gebeurt het instellen via <span class=filename>/etc/wpa_supplicant.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34; <i class=conum data-value=1></i><b>(1)</b>
  proto=RSN  <i class=conum data-value=2></i><b>(2)</b>
  key_mgmt=WPA-EAP <i class=conum data-value=3></i><b>(3)</b>
  eap=TLS <i class=conum data-value=4></i><b>(4)</b>
  identity=&#34;loader&#34; <i class=conum data-value=5></i><b>(5)</b>
  ca_cert=&#34;/etc/certs/cacert.pem&#34; <i class=conum data-value=6></i><b>(6)</b>
  client_cert=&#34;/etc/certs/clientcert.pem&#34; <i class=conum data-value=7></i><b>(7)</b>
  private_key=&#34;/etc/certs/clientkey.pem&#34; <i class=conum data-value=8></i><b>(8)</b>
  private_key_passwd=&#34;freebsdmallclient&#34; <i class=conum data-value=9></i><b>(9)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Dit veld geeft de naam van het netwerk (SSID) aan.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Hier wordt het RSN (IEEE® 802.11i) protocol gebruikt, ofwel WPA2.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>De regel <code>key_mgmt</code> verwijst naar het gebruikte sleutelbeheerprotocol. In dit geval is het WPA dat EAP-authenticatie gebruikt: <code>WPA-EAP</code>.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>In dit veld wordt de EAP-methode voor de verbinding genoemd.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Het veld <code>identity</code> bevat de identiteitsstring voor EAP.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Het veld <code>ca_cert</code> geeft de padnaam van het CA-certificaatbestand aan. Dit bestand is nodig om het servercertificaat te controleren.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>De regel <code>client_cert</code> geeft de padnaam van het cliëntcertificaatbestand aan. Dit certificaat is uniek voor elke draadloze cliënt van het netwerk.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>Het veld <code>private_key</code> is de padnaam naar het bestand dat de privésleutel van het cliëntcertificaat bevat.</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>Het veld <code>private_key_passwd</code> bevat het wachtwoord voor de privésleutel.</td></tr></tbody></table></div><div class=paragraph><p>Voeg vervolgens de volgende regels toe aan <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>De volgende stap is het activeren van de interface:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif start</span>
Starting wpa_supplicant.
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.20
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet DS/11Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class=paragraph><p>Zoals eerder is laten zien, is het ook mogelijk om de interface handmatig te activeren met zowel de commando’s <code>wpa_supplicant</code> en <code>ifconfig</code>.</p></div></div><div class=sect6><h7 id=network-wireless-wpa-eap-ttls>31.3.3.1.3.3. WPA met EAP-TTLS<a class=anchor href=#network-wireless-wpa-eap-ttls></a></h7><div class=paragraph><p>Bij EAP-TLS hebben zowel de authenticatieserver als de cliënt een certificaat nodig, met EAP-TTLS (EAP-Tunneled Transport Layer Security) is een cliëntcertificaat optioneel. Deze methode komt in de buurt van wat sommige beveiligde websites doen, waar de webserver een veilige SSL-tunnel kan aanmaken zelfs als de bezoekers geen certificaten aan de cliëntkant hebben. EAP-TTLS zal de versleutelde TLS-tunnel gebruiken voor het veilig transporteren van de authenticatiegegevens.</p></div><div class=paragraph><p>De instellingen worden gedaan via het bestand <span class=filename>/etc/wpa_supplicant.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34;
  proto=RSN
  key_mgmt=WPA-EAP
  eap=TTLS <i class=conum data-value=1></i><b>(1)</b>
  identity=&#34;test&#34; <i class=conum data-value=2></i><b>(2)</b>
  password=&#34;test&#34; <i class=conum data-value=3></i><b>(3)</b>
  ca_cert=&#34;/etc/certs/cacert.pem&#34; <i class=conum data-value=4></i><b>(4)</b>
  phase2=&#34;auth=MD5&#34; <i class=conum data-value=5></i><b>(5)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Dit veld noemt de EAP-methode voor de verbinding.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Het veld <code>identity</code> bevat de identiteitsstring voor EAP-authenticatie binnen de versleutelde TLS-tunnel.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Het veld <code>password</code> bevat het wachtwoord voor de EAP-authenticatie.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Het veld <code>ca_cert</code> wijst naar de padnaam van het CA-certificaatbestand. Dit bestand is nodig om het servercertificaat te controleren.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Dit veld noemt de gebruikte authenticatiemethode in de versleutelde TLS-tunnel. In dit geval is EAP met MD5-Challenge gebruikt. De "binnenste authenticatie"-fase wordt vaak "phase2" genoemd.</td></tr></tbody></table></div><div class=paragraph><p>Ook dienen de volgende regels toegevoegd te worden aan <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_ath0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>De volgende stap is het activeren van de interface:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif start</span>
Starting wpa_supplicant.
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 7
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 15
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 21
DHCPACK from 192.168.0.20
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet autoselect DS/11Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div></div><div class=sect6><h7 id=network-wireless-wpa-eap-peap>31.3.3.1.3.4. WPA met EAP-PEAP<a class=anchor href=#network-wireless-wpa-eap-peap></a></h7><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>PEAPv0/EAP-MSCHAPv2 is de meest gebruikelijke PEAP-methode. In de rest van dit document wordt de term PEAP gebruikt om naar die methode te verwijzen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>PEAP (Beveiligd EAP) is ontworpen als een alternatief voor EAP-TTLS, en is de meest gebruikte EAP-standaard na EAP-TLS. Met andere woorden, als u een netwerk met verschillende besturingssystemen heeft, zou PEAP de meest ondersteunde standaard moeten zijn na EAP-TLS.</p></div><div class=paragraph><p>PEAP is soortgelijk aan EAP-TTLS: het gebruikt een server-side certificaat om de cliënten te authenticeren door een beveiligde TLS-tunnel tussen de cliënt en de authenticatieserver aan te maken, welke de uitwisseling van de authenticatie-informatie beschermt. Vanuit een beveiligingsoogpunt gezien is het verschil tussen EAP-TTLS en PEAP dat PEAP-authenticatie de gebruikersnaam onversleuteld uitzendt, alleen het wachtwoord wordt in de beveiligde TLS-tunnel verzonden. EAP-TTLS gebruikt de TLS-tunnel voor zowel de gebruikersnaam als het wachtwoord.</p></div><div class=paragraph><p>Het bestand <span class=filename>/etc/wpa_supplicant.conf</span> dient gewijzigd te worden om de EAP-PEAP-gerelateerde instellingen toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34;
  proto=RSN
  key_mgmt=WPA-EAP
  eap=PEAP <i class=conum data-value=1></i><b>(1)</b>
  identity=&#34;test&#34; <i class=conum data-value=2></i><b>(2)</b>
  password=&#34;test&#34; <i class=conum data-value=3></i><b>(3)</b>
  ca_cert=&#34;/etc/certs/cacert.pem&#34; <i class=conum data-value=4></i><b>(4)</b>
  phase1=&#34;peaplabel=0&#34; <i class=conum data-value=5></i><b>(5)</b>
  phase2=&#34;auth=MSCHAPV2&#34; <i class=conum data-value=6></i><b>(6)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Dit veld noemt de EAP-methode voor de verbinding.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Het veld <code>identity</code> bevat de identiteitsstring voor EAP-authenticatie binnen de versleutelde TLS-tunnel.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Het veld <code>password</code> bevat het wachtwoord voor de EAP-authenticatie.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Het veld <code>ca_cert</code> wijst naar de padnaam van het CA-certificaatbestand. Dit bestand is nodig om het servercertificaat te controleren.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Dit veld bevat de parameters voor de eerste fase van authenticatie (de TLS-tunnel). Afhankelijk van de gebruikte authenticatieserver moet er een specifiek label voor authenticatie worden opgegeven. In de meeste gevallen zal het label "client EAP encryption" zijn welke ingesteld is door <code>peaplabel=0</code> te gebruiken. Meer informatie kan in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant.conf&amp;sektion=5&amp;format=html">wpa_supplicant.conf(5)</a> gevonden worden.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Dit veld noemt het authenticatieprotocol dat in de versleutelde TLS-tunnel gebruikt wordt. In het geval van PEAP is dit <code>auth=MSCHAPV2</code>.</td></tr></tbody></table></div><div class=paragraph><p>Het volgende dient te worden toegevoegd aan <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>Hierna kan de interface worden geactiveerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif start</span>
Starting wpa_supplicant.
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 7
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 15
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 21
DHCPACK from 192.168.0.20
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet autoselect DS/11Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div></div></div><div class=sect5><h6 id=network-wireless-wep>31.3.3.1.4. WEP<a class=anchor href=#network-wireless-wep></a></h6><div class=paragraph><p>WEP (Wired Equivalent Privacy) maakt deel uit van de oorspronkelijke 802.11 standaard. Er is geen authenticatiemechanisme, slechts een zwakke vorm van toegangscontrole, en het is gemakkelijk te kraken.</p></div><div class=paragraph><p>WEP kan worden opgezet met <code>ifconfig</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 inet 192.168.1.100 netmask 255.255.255.0 \</span>
	    ssid mijn_net wepmode on weptxkey 3 wepkey 3:0x3456789012</code></pre></div></div><div class=ulist><ul><li><p>De <code>weptxkey</code> geeft aan welke WEP-sleutel zal worden gebruikt tijdens het verzenden. Hier wordt de derde sleutel gebruikt. Dit dient overeen te komen met de instelling in het toegangspunt. Probeer, indien onbekend is welke sleutel door het toegangspunt wordt gebruikt, <code>1</code> (i.e., de eerste sleutel) voor deze waarde te gebruiken.</p></li><li><p>De <code>wepkey</code> selecteert één van de WEP-sleutels in. Het dient in het formaat <em>index:sleutel</em> te zijn. Sleutel <code>1</code> wordt als standaard gebruikt; de index hoeft alleen ingesteld te worden als we een andere dan de eerste sleutel gebruiken.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De <code>0x3456789012</code> dient vervangen te worden door de sleutel die ingesteld is voor gebruik met het toegangspunt.</p></div></td></tr></tbody></table></div></li></ul></div><div class=paragraph><p>Het wordt aangeraden om de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> te lezen voor verdere informatie.</p></div><div class=paragraph><p>De faciliteit <code>wpa_supplicant</code> kan ook gebruikt worden om de draadloze interface in te stellen voor WEP. Het bovenstaande voorbeeld kan worden ingesteld door de volgende regels toe te voegen aan <span class=filename>/etc/wpa_supplicant.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;mijn_net&#34;
  key_mgmt=NONE
  wep_key3=3456789012
  wep_tx_keyidx=3
}</pre></div></div><div class=paragraph><p>Daarna:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># wpa_supplicant -i wlan0 -c /etc/wpa_supplicant.conf</span>
Trying to associate with 00:13:46:49:41:76 <span class=o>(</span><span class=nv>SSID</span><span class=o>=</span><span class=s1>&#39;dlinkap&#39;</span> <span class=nv>freq</span><span class=o>=</span>2437 MHz<span class=o>)</span>
Associated with 00:13:46:49:41:76</code></pre></div></div></div></div></div><div class=sect3><h4 id=_ad_hoc_modus>31.3.4. Ad-hoc-modus<a class=anchor href=#_ad_hoc_modus></a></h4><div class=paragraph><p>IBSS-modus, ook ad-hoc-modus genoemd, is ontworpen voor point-to-point-verbindingen. Om bijvoorbeeld een ad-hoc-netwerk tussen de machine <code>A</code> en de machine <code>B</code> op te zetten, is het slechts nodig om twee IP-adressen en een SSID te kiezen.</p></div><div class=paragraph><p>Op machine <code>A</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode adhoc</span>
<span class=c># ifconfig wlan0 inet 192.168.0.1 netmask 255.255.255.0 ssid freebsdap</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:c3:0d:ac
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;adhoc&gt;
	  status: running
	  ssid freebsdap channel 2 <span class=o>(</span>2417 Mhz 11g<span class=o>)</span> bssid 02:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 scanvalid 60
	  protmode CTS wme burst</code></pre></div></div><div class=paragraph><p>De parameter <code>adhoc</code> geeft aan dat de interface in de IBSS-modus draait.</p></div><div class=paragraph><p>Op <code>B</code> zal het mogelijk moeten zijn om <code>A</code> te detecteren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode adhoc</span>
<span class=c># ifconfig wlan0 up scan</span>
  SSID/MESH ID    BSSID              CHAN RATE   S:N     INT CAPS
  reebsdap       02:11:95:c3:0d:ac    2   54M <span class=nt>-64</span>:-96  100 IS   WME</code></pre></div></div><div class=paragraph><p>De <code>I</code> in de uitvoer bevestigt dat machine <code>A</code> in ad-hoc-modus verkeert. Het is slechts nodig om <code>B</code> met een ander IP-adres in te stellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 inet 192.168.0.2 netmask 255.255.255.0 ssid freebsdap</span>
<span class=c># ifconfig wlan0 ssid freebsdap mediaopt adhoc inet 192.168.0.2 netmask 255.255.255.0</span>
<span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:d5:43:62
	  inet 192.168.0.2 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;adhoc&gt;
	  status: running
	  ssid freebsdap channel 2 <span class=o>(</span>2417 Mhz 11g<span class=o>)</span> bssid 02:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 scanvalid 60
	  protmode CTS wme burst</code></pre></div></div><div class=paragraph><p>Zowel <code>A</code> als <code>B</code> zijn nu klaar om informatie uit te wisselen.</p></div></div><div class=sect3><h4 id=network-wireless-ap>31.3.5. FreeBSD Host Toegangspunten<a class=anchor href=#network-wireless-ap></a></h4><div class=paragraph><p>FreeBSD kan als toegangspunt (AP) functioneren wat de noodzaak om een hardwarematig AP te kopen of een ad-hoc-netwerk te draaien wegneemt. Dit kan bijzonder nuttig zijn indien de FreeBSD-machine als gateway naar een ander netwerk (bijvoorbeeld het Internet) functioneert.</p></div><div class=sect4><h5 id=network-wireless-ap-basic>31.3.5.1. Basisinstellingen<a class=anchor href=#network-wireless-ap-basic></a></h5><div class=paragraph><p>Voordat de FreeBSD-machine als een AP wordt ingesteld, dient de kernel te worden ingesteld met de juiste ondersteuning voor draadloos netwerken voor de draadloze kaart. Ook dient er ondersteuning voor de te gebruiken beveiligingsprotocollen te worden toegevoegd. Meer details staan in <a href=#network-wireless-basic>Basisinstallatie</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Momenteel staan de NDIS-stuurprogrammawrapper en de stuurprogramma’s van Windows® het werken als AP niet toe. Alleen originele draadloze FreeBSD-stuurprogramma’s ondersteunen AP-modus.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Wanneer de ondersteuning voor draadloos netwerken is geladen, kan gecontroleerd worden of het draadloze apparaat de hostgebaseerde toegangspuntmodus ondersteunt (ook bekend als hostap-modus):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 list caps</span>
<span class=nv>drivercaps</span><span class=o>=</span>6f85edc1&lt;STA,FF,TURBOP,IBSS,HOSTAP,AHDEMO,TXPMGT,SHSLOT,SHPREAMBLE,MONITOR,MBSS,WPA1,WPA2,BURST,WME,WDS,BGSCAN,TXFRAG&gt;
<span class=nv>cryptocaps</span><span class=o>=</span>1f&lt;WEP,TKIP,AES,AES_CCM,TKIPMIC&gt;</code></pre></div></div><div class=paragraph><p>Deze uitvoer geeft de mogelijkheden van de kaart weer, het woord <code>HOSTAP</code> bevestigt dat deze draadloze kaart als toegangspunt kan functioneren. Ook worden verschillende ondersteunde versleutelmethoden genoemd: WEP, TKIP, AES, enzovoorts. Deze informatie is belangrijk om te weten welke beveiligingsprotocollen gebruikt kunnen worden op het toegangspunt.</p></div><div class=paragraph><p>Het draadloze apparaat kan enkel in hostap-modus worden gezet tijdens het creeëren van het netwerk pseudo-device dus een vooraf aangemaakt apparaat moet eerst verwijderd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 destroy</span></code></pre></div></div><div class=paragraph><p>waarna deze opnieuw aangemaakt kan worden met de juiste parameters:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode hostap</span>
<span class=c># ifconfig wlan0 inet 192.168.0.1 netmask 255.255.255.0 ssid freebsdap mode 11g channel 1</span></code></pre></div></div><div class=paragraph><p>Gebruik nogmaals <code>ifconfig</code> om de status van de interface <span class=filename>wlan0</span> te zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:c3:0d:ac
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	  status: running
	  ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 scanvalid 60
	  protmode CTS wme burst dtimperiod 1 <span class=nt>-dfs</span></code></pre></div></div><div class=paragraph><p>De parameter <code>hostap</code> geeft aan dat de interface in hostgebaseerde toegangspuntmodus draait.</p></div><div class=paragraph><p>Het instellen van de interface kan automatisch tijdens het opstarten gedaan worden door de volgende regels aan <span class=filename>/etc/rc.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
create_args_wlan0=&#34;wlanmode hostap&#34;
ifconfig_wlan0=&#34;inet 192.168.0.1 netmask 255.255.255.0 ssid freebsdap mode 11g channel 1&#34;</pre></div></div></div><div class=sect4><h5 id=_hostgebaseerde_toegangspunt_zonder_authenticatie_of_versleuteling>31.3.5.2. Hostgebaseerde toegangspunt zonder authenticatie of versleuteling<a class=anchor href=#_hostgebaseerde_toegangspunt_zonder_authenticatie_of_versleuteling></a></h5><div class=paragraph><p>Hoewel het niet aangeraden wordt om een AP zonder enige vorm van authenticatie of encryptie te draaien, is dit een eenvoudige manier om te controleren of het AP werkt. Deze configuratie is ook belangrijk voor het debuggen van problemen met cliënten.</p></div><div class=paragraph><p>Nadat het AP is ingesteld als eerder is laten zien, is het mogelijk om van een andere draadloze machine een scan te beginnen om het AP te vinden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 up scan</span>
SSID/MESH ID    BSSID              CHAN RATE   S:N     INT CAPS
freebsdap       00:11:95:c3:0d:ac    1   54M <span class=nt>-66</span>:-96  100 ES   WME</code></pre></div></div><div class=paragraph><p>De cliëntmachine heeft het AP gevonden en kan ermee geassocieerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig ath0 ssid freebsdap inet 192.168.0.2 netmask 255.255.255.0</span>
  ifconfig wlan0
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:d5:43:62
	  inet 192.168.0.2 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet OFDM/54Mbps mode 11g
	  status: associated
	  ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 bmiss 7
	  scanvalid 60 bgscan bgscanintvl 300 bgscanidle 250 roam:rssi 7
	  roam:rate 5 protmode CTS wme burst</code></pre></div></div></div><div class=sect4><h5 id=_wpa_hostgebaseerde_toegangspunt>31.3.5.3. WPA hostgebaseerde toegangspunt<a class=anchor href=#_wpa_hostgebaseerde_toegangspunt></a></h5><div class=paragraph><p>Deze sectie zal zich richten op opzetten van een FreeBSD toegangspunt dat het beveiligingsprotocol WPA gebruikt. Meer details over WPA en het instellen van op WPA gebaseerde draadloze cliënten kan gevonden worden in <a href=#network-wireless-wpa>WPA</a>.</p></div><div class=paragraph><p>De daemon hostapd wordt gebruikt om cliëntauthenticatie en sleutelbeheer op het toegangspunt met WPA af te handelen.</p></div><div class=paragraph><p>In het volgende zullen alle instellingsbewerkingen worden uitgevoerd op de FreeBSD-machine die als AP dienst doet. Wanneer het AP correct werkt, zou hostapd automatisch tijdens het opstarten aangezet moeten worden met de volgende regel in <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hostapd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Zorg ervoor dat voordat geprobeerd wordt om hostapd in te stellen, de basisinstellingen die in <a href=#network-wireless-ap-basic>Basisinstellingen</a> zijn geïntroduceerd zijn uitgevoerd.</p></div><div class=sect5><h6 id=_wpa_psk>31.3.5.3.1. WPA-PSK<a class=anchor href=#_wpa_psk></a></h6><div class=paragraph><p>WPA-PSK is bedoeld voor kleine netwerken waar het gebruik van een achterliggende authenticatieserver niet mogelijk of gewenst is.</p></div><div class=paragraph><p>Het instellen wordt gedaan in het bestand <span class=filename>/etc/hostapd.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>interface=wlan0 <i class=conum data-value=1></i><b>(1)</b>
debug=1 <i class=conum data-value=2></i><b>(2)</b>
ctrl_interface=/var/run/hostapd <i class=conum data-value=3></i><b>(3)</b>
ctrl_interface_group=wheel <i class=conum data-value=4></i><b>(4)</b>
ssid=freebsdap <i class=conum data-value=5></i><b>(5)</b>
wpa=1 <i class=conum data-value=6></i><b>(6)</b>
wpa_passphrase=freebsdmall <i class=conum data-value=7></i><b>(7)</b>
wpa_key_mgmt=WPA-PSK <i class=conum data-value=8></i><b>(8)</b>
wpa_pairwise=CCMP TKIP <i class=conum data-value=9></i><b>(9)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Dit veld geeft aan welke draadloze interface voor het toegangspunt wordt gebruikt.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Dit veld stelt het verbositeitsniveau in dat tijdens het draaien van hostapd wordt gebruikt. Een waarde van <code>1</code> vertegenwoordigt het minimale niveau.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Het veld <code>ctrl_interface</code> geeft de padnaam van de door hostapd gebruikte map om de domeinsocketbestanden voor communicatie met externe programma’s zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=hostapd_cli&amp;sektion=8&amp;format=html">hostapd_cli(8)</a> in op te slaan. Hier wordt de standaardwaarde gebruikt.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>De regel <code>ctrl_interface_group</code> stelt de groep in (hier is het de groep <code>wheel</code>) die toegang heeft tot de controle interfacebestanden.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Het veld <code>wpa</code> maakt WPA mogelijk en specificeert welk WPA-authenticatieprotocol nodig zal zijn. De waarde <code>1</code> stelt het AP in op WPA-PSK.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Het veld <code>wpa_passphrase</code> bevat het ASCII-wachtwoord voor de WPA-authenticatie.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>De regel <code>wpa_key_mgmt</code> verwijst naar het gebruikte sleutelbeheerprotocol. In dit geval is dat WPA-PSK.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>Het veld <code>wpa_pairwise</code> geeft aan welke versleutelingsalgoritmes door het toegangspunt worden geaccepteerd. Hier worden zowel de versleuteling TKIP (WPA) en CCMP (WPA2) geaccepteerd. De versleuteling CCMP is een alternatief voor TKIP en wordt sterk aangeraden indien mogelijk; TKIP dient alleen gebruikt te worden voor stations die geen CCMP aankunnen.</td></tr></tbody></table></div><div class=paragraph><p>De volgende stap is het starten van hostapd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service hostapd forcestart</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 2290
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255dddd
	  inet6 fe80::211:95ff:fec3:dac%ath0 prefixlen 64 scopeid 0x4
	  ether 00:11:95:c3:0d:ac
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;hostap&gt;
	  status: associated
	  ssid freebsdap channel 1 bssid 00:11:95:c3:0d:ac
	  authmode WPA2/802.11i privacy MIXED deftxkey 2 TKIP 2:128-bit txpowmax 36 protmode CTS dtimperiod 1 bintval 100</code></pre></div></div><div class=paragraph><p>Het toegangspunt draait nu, de cliënten kunnen er nu mee worden geassocieerd, zie <a href=#network-wireless-wpa>WPA</a> voor meer details. Het is mogelijk om de stations die met het AP geassocieerd zijn te zien door het commando <code>ifconfig wlan0 list</code> te gebruiken.</p></div></div></div><div class=sect4><h5 id=_wep_hostgebaseerd_toegangspunt>31.3.5.4. WEP hostgebaseerd toegangspunt<a class=anchor href=#_wep_hostgebaseerd_toegangspunt></a></h5><div class=paragraph><p>Het wordt niet aangeraden om WEP te gebruiken om een toegangspunt op te zetten aangezien er geen authenticatiemechanisme is en het gemakkelijk is te kraken. Sommige verouderde draadloze kaarten ondersteunen alleen WEP als een beveiligingsprotocol, met deze kaarten is het alleen mogelijk om een AP zonder authenticatie of encryptie of een AP dat het WEP-protocol gebruikt op te zetten.</p></div><div class=paragraph><p>Het draadloze apparaat kan nu in hostap-modus worden gezet en ingesteld worden met het juiste SSID en IP-adres:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode hostap</span>
<span class=c># ifconfig wlan0 inet 192.168.0.1 netmask 255.255.255.0 \</span>
  ssid freebsdap wepmode on weptxkey 3 wepkey 3:0x3456789012 mode 11g</code></pre></div></div><div class=ulist><ul><li><p>Het <code>weptxkey</code> geeft aan welke WEP-sleutel tijdens het zenden zal worden gebruikt. Hier wordt de derde sleutel gebruikt (merk op dat de nummering van de sleutels bij <code>1</code> begint). Deze parameter moet gespecificeerd worden om de gegevens daadwerkelijk te versleutelen.</p></li><li><p>Het <code>wepkey</code> geeft aan dat de geselecteerde WEP-sleutel wordt ingesteld. Het dient in het formaat <em>index:key</em> te zijn, indien de index niet is gegeven, wordt sleutel <code>1</code> gebruikt. Dus indien een andere sleutel dan de eerste wordt gebruikt dient de index te worden ingesteld.</p></li></ul></div><div class=paragraph><p>Weer wordt <code>ifconfig</code> gebruikt om de status van de interface <span class=filename>wlan0</span> te zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:c3:0d:ac
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;hostap&gt;
	  status: running
	  ssid freebsdap channel 4 <span class=o>(</span>2427 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy ON deftxkey 3 wepkey 3:40-bit
	  txpower 21.5 scanvalid 60 protmode CTS wme burst dtimperiod 1 <span class=nt>-dfs</span></code></pre></div></div><div class=paragraph><p>Vanaf een andere draadloze machine is het mogelijk om een scan te beginnen om het AP te vinden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 up scan</span>
SSID            BSSID              CHAN RATE  S:N   INT CAPS
freebsdap       00:11:95:c3:0d:ac    1   54M 22:1   100 EPS</code></pre></div></div><div class=paragraph><p>De cliëntmachine heeft het toegangspunt gevonden en kan ermee geassocieerd worden door de juiste parameters (sleutel, enz.) te gebruiken, zie <a href=#network-wireless-wep>WEP</a> voor meer details.</p></div></div></div><div class=sect3><h4 id=_zowel_de_bekabelde_als_de_draadloze_verbinding_gebruiken>31.3.6. Zowel de bekabelde als de draadloze verbinding gebruiken<a class=anchor href=#_zowel_de_bekabelde_als_de_draadloze_verbinding_gebruiken></a></h4><div class=paragraph><p>Een bekabelde verbinding biedt betere prestaties en betrouwbaarheid, terwijl een draadloze verbinding meer flexibiliteit en mobiliteit biedt; laptop-gebruikers zullen dit willen combineren en naadloos tussen de twee overschakelen.</p></div><div class=paragraph><p>In FreeBSD is het mogelijk om twee of meer netwerkinterfaces te combineren in een "failover"-opstelling, dit houdt in dat de meest geprefereerde en best beschikbare verbinding van een groep van netwerkinterfaces wordt gebruikt, en het besturingssysteem automatisch te laten overschakelen wanneer de status van de verbinding verandert.</p></div><div class=paragraph><p>Link-aggregatie en failover worden behandeld in <a href=#network-aggregation>Verbindingsaggregatie en failover</a>, een voorbeeld voor het gebruik van zowel een bekabelde als een draadloze verbinding wordt gegeven in <a href=#networking-lagg-wired-and-wireless>Failover-modus tussen bekabelde en draadloze interfaces</a>.</p></div></div><div class=sect3><h4 id=_problemen_verhelpen>31.3.7. Problemen verhelpen<a class=anchor href=#_problemen_verhelpen></a></h4><div class=paragraph><p>Indien er problemen met het draadloos netwerk zijn, zijn er een aantal stappen die genomen kunnen worden om het probleem te helpen verhelpen.</p></div><div class=ulist><ul><li><p>Indien het toegangspunt niet vermeld wordt tijdens het scannen, controleer dan of het draadloze apparaat niet is ingesteld op een beperkt aantal kanalen.</p></li><li><p>Indien het niet mogelijk is om met een toegangspunt te associëren, controleer dan of de instellingen van het station overeenkomen met die van het toegangspunt. Dit omvat het authenticatieschema en de beveiligingsprotocollen. Versimpel de configuratie zoveel mogelijk. Indien een beveiligingsprotocol als WPA of WEP wordt gebruikt, stel het toegangspunt dan in voor open authenticatie en geen beveiliging en kijk of er verkeer door kan.</p></li><li><p>Wanneer er met het toegangspunt geassocieerd kan worden, stel dan een diagnose over alle beveiligingsinstellingen met eenvoudige gereedschappen zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a>.</p><div class=paragraph><p><code>wpa_supplicant</code> biedt veel ondersteuning voor debuggen; probeer het handmatig te draaien met de optie <code>-dd</code> en controleer de systeemlogs.</p></div></li><li><p>Er zijn ook veel debug-gereedschappen op lagere niveaus. Het is mogelijk om debugberichten in de laag die het 802.11 protocol ondersteunt aan te zetten door het programma <code>wlandebug</code> te gebruiken dat gevonden wordt in <span class=filename>/usr/src/tools/tools/net80211</span>. Bijvoorbeeld:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># wlandebug -i ath0 +scan+auth+debug+assoc</span>
  net.wlan.0.debug: 0 <span class=o>=&gt;</span> 0xc80000&lt;assoc,auth,scan&gt;</code></pre></div></div><div class=paragraph><p>kan worden gebruikt om consoleberichten aan te zetten die te maken hebben met het scannen van toegangspunten en het uitvoeren van 802.11 handshakes die nodig zijn om communicatie te regelen.</p></div><div class=paragraph><p>Er worden ook veel nuttige statistieken door de 802.11 laag bijgehouden; het gereedschap <code>wlanstats</code> geeft deze informatie weer. Deze statistieken zouden alle fouten die door de 802.11 laag zijn geïdentificeerd moeten identificeren. Let erop dat sommige fouten worden geïdentificeerd in de apparaatstuurprogramma’s die onder de 802.11 laag liggen zodat ze niet verschijnen. Voor het diagnosticeren van apparaatspecifieke problemen dient de documentatie van het stuurprogramma geraadpleegd te worden.</p></div></li></ul></div><div class=paragraph><p>Indien de bovenstaande informatie niet helpt om het probleem te verhelderen, stuur dan een probleemrapport op inclusief de uitvoer van de bovenstaande gereedschappen.</p></div></div></div><div class=sect2><h3 id=network-bluetooth>31.4. Bluetooth<a class=anchor href=#network-bluetooth></a></h3><div class=sect3><h4 id=_introductie>31.4.1. Introductie<a class=anchor href=#_introductie></a></h4><div class=paragraph><p>Bluetooth is een draadloze technologie om persoonlijke netwerken aan te maken die in de vrije 2,4GHz-band werken binnen een straal van 10 meter. Deze netwerken worden gewoonlijk ad-hoc gevormd en bestaan uit draagbare apparaten zoals mobiele telefoons, handhelds en laptops. In tegenstelling tot die andere populaire draadloze techniek, Wi-Fi, biedt Bluetooth een hoger niveau van serviceprofielen, zoals FTP-achtige bestandsservers, pushing van bestanden, stemtransport, emulatie van seriële lijnen, en meer.</p></div><div class=paragraph><p>De Bluetooth stack is in FreeBSD geïmplementeerd door gebruik te maken van het Netgraph-raamwerk (zie <a href="https://man.freebsd.org/cgi/man.cgi?query=netgraph&amp;sektion=4&amp;format=html">netgraph(4)</a>). Veel van de Bluetooth USB-dongles worden ondersteund door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_ubt&amp;sektion=4&amp;format=html">ng_ubt(4)</a>. Apparaten gebaseerd op de Broadcom BCM2033 chip worden ondersteund door de stuurprogramma’s <a href="https://man.freebsd.org/cgi/man.cgi?query=ubtbcmfw&amp;sektion=4&amp;format=html">ubtbcmfw(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_ubt&amp;sektion=4&amp;format=html">ng_ubt(4)</a>. De 3Com Bluetooth PC Card 3CRWB60-A wordt ondersteund door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_bt3c&amp;sektion=4&amp;format=html">ng_bt3c(4)</a>. Seriële en op UART gebaseerde Bluetooth-apparaten worden ondersteund via <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_h4&amp;sektion=4&amp;format=html">ng_h4(4)</a>, en <a href="https://man.freebsd.org/cgi/man.cgi?query=hcseriald&amp;sektion=8&amp;format=html">hcseriald(8)</a>. Deze sectie beschrijft het gebruik van de USB Bluetooth-dongle.</p></div></div><div class=sect3><h4 id=_het_apparaat_inprikken>31.4.2. Het apparaat inprikken<a class=anchor href=#_het_apparaat_inprikken></a></h4><div class=paragraph><p>Standaard zijn stuurprogramma’s voor Bluetooth-apparaten beschikbaar als kernelmodules. Voordat een apparaat wordt aangekoppeld, dient het stuurprogramma in de kernel geladen te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload ng_ubt</span></code></pre></div></div><div class=paragraph><p>Indien het Bluetooth-apparaat tijdens het opstarten van het systeem in het systeem aanwezig is, kan de module vanuit <span class=filename>/boot/loader.conf</span> geladen worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ng_ubt_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Prik de USB-dongle in. Uitvoer vergelijkbaar aan de onderstaande zal op de console (of in syslog) verschijnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ubt0: vendor 0x0a12 product 0x0001, rev 1.10/5.25, addr 2
ubt0: Interface 0 endpoints: <span class=nv>interrupt</span><span class=o>=</span>0x81, bulk-in<span class=o>=</span>0x82, bulk-out<span class=o>=</span>0x2
ubt0: Interface 1 <span class=o>(</span>alt.config 5<span class=o>)</span> endpoints: isoc-in<span class=o>=</span>0x83, isoc-out<span class=o>=</span>0x3,
      <span class=nv>wMaxPacketSize</span><span class=o>=</span>49, <span class=nv>nframes</span><span class=o>=</span>6, buffer <span class=nv>size</span><span class=o>=</span>294</code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a> wordt gebruikt om de Bluetooth-stack te starten en te stoppen. Het is een goed idee om de stack te stoppen voordat het apparaat wordt losgekoppeld, maar het is (gewoonlijk) niet fataal. Tijdens het starten van de stack verschijnt er uitvoer vergelijkbaar met de onderstaande:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service bluetooth start ubt0</span>
BD_ADDR: 00:02:72:00:d4:1a
Features: 0xff 0xff 0xf 00 00 00 00 00
&lt;3-Slot&gt; &lt;5-Slot&gt; &lt;Encryption&gt; &lt;Slot offset&gt;
&lt;Timing accuracy&gt; &lt;Switch&gt; &lt;Hold mode&gt; &lt;Sniff mode&gt;
&lt;Park mode&gt; &lt;RSSI&gt; &lt;Channel quality&gt; &lt;SCO <span class=nb>link</span><span class=o>&gt;</span>
&lt;HV2 packets&gt; &lt;HV3 packets&gt; &lt;u-law log&gt; &lt;A-law log&gt; &lt;CVSD&gt;
&lt;Paging scheme&gt; &lt;Power control&gt; &lt;Transparent SCO data&gt;
Max. ACL packet size: 192 bytes
Number of ACL packets: 8
Max. SCO packet size: 64 bytes
Number of SCO packets: 8</code></pre></div></div></div><div class=sect3><h4 id=_host_controller_interface_hci>31.4.3. Host Controller Interface (HCI)<a class=anchor href=#_host_controller_interface_hci></a></h4><div class=paragraph><p>Het Host Controller Interface (HCI) biedt een opdrachtinterface naar de controller van de basisband en de verbindingsbeheerder, en toegang tot hardwarestatus en controleregisters. Deze interface biedt een uniforme manier om de mogelijkheden van de basisband van Bluetooth te benaderen. De HCI-laag op de gastheer wisselt gegevens en opdrachten uit met de HCI-firmware in de Bluetooth-hardware. Het stuurprogramma voor de Host Controller Transport Layer (i.e., de fysieke bus) biedt aan beide HCI-lagen de mogelijkheid om informatie met elkaar uit te wisselen.</p></div><div class=paragraph><p>Voor een enkel Bluetooth-apparaat wordt een enkele Netgraph knoop van het type <em>hci</em> aangemaakt. De HCI-knoop is normaliter verbonden met de knoop van het Bluetooth-apparaatstuurprogramma (naar beneden toe) en de L2CAP-knoop (naar boven toe). Alle HCI-bewerkingen dienen te worden uitgevoerd op de HCI-knoop en niet op de knoop van het apparaatstuurprogramma. De standaardnaam voor de HCI-knoop is "devicehci". Kijk voor meer details in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_hci&amp;sektion=4&amp;format=html">ng_hci(4)</a>.</p></div><div class=paragraph><p>Eén van de meest voorkomende taken is het ontdekken van Bluetooth-apparaten binnen radiobereik. Deze bewerking wordt <em>ondervragen</em> genoemd. Ondervragen en andere HCI-gerelateerde bewerkingen worden uitgevoerd met het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=hccontrol&amp;sektion=8&amp;format=html">hccontrol(8)</a>. Het onderstaande voorbeeld laat zien hoe kan worden uitgezocht welke Bluetooth-apparaten zich binnen het bereik bevinden. De lijst met apparaten zou binnen enkele seconden moeten binnenkomen. Bedenk dat een apparaat op afstand alleen antwoord op de ondervraging zal geven indien het in <em>ontdekbare</em> modus staat.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% hccontrol <span class=nt>-n</span> ubt0hci inquiry
Inquiry result, <span class=nv>num_responses</span><span class=o>=</span>1
Inquiry result <span class=c>#0</span>
       BD_ADDR: 00:80:37:29:19:a4
       Page Scan Rep. Mode: 0x1
       Page Scan Period Mode: 00
       Page Scan Mode: 00
       Class: 52:02:04
       Clock offset: 0x78ef
Inquiry complete. Status: No error <span class=o>[</span>00]</code></pre></div></div><div class=paragraph><p><code>BD_ADDR</code> is een uniek adres van een Bluetooth-apparaat, vergelijkbaar met een MAC-adres van een netwerkkaart. Dit adres is nodig voor verdere communicatie met een apparaat. Het is mogelijk om een menselijk leesbare naam aan een BD_ADDR toe te kennen. Het bestand <span class=filename>/etc/bluetooth/hosts</span> bevat informatie over de bekende Bluetooth-gastheren. Het volgende voorbeeld laat zien hoe de menselijk leesbare naam dat aan het apparaat op afstand was toegekend te verkrijgen is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% hccontrol <span class=nt>-n</span> ubt0hci remote_name_request 00:80:37:29:19:a4
BD_ADDR: 00:80:37:29:19:a4
Name: Pav<span class=s1>&#39;s T39</span></code></pre></div></div><div class=paragraph><p>Tijdens het uitvoeren van een ondervraging op een Bluetooth-apparaat op afstand zal het de computer als "uw.gastheer.naam (ubt0)" vinden. De naam die aan het lokale apparaat is toegekend, kan altijd gewijzigd worden.</p></div><div class=paragraph><p>Het Bluetooth-systeem biedt een punt-naar-punt-verbinding (slechts twee Bluetooth-eenheden betrokken), of een punt-naar-veelpunt-verbinding. Bij een punt-naar-veelpunt-verbinding wordt de verbinding met meerdere Bluetooth-apparaten gedeeld. Het volgende voorbeeld laat zien hoe de lijst met actieve basisbandverbindingen voor het lokale apparaat te verkrijgen is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% hccontrol <span class=nt>-n</span> ubt0hci read_connection_list
Remote BD_ADDR    Handle Type Mode Role Encrypt Pending Queue State
00:80:37:29:19:a4     41  ACL    0 MAST    NONE       0     0 OPEN</code></pre></div></div><div class=paragraph><p>Een <em>verbindingshandvat</em> is nuttig indien het beëindigen van de basisbandverbinding noodzakelijk is. Normaalgesproken is het niet nodig om dit handmatig te doen. De stack zal automatisch niet-actieve basisbandverbindingen beëindigen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hccontrol -n ubt0hci disconnect 41</span>
Connection handle: 41
Reason: Connection terminated by <span class=nb>local </span>host <span class=o>[</span>0x16]</code></pre></div></div><div class=paragraph><p>Raadpleeg <code>hccontrol help</code> voor een volledige lijst van beschikbare HCI-opdrachten. Voor de meeste HCI-opdrachten zijn geen beheerdersrechten nodig.</p></div></div><div class=sect3><h4 id=_logical_link_control_and_adaptation_protocol_l2cap>31.4.4. Logical Link Control and Adaptation Protocol (L2CAP)<a class=anchor href=#_logical_link_control_and_adaptation_protocol_l2cap></a></h4><div class=paragraph><p>Het Logical Link Control and Adaptation Protocol (L2CAP) biedt verbindingsgeoriënteerde en verbindingsloze gegevensdiensten met mogelijkheden om protocollen te multiplexen en mogelijkheden voor segmentatie/herassemblage voor protocollen in hogere lagen. L2CAP staat toe dat protocollen en toepassingen in hogere lagen L2CAP-gegevenspakketten met een maximale lengte van 64 kB te verzenden en ontvangen.</p></div><div class=paragraph><p>L2CAP is op het concept van <em>kanalen</em> gebaseerd. Een kanaal is een logische verbinding bovenop een basisbandverbinding. Elk kanaal is op een veel-op-één manier aan een enkel protocol gebonden. Aan hetzelfde protocol kunnen meerdere kanalen worden gebonden, maar één kanaal kan niet aan meerdere protocollen worden gebonden. Elk L2CAP-pakket dat op een kanaal wordt ontvangen, wordt naar het juiste hogere protocol doorgestuurd. Meerdere kanalen kunnen dezelfde basisbandverbinding delen.</p></div><div class=paragraph><p>Voor elk Bluetooth-apparaat wordt een enkele Netgraph-knoop van het soort <em>l2cap</em> aangemaakt. De L2CAP-knoop is normaalgesproken verbonden met de Bluetooth HCI-knoop (naar beneden toe) en de knopen van de stopcontacten voor Bluetooth (naar boven toe). De standaardnaam voor de L2CAP-knoop is "devicel2cap". Zie voor meer details de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_l2cap&amp;sektion=4&amp;format=html">ng_l2cap(4)</a>.</p></div><div class=paragraph><p>Een nuttig commando is <a href="https://man.freebsd.org/cgi/man.cgi?query=l2ping&amp;sektion=8&amp;format=html">l2ping(8)</a>, dat gebruikt kan worden om andere apparaten te pingen. Sommige Bluetooth-implementaties geven niet alle verzonden gegevens terug, dus is <code>0 bytes</code> normaal in het volgende voorbeeld.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># l2ping -a 00:80:37:29:19:a4</span>
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>0 <span class=nb>time</span><span class=o>=</span>48.633 ms <span class=nv>result</span><span class=o>=</span>0
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>1 <span class=nb>time</span><span class=o>=</span>37.551 ms <span class=nv>result</span><span class=o>=</span>0
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>2 <span class=nb>time</span><span class=o>=</span>28.324 ms <span class=nv>result</span><span class=o>=</span>0
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>3 <span class=nb>time</span><span class=o>=</span>46.150 ms <span class=nv>result</span><span class=o>=</span>0</code></pre></div></div><div class=paragraph><p>Met het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=l2control&amp;sektion=8&amp;format=html">l2control(8)</a> kunnen verschillende bewerkingen op L2CAP-knopen worden uitgevoerd. Dit voorbeeld laat zien hoe de lijst met logische verbindingen (kanalen) en de lijst met basisbandverbindingen voor het lokale apparaat verkregen kunnen worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% l2control <span class=nt>-a</span> 00:02:72:00:d4:1a read_channel_list
L2CAP channels:
Remote BD_ADDR     SCID/ DCID   PSM  IMTU/ OMTU State
00:07:e0:00:0b:ca    66/   64     3   132/  672 OPEN
% l2control <span class=nt>-a</span> 00:02:72:00:d4:1a read_connection_list
L2CAP connections:
Remote BD_ADDR    Handle Flags Pending State
00:07:e0:00:0b:ca     41 O           0 OPEN</code></pre></div></div><div class=paragraph><p>Een ander diagnostisch programma is <a href="https://man.freebsd.org/cgi/man.cgi?query=btsockstat&amp;sektion=1&amp;format=html">btsockstat(1)</a>. Het heeft ongeveer hetzelfde doel als <a href="https://man.freebsd.org/cgi/man.cgi?query=netstat&amp;sektion=1&amp;format=html">netstat(1)</a>, maar dan voor Bluetooth-netwerkgerelateerde gegevensstructuren. Het onderstaande voorbeeld laat dezelfde logische verbinding zien als die van <a href="https://man.freebsd.org/cgi/man.cgi?query=l2control&amp;sektion=8&amp;format=html">l2control(8)</a> hierboven.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% btsockstat
Active L2CAP sockets
PCB      Recv-Q Send-Q Local address/PSM       Foreign address   CID   State
c2afe900      0      0 00:02:72:00:d4:1a/3     00:07:e0:00:0b:ca 66    OPEN
Active RFCOMM sessions
L2PCB    PCB      Flag MTU   Out-Q DLCs State
c2afe900 c2b53380 1    127   0     Yes  OPEN
Active RFCOMM sockets
PCB      Recv-Q Send-Q Local address     Foreign address   Chan DLCI State
c2e8bc80      0    250 00:02:72:00:d4:1a 00:07:e0:00:0b:ca 3    6    OPEN</code></pre></div></div></div><div class=sect3><h4 id=_het_rfcomm_protocol>31.4.5. Het RFCOMM-protocol<a class=anchor href=#_het_rfcomm_protocol></a></h4><div class=paragraph><p>Het RFCOMM-protocol biedt emulatie van seriële poorten over het L2CAP-protocol. Het protocol is gebaseerd op de ETSI-standaard TS 07.10. RFCOMM is een eenvoudig transportprotocol, met aanvullende voorzieningen om de 9 circuits van RS-232- (EIATIA-232-E-) seriële poorten te emuleren. Het RFCOMM-protocol ondersteunt tot 60 gelijktijdige verbindingen (RFCOMM-kanalen) tussen twee Bluetooth-apparaten.</p></div><div class=paragraph><p>Het is de bedoeling van RFCOMM dat in een volledig communicatiepad twee toepassingen op verschillende apparaten draaien (de eindpunten van de communicatie) met daartussen een communicatiesegment. RFCOMM is bedoeld om de toepassingen te beheren die gebruik maken van de seriële poorten van de apparaten waarop ze zijn geïnstalleerd. Het communicatiesegment is een directe Bluetooth-verbinding van het ene apparaat naar het andere.</p></div><div class=paragraph><p>RFCOMM houdt zich alleen bezig met de verbinding tussen twee apparaten bij directe verbindingen, of tussen het apparaat en een modem in het geval van een netwerk. RFCOMM kan andere opstellingen ondersteunen, zoals modules die via draadloze Bluetooth-technologie communiceren aan de ene kant, en een draadinterface aanbieden aan de andere kant.</p></div><div class=paragraph><p>In FreeBSD is het RFCOMM-protocol in de laag van de Bluetooth-stopcontacten geïmplementeerd.</p></div></div><div class=sect3><h4 id=_het_paren_van_apparaten>31.4.6. Het paren van apparaten<a class=anchor href=#_het_paren_van_apparaten></a></h4><div class=paragraph><p>Standaard is Bluetooth-communicatie niet geauthenticeerd en kan elk apparaat met elk ander apparaat praten. Een Bluetooth-apparaat (bijvoorbeeld een mobiele telefoon) kan ervoor kiezen dat voor bepaalde diensten authenticatie nodig is (bijvoorbeeld voor de inbeldienst). Bluetooth-authenticatie geschied normaalgesproken met <em>PIN-codes</em>. Een PIN-code is een ACII-reeks van maximaal 16 tekens lang. De gebruiker dient dezelfde PIN-code op beide apparaten in te voeren. Nadat de gebruiker de PIN-code heeft ingevoerd, zullen beide apparaten een <em>verbindingssleutel</em> aanmaken. Hierna kan de verbindingssleutel òfwel in de apparaten zelf, òfwel in een permanente opslag worden opgeslagen. De volgende keer zullen beide apparaten de van tevoren aangemaakte verbindingssleutel gebruiken. Bovenstaande procedure wordt <em>paren</em> genoemd. Merk op dat indien een apparaat de verbindingssleutel verliest, het paren moet worden herhaald.</p></div><div class=paragraph><p>De daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=hcsecd&amp;sektion=8&amp;format=html">hcsecd(8)</a> is verantwoordelijk voor het behandelen van alle verzoeken voor Bluetooth-authenticatie. Het standaard instellingenbestand is <span class=filename>/etc/bluetooth/hcsecd.conf</span>. Een voorbeeldsectie voor een mobiele telefoon waarvan de PIN-code willekeurig op "1234" is hieronder beschreven:</p></div><div class="literalblock programlisting"><div class=content><pre>device {
	bgaddr	00:80:37:29:19:a4;
	name	&#34;Pav&#39;s T39&#34;;
	key	nokey;
	pin	&#34;1234&#34;;
      }</pre></div></div><div class=paragraph><p>Er is geen limiet voor PIN-codes (behalve de lengte). Voor sommige apparaten (bijvoorbeeld Bluetooth-headsets) kan de PIN-code vast zijn ingebouwd. De schakelaar <code>-d</code> dwingt de daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=hcsecd&amp;sektion=8&amp;format=html">hcsecd(8)</a> om op de voorgrond te blijven, zodat het gemakkelijk is om te zien wat er gebeurt. Stel het andere apparaat in om paarverzoeken te ontvangen en initialiseer de Bluetooth-verbinding naar het andere apparaat. Het apparaat moet zeggen dat het paarverzoek geaccepteerd is en om de PIN-code vragen. Geef dezelfde PIN-code op als in <span class=filename>hcsecd.conf</span>. Nu zijn de PC en het andere apparaat gepaard. Als alternatief kan paren op het andere apparaat worden geïnitialiseerd.</p></div><div class=paragraph><p>De volgende regel kan aan het bestand <span class=filename>/etc/rc.conf</span> worden toegevoegd om hcsecd automatisch met het systeem op te starten:</p></div><div class="literalblock programlisting"><div class=content><pre>hcsecd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het volgende is een voorbeeld van de uitvoer van de daemon hcsecd:</p></div><div class="literalblock programlisting"><div class=content><pre>hcsecd[16484]: Got Link_Key_Request event from &#39;ubt0hci&#39;, remote bdaddr 0:80:37:29:19:a4
hcsecd[16484]: Found matching entry, remote bdaddr 0:80:37:29:19:a4, name &#39;Pav&#39;s T39&#39;, link key doesn&#39;t exist
hcsecd[16484]: Sending Link_Key_Negative_Reply to &#39;ubt0hci&#39; for remote bdaddr 0:80:37:29:19:a4
hcsecd[16484]: Got PIN_Code_Request event from &#39;ubt0hci&#39;, remote bdaddr 0:80:37:29:19:a4
hcsecd[16484]: Found matching entry, remote bdaddr 0:80:37:29:19:a4, name &#39;Pav&#39;s T39&#39;, PIN code exists
hcsecd[16484]: Sending PIN_Code_Reply to &#39;ubt0hci&#39; for remote bdaddr 0:80:37:29:19:a4</pre></div></div></div><div class=sect3><h4 id=_service_discovery_protocol_sdp>31.4.7. Service Discovery Protocol (SDP)<a class=anchor href=#_service_discovery_protocol_sdp></a></h4><div class=paragraph><p>Het Service Discovery Protocol (SDP) biedt voor cliënttoepassingen de mogelijkheid om diensten te ontdekken die door servertoepassingen worden aangeboden alsook de kenmerken van deze diensten. De kenmerken van een dienst omvatten de soort of klasse van de aangeboden dienst en de informatie over het mechanisme of protocol dat nodig is om de dienst te gebruiken.</p></div><div class=paragraph><p>SDP omvat communicatie tussen een SDP-server en een SDP-cliënt. De server houdt een lijst van dienstenregistraties bij die de eigenschappen van de diensten beschrijven die met de server geassocieerd zijn. Elke dienstregistratie bevat informatie over een enkele dienst. Een cliënt kan informatie over een dienstregistratie opvragen die door de SDP-server wordt bijgehouden door een SDP-verzoek in te dienen. Indien de cliënt, of een toepassing die met de cliënt geassocieerd is, besluit om de dienst te gebruiken, moet het een aparte verbinding naar de aanbieder van de dienst openen om de dienst te gebruiken. SDP biedt een mechanisme om diensten en hun attributen te ontdekken, maar het biedt geen mechanisme om die diensten te gebruiken.</p></div><div class=paragraph><p>Normaalgesproken zoekt een SDP-cliënt naar diensten naar aanleiding van enkele gewenste eigenschappen van die diensten. Soms is het echter wenselijk om te ontdekken welke soorten diensten door de dienstregistraties van een SDP-server worden beschreven zonder enige voorkennis van deze diensten. Dit kijken naar alle aangeboden diensten wordt <em>browsen</em> genoemd.</p></div><div class=paragraph><p>De Bluetooth SDP-server <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a> en de opdrachtregelcliënt <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpcontrol&amp;sektion=8&amp;format=html">sdpcontrol(8)</a> zitten in de standaard FreeBSD-installatie. Het volgende voorbeeld laat zien hoe een SDP-browse query uit te voeren.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sdpcontrol <span class=nt>-a</span> 00:01:03:fc:6e:ec browse
Record Handle: 00000000
Service Class ID List:
        Service Discovery Server <span class=o>(</span>0x1000<span class=o>)</span>
Protocol Descriptor List:
        L2CAP <span class=o>(</span>0x0100<span class=o>)</span>
                Protocol specific parameter <span class=c>#1: u/int/uuid16 1</span>
                Protocol specific parameter <span class=c>#2: u/int/uuid16 1</span>

Record Handle: 0x00000001
Service Class ID List:
        Browse Group Descriptor <span class=o>(</span>0x1001<span class=o>)</span>

Record Handle: 0x00000002
Service Class ID List:
        LAN Access Using PPP <span class=o>(</span>0x1102<span class=o>)</span>
Protocol Descriptor List:
        L2CAP <span class=o>(</span>0x0100<span class=o>)</span>
        RFCOMM <span class=o>(</span>0x0003<span class=o>)</span>
                Protocol specific parameter <span class=c>#1: u/int8/bool 1</span>
Bluetooth Profile Descriptor List:
        LAN Access Using PPP <span class=o>(</span>0x1102<span class=o>)</span> ver. 1.0</code></pre></div></div><div class="olist lowerroman"><ol class=lowerroman type=i><li><p>enzovoorts. Merk op dat elke dienst een lijst met attributen heeft (bijvoorbeeld een RFCOMM-kanaal). Afhankelijk van de dienst kan het nodig zijn om een aantekening van sommige attributen te maken. Sommige Bluetooth-implementaties ondersteunen dienst-browsen niet en zullen een lege lijst teruggeven. In dit geval is het mogelijk om naar de specifieke dienst te zoeken. Het onderstaande voorbeeld laat zien hoe naar de dienst OBEX Object Push (OPUSH) gezocht kan worden:</p></li></ol></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sdpcontrol <span class=nt>-a</span> 00:01:03:fc:6e:ec search OPUSH</code></pre></div></div><div class=paragraph><p>Het aanbieden van diensten op FreeBSD aan Bluetooth-cliënten wordt gedaan met de server <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a>. De volgende regel kan aan het bestand <span class=filename>/etc/rc.conf</span> worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>sdpd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het daemon sdpd kan worden gestart met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sdpd start</span></code></pre></div></div><div class=paragraph><p>De plaatselijke servertoepassing die Bluetooth-diensten wil aanbieden aan verre cliënten zal de dienst registreren bij de plaatselijke SDP-daemon. Een voorbeeld van zo’n toepassing is <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a>. Nadat het gestart is zal het de Bluetooth LAN-dienst bij de plaatselijke SDP-daemon registreren.</p></div><div class=paragraph><p>De lijst met diensten die bij de plaatselijke SDP-server zijn geregistreerd kan worden opgevraagd door te SDP-browsen via het plaatselijke controlekanaal:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sdpcontrol -l browse</span></code></pre></div></div></div><div class=sect3><h4 id=_dial_up_networking_dun_en_netwerktoegang_met_ppp_lan_profielen>31.4.8. Dial-Up Networking (DUN) en netwerktoegang met PPP (LAN) profielen<a class=anchor href=#_dial_up_networking_dun_en_netwerktoegang_met_ppp_lan_profielen></a></h4><div class=paragraph><p>Het inbelnetwerk (DUN) profiel wordt het meeste gebruikt met modems en mobiele telefoons. De volgende scenario’s worden in dit profiel behandeld:</p></div><div class=ulist><ul><li><p>het gebruik van een mobiele telefoon of modem door een computer als een draadloze modem voor het verbinden met een inbelserver voor Internet-toegang, of voor andere inbeldiensten;</p></li><li><p>het gebruik van een mobiele telefoon of modem door een computer om gegevensoproepen te ontvangen.</p></li></ul></div><div class=paragraph><p>Het profiel voor netwerktoegang met PPP (LAN) kan in de volgende situaties gebruikt worden:</p></div><div class=ulist><ul><li><p>LAN-toegang voor een enkel Bluetooth-apparaat;</p></li><li><p>LAN-toegang voor meerdere Bluetooth-apparaten;</p></li><li><p>PC naar PC (door PPP-netwerken over een seriële kabel te emuleren).</p></li></ul></div><div class=paragraph><p>Op FreeBSD zijn beide profielen geïmplementeerd met <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> - een wrapper die een RFCOMM Bluetooth-verbinding omzet in iets waar PPP mee overweg kan. Voordat een profiel gebruikt kan worden, dient een nieuw PPP-label in het bestand <span class=filename>/etc/ppp/ppp.conf</span> te worden aangemaakt. Raadpleeg de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> voor voorbeelden.</p></div><div class=paragraph><p>In het volgende voorbeeld zal <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> gebruikt worden om RFCOMM-verbinding met een ver apparaat met BD_ADDR 00:80:37:29:19:a4 op een DUN RFCOMM-kanaal te maken. Het eigenlijke RFCOMM-kanaalnummer wordt via SDP van het verre apparaat verkregen. Het is mogelijk om het RFCOMM-kanaal handmatig op te geven, en in dat geval zal <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> het SDP-verzoek niet uitvoeren. Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpcontrol&amp;sektion=8&amp;format=html">sdpcontrol(8)</a> om het RFCOMM-kanaal op het verre apparaat te achterhalen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rfcomm_pppd -a 00:80:37:29:19:a4 -c -C dun -l rfcomm-dialup</span></code></pre></div></div><div class=paragraph><p>Om netwerktoegang met PPP (LAN) aan te bieden moet de server <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a> draaien. Er dient een nieuwe regel voor LAN-cliënten in het bestand <span class=filename>/etc/ppp/ppp.conf</span> aangemaakt te worden. Raadpleeg de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> voor voorbeelden. Tenslotte dient de RFCOMM PPP-server op een geldig RFCOMM-kanaal gestart te worden. De RFCOMM PPP-server zal automatisch de Bluetooth LAN-dienst bij de plaatselijke SDP-daemon registreren. Het volgende voorbeeld laat zien hoe een RFCOMM PPP-server te starten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rfcomm_pppd -s -C 7 -l rfcomm-server</span></code></pre></div></div></div><div class=sect3><h4 id=_het_obex_object_push_opush_profiel>31.4.9. Het OBEX Object Push (OPUSH) profiel<a class=anchor href=#_het_obex_object_push_opush_profiel></a></h4><div class=paragraph><p>OBEX is een veelgebruikt protocol voor eenvoudige bestandsoverdrachten tussen mobiele apparaten. Het primaire gebruik is infraroodcommunicatie, waar het wordt gebruikt voor generieke bestandsoverdrachten tussen notebooks of PDA’s, en om visitekaarten en kalenderregels tussen mobiele telefoons en andere apparaten met PIM-toepassingen over te dragen.</p></div><div class=paragraph><p>De OBEX-server en clieënt zijn geïmplenteerd als een pakket van derde partij, obexapp, dat beschikbaar is als de port <a class=package href=https://cgit.freebsd.org/ports/tree/comms/obexapp/>comms/obexapp</a>.</p></div><div class=paragraph><p>De OBEX-cliënt wordt gebruikt om objecten naar en/of van de OBEX-server te duwen/trekken. Een object kan bijvoorbeeld een visitekaart of een afspraak zijn. De OBEX-cliënt kan het RFCOMM-kanaalnummer van het verre apparaat via SDP opvragen. Dit kan gedaan worden door de dienstnaam in plaats van het RFCOMM-kanaalnummer op te geven. De ondersteunde dienstnamen zijn: IrMC, FTRN, en OPUSH. Het is mogelijk om het RFCOMM-kanaal als een nummer op te geven. Het onderstaande is een voorbeeld van een OBEX-sessie, waar een apparaatinformatie-object van de mobiele telefoon wordt getrokken, en een nieuw object (een visitekaart) in de gids van de telefoon wordt geduwd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% obexapp <span class=nt>-a</span> 00:80:37:29:19:a4 <span class=nt>-C</span> IrMC
obex&gt; get telecom/devinfo.txt devinfo-t39.txt
Success, response: OK, Success <span class=o>(</span>0x20<span class=o>)</span>
obex&gt; put new.vcf
Success, response: OK, Success <span class=o>(</span>0x20<span class=o>)</span>
obex&gt; di
Success, response: OK, Success <span class=o>(</span>0x20<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Om de dienst OBEX Object Push aan te bieden, moet de server <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a> draaien. Er moet een hoofdmap worden aangemaakt waarin alle binnenkomende objecten worden opgeslagen. Het standaardpad naar de hoofdmap is <span class=filename>/var/spool/obex</span>. Tenslotte moet de OBEX-server op een geldig RFCOMM-kanaal worden gestart. De OBEX-server zal automatisch de dienst OBEX Object Push bij de plaatselijke SDP-daemon registeren. Het onderstaande voorbeeld laat zien hoe de OBEX-server gestart wordt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># obexapp -s -C 10</span></code></pre></div></div></div><div class=sect3><h4 id=_serial_port_profile_spp>31.4.10. Serial Port Profile (SPP)<a class=anchor href=#_serial_port_profile_spp></a></h4><div class=paragraph><p>Het Seriële Poort Profiel (SPP) zorgt ervoor dat Bluetooth-apparaten RS232 (of gelijkwaardige) seriële kabels kunnen emuleren. Het scenario dat dit profiel behandelt zorgt ervoor dat oude toepassingen Bluetooth kunnen gebruiken als vervanging van kabels, door gebruik te maken van een virtuele seriële poort.</p></div><div class=paragraph><p>Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_sppd&amp;sektion=1&amp;format=html">rfcomm_sppd(1)</a> implementeert het Seriële Poort profiel. Een pseudo-tty wordt gebruikt als abstractie voor een virtuele seriële poort. Onderstaand voorbeeld laat zien hoe met een Seriële Poortdienst voor verre apparaten te verbinden. Merk op dat het niet nodig is om een RFCOMM-kanaal te kiezen - <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_sppd&amp;sektion=1&amp;format=html">rfcomm_sppd(1)</a> kan het via SDP van het verre apparaat verkrijgen. Dit kan worden overruled door een RFCOMM-kanaal op de opdrachtregel te specificeren.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rfcomm_sppd -a 00:07:E0:00:0B:CA -t /dev/ttyp6</span>
rfcomm_sppd[94692]: Starting on /dev/ttyp6...</code></pre></div></div><div class=paragraph><p>Als er een verbinding is, kan de pseudo-tty als seriële poort worden gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -l ttyp6</span></code></pre></div></div></div><div class=sect3><h4 id=_problemen_oplossen_6>31.4.11. Problemen oplossen<a class=anchor href=#_problemen_oplossen_6></a></h4><div class=sect4><h5 id=_een_apparaat_op_afstand_kan_geen_verbinding_maken>31.4.11.1. Een apparaat op afstand kan geen verbinding maken<a class=anchor href=#_een_apparaat_op_afstand_kan_geen_verbinding_maken></a></h5><div class=paragraph><p>Sommige oudere Bluetooth-apparaten ondersteunen het wisselen van rol niet. Standaard probeert FreeBSD, wanneer het een nieuwe verbinding accepteert, een rolwisseling uit te voeren en meester te worden. Apparaten die dit niet ondersteunen zullen niet kunnen verbinden. Merk op dat van rol wordt gewisseld wanneer een nieuwe verbinding wordt gemaakt, dus het is niet mogelijk om het verre apparaat te vragen of het rolwisseling ondersteunt. Er is een HCI-optie om rolwisselen aan de plaatselijke kant uit te zetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hccontrol -n ubt0hci write_node_role_switch 0</span></code></pre></div></div></div><div class=sect4><h5 id=_er_gaat_iets_mis_kan_ik_precies_zien_wat_er_gebeurt>31.4.11.2. Er gaat iets mis, kan ik precies zien wat er gebeurt?<a class=anchor href=#_er_gaat_iets_mis_kan_ik_precies_zien_wat_er_gebeurt></a></h5><div class=paragraph><p>Ja, dit is mogelijk. Gebruik het pakket hcidump, dat beschikbaar is als de port <a class=package href=https://cgit.freebsd.org/ports/tree/comms/hcidump/>comms/hcidump</a>. Het gereedschap hcidump is vergelijkbaar met <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a>. Het kan gebruikt worden om de inhoud van Bluetooth-pakketten op de terminal te laten zien en om de Bluetooth-pakketten naar een bestand te schrijven.</p></div></div></div></div><div class=sect2><h3 id=network-bridging>31.5. Bridging<a class=anchor href=#network-bridging></a></h3><div class=sect3><h4 id=_introductie_2>31.5.1. Introductie<a class=anchor href=#_introductie_2></a></h4><div class=paragraph><p>Soms is het handig om één fysiek netwerk (zoals een Ethernet-segment) in twee gescheiden netwerksegmenten te verdelen zonder de noodzaak om een IP-subnet aan te maken en een router te gebruiken om de segmenten met elkaar te verbinden. Een apparaat dat twee netwerken op deze manier met elkaar verbindt wordt een "bridge (brug)" genoemd. Een FreeBSD-systeem met twee netwerkkaarten kan als bridge dienen.</p></div><div class=paragraph><p>De bridge werkt door de adressen van de MAC-laag (Ethernetadressen) van de apparaten op elke netwerkinterface te leren. Het stuurt alleen verkeer tussen twee netwerken door indien de bron en het doel zich op verschillende netwerken bevinden.</p></div><div class=paragraph><p>In vele opzichten is een bridge als een Ethernet-switch met erg weinig poorten.</p></div></div><div class=sect3><h4 id=_situaties_waarin_bridging_juist_is>31.5.2. Situaties waarin bridging juist is<a class=anchor href=#_situaties_waarin_bridging_juist_is></a></h4><div class=paragraph><p>Er zijn vandaag de dag veel situaties waarin een bridge gebruikt wordt.</p></div><div class=sect4><h5 id=_netwerken_verbinden>31.5.2.1. Netwerken verbinden<a class=anchor href=#_netwerken_verbinden></a></h5><div class=paragraph><p>Het basisgebruik van een bridge is het met elkaar verbinden van twee of meer netwerksegmenten. Er zijn vele redenen om een hostgebaseerde bridge te gebruiken in plaats van simpele netwerkapparaten zoals kabelbeperkingen, firewalling of het verbinden van pseudonetwerken zoals een interface van een virtuële machine. Een bridge kan ook een draadloze interface die in hostap-modus draait met een bedraad netwerk verbinden en als een toegangspunt dienen.</p></div></div><div class=sect4><h5 id=_filteringbandbreedtebeheersende_firewall>31.5.2.2. Filtering/Bandbreedtebeheersende firewall<a class=anchor href=#_filteringbandbreedtebeheersende_firewall></a></h5><div class=paragraph><p>Een gebruikelijke situatie dient zich voor wanneer de functionaliteit van een firewall nodig is zonder routing of network address translation (NAT).</p></div><div class=paragraph><p>Een voorbeeld is een klein bedrijf dat via DSL of ISDN met hun internetprovider verbonden is. Dit bedrijf heeft 13 wereldwijd bereikbare IP-adressen van de internetprovider en 10 PC’s op hun netwerk. In deze situatie is een firewall die op een router gebaseerd is lastig wegens subnet-problemen.</p></div><div class=paragraph><p>Een firewall die op een bridge gebaseerd is kan ingesteld en net na de DSL- of ISDN-router geplaatst worden zonder dat er problemen met IP-nummers optreden.</p></div></div><div class=sect4><h5 id=_netwerktap>31.5.2.3. Netwerktap<a class=anchor href=#_netwerktap></a></h5><div class=paragraph><p>Een bridge kan twee netwerksegmenten verbinden en kan gebruikt worden om alle Ethernetframes die tussen dezen voorbijkomen te inspecteren. Dit kan òfwel vanuit het gebruik van <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a>/<a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a> op de bridge-interface òfwel door een kopie van alle frames naar een extra interface (overspanpoort) te versturen.</p></div></div><div class=sect4><h5 id=_laag_2_vpn>31.5.2.4. Laag 2 VPN<a class=anchor href=#_laag_2_vpn></a></h5><div class=paragraph><p>Twee Ethernetnetwerken kunnen over een IP-verbinding verbonden worden door de netwerken naar een EtherIP-tunnel te bridgen of met een oplossing gebaseerd po <a href="https://man.freebsd.org/cgi/man.cgi?query=tap&amp;sektion=4&amp;format=html">tap(4)</a> zoals OpenVPN.</p></div></div><div class=sect4><h5 id=_laag_2_redundancy>31.5.2.5. Laag 2 Redundancy<a class=anchor href=#_laag_2_redundancy></a></h5><div class=paragraph><p>Een netwerk kan met meerdere verbindingen verbonden worden en het Spanning Tree Protocol gebruiken om overbodige paden te blokkeren. Een Ethernetnetwerk kan alleen juist functioneren indien er slechts één actief pad bestaat tussen twee apparaten, Spanning Tree zal lussen detecteren en de overbodige verbindingen in een geblokkeerde toestand zetten. Indien een van de actieve verbindingen faalt zal het protocol een andere boom berekenen en een van de geblokkeerde paden weer activeren om de verbindingen naar alle punten in het netwerk te herstellen.</p></div></div></div><div class=sect3><h4 id=_de_kernel_instellen>31.5.3. De kernel instellen<a class=anchor href=#_de_kernel_instellen></a></h4><div class=paragraph><p>Deze sectie behandelt de bridges geïmplementeerd met <a href="https://man.freebsd.org/cgi/man.cgi?query=if_bridge&amp;sektion=4&amp;format=html">if_bridge(4)</a>, een stuurprogramma dat bridges met netgraph implementeert is ook beschikbaar, zie voor meer informatie de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_bridge&amp;sektion=4&amp;format=html">ng_bridge(4)</a>.</p></div><div class=paragraph><p>Het bridge-stuurprogramma is een kernelmodule en zal automatisch door <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> worden geladen wanneer er een bridge-interface wordt aangemaakt. Het is mogelijk om de bridge in de kernel te compileren door <code>device if_bridge</code> aan het kernelinstellingenbestand toe te voegen.</p></div><div class=paragraph><p>Pakketfiltering kan met elk firewall-pakket worden gebruikt dat via het raamwerk <a href="https://man.freebsd.org/cgi/man.cgi?query=pfil&amp;sektion=9&amp;format=html">pfil(9)</a> aankoppelt. De firewall kan als een module worden geladen of in de kernel worden gecompileerd.</p></div><div class=paragraph><p>De bridge kan als met <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a> als een verkeersregelaar worden gebruikt.</p></div></div><div class=sect3><h4 id=_de_bridge_inschakelen>31.5.4. De bridge inschakelen<a class=anchor href=#_de_bridge_inschakelen></a></h4><div class=paragraph><p>De bridge wordt aangemaakt door interfaces te klonen. Om een bridge aan te maken wordt <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> gebruikt, indien het bridge-stuurprogramma niet in de kernel aanwezig is zal het automatisch worden geladen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge create</span>
<span class=c># ifconfig bridge0</span>
bridge0: <span class=nv>flags</span><span class=o>=</span>8802&lt;BROADCAST,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether 96:3d:4b:f1:79:7a
        <span class=nb>id </span>00:00:00:00:00:00 priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 <span class=nb>timeout </span>1200
        root <span class=nb>id </span>00:00:00:00:00:00 priority 0 ifcost 0 port 0</code></pre></div></div><div class=paragraph><p>Een bridge-interface is aangemaakt en er is automatisch een random gegenereerd Ethernetadres aan toegekend. De parameters <code>maxaddr</code> en <code>timeout</code> bepalen hoeveel MAC-adressen de bridge in de doorstuurtabel houdt en hoeveel seconden voordat elke regel wordt verwijderd nadat het voor het laatst gezien is. De andere parameters bepalen hoe Spanning Tree werkt.</p></div><div class=paragraph><p>Voeg de netwerkinterfaces die lid zijn aan de bridge toe. Om de bridge pakketten te laten doorsturen dienen alle lidinterfaces en de bridge actief te zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 addm fxp0 addm fxp1 up</span>
<span class=c># ifconfig fxp0 up</span>
<span class=c># ifconfig fxp1 up</span></code></pre></div></div><div class=paragraph><p>De bridge stuurt nu Ethernet-frames door tussen <span class=filename>fxp0</span> en <span class=filename>fxp1</span>. De overeenkomstige configuratie in <span class=filename>/etc/rc.conf</span> zodat de bridge tijdens het opstarten wordt aangemaakt is:</p></div><div class="literalblock programlisting"><div class=content><pre>cloned_interfaces=&#34;bridge0&#34;
ifconfig_bridge0=&#34;addm fxp0 addm fxp1 up&#34;
ifconfig_fxp0=&#34;up&#34;
ifconfig_fxp1=&#34;up&#34;</pre></div></div><div class=paragraph><p>Indien de bridge-gastheer een IP-adres nodig heeft dan is de juiste plaats om dit in te stellen op de bridge-interface zelf in plaats van op een van de lidinterfaces. Dit kan statisch of via DHCP worden ingesteld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 inet 192.168.0.1/24</span></code></pre></div></div><div class=paragraph><p>Het is ook mogelijk om een IPv6-adres aan een bridge-interface toe te kennen.</p></div></div><div class=sect3><h4 id=_firewalls_gebruiken>31.5.5. Firewalls gebruiken<a class=anchor href=#_firewalls_gebruiken></a></h4><div class=paragraph><p>Wanneer pakketten worden gefilterd, zullen gebridgede pakketten het filter inbound op de vertrekkende interface passeren, op de bridge-interface en outbound op de bestemde interface. Elke stap kan uitgezet worden. Wanneer de richting van het pakketverkeer belangrijk is, kan de firewall het beste op de lidinterfaces draaien en niet op de bridge zelf.</p></div><div class=paragraph><p>De bridge heeft verschillende aanpasbare instellingen voor het doorlaten van non-IP- en ARP-pakketten, en een laag 2 firewall met IPFW. Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=if_bridge&amp;sektion=4&amp;format=html">if_bridge(4)</a> voor meer informatie.</p></div></div><div class=sect3><h4 id=_opspannende_boom>31.5.6. Opspannende boom<a class=anchor href=#_opspannende_boom></a></h4><div class=paragraph><p>Het bridge-stuurprogramma implementeert het Rapid Spanning Tree Protocol (RSTP of 802.1w) met terugwaartse compatibiliteit met het verouderde Spanning Tree Protocol (STP). Spanning Tree wordt gebruikt om lussen in een netwerktopologie te detecteren en verwijderen. RSTP biedt snellere convergentie naar een opspannende boom dan het verouderde STP, het protocol wisselt informatie met naburige switches uit om snel naar forwarding over te gaan zonder lussen te creëren. FreeBSD ondersteunt RSTP en STP als opties, waarbij RSTP de standaard is.</p></div><div class=paragraph><p>Spanning Tree kan op lidinterfaces worden geactiveerd met het commando <code>stp</code>. Voor een bridge met <span class=filename>fxp0</span> en <span class=filename>fxp1</span> alle huidige interfaces, wordt STP met het volgende geactiveerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 stp fxp0 stp fxp1</span>
bridge0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether d6:cf:d5:a0:94:6d
        <span class=nb>id </span>00:01:02:4b:d4:50 priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 <span class=nb>timeout </span>1200
        root <span class=nb>id </span>00:01:02:4b:d4:50 priority 32768 ifcost 0 port 0
        member: fxp0 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 3 priority 128 path cost 200000 proto rstp
                role designated state forwarding
        member: fxp1 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 4 priority 128 path cost 200000 proto rstp
                role designated state forwarding</code></pre></div></div><div class=paragraph><p>De bridge heeft spanning tree ID <code>00:01:02:4b:d4:50</code> en prioriteit <code>32768</code>. Aangezien het <code>root id</code> hetzelfde is geeft dit aan dat dit de hoofdbridge voor de boom is.</p></div><div class=paragraph><p>Een andere bridge in het netwerk heeft spanning tree ook geactiveerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>bridge0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether 96:3d:4b:f1:79:7a
        <span class=nb>id </span>00:13:d4:9a:06:7a priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 <span class=nb>timeout </span>1200
        root <span class=nb>id </span>00:01:02:4b:d4:50 priority 32768 ifcost 400000 port 4
        member: fxp0 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 4 priority 128 path cost 200000 proto rstp
                role root state forwarding
        member: fxp1 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 5 priority 128 path cost 200000 proto rstp
                role designated state forwarding</code></pre></div></div><div class=paragraph><p>De reegl <code>root id 00:01:02:4b:d4:50 priority 32768 ifcost 400000 port 4</code> geeft aan dat de hoofdbridge <code>00:01:02:4b:d4:50</code> is zoals boven en dat de padkosten <code>400000</code> zijn vanaf deze bridge, het pad naar de hoofdbridge gaat via <code>port 4</code> welke <span class=filename>fxp0</span> is.</p></div></div><div class=sect3><h4 id=_geavanceerd_bridgen>31.5.7. Geavanceerd bridgen<a class=anchor href=#_geavanceerd_bridgen></a></h4><div class=sect4><h5 id=_verkeersstromen_reconstrueren>31.5.7.1. Verkeersstromen reconstrueren<a class=anchor href=#_verkeersstromen_reconstrueren></a></h5><div class=paragraph><p>De bridge ondersteunt monitormodus, waarin de pakketten worden verwijderd nadat ze door <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> zijn verwerkt, en ze niet verder verwerkt of doorgestuurd worden. Dit kan worden gebruikt om de invoer van twee of meer interfaces naar een enkele <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a>-stroom te multiplexen. Dit is nuttig voor het reconstrueren van het verkeer voor netwerktaps welke de RX/TX-signalen over twee verschillende interfaces uitzenden.</p></div><div class=paragraph><p>Om de invoer van vier netwerkinterfaces als één stroom te lezen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 addm fxp0 addmfxp1 addm fxp2 addm fxp3 monitor up</span>
<span class=c># tcpdump -i bridge0</span></code></pre></div></div></div><div class=sect4><h5 id=_span_poorten>31.5.7.2. SPAN poorten<a class=anchor href=#_span_poorten></a></h5><div class=paragraph><p>Van elk Ethernet-frame dat door de bridge wordt ontvangen wordt er een kopie naar de aangewezen SPAN-poort verstuurd. Het aantal geconfigureerde SPAN-poorten op een bridge is onbeperkt, indien een interface aangewezen is als SPAN-poort kan het niet ook als gewone bridgepoort gebruikt worden. Dit is het nuttigste voor het passief afluisteren van een gebridged netwerk op een andere host die met een van de SPAN-poorten van de bridge verbonden is.</p></div><div class=paragraph><p>Om een kopie van alle frames naar de interface <span class=filename>fxp4</span> te versturen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 span fxp4</span></code></pre></div></div></div><div class=sect4><h5 id=_privé_interfaces>31.5.7.3. Privé-interfaces<a class=anchor href=#_privé_interfaces></a></h5><div class=paragraph><p>Een privé-interface stuurt geen verkeer door naar poorten die niet ook een privé-interface zijn. Het verkeer wordt onvoorwaardelijk geblokkeerd, dus worden er geen Ethernetframes doorgestuurd, inclusief ARP. Indien verkeer selectief dient te worden geblokkeerd dient er in plaats hiervan een firewall gebruikt te worden.</p></div></div><div class=sect4><h5 id=_klevende_interfaces>31.5.7.4. Klevende interfaces<a class=anchor href=#_klevende_interfaces></a></h5><div class=paragraph><p>Indien een lidinterface van een bridge als klevend is gemarkeerd worden dynamisch geleerde adresregels als statisch behandelt wanneer ze in de doorstuurcache komen. Klevende interfaces vallen nooit uit de cache en worden nooit vervangen, zelfs niet als het adres op een andere interface wordt gezien. Dit biedt het voordeel van statische adresregels zonder dat de doorstuurtabel van te voren gevuld hoeft te worden, cliënten die geleerd zijn op een bepaald segment van de bridge kunnen niet roamen naar een ander segment.</p></div><div class=paragraph><p>Een ander voorbeeld voor het gebruik van klevende adressen zou het combineren van de bridge met VLANs zijn om een router te creëren waar klantnetwerken geïsoleerd zijn zonder dat IP-adresruimte verspild wordt. Neem aan dat <code>KlantA</code> op <code>vlan100</code> zit en <code>KlantB</code> op <code>vlan101</code>. De bridge heeft het adres <code>192.168.0.1</code> en is tevens een internet-router.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 addm vlan100 sticky vlan100 addm vlan101 sticky vlan101</span>
<span class=c># ifconfig bridge0 inet 192.168.0.1/24</span></code></pre></div></div><div class=paragraph><p>Beide cliënten zien <code>192.168.0.1</code> als hun standaard gateway en aangezien de bridge-cache kleverig is kunnen ze niet het MAC-adres van de andere klant spoofen om hun verkeer op te vangen.</p></div><div class=paragraph><p>Alle communicatie tussen de VLANs kan geblokkeerd worden door het gebruik van privé-interfaces (of een firewall):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 private vlan100 private vlan101</span></code></pre></div></div><div class=paragraph><p>De klanten zijn compleet geïsoleerd van elkaar, het volledige <code>/24</code> adresruimte kan zonder subnetten toegewezen worden.</p></div></div><div class=sect4><h5 id=_adresbeperkingen>31.5.7.5. Adresbeperkingen<a class=anchor href=#_adresbeperkingen></a></h5><div class=paragraph><p>Het aantal unieke bron-MAC-adressen achter een interface kan beperkt zijn. Wanneer de limiet bereikt is worden pakketten met een onbekend bronadres gedropt totdat een bestaande ingang in de host-cache vervalt of wordt verwijderd.</p></div><div class=paragraph><p>Het volgende voorbeeld stelt het maximum aantal Ethernetapparaten voor <code>KlantA</code> op <code>vlan100</code> in op 10.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 ifmaxaddr vlan100 10</span></code></pre></div></div></div><div class=sect4><h5 id=_snmp_monitoring>31.5.7.6. SNMP-monitoring<a class=anchor href=#_snmp_monitoring></a></h5><div class=paragraph><p>De bridge-interface en STP-parameters kunnen gemonitord worden via het SNMP-daemon dat met het basis FreeBSD-systeem wordt meegeleverd. De geëxporteerde bridge-MIBs houden zich aan de standaarden van de IETF zodat elke SNMP-cliënt of monitorpakket kan worden gebruikt om de gegevens te verzamelen.</p></div><div class=paragraph><p>Op de bridge-machine dient de regel <code>begemotSnmpdModulePath."bridge" = "/usr/lib/snmp_bridge.so"</code> van <span class=filename>/etc/snmp.config</span> geactiveerd te worden en het daemon bsnmpd gestart te worden. Andere instellingen zoals gemeenschapsnamen en toegangslijsten dienen eventueel aangepast te worden. Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=bsnmpd&amp;sektion=1&amp;format=html">bsnmpd(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=snmp_bridge&amp;sektion=3&amp;format=html">snmp_bridge(3)</a> voor meer informatie.</p></div><div class=paragraph><p>Het volgende voorbeeld gebruikt de software Net-SNMP (<a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/net-snmp/>net-mgmt/net-snmp</a> om een bridge te ondervragen, de port <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/bsnmptools/>net-mgmt/bsnmptools</a> kan ook worden gebruikt. Voeg de volgende regels toe aan <span class=filename>$HOME/.snmp/snmp.conf</span> op de SNMP-cliënt-host om de MIB-definities van de bridge in Net-SNMP te importeren:</p></div><div class="literalblock programlisting"><div class=content><pre>mibdirs +/usr/shared/snmp/mibs
mibs +BRIDGE-MIB:RSTP-MIB:BEGEMOT-MIB:BEGEMOT-BRIDGE-MIB</pre></div></div><div class=paragraph><p>Om een enkele bridge via de IETF BRIDGE-MIB (RFC4188) te monitoren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% snmpwalk <span class=nt>-v</span> 2c <span class=nt>-c</span> public bridge1.example.com mib-2.dot1dBridge
BRIDGE-MIB::dot1dBaseBridgeAddress.0 <span class=o>=</span> STRING: 66:fb:9b:6e:5c:44
BRIDGE-MIB::dot1dBaseNumPorts.0 <span class=o>=</span> INTEGER: 1 ports
BRIDGE-MIB::dot1dStpTimeSinceTopologyChange.0 <span class=o>=</span> Timeticks: <span class=o>(</span>189959<span class=o>)</span> 0:31:39.59 centi-seconds
BRIDGE-MIB::dot1dStpTopChanges.0 <span class=o>=</span> Counter32: 2
BRIDGE-MIB::dot1dStpDesignatedRoot.0 <span class=o>=</span> Hex-STRING: 80 00 00 01 02 4B D4 50
...
BRIDGE-MIB::dot1dStpPortState.3 <span class=o>=</span> INTEGER: forwarding<span class=o>(</span>5<span class=o>)</span>
BRIDGE-MIB::dot1dStpPortEnable.3 <span class=o>=</span> INTEGER: enabled<span class=o>(</span>1<span class=o>)</span>
BRIDGE-MIB::dot1dStpPortPathCost.3 <span class=o>=</span> INTEGER: 200000
BRIDGE-MIB::dot1dStpPortDesignatedRoot.3 <span class=o>=</span> Hex-STRING: 80 00 00 01 02 4B D4 50
BRIDGE-MIB::dot1dStpPortDesignatedCost.3 <span class=o>=</span> INTEGER: 0
BRIDGE-MIB::dot1dStpPortDesignatedBridge.3 <span class=o>=</span> Hex-STRING: 80 00 00 01 02 4B D4 50
BRIDGE-MIB::dot1dStpPortDesignatedPort.3 <span class=o>=</span> Hex-STRING: 03 80
BRIDGE-MIB::dot1dStpPortForwardTransitions.3 <span class=o>=</span> Counter32: 1
RSTP-MIB::dot1dStpVersion.0 <span class=o>=</span> INTEGER: rstp<span class=o>(</span>2<span class=o>)</span></code></pre></div></div><div class=paragraph><p>De waarde <code>dot1dStpTopChanges.0</code> is twee wat betekent dat de topologie van de STP-bridge twee maal veranderd is, een topologieverandering houdt in dat één of meerdere links in het netwerk zijn veranderd of hebben gefaald en dat er een nieuwe boom is berekend. De waarde <code>dot1dStpTimeSinceTopologyChange.0</code> laat zien wanneer dit gebeurde.</p></div><div class=paragraph><p>Om meerdere bridge-interfaces te monitoren kan men het privé BEGEMOT-BRIDGE-MIB gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% snmpwalk <span class=nt>-v</span> 2c <span class=nt>-c</span> public bridge1.example.com
enterprises.fokus.begemot.begemotBridge
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseName.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> STRING: bridge0
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseName.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> STRING: bridge2
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseAddress.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> STRING: e:ce:3b:5a:9e:13
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseAddress.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> STRING: 12:5e:4d:74:d:fc
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseNumPorts.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> INTEGER: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseNumPorts.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> INTEGER: 1
...
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTimeSinceTopologyChange.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> Timeticks: <span class=o>(</span>116927<span class=o>)</span> 0:19:29.27 centi-seconds
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTimeSinceTopologyChange.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> Timeticks: <span class=o>(</span>82773<span class=o>)</span> 0:13:47.73 centi-seconds
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTopChanges.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> Counter32: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTopChanges.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> Counter32: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeStpDesignatedRoot.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> Hex-STRING: 80 00 00 40 95 30 5E 31
BEGEMOT-BRIDGE-MIB::begemotBridgeStpDesignatedRoot.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> Hex-STRING: 80 00 00 50 8B B8 C6 A9</code></pre></div></div><div class=paragraph><p>Om de bridge-interface die via de subboom <code>mib-2.dot1dBridge</code> wordt gemonitord te veranderen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% snmpset <span class=nt>-v</span> 2c <span class=nt>-c</span> private bridge1.example.com
BEGEMOT-BRIDGE-MIB::begemotBridgeDefaultBridgeIf.0 s bridge2</code></pre></div></div></div></div></div><div class=sect2><h3 id=network-aggregation>31.6. Verbindingsaggregatie en failover<a class=anchor href=#network-aggregation></a></h3><div class=sect3><h4 id=_introductie_3>31.6.1. Introductie<a class=anchor href=#_introductie_3></a></h4><div class=paragraph><p>De interface <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> maakt het mogelijk om meerdere netwerkinterfaces te aggregeren in één virtueel interface voor het bieden van fout-tolerante en zeer snelle verbindingen.</p></div></div><div class=sect3><h4 id=_werkmodi>31.6.2. Werkmodi<a class=anchor href=#_werkmodi></a></h4><div class=dlist><dl><dt class=hdlist1>Failover</dt><dd><p>Zendt en ontvangt verkeer alleen door de meesterpoort. Wanneer de meesterpoort niet beschikbaar is, wordt de volgende actieve poort gebruikt. De eerste toegevoegde interface is de meesterpoort; alle interfaces die hierna zijn toegevoegd worden gebruikt als failover-apparaten. Als failover naar een niet-meesterpoort plaatsvindt, dan wordt de originele poort de meester wanneer deze weer beschikbaar wordt.</p></dd><dt class=hdlist1>Cisco® Fast EtherChannel®</dt><dd><p>Cisco® Fast EtherChannel® (FEC), is een statische installatie en onderhandelt niet over aggregatie met de peer noch wisselt het frames uit om de verbinding te monitoren. Indien de switch LACP ondersteunt dient dat gebruikt te worden.</p><div class=paragraph><p>FEC balanceert uitgaand verkeer over de actieve poorten gebaseerd op gehashde informatie over protocolheaders en accepteert inkomend verkeer van elke actieve poort. De hash bevat het Ethernet bron- en doeladres, en indien beschikbaar, de VLAN-tag, en de IPv4/IPv6 bron- en doeladressen.</p></div></dd><dt class=hdlist1>LACP</dt><dd><p>Het IEEE® 802.3ad Link Aggregation Control Protocol (LACP) en het Marker Protocol. LACP onderhandelt met de peer over een verzameling aggregeerbare verbindingen in één of meerdere Link Aggregated Groups (LAG). Elke LAG is opgebouwd uit poorten die dezelfde snelheid hebben, ingesteld op full-duplex werking. Het verkeer zal over de poorten in de LAG gebalanceerd worden met de hoogste totaalsnelheid, in de meeste gevallen zal er slechts één LAG zijn die alle poorten bevat. Wanneer er fysieke verbindingen veranderen, zal Link Aggregation snel naar een nieuwe opstelling convergeren.</p><div class=paragraph><p>LACP balanceert uitgaand verkeer over de actieve poorten gebaseerd op gehashde informatie over protocolheaders en accepteert inkomend verkeer van elke actieve poort. De hash bevat het Ethernet bron- en doeladres, en indien beschikbaar, de VLAN-tag, en de IPv4/IPv6 bron- en doeladressen.</p></div></dd><dt class=hdlist1>Loadbalance</dt><dd><p>Dit is een alias van de <em>FEC</em> modus.</p></dd><dt class=hdlist1>Round-Robin</dt><dd><p>Distribueert uitgaand verkeer door middel van een round-robin scheduler over alle actieve poorten en accepteert inkomend verkeer van elke actieve poort. Deze modus schendt Ethernet frame-ordering en dient met zorg gebruikt te worden.</p></dd></dl></div></div><div class=sect3><h4 id=_voorbeelden_5>31.6.3. Voorbeelden<a class=anchor href=#_voorbeelden_5></a></h4><div id=networking-lacp-aggregation-cisco class=exampleblock><div class=title>Voorbeeld 37. LACP-aggregatie met een Cisco® switch</div><div class=content><div class=paragraph><p>Dit voorbeeld verbindt twee interfaces op een FreeBSD-machine met de switch als een enkele loadgebalanceerde en fout-tolerante verbinding. Er kunnen meer interfaces worden toegevoegd om de doorvoer en fouttolerantie te verhogen. Aangezien frame-ordering verplicht is op Ethernetverbindingen stroomt al het verkeer tussen twee stations altijd over dezelfde fysieke verbinding zodat de maximum snelheid beperkt wordt tot die van één interface. Het verzendalgoritme probeert zoveel mogelijk informatie te gebruiken voor het onderscheiden van verschillende verkeersstromen en deze over de beschikbare interfaces te balanceren.</p></div><div class=paragraph><p>Voeg op de Cisco® switch de interfaces <em>FastEthernet0/1</em> en <em>FastEthernet0/2</em> aan de kanaalgroep <em>1</em> toe:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>interface FastEthernet0/1
 channel-group 1 mode active
 channel-protocol lacp
<span class=o>!</span>
interface FastEthernet0/2
 channel-group 1 mode active
 channel-protocol lacp</code></pre></div></div><div class=paragraph><p>Maak de <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a>-interface aan met <em>fxp0</em> en <em>fxp1</em> en activeer de interface met IP-adres <em>10.0.0.3/24</em>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig fxp0 up</span>
<span class=c># ifconfig fxp1 up</span>
<span class=c># ifconfig lagg0 create</span>
<span class=c># ifconfig lagg0 up laggproto lacp laggport fxp0 laggport fxp1 10.0.0.3/24</span></code></pre></div></div><div class=paragraph><p>Bekijk de interfacestatus van ifconfig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0</span></code></pre></div></div><div class=paragraph><p>Poorten die als <em>ACTIVE</em> zijn gemarkeerd zijn lid van de actieve aggregatiegroep waarover onderhandeld is met de verre switch en waarover verkeer zal worden verzonden en ontvangen. Gebruik de uitgebreide uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> om de LAG-identifiers te bekijken.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>lagg0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>8&lt;VLAN_MTU&gt;
        ether 00:05:5d:71:8d:b8
        media: Ethernet autoselect
        status: active
        laggproto lacp
        laggport: fxp1 <span class=nv>flags</span><span class=o>=</span>1c&lt;ACTIVE,COLLECTING,DISTRIBUTING&gt;
        laggport: fxp0 <span class=nv>flags</span><span class=o>=</span>1c&lt;ACTIVE,COLLECTING,DISTRIBUTING&gt;</code></pre></div></div><div class=paragraph><p>Gebruik, om de toestand van de poorten op de switch te bekijken, <code>show lacp neighbor</code>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>switch# show lacp neighbor
Flags:  S - Device is requesting Slow LACPDUs
        F - Device is requesting Fast LACPDUs
        A - Device is <span class=k>in </span>Active mode       P - Device is <span class=k>in </span>Passive mode

Channel group 1 neighbors

Partner<span class=s1>&#39;s information:

                  LACP port                        Oper    Port     Port
Port      Flags   Priority  Dev ID         Age     Key     Number   State
Fa0/1     SA      32768     0005.5d71.8db8  29s    0x146   0x3      0x3D
Fa0/2     SA      32768     0005.5d71.8db8  29s    0x146   0x4      0x3D</span></code></pre></div></div><div class=paragraph><p>Gebruik voor meer detail het commando <code>show lacp neighbor detail</code>.</p></div><div class=paragraph><p>Voeg de volgende regels aan <span class=filename>/etc/rc.conf</span> toe om deze informatie na het opnieuw starten te behouden:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;up&#34;
ifconfig_fxp1=&#34;up&#34;
cloned_interfaces=&#34;lagg0&#34;
ifconfig_lagg0=&#34;laggproto lacp laggport fxp0 laggport fxp1 10.0.0.3/24&#34;</pre></div></div></div></div><div id=networking-lagg-failover class=exampleblock><div class=title>Voorbeeld 38. Failover-modus</div><div class=content><div class=paragraph><p>Failover-modus kan worden gebruikt om op een secondaire interface over te schakelen wanneer de verbinding op de meesterinterface verloren is. Activeer de onderliggende fysieke interface. Creëer de interface <code>lagg0</code>, met <em>fxp0</em> als de meesterinterface en <em>fxp1</em> als de secondaire interface en ken er IP-adres <em>10.0.0.15/24</em> aan toe:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig fxp0 up</span>
<span class=c># ifconfig fxp1 up</span>
<span class=c># ifconfig lagg0 create</span>
<span class=c># ifconfig lagg0 up laggproto failover laggport fxp0 laggport fxp1 10.0.0.15/24</span></code></pre></div></div><div class=paragraph><p>De interface zal er ongeveer als volgt uitzien, de grote verschillen zullen het MAC-adres en de apparaatnamen zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0</span>
lagg0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>8&lt;VLAN_MTU&gt;
        ether 00:05:5d:71:8d:b8
        inet 10.0.0.15 netmask 0xffffff00 broadcast 10.0.0.255
        media: Ethernet autoselect
        status: active
        laggproto failover
        laggport: fxp1 <span class=nv>flags</span><span class=o>=</span>0&lt;<span class=o>&gt;</span>
        laggport: fxp0 <span class=nv>flags</span><span class=o>=</span>5&lt;MASTER,ACTIVE&gt;</code></pre></div></div><div class=paragraph><p>Het verkeer zal worden verzonden en ontvangen op <em>fxp0</em>. Indien de verbinding op <em>fxp0</em> verloren is, zal <em>fxp1</em> de actieve verbinding worden. Indien de verbinding op de meesterinterface hersteld is, zal het weer de actieve verbinding worden.</p></div><div class=paragraph><p>Voeg de volgende regels aan <span class=filename>/etc/rc.conf</span> toe om deze informatie na het opnieuw starten te behouden:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;up&#34;
ifconfig_fxp1=&#34;up&#34;
cloned_interfaces=&#34;lagg0&#34;
ifconfig_lagg0=&#34;laggproto lacp laggport fxp0 laggport fxp1 10.0.0.15/24&#34;</pre></div></div></div></div><div id=networking-lagg-wired-and-wireless class=exampleblock><div class=title>Voorbeeld 39. Failover-modus tussen bekabelde en draadloze interfaces</div><div class=content><div class=paragraph><p>Voor laptop-gebruikers is het normaliter wenselijk om het draadloze interface als secundair interface te gebruiken indien het bekabelde interface niet beschikbaar is. Met <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> is het mogelijk om één IP-adres te gebruiken en het bekabelde interface voor zowel prestatie als veiligheid te prefereren terwijl de mogelijkheid behouden blijft om de draadloze verbinding te gebruiken.</p></div><div class=paragraph><p>In deze opstelling dient het MAC-adres van het onderliggende draadloze interface overschreven te worden om met dat van <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> overeen te komen, welke afkomstig is van het primaire interface dat wordt gebruikt, het bekabelde interface.</p></div><div class=paragraph><p>In deze opstelling wordt het bekabelde interface, <em>bge0</em> als meester gebruikt, en het draadloze interface, <em>wlan0</em>, als het failover-interface. <em>wlan0</em> was aangemaakt vanuit <em>iwn0</em> voor welke het MAC-adres van de bekabelde verbinding zal worden gebruikt. De eerste stap is om het MAC-adres van het bekabelde interface te verkrijgen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c>#  ifconfig bge0</span>
bge0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
      <span class=nv>options</span><span class=o>=</span>19b&lt;RXCSUM,TXCSUM,VLAN_MTU,VLAN_HWTAGGING,VLAN_HWCSUM,TSO4&gt;
      ether 00:21:70:da:ae:37
      inet6 fe80::221:70ff:feda:ae37%bge0 prefixlen 64 scopeid 0x2
      nd6 <span class=nv>options</span><span class=o>=</span>29&lt;PERFORMNUD,IFDISABLED,AUTO_LINKLOCAL&gt;
      media: Ethernet autoselect <span class=o>(</span>1000baseT &lt;full-duplex&gt;<span class=o>)</span>
      status: active</code></pre></div></div><div class=paragraph><p><em>bge0</em> kan vervangen worden door het eigenlijke interface, er zal een andere regel met <code>ether</code> verschijnen, dit is het MAC-adres van het bekabelde interface. Om het onderliggende draadloze interface, <em>iwn0</em> te wijzigen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig iwn0 ether 00:21:70:da:ae:37</span></code></pre></div></div><div class=paragraph><p>Activeer het draadloze interface maar geef er nog geen IP-adres aan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev iwn0 ssid mijn_router up</span></code></pre></div></div><div class=paragraph><p>Activeer de interface <em>bge0</em>. Maak het <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a>-interface aan met <em>bge0</em> als meester, en met failover naar <em>wlan0</em> indien nodig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bge0 up</span>
<span class=c># ifconfig lagg0 create</span>
<span class=c># ifconfig lagg0 up laggproto failover laggport bge0 laggport wlan0</span></code></pre></div></div><div class=paragraph><p>Het interface zal er ongeveer als volgt uitzien, de grootste verschillen zullen het MAC-adres en de apparaatnamen zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0</span>
lagg0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
      <span class=nv>options</span><span class=o>=</span>8&lt;VLAN_MTU&gt;
      ether 00:21:70:da:ae:37
      media: Ethernet autoselect
      status: active
      laggproto failover
      laggport: wlan0 <span class=nv>flags</span><span class=o>=</span>0&lt;<span class=o>&gt;</span>
      laggport: bge0 <span class=nv>flags</span><span class=o>=</span>5&lt;MASTER,ACTIVE&gt;</code></pre></div></div><div class=paragraph><p>Start vervolgens de DHCP-cliënt om een IP-adres te verkrijgen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dhclient lagg0</span></code></pre></div></div><div class=paragraph><p>Om deze configuratie bij het opstarten te behouden, kan het volgende aan <span class=filename>/etc/rc.conf</span> worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_bge0=&#34;up&#34;
ifconfig_iwn0=&#34;ether 00:21:70:da:ae:37&#34;
wlans_iwn0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA&#34;
cloned_interfaces=&#34;lagg0&#34;
ifconfig_lagg0=&#34;laggproto failover laggport bge0 laggport wlan0 DHCP&#34;</pre></div></div></div></div></div></div><div class=sect2><h3 id=network-diskless>31.7. Schijfloos werken<a class=anchor href=#network-diskless></a></h3><div class=paragraph><p>Een FreeBSD-machine kan over het netwerk opstarten en zonder een plaatselijke schijf werken, door gebruik te maken van bestandssystemen die van een NFS-server aangekoppeld worden. Er zijn geen systeemwijzigingen nodig anders dan de standaard instellingenbestanden. Dit soort systemen is relatief eenvoudig op te zetten omdat alle noodzakelijke elementen al aanwezig zijn:</p></div><div class=ulist><ul><li><p>Er zijn minstens twee manieren om de kernel over het netwerk te laden:</p><div class=ulist><ul><li><p>PXE: De Intel® Preboot eXecution Environment is een vorm een smart boot ROM dat in sommige netwerkkaarten en moederborden is ingebouwd. Bekijk de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> voor meer informatie.</p></li><li><p>De poort Etherboot (<a class=package href=https://cgit.freebsd.org/ports/tree/net/etherboot/>net/etherboot</a>) maakt code aan dat naar een ROM geschreven kan worden en dat kernels over het netwerk opstart. De code kan òfwel naar een opstart-PROM op een netwerkkaart geflashed worden, òfwel van een floppy (of harde) schijf geladen worden, òfwel van een draaiend MS-DOS® systeem geladen worden. Vele netwerkkaarten worden ondersteund.</p></li></ul></div></li><li><p>Een voorbeeldscript (<span class=filename>/usr/shared/examples/diskless/clone_root</span>) vergemakkelijkt het aanmaken en beheren van het root bestandssysteem van het werkstation op de server. Het kan nodig zijn dat het script wat aangepast moet worden, maar het zorgt voor een snelle start.</p></li><li><p>Er bestaan standaardbestanden voor het opstarten van het systeem in <span class=filename>/etc</span> om een systeemstart zonder schijf te detecteren en te ondersteunen.</p></li><li><p>Het gebruik van een wisselbestand, indien nodig, kan worden gedaan naar òfwel een NFS bestand òfwel naar een plaatselijke schijf.</p></li></ul></div><div class=paragraph><p>Er zijn vele manieren om een schijfloos werkstation op te zetten. Hierbij zijn veel elementen betrokken, en vele kunnen aan de eigen smaak worden aangepast. Het volgende beschrijft variaties met betrekking tot het installeren van een compleet systeem, waarbij de nadruk ligt op de eenvoud en de compatibiliteit met de standaard opstartscripts van FreeBSD. Het beschreven systeem heeft de volgende eigenschappen:</p></div><div class=ulist><ul><li><p>De schijfloze werkstations gebruiken een gedeeld bestandssysteem voor <span class=filename>/</span>, dat alleen gelezen kan worden, en een gedeeld bestandssysteem voor <span class=filename>/usr</span>, dat eveneens alleen gelezen kan worden.</p><div class=paragraph><p>Het root-bestandssysteem is een kopie van een standaard root-bestandssysteem voor FreeBSD (typisch van een server), waarbij enkele instellingenbestanden zijn overschreven door versies die specifiek zijn voor een schijfloos systeem of, mogelijk, door het werkstation horen waar ze bij horen.</p></div><div class=paragraph><p>De delen van het root-bestandssysteem die beschrijfbaar moeten zijn, zijn overdekt met <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> bestandssystemen. Alle veranderingen gaan verloren indien het systeem opnieuw wordt opgestart.</p></div></li><li><p>De kernel is overgedragen en òfwel met Etherboot òfwel met PXE geladen, aangezien sommige situaties het gebruik van één van de methodes kan eisen.</p></li></ul></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Het systeem zoals hierboven beschreven is onveilig. Het dient in een beschermd gebied van een netwerk te functioneren, en niet vertrouwd te worden door andere hosts.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Alle informatie in deze sectie is getest met FreeBSD 5.2.1-RELEASE.</p></div><div class=sect3><h4 id=_achtergrondinformatie>31.7.1. Achtergrondinformatie<a class=anchor href=#_achtergrondinformatie></a></h4><div class=paragraph><p>Het installeren van schijfloze werkstations is zowel vrij rechttoe-rechtaan als foutgevoelig. Deze fouten zijn soms moeilijk vast te stellen wegens een aantal redenen. Bijvoorbeeld:</p></div><div class=ulist><ul><li><p>Opties die tijdens het compileren zijn opgegeven kunnen verschillend gedrag tonen tijdens het draaien.</p></li><li><p>Foutmeldingen zijn vaak cryptisch of geheel afwezig.</p></li></ul></div><div class=paragraph><p>Op dit gebied is het bezit van wat achtergrondkennis over de gebruikte mechanismen zeer nuttig om mogelijke problemen op te lossen.</p></div><div class=paragraph><p>Voor een succesvol opstarten dienen verschillende handelingen uitgevoerd te worden:</p></div><div class=ulist><ul><li><p>De machine moet een aantal initiële parameters zoals het IP-adres, de bestandsnaam van de executable, de naam van de server, en het root-pad verkrijgen. Dit wordt gedaan door gebruik te maken van de DHCP of BOOTP protocollen. DHCP is een compatible uitbreiding van BOOTP, het gebruikt dezelfde poorten en het pakketformaat heeft dezelfde basis.</p><div class=paragraph><p>Het is mogelijk om een systeem in te stellen zodat het alleen BOOTP gebruikt. Het serverprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=bootpd&amp;sektion=8&amp;format=html">bootpd(8)</a> wordt met het basissysteem van FreeBSD meegeleverd.</p></div><div class=paragraph><p>DHCP biedt echter een aantal voordelen boven BOOTP (fijnere instellingenbestanden, mogelijkheid om PXE te gebruiken, en vele anderen die niet direct verband houden met schijfloos werken), er zal hoofdzakelijk een opstelling met DHCP worden beschreven, met analoge voorbeelden voor <a href="https://man.freebsd.org/cgi/man.cgi?query=bootpd&amp;sektion=8&amp;format=html">bootpd(8)</a> indien mogelijk. De voorbeeldopstelling zal het softwarepakket van ISC DHCP gebruiken (versie 3.0.1.r12 was geïnstalleerd op de testserver).</p></div></li><li><p>De machine moet één of meerdere programma’s naar het plaatselijke geheugen versturen. Eén van TFTP of NFS wordt gebruikt. De keuze tussen TFTP en NFS is op verschillende plaatsen een optie tijdens het compileren. Een veelgemaakte fout is het opgeven van bestandsnamen voor het verkeerde protocol: TFTP verstuurd typisch alle bestanden vanuit één map op de server, en verwacht dat alle bestandsnamen relatief aan deze map zijn; NFS verwacht absolute bestandspaden.</p></li><li><p>De mogelijke tussentijdse opstartprogramma’s en de kernel dienen geïnitialiseerd en uitgevoerd te worden. Er zijn enkele belangrijke variaties op dit gebied:</p><div class=ulist><ul><li><p>PXE zal <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> laden, wat een aangepaste versie is van de lader voor stage drie van FreeBSD. <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> zal de meeste parameters verkrijgen die noodzakelijk zijn om het systeem op te starten, en zal ze in de kernelomgeving laten staan voordat het de controle overdraagt. Het is in dit geval mogelijk om een <span class=filename>GENERIC</span> kernel te gebruiken.</p></li><li><p>Etherboot zal met minder voorbereiding direct de kernel laden. Hiervoor is het noodzakelijk om een kernel met specifieke opties te bouwen.</p><div class=paragraph><p>PXE en Etherboot werken beide even goed; echter, omdat kernels normaalgesproken meer werk overlaten aan <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a>, is PXE de te verkiezen methode.</p></div><div class=paragraph><p>Indien het BIOS en de netwerkkaarten PXE ondersteunen, dient dat waarschijnlijk gebruikt te worden.</p></div></li></ul></div></li><li><p>Tenslotte: de machine heeft toegang tot de bestandssystemen nodig. NFS wordt in alle gevallen gebruikt.</p></li></ul></div><div class=paragraph><p>Zie ook de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=diskless&amp;sektion=8&amp;format=html">diskless(8)</a>.</p></div></div><div class=sect3><h4 id=_installatie_instructies>31.7.2. Installatie-instructies<a class=anchor href=#_installatie_instructies></a></h4><div class=sect4><h5 id=_instellen_met_behulp_van_isc_dhcp>31.7.2.1. Instellen met behulp van ISC DHCP<a class=anchor href=#_instellen_met_behulp_van_isc_dhcp></a></h5><div class=paragraph><p>De ISC DHCP server kan zowel verzoeken voor BOOTP als DHCP beantwoorden.</p></div><div class=paragraph><p>ISC DHCP 4.2 maakt geen deel uit van het basissysteem. Eerst dient de poort <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-server/>net/isc-dhcp42-server</a> of het corresponderende pakket geïnstalleerd te worden.</p></div><div class=paragraph><p>Wanneer ISC DHCP is geïnstalleerd, heeft het een instellingenbestand nodig om te draaien (normaliter <span class=filename>/usr/local/etc/dhcpd.conf</span> genoemd). Hieronder volgt een voorbeeld met commentaar, waarbij host <code>margaux</code> gebruik maakt van Etherboot en <code>corbieres</code> gebruik maakt van PXE:</p></div><div class="literalblock programlisting"><div class=content><pre>default-lease-time 600;
max-lease-time 7200;
authoritative;

option domain-name &#34;example.com&#34;;
option domain-name-servers 192.168.4.1;
option routers 192.168.4.1;

subnet 192.168.4.0 netmask 255.255.255.0 {
  use-host-decl-names on; <i class=conum data-value=1></i><b>(1)</b>
  option subnet-mask 255.255.255.0;
  option broadcast-address 192.168.4.255;

  host margaux {
    hardware ethernet 01:23:45:67:89:ab;
    fixed-address margaux.example.com;
    next-server 192.168.4.4; <i class=conum data-value=2></i><b>(2)</b>
    filename &#34;/data/misc/kernel.diskless&#34;; <i class=conum data-value=3></i><b>(3)</b>
    option root-path &#34;192.168.4.4:/data/misc/diskless&#34;; <i class=conum data-value=4></i><b>(4)</b>
  }
  host corbieres {
    hardware ethernet 00:02:b3:27:62:df;
    fixed-address corbieres.example.com;
    next-server 192.168.4.4;
    filename &#34;pxeboot&#34;;
    option root-path &#34;192.168.4.4:/data/misc/diskless&#34;;
  }
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Deze optie vertelt dhcpd om de waarde die in de verklaringen voor <code>host</code> staan te versturen als de hostnaam voor de schijfloze host. Een andere mogelijkheid is om <code>option host-name margaux</code> binnen de verklaringen voor <code>host</code> op te nemen.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>De aanwijzing <code>next-server</code> bepaalt de TFTP of NFS server die gebruikt moet worden voor het laden van het lader- of kernelbestand (standaard wordt dezelfde host als voor de DHCP-server gebruikt).</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>De aanwijzing <code>filename</code> bepaalt het bestand dat Etherboot of PXE gebruikt voor de volgende uitvoerstap. Het dient gespecificeerd te worden volgens de gebruikte verzendmethode. Voor Etherboot kan tijdens het compileren worden opgegeven of het NFS of TFTP moet gebruiken. De FreeBSD-poort stelt standaard NFS in. PXE gebruikt TFTP, vandaar dat hier een relatieve bestandsnaam wordt gebruikt (dit kan afhangen van de instellingen van de TFTP-server, maar het is de gewoonte). Verder geldt dat PXE <span class=filename>pxeboot</span> en niet de kernel laadt. Er zijn andere interessante mogelijkheden, zoals het laden van <span class=filename>pxeboot</span> vanuit de map <span class=filename>/boot</span> van een FreeBSD CD-ROM (aangezien <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> de <span class=filename>GENERIC</span> kernel kan laden, bestaat de mogelijkheid om PXE te gebruiken om van een CDROM op afstand op te starten.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>De optie <code>root-path</code> definieert het pad naar het root-bestandssysteem, in de gebruikelijke notatie van NFS. Indien PXE gebruikt wordt, is het mogelijk om het IP-adres van de host weg te laten zolang de kerneloptie BOOTP niet geactiveerd is. De NFS-server is dan dezelfde als die van TFTP.</td></tr></tbody></table></div></div><div class=sect4><h5 id=_configuratie_door_gebruik_van_bootp>31.7.2.2. Configuratie door gebruik van BOOTP<a class=anchor href=#_configuratie_door_gebruik_van_bootp></a></h5><div class=paragraph><p>Hieronder staan de equivalente instellingen voor bootpd (gereduceerd tot één cliënt). Dit staat in <span class=filename>/etc/bootptab</span>.</p></div><div class=paragraph><p>Merk op dat Etherboot gecompileerd dient te worden met de afwijkende optie <code>NO_DHCP_SUPPORT</code> om BOOTP te gebruiken, en dat PXEDHCP <em>nodig heeft</em>. Het enige duidelijke voordeel van bootpd is dat het in het basissysteem zit.</p></div><div class="literalblock programlisting"><div class=content><pre>.def100:\
  :hn:ht=1:sa=192.168.4.4:vm=rfc1048:\
  :sm=255.255.255.0:\
  :ds=192.168.4.1:\
  :gw=192.168.4.1:\
  :hd=&#34;/tftpboot&#34;:\
  :bf=&#34;/kernel.diskless&#34;:\
  :rp=&#34;192.168.4.4:/data/misc/diskless&#34;:

margaux:ha=0123456789ab:tc=.def100</pre></div></div></div><div class=sect4><h5 id=_een_opstartprogramma_voorbereiden_met_etherboot>31.7.2.3. Een opstartprogramma voorbereiden met Etherboot<a class=anchor href=#_een_opstartprogramma_voorbereiden_met_etherboot></a></h5><div class=paragraph><p>De <a href=http://etherboot.sourceforge.net>website van Etherboot</a> bevat <a href=http://etherboot.sourceforge.net/doc/html/userman/t1.html>uitgebreide documentatie</a> die over het algemeen is bedoeld voor Linux-systemen, maar die desalniettemin bruikbare informatie bevat. Het volgende geeft een samenvatting over hoe Etherboot op een FreeBSD-systeem te gebruiken.</p></div><div class=paragraph><p>Ten eerste dient het pakket of de poort <a class=package href=https://cgit.freebsd.org/ports/tree/net/etherboot/>net/etherboot</a> geïnstalleerd te worden.</p></div><div class=paragraph><p>De instellingen van Etherboot (i.e., om TFTP in plaats van NFS te gebruiken) kunnen gewijzigd worden door het bestand <span class=filename>Config</span> in de bronmap van Etherboot te bewerken.</p></div><div class=paragraph><p>Hieronder zal een opstartdiskette gebruikt worden. Raadpleeg voor andere methoden (PROM, of een MS-DOS®-programma) de documentatie van Etherboot.</p></div><div class=paragraph><p>Om een opstartdiskette te maken, dient er een diskette in het diskettestation van de machine aanwezig te zijn waarop Etherboot is geïnstalleerd, daarna dient er naar de map <span class=filename>src</span> in de mapboom van Etherboot gegaan te worden, en het volgende ingetypt te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmake bin32/apparaatsoort.fd0</span></code></pre></div></div><div class=paragraph><p><em>apparaatsoort</em> hangt af van het soort Ethernetkaart dat in het schijfloze werkstation aanwezig is. Raadpleeg het bestand <span class=filename>NIC</span> in dezelfde map om het juiste <em>apparaatsoort</em> te bepalen.</p></div></div><div class=sect4><h5 id=_opstarten_met_pxe>31.7.2.4. Opstarten met PXE<a class=anchor href=#_opstarten_met_pxe></a></h5><div class=paragraph><p>Standaard laadt de lader <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> de kernel via NFS. Het kan zodanig gecompileerd worden dat het TFTP gebruikt door de optie <code>LOADER_TFTP_SUPPORT</code> in <span class=filename>/etc/make.conf</span> te specificeren. Raadpleeg het commentaar in <span class=filename>/usr/shared/examples/etc/make.conf</span> voor instructies.</p></div><div class=paragraph><p>Er zijn nog twee andere opties voor <span class=filename>make.conf</span> die nuttig kunnen zijn bij het opzetten van een schijfloze machine die als seriële console gebruikt wordt: <code>BOOT_PXELDR_PROBE_KEYBOARD</code>, en <code>BOOT_PXELDR_ALWAYS_SERIAL</code>.</p></div><div class=paragraph><p>Om PXE bij het opstarten van de machine te gebruiken, is het gewoonlijk nodig om de optie <code>Boot from network</code> in het BIOS te selecteren, of om een functietoets tijdens de initialisatie van de PC in te typen.</p></div></div><div class=sect4><h5 id=_de_tftp_en_nfs_servers_instellen>31.7.2.5. De TFTP en NFS servers instellen<a class=anchor href=#_de_tftp_en_nfs_servers_instellen></a></h5><div class=paragraph><p>Indien PXE of Etherboot gebruikt wordt, welke is ingesteld om TFTP te gebruiken, is het nodig om tftpd op de bestandsserver aan te zetten:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Maak een map aan van waaruit tftpd de bestanden serveert, bijvoorbeeld <span class=filename>/tftpboot</span>.</p></li><li><p>Voeg deze regel toe aan <span class=filename>/etc/inetd.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>tftp	dgram	udp	wait	root	/usr/libexec/tftpd	tftpd -l -s /tftpboot</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het schijnt dat sommige versies van PXE de TCP-versie van TFTP vereisen. In dit geval dient een tweede regel toegevoegd te worden, waarbij <code>dgram udp</code> door <code>stream tcp</code> vervangen wordt.</p></div></td></tr></tbody></table></div></li><li><p>inetd dient de instellingenbestanden opnieuw te lezen. De regel <code>inetd_enable="YES"</code> dient in het bestand <span class=filename>/etc/rc.conf</span> aanwezig te zijn voor de juiste werking van deze opdracht:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd restart</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>De map <span class=filename>tftpboot</span> kan overal op de server geplaatst worden. De plaats dient zowel in <span class=filename>inetd.conf</span> als in <span class=filename>dhcpd.conf</span> ingesteld te worden.</p></div><div class=paragraph><p>In alle gevallen dient er ook voor gezorgd te worden dat NFS aanstaat en dat het juiste bestandssysteem op de NFS-server geëxporteerd wordt.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Voeg het volgende toe aan <span class=filename>/etc/rc.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>nfs_server_enable=&#34;YES&#34;</pre></div></div></li><li><p>Exporteer het bestandssysteem waar de schijfloze root-map zich bevindt door het volgende aan <span class=filename>/etc/exports</span> toe te voegen (pas het aankoppelpunt van het volume aan en vervang <em>margaux corbieres</em> door de namen van de schijfloze werkstations):</p><div class="literalblock programlisting"><div class=content><pre>/data/misc -alldirs -ro margaux corbieres</pre></div></div></li><li><p>mountd dient het instellingenbestand opnieuw te lezen. Indien het nodig was om NFS in <span class=filename>/etc/rc.conf</span> tijdens de eerste stap aan te zetten, is het waarschijnlijk gewenst om in plaats hiervan opnieuw op te starten.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service mountd restart</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect4><h5 id=_een_schijfloze_kernel_bouwen>31.7.2.6. Een schijfloze kernel bouwen<a class=anchor href=#_een_schijfloze_kernel_bouwen></a></h5><div class=paragraph><p>Indien Etherboot gebruikt wordt, is het nodig om een kernelinstellingenbestand voor de schijfloze cliënt met de volgende opties (naast de gebruikelijke) aan te maken:</p></div><div class="literalblock programlisting"><div class=content><pre>options	BOOTP		# Gebruik BOOTP om het IP-adres en de hostnaam te verkrijgen
options	BOOTP_NFSROOT	# NFS-mount het root-bestandssysteem door gebruik te maken van de informatie van BOOTP</pre></div></div><div class=paragraph><p>Het kan ook gewenst zijn om <code>BOOTP_NFSV3</code>, <code>BOOT_COMPAT</code>, en <code>BOOTP_WIRED_TO</code> te gebruiken (raadpleeg hiervoor <span class=filename>NOTES</span>).</p></div><div class=paragraph><p>De namen van deze opties zijn historisch en enigszins misleidend aangezien ze eigenlijk onverschillig gebruik van DHCP en BOOTP in de kernel mogelijk maken (het is ook mogelijk om strikt gebruik van BOOTP of DHCP te forceren).</p></div><div class=paragraph><p>De kernel dient gebouwd te worden (zie <a href=./#kernelconfig>De FreeBSD-kernel instellen</a>) en gekopieerd te worden naar de plaats die in <span class=filename>dhcpd.conf</span> is aangegeven.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien PXE gebruikt wordt, is het bouwen van een kernel met bovenstaande opties niet strikt noodzakelijk (maar wel aangeraden). Door deze opties aan te zetten zullen er meer verzoeken voor DHCP tijdens het opstarten van de kernel verstuurd worden, met in sommige speciale gevallen een klein risico op inconsistentie tussen de nieuwe waarden en degenen die door <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> zijn ontvangen. Het voordeel van het gebruik van deze opties is dat de hostnaam als een bijverschijnsel wordt ingesteld. In de andere gevallen dient de hostnaam op een andere manier ingesteld te worden, bijvoorbeeld in een cliënt-specifiek bestand <span class=filename>rc.conf</span>.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Om laadbaar te zijn met Etherboot, dienen de apparaataanwijzingen in de kernel gecompileerd te worden. Normaalgesproken wordt hiervoor de volgende optie in het instellingenbestand gebruikt (zie het instellingencommentaarbestand <span class=filename>NOTES</span>):</p></div><div class="literalblock programlisting"><div class=content><pre>hints		&#34;GENERIC.hints&#34;</pre></div></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_het_root_bestandssysteem_voorbereiden>31.7.2.7. Het root-bestandssysteem voorbereiden<a class=anchor href=#_het_root_bestandssysteem_voorbereiden></a></h5><div class=paragraph><p>Er dient een root-bestandssysteem voor de schijfloze werkstations op de plaats die als <code>root-path</code> in <span class=filename>dhcpd.conf</span> staat aangegeven aangemaakt te worden.</p></div><div class=sect5><h6 id=_make_world_gebruiken_om_het_root_bestandssysteem_te_bevolken>31.7.2.7.1. <code>make world</code> gebruiken om het root-bestandssysteem te bevolken<a class=anchor href=#_make_world_gebruiken_om_het_root_bestandssysteem_te_bevolken></a></h6><div class=paragraph><p>Deze methode is snel en installeert een compleet maagdelijk systeem (niet alleen het root-bestandssysteem) in <code>DESTDIR</code>. Hiervoor dient slechts het volgende script uitgevoerd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
export DESTDIR=/data/misc/diskless
mkdir -p ${DESTDIR}
cd /usr/src; make buildworld &amp;&amp; make buildkernel
make installworld &amp;&amp; make installkernel
cd /usr/src/etc; make distribution</pre></div></div><div class=paragraph><p>Nadat dit gedaan is, kunnen <span class=filename>/etc/rc.conf</span> en <span class=filename>/etc/fstab</span> die in <code>DESTDIR</code> geplaatst zijn naar behoefte worden aangepast.</p></div></div></div><div class=sect4><h5 id=_swapruimte_instellen>31.7.2.8. Swapruimte instellen<a class=anchor href=#_swapruimte_instellen></a></h5><div class=paragraph><p>Indien nodig kan een wisselbestand dat zich op de server bevindt via NFS worden benaderd.</p></div><div class=sect5><h6 id=_swapruimte_via_nfs>31.7.2.8.1. Swapruimte via NFS<a class=anchor href=#_swapruimte_via_nfs></a></h6><div class=paragraph><p>De kernel biedt geen ondersteuning om swapruimte via NFS tijdens het opstarten aan te zetten. De swapruimte moet door de opstartscripts worden aangezet, door een beschrijfbaar bestandssysteem aan te koppelen en een wisselbestand aan te maken en aan te zetten. De volgende opdracht maakt een wisselbestand van de juiste grootte aan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/pad/naar/wisselbestand bs=1k count=1 oseek=100000</span></code></pre></div></div><div class=paragraph><p>Om het aan te zetten dient de volgende regel aan <span class=filename>/etc/rc.conf</span> te worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>swapfile=/pad/naar/wisselbestand</pre></div></div></div></div><div class=sect4><h5 id=_diverse_problemen>31.7.2.9. Diverse problemen<a class=anchor href=#_diverse_problemen></a></h5><div class=sect5><h6 id=_draaien_met_een_alleen_lezen_usr>31.7.2.9.1. Draaien met een alleen-lezen <span class=filename>/usr</span><a class=anchor href=#_draaien_met_een_alleen_lezen_usr></a></h6><div class=paragraph><p>Indien het schijfloze werkstation is ingesteld om X te draaien, is het nodig om het instellingenbestand van XDM te wijzigen, dat standaard het foutenlogboek in <span class=filename>/usr</span> plaatst.</p></div></div><div class=sect5><h6 id=_gebruik_maken_van_een_niet_freebsd_server>31.7.2.9.2. Gebruik maken van een niet-FreeBSD-server<a class=anchor href=#_gebruik_maken_van_een_niet_freebsd_server></a></h6><div class=paragraph><p>Indien de server voor het root-bestandssysteem geen FreeBSD draait, is het nodig om het root-bestandssysteem op een FreeBSD-machine aan te maken, en het daarna naar de bestemming te kopiëren, door gebruik te maken van <code>tar</code> of <code>cpio</code>.</p></div><div class=paragraph><p>In deze situatie zijn er af en toe problemen met de speciale bestanden in <span class=filename>/dev</span>, vanwege verschillen in de groottes van grote/kleine integers. Een oplossing voor dit probleem is om een map van de niet-FreeBSD-server te exporteren, deze map op een FreeBSD-machine aan te koppelen, en <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> te gebruiken om de apparaatknooppunten transparant voor de gebruiker toe te wijzen.</p></div></div></div></div></div><div class=sect2><h3 id=network-pxe-nfs>31.8. Met PXE en een NFS-root-bestandssysteem opstarten<a class=anchor href=#network-pxe-nfs></a></h3><div class=paragraph><p>Het Preboot eXecution Environment (PXE) van Intel® maakt het mogelijk om het besturingssysteem over het netwerk op te starten. Ondersteuning voor PXE wordt normaliter aangeboden in het BIOS van moderne moederborden, waar het kan worden aangezet in de instellingen van het BIOS wat opstarten over het netwerk mogelijk maakt. Een volledig werkende PXE-opstelling vereist ook correct geconfigureerde DHCP- en TFTP-servers.</p></div><div class=paragraph><p>Wanneer de gastheercomputer opstart, krijgt het informatie over DHCP over waar de intiële bootloader staat via TFTP. Nadat de gastheercomputer deze informatie heeft ontvangen, downloadt het de bootloader via TFTP en voert het vervolgens de bootloader uit. Dit is gedocumenteerd in sectie 2.2.1 van de <a href=http://download.intel.com/design/archives/wfm/downloads/pxespec.pdf>Preboot Execution Environment (PXE) Specification</a>. In FreeBSD is de bootloader die tijdens het PXE-proces wordt opgehaald <span class=filename>/boot/pxeboot</span>. Terwijl <span class=filename>/boot/pxeboot</span> wordt uitgevoerd, wordt de kernel van FreeBSD geladen en wordt er verder gegaan met de rest van de opstartprocedure van FreeBSD. Kijk voor meer informatie over het opstartproces van FreeBSD in <a href=./#boot>Het FreeBSD opstartproces</a>.</p></div><div class=sect3><h4 id=_de_chroot_omgeving_voor_het_nfs_root_bestandssysteem_instellen>31.8.1. De <code>chroot</code>-omgeving voor het NFS-root-bestandssysteem instellen<a class=anchor href=#_de_chroot_omgeving_voor_het_nfs_root_bestandssysteem_instellen></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Kies een map uit voor een installatie van FreeBSD die over NFS aangekoppeld kan worden. Bijvoorbeeld een map als <span class=filename>/b/tftpboot/FreeBSD/install</span>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># export NFSROOTDIR=/b/tftpboot/FreeBSD/install</span>
<span class=c># mkdir -p ${NFSROOTDIR}</span></code></pre></div></div></li><li><p>Stel de NFS-server in door de instructies in <a href=./#network-configuring-nfs>NFS instellen</a> op te volgen.</p></li><li><p>Exporteer de map via NFS door het volgende aan <span class=filename>/etc/exports</span> toe te voegen:</p><div class="literalblock programlisting"><div class=content><pre>/b -ro -alldirs</pre></div></div></li><li><p>Herstart de NFS-server:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service nfsd restart</span></code></pre></div></div></li><li><p>Stel <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> in door de stappen zoals in <a href=./#network-inetd-settings>Instellingen</a> beschreven op te volgen.</p></li><li><p>Voeg de volgende regel toe aan <span class=filename>/etc/inetd.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>tftp dgram udp wait root /usr/libexec/tftpd tftpd -l -s /b/tftpboot</pre></div></div></li><li><p>Herstart inetd:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd restart</span></code></pre></div></div></li><li><p><a href=#makeworld>Herbouw de kernel en userland van FreeBSD</a>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make buildworld</span>
<span class=c># make buildkernel</span></code></pre></div></div></li><li><p>Installeer FreeBSD in de map die over NFS is aangekoppeld:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make installworld DESTDIR=${NFSROOTDIR}</span>
<span class=c># make installkernel DESTDIR=${NFSROOTDIR}</span>
<span class=c># make distribution DESTDIR=${NFSROOTDIR}</span></code></pre></div></div></li><li><p>Test dat de TFTP-server werkt en dat het de bootloader dat via PXE verkregen zal worden kan downloaden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tftp localhost</span>
tftp&gt; get FreeBSD/install/boot/pxeboot
Received 264951 bytes <span class=k>in </span>0.1 seconds</code></pre></div></div></li><li><p>Voeg een regel aan <span class=filename>${NFSROOTDIR}/etc/fstab</span> toe om het root-bestandssysteem over NFS aan te koppelen:</p><div class="literalblock programlisting"><div class=content><pre># Device                                            Mountpoint    FSType   Options  Dump Pass
mijnhost.example.com:/b/tftpboot/FreeBSD/install      /         nfs      ro        0    0</pre></div></div><div class=paragraph><p>Vervang <em>mijnhost.example.com</em> door de hostnaam of het IP-adres van uw NFS-server. In dit voorbeeld wordt het root-bestandssysteem als alleen-lezen aangekoppeld om te voorkomen dat NFS-cliënten per ongeluk de inhoud van het root-bestandssysteem wissen.</p></div></li><li><p>Stel het root-wachtwoord in voor de <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a>-omgeving.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chroot ${NFSROOTDIR}</span>
<span class=c># passwd</span></code></pre></div></div><div class=paragraph><p>Dit stelt het root-wachtwoord in voor cliëntmachines die over PXE opstarten.</p></div></li><li><p>Maak root-logins over SSH mogelijk voor cliëntmachines die met PXE opstarten door <span class=filename>${NFSROOTDIR}/etc/ssh/sshd_config</span> te bewerken en de optie <code>PermitRootLogin</code> aan te zetten. Dit is gedocumenteerd in <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd_config&amp;sektion=5&amp;format=html">sshd_config(5)</a>.</p></li><li><p>Pas andere wijzigingen toe aan de <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a>-omgeving in ${NFSROOTDIR}. Deze wijzigingen zouden het toevoegen van pakketten met <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>, het bewerken van het wachtwoordbestand met <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> of het bewerken van <a href="https://man.freebsd.org/cgi/man.cgi?query=amd.conf&amp;sektion=8&amp;format=html">amd.conf(8)</a>-projecties voor automatisch aankoppelen kunnen zijn. Bijvoorbeeld:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chroot ${NFSROOTDIR}</span>
<span class=c># pkg_add -r bash</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=_geheugenbestandssystemen_die_gebruikt_worden_door_etcrc_initdiskless_configureren>31.8.2. Geheugenbestandssystemen die gebruikt worden door <span class=filename>/etc/rc.initdiskless</span> configureren<a class=anchor href=#_geheugenbestandssystemen_die_gebruikt_worden_door_etcrc_initdiskless_configureren></a></h4><div class=paragraph><p>Als u vanaf een NFS-rootvolume opstart, detecteert <span class=filename>/etc/rc</span> dat u over NFS opstartte en draait het het script <span class=filename>/etc/rc.initdiskless</span>. Lees het commentaar in dit script om te begrijpen wat er gebeurt. Het is nodig om <span class=filename>/etc</span> en <span class=filename>/var</span> geheugen-backed te maken omdat deze mappen schrijfbaar moeten zijn, maar de NFS-rootmap is alleen-lezen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chroot ${NFSROOTDIR}</span>
<span class=c># mkdir -p conf/base</span>
<span class=c># tar -c -v -f conf/base/etc.cpio.gz --format cpio --gzip etc</span>
<span class=c># tar -c -v -f conf/base/var.cpio.gz --format cpio --gzip var</span></code></pre></div></div><div class=paragraph><p>Wanneer het systeem opstart, zullen er geheugen-bestandssystemen voor <span class=filename>/etc</span> en <span class=filename>/var</span> worden aangemaakt en aangekoppeld, en zal de inhoud van de <span class=filename>cpio.gz</span>-bestanden er naartoe worden gekopieerd.</p></div></div><div class=sect3><h4 id=network-pxe-setting-up-dhcp>31.8.3. Een DHCP-server prepareren<a class=anchor href=#network-pxe-setting-up-dhcp></a></h4><div class=paragraph><p>PXE heeft een geprepareerde TFTP-server en DHCP-server nodig. De DHCP-server hoeft niet per së dezelfde machine te zijn als de TFTP-server, maar het dient bereikbaar te zijn in uw netwerk.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Installeer de DHCP-server door de instructies op te volgen zoals beschreven in <a href=./#network-dhcp-server>Een DHCP-server installeren en instellen</a>. Zorg ervoor dat <span class=filename>/etc/rc.conf</span> en <span class=filename>/usr/local/etc/dhcpd.conf</span> correct zijn geconfigureerd.</p></li><li><p>Stel in <span class=filename>/usr/local/etc/dhcpd.conf</span><code>next-server</code>, <code>filename</code> en <code>option root-path</code> in om het IP-adres van uw TFTP-server, het pad naar <span class=filename>/boot/pxeboot</span> en het pad naar het NFS-root-bestandssysteem op te geven. Hier is een voorbeeld van de instellingen voor <span class=filename>dhcpd.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>subnet 192.168.0.0 netmask 255.255.255.0 {
   range 192.168.0.2 192.168.0.3 ;
   option subnet-mask 255.255.255.0 ;
   option routers 192.168.0.1 ;
   option broadcast-address 192.168.0.255 ;
   option domain-name-server 192.168.35.35, 192.168.35.36 ;
   option domain-name &#34;example.com&#34;;

   # IP-adres van TFTP server
   next-server 192.168.0.1 ;

   # pad van bootloader verkregen via TFTP
   filename &#34;FreeBSD/install/boot/pxeboot&#34; ;

   # pxeboot bootloader zal proberen om deze map te NFS-mounten voor root-FS
   option root-path &#34;192.168.0.1:/b/tftpboot/FreeBSD/install/&#34; ;
}</pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=_de_pxe_cliënt_configureren_en_verbindingsproblemen_opsporen>31.8.4. De PXE-cliënt configureren en verbindingsproblemen opsporen<a class=anchor href=#_de_pxe_cliënt_configureren_en_verbindingsproblemen_opsporen></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Ga naar het BIOS-configuratiemenu wanneer de cliëntmachine opstart. Stel het BIOS zo in dat het van het netwerk opstart. Indien alle vorige configuratiestappen correct zijn, zou alles "gewoon" moeten werken.</p></li><li><p>Gebruik de poort <a class=package href=https://cgit.freebsd.org/ports/tree/net/wireshark/>net/wireshark</a> om netwerkverkeer met betrekking tot het PXE-opstartproces te debuggen, wat geïllustreerd is in onderstaand diagram. In <a href=#network-pxe-setting-up-dhcp>Een DHCP-server prepareren</a> is een voorbeeldconfiguratie gegeven waarbij de DHCP-, TFTP- en NFS-servers op dezelfde machine staan. Deze servers kunnen echter op verschillende machines staan.</p><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/pxe-nfs.png alt="pxe nfs"></div><div class=title>Figuur 58. PXE-opstartproces met NFS-root-mount</div></div></li><li><p>Controleer dat het bestand <span class=filename>pxeboot</span> via TFTP kan worden verkregen. Kijk op uw TFTP-server in <span class=filename>/var/log/xferlog</span> om er zeker van de zijn dat het bestand <span class=filename>pxeboot</span> van de juiste locatie is opgehaald. Om de configuratie met bovenstaande <span class=filename>dhcpd.conf</span> te testen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tftp 192.168.0.1</span>
tftp&gt; get FreeBSD/install/boot/pxeboot
Received 264951 bytes <span class=k>in </span>0.1 seconds</code></pre></div></div><div class=paragraph><p>Lees <a href="https://man.freebsd.org/cgi/man.cgi?query=tftpd&amp;sektion=8&amp;format=html">tftpd(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=tftp&amp;sektion=1&amp;format=html">tftp(1)</a>. De <code>BUGS</code> secties in deze pagina’s documenteren enkele beperkingen van TFTP.</p></div></li><li><p>Controleer dat het root-bestandssysteem via NFS kan worden aangekoppeld. Om de configuratie met bovenstaande <span class=filename>dhcpd.conf</span> te testen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t nfs 192.168.0.1:/b/tftpboot/FreeBSD/install /mnt</span></code></pre></div></div></li><li><p>Lees de code in <span class=filename>src/sys/boot/i386/libi386/pxe.c</span> om te begrijpen hoe de <span class=filename>pxeboot</span>-lader variabelen als <code>boot.nfsroot.server</code> en <code>boot.nfsroot.path</code> instelt. Deze variabelen worden vervolgens gebruikt in de root-aankoppelcode voor diskvrij NFS in <span class=filename>src/sys/nfsclient/nfs_diskless.c</span>.</p></li><li><p>Lees <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a>.</p></li></ol></div></div></div></div></div><div class=sect2><h3 id=network-isdn>31.9. ISDN<a class=anchor href=#network-isdn></a></h3><div class=paragraph><p>Een goede bron voor informatie over de technologie van en hardware over ISDN is <a href=http://www.alumni.caltech.edu/~dank/isdn/>Dan Kegel’s ISDN Page</a>.</p></div><div class=paragraph><p>Hieronder staat een snelle eenvoudige handleiding voor ISDN:</p></div><div class=ulist><ul><li><p>Indien u in Europa leeft is het raadzaam om de sectie over ISDN-kaarten te bestuderen.</p></li><li><p>Indien het plan is om ISDN hoofdzakelijk te gebruiken om via een niet-toegewijde inbellijn een verbinding met het Internet te maken, zijn Terminal Adapters wellicht een optie. Dit biedt de meeste flexibiliteit, en de minste problemen bij het wisselen van providers.</p></li><li><p>Indien twee LANs met elkaar verbonden worden, of indien er een toegewijde ISDN-verbinding wordt gebruikt om met het Internet te verbinden, is het gebruik van een zelfstandige router/bridge te overwegen.</p></li></ul></div><div class=paragraph><p>Financiële kosten zijn een belangrijke factor in de uiteindelijke oplossing. De volgende opties zijn gesorteerd in volgorde van oplopende kosten.</p></div><div class=sect3><h4 id=network-isdn-cards>31.9.1. ISDN-kaarten<a class=anchor href=#network-isdn-cards></a></h4><div class=paragraph><p>De ISDN-implementatie in FreeBSD biedt alleen ondersteuning voor de DSS1/Q.931 (of Euro-ISDN) standaard indien passieve kaarten gebruikt worden. Sommige actieve kaarten worden ondersteund indien de firmware ook ondersteuning voor andere signaleringsprotocollen biedt; dit omvat ook de eerst ondersteunde Primary Rate (PRI) ISDN-kaart.</p></div><div class=paragraph><p>De isdn4bsd-software biedt de mogelijkheid om met andere ISDN-routers te verbinden door òfwel IP over rauwe HDLC òfwel synchrone PPP te gebruiken: òfwel via kernel-PPP met <code>isppp</code>, een aangepast stuurprogramma voor <a href="https://man.freebsd.org/cgi/man.cgi?query=sppp&amp;sektion=4&amp;format=html">sppp(4)</a>, òfwel via het gebruikersprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a>. Door het gebruikersprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> te gebruiken, is het combineren van twee of meer ISDN B-kanalen mogelijk. Ook zijn een toepassing die de telefoon beantwoordt en vele gereedschappen zoals een 300 Baud-modem in software beschikbaar.</p></div><div class=paragraph><p>Een groeiend aantal ISDN-kaarten voor de PC wordt door FreeBSD ondersteund en volgens de rapportages wordt het succesvol in heel Europa en in vele andere delen van de wereld gebruikt.</p></div><div class=paragraph><p>De ondersteunde passieve ISDN-kaarten zijn meestal uitgerust met de Infineon (voormalig Siemens) ISAC/HSCX/IPAC ISDN-chipsets, maar ook worden ISDN-kaarten ondersteund met chips van Cologne Chip (alleen ISA-bus), PCI-kaarten met Winbond W6692-chips, enkele kaarten met combinaties van Tiger300/320/ISAC chipsets en enkele kaarten die gebaseerd zijn op fabrikantspecifieke chipsets zoals de AVM Fritz!Card PCI V.1.0 en de AVM Fritz!Card PnP.</p></div><div class=paragraph><p>Momenteel zijn de actieve ISDN-kaarten die ondersteund worden de AVM B1 (ISA en PCI) BRI-kaarten en de AVM T1 PCI PRI-kaarten.</p></div><div class=paragraph><p>Kijk voor documentatie over isdn4bsd op de <a href=http://www.freebsd-support.de/i4b/>homepage van isdn4bsd</a>, welke ook verwijzingen naar tips, errata, en veel meer documentatie zoals het <a href=http://people.FreeBSD.org/~hm/>isdn4bsd handboek</a> bevat.</p></div><div class=paragraph><p>Indien er interesse is om ondersteuning voor een ander ISDN-protocol, een momenteel niet-ondersteunde ISDN-kaart voor de PC, of een andere verbetering voor isdn4bsd toe te voegen, dient er contact opgenomen te worden met Hellmuth Michaelis &lt;<a href=mailto:hm@FreeBSD.org>hm@FreeBSD.org</a>>.</p></div><div class=paragraph><p>Voor vragen over het installeren, instellen, en problemen met isdn4bsd oplossen is er een mailinglijst, <a href=https://lists.FreeBSD.org/subscription/freebsd-isdn>freebsd-isdn</a>, beschikbaar.</p></div></div><div class=sect3><h4 id=_isdn_terminal_adapters>31.9.2. ISDN Terminal Adapters<a class=anchor href=#_isdn_terminal_adapters></a></h4><div class=paragraph><p>Terminal adapters (TA) zijn voor ISDN wat modems voor gewone telefoonlijnen zijn.</p></div><div class=paragraph><p>De meeste TA’s gebruiken de standaard opdrachtenverzameling van de Hayes-modem, en kunnen direct als vervanging van een modem gebruikt worden.</p></div><div class=paragraph><p>Een TA zal als een gewoon modem werken behalve dat de verbindings- en doorvoersnelheden veel hoger zullen zijn dan van het oude modem. Het is noodzakelijk om <a href=./#ppp>PPP</a> precies hetzelfde als voor het modem in te stellen. Zorg ervoor dat de seriële snelheid zo hoog mogelijk wordt ingesteld.</p></div><div class=paragraph><p>Het grootste voordeel van met een TA met een internetprovider te verbinden is de mogelijkheid tot dynamisch PPP. Aangezien IP-adresruimte steeds schaarser wordt, zijn de meeste providers niet meer bereid om een statisch IP te geven. De meeste zelfstandige routers zijn niet in staat tot dynamische IP-toewijzing.</p></div><div class=paragraph><p>TA’s zijn geheel afhankelijk van het PPP-daemon dat gedraaid wordt voor hun mogelijkheden en stabiliteit van de verbinding. Dit maakt het mogelijk om gemakkelijk om op een FreeBSD-machine van een modem naar ISDN over te gaan, indien PPP reeds is ingesteld. Echter, dezelfde problemen die er waren met het PPP-programma zullen blijven voorkomen.</p></div><div class=paragraph><p>Indien maximale stabiliteit gewenst is, dient de kernel <a href=./#ppp>PPP</a>-, niet de <a href=./#userppp>gebruikers-PPP</a>-optie gebruikt te worden.</p></div><div class=paragraph><p>Van de volgende TA’s is bekend dat ze met FreeBSD werken:</p></div><div class=ulist><ul><li><p>Motorola BitSurfer en BitSurfer Pro</p></li><li><p>Adtran</p></li></ul></div><div class=paragraph><p>De meeste andere TA’s zullen waarschijnlijk ook werken, TA-verkopers proberen er zeker van te zijn dat hun product het meeste van de AT-opdrachtverzameling van het standaardmodem accepteert.</p></div><div class=paragraph><p>Het echte probleem met externe TA’s is dat, net zoals bij modems, een goede seriële kaart in de computer nodig is.</p></div><div class=paragraph><p>Voor een goed begrip van seriële apparaten dient de tutorial <a href=https://docs.freebsd.org/en/articles/serial-uart/>FreeBSD Serial Hardware</a> en de verschillen tussen asynchrone en synchrone seriële poorten gelezen te worden.</p></div><div class=paragraph><p>Een TA die op een standaard seriële poort (asynchroon) van een PC draait beperkt de snelheid tot 115.2 Kbps, zelfs als er een 128 Kbps-verbinding beschikbaar is. Om de volledige 128 Kbps waartoe ISDN in staat is te gebruiken, dient de TA op een synchrone seriële kaart overgeplaatst te worden.</p></div><div class=paragraph><p>Het kopen van een interne TA voorkomt het probleem van synchroon/asynchroon niet. Interne TA’s hebben simpelweg een seriële poortchip van een standaard PC ingebouwd. Dit ontlast de gebruiker alleen van het kopen van nog een seriële kabel en het vinden van nog een leeg elektronisch uitbreidingsslot.</p></div><div class=paragraph><p>Een synchrone kaart met een TA is minstens zo snel als een zelfstandige router, en wanneer het door een eenvoudige 386 met FreeBSD erop wordt aangestuurd, waarschijnlijk flexibeler.</p></div><div class=paragraph><p>De keuze tussen synchrone kaart/TA en zelfstandige router is grotendeels religieus. Hierover zijn wat discussies in de mailinglijsten gevoerd. Het wordt aangeraden om de <a href=https://www.FreeBSD.org/search/>archieven</a> te doorzoeken voor de volledige discussie.</p></div></div><div class=sect3><h4 id=_zelfstandige_isdn_bridgesrouters>31.9.3. Zelfstandige ISDN bridges/routers<a class=anchor href=#_zelfstandige_isdn_bridgesrouters></a></h4><div class=paragraph><p>ISDN-bridges of -routers zijn in het geheel niet specifiek voor FreeBSD of enig ander besturingssysteem. Raadpleeg voor een volledigere beschrijving van de technologie van routing en bridging een referentieboek over netwerken.</p></div><div class=paragraph><p>In deze sectie zullen de termen router en bridge door elkaar worden gebruikt.</p></div><div class=paragraph><p>Aangezien de prijzen van eenvoudige ISDN-routers/-bridges zakken, zal dit waarschijnlijk een steeds populairdere keuze worden. Een ISDN-router is en kleine doos die direct in het plaatselijke Ethernetnetwerk geprikt wordt, en zijn eigen verbinding met de andere bridge/router beheert. Het heeft ingebouwde software om via PPP en andere populaire protocollen te communiceren.</p></div><div class=paragraph><p>Een router staat veel snellere doorvoer dan een standaard-TA toe, aangezien het een volledig synchrone ISDN-verbinding zal gebruiken.</p></div><div class=paragraph><p>Het grootste probleem met ISDN-routers en -bridges is dat samenwerking tussen fabrikanten nog steeds een probleem kan zijn. Indien er plannen zijn om met een internetprovider te verbinden, is het raadzaam de wensen met hen te bespreken.</p></div><div class=paragraph><p>Indien er gepland is om twee LAN-segmenten met elkaar te verbinden, zoals het thuis-LAN en het kantoor-LAN, is dit de eenvoudigste en onderhoudarmste oplossing. Aangezien de apparatuur voor beide kanten van de verbinding wordt gekocht is het zeker dat de verbinding zal werken.</p></div><div class=paragraph><p>De volgende installatie kan worden gebruikt om bijvoorbeeld een thuiscomputer of een netwerk van een afdelingskantoor met een netwerk van het hoofdkantoor te verbinden:</p></div><div class=exampleblock><div class=title>Voorbeeld 40. Netwerk van afdelingskantoor of thuis</div><div class=content><div class=paragraph><p>Het netwerk gebruikt een topologie gebaseerd op een bus met een 10 base 2 Ethernet ("thinnet"). Verbind indien nodig de router met de netwerkkabel met een AUI/10BT transceiver.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/isdn-bus.png alt="10 Base 2 Ethernet"></div></div><div class=paragraph><p>Wanneer het thuis-/afdelingskantoornetwerk uit slechts één computer bestaat kan een twisted-pair crossover-kabel gebruikt worden om direct met de zelfstandige router te verbinden.</p></div></div></div><div class=exampleblock><div class=title>Voorbeeld 41. Hoofdkantoor- of ander LAN</div><div class=content><div class=paragraph><p>Het netwerk gebruikt een stertopologie met 10 base T Ethernet ("Twisted Pair").</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/isdn-twisted-pair.png alt="ISDN Netwerkdiagram"></div></div></div></div><div class=paragraph><p>Een groot voordeel van de meeste routers/bridges is dat ze <em>gelijktijdig</em> 2 <em>gescheiden onafhankelijke</em> PPP-verbindingen met 2 gescheiden sites toestaan. Dit wordt door de meeste TA’s niet ondersteund, behalve voor specifieke (gewoonlijk dure) modellen die twee seriële poorten hebben. Dit dient niet met kanaalbinding, MPP, etcetera verward te worden.</p></div><div class=paragraph><p>Dit kan een erg handige eigenschap zijn indien, bijvoorbeeld, er een toegewijde ISDN-verbinding op kantoor is en het gewenst is om deze af te tappen, maar een andere ISDN-lijn op het werk ongewenst is. Een router op kantoor kan een toegewijde B-kanaal verbinding (64 Kbps) met het Internet beheren en het andere B-kanaal voor een gescheiden gegevensverbinding gebruiken. Het tweede B-kanaal kan voor inbellen, uitbellen, of dynamisch binden (MPP, etcetera) gebruikt worden met het eerste B-kanaal voor meer bandbreedte.</p></div><div class=paragraph><p>Een Ethernet-bridge staat ook toe om meer dan alleen IP-verkeer te verzenden. Het is ook mogelijk om IPX/SPX of enig ander protocol te gebruiken.</p></div></div></div><div class=sect2><h3 id=network-natd>31.10. Network Address Translation<a class=anchor href=#network-natd></a></h3><div class=sect3><h4 id=network-natoverview>31.10.1. Overzicht<a class=anchor href=#network-natoverview></a></h4><div class=paragraph><p>Het Network Address Translation daemon van FreeBSD, in het algemeen bekend als <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a>, is een daemon dat rauwe binnenkomende IP-pakketten accepteert, de bron naar die van de plaatselijke machine verandert en de pakketten terug in de uitgaande IP-pakketstroom injecteert. <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> doet dit door het IP-adres en de poort van de bron zo te veranderen dat wanneer de gegevens weer ontvangen worden, het in staat is om de originele plaats van de gegevens te achterhalen en ze door te sturen naar de originele aanvrager.</p></div><div class=paragraph><p>NAT wordt het meest gebruikt wat in het algemeen bekend is als het delen van een Internetverbinding.</p></div></div><div class=sect3><h4 id=network-natsetup>31.10.2. Installatie<a class=anchor href=#network-natsetup></a></h4><div class=paragraph><p>Wegens de krimpende IP-ruimte in IPv4, en het groeiend aantal gebruikers van consumentenlijnen op hoge snelheid zoals kabel of DSL, hebben steeds meer mensen een oplossing als het delen van een Internetverbinding nodig. Vanwege de mogelijkheid om meerdere computers online te verbinden door één verbinding en IP-adres is <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> een redelijke keuze.</p></div><div class=paragraph><p>In de meeste gevallen heeft een gebruiker een machine verbonden met een kabel- of DSL-lijn met één IP-adres en is het gewenst om deze ene verbonden computer te gebruiken om Internettoegang aan meerdere computers over een LAN te geven.</p></div><div class=paragraph><p>Hiervoor dient de FreeBSD-machine op het Internet dienst doen als gateway. Deze gateway-machine heeft twee NICs nodig - één voor de verbinding met de Internetrouter, de andere voor de verbinding met het LAN. Alle machines op het LAN zijn verbonden door een hub of switch.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er zijn vele manieren om een LAN via een FreeBSD-gateway met het Internet te verbinden. Dit voorbeeld behandelt slechts een gateway met tenminste twee NICs.</p></div></td></tr></tbody></table></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/natd.png alt=Netwerkschema></div></div><div class=paragraph><p>Dit soort installaties wordt in het algemeen gebruikt om een Internetverbinding te delen. Eén van de LAN-machines is verbonden met het Internet. De rest van de machines hebben internettoegang via die "gateway"-machine.</p></div></div><div class=sect3><h4 id=network-natdloaderconfiguration>31.10.3. Bootloader-configuratie<a class=anchor href=#network-natdloaderconfiguration></a></h4><div class=paragraph><p>De mogelijkheden van de kernel voor network address translation met <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> staan niet aan in <span class=filename>GENERIC</span>, maar ze kunnen worden voorgeladen tijdens het opstarten door enkele opties aan <span class=filename>/boot/loader.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>ipfw_load=&#34;YES&#34;
ipdivert_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ook moet de tunable <code>net.inet.ip.fw.default_to_accept</code> op <code>1</code> worden gezet:</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.default_to_accept=&#34;1&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is een goed idee om deze optie aan te zetten tijdens de eerste pogingen om een firewall en NAT gateway te installeren. Op deze manier zal het standaardbeleid van <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> <code>allow ip from any to any</code> zijn in plaats van het minder vrije <code>deny ip from any to any</code>, en zal het iets moeilijker zijn om buitengesloten te worden net na het opnieuw opstarten van het systeem.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=network-natdkernconfiguration>31.10.4. Kernelconfiguratie<a class=anchor href=#network-natdkernconfiguration></a></h4><div class=paragraph><p>Wanneer modules geen optie zijn of wanneer het gewenst is om alle benodigde mogelijkheden in de draaiende kernel te bouwen, dienen de volgende opties in het kernelinstellingenbestand aanwezig te zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>options IPFIREWALL
options IPDIVERT</pre></div></div><div class=paragraph><p>De volgende opties kunnen ook van pas komen:</p></div><div class="literalblock programlisting"><div class=content><pre>options IPFIREWALL_DEFAULT_TO_ACCEPT
options IPFIREWALL_VERBOSE</pre></div></div></div><div class=sect3><h4 id=network-natdsystemconfiguration>31.10.5. Systeeminstellingen voor het opstarten<a class=anchor href=#network-natdsystemconfiguration></a></h4><div class=paragraph><p>Om de firewall en NAT tijdens het opstarten aan te zetten, moet het volgende in <span class=filename>/etc/rc.conf</span> staan:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34; <i class=conum data-value=1></i><b>(1)</b>
firewall_enable=&#34;YES&#34; <i class=conum data-value=2></i><b>(2)</b>
firewall_type=&#34;OPEN&#34; <i class=conum data-value=3></i><b>(3)</b>
natd_enable=&#34;YES&#34;
natd_interface=&#34;fxp0&#34; <i class=conum data-value=4></i><b>(4)</b>
natd_flags=&#34;&#34; <i class=conum data-value=5></i><b>(5)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Stelt de machine in om dienst te doen als gateway. Het draaien van <code>sysctl net.inet.ip.forwarding=1</code> heeft hetzelfde effect.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Activeert de firewall-regels in <span class=filename>/etc/rc.firewall</span> tijdens het opstarten.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Dit specificeert een vooraf gedefinieerde verzameling van firewall-regels die alles binnenlaat. Raadpleeg <span class=filename>/etc/rc.firewall</span> voor aanvullende types.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Geeft aan welke interface te gebruiken om pakketten naar door te sturen (de interface die met het Internet verbonden is).</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Alle aanvullende instelopties die tijdens het opstarten aan <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> worden doorgegeven.</td></tr></tbody></table></div><div class=paragraph><p>Het gedefinieerd hebben van de bovenstaande opties in <span class=filename>/etc/rc.conf</span> zal <code>natd -interface fxp0</code> draaien tijdens het opstarten. Dit kan ook handmatig worden gedraaid.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is ook mogelijk om een instellingenbestand voor <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> te gebruiken als er teveel opties zijn om door te geven. In dit geval dient het instellingenbestand te worden gedefinieerd door de volgende regel aan <span class=filename>/etc/rc.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>natd_flags=&#34;-f /etc/natd.conf&#34;</pre></div></div><div class=paragraph><p>Het bestand <span class=filename>/etc/natd.conf</span> zal een lijst met instelopties bevatten, één per regel. Het geval in de volgende sectie bijvoorbeeld zal het volgende bestand gebruiken:</p></div><div class="literalblock programlisting"><div class=content><pre>redirect_port tcp 192.168.0.2:6667 6667
redirect_port tcpc 192.168.0.3:80 80</pre></div></div><div class=paragraph><p>Raadpleeg voor meer informatie over het instellingenbestand het gedeelte over de optie <code>-f</code> van de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Elke machine en interface achter het LAN dient een IP-adres in de privé-netwerkruimte toegewezen te krijgen zoals gedefinieerd in <a href=ftp://ftp.isi.edu/in-notes/rfc1918.txt>RFC 1918</a> en een standaard gateway van het interne IP-adres van de natd-machine hebben.</p></div><div class=paragraph><p>Bijvoorbeeld, cliënt <code>A</code> en <code>B</code> achter het LAN hebben IP-adressen <code>192.168.0.2</code> en <code>192.168.0.3</code>, terwijl de LAN-interface van de natd-machine IP-adres <code>192.168.0.1</code> heeft. De standaard gateway van cliënt <code>A</code> en <code>B</code> dient ingesteld te worden op die van de natd-machine, <code>192.168.0.1</code>. Voor de externe, of Internet-interface van de natd-machine zijn geen speciale wijzigingen nodig om <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> te laten werken.</p></div></div><div class=sect3><h4 id=network-natdport-redirection>31.10.6. Poorten omleiden<a class=anchor href=#network-natdport-redirection></a></h4><div class=paragraph><p>Het nadeel van <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> is dat de LAN-cliënten niet vanaf het Internet toegankelijk zijn. Cliënten op het LAN kunnen uitgaande verbinden naar de wereld maken maar kunnen geen inkomende verbindingen ontvangen. Dit vormt een probleem wanneer geprobeerd wordt om Internetdiensten op een van de LAN-cliëntmachines te draaien. Een eenvoudige om dit te omzeilen is om bepaalde Internetpoorten op de natd-machine om te leiden naar een LAN-cliënt.</p></div><div class=paragraph><p>Bijvoorbeeld, er draait een IRC-server op cliënt <code>A</code>, en er draait een webserver op cliënt <code>B</code>. Om dit goed te laten werken, dienen verbindingen die worden ontvangen op poorten 6667 (IRC) en 80 (web) te worden omgeleid naar de respectievelijke machines.</p></div><div class=paragraph><p>De optie <code>-redirect_port</code> dient aan <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> met de juiste opties te worden doorgegeven. De syntaxis is als volgt:</p></div><div class="literalblock programlisting"><div class=content><pre>     -redirect_port proto doelIP:doelPOORT[-doelPOORT]
                 [aliasIP:]aliasPOORT[-aliasPOORT]
                 [verIP[:verrePOORT[-verrePOORT]]]</pre></div></div><div class=paragraph><p>In het bovenstaand voorbeeld dienen de argumenten te zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>     -redirect_port tcp 192.168.0.2:6667 6667
-redirectport tcp 192.168.0.3:80 80</pre></div></div><div class=paragraph><p>Dit zal de juiste <em>tcp</em>-poorten naar de LAN-cliënt-machines omleiden.</p></div><div class=paragraph><p>Het argument <code>-redirect_port</code> kan worden gebruikt om poortbereiken over individuele poorten aan te geven. Bijvoorbeeld, <em>tcp 192.168.0.2:2000-3000 2000-3000</em> zal alle verbindingen die op poorten 2000 tot 3000 worden ontvangen omleiden naar poorten 2000 tot 3000 op cliënt <code>A</code>.</p></div><div class=paragraph><p>Deze opties kunnen worden gebruikt wanneer <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> direct wordt gedraaid, wanneer ze zijn geplaatst in de optie <code>natd_flags=""</code> van <span class=filename>/etc/rc.conf</span>, of wanneer ze via een instellingenbestand worden doorgegeven.</p></div><div class=paragraph><p>Raadpleeg voor meer instelopties <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a>.</p></div></div><div class=sect3><h4 id=network-natdaddress-redirection>31.10.7. Adressen omleiden<a class=anchor href=#network-natdaddress-redirection></a></h4><div class=paragraph><p>Adressen omleiden is handig wanneer er verschillende IP-adressen beschikbaar zijn, maar ze op één machine moeten zitten. Hiermee kan <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> aan elke LAN-cliënt een eigen extern IP-adres toewijzen. Vervolgens overschrijft <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> de uitgaande pakketten van de LAN-cliënten met het juiste IP-adres en leidt het al het binnenkomende verkeer op dat ene IP-adres terug naar de specifieke LAN-cliënt. Dit staat ook bekend als statisch NAT. Bijvoorbeeld, de IP-adressen <code>128.1.1.1</code>, <code>128.1.1.2</code>, en <code>1281.2..3</code> behoren toe aan de natd gateway-machine. <code>128.1.1.1</code> kan gebruikt worden als het externe IP-adres van de natd gateway-machine, terwijl <code>128.1.1.2</code> en <code>128.1.1.3</code> terug worden gestuurd naar de LAN-cliënten <code>A</code> en <code>B</code>.</p></div><div class=paragraph><p>De syntaxis van <code>-redirect_address</code> is als volgt:</p></div><div class="literalblock programlisting"><div class=content><pre>-redirect_address lokaalIP publiekIP</pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>lokaalIP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het interne IP-adres van de LAN-cliënt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>publiekIP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het externe IP-adres overeenkomend met de LAN-cliënt.</p></td></tr></tbody></table><div class=paragraph><p>In het voorbeeld zou dit argument zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>-redirect_address 192.168.0.2 128.1.1.2
-redirect_address 192.168.0.3 128.1.1.3</pre></div></div><div class=paragraph><p>Net zoals <code>-redirect_port</code> worden ook deze argumenten geplaatst in de optie <code>natd_flags=""</code> van <span class=filename>/etc/rc.conf</span>, of doorgegeven via een instellingenbestand. Met adresomleiding is het omleiden van poorten niet nodig aangezien alle gegevens die op een bepaald IP-adres worden ontvangen worden omgeleidt.</p></div><div class=paragraph><p>Het externe IP-adres op de natd machine dient actief en naar een externe interface gealiased te zijn. In <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> staat hoe dit te doen.</p></div></div></div><div class=sect2><h3 id=network-ipv6>31.11. IPv6<a class=anchor href=#network-ipv6></a></h3><div class=paragraph><p>IPv6 (ook bekend als IPng "IP next generation") is de nieuwe versie van het welbekende IP-protocol (ook bekend als IPv4). Net zoals de andere huidige *BSD-systemen, bevat FreeBSD de referentie-implementatie van KAME IPv6. Het FreeBSD-systeem wordt dus geleverd met alles wat nodig is om met IPv6 te experimenteren. Deze sectie richt zich op het ingesteld en draaiend krijgen van IPv6.</p></div><div class=paragraph><p>In de vroege jaren 1990 werden mensen zich bewust van de snel krimpende adresruimte van IPv4. De uitbreidingssnelheid van het Internet baarde twee grote zorgen:</p></div><div class=ulist><ul><li><p>Geen adresruimte meer. Tegenwoordig is dit niet zo’n probleem meer aangezien RFC1918 voor privé-adresruimte (<code>10.0.0.0/8</code>, <code>172.16.0.0/12</code>, en <code>192.168.0.0/16</code>) en Network Address Translation (NAT) worden gebruikt.</p></li><li><p>De regels in de routeertabellen werden te groot. Dit is tegenwoordig nog steeds een probleem.</p></li></ul></div><div class=paragraph><p>IPv6 behandelt deze en vele andere zaken:</p></div><div class=ulist><ul><li><p>128-bits adresruimte. Met andere woorden, er zijn theoretisch 340.282.366.920.938.463.463.374.607.431.768.211.456 adressen beschikbaar. Dit betekent dat er ongeveer 6,67 * 10^27 IPv6-adressen per vierkante meter op onze planeet beschikbaar zijn.</p></li><li><p>Routers zullen alleen netwerkaggregatie-adressen in hun routeertabellen opslaan en dus de gemiddelde ruimte van een routeertabel verkleinen tot 8192 regels.</p></li></ul></div><div class=paragraph><p>IPv6 heeft ook vele andere nuttige eigenschappen zoals:</p></div><div class=ulist><ul><li><p>Automatische adresconfiguratie (<a href=http://www.ietf.org/rfc/rfc2462.txt>RFC2462</a>)</p></li><li><p>Anycast-adressen ("ééen-van-velen")</p></li><li><p>Verplichte multicast-adressen</p></li><li><p>IPsec (IP security)</p></li><li><p>Versimpelde structuur van de headers</p></li><li><p>Mobiele IP</p></li><li><p>Overgangsmechanismen voor IPv6 naar IPv4</p></li></ul></div><div class=paragraph><p>Bekijk voor meer informatie:</p></div><div class=ulist><ul><li><p>IPv6-overzicht op <a href=http://playground.sun.com/pub/ipng/html/ipng-main.html>playground.sun.com</a></p></li><li><p><a href=http://www.kame.net>KAME.net</a></p></li></ul></div><div class=sect3><h4 id=_achtergrond_over_ipv6_adressen>31.11.1. Achtergrond over IPv6 adressen<a class=anchor href=#_achtergrond_over_ipv6_adressen></a></h4><div class=paragraph><p>Er zijn verschillende soorten IPv6-adressen: unicast, anycast, en multicast.</p></div><div class=paragraph><p>Unicast-adressen zijn de bekende adressen. Een pakket dat naar een unicast-adres wordt verzonden arriveert precies op de interface dat bij dat adres hoort.</p></div><div class=paragraph><p>Anycast-adressen zijn syntactisch niet van unicast-adressen te onderscheiden maar ze adresseren een groep interfaces. Een pakket dat bestemd is voor een anycast-adres zal bij de dichtstbijzijnde interface arriveren (in router-metrieken). Anycast-adressen mogen alleen door routers worden gebruikt.</p></div><div class=paragraph><p>Multicast-adressen identificeren een groep interfaces. Een pakket dat bestemd is voor en multicast-adres zal bij alle interfaces die bij de multicast-groep horen arriveren.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het broadcast-adres van IPv4 (gewoonlijk <code>xxx.xxx.xxx.255</code>) wordt in IPv6 met multicast-adressen uitgedrukt.</p></div></td></tr></tbody></table></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 12. Gereserveerde IPv6-adressen</caption><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">IPv6-adres</th><th class="tableblock halign-left valign-top">Prefixlengte (bits)</th><th class="tableblock halign-left valign-top">Beschrijving</th><th class="tableblock halign-left valign-top">Opmerkingen</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>128 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>niet gespecificeerd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>cf. <code>0.0.0.0</code> in IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::1</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>128 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>teruglusadres</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>cf. <code>127.0.0.1</code> in IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::00:xx:xx:xx:xx</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>96 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ingebouwd IPv4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De laagste 32 bits zijn het IPv4-adres. Ook "IPv4 compatibel IPv6-adres" genoemd.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::ff:xx:xx:xx:xx</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>96 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IPv4-afgebeeld IPv6-adres</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De laagste 32 bits zijn het IPv4-adres. Voor hosts die geen IPv6 ondersteunen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fe80::</code> - <code>feb::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>10 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>link-lokaal</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>cf. teruglusadres in IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fec0::</code> - <code>fef::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>10 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>site-lokaal</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ff::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>multicast</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>001</code> (base 2)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>globale unicast</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle globale unicast-adressen worden vanuit deze pool toegewezen. De eerste 3 bits zijn "001".</p></td></tr></tbody></table></div><div class=sect3><h4 id=_ipv6_adressen_lezen>31.11.2. IPv6-adressen lezen<a class=anchor href=#_ipv6_adressen_lezen></a></h4><div class=paragraph><p>De canonieke vorm wordt weergegeven als: <code>x:x:x:x:x:x:x:x</code>, waarbij elke "x" een 16-bits hexadecimale waarde is. Bijvoorbeeld <code>FEBC:A574:382B:23C1:AA49:4592:4EFE:9982</code></p></div><div class=paragraph><p>Vaak bevat een adres lange deelstrings van allen nullen, daarom kan per adres één zo’n deelstring worden afgekort als "::". Ook kunnen maximaal drie voorlopende "0"'s per hexadecimaal viertal worden weggelaten. Bijvoorbeeld, <code>fe80::1</code> komt overeen met de canonieke vorm <code>fe80:0000:0000:0000:0000:0000:0000:0001</code>.</p></div><div class=paragraph><p>Een derde vorm is het schrijven van de laatste 32 bits in de bekende (decimale) IPv4-stijl met punten "." als scheidingstekens. Bijvoorbeeld, <code>2002::10.0.0.1</code> komt overeen met de (hexadecimale) canonieke representatie <code>2002:0000:0000:0000:0000:0000:0a00:0001</code> wat weer hetzelfde is als <code>2002::a00:1</code>.</p></div><div class=paragraph><p>Op dit punt dient de lezer het volgende te begrijpen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig</span></code></pre></div></div><div class="literalblock programlisting"><div class=content><pre>rl0: flags=8943&lt;UP,BROADCAST,RUNNING,PROMISC,SIMPLEX,MULTICAST&gt; mtu 1500
        inet 10.0.0.10 netmask 0xffffff00 broadcast 10.0.0.255
        inet6 fe80::200:21ff:fe03:8e1%rl0 prefixlen 64 scopeid 0x1
        ether 00:00:21:03:08:e1
	media: Ethernet autoselect (100baseTX )
        status: active</pre></div></div><div class=paragraph><p><code>fe80::200:21ff:fe03:8e1%rl0</code> is een automatisch ingesteld link-lokaal adres. Het is als deel van de automatische instelling vanuit het MAC-adres aangemaakt.</p></div><div class=paragraph><p>Kijk voor verdere informatie over de structuur van IPv6-adressen op <a href=http://www.ietf.org/rfc/rfc3513.txt>RFC3513</a>.</p></div></div><div class=sect3><h4 id=_verbinding_krijgen>31.11.3. Verbinding krijgen<a class=anchor href=#_verbinding_krijgen></a></h4><div class=paragraph><p>Er zijn momenteel vier manieren om met andere IPv6-hosts en -netwerken te verbinden:</p></div><div class=ulist><ul><li><p>Neem contact op met de Internetprovider om te zien of ze al IPv6 aanbieden.</p></li><li><p><a href=http://www.sixxs.net>SixXS</a> biedt wereldwijd tunnels met eindpunten aan.</p></li><li><p>Tunnelen via 6-naar-4 (<a href=http:///www.ietf.org/rfc/rfc3608.txt>RFC3068</a>)</p></li><li><p>Gebruik de poort <a class=package href=https://cgit.freebsd.org/ports/tree/net/freenet6/>net/freenet6</a> indien er een inbelverbinding wordt gebruikt.</p></li></ul></div></div><div class=sect3><h4 id=_dns_in_de_ipv6_wereld>31.11.4. DNS in de IPv6-wereld<a class=anchor href=#_dns_in_de_ipv6_wereld></a></h4><div class=paragraph><p>Er waren twee soorten DNS-records voor IPv6. De IETF heeft A6-records overbodig verklaard. AAAA-records zijn nu de standaard.</p></div><div class=paragraph><p>AAAA-records gebruiken gaat rechttoe-rechtaan. Wijs de hostnaam toe aan het nieuwe IPv6-adres dat net ontvangen is door het volgende aan de DNS-bestand voor primaire zones toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>MIJNHOSTNAAM          AAAA    MIJNIPv6ADRES</pre></div></div><div class=paragraph><p>Vraag het aan de DNS-provider indien de DNS-zones niet zelf worden geserveerd. De huidige versies van bind (versie 8.3 en 9) en <a class=package href=https://cgit.freebsd.org/ports/tree/dns/djbdns/>dns/djbdns</a> (met de IPv6-patch) ondersteunen AAAA-records.</p></div></div><div class=sect3><h4 id=_de_benodigde_wijzigingen_doorvoeren_in_etcrc_conf>31.11.5. De benodigde wijzigingen doorvoeren in <span class=filename>/etc/rc.conf</span><a class=anchor href=#_de_benodigde_wijzigingen_doorvoeren_in_etcrc_conf></a></h4><div class=sect4><h5 id=_ipv6_cliëntinstellingen>31.11.5.1. IPv6-cliëntinstellingen<a class=anchor href=#_ipv6_cliëntinstellingen></a></h5><div class=paragraph><p>Deze instellingen helpen bij het configureren van een machine in het LAN die als cliënt in plaats van router dienst zal doen. Om <a href="https://man.freebsd.org/cgi/man.cgi?query=rtsol&amp;sektion=8&amp;format=html">rtsol(8)</a> automatisch de interface tijdens het opstarten te laten configureren op FreeBSD 9.<em>X</em> en nieuwer dient het volgende aan <span class=filename>rc.conf</span> toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_prefer=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Voeg voor FreeBSD 8.<em>X</em> en ouder het volgende toe:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Voeg het volgende toe om statisch een IP-adres zoals <code>2001:471:1f11:251:290:27ff:fee0:2093</code> aan de interface <span class=filename>fxp0</span> toe te voegen voor FreeBSD 9.<em>X</em>:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0_ipv6=&#34;2001:471:1f11:251:290:27ff:fee0:2093 prefixlen 64&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Zorg ervoor dat <em>prefixlen 64</em> wordt vervangen door de juiste waarde voor het subnet van de computer.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Voeg voor FreeBSD 8.<em>X</em> het volgende toe:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_ifconfig_fxp0=&#34;2001:471:1f11:251:290:27ff:fee0:2093&#34;</pre></div></div><div class=paragraph><p>Voeg het volgende aan <span class=filename>/etc/rc.conf</span> toe om een standaardrouter <code>2001:471:1f11:251::1</code> toe te wijzen:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_defaultrouter=&#34;2001:471:1f11:251::1&#34;</pre></div></div></div><div class=sect4><h5 id=_ipv6_routergateway_instellingen>31.11.5.2. IPv6 router/gateway instellingen<a class=anchor href=#_ipv6_routergateway_instellingen></a></h5><div class=paragraph><p>Deze paragraaf helpt bij het opvolgen van de aanwijzingen die de tunnelprovider heeft gegeven en ze om te zetten in instellingen die blijven na een herstart. Om de tunnel tijdens het opstarten te herstellen kan het volgende in <span class=filename>/etc/rc.conf</span> gebruikt worden:</p></div><div class=paragraph><p>Noem de generieke tunnelinterfaces die zullen worden ingesteld, bijvoorbeeld <span class=filename>gif0</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>gif_interfaces=&#34;gif0&#34;</pre></div></div><div class=paragraph><p>Om de interface met een lokaal eindpunt <em>MIJN_IPv4_ADRES</em> in te stellen naar een ver eindpunt <em>VER_IPv4_ADRES</em>:</p></div><div class="literalblock programlisting"><div class=content><pre>gifconfig_gif0=&#34;MIJN_IPv4_ADRES VER_IPv4_ADRES&#34;</pre></div></div><div class=paragraph><p>Voeg het volgende toe om het IPv6-adres dat is toegewezen als het eindpunt van de IPv6-tunnel te gebruiken voor FreeBSD 9.<em>X</em> en nieuwer:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_gif0_ipv6=&#34;inet6 MIJN_TOEGEWEZEN_IPv6_TUNNEL_EINDPUNT_ADRES&#34;</pre></div></div><div class=paragraph><p>Voeg voor FreeBSD 8.<em>X</em> en eerder het volgende toe:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_ifconfig_gif0=&#34;MIJN_TOEGEWEZEN_IPv6_TUNNEL_EINDPUNT_ADRES&#34;</pre></div></div><div class=paragraph><p>Nu hoeft alleen de standaardroute voor IPv6 ingesteld te worden. Dit is de andere kant van de IPv6-tunnel:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_defaultrouter=&#34;MIJN_IPv6_VER_TUNNEL_EINDPUNT_ADRES&#34;</pre></div></div></div><div class=sect4><h5 id=_ipv6_tunnelinstellingen>31.11.5.3. IPv6-tunnelinstellingen<a class=anchor href=#_ipv6_tunnelinstellingen></a></h5><div class=paragraph><p>Indien de server gebruikt wordt om IPv6 tussen de rest van het netwerk en de wereld te routen, is ook de volgende instelling in <span class=filename>/etc/rc.conf</span> nodig:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_gateway_enable=&#34;YES&#34;</pre></div></div></div></div><div class=sect3><h4 id=_routeradvertentie_en_automatische_hostconfiguratie>31.11.6. Routeradvertentie en automatische hostconfiguratie<a class=anchor href=#_routeradvertentie_en_automatische_hostconfiguratie></a></h4><div class=paragraph><p>Deze sectie helpt bij het instellen van <a href="https://man.freebsd.org/cgi/man.cgi?query=rtadvd&amp;sektion=8&amp;format=html">rtadvd(8)</a> om de standaard IPv6-route te adverteren.</p></div><div class=paragraph><p>Het volgende is nodig in <span class=filename>/etc/rc.conf</span> om <a href="https://man.freebsd.org/cgi/man.cgi?query=rtadvd&amp;sektion=8&amp;format=html">rtadvd(8)</a> aan te zetten:</p></div><div class="literalblock programlisting"><div class=content><pre>rtadvd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het is belangrijk om de interface te specificeren waarop het IPv6-routerverzoek plaatsvindt. Om bijvoorbeeld <a href="https://man.freebsd.org/cgi/man.cgi?query=rtadvd&amp;sektion=8&amp;format=html">rtadvd(8)</a> te vertellen om <span class=filename>fxp0</span> te gebruiken:</p></div><div class="literalblock programlisting"><div class=content><pre>rtadvd_interfaces=&#34;fxp0&#34;</pre></div></div><div class=paragraph><p>Nu dient het instellingenbestand <span class=filename>/etc/rtadvd.conf</span> aangemaakt te worden. Hier is een voorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>fxp0:\
	:addrs#1:addr=&#34;2001:471:1f11:246::&#34;:prefixlen#64:tc=ether:</pre></div></div><div class=paragraph><p>Vervang <span class=filename>fxp0</span> door de interface die gebruikt gaat worden.</p></div><div class=paragraph><p>Vervang vervolgens <code>2001:471:1f11:246::</code> met de prefix van uw toewijzing.</p></div><div class=paragraph><p>Indien een <code>/64</code> subnet is toegewezen, hoeft er verder niets veranderd te worden. In andere gevallen dient de juiste waarde voor <code>prefixlen#</code> gebruikt te worden.</p></div></div></div><div class=sect2><h3 id=network-atm>31.12. Asynchronous Transfer Mode (ATM)<a class=anchor href=#network-atm></a></h3><div class=sect3><h4 id=_klassiek_ip_configureren_over_atm_pvcs>31.12.1. Klassiek IP configureren over ATM (PVCs)<a class=anchor href=#_klassiek_ip_configureren_over_atm_pvcs></a></h4><div class=paragraph><p>Klassiek IP over ATM (CLIP) is de eenvoudigste methode om Asynchronous Transfer Mode (ATM) met IP te gebruiken. Het kan met geswitchte verbindingen (SVCs) en met permanente verbindingen (PVCs) gebruikt worden. Deze sectie beschrijft hoe een netwerk gebaseerd op PVCs op te zetten.</p></div><div class=sect4><h5 id=_volledig_geschakelde_configuraties>31.12.1.1. Volledig geschakelde configuraties<a class=anchor href=#_volledig_geschakelde_configuraties></a></h5><div class=paragraph><p>De eerste methode om een CLIP met PVCs op te zetten is om elke machine met elke andere machine in het netwerk te verbinden via een toegewijde PVC. Hoewel dit eenvoudig te configureren is, wordt het onpraktisch voor een groter aantal machines. Dit netwerk gaat ervan uit dat er vier machines in het netwerk zijn, allen verbonden met het ATM netwerk met een ATM adapterkaart. De eerste stap is het plannen van de IP-adressen en de ATM verbindingen tussen de machines. Het volgende wordt gebruikt:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Host</th><th class="tableblock halign-left valign-top">IP-adres</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostA</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.1</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostB</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.2</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.3</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.4</code></p></td></tr></tbody></table><div class=paragraph><p>Om een volledig geschakeld net te bouwen is er een ATM-verbinding nodig tussen elk paar machines:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Machines</th><th class="tableblock halign-left valign-top">VPI.VCI koppel</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostA</code> - <code>hostB</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostA</code> - <code>hostC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.101</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostA</code> - <code>hostD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.102</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostB</code> - <code>hostC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.103</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostB</code> - <code>hostD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.104</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostC</code> - <code>hostD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.105</p></td></tr></tbody></table><div class=paragraph><p>De VPI- en VCI-waarde kunnen aan beide kanten van de verbinding verschillen, maar voor de eenvoud wordt aangenomen dat ze hetzelfde zijn. Vervolgens dienen de ATM-interfaces op elke host geconfigureerd te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>hostA# ifconfig hatm0 192.168.173.1 up
hostB# ifconfig hatm0 192.168.173.2 up
hostC# ifconfig hatm0 192.168.173.3 up
hostD# ifconfig hatm0 192.168.173.4 up</code></pre></div></div><div class=paragraph><p>aannemende dat de ATM-interface op alle hosts <span class=filename>hatm0</span> is. Nu dienen de PVCs op <code>hostA</code> geconfigureerd te worden (er wordt aangenomen dat ze reeds op de ATM-switches zijn geconfigureerd, raadpleeg de handleiding van de switch hoe dit te doen).</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>hostA# atmconfig natm add 192.168.173.2 hatm0 0 100 llc/snap ubr
hostA# atmconfig natm add 192.168.173.3 hatm0 0 101 llc/snap ubr
hostA# atmconfig natm add 192.168.173.4 hatm0 0 102 llc/snap ubr

hostB# atmconfig natm add 192.168.173.1 hatm0 0 100 llc/snap ubr
hostB# atmconfig natm add 192.168.173.3 hatm0 0 103 llc/snap ubr
hostB# atmconfig natm add 192.168.173.4 hatm0 0 104 llc/snap ubr

hostC# atmconfig natm add 192.168.173.1 hatm0 0 101 llc/snap ubr
hostC# atmconfig natm add 192.168.173.2 hatm0 0 103 llc/snap ubr
hostC# atmconfig natm add 192.168.173.4 hatm0 0 105 llc/snap ubr

hostD# atmconfig natm add 192.168.173.1 hatm0 0 102 llc/snap ubr
hostD# atmconfig natm add 192.168.173.2 hatm0 0 104 llc/snap ubr
hostD# atmconfig natm add 192.168.173.3 hatm0 0 105 llc/snap ubr</code></pre></div></div><div class=paragraph><p>Uiteraard kunnen ook andere verkeerscontracten dan UBR worden gebruikt indien de ATM-adapter die ondersteunt. In dit geval wordt de naam van het verkeerscontract gevolgd door de parameters van het verkeer. Hulp voor het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=atmconfig&amp;sektion=8&amp;format=html">atmconfig(8)</a> kan verkregen worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atmconfig help natm add</span></code></pre></div></div><div class=paragraph><p>of in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=atmconfig&amp;sektion=8&amp;format=html">atmconfig(8)</a>.</p></div><div class=paragraph><p>Dezelfde configuratie kan ook bereikt worden via <span class=filename>/etc/rc.conf</span>. Voor <code>hostA</code> wordt dit:</p></div><div class="literalblock programlisting"><div class=content><pre>network_interfaces=&#34;lo0 hatm0&#34;
ifconfig_hatm0=&#34;inet 192.168.173.1 up&#34;
natm_static_routes=&#34;hostB hostC hostD&#34;
route_hostB=&#34;192.168.173.2 hatm0 0 100 llc/snap ubr&#34;
route_hostC=&#34;192.168.173.3 hatm0 0 101 llc/snap ubr&#34;
route_hostD=&#34;192.168.173.4 hatm0 0 102 llc/snap ubr&#34;</pre></div></div><div class=paragraph><p>De huidige toestand van alle CLIP routes kan worden verkregen met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>hostA# atmconfig natm show</code></pre></div></div></div></div></div><div class=sect2><h3 id=carp>31.13. Common Address Redundancy Protocol (CARP)<a class=anchor href=#carp></a></h3><div class=paragraph><p>Het Common Address Redundancy Protocol, of CARP, staat toe dat meerdere hosts hetzelfde IP-adres gebruiken. In sommige opstellingen wordt dit gebruikt voor beschikbaarheid of loadbalancing. Hosts kunnen ook gescheiden IP-adressen gebruiken, zoals in het voorbeeld dat hier is gegeven.</p></div><div class=paragraph><p>Om ondersteuning voor CARP aan te zetten, dient de FreeBSD-kernel herbouwd zoals beschreven in <a href=./#kernelconfig>De FreeBSD-kernel instellen</a> met de volgende optie:</p></div><div class="literalblock programlisting"><div class=content><pre>device	carp</pre></div></div><div class=paragraph><p>Als alternatief kan de <span class=filename>if_carp.ko</span> module geladen worden tijdens het opstarten. Voeg de volgende regel toe aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>if_carp_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>De functionaliteit van CARP zou nu beschikbaar moeten zijn en kan met verschillende <code>sysctl</code>-OIDs worden bijgesteld:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">OID</th><th class="tableblock halign-left valign-top">Beschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.allow</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Accepteer inkomende CARP pakketten. Staat standaard aan.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.preempt</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Deze optie zet alle CARP interfaces down op de host wanneer er een down gaat. Staat standaard uit.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.log</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De waarde <code>0</code> zet alle logging uit. De waarde <code>1</code> zet het loggen van slechte CARP-pakketten aan. Waardes hoger dan <code>1</code> zet het loggen van toestandsveranderingen van de CARP interfaces aan. De standaardwaarde is <code>1</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.arpbalance</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Balanceer lokaal netwerkverkeer met ARP. Staat standaard uit.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.suppress_preempt</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een alleen-lezen OID die de toestand van preëmptie-onderdrukking weergeeft. Preëmptie kan worden onderdrukt wanneer de verbinding op een interface afwezig is. De waarde <code>0</code> betekent dat preëmptie niet onderdrukt is. Elk probleem verhoogt deze OID.</p></td></tr></tbody></table><div class=paragraph><p>De CARP-apparaten zelf kunnen met het commando <code>ifconfig</code> worden aangemaakt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig carp0 create</span></code></pre></div></div><div class=paragraph><p>In een echte omgeving hebben deze interfaces unieke identificatienummers, bekend als een VHID, nodig. Dit VHID of Virtual Host Identification zal worden gebruikt om de hosts op het netwerk te onderscheiden.</p></div><div class=sect3><h4 id=_carp_gebruiken_voor_serverbeschikbaarheid>31.13.1. CARP gebruiken voor serverbeschikbaarheid<a class=anchor href=#_carp_gebruiken_voor_serverbeschikbaarheid></a></h4><div class=paragraph><p>Eén gebruik van CARP, zoals boven aangegeven, is serverbeschikbaarheid. Dit voorbeeld geeft failover-ondersteuning voor drie hosts, met allemaal een uniek IP-adres en dezelfde webinhoud. Deze machines zullen samen met een Round Robin DNS configuratie dienst doen. De failover-machine zal twee aanvullende CARP-interfaces hebben, één voor elk van de IP’s van de contentservers. Wanneer er een storing optreedt, zou de failover-server het IP-adres van de falende machine moeten oppikken. Dit betekent dat de storing geheel onmerkbaar zou moeten zijn voor de gebruiker. De failover-server heeft dezelfde inhoud en diensten nodig als de andere contentservers waarvoor het moet invallen.</p></div><div class=paragraph><p>De twee machines dienen identiek geconfigureerd te worden op de gegeven hostnamen en VHIDs na. Dit voorbeeld noemt deze machines respectievelijk <code>hosta.example.org</code> en <code>hostb.example.org</code>. Ten eerste dienen de benodigde regels voor een CARP-configuratie aan <span class=filename>rc.conf</span> te worden toegevoegd. Voor <code>hosta.example.org</code> dient het bestand <span class=filename>rc.conf</span> de volgende regels te bevatten:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;hosta.example.org&#34;
ifconfig_fxp0=&#34;inet 192.168.1.3 netmask 255.255.255.0&#34;
cloned_interfaces=&#34;carp0&#34;
ifconfig_carp0=&#34;vhid 1 pass testpass 192.168.1.50/24&#34;</pre></div></div><div class=paragraph><p>Op <code>hostb.example.org</code> dienen de volgende regels in <span class=filename>rc.conf</span> te staan:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;hostb.example.org&#34;
ifconfig_fxp0=&#34;inet 192.168.1.4 netmask 255.255.255.0&#34;
cloned_interfaces=&#34;carp0&#34;
ifconfig_carp0=&#34;vhid 2 pass testpass 192.168.1.51/24&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is erg belangrijk dat de wachtwoorden die met de optie <code>pass</code> aan <code>ifconfig</code> gegeven zijn, identiek zijn. De <span class=filename>carp</span> apparaten zullen alleen luisteren naar en advertenties accepteren van machines met het juiste wachtwoord. Het VHID dient ook verschillend te zijn voor elke machine.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De derde machine, <code>provider.example.org</code>, dient voorbereidt te worden op het afhandelen van failover van beide hosts. Deze machine heeft twee <span class=filename>carp</span> apparaten nodig, één om elke host af te handelen. De juiste instelregels voor <span class=filename>rc.conf</span> zullen ongeveer gelijk zijn aan de volgende:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;provider.example.org&#34;
ifconfig_fxp0=&#34;inet 192.168.1.5 netmask 255.255.255.0&#34;
cloned_interfaces=&#34;carp0 carp1&#34;
ifconfig_carp0=&#34;vhid 1 advskew 100 pass testpass 192.168.1.50/24&#34;
ifconfig_carp1=&#34;vhid 2 advskew 100 pass testpass 192.168.1.51/24&#34;</pre></div></div><div class=paragraph><p>Met twee <span class=filename>carp</span> apparaten is <code>provider.example.org</code> in staat om het IP-adres van de andere machine op te pikken wanneer de ene niet meer antwoordt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De standaard FreeBSD-kernel <em>kan</em> preëmptie geactiveerd hebben. In dat geval hoeft <code>provider.example.org</code> het IP-adres niet terug te geven aan de originele contentserver. In dit geval kan het nodig zijn dat een beheerder handmatig het IP terug aan de meester moet geven. Het volgende commando dient op <code>provider.example.org</code> gegeven te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig carp0 down &amp;&amp; ifconfig carp0 up</span></code></pre></div></div><div class=paragraph><p>Dit dient gedaan te worden op de <span class=filename>carp</span> interface die met de juiste host overeenkomt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Op dit moment dient CARP volledig actief en beschikbaar voor testen te zijn. Voor het testen dienen òfwel het netwerken herstart te worden, òf de machines dienen opnieuw opgestart te worden.</p></div><div class=paragraph><p>Meer informatie is altijd beschikbaar in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=carp&amp;sektion=4&amp;format=html">carp(4)</a></p></div></div></div></div></div><h1 id=appendices class=sect0>Deel V: Appendix<a class=anchor href=#appendices></a></h1><div class=sect1><h2 id=mirrors>Bijlage A: FreeBSD verkrijgen<a class=anchor href=#mirrors></a></h2><div class=sectionbody><div class=sect2><h3 id=mirrors-cdrom>A.1. CD-ROM en DVD uitgevers<a class=anchor href=#mirrors-cdrom></a></h3><div class=sect3><h4 id=_winkelproducten_in_doos>A.1.1. Winkelproducten in doos<a class=anchor href=#_winkelproducten_in_doos></a></h4><div class=paragraph><p>FreeBSD is beschikbaar in een doos (FreeBSD CD-ROMs, additionele software en gedrukte documentatie) bij verschillende verkopers:</p></div><div class=ulist><ul><li><p>Frys Electronics<br>WWW: <a href=http://www.frys.com/ class=bare>http://www.frys.com/</a></p></li></ul></div></div><div class=sect3><h4 id=_cd_roms_en_dvds>A.1.2. CD-ROMs en DVD’s<a class=anchor href=#_cd_roms_en_dvds></a></h4><div class=paragraph><p>FreeBSD CD-ROMs en DVD’s zijn te koop bij veel online winkels:</p></div><div class=ulist><ul><li><p>FreeBSD Mall, Inc.<br>700 Harvest Park Ste F<br>Brentwood, CA 94513<br>Verenigde Staten<br>Telefoon: +1 925 240-6652<br>Fax: +1 925 674-0821<br>E–mail: &lt;<a href=mailto:info@freebsdmall.com>info@freebsdmall.com</a>><br>WWW: <a href=http://www.freebsdmall.com/ class=bare>http://www.freebsdmall.com/</a></p></li><li><p>Dr. Hinner EDV<br>St. Augustinus-Str. 10<br>D-81825 München<br>Duitsland<br>Telefoon: (089) 428 419<br>WWW: <a href=http://www.hinner.de/linux/freebsd.html class=bare>http://www.hinner.de/linux/freebsd.html</a></p></li><li><p>JMC Software<br>Ierland<br>Telefoon: 353 1 6291282<br>WWW: <a href=http://www.thelinuxmall.com class=bare>http://www.thelinuxmall.com</a></p></li><li><p>Linux Distro UK<br>42 Wharfedale Road<br>Margate<br>CT9 2TB<br>Verenigd Koninkrijk<br>WWW: <a href=https://linux-distro.co.uk/ class=bare>https://linux-distro.co.uk/</a></p></li><li><p>The Linux Emporium<br>Hilliard House, Lester Way<br>Wallingford<br>OX10 9TA<br>Verenigd Koninkrijk<br>Telefoon: +44 1491 837010<br>Fax: +44 1491 837016<br>WWW: <a href=http://www.linuxemporium.co.uk/products/bsd/ class=bare>http://www.linuxemporium.co.uk/products/bsd/</a></p></li><li><p>Linux+ DVD Magazine<br>Lewartowskiego 6<br>Warsaw<br>00-190<br>Polen<br>Telefoon: +48 22 860 18 18<br>E–mail: &lt;<a href=mailto:editors@lpmagazine.org>editors@lpmagazine.org</a>><br>WWW: <a href=http://www.lpmagazine.org/ class=bare>http://www.lpmagazine.org/</a></p></li><li><p>Linux System Labs Australia<br>21 Ray Drive<br>Balwyn North<br>VIC - 3104<br>Australië<br>Telefoon: +61 3 9857 5918<br>Fax: +61 3 9857 8974<br>WWW: <a href=http://www.lsl.com.au class=bare>http://www.lsl.com.au</a></p></li><li><p>LinuxCenter.Ru<br>Galernaya Street, 55<br>Saint-Petersburg<br>190000<br>Rusland<br>Telefoon: +7-812-3125208<br>E–mail: &lt;<a href=mailto:info@linuxcenter.ru>info@linuxcenter.ru</a>><br>WWW: <a href=http://linuxcenter.ru/shop/freebsd class=bare>http://linuxcenter.ru/shop/freebsd</a></p></li></ul></div></div><div class=sect3><h4 id=_distributeurs>A.1.3. Distributeurs<a class=anchor href=#_distributeurs></a></h4><div class=paragraph><p>Wederverkopers die FreeBSD CD-ROM producten willen verkopen kunnen contact opnemen met een distributeur:</p></div><div class=ulist><ul><li><p>Ingram Micro<br>1600 E. St. Andrew Place<br>Santa Ana, CA<br>92705-4926 Verenigde Staten<br>Telefoon: 1 (800) 456-8000<br>WWW: <a href=http://www.ingrammicro.com/ class=bare>http://www.ingrammicro.com/</a></p></li><li><p>Kudzu, LLC<br>7375 Washington Ave. S.<br>Edina, MN 55439<br>Verenigde Staten<br>Telefoon: +1 952 947-0822<br>Fax: +1 952 947-0876<br>E–mail: &lt;<a href=mailto:sales@kudzuenterprises.com>sales@kudzuenterprises.com</a>></p></li><li><p>LinuxCenter.Ru<br>Galernaya Street, 55<br>Sint-Petersburg<br>190000<br>Rusland<br>Telefoon: +7-812-3125208<br>E–mail: &lt;<a href=mailto:info@linuxcenter.ru>info@linuxcenter.ru</a>><br>WWW: <a href=http://linuxcenter.ru/freebsd class=bare>http://linuxcenter.ru/freebsd</a></p></li></ul></div></div></div><div class=sect2><h3 id=mirrors-ftp>A.2. FTP sites<a class=anchor href=#mirrors-ftp></a></h3><div class=paragraph><p>De officiële broncode voor FreeBSD is beschikbaar via anoniem toegankelijke FTP in de hele wereld via vele mirrorsites. De site <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/>ftp://ftp.FreeBSD.org/pub/FreeBSD/</a> heeft een goede verbinding en staat veel verbindingen toe, maar het is waarschijnlijk beter om een mirrorsite te zoeken die "dichterbij" is (zeker als het doel is ook een soort mirrorsite op te zetten).</p></div><div class=paragraph><p>FreeBSD is beschikbaar via de onderstaande anonieme FTP mirror sites. Bij het kiezen van anonieme FTP voor het verkrijgen van FreeBSD wordt aangeraden een site die dichtbij ligt te kiezen. De mirrorsites die in de lijst staan als "Primaire Mirrorsites" hebben meestal het complete FreeBSD archief (alle beschikbare versies voor alle architecturen) maar downloads zijn waarschijnlijk sneller van een site die in het land of de regio van de gebruiker staat. De regionale sites hebben de meeste recente versies voor de meest populaire architecturen, maar hebben wellicht niet het complete archief. Alle sites geven toegang via anonieme FTP, maar een aantal sites hebben ook andere toegangsmogelijkheden. De toegangsmogelijkheden voor iedere site staan tussen haakjes achter de hostnaam.</p></div><div class=paragraph><p><a href=#central>Central Servers</a>, <a href=#primary>Primary Mirror Sites</a>, <a href=#armenia>Armenia</a>, <a href=#australia>Australia</a>, <a href=#austria>Austria</a>, <a href=#brazil>Brazil</a>, <a href=#czech-republic>Czech Republic</a>, <a href=#denmark>Denmark</a>, <a href=#estonia>Estonia</a>, <a href=#finland>Finland</a>, <a href=#france>France</a>, <a href=#germany>Germany</a>, <a href=#greece>Greece</a>, <a href=#hong-kong>Hong Kong</a>, <a href=#ireland>Ireland</a>, <a href=#japan>Japan</a>, <a href=#korea>Korea</a>, <a href=#latvia>Latvia</a>, <a href=#lithuania>Lithuania</a>, <a href=#netherlands>Netherlands</a>, <a href=#new-zealand>New Zealand</a>, <a href=#norway>Norway</a>, <a href=#poland>Poland</a>, <a href=#russia>Russia</a>, <a href=#saudi-arabia>Saudi Arabia</a>, <a href=#slovenia>Slovenia</a>, <a href=#south-africa>South Africa</a>, <a href=#spain>Spain</a>, <a href=#sweden>Sweden</a>, <a href=#switzerland>Switzerland</a>, <a href=#taiwan>Taiwan</a>, <a href=#ukraine>Ukraine</a>, <a href=#uk>United Kingdom</a>, <a href=#usa>United States of America</a>.</p></div><div class=paragraph><p>(as of UTC)</p></div><div id=central class=paragraph><p><strong>Central Servers</strong></p></div><div class=paragraph><p><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.FreeBSD.org/pub/FreeBSD/</a>)</p></div><div id=primary class=paragraph><p><strong>Primary Mirror Sites</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:mirror-admin@FreeBSD.org>mirror-admin@FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp1.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp1.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp3.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp4.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp4.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp5.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp7.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp10.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp10.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp10.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp10.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp10.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp10.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp11.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp11.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp13.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp13.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp14.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp14.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp14.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp14.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=armenia class=paragraph><p><strong>Armenia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@am.FreeBSD.org>hostmaster@am.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp1.am.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp1.am.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp1.am.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp1.am.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li></ul></div><div id=australia class=paragraph><p><strong>Australia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@au.FreeBSD.org>hostmaster@au.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.au.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.au.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.au.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.au.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp3.au.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.au.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=austria class=paragraph><p><strong>Austria</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@at.FreeBSD.org>hostmaster@at.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.at.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.at.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp.at.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.at.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp.at.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.at.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=brazil class=paragraph><p><strong>Brazil</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@br.FreeBSD.org>hostmaster@br.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp2.br.FreeBSD.org/FreeBSD/ class=bare>ftp://ftp2.br.FreeBSD.org/FreeBSD/</a> (ftp / <a href=http://ftp2.br.FreeBSD.org/ class=bare>http://ftp2.br.FreeBSD.org/</a>)</p></li><li><p><a href=ftp://ftp3.br.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.br.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync)</p></li><li><p><a href=ftp://ftp4.br.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.br.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=czech-republic class=paragraph><p><strong>Czech Republic</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@cz.FreeBSD.org>hostmaster@cz.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.cz.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.cz.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=ftp://ftp.cz.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.cz.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp.cz.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.cz.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp.cz.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.cz.FreeBSD.org/pub/FreeBSD/</a> / rsync / rsyncv6)</p></li><li><p><a href=ftp://ftp2.cz.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.cz.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp2.cz.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.cz.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=denmark class=paragraph><p><strong>Denmark</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:staff@dotsrc.org>staff@dotsrc.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.dk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.dk.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp.dk.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.dk.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp.dk.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.dk.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=estonia class=paragraph><p><strong>Estonia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@ee.FreeBSD.org>hostmaster@ee.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.ee.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.ee.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=finland class=paragraph><p><strong>Finland</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@fi.FreeBSD.org>hostmaster@fi.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.fi.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.fi.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=france class=paragraph><p><strong>France</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@fr.FreeBSD.org>hostmaster@fr.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp1.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp1.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp1.fr.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp1.fr.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp3.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync)</p></li><li><p><a href=ftp://ftp7.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp8.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp8.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=germany class=paragraph><p><strong>Germany</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:de-bsd-hubs@de.FreeBSD.org>de-bsd-hubs@de.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.de.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.de.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp1.de.FreeBSD.org/freebsd/ class=bare>ftp://ftp1.de.FreeBSD.org/freebsd/</a> (ftp / <a href=http://www1.de.FreeBSD.org/freebsd/ class=bare>http://www1.de.FreeBSD.org/freebsd/</a> / rsync://rsync3.de.FreeBSD.org/freebsd/)</p></li><li><p><a href=ftp://ftp2.de.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.de.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp2.de.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.de.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp4.de.FreeBSD.org/FreeBSD/ class=bare>ftp://ftp4.de.FreeBSD.org/FreeBSD/</a> (ftp / <a href=http://ftp4.de.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.de.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp5.de.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.de.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp7.de.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.de.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp7.de.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp7.de.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=greece class=paragraph><p><strong>Greece</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@gr.FreeBSD.org>hostmaster@gr.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.gr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.gr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.gr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.gr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=hong-kong class=paragraph><p><strong>Hong Kong</strong></p></div><div class=paragraph><p><a href=ftp://ftp.hk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.hk.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></div><div id=ireland class=paragraph><p><strong>Ireland</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@ie.FreeBSD.org>hostmaster@ie.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp3.ie.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.ie.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync)</p></li></ul></div><div id=japan class=paragraph><p><strong>Japan</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@jp.FreeBSD.org>hostmaster@jp.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp3.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp5.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp7.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp8.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp8.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp9.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp9.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=korea class=paragraph><p><strong>Korea</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@kr.FreeBSD.org>hostmaster@kr.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.kr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.kr.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync)</p></li><li><p><a href=ftp://ftp2.kr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.kr.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp2.kr.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.kr.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=latvia class=paragraph><p><strong>Latvia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@lv.FreeBSD.org>hostmaster@lv.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.lv.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.lv.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.lv.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.lv.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=lithuania class=paragraph><p><strong>Lithuania</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@lt.FreeBSD.org>hostmaster@lt.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.lt.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.lt.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.lt.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.lt.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=netherlands class=paragraph><p><strong>Netherlands</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@nl.FreeBSD.org>hostmaster@nl.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.nl.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.nl.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.nl.FreeBSD.org/os/FreeBSD/ class=bare>http://ftp.nl.FreeBSD.org/os/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp2.nl.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.nl.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=new-zealand class=paragraph><p><strong>New Zealand</strong></p></div><div class=ulist><ul><li><p><a href=ftp://ftp.nz.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.nz.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.nz.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.nz.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=norway class=paragraph><p><strong>Norway</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@no.FreeBSD.org>hostmaster@no.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.no.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.no.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync)</p></li></ul></div><div id=poland class=paragraph><p><strong>Poland</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@pl.FreeBSD.org>hostmaster@pl.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.pl.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.pl.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p>ftp2.pl.FreeBSD.org</p></li></ul></div><div id=russia class=paragraph><p><strong>Russia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@ru.FreeBSD.org>hostmaster@ru.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.ru.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.ru.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.ru.FreeBSD.org/FreeBSD/ class=bare>http://ftp.ru.FreeBSD.org/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp2.ru.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.ru.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp2.ru.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.ru.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp5.ru.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.ru.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp5.ru.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp5.ru.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp6.ru.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.ru.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=saudi-arabia class=paragraph><p><strong>Saudi Arabia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:ftpadmin@isu.net.sa>ftpadmin@isu.net.sa</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.isu.net.sa/pub/ftp.freebsd.org class=bare>ftp://ftp.isu.net.sa/pub/ftp.freebsd.org</a> (ftp)</p></li></ul></div><div id=slovenia class=paragraph><p><strong>Slovenia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@si.FreeBSD.org>hostmaster@si.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.si.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.si.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=south-africa class=paragraph><p><strong>South Africa</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@za.FreeBSD.org>hostmaster@za.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.za.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.za.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.za.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.za.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.za.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.za.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=spain class=paragraph><p><strong>Spain</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@es.FreeBSD.org>hostmaster@es.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.es.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.es.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.es.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.es.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp3.es.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.es.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=sweden class=paragraph><p><strong>Sweden</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@se.FreeBSD.org>hostmaster@se.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.se.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.se.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync://ftp2.se.FreeBSD.org/)</p></li><li><p><a href=ftp://ftp3.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.se.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.se.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=ftp://ftp4.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.se.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp4.se.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.se.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp4.se.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.se.FreeBSD.org/pub/FreeBSD/</a> / rsync://ftp4.se.FreeBSD.org/pub/FreeBSD/ / rsync://ftp4.se.FreeBSD.org/pub/FreeBSD/)</p></li><li><p><a href=ftp://ftp6.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.se.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp6.se.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp6.se.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=switzerland class=paragraph><p><strong>Switzerland</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@ch.FreeBSD.org>hostmaster@ch.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.ch.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.ch.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.ch.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.ch.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=taiwan class=paragraph><p><strong>Taiwan</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@tw.FreeBSD.org>hostmaster@tw.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.ch.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.ch.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=ftp://ftp.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.tw.FreeBSD.org/pub/FreeBSD/</a> / rsync / rsyncv6)</p></li><li><p><a href=ftp://ftp2.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=ftp://ftp2.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.tw.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp2.tw.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.tw.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp2.tw.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.tw.FreeBSD.org/pub/FreeBSD/</a> / rsync / rsyncv6)</p></li><li><p><a href=ftp://ftp4.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp5.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp6.tw.FreeBSD.org/ class=bare>http://ftp6.tw.FreeBSD.org/</a> / rsync)</p></li><li><p><a href=ftp://ftp7.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp8.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp8.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp11.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp11.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp11.tw.FreeBSD.org/FreeBSD/ class=bare>http://ftp11.tw.FreeBSD.org/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp12.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp12.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp13.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp13.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp14.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp14.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp15.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp15.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=ukraine class=paragraph><p><strong>Ukraine</strong></p></div><div class=ulist><ul><li><p><a href=ftp://ftp.ua.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.ua.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.ua.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.ua.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp6.ua.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.ua.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp6.ua.FreeBSD.org/pub/FreeBSD class=bare>http://ftp6.ua.FreeBSD.org/pub/FreeBSD</a> / rsync://ftp6.ua.FreeBSD.org/FreeBSD/)</p></li><li><p><a href=ftp://ftp7.ua.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.ua.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=uk class=paragraph><p><strong>United Kingdom</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@uk.FreeBSD.org>hostmaster@uk.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.uk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.uk.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.uk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.uk.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync://ftp2.uk.FreeBSD.org/ftp.freebsd.org/pub/FreeBSD/)</p></li><li><p><a href=ftp://ftp3.uk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.uk.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.uk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.uk.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp5.uk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.uk.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=usa class=paragraph><p><strong>United States of America</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@us.FreeBSD.org>hostmaster@us.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp1.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp1.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp3.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.us.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp4.us.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.us.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp4.us.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.us.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp5.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp8.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp8.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp10.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp10.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp11.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp11.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp13.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp13.us.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp13.us.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp13.us.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp14.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp14.us.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp14.us.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp14.us.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp15.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp15.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div></div><div class=sect2><h3 id=mirrors-svn>A.3. Subversion-sites<a class=anchor href=#mirrors-svn></a></h3><div class=paragraph><p>Sinds juli 2012 gebruikt FreeBSD <a href=http://subversion.apache.org/>Subversion</a> als het primaire versiebeheersysteem om alle broncode van FreeBSD, de documentatie, en de Portscollectie op te slaan.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Subversion is hoofdzakelijk een gereedschap voor ontwikkelaars. De meeste gebruikers dienen <a href=./#updating-upgrading-freebsdupdate>FreeBSD Update</a> te gebruiken om het basissysteem van FreeBSD bij te werken, en <a href=./#updating-upgrading-portsnap>Portsnap</a> om de FreeBSD Portscollectie bij te werken.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het spiegelsite-netwerk voor Subversion van FreeBSD bevindt zich nog in de beginfase en zal waarschijnlijk veranderen. Reken er niet op dat deze lijst van spiegelsites statisch is. In het bijzonder zullen de SSL-certificaten van de servers op een gegeven moment veranderen.</p></div><div class=paragraph><p>In Subversion worden URLs gebruikt om een depot aan te duiden in de vorm van <code>protocol://hostnaam/pad</code>. Spiegelsites kunnen verschillende protocollen ondersteunen zoals hieronder is gespecificeerd. Het eerste gedeelte van het pad is het FreeBSD-depot wat benaderd moet worden. Er zijn drie verschillende depots, <code>base</code> voor de broncode van het basissysteem van FreeBSD, <code>ports</code> voor de Portscollectie, en <code>doc</code> voor de documentatie. De URL <code>svn://svn0.us-east.FreeBSD.org/ports/head/</code> specificeert de hoofdtak van het ports-depot op de spiegelsite <code>svn0.us-east.FreeBSD.org</code>, gebruikmakend van het svn-protocol.</p></div><div class=paragraph><p>Alle spiegelsites bevatten alle depots.</p></div><div class=paragraph><p>De FreeBSD Subversion hoofdserver, <code>svn.FreeBSD.org</code>, is publiekelijk toegankelijk als alleen-lezen. Dit kan in de toekomst veranderen, dus gebruikers worden aangeraden om een van de officiële spiegelsites te gebruiken. Gebruik <a href=http://svnweb.FreeBSD.org/>http://svnweb.FreeBSD.org</a> om de Subversion-depots van FreeBSD met een webbrowser te bekijken.</p></div><table class="tableblock frame-all grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Naam</th><th class="tableblock halign-left valign-top">Protocollen</th><th class="tableblock halign-left valign-top">Locatie</th><th class="tableblock halign-left valign-top">SSL-vingerafdruk</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>svn0.us-west.FreeBSD.org</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>svn, <a href=http://svn0.us-west.FreeBSD.org/base/>http</a>, <a href=https://svn0.us-west.FreeBSD.org/base/>https</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Verenigde Staten, Californië</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SHA1 <code>79:35:8F:CA:6D:34:D9:30:44:D1:00:AF:33:4D:E6:11:44:4D:15:EC</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>svn0.us-east.FreeBSD.org</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>svn, <a href=http://svn0.us-east.FreeBSD.org/base/>http</a>, <a href=https://svn0.us-east.FreeBSD.org/base/>https</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Verenigde Staten, New Jersey</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SHA1 <code>06:D1:23:DE:5E:7A:F7:2B:7A:7E:74:95:5F:54:8D:5C:B0:D6:2E:8F</code></p></td></tr></tbody></table></div><div class=sect2><h3 id=anoncvs>A.4. Anonieme CVS<a class=anchor href=#anoncvs></a></h3><div class=sect3><h4 id=anoncvs-intro>A.4.1. Inleiding<a class=anchor href=#anoncvs-intro></a></h4><div class=paragraph><p>Anonieme CVS (of ook wel bekend als <em>anoncvs</em>) is een functie die beschikbaar is met de hulpprogramma’s die bij FreeBSD zitten om te synchroniseren met een elders aanwezig CVS depot. Het staat gebruikers van FreeBSD onder andere toe om zonder bijzondere rechten alleen-lezen operaties uit te voeren op een van de officiële anoncvs servers van het FreeBSD project. Om het te kunnen gebruiken dient de omgevingsvariabele <code>CVSROOT</code> zo ingesteld te worden dat hij wijst naar de gewenste anoncvs server, dient het bekende wachtwoord "anoncvs" bij het commando <code>cvs login</code> opgegeven te worden en kan daarna <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> gebruikt worden om het te benaderen als ieder lokaal aanwezig depot.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het commando <code>cvs login</code> slaat de wachtwoorden die voor aanmelden bij de CVS server op in een bestand met de naam <span class=filename>.cvspass</span> in de map <code>HOME</code>. Als dit bestand niet bestaat, is het mogelijk dat er een foutmelding wordt gegeven als <code>cvs login</code> de eerste keer wordt gebruikt. Dat kan opgelost worden door een leeg bestand <span class=filename>.cvspass</span> te maken en dan opnieuw aan te melden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Hoewel de diensten <a href=#cvsup>CVSup</a> en <em>anoncvs</em> beiden vrijwel dezelfde functie invullen, zijn er redenen die de keuze voor de synchronisatiemethode beïnvloeden. In een notendop is CVSup veel efficiënter in het gebruik van netwerkbronnen en is het de meest geavanceerde van de twee, maar daar staat iets tegenover. Voor het gebruik van CVSup moet eerst een speciale client geïnstalleerd en ingesteld worden voordat er bits kunnen gaan stromen en dat kan dan alleen in de redelijk grote brokken die in CVSup_collections_ heten.</p></div><div class=paragraph><p>Anoncvs kan daarentegen gebruikt worden om alles te bekijken van een individueel bestand tot aan een specifiek programma (als <code>ls</code> of <code>grep</code>) door aan de naam van de CVS module te refereren. Ook anoncvs is alleen geschikt voor alleen-lezen operaties op het CVS depot, dus als het de bedoeling is om lokaal ontwikkelwerk en hetzelfde depot met delen uit het FreeBSD project te combineren, dan biedt alleen CVSup daar een oplossing voor.</p></div></div><div class=sect3><h4 id=anoncvs-usage>A.4.2. Anonieme CVS gebruiken<a class=anchor href=#anoncvs-usage></a></h4><div class=paragraph><p>Het instellen van <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> om gebruik te maken van een Anoniem CVS depot is een kwestie van het instellen van de omgevingsvariabele <code>CVSROOT</code> op een van de <em>anoncvs</em> servers van het FreeBSD project. Op het moment van schrijven zijn de volgende servers beschikbaar:</p></div><div class=ulist><ul><li><p><em>Frankrijk</em>: :pserver:anoncvs@anoncvs.fr.FreeBSD.org:/home/ncvs (Gebruik <code>cvs login</code> voor pserver-modus en voer het wachtwoord "anoncvs" in wanneer het gevraagd wordt. Voor ssh is geen wachtwoord nodig.)</p></li><li><p><em>Taiwan</em>: :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs (Gebruik <code>cvs login</code> voor pserver-modus en voer elk willekeurig wachtwoord in wanneer het gevraagd wordt. Voor ssh is geen wachtwoord nodig.)</p><div class="literalblock programlisting"><div class=content><pre>SSH2 HostKey: 1024 02:ed:1b:17:d6:97:2b:58:5e:5c:e2:da:3b:89:88:26 /etc/ssh/ssh_host_rsa_key.pub
SSH2 HostKey: 1024 e8:3b:29:7b:ca:9f:ac:e9:45:cb:c8:17:ae:9b:eb:55 /etc/ssh/ssh_host_dsa_key.pub</pre></div></div></li></ul></div><div class=paragraph><p>Omdat met CVS vrijwel iedere versie die ooit beschikbaar is geweest "uitgecheckt" kan worden, is het van belang op de hoogte te zijn van de <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> vlag voor revisie (<code>-r</code>) en welke waarden zie zoal kan aannemen in het FreeBSD Project depot.</p></div><div class=paragraph><p>Er zijn twee soorten labels (tags): revisielabels en taklabels (branch). Een revisielabel refereert aan een specifieke revisie. De betekenis blijft van dag tot dag gelijk. Aan de andere kant refereert een taklabel aan de laatste revisie in een bepaalde ontwikkellijn op een bepaald moment. Omdat een taklabel niet refereert aan een specifieke revisie, kan die morgen anders zijn dan vandaag.</p></div><div class=paragraph><p><a href=#cvs-tags>CVS labels</a> bevat revisielabels waar gebruikers in geïnteresseerd kunnen zijn. Nogmaals: deze zijn allemaal niet geldig voor de Portscollectie omdat de Portscollectie geen meerdere ontwikkel takken kent.</p></div><div class=paragraph><p>Als een specifiek taklabel wordt aangegeven, worden als alles goed gaat, de laatste revisies uit een bepaalde ontwikkellijn ontvangen. Als er een oudere versie opgehaald moet worden, kan dat door met de vlag <code>-D datum</code> een datum aan te geven. In <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> staan meer details.</p></div></div><div class=sect3><h4 id=_voorbeelden_6>A.4.3. Voorbeelden<a class=anchor href=#_voorbeelden_6></a></h4><div class=paragraph><p>Hoewel het sterk wordt aangeraden eerst de hulppagina’s voor <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> grondig door te lezen, volgen hier een aantal snelle voorbeelden die feitelijk aangeven hoe Anonieme CVS gebruikt kan worden.</p></div><div class=exampleblock><div class=title>Voorbeeld 42. SSH gebruiken om de <span class=filename>src/</span> tree uit te checken:</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cvs <span class=nt>-d</span> anoncvs@anoncvs1.FreeBSD.org:/home/ncvs co src
The authenticity of host <span class=s1>&#39;anoncvs1.freebsd.org (216.87.78.137)&#39;</span> can<span class=s1>&#39;t be established.
DSA key fingerprint is 53:1f:15:a3:72:5c:43:f6:44:0e:6a:e9:bb:f8:01:62.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;</span>anoncvs1.freebsd.org<span class=s1>&#39; (DSA) to the list of known hosts.</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Voorbeeld 43. Iets uitchecken uit -CURRENT (<a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a>):</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setenv CVSROOT :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs
% cvs login
Op de prompt, voer een willekeurig wachtwoord <span class=k>in</span> “wachtwoord”.
% cvs co <span class=nb>ls</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Voorbeeld 44. SSH gebruiken om de <span class=filename>src/</span> structuur uit te checken:</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cvs <span class=nt>-d</span> freebsdanoncvs@anoncvs.FreeBSD.org:/home/ncvs co src
The authenticity of host <span class=s1>&#39;anoncvs.freebsd.org (128.46.156.46)&#39;</span> can<span class=s1>&#39;t be established.
DSA key fingerprint is 52:02:38:1a:2f:a8:71:d3:f5:83:93:8d:aa:00:6f:65.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;</span>anoncvs.freebsd.org<span class=s1>&#39; (DSA) to the list of known hosts.</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Voorbeeld 45. De versie van <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> in de 8-STABLE tak uitchecken:</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setenv CVSROOT :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs
% cvs login
Op de prompt, voer een willekeurig wachtwoord <span class=k>in</span> “wachtwoord”.
% cvs co <span class=nt>-rRELENG_8</span> <span class=nb>ls</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Voorbeeld 46. Een lijst wijzigingen maken (als unified diffs) voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setenv CVSROOT :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs
% cvs login
Op de prompt, voer een willekeurig wachtwoord <span class=k>in</span> “wachtwoord”.
% cvs rdiff <span class=nt>-u</span> <span class=nt>-rRELENG_8_0_0_RELEASE</span> <span class=nt>-rRELENG_8_1_0_RELEASE</span> <span class=nb>ls</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Voorbeeld 47. Uitzoeken welke modulenamen gebruikt kunnen worden:</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setenv CVSROOT :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs
% cvs login
Op de prompt, voer een willekeurig wachtwoord <span class=k>in</span> “wachtwoord”.
% cvs co modules
% more modules/modules</code></pre></div></div></div></div></div><div class=sect3><h4 id=_andere_bronnen>A.4.4. Andere bronnen<a class=anchor href=#_andere_bronnen></a></h4><div class=paragraph><p>De volgende bronnen kunnen bijdragen aan een beter begrip van CVS:</p></div><div class=ulist><ul><li><p><a href=http://users.csc.calpoly.edu/~gfisher/classes/308/handouts/cvs-basics.html>CVS Tutorial</a> van California Polytechnic State University.</p></li><li><p><a href=http://www.nongnu.org/cvs/>CVS Home</a>, de CVS gemeenschap voor ontwikkeling en ondersteuning.</p></li><li><p><a href=http://www.FreeBSD.org/cgi/cvsweb.cgi>CVSweb</a> is de FreeBSD Project webinterface voor CVS.</p></li></ul></div></div></div><div class=sect2><h3 id=ctm>A.5. CTM gebruiken<a class=anchor href=#ctm></a></h3><div class=paragraph><p>CTM is een methode om een map elders gesynchroniseerd te houden met een centrale. Het is ontwikkeld voor gebruik met de FreeBSD broncode, hoewel sommigen het ook voor andere doeleinden handig vinden. Er bestaat op dit moment weinig tot geen documentatie over het proces van het maken van delta’s. Voor informatie over het gebruik van CTM kan het beste contact gezocht worden met de <a href=https://lists.FreeBSD.org/subscription/ctm-users>ctm-users-desc</a> mailinglijst.</p></div><div class=sect3><h4 id=_waarom_ctm_gebruiken>A.5.1. Waarom CTM gebruiken?<a class=anchor href=#_waarom_ctm_gebruiken></a></h4><div class=paragraph><p>CTM geeft een lokale kopie van de FreeBSD broncode. Die is in een aantal "smaken" beschikbaar. Of het gaat om slechts één tak of de complete CVS structuur, CTM kan het bieden. CTM is gewoon gemaakt voor actieve ontwikkelaars die met FreeBSD werken, maar geen of een slechte Internetverbinding hebben of gewoon automatisch de laatste wijzigingen willen ontvangen. De meest actieve takken kennen op z’n hoogst drie delta’s per dag. Het is het overwegen waard om ze per automatische mail te laten sturen. De grootte van de updates wordt altijd zo klein mogelijk gehouden. Meestal kleiner dan 5 K en soms (in tien procent van de gevallen) is het 10-50 K. In uitzonderlijke gevallen komt het voor dat een mail van 100 K of meer wordt gestuurd.</p></div><div class=paragraph><p>Het is wel van belang op de hoogte te zijn van de valkuilen die een rol spelen bij het direct werken met broncode in plaats van met een voorverpakte release. Dit geldt nog meer als wordt gewerkt met de "current" code. Het lezen van <a href=./#current>Bijblijven met FreeBSD</a> wordt sterk aangeraden.</p></div></div><div class=sect3><h4 id=_wat_is_er_nodig_om_ctm_te_gebruiken>A.5.2. Wat is er nodig om CTM te gebruiken?<a class=anchor href=#_wat_is_er_nodig_om_ctm_te_gebruiken></a></h4><div class=paragraph><p>Voor het gebruik van CTM zijn twee dingen nodig: het CTM programma en de initiële delta’s om de applicatie te voeden en naar een "current" niveau te komen.</p></div><div class=paragraph><p>CTM is al onderdeel van FreeBSD sinds versie 2.0 is uitgebracht en is te vinden in <span class=filename>/usr/src/usr.sbin/ctm</span>, als de broncode aanwezig is.</p></div><div class=paragraph><p>De "delta’s" voor CTM kunnen op twee manieren komen: met FTP of per e-mail. De volgende FTP sites bieden ondersteuning voor CTM:</p></div><div class=paragraph><p><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/>ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/</a></p></div><div class=paragraph><p>Er staan er nog meer in de paragraaf <a href=#mirrors-ctm>mirrors</a>.</p></div><div class=paragraph><p>FTP de relevante map en download het bestand <span class=filename>README</span> vanaf daar.</p></div><div class=paragraph><p>Voor delta’s via e-mail:</p></div><div class=paragraph><p>Er dient een abonnement genomen te worden op een van de CTM distributielijsten. <a href=https://lists.FreeBSD.org/subscription/ctm-src-cur>ctm-src-cur-desc</a> ondersteunt de complete Subversion structuur. <a href=https://lists.FreeBSD.org/subscription/ctm-src-cur>ctm-src-cur-desc</a> ondersteunt het hoofd van de ontwikkeltak. <a href=https://lists.FreeBSD.org/subscription/ctm-src-9>ctm-src-9-desc</a> ondersteunt de 9.X release tak, enzovoort. Om te abonneren kan geklikt worden op de bovenstaande links of via <a href=https://lists.freebsd.org class=bare>https://lists.freebsd.org</a> kan in een lijst geklikt worden op de lijst waarvoor een abonnement gewenst is. De lijstpagina bevat instructies over hoe te abonneren.</p></div><div class=paragraph><p>Na het ontvangen van CTM updates per mail, kan <code>ctm_rmail</code> gebruikt worden voor het uitpakken en verwerken. <code>ctm_rmail</code> kan zelfs direct vanuit <span class=filename>/etc/aliases</span> gebruikt worden om het proces volledig automatisch te laten verlopen. In de hulppagina van <code>ctm_rmail</code> staan meer details.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Welke methode ook gebruikt wordt voor de CTM delta’s, het is belangrijk een abonnement te nemen op de <a href=https://lists.FreeBSD.org/subscription/ctm-announce>ctm-announce-desc</a> mailinglijst. In de toekomst worden alleen op die lijst aankondigingen gedaan over het CTM systeem. Abonneren kan door op de link hierboven te klikken en de instructies te volgen.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_ctm_de_eerste_keer_gebruiken>A.5.3. CTM de eerste keer gebruiken<a class=anchor href=#_ctm_de_eerste_keer_gebruiken></a></h4><div class=paragraph><p>Voordat de CTM delta’s gebruikt kunnen worden, moet er een startpunt voor bepaald worden.</p></div><div class=paragraph><p>Eerst moet bepaald worden wat er al is. Het is mogelijk te beginnen vanuit een "lege" map. Dan moet een initiële "Empty" delta gebruikt worden om een door CTM ondersteunde structuur te starten. Het is de bedoeling dat deze "start" delta’s ooit voor het gemak op de CD-ROM komen te staan, maar dit is nog niet het geval.</p></div><div class=paragraph><p>Omdat de structuren tientallen megabytes groot zijn, heeft het de voorkeur om al met iets te beginnen. Als er een -RELEASE CD-ROM beschikbaar is, kan de initiële broncode gekopieerd of uitgepakt worden. Dit bespaart nogal wat dataverkeer.</p></div><div class=paragraph><p>De "start" delta’s kunnen herkend worden aan de <code>X</code> die aan het nummer is toegevoegd (bijvoorbeeld <span class=filename>src-cur.3210XEmpty.gz</span>). De nummering achter de <code>X</code> komt overeen met de oorsprong van het initiële "zaad". <span class=filename>Empty</span> is een lege map. Er wordt in het algemeen iedere honderd delta’s een basistransitie voor <code>Empty</code> gemaakt. Die zijn trouwens groot: 70 tot 80 Megabytes <code>gzip</code> data is normaal voor de <span class=filename>XEmpty</span> delta’s.</p></div><div class=paragraph><p>Als er een delta als startpunt is gekozen, zijn ook alle delta’s met hogere volgnummers nodig.</p></div></div><div class=sect3><h4 id=_ctm_in_het_dagelijks_leven_gebruiken>A.5.4. CTM in het dagelijks leven gebruiken<a class=anchor href=#_ctm_in_het_dagelijks_leven_gebruiken></a></h4><div class=paragraph><p>Om de delta’s toe te passen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /where/ever/you/want/the/stuff</span>
<span class=c># ctm -v -v /where/you/store/your/deltas/src-xxx.*</span></code></pre></div></div><div class=paragraph><p>CTM begrijpt delta’s in <code>gzip</code> formaat, dus het niet nodig om eerst <code>gunzip</code> te gebruiken. Dat spaart diskruimte.</p></div><div class=paragraph><p>Tenzij het zeker is van de veiligheid van het proces, doet CTM niets met de structuur. Om een delta te verifiëren kan ook de vlag <code>-c</code> gebruikt worden en dan komt CTM ook niet aan een structuur. Dan wordt alleen de integriteit van de delta gecontroleerd en of die zonder problemen op de huidige structuur kan worden toegepast.</p></div><div class=paragraph><p>CTM kent nog meer opties die in de hulppagina’s worden besproken.</p></div><div class=paragraph><p>Meer is er niet. Iedere keer dat er een delta wordt ontvangen, moet die door CTM gehaald worden om de broncode bijgewerkt te houden.</p></div><div class=paragraph><p>Delta’s kunnen het beste niet verwijderd worden als het lastig is ze opnieuw te downloaden. Dan kunnen ze het beste bewaard worden voor het geval er eens iets gebeurt. Zelfs als er alleen floppy’s beschikbaar zijn, is het wellicht verstandig die te gebruiken met <code>fdwrite</code>.</p></div></div><div class=sect3><h4 id=_lokale_wijzigingen_behouden>A.5.5. Lokale wijzigingen behouden<a class=anchor href=#_lokale_wijzigingen_behouden></a></h4><div class=paragraph><p>Een ontwikkelaar wil graag experimenteren met bestanden in de structuur en die bestanden veranderen. CTM ondersteunt lokale wijzigingen in beperkte mate: alvorens te kijken of bestand <span class=filename>foo</span> bestaat, zoekt het eerst naar <span class=filename>foo.ctm</span>. Als dat bestand bestaat, past CTM de wijzigigen daarop toe in plaats van op <span class=filename>foo</span>.</p></div><div class=paragraph><p>Dit gedrag biedt een eenvoudige mogelijkheid om lokale wijzigingen bij te houden. Dat kan dus door bestanden die gewijzigd gaan worden te kopiëren naar een bestand met dezelfde naam met de toevoeging <span class=filename>.ctm</span>. Dan kan er vrijelijk gespeeld worden met de code, terwijl CTM het bestand <span class=filename>.ctm</span> bijwerkt.</p></div></div><div class=sect3><h4 id=_andere_interessante_mogelijkheden_van_ctm>A.5.6. Andere interessante mogelijkheden van CTM<a class=anchor href=#_andere_interessante_mogelijkheden_van_ctm></a></h4><div class=sect4><h5 id=_uitvinden_wat_precies_wordt_veranderd_met_bijwerken>A.5.6.1. Uitvinden wat precies wordt veranderd met bijwerken<a class=anchor href=#_uitvinden_wat_precies_wordt_veranderd_met_bijwerken></a></h5><div class=paragraph><p>Het is mogelijk een lijst met wijzigingen te maken die CTM zou maken op het broncodedepot met de optie <code>-l</code>.</p></div><div class=paragraph><p>Dit is nuttig als het gewenst is om een logboek bij te houden van de wijzigingen, de te wijzigen bestanden voor- of na te bewerken op welke manier dan ook, of als de gebruiker gewoon een beetje paranoïde is.</p></div></div><div class=sect4><h5 id=_back_ups_maken_vóór_bijwerken>A.5.6.2. Back-ups maken vóór bijwerken<a class=anchor href=#_back_ups_maken_vóór_bijwerken></a></h5><div class=paragraph><p>Soms kan het wenselijk zijn om een back-up te maken van alle bestanden die gewijzigd gaan worden door een CTM update.</p></div><div class=paragraph><p>Met <code>-B back-upbestand</code> back-upt CTM alle bestanden die gewijzigd gaan worden door een CTM delta naar <span class=filename>back-upbestand</span>.</p></div></div><div class=sect4><h5 id=_te_wijzigen_bestanden_door_bijwerken_beperken>A.5.6.3. Te wijzigen bestanden door bijwerken beperken<a class=anchor href=#_te_wijzigen_bestanden_door_bijwerken_beperken></a></h5><div class=paragraph><p>Soms is het wenselijk de reikwijdte voor een CTM update te beperken of kan het wenselijk zijn om maar een paar bestanden bij te werken uit een aantal delta’s.</p></div><div class=paragraph><p>Een lijst met bestanden die CTM mag bewerken kan aangegeven worden met de opties <code>-e</code> en <code>-x</code> en het opgeven van regular expressions.</p></div><div class=paragraph><p>Om bijvoorbeeld een bijgewerkte kopie van <span class=filename>lib/libc/Makefile</span> te maken uit de verzameling met opgeslagen CTM delta’s, kan het volgende commando uitgevoerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /where/ever/you/want/to/extract/it/</span>
<span class=c># ctm -e &#39;^lib/libc/Makefile&#39; ~ctm/src-xxx.*</span></code></pre></div></div><div class=paragraph><p>Voor ieder te wijzigen bestand in een CTM delta worden de opties <code>-e</code> en <code>-x</code> toegepast in de volgorde waarin ze op de commandoregel staan. Het bestand wordt alleen door CTM verwerkt als het passend is bevonden na het toepassen van alle parameters in <code>-e</code> en <code>-x</code>.</p></div></div></div><div class=sect3><h4 id=_toekomstige_plannen_voor_ctm>A.5.7. Toekomstige plannen voor CTM<a class=anchor href=#_toekomstige_plannen_voor_ctm></a></h4><div class=paragraph><p>Die zijn er:</p></div><div class=ulist><ul><li><p>Een of andere vorm van authenticatie in het CTM systeem bouwen zodat vervalste CTM updates afgevangen kunnen worden;</p></li><li><p>De opties voor CTM opruimen omdat ze verwarrend zijn geworden.</p></li></ul></div></div><div class=sect3><h4 id=_nog_meer>A.5.8. Nog meer<a class=anchor href=#_nog_meer></a></h4><div class=paragraph><p>Er zijn ook delta’s voor de `ports`collectie, maar daar is nog niet zo veel belangstelling voor.</p></div></div><div class=sect3><h4 id=mirrors-ctm>A.5.9. CTM mirrors<a class=anchor href=#mirrors-ctm></a></h4><div class=paragraph><p><a href=#ctm>CTM</a>/FreeBSD is op de volgende mirrorsites via anonieme FTP beschikbaar. Als voor CTM anonieme FTP wordt gebruikt, heeft het de voorkeur een site die in geografische zin dichtbij is te gebruiken.</p></div><div class=paragraph><p>Bij problemen kan contact gezocht worden met de <a href=https://lists.FreeBSD.org/subscription/ctm-users>ctm-users-desc</a> mailinglijst.</p></div><div class=dlist><dl><dt class=hdlist1>Californië, Bay Area, officiële bron</dt><dd><div class=ulist><ul><li><p><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/>ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/</a></p></li></ul></div></dd><dt class=hdlist1>Zuid-Afrika, back-upserver voor oude delta’s</dt><dd><div class=ulist><ul><li><p><a href=ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/>ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/</a></p></li></ul></div></dd><dt class=hdlist1>Taiwan/R.O.C.</dt><dd><div class=ulist><ul><li><p><a href=ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/>ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></p></li><li><p><a href=ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/>ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></p></li><li><p><a href=ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/>ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></p></li></ul></div></dd></dl></div><div class=paragraph><p>Als er geen mirror dichtbij is of als die incompleet is, kan een zoekmachine als <a href=http://www.alltheweb.com/>alltheweb</a> gebruikt worden.</p></div></div></div><div class=sect2><h3 id=cvsup>A.6. CVSup gebruiken<a class=anchor href=#cvsup></a></h3><div class=sect3><h4 id=cvsup-intro>A.6.1. Inleiding<a class=anchor href=#cvsup-intro></a></h4><div class=paragraph><p>CVSup is een softwarepakket voor het verspreiden en bijwerken van broncodestructuren vanaf een master CVS depot op een andere server. De FreeBSD broncode wordt beheerd in een broncode depot op een centrale ontwikkelmachine in Californië. Met CVSup kunnen FreeBSD gebruikers op eenvoudige wijze hun broncode bijwerken.</p></div><div class=paragraph><p>CVSup gebruikt een zogenaamd <em>pull</em> model voor het bijwerken. In het pull-model vraagt iedere client de server om updates als die nodig zijn. De server wacht passief op een verzoek om updates van zijn clients. Alle updates worden dus op initiatief van de client gedaan. De server stuurt nooit ongevraagde updates. Gebruikers moeten de CVSup client handmatig draaien om te updaten of een <code>cron</code> taak instellen om op regelmatige basis bij te werken.</p></div><div class=paragraph><p>De term CVSup, op de gegeven wijze geschreven, doelt op het complete softwarepakket. De belangrijkste componenten zijn de client <code>cvsup</code>, die op de machine van een gebruiker draait, en de server <code>cvsupd</code>, die op alle FreeBSD mirrorsites draait.</p></div><div class=paragraph><p>In de FreeBSD documentatie en op de mailinglijsten zijn referenties aan sup te vinden. Sup was de voorloper van CVSup en diende hetzelfde doel. CVSup wordt op dezelfde manier gebruikt als sup en gebruikt zelfs bestanden met instellingen die ook te gebruiken zijn met <code>sup</code>. Sup wordt niet langer gebruikt in het FreeBSD project omdat CVSup sneller en flexibeler is.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De csup applicatie is een herschreven versie van CVSup in de C taal. Het grootste voordeel ervan is dat het sneller is en dat het niet afhankelijk is van de Modula-3 taal, dus dat hoeft niet geïnstalleerd te worden als afhankelijkheid. Sterker nog de applicatie wordt standaard meegeleverd. als ervoor gekozen is om csup te gebruiken, sla dan de installatie stappen voor CVSup over en vervang de referenties naar CVSup met csup terwijl de rest van het artikel gevolgd wordt.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=cvsup-install>A.6.2. Installatie<a class=anchor href=#cvsup-install></a></h4><div class=paragraph><p>De meest eenvoudige wijze van installatie van CVSup is met het voorgecompileerde pakket <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup/>net/cvsup</a> uit de FreeBSD <a href=./#ports>pakkettencollectie</a>. Als het gewenst is, kan CVSup ook uit de broncode gebouwd worden in <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup/>net/cvsup</a>. De port <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup/>net/cvsup</a> is afhankelijk van het Modula-3 systeem en dat kan wel even duren en er is ook nogal wat schijfruimte voor nodig om het te downloaden en te bouwen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als CVSup gebruikt gaat worden op een machine waarop geen Xorg staat, zoals een server, dan dient de port waar geen CVSupGUI bij zit geïnstalleerd te worden: <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup-without-gui/>net/cvsup-without-gui</a>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=cvsup-config>A.6.3. CVSup instellingen<a class=anchor href=#cvsup-config></a></h4><div class=paragraph><p>De werking van CVSup wordt gestuurd door een bestand met instellingen met de naam <span class=filename>supfile</span>. Er staan een aantal <span class=filename>supfiles</span> als voorbeeld in de map <a href=file://localhost/usr/shared/examples/cvsup/>/usr/shared/examples/cvsup/</a>.</p></div><div class=paragraph><p>De informatie in een <span class=filename>supfile</span> beantwoordt de volgende vragen voor CVSup:</p></div><div class=ulist><ul><li><p><a href=#cvsup-config-files>Welke bestanden moeten ontvangen worden?</a></p></li><li><p><a href=#cvsup-config-vers>Welke versies daarvan moeten ontvangen worden?</a></p></li><li><p><a href=#cvsup-config-where>Waar moeten ze vandaan komen?</a></p></li><li><p><a href=#cvsup-config-dest>Waar moeten ze komen te staan?</a></p></li><li><p><a href=#cvsup-config-status>Waar moet <code>cvsup</code> zijn statusbestanden bijhouden?</a></p></li></ul></div><div class=paragraph><p>In de volgende paragrafen wordt een <span class=filename>supfile</span> bestand opgebouwd door achtereenvolgens alle gestelde vragen te beantwoorden. Als eerste wordt de algemene structuur van een <span class=filename>supfile</span> beschreven.</p></div><div class=paragraph><p>Een <span class=filename>supfile</span> is een tekstbestand. Commentaar begint met een <code>#</code> en loopt tot het einde van de regel. Lege regels en regels die alleen commentaar bevatten worden genegeerd.</p></div><div class=paragraph><p>Iedere regel die overblijft slaat op een groep bestanden die ontvangen moet worden. De regel begint met de naam van een "collectie", een logische groep bestanden op de server. De naam van de collectie geeft de server aan welke bestanden er gestuurd moeten worden. Na de naam van de collectie komen er geen of meer velden die gescheiden worden door witruimte. Die velden beantwoorden de hierboven gestelde vragen. Er zijn twee soorten velden: vlagvelden en waardevelden. Een vlagveld bestaat uit een alleenstaand sleutelwoord, bijvoorbeeld <code>delete</code> of <code>compress</code>. Een waardeveld begint ook met een sleutelwoord, maar het sleutelwoord wordt direct (zonder witruimte) gevolgd door <code>=</code> en een tweede woord. <code>release=cvs</code> is bijvoorbeeld een waardeveld.</p></div><div class=paragraph><p>In een <span class=filename>supfile</span> wordt meestal aangegeven dat er meerdere collecties ontvangen moeten worden. Het is mogelijk om een <span class=filename>supfile</span> te structureren door expliciet alle relevante velden aan te geven voor iedere collectie, maar dat maakt de regels in de <span class=filename>supfile</span> nogal lang en het is onhandig omdat de meeste velden hetzelfde zijn voor alle collecties in een <span class=filename>supfile</span>. CVSup biedt een systeem met standaardinstellingen om dit probleem te omzeilen. Regels die beginnen met de speciale pseudo-collectienaam <code>*default</code> kunnen gebruikt worden om standaarden in te stellen voor de collecties die er in de <span class=filename>supfile</span> achteraan komen. Een standaardwaarde kan voor individuele collecties overschreven worden door een andere waarde in de collectie zelf aan te geven. Standaarden kunnen ook middenin het bestand gewijzigd of aangevuld worden met extra <code>*default</code> regels.</p></div><div class=paragraph><p>Na deze achtergronden wordt er nu een <span class=filename>supfile</span> samengesteld voor het ontvangen en bijwerken van de hoofd broncodestructuur van <a href=./#current>FreeBSD-CURRENT</a>.</p></div><div class=ulist><ul><li><p><a id=cvsup-config-files></a>Welke bestanden moeten ontvangen worden?</p><div class=paragraph><p>De bestanden die via CVSup beschikbaar zijn, zijn beschikbaar in groepen die "collecties" heten. De beschikbare collecties staan beschreven in de <a href=#cvsup-collec>volgende paragraaf</a>. In dit voorbeeld is het de bedoeling dat de hele hoofd broncodestructuur voor FreeBSD wordt ontvangen. Daar is één grote collectie voor: <code>src-all</code>. De eerste stap in het maken van een <span class=filename>supfile</span> is het opsommen van de gewenste collecties, één per regel (in dit geval maar één regel):</p></div><div class="literalblock programlisting"><div class=content><pre>src-all</pre></div></div></li><li><p><a id=cvsup-config-vers></a>Welke versies daarvan moeten ontvangen worden?</p><div class=paragraph><p>Met CVSup kan vrijwel iedere versie van de broncode die ooit heeft bestaan opgehaald worden. Dat kan omdat de cvsupd server direct vanaf het CVS depot werkt, dat alle versies bevat. Er kan aangegeven welke ontvangen moeten worden met de waardevelden <code>tag=</code> en <code>date=</code>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Voorzichtigheid is geboden bij het correct aangeven van velden met <code>tag=</code>. Sommige labels zijn alleen geldig voor bepaalde collecties of bestanden. Als ze incorrect worden aangeven of als er een spelfout wordt gemaakt in een label, verwijdert CVSup bestanden waarvan dat waarschijnlijk niet de bedoeling is. Het label <code>tag=.</code> dient eigenlijk <em>alleen</em> gebruikt te worden voor de <code>ports-*</code> collecties.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Het veld <code>tag=</code> benoemt een symbolisch label in het depot. Er zijn twee soorten labels: revisielabels en taklabels. Een revisielabel refereert aan een specifieke revisie. De betekenis blijft altijd hetzelfde. Een taklabel refereert echter aan de laatste revisie van een gegeven ontwikkellijn op een gegeven moment. Omdat een taklabel niet refereert aan een specifieke revisie, kan het morgen iets anders betekenen dan vandaag.</p></div><div class=paragraph><p><a href=#cvs-tags>CVS labels</a> beschrijft de meest interessante taklabels. Als er in het instellingenbestand van CVSup een label wordt aangegeven, moet dat vooraf gegaan worden door <code>tag=</code> (<code>RELENG_8</code> zal <code>tag=RELENG_8</code> worden). Voor de Portscollectie is alleen <code>tag=.</code> relevant.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Labels dienen exact zo ingegeven te worden als ze staan beschreven. CVSup kan geen onderscheid maken tussen geldige en ongeldige labels. Als er een spelfout in een label wordt gemaakt, doet CVSup alsof er een geldig label is ingegeven dat aan geen enkel bestand refereert. Dan zal CVSup de bestaande broncode wissen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Bij het aangeven van een taklabel wordt meestal de laatste versie van de bestanden voor een bepaalde ontwikkellijn ontvangen. Om een oudere versie te ontvangen kan in het veld <code>date=</code> een datum opgegeven worden. In <a href="https://man.freebsd.org/cgi/man.cgi?query=cvsup&amp;sektion=1&amp;format=html">cvsup(1)</a> staat hoe dat werkt.</p></div><div class=paragraph><p>Om bijvoorbeeld FreeBSD-CURRENT te ontvangen dient het volgende aan het begin van <span class=filename>supfile</span> toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>*default tag=.</pre></div></div><div class=paragraph><p>Er ontstaat een belangrijk speciaal geval als er geen velden met <code>tag=</code> of <code>date=</code> worden aangegeven. In dat geval worden de eigenlijke RCS bestanden direct uit het CVS depot van de server ontvangen in plaats van dat een bepaalde versie wordt ontvangen. Ontwikkelaars geven in het algemeen de voorkeur aan deze optie. Door zelf een kopie van de broncode op hun systeem te hebben, krijgen ze de mogelijkheid om zelf door eerdere versies van bestanden te bladeren en de geschiedenis ervan te bekijken. Dit voordeel kost wel veel schijfruimte.</p></div></li><li><p><a id=cvsup-config-where></a>Waar moeten ze vandaan komen?</p><div class=paragraph><p>Het veld <code>host=</code> wordt gebruikt om <code>cvsup</code> aan te geven waar de updates vandaan moeten komen. Dat kan van elke <a href=#cvsup-mirrors>CVSup mirrorsite</a>, hoewel er wordt aangeraden een site die geografisch dichtbij ligt te kiezen. In dit voorbeeld wordt een fictieve FreeBSD distributiesite gebruikt, <code>cvsup99.FreeBSD.org</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>*default host=cvsup99.FreeBSD.org</pre></div></div><div class=paragraph><p>In een werkelijke situatie dient de hostnaam gewijzigd te worden in een host die echt bestaat voordat CVSup gaat draaien. Iedere keer dat <code>cvsup</code> wordt gestart, kan er een andere host op de commandoregel opgegeven worden met de optie <code>-h_hostname_</code>.</p></div></li><li><p><a id=cvsup-config-dest></a>Waar moeten ze komen te staan?</p><div class=paragraph><p>Het veld <code>prefix=</code> geeft <code>cvsup</code> aan waar de ontvangen bestanden terecht moeten komen. In dit voorbeeld worden de bestanden direct in de hoofd broncodestructuur <span class=filename>/usr/src</span> geplaatst. De map <span class=filename>src</span> is al impliciet in de gekozen collecties, vandaar dat het onderstaande de juiste instelling is:</p></div><div class="literalblock programlisting"><div class=content><pre>*default prefix=/usr</pre></div></div></li><li><p><a id=cvsup-config-status></a>Waar moet <code>cvsup</code> zijn statusbestanden bijhouden?</p><div class=paragraph><p>De CVSup client houdt statusbestanden bij in een map die "base" wordt genoemd. Die bestanden helpen CVSup efficiënter te werken door bij te houden welke updates al eerder zijn ontvangen. Hier wordt de standaard basemap gebruikt, <span class=filename>/var/db</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>*default base=/var/db</pre></div></div><div class=paragraph><p>De bovenstaande instelling wordt standaard gebruikt als die niet wordt aangegeven in de <span class=filename>supfile</span>, dus hij is eigenlijk niet nodig.</p></div><div class=paragraph><p>Als de basemap niet al bestaat, moet die gemaakt worden. De <code>cvsup</code> client weigert te draaien als de basemap niet bestaat.</p></div></li><li><p>Allerlei <span class=filename>supfile</span> instellingen:</p><div class=paragraph><p>Er is nog een regel die in een <span class=filename>supfile</span> moet staan:</p></div><div class="literalblock programlisting"><div class=content><pre>*default release=cvs delete use-rel-suffix compress</pre></div></div><div class=paragraph><p><code>release=cvs</code> geeft de server aan dat de informatie uit het FreeBSD hoofd CVS depot moet komen. Dat is eigenlijk altijd het geval, maar er zijn mogelijkheden die buiten het bereik van dit handboek vallen.</p></div><div class=paragraph><p><code>delete</code> geeft CVSup het recht om bestanden te verwijderen. Dit moet altijd aangegeven worden zodat CVSup de broncode altijd kan bijwerken. CVSup gaat voorzichtig om met het verwijderen van bestanden waar het verantwoordelijk voor is. Extra bestanden in de structuur worden met rust gelaten.</p></div><div class=paragraph><p><code>use-rel-suffix</code> is nogal geheimzinnig. Voor de nieuwsgierigen staat er meer over in <a href="https://man.freebsd.org/cgi/man.cgi?query=cvsup&amp;sektion=1&amp;format=html">cvsup(1)</a>. Anders kan het gewoon ingesteld worden zonder erover na te denken.</p></div><div class=paragraph><p><code>compress</code> schakelt het gebruikt van gzip compressie in voor het communicatiekanaal. Als de verbinding een E1 of sneller is, hoeft er geen compressie gebruikt te worden. Anders helpt het aanzienlijk.</p></div></li><li><p>Alles combinerend:</p><div class=paragraph><p>Hieronder staat de hele <span class=filename>supfile</span> uit het voorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>*default tag=.
*default host=cvsup99.FreeBSD.org
*default prefix=/usr
*default base=/var/db
*default release=cvs delete use-rel-suffix compress

src-all</pre></div></div></li></ul></div><div class=sect4><h5 id=cvsup-refuse-file>A.6.3.1. Het bestand <span class=filename>refuse</span><a class=anchor href=#cvsup-refuse-file></a></h5><div class=paragraph><p>Zoals hierboven al is aangegeven, gebruikt CVSup een <em>pull methode</em>. Dat betekent eigenlijk dat er een verbinding wordt gemaakt met de CVSup server en die zegt dan: "Dit kan er van mij gedownload worden…​", en dan antwoordt de client met: "Oké, ik wil dit en dat en zus en zo." Met de standaardinstellingen haalt de CVSup client alle bestanden die bij een collectie en het label horen dat in het bestand met de instellingen is opgegeven. Maar dat is niet altijd wenselijk, in het bijzonder als de <span class=filename>doc</span>, <span class=filename>ports</span> of <span class=filename>www</span> structuren worden gesynchroniseerd. De meeste mensen kunnen geen vier of vijf talen lezen en die hebben de taalspecifieke bestanden dus niet nodig. Als de Portscollectie met CVSup wordt opgehaald, is het mogelijk om iedere collectie apart aan te geven (bijvoorbeeld <em>ports-astrology</em>, <em>ports-biology</em>, enzovoort, in plaats van eenvoudigweg <em>ports-all</em>). Maar omdat de <span class=filename>doc</span> en <span class=filename>www</span> structuren geen taalspecifieke collecties hebben, moet er gebruik gemaakt worden van een van de vele mooie mogelijkheden van CVSup: het bestand <span class=filename>refuse</span>.</p></div><div class=paragraph><p>Het bestand <span class=filename>refuse</span> geeft CVSup in feite aan dat niet ieder bestand uit een collectie opgehaald moet worden. Het geeft dus aan dat de client bepaalde bestanden van de server moet <em>weigeren</em>. Het bestand <span class=filename>refuse</span> staat in (of kan gemaakt worden in) <span class=filename>base/sup/</span>. <em>base</em> staat ingesteld in <span class=filename>supfile</span>. De standaardlocatie voor <em>base</em> is <span class=filename>/var/db</span>. De standaardplaats voor <span class=filename>refuse</span> is dus <span class=filename>/var/db/sup/refuse</span>.</p></div><div class=paragraph><p>Het bestand <span class=filename>refuse</span> heeft een erg eenvoudige opmaak. Het bevat de namen van de bestanden die niet gedownload mogen worden. Als een gebruiker bijvoorbeeld geen andere talen spreekt dan Engels en Nederlands, maar de Nederlandse vertaling van de documentatie hoeft niet binnengehaald te worden, dan kan het volgende in het bestand <span class=filename>refuse</span> gezet worden:</p></div><div class="literalblock programlisting"><div class=content><pre>doc/bn_*
doc/da_*
doc/de_*
doc/el_*
doc/es_*
doc/fr_*
doc/hu_*
doc/it_*
doc/ja_*
doc/mn_*
doc/nl_*
doc/no_*
doc/pl_*
doc/pt_*
doc/ru_*
doc/sr_*
doc/tr_*
doc/zh_*</pre></div></div><div class=paragraph><p>Dit gaat zo door voor de andere talen. De volledige lijst staat in het <a href=http://www.FreeBSD.org/cgi/cvsweb.cgi/>FreeBSD CVS depot</a>.</p></div><div class=paragraph><p>Met deze handige eigenschap kunnen gebruikers met langzamere verbindingen of zij die per minuut voor hun Internetverbinding betalen waardevolle tijd besparen omdat er geen bestanden meer gedownload worden die nooit gebruikt worden. Meer informatie over <span class=filename>refuse</span> bestanden en andere leuke mogelijkheden van CVSup staat in de handleiding.</p></div></div></div><div class=sect3><h4 id=_cvsup_draaien>A.6.4. CVSup draaien<a class=anchor href=#_cvsup_draaien></a></h4><div class=paragraph><p>Nu kan het bijwerken beginnen. Het commando is best wel eenvoudig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cvsup supfile</span></code></pre></div></div><div class=paragraph><p>De <span class=filename>supfile</span> is de naam van het <span class=filename>supfile</span> bestand dat gebruikt moet worden. Aangenomen dat er X11 draait op een machine, toont <code>cvsup</code> een GUI venster met wat knoppen om de bekende acties uit te voeren. Het proces start na het klikken op de knop btn[go].</p></div><div class=paragraph><p>Omdat in dit voorbeeld de werkelijke structuur in <span class=filename>/usr/src</span> wordt bijgewerkt, moet het programma als <code>root</code> uitgevoerd worden, zodat <code>cvsup</code> de rechten heeft die het nodig heeft om de bestanden bij te werken. Het is voorstelbaar dat de benodigde rechten, het net gemaakte bestand met instellingen en het voor de eerste keer draaien van een programma zorgt voor wat onrust. Daarom is het mogelijk proef te draaien zonder dat er bestanden gewijzigd worden. Dat kan door ergens een lege map te maken en een extra argument mee te geven op de commandoregel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/tmp/dest</span>
<span class=c># cvsup supfile /var/tmp/dest</span></code></pre></div></div><div class=paragraph><p>De opgegeven map is de bestemming voor alle bestandsupdates. CVSup bekijkt wel de bestanden in <span class=filename>/usr/src</span>, maar wijzigt ze niet. Alle updates belanden in <span class=filename>/var/tmp/dest/usr/src</span>. CVSup werkt ook de statusbestanden niet bij als het op deze wijze wordt uitgevoerd. De nieuwe versies van de bestanden worden naar de aangegeven map geschreven. Als er maar leestoegang is tot <span class=filename>/usr/src</span>, hoeft een gebruiker zelfs geen <code>root</code> te zijn bij het uitvoeren van dit experiment.</p></div><div class=paragraph><p>Als er geen X11 draait of als het niet wenselijk is een GUI te gebruiken, dan kunnen daarvoor opties op de commandoregel meegegeven worden bij het draaien van <code>cvsup</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cvsup -g -L 2 supfile</span></code></pre></div></div><div class=paragraph><p>De optie <code>-g</code> geeft CVSup aan dat de GUI niet gebruikt hoeft te worden. Dit gebeurt automatisch als X11 niet draait, maar anders moet het aangegeven worden.</p></div><div class=paragraph><p>De optie <code>-L 2</code> geeft CVSup aan dat details getoond moeten worden over alle bestanden die bijgewerkt worden. Er zijn drie niveaus van uitvoerigheid, van <code>-L 0</code> tot <code>-L 2</code>. Standaard is het 0, wat betekent dat er geen enkel bericht wordt getoond, met uitzondering van foutmeldingen.</p></div><div class=paragraph><p>Er zijn nog veel andere opties beschikbaar. Met <code>cvsup -H</code> wordt een lijst met korte uitleg getoond. Beschrijvingen met meer details staan in de handleiding.</p></div><div class=paragraph><p>Als het bijwerken op de gewenste manier loopt, kan het regulier draaien van CVSup met <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> ingesteld worden. Natuurlijk hoort CVSup zonder GUI te draaien als het programma vanuit de <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> draait.</p></div></div><div class=sect3><h4 id=cvsup-collec>A.6.5. CVSup bestandscollecties<a class=anchor href=#cvsup-collec></a></h4><div class=paragraph><p>De via CVSup beschikbare bestandscollecties zijn hiërarchisch georganiseerd. Er zijn een paar grote collecties en die zijn opgedeeld in kleinere subcollecties. Het ontvangen van een collectie is hetzelfde als het ontvangen van alle subcollecties. De hiërarchische relatie tussen de collecties wordt hieronder aangegeven door het niveau van inspringen.</p></div><div class=paragraph><p>De meest gebruikte collecties zijn <code>src-all</code> en <code>ports-all</code>. De andere collecties worden door kleine groepen mensen gebruikt voor bijzondere doeleinden en sommige mirrorsites hebben ze niet allemaal.</p></div><div class=dlist><dl><dt class=hdlist1><code>cvs-all release=cvs</code></dt><dd><p>Het FreeBSD CVS hoofddepot, inclusief de cryptografische code.</p><div class=dlist><dl><dt class=hdlist1><code>distrib release=cvs</code></dt><dd><p>Bestanden die betrekking hebben op het verspreiden en spiegelen van FreeBSD.</p></dd><dt class=hdlist1><code>ports-all release=cvs</code></dt><dd><p>De FreeBSD Portscollectie.</p><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Als <code>ports-all</code> (het complete portssysteem) niet bijgewerkt hoeft te worden, maar enkele van de onderstaande subcollecties, dan moet <em>altijd</em> ook de <code>ports-base</code> subcollectie bijgewerkt worden! Als er iets wijzigt in de infrastructuur van de ports waar <code>ports-base</code> voor staat, is het vrijwel zeker dat die wijzigingen heel snel door "echte" ports gebruikt gaan worden. Dus als alleen de "echte" ports bijgewerkt worden en als die gebruik maken van nieuwe mogelijkheden, dan is de kans groot dat het bouwen daarvan foutloopt met een vage foutmelding. Het <em>eerste</em> dat gedaan moeten worden is ervoor zorgen dat de <code>ports-base</code> subcollectie is bijgewerkt.</p></div></td></tr></tbody></table></div></dd></dl></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Bij het zelf bouwen van een lokale kopie van <span class=filename>ports/INDEX</span><em>moet</em>`ports-all` geaccepteerd worden (de hele port structuur). Het bouwen van <span class=filename>ports/INDEX</span> met een gedeeltelijke structuur wordt niet ondersteund. Zie ook de <a href=https://docs.freebsd.org/en/books/faq/#MAKE-INDEX>FAQ</a>.</p></div></td></tr></tbody></table></div><div class=dlist><dl><dt class=hdlist1><code>ports-accessibility release=cvs</code></dt><dd><p>Software voor minder valide gebruikers.</p></dd><dt class=hdlist1><code>ports-arabic release=cvs</code></dt><dd><p>Ondersteuning voor de Arabische taal.</p></dd><dt class=hdlist1><code>ports-archivers release=cvs</code></dt><dd><p>Archiveringshulpmiddelen.</p></dd><dt class=hdlist1><code>ports-astro release=cvs</code></dt><dd><p>Astronomie ports.</p></dd><dt class=hdlist1><code>ports-audio release=cvs</code></dt><dd><p>Geluidsondersteuning.</p></dd><dt class=hdlist1><code>ports-base release=cvs</code></dt><dd><p>De infrastructuur van de Portscollectie. Bestanden uit de mappen <span class=filename>Mk/</span> en <span class=filename>Tools/</span> van <span class=filename>/usr/ports</span>.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Zie ook de <a href=#cvsup-collec-pbase-warn>belangrijke waarschuwing hierboven</a>: deze subcollectie dient <em>altijd</em> bijgewerkt te worden als er een onderdeel van de FreeBSD Portscollectie wordt bijgewerkt!</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1><code>ports-benchmarks release=cvs</code></dt><dd><p>Benchmarks.</p></dd><dt class=hdlist1><code>ports-biology release=cvs</code></dt><dd><p>Biologie.</p></dd><dt class=hdlist1><code>ports-cad release=cvs</code></dt><dd><p>Computer aided design programma’s.</p></dd><dt class=hdlist1><code>ports-chinese release=cvs</code></dt><dd><p>Ondersteuning voor de Chinese taal.</p></dd><dt class=hdlist1><code>ports-comms release=cvs</code></dt><dd><p>Communicatiesoftware.</p></dd><dt class=hdlist1><code>ports-converters release=cvs</code></dt><dd><p>Karaktercode omzetters.</p></dd><dt class=hdlist1><code>ports-databases release=cvs</code></dt><dd><p>Databases.</p></dd><dt class=hdlist1><code>ports-deskutils release=cvs</code></dt><dd><p>Dingen die op een bureaublad stonden voordat computers waren uitgevonden.</p></dd><dt class=hdlist1><code>ports-devel release=cvs</code></dt><dd><p>Ontwikkelhulpmiddelen.</p></dd><dt class=hdlist1><code>ports-dns release=cvs</code></dt><dd><p>DNS gerelateerde software.</p></dd><dt class=hdlist1><code>ports-editors release=cvs</code></dt><dd><p>Editors.</p></dd><dt class=hdlist1><code>ports-emulators release=cvs</code></dt><dd><p>Emulatoren voor besturingssystemen.</p></dd><dt class=hdlist1><code>ports-finance release=cvs</code></dt><dd><p>Monetaire, financiële en gerelateerde applicaties.</p></dd><dt class=hdlist1><code>ports-ftp release=cvs</code></dt><dd><p>FTP client en server programma’s.</p></dd><dt class=hdlist1><code>ports-games release=cvs</code></dt><dd><p>Spelletjes.</p></dd><dt class=hdlist1><code>ports-german release=cvs</code></dt><dd><p>Ondersteuning voor de Duitse taal.</p></dd><dt class=hdlist1><code>ports-graphics release=cvs</code></dt><dd><p>Grafische programma’s.</p></dd><dt class=hdlist1><code>ports-hebrew release=cvs</code></dt><dd><p>Ondersteuning voor de Hebreeuwse taal.</p></dd><dt class=hdlist1><code>ports-hungarian release=cvs</code></dt><dd><p>Ondersteuning voor de Hongaarse taal.</p></dd><dt class=hdlist1><code>ports-irc release=cvs</code></dt><dd><p>Internet Relay Chat hulpprogramma’s.</p></dd><dt class=hdlist1><code>ports-japanese release=cvs</code></dt><dd><p>Ondersteuning voor de Japanse taal.</p></dd><dt class=hdlist1><code>ports-java release=cvs</code></dt><dd><p>Java™ programma’s.</p></dd><dt class=hdlist1><code>ports-korean release=cvs</code></dt><dd><p>Ondersteuning voor de Koreaanse taal.</p></dd><dt class=hdlist1><code>ports-lang release=cvs</code></dt><dd><p>Programmeertalen.</p></dd><dt class=hdlist1><code>ports-mail release=cvs</code></dt><dd><p>Mailsoftware.</p></dd><dt class=hdlist1><code>ports-math release=cvs</code></dt><dd><p>Numerieke rekensoftware.</p></dd><dt class=hdlist1><code>ports-misc release=cvs</code></dt><dd><p>Verschillende programma’s.</p></dd><dt class=hdlist1><code>ports-multimedia release=cvs</code></dt><dd><p>Multimedia software.</p></dd><dt class=hdlist1><code>ports-net release=cvs</code></dt><dd><p>Netwerksoftware.</p></dd><dt class=hdlist1><code>ports-net-im release=cvs</code></dt><dd><p>Berichtenuitwisseling.</p></dd><dt class=hdlist1><code>ports-net-mgmt release=cvs</code></dt><dd><p>Netwerkbeheersoftware.</p></dd><dt class=hdlist1><code>ports-net-p2p release=cvs</code></dt><dd><p>Peer to Peer Netwerken</p></dd><dt class=hdlist1><code>ports-news release=cvs</code></dt><dd><p>USENET news software.</p></dd><dt class=hdlist1><code>ports-palm release=cvs</code></dt><dd><p>Softwareondersteuning voor Palm™ apparatuur.</p></dd><dt class=hdlist1><code>ports-polish release=cvs</code></dt><dd><p>Ondersteuning voor de Poolse taal.</p></dd><dt class=hdlist1><code>ports-ports-mgmt release=cvs</code></dt><dd><p>Programma’s om ports en pakketten te beheren.</p></dd><dt class=hdlist1><code>ports-portuguese release=cvs</code></dt><dd><p>Ondersteuning voor de Portugese taal.</p></dd><dt class=hdlist1><code>ports-print release=cvs</code></dt><dd><p>Printsoftware.</p></dd><dt class=hdlist1><code>ports-russian release=cvs</code></dt><dd><p>Ondersteuning voor de Russische taal.</p></dd><dt class=hdlist1><code>ports-science release=cvs</code></dt><dd><p>Wetenschappelijk.</p></dd><dt class=hdlist1><code>ports-security release=cvs</code></dt><dd><p>Beveiligingsprogramma’s.</p></dd><dt class=hdlist1><code>ports-shells release=cvs</code></dt><dd><p>Commandoregelshells.</p></dd><dt class=hdlist1><code>ports-sysutils release=cvs</code></dt><dd><p>Systeemprogramma’s.</p></dd><dt class=hdlist1><code>ports-textproc release=cvs</code></dt><dd><p>Tekstverwerkingsprogramma’s (zonder desktop publishing).</p></dd><dt class=hdlist1><code>ports-ukrainian release=cvs</code></dt><dd><p>Ondersteuning voor de Oekraïense taal.</p></dd><dt class=hdlist1><code>ports-vietnamese release=cvs</code></dt><dd><p>Ondersteuning voor de Viëtnamese taal.</p></dd><dt class=hdlist1><code>ports-www release=cvs</code></dt><dd><p>Software gerelateerd aan het Wereldwijde Web.</p></dd><dt class=hdlist1><code>ports-x11 release=cvs</code></dt><dd><p>Ports voor het X windowsysteem.</p></dd><dt class=hdlist1><code>ports-x11-clocks release=cvs</code></dt><dd><p>X11 klokken.</p></dd><dt class=hdlist1><code>ports-x11-drivers release=cvs</code></dt><dd><p>X11-stuurprogramma’s</p></dd><dt class=hdlist1><code>ports-x11-fm release=cvs</code></dt><dd><p>X11 bestandsbeheerders.</p></dd><dt class=hdlist1><code>ports-x11-fonts release=cvs</code></dt><dd><p>X11 lettertypen en lettertypeprogramma’s.</p></dd><dt class=hdlist1><code>ports-x11-toolkits release=cvs</code></dt><dd><p>X11 hulpprogramma’s.</p></dd><dt class=hdlist1><code>ports-x11-servers release=cvs</code></dt><dd><p>X11 servers.</p></dd><dt class=hdlist1><code>ports-x11-themes</code></dt><dd><p>X11 thema’s.</p></dd><dt class=hdlist1><code>ports-x11-wm release=cvs</code></dt><dd><p>X11 vensterbeheerprogramma’s.</p><div class=dlist><dl><dt class=hdlist1><code>projects-all release=cvs</code></dt><dd><p>Broncode’s voor de FreeBSD projecten repository.</p></dd><dt class=hdlist1><code>src-all release=cvs</code></dt><dd><p>De hoofdbroncode van FreeBSD, inclusief de cryptografische code.</p></dd></dl></div></dd><dt class=hdlist1><code>src-base release=cvs</code></dt><dd><p>Verschillende bestanden bovenin de <span class=filename>/usr/src</span> structuur.</p></dd><dt class=hdlist1><code>src-bin release=cvs</code></dt><dd><p>Gebruikersprogramma’s die wellicht nodig zijn in single-user modus (<span class=filename>/usr/src/bin</span>).</p></dd><dt class=hdlist1><code>src-cddl release=cvs</code></dt><dd><p>Programma’s en bibliotheken die uitgegeven zijn onder de CDDL licentie (<span class=filename>/usr/src/cddl</span>).</p></dd><dt class=hdlist1><code>src-contrib release=cvs</code></dt><dd><p>Programma’s en bibliotheken van buiten het FreeBSD project die vrijwel ongewijzigd gebruikt worden (<span class=filename>/usr/src/contrib</span>).</p></dd><dt class=hdlist1><code>src-crypto release=cvs</code></dt><dd><p>Cryptografische programma’s en bibliotheken van buiten het FreeBSD project, die vrijwel ongewijzigd worden gebruikt (<span class=filename>/usr/src/crypto</span>).</p></dd><dt class=hdlist1><code>src-eBones release=cvs</code></dt><dd><p>Kerberos en DES (<span class=filename>/usr/src/eBones</span>). Niet gebruikt in recente uitgaves van FreeBSD.</p></dd><dt class=hdlist1><code>src-etc release=cvs</code></dt><dd><p>Bestanden met systeeminstellingen (<span class=filename>/usr/src/etc</span>).</p></dd><dt class=hdlist1><code>src-games release=cvs</code></dt><dd><p>Spelletjes (<span class=filename>/usr/src/games</span>).</p></dd><dt class=hdlist1><code>src-gnu release=cvs</code></dt><dd><p>Programma’s die onder de GNU Public License vallen (<span class=filename>/usr/src/gnu</span>).</p></dd><dt class=hdlist1><code>src-include release=cvs</code></dt><dd><p>Headerbestanden (<span class=filename>/usr/src/include</span>).</p></dd><dt class=hdlist1><code>src-kerberos5 release=cvs</code></dt><dd><p>Kerberos5 beveiligingspakket (<span class=filename>/usr/src/kerberos5</span>).</p></dd><dt class=hdlist1><code>src-kerberosIV release=cvs</code></dt><dd><p>KerberosIV beveiligingspakket (<span class=filename>/usr/src/kerberosIV</span>).</p></dd><dt class=hdlist1><code>src-lib release=cvs</code></dt><dd><p>Bibliotheken (<span class=filename>/usr/src/lib</span>).</p></dd><dt class=hdlist1><code>src-libexec release=cvs</code></dt><dd><p>Systeemprogramma’s die meestal door andere programma’s worden uitgevoerd (<span class=filename>/usr/src/libexec</span>).</p></dd><dt class=hdlist1><code>src-release release=cvs</code></dt><dd><p>Bestanden die nodig zijn voor het maken van een FreeBSD release (<span class=filename>/usr/src/release</span>).</p></dd><dt class=hdlist1><code>src-release release=cvs</code></dt><dd><p>Statisch gelinkte programma’s voor nood onderhoud, zie <a href="https://man.freebsd.org/cgi/man.cgi?query=rescue&amp;sektion=8&amp;format=html">rescue(8)</a> (<span class=filename>/usr/src/rescue</span>).</p></dd><dt class=hdlist1><code>src-sbin release=cvs</code></dt><dd><p>Systeemprogramma’s voor single-user modus (<span class=filename>/usr/src/sbin</span>).</p></dd><dt class=hdlist1><code>src-secure release=cvs</code></dt><dd><p>Cryptografische bibliotheken en commando’s (<span class=filename>/usr/src/secure</span>).</p></dd><dt class=hdlist1><code>src-share release=cvs</code></dt><dd><p>Bestanden die tussen meerdere systemen gedeeld kunnen worden (<span class=filename>/usr/src/share</span>).</p></dd><dt class=hdlist1><code>src-sys release=cvs</code></dt><dd><p>De kernel (<span class=filename>/usr/src/sys</span>).</p></dd><dt class=hdlist1><code>src-sys-crypto release=cvs</code></dt><dd><p>Cryptografische kernelcode (<span class=filename>/usr/src/sys/crypto</span>).</p></dd><dt class=hdlist1><code>src-tools release=cvs</code></dt><dd><p>Verschillende hulpprogramma’s voor het onderhoud van FreeBSD (<span class=filename>/usr/src/tools</span>).</p></dd><dt class=hdlist1><code>src-usrbin release=cvs</code></dt><dd><p>Gebruikersprogramma’s (<span class=filename>/usr/src/usr.bin</span>).</p></dd><dt class=hdlist1><code>src-usrsbin release=cvs</code></dt><dd><p>Systeemprogramma’s (<span class=filename>/usr/src/usr.sbin</span>).</p></dd></dl></div></dd><dt class=hdlist1><code>distrib release=self</code></dt><dd><p>De instellingenbestanden van de CVSup server zelf. Gebruikt door de CVSup mirrorsites.</p></dd><dt class=hdlist1><code>gnats release=current</code></dt><dd><p>De GNATS bug-tracking database.</p></dd><dt class=hdlist1><code>mail-archive release=current</code></dt><dd><p>FreeBSD mailinglijstarchief.</p></dd><dt class=hdlist1><code>www release=current</code></dt><dd><p>De voorbewerkte FreeBSD websitebestanden (niet de broncode). Gebruikt door WWW mirrorsites.</p></dd></dl></div></div><div class=sect3><h4 id=_voor_meer_informatie>A.6.6. Voor meer informatie<a class=anchor href=#_voor_meer_informatie></a></h4><div class=paragraph><p>De CVSup FAQ en andere informatie over CVSup is te vinden op <a href=http://www.cvsup.org/>De CVSup Homepage</a>.</p></div><div class=paragraph><p>De meeste FreeBSD-gerelateerde discussie over CVSup vindt plaats op de <a href=https://lists.FreeBSD.org/subscription/freebsd-hackers>FreeBSD technische discussie mailinglijst</a>. Daar worden nieuwe versies van de software aangekondigd, net als op de <a href=https://lists.FreeBSD.org/subscription/freebsd-announce>FreeBSD aankondigingen mailinglijst</a>.</p></div><div class=paragraph><p>Voor vragen en foutrapporten moet een kijkje genomen worden op <a href=http://www.cvsup.org/faq.html#bugreports>de CVSup FAQ</a></p></div></div><div class=sect3><h4 id=cvsup-mirrors>A.6.7. CVSup sites<a class=anchor href=#cvsup-mirrors></a></h4><div class=paragraph><p><a href=#cvsup>CVSup</a> servers voor FreeBSD draaien op de onderstaande sites.</p></div></div></div><div class=sect2><h3 id=cvs-tags>A.7. CVS labels<a class=anchor href=#cvs-tags></a></h3><div class=paragraph><p>Bij het ophalen of bijwerken van broncode met cvs of CVSup moet een revisielabel meegegeven worden. Een revisielabel refereert aan een specifieke lijn in de FreeBSD ontwikkeling of aan een specifiek moment in de tijd. Het eerste type heet "taklabel" (branch tag) en het tweede type heet "releaselabel" (release tag).</p></div><div class=sect3><h4 id=_taklabels>A.7.1. Taklabels<a class=anchor href=#_taklabels></a></h4><div class=paragraph><p>Deze zijn, met uitzondering van <code>HEAD</code> (dat altijd een geldig label is), alleen van toepassing op de <span class=filename>src/</span> structuur. De <span class=filename>ports/</span>, <span class=filename>doc/</span> en <span class=filename>www/</span> structuren kennen geen takken.</p></div><div class=dlist><dl><dt class=hdlist1>HEAD</dt><dd><p>Symbolische naam voor de hoofdlijn van FreeBSD-CURRENT. Ook de standaard als geen revisie is aangegeven.</p><div class=paragraph><p>In CVSup wordt dit label aangegeven met een <code>.</code> (dat is dus geen interpunctie, maar een echt <code>.</code> karakter).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In CVS is dit de standaard als er geen revisielabel is aangegeven. Het is meestal <em>geen</em> goed idee om een checkout of update van CURRENT broncode op een STABLE machine te doen, tenzij dat expliciet de bedoeling is.</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1>RELENG_9</dt><dd><p>De ontwikkellijn voor FreeBSD-9.X, ook bekend als FreeBSD 9-STABLE.</p></dd><dt class=hdlist1>RELENG_9_0</dt><dd><p>De uitgavetak voor FreeBSD-9.0, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_8</dt><dd><p>De ontwikkellijn voor FreeBSD-8.X, ook bekend als FreeBSD 8-STABLE.</p></dd><dt class=hdlist1>RELENG_8_3</dt><dd><p>De uitgavetak voor FreeBSD-8.3, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_8_2</dt><dd><p>De uitgavetak voor FreeBSD-8.2, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_8_1</dt><dd><p>De uitgavetak voor FreeBSD-8.1, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_8_0</dt><dd><p>De uitgavetak voor FreeBSD-8.0, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_7</dt><dd><p>De ontwikkellijn voor FreeBSD-7.X, ook bekend als FreeBSD 7-STABLE.</p></dd><dt class=hdlist1>RELENG_7_4</dt><dd><p>De uitgavetak voor FreeBSD-7.3, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_7_3</dt><dd><p>De uitgavetak voor FreeBSD-7.3, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_7_2</dt><dd><p>De uitgavetak voor FreeBSD-7.2, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_7_1</dt><dd><p>De uitgavetak voor FreeBSD-7.1, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_7_0</dt><dd><p>De uitgavetak voor FreeBSD-7.0, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_6</dt><dd><p>De ontwikkellijn voor FreeBSD-6.X, ook bekend als FreeBSD 6-STABLE.</p></dd><dt class=hdlist1>RELENG_6_4</dt><dd><p>De uitgavetak voor FreeBSD-6.4, alleen gebruikt voor beveiligingsadviezen en andere kritieke reparaties.</p></dd><dt class=hdlist1>RELENG_6_3</dt><dd><p>De uitgavetak voor FreeBSD-6.3, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_6_2</dt><dd><p>De releasetak voor FreeBSD-6.2, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_6_1</dt><dd><p>De releasetak voor FreeBSD-6.1, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_6_0</dt><dd><p>De releasetak voor FreeBSD-6.0, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_5</dt><dd><p>De ontwikkellijn voor FreeBSD-5.X, ook bekend als FreeBSD 5-STABLE.</p></dd><dt class=hdlist1>RELENG_5_5</dt><dd><p>De releasetak voor FreeBSD-5.5, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_5_4</dt><dd><p>De releasetak voor FreeBSD-5.4, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_5_3</dt><dd><p>De releasetak voor FreeBSD-5.3, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_5_2</dt><dd><p>De releasetak voor FreeBSD-5.2 en FreeBSD-5.2.1, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_5_1</dt><dd><p>De releasetak voor FreeBSD-5.1, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_5_0</dt><dd><p>De releasetak voor FreeBSD-5.0, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_4</dt><dd><p>De ontwikkellijn voor FreeBSD-4.X, ook bekend als FreeBSD 4-STABLE.</p></dd><dt class=hdlist1>RELENG_4_11</dt><dd><p>De releasetak voor FreeBSD-4.11, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_4_10</dt><dd><p>De releasetak voor FreeBSD-4.10, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_4_9</dt><dd><p>De releasetak voor FreeBSD-4.9, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_4_8</dt><dd><p>De releasetak voor FreeBSD-4.8, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_4_7</dt><dd><p>De releasetak voor FreeBSD-4.7, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_4_6</dt><dd><p>De releasetak voor FreeBSD-4.6 en FreeBSD-4.6.2, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_4_5</dt><dd><p>De releasetak voor FreeBSD-4.5, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_4_4</dt><dd><p>De releasetak voor FreeBSD-4.4, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_4_3</dt><dd><p>De releasetak voor FreeBSD-4.3, alleen gebruikt voor beveiligingswaarschuwingen en andere kritische aanpassingen.</p></dd><dt class=hdlist1>RELENG_3</dt><dd><p>De ontwikkellijn voor FreeBSD-3.X, ook bekend als 3.X-STABLE.</p></dd><dt class=hdlist1>RELENG_2_2</dt><dd><p>De ontwikkellijn voor FreeBSD-2.2.X, ook bekend als 2.2-STABLE. Deze tak is sterk verouderd.</p></dd></dl></div></div><div class=sect3><h4 id=_releaselabels>A.7.2. Releaselabels<a class=anchor href=#_releaselabels></a></h4><div class=paragraph><p>Deze labels refereren aan een specifiek moment in de tijd waarop een versie van FreeBSD is uitgegeven. Het proces om tot een release te komen is gedetailleerder beschreven in de <a href=https://www.FreeBSD.org/releng/>Release Engineering Informatie</a> en <a href=https://docs.freebsd.org/en/articles/releng/#release-proc/>Release Proces</a> documenten. De <span class=filename>src</span> structuur gebruikt labelnamen die beginnen met <code>RELENG_</code> labels. De <span class=filename>ports</span> en <span class=filename>doc</span> structuren gebruiken labels waarvan de naam begint met het label <code>RELEASE</code>. De <span class=filename>www</span> tenslotte, is niet gemarkeerd met een bijzondere naam bij uitgaven.</p></div><div class=dlist><dl><dt class=hdlist1>RELENG_9_0_0_RELEASE</dt><dd><p>FreeBSD 9.0</p></dd><dt class=hdlist1>RELENG_8_3_0_RELEASE</dt><dd><p>FreeBSD 8.3</p></dd><dt class=hdlist1>RELENG_8_2_0_RELEASE</dt><dd><p>FreeBSD 8.2</p></dd><dt class=hdlist1>RELENG_8_1_0_RELEASE</dt><dd><p>FreeBSD 8.1</p></dd><dt class=hdlist1>RELENG_8_0_0_RELEASE</dt><dd><p>FreeBSD 8.0</p></dd><dt class=hdlist1>RELENG_7_4_0_RELEASE</dt><dd><p>FreeBSD 7.4</p></dd><dt class=hdlist1>RELENG_7_3_0_RELEASE</dt><dd><p>FreeBSD 7.3</p></dd><dt class=hdlist1>RELENG_7_2_0_RELEASE</dt><dd><p>FreeBSD 7.2</p></dd><dt class=hdlist1>RELENG_7_1_0_RELEASE</dt><dd><p>FreeBSD 7.1</p></dd><dt class=hdlist1>RELENG_7_0_0_RELEASE</dt><dd><p>FreeBSD 7.0</p></dd><dt class=hdlist1>RELENG_6_4_0_RELEASE</dt><dd><p>FreeBSD 6.4</p></dd><dt class=hdlist1>RELENG_6_3_0_RELEASE</dt><dd><p>FreeBSD 6.3</p></dd><dt class=hdlist1>RELENG_6_2_0_RELEASE</dt><dd><p>FreeBSD 6.2</p></dd><dt class=hdlist1>RELENG_6_1_0_RELEASE</dt><dd><p>FreeBSD 6.1</p></dd><dt class=hdlist1>RELENG_6_0_0_RELEASE</dt><dd><p>FreeBSD 6.0</p></dd><dt class=hdlist1>RELENG_5_5_0_RELEASE</dt><dd><p>FreeBSD 5.5</p></dd><dt class=hdlist1>RELENG_5_4_0_RELEASE</dt><dd><p>FreeBSD 5.4</p></dd><dt class=hdlist1>RELENG_4_11_0_RELEASE</dt><dd><p>FreeBSD 4.11</p></dd><dt class=hdlist1>RELENG_5_3_0_RELEASE</dt><dd><p>FreeBSD 5.3</p></dd><dt class=hdlist1>RELENG_4_10_0_RELEASE</dt><dd><p>FreeBSD 4.10</p></dd><dt class=hdlist1>RELENG_5_2_1_RELEASE</dt><dd><p>FreeBSD 5.2.1</p></dd><dt class=hdlist1>RELENG_5_2_0_RELEASE</dt><dd><p>FreeBSD 5.2</p></dd><dt class=hdlist1>RELENG_4_9_0_RELEASE</dt><dd><p>FreeBSD 4.9</p></dd><dt class=hdlist1>RELENG_5_1_0_RELEASE</dt><dd><p>FreeBSD 5.1</p></dd><dt class=hdlist1>RELENG_4_8_0_RELEASE</dt><dd><p>FreeBSD 4.8</p></dd><dt class=hdlist1>RELENG_5_0_0_RELEASE</dt><dd><p>FreeBSD 5.0</p></dd><dt class=hdlist1>RELENG_4_7_0_RELEASE</dt><dd><p>FreeBSD 4.7</p></dd><dt class=hdlist1>RELENG_4_6_2_RELEASE</dt><dd><p>FreeBSD 4.6.2</p></dd><dt class=hdlist1>RELENG_4_6_1_RELEASE</dt><dd><p>FreeBSD 4.6.1</p></dd><dt class=hdlist1>RELENG_4_6_0_RELEASE</dt><dd><p>FreeBSD 4.6</p></dd><dt class=hdlist1>RELENG_4_5_0_RELEASE</dt><dd><p>FreeBSD 4.5</p></dd><dt class=hdlist1>RELENG_4_4_0_RELEASE</dt><dd><p>FreeBSD 4.4</p></dd><dt class=hdlist1>RELENG_4_3_0_RELEASE</dt><dd><p>FreeBSD 4.3</p></dd><dt class=hdlist1>RELENG_4_2_0_RELEASE</dt><dd><p>FreeBSD 4.2</p></dd><dt class=hdlist1>RELENG_4_1_1_RELEASE</dt><dd><p>FreeBSD 4.1.1</p></dd><dt class=hdlist1>RELENG_4_1_0_RELEASE</dt><dd><p>FreeBSD 4.1</p></dd><dt class=hdlist1>RELENG_4_0_0_RELEASE</dt><dd><p>FreeBSD 4.0</p></dd><dt class=hdlist1>RELENG_3_5_0_RELEASE</dt><dd><p>FreeBSD-3.5</p></dd><dt class=hdlist1>RELENG_3_4_0_RELEASE</dt><dd><p>FreeBSD-3.4</p></dd><dt class=hdlist1>RELENG_3_3_0_RELEASE</dt><dd><p>FreeBSD-3.3</p></dd><dt class=hdlist1>RELENG_3_2_0_RELEASE</dt><dd><p>FreeBSD-3.2</p></dd><dt class=hdlist1>RELENG_3_1_0_RELEASE</dt><dd><p>FreeBSD-3.1</p></dd><dt class=hdlist1>RELENG_3_0_0_RELEASE</dt><dd><p>FreeBSD-3.0</p></dd><dt class=hdlist1>RELENG_2_2_8_RELEASE</dt><dd><p>FreeBSD-2.2.8</p></dd><dt class=hdlist1>RELENG_2_2_7_RELEASE</dt><dd><p>FreeBSD-2.2.7</p></dd><dt class=hdlist1>RELENG_2_2_6_RELEASE</dt><dd><p>FreeBSD-2.2.6</p></dd><dt class=hdlist1>RELENG_2_2_5_RELEASE</dt><dd><p>FreeBSD-2.2.5</p></dd><dt class=hdlist1>RELENG_2_2_2_RELEASE</dt><dd><p>FreeBSD-2.2.2</p></dd><dt class=hdlist1>RELENG_2_2_1_RELEASE</dt><dd><p>FreeBSD-2.2.1</p></dd><dt class=hdlist1>RELENG_2_2_0_RELEASE</dt><dd><p>FreeBSD-2.2.0</p></dd></dl></div></div></div><div class=sect2><h3 id=mirrors-rsync>A.8. rsync sites<a class=anchor href=#mirrors-rsync></a></h3><div class=paragraph><p>De volgende sites bieden FreeBSD aan via het protocol rsync. Het programma rsync werkt vrijwel hetzelfde als <a href="https://man.freebsd.org/cgi/man.cgi?query=rcp&amp;sektion=1&amp;format=html">rcp(1)</a>, maar kent meer mogelijkheden en gebruikt het rsync remote-update protocol, dat alleen verschillen tussen twee groepen bestanden overbrengt, waardoor het synchroniseren via een netwerk drastisch wordt versneld. Dit kan het beste gedaan worden als er een mirrorsite voor de FreeBSD FTP server of het FreeBSD CVS depot draait. De rsync suite is voor veel besturingssystemen beschikbaar. Voor FreeBSD kan het pakket of de port uit <a class=package href=https://cgit.freebsd.org/ports/tree/net/rsync/>net/rsync</a> geïnstalleerd worden.</p></div><div class=dlist><dl><dt class=hdlist1>Tsjechië</dt><dd><p>rsync://ftp.cz.FreeBSD.org/</p><div class=paragraph><p>Beschikbare collecties:</p></div><div class=ulist><ul><li><p>ftp: een gedeeltelijke mirror van de FreeBSD FTP server.</p></li><li><p>FreeBSD: een volledige mirror van de FreeBSD FTP server.</p></li></ul></div></dd><dt class=hdlist1>Nederland</dt><dd><p>rsync://ftp.nl.FreeBSD.org/</p><div class=paragraph><p>Beschikbare collecties:</p></div><div class=ulist><ul><li><p>FreeBSD: een volledige mirror van de FreeBSD FTP server.</p></li></ul></div></dd><dt class=hdlist1>Rusland</dt><dd><p>rsync://ftp.mtu.ru/</p><div class=paragraph><p>Beschikbare collecties:</p></div><div class=ulist><ul><li><p>FreeBSD: een volledige spiegel van de FTP-server van FreeBSD.</p></li><li><p>FreeBSD-gnats: De GNATS bug-tracking database.</p></li><li><p>FreeBSD-archief: spiegel van de FreeBSD Archive FTP-server.</p></li></ul></div></dd><dt class=hdlist1>Zweden</dt><dd><p>rsync://ftp4.se.freebsd.org/</p><div class=paragraph><p>Beschikbare verzamelingen:</p></div><div class=ulist><ul><li><p>FreeBSD: een volledige spiegel van de FTP-server van FreeBSD.</p></li></ul></div></dd><dt class=hdlist1>Taiwan</dt><dd><p>rsync://ftp.tw.FreeBSD.org/</p><div class=paragraph><p>rsync://ftp2.tw.FreeBSD.org/</p></div><div class=paragraph><p>rsync://ftp6.tw.FreeBSD.org/</p></div><div class=paragraph><p>Beschikbare collecties:</p></div><div class=ulist><ul><li><p>FreeBSD: een volledige mirror van de FreeBSD FTP server.</p></li></ul></div></dd><dt class=hdlist1>Verenigd Koninkrijk</dt><dd><p>rsync://rsync.mirrorservice.org/</p><div class=paragraph><p>Beschikbare collecties:</p></div><div class=ulist><ul><li><p>sites/ftp.freebsd.org: een volledige mirror van de FreeBSD FTP server.</p></li></ul></div></dd><dt class=hdlist1>Verenigde Staten van Amerika</dt><dd><p>rsync://ftp-master.FreeBSD.org/</p><div class=paragraph><p>Deze server mag alleen gebruikt worden door FreeBSD primaire mirrorsites.</p></div><div class=paragraph><p>Beschikbare collecties:</p></div><div class=ulist><ul><li><p>FreeBSD: het masterarchief van de FreeBSD FTP server.</p></li><li><p>acl: de FreeBSD master ACL lijst.</p><div class=paragraph><p>rsync://ftp13.FreeBSD.org/</p></div><div class=paragraph><p>Beschikbare collecties:</p></div></li><li><p>FreeBSD: een volledige mirror van de FreeBSD FTP server.</p></li></ul></div></dd></dl></div></div></div></div><div class=sect1><h2 id=bibliography>Bijlage B: Bibliography<a class=anchor href=#bibliography></a></h2><div class=sectionbody><div class=paragraph><p>Hoewel de handleiding de juiste referentie is voor individuele stukken van het FreeBSD besturingssysteem, staan ze erom bekend niet te illustreren hoe de stukken in elkaar vallen om het hele besturingssysteem soepel te laten draaien. Daarom wordt er gesteld dat er geen vervanger is voor een goed boek over UNIX® systeembeheer en een goede gebruikershandleiding.</p></div><div class=sect2><h3 id=bibliography-freebsd>B.1. Boeken & tijdschriften over FreeBSD<a class=anchor href=#bibliography-freebsd></a></h3><div class=paragraph><p><em>Internationale boeken & Tijdschriften:</em></p></div><div class=ulist><ul><li><p><a href=http://jdli.tw.FreeBSD.org/publication/book/freebsd2/index.htm>Using FreeBSD</a> (Traditioneel Chinees), gepubliceerd door <a href=http://www.drmaster.com.tw/>Drmaster</a>, 1997. ISBN 9-578-39435-7.</p></li><li><p>FreeBSD Unleashed (Versimpelde Chinese vertaling), gepubliceerd door <a href=http://www.hzbook.com/>China Machine Press</a>. ISBN 7-111-10201-0.</p></li><li><p>FreeBSD From Scratch Second Edition (Versimpeld Chinees), gepubliceerd door China Machine Press. ISBN 7-111-10286-X.</p></li><li><p>FreeBSD Handbook Second Edition (Versimpeld Chinese vertaling), gepubliceerd door <a href=http://www.ptpress.com.cn/>Posts & Telecom Press</a>. ISBN 7-115-10541-3.</p></li><li><p>FreeBSD & Windows (Versimpeld Chinees), gepubliceerd door gepubliceerd door <a href=http://www.tdpress.com/>China Railway Publishing House</a>. ISBN 7-113-03845-X</p></li><li><p>FreeBSD Internet Services HOWTO (Versimpeld Chinees), gepubliceerd door China Railway Publishing House. ISBN 7-113-03423-3</p></li><li><p>FreeBSD (Japans), gepubliceerd door CUTT. ISBN 4-906391-22-2 C3055 P2400E.</p></li><li><p><a href="http://www.shoeisha.com/book/Detail.asp?bid=650">Complete Introduction to FreeBSD</a> (Japans), gepubliceerd door <a href=http://www.shoeisha.co.jp/>Shoeisha Co., Ltd</a>. ISBN 4-88135-473-6 P3600E.</p></li><li><p><a href=http://www.ascii.co.jp/pb/book1/shinkan/detail/1322785.html>Personal UNIX Starter Kit FreeBSD</a> (Japans), gepubliceerd door <a href=http://www.ascii.co.jp/>ASCII</a>. ISBN 4-7561-1733-3 P3000E.</p></li><li><p>FreeBSD Handbook (Japanse vertaling), gepubliceerd door <a href=http://www.ascii.co.jp/>ASCII</a>. ISBN 4-7561-1580-2 P3800E.</p></li><li><p>FreeBSD mit Methode (Duits), gepubliceerd door <a href=http://www.cul.de>Computer und Literatur Verlag</a>/Vertrieb Hanser, 1998. ISBN 3-932311-31-0.</p></li><li><p><a href=http://www.mitp.de/vmi/mitp/detail/pWert/1343/>FreeBSD de Luxe</a> (Duits), gepubliceerd door <a href=http://www.mitp.de>Verlag Modere Industrie</a>, 2003. ISBN 3-8266-1343-0.</p></li><li><p><a href=http://www.pc.mycom.co.jp/FreeBSD/install-manual.html>FreeBSD Install and Utilization Manual</a> (Japans), gepubliceerd door <a href=http://www.pc.mycom.co.jp/>Mainichi Communications Inc.</a>.</p></li><li><p>Onno W Purbo, Dodi Maryanto, Syahrial Hubbany, Widjil Widodo <em><a href=http://maxwell.itb.ac.id/>Building Internet Server with FreeBSD</a></em> (Indonesisch), published by <a href=http://www.elexmedia.co.id/>Elex Media Komputindo</a>.</p></li><li><p>Absolute BSD: The Ultimate Guide to FreeBSD (Traditioneel Chinese vertaling), gepubliceerd door <a href=http://www.grandtech.com.tw/>GrandTech Press</a>, 2003. ISBN 986-7944-92-5.</p></li><li><p><a href=http://www.twbsd.org/cht/book/>The FreeBSD 6.0 Book</a> (Traditioneel Chinees), gepubliceerd door Drmaster, 2006. ISBN 9-575-27878-X.</p></li></ul></div><div class=paragraph><p><em>Engelstalige boeken & Tijdschriften:</em></p></div><div class=ulist><ul><li><p><a href=http://www.absoluteFreeBSD.com/>Absolute FreeBSD, 2e editie: The Complete Guide to FreeBSD</a>, gepubliceerd door <a href=http://www.nostarch.com/>No Starch Press</a>, 2007. ISBN: 978-1-59327-151-0</p></li><li><p><a href=http://www.freebsdmall.com/cgi-bin/fm/bsdcomp>The Complete FreeBSD</a>, gepubliceerd door <a href=http://www.oreilly.com/>O’Reilly</a>, 2003. ISBN: 0596005164</p></li><li><p><a href=http://www.freebsd-corp-net-guide.com/>The FreeBSD Corporate Networker’s Guide</a>, gepubliceerd door <a href=http://www.awl.com/aw/>Addison-Wesley</a>, 2000. ISBN: 0201704811</p></li><li><p><a href=http://andrsn.stanford.edu/FreeBSD/introbook/>FreeBSD: An Open-Source Operating System for Your Personal Computer</a>, gepubliceerd door The Bit Tree Press, 2001. ISBN: 0971204500</p></li><li><p>Teach Yourself FreeBSD in 24 Hours, gepubliceerd door <a href=http://www.samspublishing.com/>Sams</a>, 2002. ISBN: 0672324245</p></li><li><p>FreeBSD unleashed, gepubliceerd door <a href=http://www.samspublishing.com/>Sams</a>, 2006. ISBN: 0672328755</p></li><li><p>FreeBSD: The Complete Reference, gepubliceerd door <a href=http://books.mcgraw-hill.com>McGrawHill</a>, 2003. ISBN: 0072224096</p></li><li><p><a href=http://www.bsdmag.org>BSD Magazine</a>, gepubliceerd door Software Press Sp. z.o.o. SK. ISSN 1898-9144</p></li></ul></div></div><div class=sect2><h3 id=bibliography-userguides>B.2. Voor gebruikers<a class=anchor href=#bibliography-userguides></a></h3><div class=ulist><ul><li><p>Ohio State University heeft een <a href=http://www.cs.duke.edu/csl/docs/unix_course/>UNIX Introductiecursus</a> geschreven welke online in HTML en in PostScript® formaat beschikbaar is.</p><div class=paragraph><p>Een Italiaanse <a href=https://www.FreeBSD.org/doc/it_IT.ISO8859-15/books/unix-introduction/index.html>vertaling</a> van dit document is beschikbaar als onderdeel van het FreeBSD Italian Documentation Project.</p></div></li><li><p><a href=http://www.jp.FreeBSD.org/>Jpman Project, Japan FreeBSD Users Group</a>. <a href=http://www.pc.mycom.co.jp/FreeBSD/urm.html>FreeBSD User’s Reference Manual</a> (Japanse vertaling). <a href=http://www.pc.mycom.co.jp/>Mainichi Communications Inc.</a>, 1998. ISBN4-8399-0088-4 P3800E.</p></li><li><p><a href=http://www.ed.ac.uk/>Edinburgh University</a> heeft een <a href=http://unixhelp.ed.ac.uk/>Online Guide</a> geschreven voor nieuwkomers in de UNIX® omgeving.</p></li></ul></div></div><div class=sect2><h3 id=bibliography-adminguides>B.3. Voor beheerders<a class=anchor href=#bibliography-adminguides></a></h3><div class=ulist><ul><li><p><a href=http://www.jp.FreeBSD.org/>Jpman Project, Japan FreeBSD Users Group</a>. <a href=http://www.pc.mycom.co.jp/FreeBSD/sam.html>FreeBSD System Administrator’s Manual</a> (Japanse vertaling). <a href=http://www.pc.mycom.co.jp/>Mainichi Communications Inc.</a>, 1998. ISBN4-8399-0109-0 P3300E.</p></li><li><p>Dreyfus, Emmanuel. <a href=http://www.eyrolles.com/Informatique/Livre/9782212114638/>Cahiers de l’Admin: BSD</a> 2nd Ed. (Frans), Eyrolles, 2004. ISBN 2-212-11463-X</p></li></ul></div></div><div class=sect2><h3 id=bibliography-programmers>B.4. Voor programmeurs<a class=anchor href=#bibliography-programmers></a></h3><div class=ulist><ul><li><p>Computer Systems Research Group, UC Berkeley. <em>4.4BSD Programmer’s Reference Manual</em>. O’Reilly & Associates, Inc., 1994. ISBN 1-56592-078-3</p></li><li><p>Computer Systems Research Group, UC Berkeley. <em>4.4BSD Programmer’s Supplementary Documents</em>. O’Reilly & Associates, Inc., 1994. ISBN 1-56592-079-1</p></li><li><p>Harbison, Samuel P. and Steele, Guy L. Jr. <em>C: A Reference Manual</em>. 4th ed. Prentice Hall, 1995. ISBN 0-13-326224-3</p></li><li><p>Kernighan, Brian and Dennis M. Ritchie. <em>The C Programming Language.</em>. 2nd Ed. PTR Prentice Hall, 1988. ISBN 0-13-110362-8</p></li><li><p>Lehey, Greg. <em>Porting UNIX Software</em>. O’Reilly & Associates, Inc., 1995. ISBN 1-56592-126-7</p></li><li><p>Plauger, P. J. <em>The Standard C Library</em>. Prentice Hall, 1992. ISBN 0-13-131509-9</p></li><li><p>Spinellis, Diomidis. <a href=http://www.spinellis.gr/codereading/>Code Reading: The Open Source Perspective</a>. Addison-Wesley, 2003. ISBN 0-201-79940-5</p></li><li><p>Marshall Kirk McKusick, George V. Neville-Neil. <em>The Design and Implementation of the FreeBSD UNIX Operating System</em>. Boston, Mass. : Addison-Wesley, 2004. ISBN 0-201-70245-2</p></li><li><p>Spinellis, Diomidis. <a href=http://www.spinellis.gr/codequality/>Code Quality: The Open Source Perspective</a>. Addison-Wesley, 2006. ISBN 0-321-16607-8</p></li><li><p>Stevens, W. Richard. <em>Advanced Programming in the UNIX Environment</em>. Reading, Mass. : Addison-Wesley, 2005. ISBN 0-201-43307-9</p></li><li><p>Stevens, W. Richard. <em>UNIX Network Programming</em>. 2nd Ed, PTR Prentice Hall, 1998. ISBN 0-13-490012-X</p></li></ul></div></div><div class=sect2><h3 id=bibliography-osinternals>B.5. Dieper in het besturingssysteem<a class=anchor href=#bibliography-osinternals></a></h3><div class=ulist><ul><li><p>Andleigh, Prabhat K. <em>UNIX System Architecture</em>. Prentice-Hall, Inc., 1990. ISBN 0-13-949843-5</p></li><li><p>Jolitz, William. "Porting UNIX to the 386". <em>Dr. Dobb’s Journal</em>. January 1991-July 1992.</p></li><li><p>Leffler, Samuel J., Marshall Kirk McKusick, Michael J Karels en John Quarterman <em>The Design and Implementation of the 4.3BSD UNIX Operating System</em>. Reading, Mass. : Addison-Wesley, 1989. ISBN 0-201-06196-1</p></li><li><p>Leffler, Samuel J., Marshall Kirk McKusick, <em>The Design and Implementation of the 4.3BSD UNIX Operating System: Answer Book</em>. Reading, Mass. : Addison-Wesley, 1991. ISBN 0-201-54629-9</p></li><li><p>McKusick, Marshall Kirk, Keith Bostic, Michael J Karels, and John Quarterman. <em>The Design and Implementation of the 4.4BSD Operating System</em>. Reading, Mass. : Addison-Wesley, 1996. ISBN 0-201-54979-4</p><div class=paragraph><p>Hoofdstuk 2 is <a href=https://docs.freebsd.org/en/books/design-44bsd/>online</a> beschikbaar als onderdeel van het FreeBSD Documentatie Project.</p></div></li><li><p>Stevens, W. Richard. <em>TCP/IP Illustrated, Volume 1: The Protocols</em>. Reading, Mass. : Addison-Wesley, 1996. ISBN 0-201-63346-9</p></li><li><p>Schimmel, Curt. <em>Unix Systems for Modern Architectures</em>. Reading, Mass. : Addison-Wesley, 1994. ISBN 0-201-63338-8</p></li><li><p>Stevens, W. Richard. <em>TCP/IP Illustrated, Volume 3: TCP for Transactions, HTTP, NNTP and the UNIX Domain Protocols</em>. Reading, Mass. : Addison-Wesley, 1996. ISBN 0-201-63495-3</p></li><li><p>Vahalia, Uresh. <em>UNIX Internals — The New Frontiers</em>. Prentice Hall, 1996. ISBN 0-13-101908-2</p></li><li><p>Wright, Gary R. and W. Richard Stevens. <em>TCP/IP Illustrated, Volume 2: The Implementation</em>. Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-63354-X</p></li></ul></div></div><div class=sect2><h3 id=bibliography-security>B.6. Over beveiliging<a class=anchor href=#bibliography-security></a></h3><div class=ulist><ul><li><p>Cheswick, William R. and Steven M. Bellovin. <em>Firewalls and Internet Security: Repelling the Wily Hacker</em>. Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-63357-4</p></li><li><p>Garfinkel, Simson. <em>PGP Pretty Good Privacy</em> O’Reilly & Associates, Inc., 1995. ISBN 1-56592-098-8</p></li></ul></div></div><div class=sect2><h3 id=bibliography-hardware>B.7. Over hardware<a class=anchor href=#bibliography-hardware></a></h3><div class=ulist><ul><li><p>Anderson, Don and Tom Shanley. <em>Pentium Processor System Architecture</em>. 2nd Ed. Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-40992-5</p></li><li><p>Ferraro, Richard F. <em>Programmer’s Guide to the EGA, VGA, and Super VGA Cards</em>. 3rd ed. Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-62490-7</p></li><li><p>Intel Corporation publiceert documentatie over haar CPU’s, chipsets en standaarden op haar <a href=http://developer.intel.com/>ontwikkelaars website</a>, gewoonlijk als PDF bestanden.</p></li><li><p>Shanley, Tom. <em>80486 System Architecture</em>. 3rd ed. Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-40994-1</p></li><li><p>Shanley, Tom. <em>ISA System Architecture</em>. 3rd ed. Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-40996-8</p></li><li><p>Shanley, Tom. <em>PCI System Architecture</em>. 4th ed. Reading, Mass. : Addison-Wesley, 1999. ISBN 0-201-30974-2</p></li><li><p>Van Gilluwe, Frank. <em>The Undocumented PC</em>, 2nd Ed. Reading, Mass: Addison-Wesley Pub. Co., 1996. ISBN 0-201-47950-8</p></li><li><p>Messmer, Hans-Peter. <em>The Indispensable PC Hardware Book</em>, 4th Ed. Reading, Mass: Addison-Wesley Pub. Co., 2002. ISBN 0-201-59616-4</p></li></ul></div></div><div class=sect2><h3 id=bibliography-history>B.8. UNIX® geschiedenis<a class=anchor href=#bibliography-history></a></h3><div class=ulist><ul><li><p>Lion, John <em>Lion’s Commentary on UNIX, 6th Ed. With Source Code</em>. ITP Media Group, 1996. ISBN 1573980137</p></li><li><p>Raymond, Eric S. <em>The New Hacker’s Dictionary, 3rd edition</em>. MIT Press, 1996. ISBN 0-262-68092-0. Ook bekend als het <a href=http://www.catb.org/~esr/jargon/html/index.html>Jargon Bestand</a></p></li><li><p>Salus, Peter H. <em>A quarter century of UNIX</em>. Addison-Wesley Publishing Company, Inc., 1994. ISBN 0-201-54777-5</p></li><li><p>Simon Garfinkel, Daniel Weise, Steven Strassmann. <em>The UNIX-HATERS Handbook</em>. IDG Books Worldwide, Inc., 1994. ISBN 1-56884-203-1. Het is niet meer te leveren, maar wel <a href=http://www.simson.net/ref/ugh.pdf>online</a> beschikbaar.</p></li><li><p>Don Libes, Sandy Ressler <em>Life with UNIX</em> - special edition. Prentice-Hall, Inc., 1989. ISBN 0-13-536657-7</p></li><li><p><em>The BSD family tree</em>. <a href=http://www.FreeBSD.org/cgi/cvsweb.cgi/src/shared/misc/bsd-family-tree>http://www.FreeBSD.org/cgi/cvsweb.cgi/src/shared/misc/bsd-family-tree</a> of <a href=file://localhost/usr/shared/misc/bsd-family-tree>/usr/shared/misc/bsd-family-tree</a> op een FreeBSD machine.</p></li><li><p><em>Networked Computer Science Technical Reports Library</em>. <a href=http://www.ncstrl.org/>http://www.ncstrl.org/</a></p></li><li><p><em>Oude BSD releases van de Computer Systems Research group (CSRG)</em>. <a href=http://www.mckusick.com/csrg/>http://www.mckusick.com/csrg/</a>: De set van 4 cd-roms bevat alle versies van BSD van 1BSD to 4.4BSD en 4.4BSD-Lite2 (maar helaas 2.11BSD niet). Op de laatste disk staan ook de laatste broncode en de SCCS bestanden.</p></li></ul></div></div><div class=sect2><h3 id=bibliography-journals>B.9. Tijdschriften en periodieken<a class=anchor href=#bibliography-journals></a></h3><div class=ulist><ul><li><p><em>The C/C++ Users Journal</em>. R&amp;D Publications Inc. ISSN 1075-2838</p></li><li><p><em>Sys Admin - The Journal for UNIX System Administrators</em> Miller Freeman, Inc., ISSN 1061-2688</p></li><li><p><em>freeX - Das Magazin für Linux - BSD - UNIX</em> (Duits) Computer- und Literaturverlag GmbH, ISSN 1436-7033</p></li></ul></div></div></div></div><div class=sect1><h2 id=eresources>Bijlage C: Bronnen op Internet<a class=anchor href=#eresources></a></h2><div class=sectionbody><div class=paragraph><p>Door de snelle ontwikkeling van FreeBSD zijn gedrukte media niet zo praktisch om de laatste ontwikkelingen te volgen. Elektronische bronnen zijn de beste, en vaak de enige, om op de hoogte te blijven van de laatste ontwikkelingen. Omdat FreeBSD draait op de inzet van vrijwilligers, is de gebruikersgemeenschap vaak een soort "technische ondersteuningsgroep", die heeft ontdekt dat email, webfora, en USENET de meeste effectieve manieren zijn om de gebruikersgemeenschap te bereiken.</p></div><div class=paragraph><p>Hieronder staan de meest belangrijke contactmogelijkheden met de FreeBSD gebruikersgemeenschap beschreven. Mochten er andere bronnen zijn die hier niet beschreven zijn, laat die dan weten aan de <a href=https://lists.FreeBSD.org/subscription/freebsd-doc>FreeBSD documentatieproject mailinglijst</a>, zodat ze hier ook beschreven kunnen worden.</p></div><div class=sect2><h3 id=eresources-mail>C.1. Mailinglijsten<a class=anchor href=#eresources-mail></a></h3><div class=paragraph><p>De mailinglijsten zijn de meest directe manier om vragen te stellen aan of een technische discussie te beginnen met een geconcentreerd FreeBSD-publiek. Er is een grote verscheidenheid aan lijsten met betrekking tot verschillende FreeBSD-onderwerpen. Door uw vragen aan de meest geschikte mailinglijst te stellen bent u ongetwijfeld verzekerd van een sneller en accurater antwoord.</p></div><div class=paragraph><p>De doelstellingen van de verschillende lijsten staan onderaan dit document. <em>Lees alstublieft de doelstellingen alvorens lid te worden of mail te sturen</em>. De meeste leden ontvangen tegenwoordig vaak honderden FreeBSD-gerelateerde berichten per dag, en door de doelstellingen en gebruiksregels op te stellen wordt gestreefd om zo min mogelijk ruis op de lijn te krijgen. Door de voorgaande adviezen te negeren zouden de mailinglijsten op termijn falen als een effectief communicatiemedium over het project.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><em>Als u wilt testen of u naar de FreeBSD lijsten email kunt versturen, stuur dan een bericht naar <a href=https://lists.FreeBSD.org/subscription/freebsd-test>FreeBSD test mailinglijst</a>.</em> Stuur alstublieft geen testberichten naar andere lijsten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Bij twijfel over naar welke lijst te posten, kan de pagina <a href=https://docs.freebsd.org/en/articles/freebsd-questions/>Hoe de beste resultaten uit de FreeBSD-vragen mailinglijst te halen</a> wellicht helpen.</p></div><div class=paragraph><p>Alvorens naar enige lijst te posten, is het verstandig te leren hoe de mailinglijsten het beste gebruikt kunnen worden. Hoe bijvoorbeeld zich vaak herhalende discussies voorkomen kunnen worden door het document <a href=https://docs.freebsd.org/en/articles/mailing-list-faq/>Veel Gestelde Mailinglijstvragen</a> (FAQ) te lezen.</p></div><div class=paragraph><p>Voor alle mailinglijsten worden archieven bijgehouden die doorzocht kunnen worden op de <a href=https://www.FreeBSD.org/search/>FreeBSD World Wide Web server</a>. De met sleutelwoorden te doorzoeken archieven bieden een voortreffelijke methode om antwoorden te vinden op vaak gestelde vragen en horen geraadpleegd te worden voordat er vragen op een lijst worden gesteld. Merk op dat dit ook betekent dat berichten die naar de mailinglijsten van FreeBSD worden verzonden tot in de oneindigheid worden gearchiveerd. Overweeg, wanneer het beschermen van privacy belangrijk is, om een tweede emailadres dat weggegooid kan worden te gebruiken en om alleen publieke informatie te posten.</p></div><div class=sect3><h4 id=eresources-summary>C.1.1. Lijstsamenvatting<a class=anchor href=#eresources-summary></a></h4><div class=paragraph><p><em>Algemene lijsten:</em> De volgende zijn algemene lijsten waarop vrijelijk (en aangemoedigd) geabonneerd kan worden:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Lijst</th><th class="tableblock halign-left valign-top">Doel</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-advocacy>freebsd-advocacy</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD Evangelisatie</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-announce>FreeBSD aankondigingen mailinglijst</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Belangrijke gebeurtenissen en projectdoelen (gemodereerd)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-arch>freebsd-arch</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Architectuur en ontwerp discussies</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-bugbusters>freebsd-bugbusters</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussie over het onderhoud van de FreeBSD probleemrapportendatabase en aanverwante zaken</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-bugs>freebsd-bugs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Bugbeschrijvingen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-chat>freebsd-chat</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Niet-technische onderwerpen met betrekking tot de FreeBSD-gemeenschap</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-chromium>freebsd-chromium</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD specifieke Chromium problemen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT mailinglijst</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussie over het gebruik van FreeBSD-CURRENT</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-isp>freebsd-isp</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Zaken voor Internet Service Providers die FreeBSD gebruiken</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-jobs>freebsd-jobs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Werk en mogelijkheden voor het geven van advies met betrekking tot FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-questions>freebsd-questions</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gebruikersvragen en technische ondersteuning</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-security-notifications>FreeBSD beveiligingswaarschuwingen mailinglijst</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Beveiligingswaarschuwingen (gemodereerd)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; mailinglijst</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussies over het gebruik van FreeBSD-STABLE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-test>FreeBSD test mailinglijst</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Hier kunnen testberichten heengestuurd worden in plaats van naar de eigenlijke lijsten</p></td></tr></tbody></table><div class=paragraph><p><em>Technische lijsten:</em> De volgende lijsten zijn voor technische discussie. Het is van belang de doelstellingen te lezen alvorens lid te worden of mail te sturen omdat de richlijnen voor het gebruik en de inhoud erg strikt zijn.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Lijst</th><th class="tableblock halign-left valign-top">Doel</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI mailinglijst</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ontwikkeling van ACPI en energiebeheer</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-afs>freebsd-afs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van AFS naar FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/aic7xxx>freebsd-aic7xxx</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ontwikkeling van stuurprogramma’s voor de Adaptec® AIC 7xxx</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-amd64>freebsd-amd64</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van FreeBSD naar AMD64-systemen (gemodereerd)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-apache>freebsd-apache</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussie over ports met betrekking tot Apache</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-arm>freebsd-arm</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van FreeBSD naar ARM®-processors</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-atm>freebsd-atm</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het gebruik van ATM-netwerken met FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-bluetooth>freebsd-bluetooth</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Bluetooth® technologie gebruiken in FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-cluster>freebsd-cluster</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD gebruiken in een geclusterde omgeving</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-cvsweb>freebsd-cvsweb</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CVSweb onderhoud</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-database>freebsd-database</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussie over het gebruik en de ontwikkeling van databases met FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-desktop>freebsd-desktop</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD gebruiken op en verbeteren voor bureaubladen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-doc>freebsd-doc</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het maken van FreeBSD-gerelateerde documenten</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-drivers>freebsd-drivers</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Apparaatstuurprogramma’s schrijven voor FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-dtrace>freebsd-dtrace</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTrace op FreeBSD gebruiken en ontwikkelen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-eclipse>freebsd-eclipse</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gebruikers van Eclipse IDE, hulpprogramma’s, cliëntapplicaties en ports</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-eol>freebsd-eol</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ondersteuning voor FreeBSD-gerelateerde software welke niet langer ondersteund worden door het FreeBSD-project.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-embedded>freebsd-embedded</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD gebruiken in embedded applicaties.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-emulation>freebsd-emulation</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Emulatie van andere systemen zoals Linux®, MS-DOS®, en Windows®</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-firewire>freebsd-firewire</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD FireWire® (iLink, IEEE 1394) technische discussie</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-fs>freebsd-fs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Bestandssystemen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-gecko>freebsd-gecko</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussies over de Gecko Rendering Engine</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-geom>freebsd-geom</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GEOM-specifieke discussies en implementaties</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-gnome>freebsd-gnome</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van GNOME en GNOME applicaties</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-hackers>freebsd-hackers</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Algemene technische discussies</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-hardware>freebsd-hardware</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Algemene discussies over hardware voor het draaien van FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-i18n>freebsd-i18n</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD Internationalisatie</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ia32>freebsd-ia32</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD op het IA-32 (Intel® x86) platform</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ia64>freebsd-ia64</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van FreeBSD naar Intel®'s IA64 systemen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-infiniband>freebsd-infiniband</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Infiniband op FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ipfw>freebsd-ipfw</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Technische discussie over het herontwerp van de IP-firewallcode</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-isdn>freebsd-isdn</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ISDN-ontwikkelaars</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-jail>freebsd-jail</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussies over de <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a>-faciliteiten.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-java>freebsd-java</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Java™ ontwikkelaars en mensen die JDK™s porten naar FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://mail.kde.org/mailman/listinfo/kde-freebsd>freebsd-kde</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van KDE en KDE applicaties</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-lfs>freebsd-lfs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van LFS naar FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-mips>freebsd-mips</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van FreeBSD naar MIPS®</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-mobile>freebsd-mobile</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussie over mobiel computeren</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-mono>freebsd-mono</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mono en C# applicaties op FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-mozilla>freebsd-mozilla</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van Mozilla naar FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-multimedia>FreeBSD multimedia mailinglijst</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Multimedia-applicaties</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-new-bus>freebsd-new-bus</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Technische discussies over busarchitecturen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-net>freebsd-net</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussies over netwerken en TCP/IP-broncode</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-numerics>freebsd-numerics</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussies over implementaties van hoge kwaliteit van functies in libm</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-office>freebsd-office</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Kantoortoepassingen op FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-performance>freebsd-performance</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Optimalisatie van prestaties voor installaties met hoge prestaties en/of load</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-perl>freebsd-perl</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Onderhoud van een aantal ports met betrekking tot Perl</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-pf>freebsd-pf</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussies en vragen voor het pakketfilter firewallsysteem</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-platforms>freebsd-platforms</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ports naar niet Intel®-architectuurplatformen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ports>freebsd-ports</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussie over de Portscollectie</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ports-announce>freebsd-ports-announce</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Belangrijk nieuws en belangrijke instructies over de Portscollectie (gemodereerd)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ports-bugs>freebsd-ports-bugs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussie over bugs in ports en PR’s</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ppc>freebsd-ppc</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van FreeBSD naar de PowerPC®</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-proliant>freebsd-proliant</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Technische discussie over FreeBSD op HP Proliant serverplatforms</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-python>freebsd-python</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD-specifieke zaken over Python</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-realtime>freebsd-realtime</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ontwikkeling van realtime-uitbreidingen voor FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-rc>freebsd-rc</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussie over het <span class=filename>rc.d</span>-systeem en de ontwikkeling daarvan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ruby>freebsd-ruby</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD-specifieke discussies over Ruby</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-scsi>freebsd-scsi</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het SCSI-subsysteem</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-security>FreeBSD beveiliging mailinglijst</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Beveiligingsonderwerpen betreffende FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-small>freebsd-small</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD gebruiken in embedded toepassingen, verouderd, gebruik in plaats hiervan <a href=https://lists.FreeBSD.org/subscription/freebsd-embedded>freebsd-embedded</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-snapshots>freebsd-snapshots</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Aankondigingen van ontwikkel-snapshots van FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-sparc64>freebsd-sparc64</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Porten van FreeBSD naar op SPARC® gebaseerde systemen</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-standards>freebsd-standards</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Volgen van de C99- en de POSIX® standaarden door FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-sysinstall>freebsd-sysinstall</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ontwikkeling van <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-tcltk>freebsd-tcltk</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD-specifieke discussies over Tcl/Tk</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-testing>freebsd-testing</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Testen op FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-tex>freebsd-tex</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TeX en haar toepassingen op FreeBSD overzetten</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-threads>freebsd-threads</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Threading in FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-tilera>freebsd-tilera</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD porteren naar de Tilera CPU-familie</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-tokenring>freebsd-tokenring</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ondersteuning voor Token Ring in FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-toolchain>freebsd-toolchain</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Onderhoud van de ingebouwde toolchain van FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-usb>freebsd-usb</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussie over FreeBSD-ondersteuning voor USB</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-virtualization>freebsd-virtualization</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussies over verscheidene virtualisatietechnieken ondersteund door FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-vuxml>freebsd-vuxml</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussie over VuXML-infrastructuur</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-x11>freebsd-x11</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Onderhoud en ondersteuning voor X11 op FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-xen>freebsd-xen</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussies over het overbrengen van FreeBSD naar Xen™ - implementatie en gebruik</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-xfce>freebsd-xfce</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Overbrengen en onderhouden van XFCE voor FreeBSD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-zope>freebsd-zope</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Zope voor FreeBSD - overbrengen en onderhouden</p></td></tr></tbody></table><div class=paragraph><p><em>Beperkte lijsten:</em> De volgende lijsten zijn voor meer gespecialiseerd publiek en algemene gebruikers hebben er waarschijnlijk niets aan. Het is verstandig om eerst naam te maken in de technische lijsten alvorens lid te worden van een van de onderstaande beperkte lijsten, zodat de gebruiken op die lijst bekend zijn.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Lijst</th><th class="tableblock halign-left valign-top">Doel</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-hubs>freebsd-hubs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mensen die mirrorsites draaien (infrastructurele ondersteuning)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-user-groups>freebsd-user-groups</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gebruikersgroepcoördinatie</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-wip-status>freebsd-wip-status</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD Werk-In-Uitvoering status</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-wireless>freebsd-wireless</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Discussies over de ontwikkeling van de 802.11-stack, gereedschappen en stuurprogramma’s.</p></td></tr></tbody></table><div class=paragraph><p><em>Verkorte versie van lijsten (digest):</em> Alle hierboven beschreven lijsten zijn beschikbaar in verkorte vorm. Na het lid worden van een lijst zijn de digest opties te wijzigen bij de accountopties.</p></div><div class=paragraph><p><em>SVN-lijsten:</em> De volgende lijsten zijn voor mensen met interesse in het zien van logboekberichten voor wijzigingen in verschillende onderdelen van de broncodeboom. Het zijn <em>Alleen-lezen</em>-lijsten waar geen email heen gezonden hoort te worden.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Lijst</th><th class="tableblock halign-left valign-top">Broncodegebied</th><th class="tableblock halign-left valign-top">Broncodebeschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-doc-all>svn-doc-all</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/doc</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen aan het doc-Subversion-reservoir (behalve <span class=filename>user</span>, <span class=filename>projects</span> en <span class=filename>translations</span>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-doc-head>svn-doc-head</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/doc</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen aan de tak "head" van het doc-Subversion-reservoir</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-doc-projects>svn-doc-projects</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/doc/projects</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen in het projects-gebied van het doc-Subversion-reservoir</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-doc-svnadmin>svn-doc-svnadmin</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/doc</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen aan de administratieve scripts, haken en andere configuratiegegevens van het doc-Subversion-reservoir</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-ports-all>svn-ports-all</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/ports</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen aan het ports-Subversion-reservoir</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-ports-head>svn-ports-head</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/ports</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen aan de tak "head" van het ports-Subversion-reservoir</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-ports-svnadmin>svn-ports-svnadmin</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/ports</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen aan de administratieve scripts, haken en andere configuratiegegevens van het ports-Subversion-reservoir</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-all>SVN-commitberichten voor de gehele src-structuur (behalve voor "user" en "projects")</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen in het src-Subversion-repository (behalve <span class=filename>user</span> en <span class=filename>projects</span>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-head>SVN-commitberichten voor de src-structuur voor head/-current</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen aan de "head"-tak van het src-Subversion-repository (de tak FreeBSD-CURRENT)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-projects>svn-src-projects</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/projects</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen aan het gebied <span class=filename>projects</span> van het src-Subversion-repository</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-release>svn-src-release</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle veranderingen aan het gebied <span class=filename>releases</span> van het src-Subversion-repository</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-releng>svn-src-releng</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle veranderingen aan de takken <span class=filename>releng</span> van het src-Subversion-repository (de beveiligings- / uitgavetakken)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable>svn-src-stable</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle veranderingen aan alle stable-takken van het src-Subversion-repository</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable-6>svn-src-stable-6</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle veranderingen aan de <span class=filename>stable/6</span>-tak van het src-Subversion-repository</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable-7>svn-src-stable-7</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle veranderingen aan de <span class=filename>stable/7</span>-tak van het src-Subversion-repository</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable-8>svn-src-stable-8</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle veranderingen aan de <span class=filename>stable/8</span>-tak van het src-Subversion-repository</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable-9>SVN-commitberichten voor alleen de 9-stable-src-structuur</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle veranderingen aan de <span class=filename>stable/9</span>-tak van het src-Subversion-repository</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable-other>svn-src-stable-other</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle veranderingen aan de oudere <span class=filename>stable</span>-takken van het src-Subversion-repository</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-svnadmin>svn-src-svnadmin</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle veranderingen aan de administratieve scripts, haken, en andere configuratiegegevens van het src-Subversion-repository</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-user>svn-src-user</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle veranderingen aan het experimentele gebied <span class=filename>user</span> van het src-Subversion-repository</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-vendor>svn-src-vendor</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle wijzigingen aan het verkoperswerkgebied van het src-Subversion-repository</p></td></tr></tbody></table></div><div class=sect3><h4 id=eresources-subscribe>C.1.2. Hoe abonneren<a class=anchor href=#eresources-subscribe></a></h4><div class=paragraph><p>Om te abonneren op een lijst kan geklikt worden op de naam van de lijst hierboven of kan op <a href=https://lists.freebsd.org class=bare>https://lists.freebsd.org</a> geklikt worden op de lijst waarin interesse bestaat. De pagina waarop de lijsten staan beschreven bevat alle informatie die nodig is om te abonneren.</p></div><div class=paragraph><p>Om te posten op een lijst kan een email gestuurd worden naar <a href=mailto:lijstnaam@FreeBSD.org>lijstnaam@FreeBSD.org</a>. Daarna wordt die doorgestuurd aan leden van de lijst in de hele wereld.</p></div><div class=paragraph><p>Om het abonnement op een lijst op te zeggen kan op de URL die onderaan iedere email van een lijst staat geklikt worden. Het is ook mogelijk om een email te sturen naar <a href=mailto:lijstnaam-unsubscribe@FreeBSD.org>lijstnaam-unsubscribe@FreeBSD.org</a> om een abonnement op te zeggen.</p></div><div class=paragraph><p>Hierbij nogmaals het advies om discussies op de technische mailinglijsten technisch te houden. Als er alleen interesse bestaat in belangrijke mededelingen dan wordt aangeraden te abonnneren op <a href=https://lists.FreeBSD.org/subscription/freebsd-announce>FreeBSD aankondigingen mailinglijst</a>, waarop zelden verkeer voorkomt.</p></div></div><div class=sect3><h4 id=eresources-charters>C.1.3. Lijstdoelstellingen<a class=anchor href=#eresources-charters></a></h4><div class=paragraph><p><em>Alle</em> FreeBSD-mailinglijsten hebben eigen regels waaraan voldaan dient te worden bij gebruik. Als daaraan niet wordt voldaan, resulteert dat in maximaal twee (2) schriftelijke waarschuwingen van de FreeBSD Postmaster <a href=mailto:postmaster@FreeBSD.org>postmaster@FreeBSD.org</a>, waarna na de derde overtreding de poster verwijderd wordt van alle FreeBSD-mailinglijsten en alle toekomstige mail van het adres van de verzender wordt uitgefilterd. Helaas zijn deze regels nodig, omdat het Internet van vandaag de dag een onvriendelijke omgeving is en slechts weinigen zich bewust zijn van hoe fragiel sommige mechanismen zijn.</p></div><div class=paragraph><p>Standaardregels:</p></div><div class=ulist><ul><li><p>Het onderwerp van iedere mail dient te voldoen aan de basisdoelstellingen van de lijst waarnaar wordt gepost. Als de lijst bijvoorbeeld over technische onderwerpen gaat, dan hoort een post ook over iets technisch te gaan. Ruis en flaming doen alleen af aan de waarde van een mailinglijst voor alle leden en dat wordt niet getolereerd. Voor vrije discussie dient de <a href=https://lists.FreeBSD.org/subscription/freebsd-chat>FreeBSD babbel mailinglijst</a> gebruikt te worden die daar speciaal voor is ingesteld.</p></li><li><p>Bijdragen horen niet naar meer dan twee mailinglijsten verzonden te worden en alleen dan naar twee als het helder en duidelijk is dat daarvoor de noodzaak bestaat. Voor de meeste lijsten bestaat er al veel overlap in de leden en met uitzondering van de meer esoterische lijsten, zoals bijvoorbeeld "-stable & -scsi", is er eigenlijk slechts zelden aanleiding om naar meer dan een lijst te posten. Als een bericht zo is verzonden dat er meerdere mailinglijsten op de regel <code>Cc</code> staan, dan hoort de regel <code>Cc</code> weer ingekort te worden in een eventueel antwoord. <em>De verzender is verantwoordelijk voor zijn eigen kruisposten, wie ook een eerdere zender was.</em></p></li><li><p>Persoonlijke aanvallen en profane taal (in de context van een geschil) zijn niet toegestaan. Dit geldt zowel voor gebruikers als ontwikkelaars. Grove schending van de netiquette, zoals kopiëren uit of het volledig doorsturen van persoonlijke email zonder dat daarvoor toestemming is gegeven, wordt niet op prijs gesteld. Er zijn hoe dan ook zeer weinig gevallen waarin zoiets dergelijks wel binnen de doelstelling van een lijst valt, waardoor dat soort emails op grond van de inhoud alleen al vaak reden zijn voor een waarschuwing (of ban).</p></li><li><p>Adverteren voor niet-FreeBSD-gerelateerde producten is streng verboden en heeft direct een ban tot gevolg als helder is dat de overtreder adverteert door middel van spam.</p></li></ul></div><div class=paragraph><p><em>Individuele lijstdoelstellingen:</em></p></div><div class=dlist><dl><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI mailinglijst</a></dt><dd><p><em>ACPI en energiebeheerontwikkeling</em></p></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-afs>freebsd-afs</a></dt><dd><p><em>Andrew Bestandssysteem (Andrew File System)</em></p><div class=paragraph><p>Deze lijst is voor onderwerpen over het porten en gebruik van AFS van CMU/Transarc</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-announce>FreeBSD aankondigingen mailinglijst</a></dt><dd><p><em>Belangrijke gebeurtenissen en projectdoelen</em></p><div class=paragraph><p>Dit is de mailinglijst voor hen die alleen interesse hebben in gelegenheidsmededelingen of belangrijke FreeBSD-gebeurtenissen. Hieronder vallen aankondigingen over snapshots en andere uitgaven. De lijst omvat ook aankondigingen over nieuwe mogelijkheden binnen FreeBSD. Er kunnen ook oproepen gedaan worden voor vrijwilligers, enzovoort. Deze lijst kent een laag volume en is volledig gemodereerd.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-arch>freebsd-arch</a></dt><dd><p><em>Discussie van architectuur en ontwerp</em></p><div class=paragraph><p>Deze lijst is bedoeld voor het bespreken van de FreeBSD-architectuur. Berichten zijn in het algemeen strikt technisch van aard. Voorbeelden van geschikte onderwerpen zijn:</p></div><div class=ulist><ul><li><p>Hoe het buildsysteem bijgewerkt kan worden zodat meerdere aanpaste builds tegelijkertijd kunnen lopen.</p></li><li><p>Wat moet er aan VPS aangepast worden om Heidemann-lagen te laten werken.</p></li><li><p>Hoe kan de apparataatstuurprogramma interface aangepast worden zodat dezelfde stuurprogramma’s netjes op vele bussen en architecturen gebruikt kunnen worden.</p></li><li><p>Hoe een netwerkstuurprogramma geschreven kan worden.</p></li></ul></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-bluetooth>freebsd-bluetooth</a></dt><dd><p><em>Bluetooth® in FreeBSD</em></p><div class=paragraph><p>Dit is het forum waar gebruikers van Bluetooth® op FreeBSD samenkomen. Gespreksstof op het gebied van ontwerp, implementatiedetails, patches, probleemrapportages, statusrapportages, verzoeken voor nieuwe mogelijkheden en al het andere dat met Bluetooth® te maken heeft is geschikt materiaal.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-bugbusters>freebsd-bugbusters</a></dt><dd><p><em>Coördinatie afhandeling Problem Reports</em></p><div class=paragraph><p>Het doel van deze lijst is een platform zijn voor de coördinatie en discussie voor de Bugmeister, zijn Bugbusters en anderen die interesse hebben in de PR-database. Deze lijst is niet bedoeld voor discussies over specifieke bugs, patches of PR’s.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-bugs>freebsd-bugs</a></dt><dd><p><em>Bug reports</em></p><div class=paragraph><p>Dit is de mailinglijst voor het rapporteren van bugs in FreeBSD. Waar mogelijk dienen bugs ingezonden te worden via <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> of via de <a href=https://www.FreeBSD.org/send-pr.html>Webinterface</a> daarvan.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-chat>freebsd-chat</a></dt><dd><p><em>Niet-technische onderwerpen met betrekking tot de FreeBSD-gemeenschap</em></p><div class=paragraph><p>Deze lijst bevat alle onderwerpen waar op andere lijsten geen ruimte voor is wat betreft niet-technische en sociale informatie. Er wordt gesproken over de moord op Van Gogh, of er in onderkast of kapitalen geschreven dient te worden, wie er te veel koffie drinkt, waar het beste bier vandaan komt, enzovoort. Belangrijke gebeurtenissen (zoals feestjes, bruiloften, geboorten, nieuwe banen, enzovoort) kunnen op de technische lijsten aangekondigd worden, maar antwoorden dienen naar deze -chat lijst te gaan.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-chromium>freebsd-chromium</a></dt><dd><p><em>FreeBSD specifieke Chromium problemen</em></p><div class=paragraph><p>Dit is een lijst voor het bespreken van Chromium ondersteuning voor FreeBSD. Dit is een technische lijst om de ontwikkelingen en installatie van Chromium te bespreken.</p></div></dd><dt class=hdlist1>FreeBSD core team</dt><dd><p><em>FreeBSD Kernteam</em></p><div class=paragraph><p>Dit is een interne mailinglijst die wordt gebruikt door de kernleden. Er kunnen berichten naar gestuurd worden als een belangrijke FreeBSD-gerelateerde zaak arbitrage nodig heeft of een onderzoekende blik op hoog niveau nodig is.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT mailinglijst</a></dt><dd><p><em>Discussie over het gebruikt van FreeBSD-CURRENT</em></p><div class=paragraph><p>Dit is de mailinglijst voor gebruikers van FreeBSD-CURRENT. Er staan waarschuwingen op over nieuwe mogelijkheden in -CURRENT die impact hebben op gebruikers en instructies over de te nemen stappen om -CURRENT te blijven. Iedereen die "CURRENT" draait, zou zich moeten abonneren. Dit is een technische mailinglijst waarop strikt technische berichten worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-cvsweb>freebsd-cvsweb</a></dt><dd><p><em>FreeBSD CVSweb Project</em></p><div class=paragraph><p>Technische discussie over het gebruik, de ontwikkeling en het beheer van FreeBSD-CVSweb.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-desktop>freebsd-desktop</a></dt><dd><p><em>FreeBSD gebruiken op en verbeteren voor bureaubladen</em></p><div class=paragraph><p>Dit is een forum voor het bespreken van FreeBSD op desktops. Het is vooral een plaats voor porters en gebruikers van bureaubladomgevingen om zaken te bespreken en de ondersteuning van FreeBSD op het bureaublad te verbeteren.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-doc>freebsd-doc</a></dt><dd><p><em>Documentatieproject</em></p><div class=paragraph><p>Dit is de mailinglijst voor het bespreken van onderwerpen en projecten die te maken hebben met het maken van documentatie voor FreeBSD. De leden van deze mailinglijst worden samen "The FreeBSD Documentation Project" genoemd. Het is een open lijst waarop zonder problemen een abonnement genomen kan worden en bijdragen zeer op prijs worden gesteld!</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-drivers>freebsd-drivers</a></dt><dd><p><em>Apparaatstuurprogramma’s schrijven voor FreeBSD</em></p><div class=paragraph><p>Dit is een forum voor technische discussie met betrekking tot apparaatstuurprogramma’s op FreeBSD. Het is vooral een plaats voor schrijvers van apparaatstuurprogramma’s om vragen te stellen over hoe apparaatstuurprogramma’s te schrijven met de API’s in de kernel van FreeBSD.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-dtrace>freebsd-dtrace</a></dt><dd><p><em>DTrace op FreeBSD gebruiken en ontwikkelen</em></p><div class=paragraph><p>DTrace is een geïntegreerd component van FreeBSD dat een raamwerk biedt om de kernel en de gebruikersprogramma’s tijdens het draaien te begrijpen. De mailinglijst is een gearchiveerde discussie voor ontwikkelaars van de code en voor de gebruikers ervan.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-eclipse>freebsd-eclipse</a></dt><dd><p><em>Gebruikers van Eclipse IDE, hulpprogramma’s, cliëntapplicaties en ports</em></p><div class=paragraph><p>De doelstelling van deze lijst is wederzijdse ondersteuning bieden voor alles dat te maken heeft met het kiezen, installeren, gebruiken, ontwikkelen, en onderhouden van Eclipse IDE, hulpprogramma’s en cliëntapplicaties op het FreeBSD-platform en te ondersteunen bij het porten van Eclipse IDE en plugins naar de FreeBSD-omgeving.</p></div><div class=paragraph><p>Het is ook de bedoeling om het uitwisselen van informatie tussen de Eclipse gemeenschap en de FreeBSD-gemeenschap te bevorderen zodat beiden ervan kunnen profiteren.</p></div><div class=paragraph><p>Hoewel deze lijst voornamelijk is gericht op de behoeften van gebruikers van Eclipse, wordt ook een forum geboden voor hen die FreeBSD-specifieke applicaties willen ontwikkelen met het Eclipse raamwerk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-eol>freebsd-eol</a></dt><dd><p><em>Ondersteuning van FreeBSD gerelateerde software welke niet meer ondersteund wordt door het FreeBSD-project.</em></p><div class=paragraph><p>Deze lijst is voor degenen die geïnteresseerd zijn in het leveren of gebruiken van ondersteuning voor FreeBSD-gerelateerde software voor welke het FreeBSD-project geen ondersteuning meer biedt (in de vorm van beveiligingsadviezen en patches).</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-embedded>freebsd-embedded</a></dt><dd><p><em>FreeBSD gebruiken in embedded applicaties</em></p><div class=paragraph><p>Deze lijst heeft tot doel om te discussieren over FreeBSD in embedded systemen. Dit is een technische mailinglijst waarbij men alleen technische inhoud verwacht. Voor het belang van deze lijst definiëren we embedded systemen als computersystemen die geen desktop-systemen zijn en meestal slechts één doel hebben ten opzichte van gewone systemen. Voorbeelden bevatten onder andere: diverse soorten telefoonsets, netwerkapparatuur zoals routers, switches en PBX’en, op afstand bestuurbare meetapparatuur, PDA’s, Point of Sale systemen etc.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-emulation>freebsd-emulation</a></dt><dd><p><em>Emulatie van andere systemen zoals Linux®, MS-DOS® en Windows®</em></p><div class=paragraph><p>Dit is een forum voor technische discussie met betrekking tot het draaien van programma’s op FreeBSD die zijn geschreven voor andere besturingssystemen.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-firewire>freebsd-firewire</a></dt><dd><p><em>FireWire® (iLink, IEEE 1394)</em></p><div class=paragraph><p>Dit is de mailinglijst voor het bespreken van het ontwerp en de implementatie van een FireWire® (ook wel IEEE 1394 of iLink) subsysteem voor FreeBSD. Relevante onderwerpen omvatten de standaarden, busapparaten en hun protocollen, adapter boards/kaarten/chipssets en de architectuur en implementatie van code voor een juiste ondersteuning.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-fs>freebsd-fs</a></dt><dd><p><em>Bestandssystemen</em></p><div class=paragraph><p>Discussie over FreeBSD-bestandssystemen. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-gecko>freebsd-gecko</a></dt><dd><p><em>Gecko Rendering Engine</em></p><div class=paragraph><p>Dit is een forum over Gecko applicaties die FreeBSD gebruiken.</p></div><div class=paragraph><p>De discussie concentreert zich op toepassingen van Gecko Ports, hun installatie, hun ontwikkeling en hun ondersteuning binnen FreeBSD.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-geom>freebsd-geom</a></dt><dd><p><em>GEOM</em></p><div class=paragraph><p>Discussie specifiek over GEOM en gerelateerde implementaties. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-gnome>freebsd-gnome</a></dt><dd><p><em>GNOME</em></p><div class=paragraph><p>Discussie over de bureaubladomgeving GNOME voor FreeBSD. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-infiniband>freebsd-infiniband</a></dt><dd><p><em>Infiniband op FreeBSD</em></p><div class=paragraph><p>Technische mailinglijst over Infiniband, OFED en OpenSM op FreeBSD.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ipfw>freebsd-ipfw</a></dt><dd><p><em>IP Firewall</em></p><div class=paragraph><p>Dit is het forum voor technische bespreking van het herontwerp van de IP-firewallcode in FreeBSD. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ia64>freebsd-ia64</a></dt><dd><p><em>Porten van FreeBSD naar IA64</em></p><div class=paragraph><p>Dit is een technische mailinglijst voor individuen die actief werken aan het porten van FreeBSD naar het platform IA-64 van Intel®, om problemen op tafel te leggen of alternatieve oplossingen te bespreken. Geïnteresseerden die alleen de technische bespreking willen volgen zijn ook welkom.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-isdn>freebsd-isdn</a></dt><dd><p><em>ISDN-communicatie</em></p><div class=paragraph><p>Dit is de mailinglijst voor discussie over de ontwikkeling van ISDN-ondersteuning voor FreeBSD.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-java>freebsd-java</a></dt><dd><p><em>Java™ Ontwikkeling</em></p><div class=paragraph><p>Dit is de mailinglijst voor het bespreken van de ontwikkeling van significante Java™ applicaties voor FreeBSD en het porten en het beheer van JDK™'s.</p></div></dd></dl></div><div id=eresources-charters-jobs class=dlist><dl><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-jobs>freebsd-jobs</a></dt><dd><p><em>Banen in de aanbieding en gezocht</em></p><div class=paragraph><p>Dit is een forum voor vacatures en CV’s specifiek gerelateerd aan FreeBSD, bijvoorbeeld als er FreeBSD-gerelateerd werk wordt gezocht of in de aanbieding is. Dit is <em>geen</em> mailinglijst voor algemene werkonderwerpen omdat daarvoor al elders ruimte staat.</p></div><div class=paragraph><p>Ook deze lijst wordt net als alle andere <code>FreeBSD.org</code> mailinglijsten wereldwijd verspreid. Daarom dient duidelijk vermeld te worden om welke locatie het gaat en onder welke voorwaarden telewerken of bijdragen in huisvesting mogelijk zijn.</p></div><div class=paragraph><p>Email dient alleen open formaten te bevatten. Bij voorkeur platte tekst, maar standaard Portable Document Format (PDF), HTML, en een aantal andere, zijn acceptabel voor lezers. Gesloten formaten, zoals Microsoft® Word (<span class=filename>.doc</span>), worden door de mailinglijstserver geweigerd.</p></div></dd><dt class=hdlist1><a href=https://mail.kde.org/mailman/listinfo/kde-freebsd>freebsd-kde</a></dt><dd><p><em>KDE</em></p><div class=paragraph><p>Discussie over KDE op FreeBSD-systemen. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-hackers>freebsd-hackers</a></dt><dd><p><em>Technische discussies</em></p><div class=paragraph><p>Dit is een forum voor technische discussie met betrekking tot FreeBSD. Dit is de leidende technische mailinglijst die is bestemd voor mensen die actief aan FreeBSD werken om problemen aan het voetlicht te brengen of alternatieve oplossingen te bespreken. Geïnteresseerden die alleen de technische bespreking willen volgen zijn ook welkom. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-hardware>freebsd-hardware</a></dt><dd><p><em>Algemene discussie over FreeBSD-hardware</em></p><div class=paragraph><p>Algemene discussie over de typen hardware waar FreeBSD op draait en problemen en oplossingen over wat te kopen en wat vooral niet.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-hubs>freebsd-hubs</a></dt><dd><p><em>Mirrorsites</em></p><div class=paragraph><p>Aankondigingen en discussie voor beheerders van FreeBSD-mirrorsites.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-isp>freebsd-isp</a></dt><dd><p><em>Onderwerpen voor Internet Service Providers</em></p><div class=paragraph><p>Deze mailinglijst is voor het bespreken van relevante onderwerpen voor Internet Service Providers (ISP’s) die FreeBSD gebruiken. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-mono>freebsd-mono</a></dt><dd><p><em>Mono en C# applicaties op FreeBSD</em></p><div class=paragraph><p>Dit is een lijst voor discussies met betrekking tot het Mono-ontwikkelraamwerk op FreeBSD. Dit is een technische mailinglijst. Het is bedoeld voor individuen die actief werken aan het overbrengen van Mono of C# applicaties naar FreeBSD, om problemen naar voren te brengen of alternatieve oplossingen te bespreken. Individuen die geïnteresseerd zijn in het volgen van de technische discussie zijn ook welkom.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-office>freebsd-office</a></dt><dd><p><em>Kantoortoepassingen op FreeBSD</em></p><div class=paragraph><p>De discussie richt zich op kantoortoepassingen, hun installatie, hun ontwikkeling en hun ondersteuning binnen FreeBSD.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ops-announce>freebsd-ops-announce</a></dt><dd><p><em>Aankondigingen over de projectinfrastructuur</em></p><div class=paragraph><p>Deze mailinglijst is bedoeld voor mensen die geïnteresseerd zijn in veranderingen en zaken die te maken hebben met de infrastructuur van het FreeBSD.org project.</p></div><div class=paragraph><p>Deze gemodereerde lijst is strict voor aankondigingen: geen antwoorden, verzoeken, discussies of meningen.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-performance>freebsd-performance</a></dt><dd><p><em>Discussie over het optimaliseren of versnellen van FreeBSD</em></p><div class=paragraph><p>Deze mailinglijst is een platform voor hackers, beheerders en/of andere belanghebbenden om FreeBSD- en prestatiegerelateerde onderwerpen te bespreken. De onderwerpen die besproken kunnen worden omvatten FreeBSD-installaties met een hoge load, systemen met prestatieproblemen of systemen die tegen de limieten van FreeBSD aan zitten. Zij die willen meewerken om de prestaties van FreeBSD te verbeteren worden sterk aangemoedigd zich op deze lijst te abonneren. Deze lijst is bijzonder technisch en bijzonder geschikt voor ervaren FreeBSD-gebruikers, hackers en beheerders die FreeBSD snel, robuust, en schaalbaar willen houden. Deze lijst is geen vraag-en-antwoord lijst die dient als vervanging voor het lezen van documentatie, maar hier worden bijdragen geleverd of vragen gesteld over nog niet eerder beschreven prestatiegerelateerde onderwerpen.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-pf>freebsd-pf</a></dt><dd><p><em>Discussie en vragen over het pakketfilter firewallsysteem</em></p><div class=paragraph><p>Discussie over het pakketfilter (pf) firewallsysteem met betrekking tot FreeBSD. Technische discussie en gebruikersvragen zijn beiden welkom. Deze lijst is ook de plaats om het raamwerk ALTQ QoS te bespreken.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-pkg>freebsd-pkg</a></dt><dd><p><em>Discussies over binair pakketbeheer en pakketgereedschappen</em></p><div class=paragraph><p>Discussies over alle aspecten over het beheren van FreeBSD-systemen door middel van het gebruik van binaire pakketten om software te installeren, inclusief de gereedschappen en formaten van binaire pakketten, hun ontwikkeling en ondersteuning binnen FreeBSD, het beheer van pakketreservoirs en pakketten van derde partijen.</p></div><div class=paragraph><p>Merk op dat discussies over poorten die onjuiste pakketten genereren over het algemeen als problemen met poorten moet worden gezien en dus ongeschikt zijn voor deze lijst.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-platforms>freebsd-platforms</a></dt><dd><p><em>Porten van niet-Intel® platforms</em></p><div class=paragraph><p>Cross-platform FreeBSD-zaken, algemene discussie en voorstellen voor niet-Intel® FreeBSD ports. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ports>freebsd-ports</a></dt><dd><p><em>Discussie over "ports"</em></p><div class=paragraph><p>Discussie over de "Portscollectie" (<span class=filename>/usr/ports</span>) van FreeBSD, de Ports infrastructuur en algemene coördinatie aangaande ports. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ports-announce>freebsd-ports-announce</a></dt><dd><p><em>Belangrijk nieuws en belangrijke instructies over FreeBSD "Portscollectie"</em></p><div class=paragraph><p>Belangrijk nieuws voor ontwikkelaars, porters en gebruikers van de "Portscollectie" (<span class=filename>/usr/ports</span>), waaronder veranderingen aan de architectuur/infrastructuur, nieuwe mogelijkheden, kritische opwaardeerinstructies, en uitgave-informatie. Dit is een mailinglijst met een laag volume, bedoeld voor aankondigingen.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ports-bugs>freebsd-ports-bugs</a></dt><dd><p><em>Discussie over "ports" bugs</em></p><div class=paragraph><p>Discussie over probleemrapportages voor de FreeBSD "Portscollectie" (<span class=filename>/usr/ports</span>), voorgestelde ports of aanpassingen aan ports. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-proliant>freebsd-proliant</a></dt><dd><p><em>Technische discussie over FreeBSD op HP Proliant serverplatforms</em></p><div class=paragraph><p>Deze mailinglijst wordt gebruikt voor technische discussie over het gebruik van FreeBSD op HP ProLiant servers, inclusief het bespreken van ProLiant-specifieke stuurprogramma’s, beheersoftware, gereedschappen voor instellingen en BIOS-updates. Dit is daaarom ook de uitgesproken plaats voor het bespreken van de modules hpasmd, hpasmcli, en hpacucli.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-python>freebsd-python</a></dt><dd><p><em>Python op FreeBSD</em></p><div class=paragraph><p>Dit is een lijst voor discussie gerelateerd aan het verbeteren van ondersteuning voor Python op FreeBSD. Dit is een technische mailinglijst voor mensen die aan het porten van Python, aanverwante modules en Zope-dingen naar FreeBSD werken.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-questions>freebsd-questions</a></dt><dd><p><em>Gebruikersvragen</em></p><div class=paragraph><p>Dit is de mailinglijst voor vragen over FreeBSD. Er horen geen "how to" vragen op de technische mailinglijsten thuis, tenzij een vraag erg technisch van aard is.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ruby>freebsd-ruby</a></dt><dd><p><em>FreeBSD-specifieke discussies over Ruby</em></p><div class=paragraph><p>Dit is een lijst voor discussies gerelateerd aan de Ruby-ondersteuning op FreeBSD. Dit is een technische mailinglijst. Het is bedoeld voor individuen die aan Ruby-ports, bibliotheken van derde partijen, en raamwerken werken.</p></div><div class=paragraph><p>Individuen die geïnteresseerd zijn in de technische discussie zijn ook welkom.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-scsi>freebsd-scsi</a></dt><dd><p><em>SCSI-subsysteem</em></p><div class=paragraph><p>Dit is de mailinglijst voor mensen die aan het SCSI-subsysteem voor FreeBSD werken. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-security>FreeBSD beveiliging mailinglijst</a></dt><dd><p><em>Beveiligingsonderwerpen</em></p><div class=paragraph><p>FreeBSD-computerbeveiligingsonderwerpen (DES, Kerberos, bekende beveiligingsgaten, oplossingen, enzovoort). Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht. Dit is zeker geen vraag-en-antwoord lijst, maar bijdragen voor de FAQ (zowel <em>vraag</em> als <em>antwoord</em>) zijn welkom.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-security-notifications>FreeBSD beveiligingswaarschuwingen mailinglijst</a></dt><dd><p><em>Beveiligingswaarschuwingen</em></p><div class=paragraph><p>Waarschuwingen voor FreeBSD beveiligingsproblemen en oplossingen. Dit is geen discussielijst. De discussielijst is <a href=https://lists.FreeBSD.org/subscription/freebsd-security>FreeBSD beveiliging mailinglijst</a>.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-small>freebsd-small</a></dt><dd><p><em>FreeBSD gebruiken in embedded toepassingen</em></p><div class=paragraph><p>Op deze lijst worden onderwerpen gerelateerd aan ongebruikelijk kleine en embedded FreeBSD-installaties besproken. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div><div class=paragraph><p>Deze lijst is vervangen door <a href=https://lists.FreeBSD.org/subscription/freebsd-embedded>freebsd-embedded</a></p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-snapshots>freebsd-snapshots</a></dt><dd><p><em>Aankondigingen van ontwikkel-snapshots van FreeBSD</em></p><div class=paragraph><p>Deze lijst houdt u op de hoogte over de beschikbaarheid van nieuwe ontwikkel-snapshots voor de takken head/ en stable/ van FreeBSD.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; mailinglijst</a></dt><dd><p><em>Discussie over het gebruik van FreeBSD-STABLE</em></p><div class=paragraph><p>Dit is de mailinglijst voor gebruikers van FreeBSD-STABLE. Er worden ook waarschuwingen op gepost over nieuwe opties in -STABLE die invloed op de systemen van gebruikers kunnen hebben en instructies over de te nemen stappen om -STABLE te blijven. Iedereen die "STABLE" draait hoort zich op deze lijst te abonneren. Dit is een technische mailinglijst waarop slechts strikt technische bijdragen worden verwacht.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-standards>freebsd-standards</a></dt><dd><p><em>Conformeren C99 & POSIX</em></p><div class=paragraph><p>Dit is een forum voor technische bespreking gerelateerd aan het conformeren van FreeBSD aan de C99- en de POSIX-standaarden.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-testing>freebsd-testing</a></dt><dd><p><em>Testen op FreeBSD</em></p><div class=paragraph><p>Technische mailinglijst voor discussies over testen op FreeBSD, inclusief ATF/Kyua, infrastructuren voor testbuilds, het testen van ports naar FreeBSD van andere besturingssystemen (NetBSD, …​), enzovoorts.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-tex>freebsd-tex</a></dt><dd><p><em>TeX en haar toepassingen op FreeBSD overzetten</em></p><div class=paragraph><p>Dit is een technische mailinglijst voor discussies over TeX en haar toepassingen op FreeBSD. Het is bedoeld voor degenen die actief werken aan het overzetten van TeX op FreeBSD, om problemen te bespreken of alternatieve oplossingen aan te dragen. Personen die geïnteresseerd zijn in het volgen van de technische discussie zijn ook welkom.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-toolchain>freebsd-toolchain</a></dt><dd><p><em>Onderhoud van de ingebouwde toolchain van FreeBSD</em></p><div class=paragraph><p>Dit is de mailinglijst bedoeld voor discussies over het onderhoud van de toolchain die met FreeBSD wordt geleverd. Dit zou de toestand van Clang en GCC kunnen omvatten, maar ook software als assemblers, linkers en debuggers.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-usb>freebsd-usb</a></dt><dd><p><em>Discussie over FreeBSD ondersteuning voor USB</em></p><div class=paragraph><p>Dit is de mailinglijst voor technische bespreking van onderwerpen gerelateerd aan FreeBSD ondersteuning voor USB.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-user-groups>freebsd-user-groups</a></dt><dd><p><em>Gebruikersgroep Coördinatie Lijst</em></p><div class=paragraph><p>Dit is de mailinglijst voor coördinatoren voor alle lokale gebruikersgroepen, zodat ze met elkaar en een lid van het Kernteam zaken kunnen bespreken. Deze lijst hoort beperkt te blijven tot een overzicht van overleggen en de coördinatie van projecten waarbij meerdere gebruikersgroepen betrokken zijn.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-virtualization>freebsd-virtualization</a></dt><dd><p><em>Discussies over verscheidene virtualisatietechnieken ondersteund door FreeBSD</em></p><div class=paragraph><p>Een lijst om de verscheidene virtualisatietechnieken die door FreeBSD worden ondersteund te bespreken. Aan de ene kant zal de nadruk liggen op de implementatie van de basale functionaliteit alsook op het toevoegen van nieuwe mogelijkheden. Aan de andere kant zullen gebruikers een forum hebben om om hulp te vragen bij problemen of om hun usecases te bespreken.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-wip-status>freebsd-wip-status</a></dt><dd><p><em>FreeBSD Werk-In-Uitvoering status</em></p><div class=paragraph><p>Deze mailinglijst kan gebruikt worden om de schepping en voortgang van uw FreeBSD-gerelateerd werk aan te kondigen. Berichten zullen gemodereerd worden. Het wordt gesuggereerd om het bericht "Aan:" een FreeBSD-mailinglijst dat het onderwerp beter dekt te sturen en deze lijst alleen te "BCC:"-en. Op deze manier kan uw werk-in-uitvoering ook op de onderwerpslijst worden bediscussieerd, aangezien discussies op deze lijst niet zijn toegestaan.</p></div><div class=paragraph><p>Kijk in de archieven voor voorbeelden van geschikte berichten.</p></div><div class=paragraph><p>Een redactioneel overzicht van de berichten aan deze lijst kan om de paar maanden naar de FreeBSD-website gezonden worden als deel van de Status Reports . Meer voorbeelden en oude rapportages zijn daar ook te vinden.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-wireless>freebsd-wireless</a></dt><dd><p><em>Discussies over de 802.11-stack, de ontwikkeling van gereedschappen voor stuurprogramma’s</em></p><div class=paragraph><p>De FreeBSD-wireless lijst richt zich op de 802.11-stack (sys/net80211) en de ontwikkeling van stuurprogramma’s en gereedschappen. Dit omvat bugs, nieuwe eigenschappen en onderhoud.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-xen>freebsd-xen</a></dt><dd><p><em>Discussies over het porteren van FreeBSD naar Xen™ - implementatie en gebruik</em></p><div class=paragraph><p>Een lijst die zich richt op de FreeBSD Xen™ port. De verwachte hoeveelheid verkeer is laag genoeg zodat het voor zowel technische discussies over de implementatie- en ontwerpdetails als voor zaken over administratief gebruik bedoeld is.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-xfce>freebsd-xfce</a></dt><dd><p><em>XFCE</em></p><div class=paragraph><p>Dit is een forum voor discussies gerelateerd aan de XFCE-omgeving voor FreeBSD. Dit is een technische mailinglijst. Het is bedoeld voor degenen die actief werken aan het porten van XFCE naar FreeBSD, om problemen naar voren te brengen of alternatieve oplossingen te bespreken. Personen die geïnteresseerd zijn in het volgen van de technische discussie zijn ook welkom.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-zope>freebsd-zope</a></dt><dd><p><em>Zope</em></p><div class=paragraph><p>Dit is een forum voor discussies die verwant zijn aan het brengen van de Zope-omgeving naar FreeBSD. Dit is een technische mailinglijst. Het is bedoeld voor individuen die actief werken aan het overbrengen van Zope naar FreeBSD, om problemen aan te dragen of alternatieve oplossingen te bespreken. Individuen die geïnteresseerd zijn in het volgen van de technische discussie zijn ook welkom.</p></div></dd></dl></div></div><div class=sect3><h4 id=eresources-mailfiltering>C.1.4. Filters op de mailinglijsten<a class=anchor href=#eresources-mailfiltering></a></h4><div class=paragraph><p>De FreeBSD-mailinglijsten worden op verschillende manieren gefilterd om het doorsturen van spam, virussen, en andere ongewenste email te beperken. De hieronder beschreven filteracties bevatten niet alle genomen acties voor de beveiliging van de mailinglijsten.</p></div><div class=paragraph><p>Er is een beperkt aantal typen bijlagen toegestaan op de mailinglijsten. Alle bijlagen met een MIME-inhoudtype dat niet in de onderstaande lijst staat worden verwijderd voordat de mail wordt doorgestuurd naar de mailinglijsten.</p></div><div class=ulist><ul><li><p>application/octet-stream</p></li><li><p>application/pdf</p></li><li><p>application/pgp-signature</p></li><li><p>application/x-pkcs7-signature</p></li><li><p>message/rfc822</p></li><li><p>multipart/alternative</p></li><li><p>multipart/related</p></li><li><p>multipart/signed</p></li><li><p>text/html</p></li><li><p>text/plain</p></li><li><p>text/x-diff</p></li><li><p>text/x-patch</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sommige mailinglijsten staan wellicht bijlagen toe met andere MIME-inhoudtypen, maar de bovenstaande lijst zal gelden voor de meeste mailinglijsten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als een email zowel een HTML- als een platte tekstversie bevat, dan wordt de HTML-versie verwijderd. Als een mail alleen een HTML-versie bevat, dan wordt die omgezet naar platte tekst.</p></div></div></div><div class=sect2><h3 id=eresources-news>C.2. Usenet-nieuwsgroepen<a class=anchor href=#eresources-news></a></h3><div class=paragraph><p>Naast de twee specifieke FreeBSD-nieuwsgroepen zijn er nog vele andere waarin FreeBSD wordt besproken of die anderszins relevant zijn voor gebruikers van FreeBSD.</p></div><div class=sect3><h4 id=_specifieke_bsd_nieuwsgroepen>C.2.1. Specifieke BSD nieuwsgroepen<a class=anchor href=#_specifieke_bsd_nieuwsgroepen></a></h4><div class=ulist><ul><li><p><a href=news:comp.unix.bsd.freebsd.announce>comp.unix.bsd.freebsd.announce</a></p></li><li><p><a href=news:comp.unix.bsd.freebsd.misc>comp.unix.bsd.freebsd.misc</a></p></li><li><p><a href=news:de.comp.os.unix.bsd>de.comp.os.unix.bsd</a> (Duits)</p></li><li><p><a href=news:fr.comp.os.bsd>fr.comp.os.bsd</a> (Frans)</p></li><li><p><a href=news:it.comp.os.freebsd>it.comp.os.freebsd</a> (Italiaans)</p></li></ul></div></div><div class=sect3><h4 id=_overige_interessante_unix_nieuwsgroepen>C.2.2. Overige interessante UNIX®-nieuwsgroepen<a class=anchor href=#_overige_interessante_unix_nieuwsgroepen></a></h4><div class=ulist><ul><li><p><a href=news:comp.unix>comp.unix</a></p></li><li><p><a href=news:comp.unix.questions>comp.unix.questions</a></p></li><li><p><a href=news:comp.unix.admin>comp.unix.admin</a></p></li><li><p><a href=news:comp.unix.programmer>comp.unix.programmer</a></p></li><li><p><a href=news:comp.unix.shell>comp.unix.shell</a></p></li><li><p><a href=news:comp.unix.user-friendly>comp.unix.user-friendly</a></p></li><li><p><a href=news:comp.security.unix>comp.security.unix</a></p></li><li><p><a href=news:comp.sources.unix>comp.sources.unix</a></p></li><li><p><a href=news:comp.unix.advocacy>comp.unix.advocacy</a></p></li><li><p><a href=news:comp.unix.misc>comp.unix.misc</a></p></li><li><p><a href=news:comp.unix.bsd>comp.unix.bsd</a></p></li></ul></div></div><div class=sect3><h4 id=_x_window_systeem>C.2.3. X Window systeem<a class=anchor href=#_x_window_systeem></a></h4><div class=ulist><ul><li><p><a href=news:comp.windows.x.i386unix>comp.windows.x.i386unix</a></p></li><li><p><a href=news:comp.windows.x>comp.windows.x</a></p></li><li><p><a href=news:comp.windows.x.apps>comp.windows.x.apps</a></p></li><li><p><a href=news:comp.windows.x.announce>comp.windows.x.announce</a></p></li><li><p><a href=news:comp.windows.x.intrinsics>comp.windows.x.intrinsics</a></p></li><li><p><a href=news:comp.windows.x.motif>comp.windows.x.motif</a></p></li><li><p><a href=news:comp.windows.x.pex>comp.windows.x.pex</a></p></li><li><p><a href=news:comp.emulators.ms-windows.wine>comp.emulators.ms-windows.wine</a></p></li></ul></div></div></div><div class=sect2><h3 id=eresources-web>C.3. World wide webservers<a class=anchor href=#eresources-web></a></h3><div class=sect3><h4 id=eresources-web-social>C.3.1. Fora, blogs, en sociale netwerken<a class=anchor href=#eresources-web-social></a></h4><div class=ulist><ul><li><p><a href=http://forums.freebsd.org/>The FreeBSD Forums</a> bieden een webgebaseerd discussieforum voor vragen en technische discussies over FreeBSD.</p></li><li><p><a href=http://planet.freebsdish.org/>Planet FreeBSD</a> biedt een samengestelde feed van tientallen blogs geschreven door FreeBSD-ontwikkelaars. Vele ontwikkelaars gebruiken dit om korte notities te posten over waaraan ze werken, nieuwe patches, en ander werk in uitvoering.</p></li><li><p>Het <a href=http://www.youtube.com/bsdconferences>BSDConferences YouTube Channel</a> biedt een verzameling van video’s van hoge kwaliteit van wereldwijde BSD-conferenties. Dit is een prima manier om presentaties van hoofdontwikkelaars over nieuw werk in FreeBSD te zien.</p></li></ul></div></div><div class=sect3><h4 id=eresources-web-mirrors>C.3.2. Officiële spiegels<a class=anchor href=#eresources-web-mirrors></a></h4><div class=paragraph><p><a href=#central-mirrors>Central Servers</a>, <a href=#armenia-mirrors>Armenia</a>, <a href=#australia-mirrors>Australia</a>, <a href=#austria-mirrors>Austria</a>, <a href=#czech-republic-mirrors>Czech Republic</a>, <a href=#denmark-mirrors>Denmark</a>, <a href=#finland-mirrors>Finland</a>, <a href=#france-mirrors>France</a>, <a href=#germany-mirrors>Germany</a>, <a href=#hong-kong-mirrors>Hong Kong</a>, <a href=#ireland-mirrors>Ireland</a>, <a href=#japan-mirrors>Japan</a>, <a href=#latvia-mirrors>Latvia</a>, <a href=#lithuania-mirrors>Lithuania</a>, <a href=#netherlands-mirrors>Netherlands</a>, <a href=#norway-mirrors>Norway</a>, <a href=#russia-mirrors>Russia</a>, <a href=#slovenia-mirrors>Slovenia</a>, <a href=#south-africa-mirrors>South Africa</a>, <a href=#spain-mirrors>Spain</a>, <a href=#sweden-mirrors>Sweden</a>, <a href=#switzerland-mirrors>Switzerland</a>, <a href=#taiwan-mirrors>Taiwan</a>, <a href=#uk-mirrors>United Kingdom</a>, <a href=#usa-mirrors>United States of America</a>.</p></div><div class=paragraph><p>(as of UTC)</p></div><div id=central-mirrors class=paragraph><p><strong>Central Servers</strong></p></div><div class=ulist><ul><li><p><a href=https://www.FreeBSD.org/ class=bare>https://www.FreeBSD.org/</a></p></li></ul></div><div id=armenia-mirrors class=paragraph><p><strong>Armenia</strong></p></div><div class=ulist><ul><li><p><a href=http://www.at.FreeBSD.org/ class=bare>http://www.at.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=australia-mirrors class=paragraph><p><strong>Australia</strong></p></div><div class=ulist><ul><li><p><a href=http://www.au.FreeBSD.org/ class=bare>http://www.au.FreeBSD.org/</a></p></li><li><p><a href=http://www2.au.FreeBSD.org/ class=bare>http://www2.au.FreeBSD.org/</a></p></li></ul></div><div id=austria-mirrors class=paragraph><p><strong>Austria</strong></p></div><div class=ulist><ul><li><p><a href=http://www.at.FreeBSD.org/ class=bare>http://www.at.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=czech-republic-mirrors class=paragraph><p><strong>Czech Republic</strong></p></div><div class=ulist><ul><li><p><a href=http://www.cz.FreeBSD.org/ class=bare>http://www.cz.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=denmark-mirrors class=paragraph><p><strong>Denmark</strong></p></div><div class=ulist><ul><li><p><a href=http://www.dk.FreeBSD.org/ class=bare>http://www.dk.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=finland-mirrors class=paragraph><p><strong>Finland</strong></p></div><div class=ulist><ul><li><p><a href=http://www.fi.FreeBSD.org/ class=bare>http://www.fi.FreeBSD.org/</a></p></li></ul></div><div id=france-mirrors class=paragraph><p><strong>France</strong></p></div><div class=ulist><ul><li><p><a href=http://www1.fr.FreeBSD.org/ class=bare>http://www1.fr.FreeBSD.org/</a></p></li></ul></div><div id=germany-mirrors class=paragraph><p><strong>Germany</strong></p></div><div class=ulist><ul><li><p><a href=http://www.de.FreeBSD.org/ class=bare>http://www.de.FreeBSD.org/</a></p></li></ul></div><div id=hong-kong-mirrors class=paragraph><p><strong>Hong Kong</strong></p></div><div class=ulist><ul><li><p><a href=http://www.hk.FreeBSD.org/ class=bare>http://www.hk.FreeBSD.org/</a></p></li></ul></div><div id=ireland-mirrors class=paragraph><p><strong>Ireland</strong></p></div><div class=ulist><ul><li><p><a href=http://www.ie.FreeBSD.org/ class=bare>http://www.ie.FreeBSD.org/</a></p></li></ul></div><div id=japan-mirrors class=paragraph><p><strong>Japan</strong></p></div><div class=ulist><ul><li><p><a href=http://www.jp.FreeBSD.org/www.FreeBSD.org/ class=bare>http://www.jp.FreeBSD.org/www.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=latvia-mirrors class=paragraph><p><strong>Latvia</strong></p></div><div class=ulist><ul><li><p><a href=http://www.lv.FreeBSD.org/ class=bare>http://www.lv.FreeBSD.org/</a></p></li></ul></div><div id=lithuania-mirrors class=paragraph><p><strong>Lithuania</strong></p></div><div class=ulist><ul><li><p><a href=http://www.lt.FreeBSD.org/ class=bare>http://www.lt.FreeBSD.org/</a></p></li></ul></div><div id=netherlands-mirrors class=paragraph><p><strong>Netherlands</strong></p></div><div class=ulist><ul><li><p><a href=http://www.nl.FreeBSD.org/ class=bare>http://www.nl.FreeBSD.org/</a></p></li></ul></div><div id=norway-mirrors class=paragraph><p><strong>Norway</strong></p></div><div class=ulist><ul><li><p><a href=http://www.no.FreeBSD.org/ class=bare>http://www.no.FreeBSD.org/</a></p></li></ul></div><div id=russia-mirrors class=paragraph><p><strong>Russia</strong></p></div><div class=ulist><ul><li><p><a href=http://www.ru.FreeBSD.org/ class=bare>http://www.ru.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=slovenia-mirrors class=paragraph><p><strong>Slovenia</strong></p></div><div class=ulist><ul><li><p><a href=http://www.si.FreeBSD.org/ class=bare>http://www.si.FreeBSD.org/</a></p></li></ul></div><div id=south-africa-mirrors class=paragraph><p><strong>South Africa</strong></p></div><div class=ulist><ul><li><p><a href=http://www.za.FreeBSD.org/ class=bare>http://www.za.FreeBSD.org/</a></p></li></ul></div><div id=spain-mirrors class=paragraph><p><strong>Spain</strong></p></div><div class=ulist><ul><li><p><a href=http://www.es.FreeBSD.org/ class=bare>http://www.es.FreeBSD.org/</a></p></li><li><p><a href=http://www2.es.FreeBSD.org/ class=bare>http://www2.es.FreeBSD.org/</a></p></li></ul></div><div id=sweden-mirrors class=paragraph><p><strong>Sweden</strong></p></div><div class=ulist><ul><li><p><a href=http://www.se.FreeBSD.org/ class=bare>http://www.se.FreeBSD.org/</a></p></li></ul></div><div id=switzerland-mirrors class=paragraph><p><strong>Switzerland</strong></p></div><div class=ulist><ul><li><p><a href=http://www.ch.FreeBSD.org/ class=bare>http://www.ch.FreeBSD.org/</a> (IPv6)</p></li><li><p><a href=http://www2.ch.FreeBSD.org/ class=bare>http://www2.ch.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=taiwan-mirrors class=paragraph><p><strong>Taiwan</strong></p></div><div class=ulist><ul><li><p><a href=http://www.tw.FreeBSD.org/ class=bare>http://www.tw.FreeBSD.org/</a></p></li><li><p><a href=http://www2.tw.FreeBSD.org/ class=bare>http://www2.tw.FreeBSD.org/</a></p></li><li><p><a href=http://www4.tw.FreeBSD.org/ class=bare>http://www4.tw.FreeBSD.org/</a></p></li><li><p><a href=http://www5.tw.FreeBSD.org/ class=bare>http://www5.tw.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=uk-mirrors class=paragraph><p><strong>United Kingdom</strong></p></div><div class=ulist><ul><li><p><a href=http://www1.uk.FreeBSD.org class=bare>http://www1.uk.FreeBSD.org</a></p></li><li><p><a href=http://www3.uk.FreeBSD.org/ class=bare>http://www3.uk.FreeBSD.org/</a></p></li></ul></div><div id=usa-mirrors class=paragraph><p><strong>United States of America</strong></p></div><div class=ulist><ul><li><p><a href=http://www5.us.FreeBSD.org/ class=bare>http://www5.us.FreeBSD.org/</a> (IPv6)</p></li></ul></div></div></div><div class=sect2><h3 id=eresources-email>C.4. Email-adressen<a class=anchor href=#eresources-email></a></h3><div class=paragraph><p>De onderstaande gebruikersgroepen bieden FreeBSD-gerelateerde email-adressen aan voor hun leden. De aangegeven beheerders behouden zich het recht voor om een account te verwijderen als die op enigerlei wijze wordt misbruikt.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Domein</th><th class="tableblock halign-left valign-top">Faciliteiten</th><th class="tableblock halign-left valign-top">Gebruikersgroep</th><th class="tableblock halign-left valign-top">Beheerder</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ukug.uk.FreeBSD.org</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alleen forwarden</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=mailto:ukfreebsd@uk.FreeBSD.org>ukfreebsd@uk.FreeBSD.org</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lee Johnston <a href=mailto:lee@uk.FreeBSD.org>lee@uk.FreeBSD.org</a></p></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=pgpkeys>Bijlage D: PGP sleutels<a class=anchor href=#pgpkeys></a></h2><div class=sectionbody><div class=paragraph><p>In het geval een handtekening van een van de beambten of ontwikkelaars gecontroleerd moet worden of er een versleutelde e-mail aan ze gezonden moet worden, worden hier voor het gemak een aantal sleutels weergegeven. Een complete sleutelring van <code>FreeBSD.org</code> gebruikers kan op de volgende link gedownload worden: <a href=https://docs.FreeBSD.org/pgpkeys/pgpkeys.txt>pgpkeyring.txt</a>.</p></div><div class=sect2><h3 id=pgpkeys-officers>D.1. Beambten<a class=anchor href=#pgpkeys-officers></a></h3><div class=sect3><h4 id=_beveiligingsbeambtenteam_security_officerfreebsd_org>D.1.1. Beveiligingsbeambtenteam <code>&lt;<a href=mailto:security-officer@FreeBSD.org>security-officer@FreeBSD.org</a>></code><a class=anchor href=#_beveiligingsbeambtenteam_security_officerfreebsd_org></a></h4><div class="literalblock literal-block-margin"><div class=content><pre>pub   rsa4096/D9AD2A18057474CB 2022-12-11 [C] [expires: 2026-01-24]
      Key fingerprint = 0BE3 3275 D74C 953C 79F8  1107 D9AD 2A18 0574 74CB
uid                            FreeBSD Security Officer &lt;security-officer@freebsd.org&gt;
sub   rsa4096/6E58DE901F001AEF 2022-12-11 [S] [expires: 2025-01-15]
sub   rsa4096/46DB26D62F6039B7 2022-12-11 [E] [expires: 2025-01-15]</pre></div></div><div class="literalblock literal-block-margin"><div class=content><pre>-----BEGIN PGP PUBLIC KEY BLOCK-----

mQINBGOVdeUBEADHF5VGg1iPbACB+7lomX6aDytUf0k2k2Yc/Kp6lfYv7JKU+1nr
TcNF7Gt1YkajPSeWRKNZw/X94g4w5TEOHbJ6QQWx9g+N7RjEq75actQ/r2N5zY4S
ujfFTepbvgR55mLTxlxGKFBmNrfNbpHRyh4GwFRgPlxf5Jy9SB+0m54yFS4QlSd0
pIzO0CLkjHUFy/8S93oSK2zUkgok5gLWruBXom+8VC3OtBElkWswPkE1pKZvMQCv
VyM+7BS+MCFXSdZczDZZoEzpQJGhUYFsdg0KqlLv6z1rP+HsgUYKTkRpcrumDQV0
MMuCE4ECU6nFDDTnbR8Wn3LF5oTt0GtwS0nWf+nZ1SFTDURcSPR4Lp/PKjuDAkOS
P8BaruCNx1ItHSwcnXw0gS4+h8FjtWNZpsawtzjjgApcl+m9KP6dkBcbN+i1DHm6
NG6YQVtVWyN8aOKmoC/FEm1CWh1bv+ri9XOkF2EqT/ktbjbT1hFoFGBkS9/35y1G
3KKyWtwKcyF4OXcArl6sQwGgiYnZEG3sUMaGrwQovRtMf7le3cAYsMkXyiAnEufa
deuabYLD8qp9L/eNo+9aZmhJqQg4EQb+ePH7bGPNDZ+M5oGUwReX857FoWaPhs4L
dAKQ1YwASxdKKh8wnaamjIeZSGP5TCjurH7pADAIaB3/D+ZNl2a7od+C1wARAQAB
tDdGcmVlQlNEIFNlY3VyaXR5IE9mZmljZXIgPHNlY3VyaXR5LW9mZmljZXJAZnJl
ZWJzZC5vcmc+iQJSBBMBCgA8AhsBBAsJCAcEFQoJCAUWAgMBAAIeBQIXgBYhBAvj
MnXXTJU8efgRB9mtKhgFdHTLBQJjlXeQBQkF3u+rAAoJENmtKhgFdHTLOVoQALS3
cj7rqYkHiV4zDYrgPEp9O1kAyGI8VdfGAMkDVTqr+wP4v/o7LIUrgwZl5qxesVFB
VknFr0Wp5g9h0iAjasoI5sDd6tH2SmumhBHXFVdftzDQhrugxH6fWRhHs0SaFYCk
Qt5nFbcpUfWgtQ35XTbsL8iENdYpjKXsSFQrJneGSwxIjWYTFn6ps/AI3gwR8+Bn
OffEFdYugJ049O6Vu6YBFJHrnMO7NbF4v95dVYuLtpMIaXWM+V9KITmhaBzFz5fM
Q7UOzcLlbxOYKNIWcp8QQk429mayKW5VUeUExUD1ZzBHn+P6ZG7QTMDu/RmBqiHo
ewCMVz4n9uXT5BiOngE4CvS0WQwHzK+k9MLpG2u/Bo9+LT0Ceh9Ou1rfU5+0tRwl
GyOFFjf3INS7I7gkcAwxQ7dzDItN/UQPZpg8y9mABU2x4enz0AvTnb61d/1dnTEr
tdNgU433he0ZnD1HurZCjBEWC656wv6iMdWcD8gjhMbmEpPmjvXcYlTO6zhEygSM
DiwdQCWK2W4++YJerA6ULBi3niNWBpofOFH8XylV56ruhjtHCo7+/3carcMoPOJv
lVZ1zCKxLro3TRBT15JTFBGqblRyTopFK3PuxW//GTnZOtpQEOV6yL4RAXcWeC1d
1hb5k/YxUmRF6XsDNEH4b08T8ZO8dV3dAV43Wh1oiQEzBBABCAAdFiEEuyjUCzYO
7pNq7RVv5fe8y6O93fgFAmObXVYACgkQ5fe8y6O93fiBlwf/W8y1XXJIx1ZA3n6u
f7aS70rbP9KFPr4U0dixwKE/gbtIQ9ckeNXrDDWz0v0NCz4qS+33IPiJg1WcY3vR
W90e7QgAueCo5TdZPImPbCs42vadpa5byMXS4Pw+xyT+d/yp2oLKYbj3En4bg1GM
w71DezIjvV+e01UR++u1t9yZ8LOWM5Kumz1zyQLZDZ8qIKt1bBfpa+E0cEqtNQWu
iGhQE3AHI8eWV+jBkg5y2zHRIevbWb1UPsj43lgkFtAGHk9rrM8Rmgr4AXr531iD
srBwauKZ/MElcF3MINuLH+gkPPaFHw/YIpLRLaZXZVsw3Xi1RNXI2n2ea29dvs/C
Lcf1vYkCMwQQAQgAHRYhBPwOh4rlr+eIAo1jVdOXkvSep+XCBQJjm14FAAoJENOX
kvSep+XC0DcP/1ZB7k9p1T+9QbbZZE1PJiHby3815ccH3XKexbNmmakHIn3L6Cet
F891Kqt9ssbhFRMNtyZ/k/8y8Hv5bKxVep5/HMyK+8aqfDFN0WMrqZh0/CiR6DJh
gnAmPNw/hAVHMHaYGII9kCrFfPFJ02FKoc81g9F08odb7TV+UlvRjkErhRxF+dGS
wQoO0RCbf0Z1cs7nd0Vb2z4IJh4XMxBjWc/uQ2Q9dH/0uRzwpAnR4YX+MG5YrX7Z
zBvDyR0r76iQwRSDKgioNgkr6R3rq1NZGdaj+8b0LzdOqtzKJ/eupDe3+H67e/EN
qymtreGjrubpiU9bKvYArisUqhE5KtguryvR6Qz9bj87nPg33DT3WWGVrwFRxBox
dbWzjQFv0wug8m4GAwVF7fPR5/eW7IHw8zvgn0vSPcZz7MZ4e6Y5jN4kA5/xWJYZ
Sps54qQWB+FA30unIXN68KqdIzONIbtaY3W4/JjJUCm4T+wEjKaH+wJX8w1DMjlg
mkTmGh/UrTyC1vXbPgk9Sy3cRTICR1T9z7W8UlmTtnKrUklrjlFR7SXzrEXzLGOX
Fm+NEHpHNXqzcm6c3QfzY/yQ9HSAQ/t7SUQ9caRePbDz3/msyPxtGFor9roQv6VN
wRXCyRgkH4Y5tPhJAQ8G/FxX+VXFb93QL0lfelb23/BBu6cUwW63SRn5uQINBGOV
dskBEADqo8z6TFAhrvHhJV5wHdj67guoYvpXP8gvdCqos8SLluqi0AWgJEwlqu7L
mKQ6qMoJ+2DN6y+dEtvOVgBAgF63LLf3FQKq9FB/3uqeIiQlCIl3H43f8KttEZzf
/lbry4Y6QhS2OXM31Ut9Q+1IfTGwvs1E8/J1U4jQrAGqNKknXyQyMweJ0jvvcSLJ
nv3S7COUJVOT3cTgVeh3RIQlFzqK2rSQmygDpS8bT8MjCsZr+KGezKpbddKXio4a
QW/e6nCMyYR8bo0GQ9DpsyAOsaENnkghncQhA7GdPZK9xLMNQMCp0OdcZlqRVjRZ
OutuzNW6PPoczs/NQq02YWK4BPtSV7+ldS9gPZTLIpnRNQRzcnA0vnQTqSAfasVw
sAGm+MpH7zcaMf2Tw1K08u7+5gyObgzUzQmGLCgo9VIncnDis0s4gfTmtrr5jCeV
7LYDQX+2fApMtXbVXeKJem1PS+Z6LPbW2HklxYuG5nFgewCYlQjKujfiwW1Clhi4
JQeE1Naobbaar99V/VeoHrOYAEWP0bkUyrFcocLJ+0g3KpjSkctIptgGGpMBKe4U
9O7pWoTki8Yz/uYQn/p0iZcG8SfKM8I4283jdsi5SUiNNJJZCBQTVA7d8MxUVv5+
qpX/v5XqYM3pHza2DLXzwfAE9O2dgN1OMZYIld+OnWcpm2PxIwARAQABiQRyBBgB
CgAmFiEEC+MydddMlTx5+BEH2a0qGAV0dMsFAmOVdskCGwIFCQICKQACQAkQ2a0q
GAV0dMvBdCAEGQEKAB0WIQS2FSd+gQh991yBgztuWN6QHwAa7wUCY5V2yQAKCRBu
WN6QHwAa77gbEADpUBT14cesITuMsOWYsyEtNmB4UlTFWCktk/YzyCotasZxIhMP
Xih9G1tDo9ExIWT8jNjSSA+w0Viua/PirDLvI8JtX1JiK3nwMenwlXwlkRAk9TJW
y944YegHF/5ytntwZ/L4BMYc3MztyZbw+sDwnNBZKYmO8gwfYobtfoGxOR4Onb37
bbUVw62xHQIn2zafSmMQ4oMXZTm9EteIYwgcrC1h+Urv5IXCJZHrqmXCPE5g5XZ1
G9jqkwlaRYWjcLD0qxwc5m9LNrF6OBS9N6S7DncIYt9VupI5OCr1uRSqzqaBMFDC
lTTH+dAx3b6J1KFB0UiHP3FeTalFh8L3NE+dN9apNAgkUWv/v4oo/6dkRu3NZse2
RAo/o2X5r40qk/lhydQRZTSTFsiuH3VUWVsgmqAHnHW7pMMw8FAlKhyRSFnhbW7r
e0jj8XMIO7G5yjQKQCnYuPdXbx++bP1PzsEWDv9j/sph5arcosdo6tEXklWHED17
MEPIton1+NRfsU0peEVggQXlwdTcZN/h7FeCZ56dcwCWdCpSlv6CcWzRXSNUyJpK
a9qfIqBX/monjy7w5IHmhvLwAYI6IoT11h1QDEfGfhrwWPwOjnXsaYm5E7wv8w69
PxMbOJbMpWSg8L7xW3LXKR1VwXggUC1+b3y67E5Ggi1hf0lfTnTMpL2ClO2QD/oC
hMIafhzxbjh2WzgYahVHZH3gpHc1/0Bnc07s9+Pa6EYYM9r0XzezLW7bswOjVloR
FreQ3FIF/2OSN0OGdm7dyYl0OliTIDDDlwK/l8bcckUcpHNR1dw0P3KvDlmLmzZy
G4HmzzSBa9jiFirEfcg2rnGc6Zi382jGVALuYVplPXyMOUiChp0AAQZzTIYpXw/g
pBE6em2k740yuK6WqG4yXXgk67FoH10TQvMd4Q73K4zw+9DMpThlUHcfBmAoViZw
il7C0xl+ysHX8ZI3JU8s1r3XAnpqdHi4Wpixm/ctXbVnTSA3FQr2SctJYqR1VHRW
GMW+Ii2SQDS+t9bZTzOgAPLDtfy+JqhBpwCB1a1EHftkJEojpfZipaYGkf3yc+vN
wUeUHp/csF9CT7Qbqaj1t7fVWzv7jcVKpRwngIT4vTSzqbo6WC34FuUAH0t7tJ5K
eZ625AqEFLmtqtDo+ydJhZrVrXBNXPfkx5hSVW/I9hvckMNwA3t0KfQC2sz+Z1Q1
a4vDWQYRytfyrgZkWGbXMn6l1JyqIolgJZuax2kYs7Vu3t8KptqCbv0ZBAGoMm7r
RLgVodhI9voA8YxCirSChrueJYn+JKk8MIyk3DdXpBoocMIAjFJAUgXjV5NQpZMy
xR8BEiQnBcHRIKVWEEyhbLtHpmCEsnKNyKVGoxs31IkEcgQYAQoAJgIbAhYhBAvj
MnXXTJU8efgRB9mtKhgFdHTLBQJlhctvBQkD8n2mAkDBdCAEGQEKAB0WIQS2FSd+
gQh991yBgztuWN6QHwAa7wUCY5V2yQAKCRBuWN6QHwAa77gbEADpUBT14cesITuM
sOWYsyEtNmB4UlTFWCktk/YzyCotasZxIhMPXih9G1tDo9ExIWT8jNjSSA+w0Viu
a/PirDLvI8JtX1JiK3nwMenwlXwlkRAk9TJWy944YegHF/5ytntwZ/L4BMYc3Mzt
yZbw+sDwnNBZKYmO8gwfYobtfoGxOR4Onb37bbUVw62xHQIn2zafSmMQ4oMXZTm9
EteIYwgcrC1h+Urv5IXCJZHrqmXCPE5g5XZ1G9jqkwlaRYWjcLD0qxwc5m9LNrF6
OBS9N6S7DncIYt9VupI5OCr1uRSqzqaBMFDClTTH+dAx3b6J1KFB0UiHP3FeTalF
h8L3NE+dN9apNAgkUWv/v4oo/6dkRu3NZse2RAo/o2X5r40qk/lhydQRZTSTFsiu
H3VUWVsgmqAHnHW7pMMw8FAlKhyRSFnhbW7re0jj8XMIO7G5yjQKQCnYuPdXbx++
bP1PzsEWDv9j/sph5arcosdo6tEXklWHED17MEPIton1+NRfsU0peEVggQXlwdTc
ZN/h7FeCZ56dcwCWdCpSlv6CcWzRXSNUyJpKa9qfIqBX/monjy7w5IHmhvLwAYI6
IoT11h1QDEfGfhrwWPwOjnXsaYm5E7wv8w69PxMbOJbMpWSg8L7xW3LXKR1VwXgg
UC1+b3y67E5Ggi1hf0lfTnTMpL2ClAkQ2a0qGAV0dMsjqhAAorQ725G342raJ+os
6+E/EFNsr4SR5H+AeinlQ2ymNSeO/ODsV6dmyYD3hed0mAXvIJt2B46fFC4eAP9f
VOIbMMhPMpnJuZyLPDi8gXcZLgWSRhJ88R98KIsmKlh+/fdZM4RI1JLjICi7kyNR
4jtKCzLj0DYVBzp1mn0lTwtFzv7SC9djpqFLnO5YoGPWfQHHhY02Trh2posRwAHO
oacXSFvsoQv6k6XNlStJ4lnrkH6t+Od4kU3/TJ0eQXs7Zd2WEVnMe1IhbihsGcAY
mzZzZlLOhskHCeVE2taHiXC6h4tC3/69I16N8ICauxGY41clPhiNmVaAzmkunOPz
ry5utl6HkpZ5/3UMVHI1JIvsfJW+vSMUhdcQILAv6DbRWWHeax3ZZ6iAVGCtJS7U
glwZM1Xor0okGtIS+aJ/Cw7tZ8Nm18lutcrf2MVW+BWpzMQKnWFQYTn1NEWjzYnx
9Na22+E8AvW02TdS0NSiP0sG/0q7lBNEck9vH4WEbbEXktj51Dg4ISUhQyW8BWwW
X+kSiNeqtcaikUb8SFj5vpTDotTSzikfT/jisvR5goTMNFCVHFZdXCdsbUZd8Iub
egAOh6Db/06y3mFYDEfcGJipab400OY03a2xw9Vz+YxrKfELCTBo2tZv+3K8kXgq
XFcbyJnkXmjnYM/sw5kKqtzuc7i5Ag0EY5V3BwEQAMpFVczZo9ZPNsgW791UW5o6
wnrnd1nIO+S4rc37q2TEz8KGHCuxo5NwffZ2t6Ln04BI54pbapg17b7a0hPka37H
FkL28n4VyMdx0CsAm3QEfUsdK6xwKV2SucYeVcrV1upcN4PdXD7su1I7/A4CWXFJ
G047zJ0Z89lJZiQEiAq7ghvEoinC0sm+0a6ao/ocqCgWCKM1yCPOyzJXleRrv29S
RnYziMR+q2U0x9xg9Xl6GMwUmFwbJc9nORVvLH7fbU6/du8EgoAYrglFOFZG/TSo
lSGWRSMiavz0JSD/i+rEN4aIT4WfBe+L9Wy1AmrNxiAO+zKmzHQu3JSxDncr+y+h
cd+W0gqw10FoI9jWLcL7kR+6a0iOjuJSXSopq2l3DafiPxtCFmr4CGQhzBHM6e4/
v/NNd3F0XpVbJ6RQph7lkfvfz8q2lvUlHhezJ0p1xXmhff9CHjdVMhmAmz5+imBA
Xk2mottNfKb0pFEen1xY3K/UPA4g+oPsSj495MsvIg9eIMCcC3/z0SEUMWH/styy
JzPqfpyfGwZeTcIj9vg2o+RnGvmcLVYA/EGToPk905kv/cK73oy8bZyOB0zMg7T9
PaWgLUO0sqjqo0Mw3knFySg3oRXlcilPQvfPdX0JvwLpc9DWlr1+1GkCXJ08lWug
Jc96CJQupKRb1IbC0oUXABEBAAGJAjwEGAEKACYWIQQL4zJ110yVPHn4EQfZrSoY
BXR0ywUCY5V3BwIbDAUJAgIpAAAKCRDZrSoYBXR0ywwtD/wIDmEcHdFlyFRTomUB
jbeK2uzcZIhkkgL58lc63UPle5iJ2FBvmYS+0rQS53sVEsccn5KfkOwTryKllvWb
l0IzuiqfawxALcfWpfZJHzTMSnDHfgXvOOyFMQruqRDAHAr7PNC0CnbT0sEF2ZFz
ad8M9fLqtkXUx4mgECNGJ4CVqg75KY8uUzv/BmRwEf587FT5/iAIed5MjFB2VFDX
9GABcvTTbHxCZIxnxl3cs15SxT0lAofZ2ueU6kWYWZSXFeaEM/4ymPJws2mmV0Ak
bJghLXCn9Mx3nX6NTZZ9Harbru+RzW3/Hg3DZd0J9vko8PafP0l1NWtgyX74CqvT
gjzTxXTnqrRXzcczK7fhcC2u4i0prPtXXcyyi7SwpoLikaZCLFFhUmOx+mS5Tjtg
FyFZBNxnO7iAwkzfcTcC9sPoWaFmiQf6q5EIYzG+WQpncj80mxl3HWOP6oFj/hZJ
RYseKeMkvJzLTo87rFdM6CsMrLwETR6e+aWM0btPFil1rXVACNOjsy0bxTV8OJEf
yxnYmyjvnBvB0kdiaVEDdVhxgSqzLAX4mgXa49/V6M/uzMr+n3/A1Jdk4V6fVm8S
5cFIXxoUat3cB4xGaT9OWD3o1NPr6eS9Vo0EsJlRl81SG68fS+Qtk2fX27T68YG4
Aa3zMfZxUsVuFLtTuQbRC+fJpIkCPAQYAQoAJgIbDBYhBAvjMnXXTJU8efgRB9mt
KhgFdHTLBQJlhcuqBQkD8n1oAAoJENmtKhgFdHTLoO0QAJsTE9fkleb7YzPEuP9G
J3jx8PGdWm7n+8UNdr24kS6gOXVUfPZrWa5So21hcIwZb4PZDqHSVSQnRciKhSnG
7gplYPNGZ4+FWbLr/mBRYarjkVFLUuCPexSIjxV1KSGJnWs9YTVAKZAz75GpCML6
jD6biCOQCQ86wqOdWvZIZR8YvurrxR64ABB0rjbsaG8cNOUX1cwAfdLwthf64dS+
2m3lqNGDHkP5eNL0RIxC5gXYEp0lvmlMH3ZuO5WrfH73PTDg89bxXeuhrFmSEwf4
xWm603oi8/2qQvR9/7jb0o+t71NQuWrWIFONZWWgZBUGso+uyT3XgY4YqKGR3z2Q
zKHYnJ6M7SvSYpqS7RtcxcCXF0HGNfES8cAgtKVpFtbtSwXXp8O8oLyjmVIO/NjU
pbLOGdFIsarsezLFV9f2fqZ63J34hyUSg8LrYVV1fA5DJUpebbX4hLpdk0MMtgG4
3BwKIGlJTpL5RkQ/uQU3YW2kairy7o+1imDD0TRzQxtdjVOI5vnlTNcfJZIIfLx4
drABA12OvpX3dfPV62R+8BAlJFT430CG6AISJIBqJRFvuikmnZGUvEHmOUs/FLbb
aXTPkKc7tR2WIwljRvMV+Qk84cWcX6YchMslMuiDM1mtlQZig34WHGSE+zCWnXAs
lIHlSwox7qfdO0Kz2XncSbIA
=QvUh
-----END PGP PUBLIC KEY BLOCK-----</pre></div></div></div><div class=sect3><h4 id=_secretaris_van_het_core_team_core_secretaryfreebsd_org>D.1.2. Secretaris van het Core Team <code>&lt;<a href=mailto:core-secretary@FreeBSD.org>core-secretary@FreeBSD.org</a>></code><a class=anchor href=#_secretaris_van_het_core_team_core_secretaryfreebsd_org></a></h4><div class="literalblock literal-block-margin"><div class=content><pre>pub   rsa4096/4D632518C3546B05 2024-02-17 [SC] [expires: 2025-02-16]
      Key fingerprint = 1A23 6A92 528D 00DD 7965  76FE 4D63 2518 C354 6B05
uid                            FreeBSD Core Team Secretary &lt;core-secretary@FreeBSD.org&gt;
sub   rsa4096/CABFDE12CA516ED2 2024-02-17 [E] [expires: 2025-02-16]</pre></div></div><div class="literalblock literal-block-margin"><div class=content><pre>-----BEGIN PGP PUBLIC KEY BLOCK-----

mQINBGXQ1o8BEAC+Rcg8cmVxuP17Vu+q5KgCx/XiulQuqKXAqqBlYCH2jqk6DINP
yFrREGBhzd/qNmlAYEahQ4Zgl0bUZNTrZVDyzicOvPP0jH+KSTQwRs7NOawEdlVO
cyHrwDCPEqf5ZzD4NhfTriEOw+j0pEH/onitUGvoQRtx15xWyaJQxDEBMTYMLewE
86D1bltwnTNczE3UZb7oQLJXkAX5hcLtou70XJGgZITvJkK+kp/xot2eFjnqRz/u
WeXnKhYAmC07EKwZ1uw047eHKwMMRBYqzApLwoQtfE430Kxf2q8de64x8zDbi6YM
1J4r8OAxOtHVyfJ0j7Q23DEZz0VVb4b1Tx5OG2Re/KSNvqI0awJO4TcRmOR88OyY
dzyXgnX6Sa7GVQY1FXvn7vtFuDAt7egZOzeomSHL9bdX07LTQ4UtM88EV9wm3q4q
smoatV9jsvPQ1zxCU3aQD/5eWTJH2/kz1LIuBL/Qi5XQpJn91lBtUWJrCgkHWPGu
f//rnnXmsG7DAChW+yZ7cFO8lfNa8sFhPqSxCYphWmJTrvadyQtDngB8JakWdnmK
pfGS6y5lel+181vw38ZZKt04AKM+nDY8051lBM7Q9Q6kTLI33UZeImndx5xYukVD
kV6aQ31HYfEark15c7iEz+OAcwFnM2ntXMt7kKGd40CqzusiPcQkPqPbAQARAQAB
tDhGcmVlQlNEIENvcmUgVGVhbSBTZWNyZXRhcnkgPGNvcmUtc2VjcmV0YXJ5QEZy
ZWVCU0Qub3JnPokCVwQTAQoAQRYhBBojapJSjQDdeWV2/k1jJRjDVGsFBQJl0NaP
AhsDBQkB4TOACAsJDQgMBwsDBRUKCQgLBRYDAgEAAh4FAheAAAoJEE1jJRjDVGsF
nacP/3PSg8JPmWoBfWrgT287NZ7OAU16/uGpDxlBUoVeEtkEDqZVW8yBFzrMhbwj
bJs3CZ+L85HMUDLZoxSwVnPM8PLVRzHTybYV7agYYzMox5C/jp2aeAgy9KYVd0Tk
07GMTYrSh4fhHWpxXz7IBOxk0RXvQxTHlg1u0DASkibYb2UTDcUNG5Q9kP/8jaIZ
kVDX8a5LDdOCgWaYdKPg4blv/UMjkegJz+Ayp7gXTcux6koW5F6ysSw9sgLBWb2D
b/KNIi4MBMe46xyXB/dqGAR4ibrUXTcQ4OAZNq1L6uWG1A49XuSgykdIwr00MzQw
wfVpKT31ww4ayVHLgj7NuqPlab9S5/fPfJ4MAvGE4GqWQFgsPKgKImUMgnnxTGpv
l7Dqk2MnWqn+wEi0bRES0PVBG96G+sZJQeaxBhoB+HwUSFqoZQg166AJIl//4t2w
bx0a1aWQSS0DZt3wsQW3NW9AE6L+FnFfIc2pQVoLjmvcGalDuvnemRmEOgotiZmt
32bi2aWxg0/Qio2rjLS2LpV+fhwDSN3Agvtnu53yUdD1TFFjTSMloM4SKhiXoPbI
XgfCLiBLNMsZL0AvO7wQfSePzPYxDLyEcwsfPJ8be+eGG1L62RUyad+MdfyXMH/S
m0sgqW/MW6Nv10RyPQOq3Jbgmp2laRMzKTOvQt5WwQf2FEl9uQINBGXQ1o8BEAC9
1cBYn6Z0QmM0OFWdXQI6fMOeNokaa6ngPgt7bzW5NjryqTdwyHOPZdm4DWf1SO/0
+fJRCqxbICyuMAFrb9fDle8bodALjm5ZquTL3D61HpZD4+RwOzOjYP6wLm7h38HT
/yIyK882Ovlw4Xz/TeSiL/VUSWE9twW7yz3oreCeLUBAfzacS9y+syO+aquEd0/x
JBz+mPQbrqfS64rCZXMZEivgsjkQoE6RM+n1rF4kw4Eu3E2kPevVwsoAaY+MEUM8
JAXaJMaNcLIhbeMy7dO/z6z2I3h5bUw5KxfVwzYSzSeRpYh53dNaB4NY+f5/vTrL
4dZmqBcLgcV0zZ02dj/u0SiwWlUFUpFGuSiW16DN7+2zG1zOWi7Nl44JawM62Tlf
mO8zruVGEHaV3e8fFwBLRKM0Sc7e3aLECISsfYeC5ZbRRbpQ1KX+VQr3FBKAMzG4
l9Go7vZ+UcLKpQx2rVPTJt1vDnRV49X6CF2Q/lV9iafQ4MTy6ACdAloT1yfH/lhU
iWQo1qDyRCSlmNBDsYl8gLrwMp4gGQAv3imZHxnJF5ru3nUYGG0U08D5mf2sWv5P
Wh7By8Jm8bmaP8cUF86lO9BJXh2d9QN5jqrAtXqYzenZ+ABSoL1XrD/yv3270rH7
H4gAUtgP+vJ3uMyRu9055OC+ie/b613NojCW5nYN2QARAQABiQI8BBgBCgAmFiEE
GiNqklKNAN15ZXb+TWMlGMNUawUFAmXQ1o8CGwwFCQHhM4AACgkQTWMlGMNUawXh
7w/+KjbEWTwAhjm2HJ3w4tXtPC5URg+A+BzYYVH/q0+956c1QeD0LYafHBw4LEMI
lhRvHQnmzwjtY8v/DgmLOVDMiMWVHo0Q2iQyMvOT1WyEPcgOTJLhvyVzDqRZx7AS
B4G8uNVkKAdBZ7OSXAP27lR/2SEoG05esw8b7Y39pVtucC3aeiua+19PLJWadBjj
XuvXuSCho0km+nk4IgadYmxIDyiMeyKZ8wCl7CJkzECm83q2OtNsMe3k8lgEXybt
KlQxnYApZmhqLMV5ob8WOk3AgAVsif1m332CiEIb1Sfx6wt3nXy/410CXdDDucuj
ndJVfJ6Un33tn0irZ5scPA2HmzK1PGMfgOGtkM8B3LE/x8kEKeWKb3l9boB32Unm
iTfKgEna+JISEab3bzOPWdCQFB8LyGXuWlhtvqmRoX8GtiMRy/F4mzh+l3lYHjj3
4EvPVyippO5zwU+S9HElJ2G37K6zrOmd5cGBrw4aBDoO70QVrMN4O86uvC9kChDb
qyFF5UgXg29QxJjiSCv98ksDMqpJ5AFYrmrsBtwU64OANrxxJ4AZLQ1apYmG9RWD
VHZgfeI60FNBLfKwix9UffFT7piQ/MLrjSde8gPH5S6ezBMrYpfGEopaI9A5qXe3
LnHz88gfdmaBM77YDZM/p23nmCrUxlE3kkbgjTY8NRjYyF8=
=MkAH
-----END PGP PUBLIC KEY BLOCK-----</pre></div></div></div><div class=sect3><h4 id=_secretaris_van_het_ports_beheerteam_portmgr_secretaryfreebsd_org>D.1.3. Secretaris van het Ports Beheerteam <code>&lt;<a href=mailto:portmgr-secretary@FreeBSD.org>portmgr-secretary@FreeBSD.org</a>></code><a class=anchor href=#_secretaris_van_het_ports_beheerteam_portmgr_secretaryfreebsd_org></a></h4><div class="literalblock literal-block-margin"><div class=content><pre>pub   ed25519/E3C401F60D709D59 2023-03-06 [SC] [expires: 2027-03-05]
      Key fingerprint = BED4 A1D3 6555 B681 2E9F  ABDA E3C4 01F6 0D70 9D59
uid                            FreeBSD Ports Management Team Secretary &lt;portmgr-secretary@FreeBSD.org&gt;
sub   cv25519/2C92B55E27A641C3 2023-03-06 [E] [expires: 2027-03-05]</pre></div></div><div class="literalblock literal-block-margin"><div class=content><pre>-----BEGIN PGP PUBLIC KEY BLOCK-----

mDMEZAXJvxYJKwYBBAHaRw8BAQdASFAC20WL3R1T6uNyGMZbfJCxDkcP4C5vi3Op
tcZ2fbq0R0ZyZWVCU0QgUG9ydHMgTWFuYWdlbWVudCBUZWFtIFNlY3JldGFyeSA8
cG9ydG1nci1zZWNyZXRhcnlARnJlZUJTRC5vcmc+iJYEExYKAD4WIQS+1KHTZVW2
gS6fq9rjxAH2DXCdWQUCZAXJvwIbAwUJB4TOAAULCQgHAwUVCgkICwUWAwIBAAIe
BQIXgAAKCRDjxAH2DXCdWYN1AP43TjyfZtZ3DLYT++g0+SuPsoO/3yWVybA+UmFL
zb8MngEA+LLNUfvEwCuXS/soh+ww5bpfmi3UUmeGiQEAXug3iA+JATMEEAEKAB0W
IQT7N0XIbxXo7ayBMvzYKU7Du8TX1QUCZAXLkwAKCRDYKU7Du8TX1XHMB/9R1MX4
6zMgpKqPPt76GOI+eGEdBK6bY8aJZjQGdqTh9f6VtXVoTGIG7cvhc9X8tDBoB0PT
2KZWheF51AV1+NHU4HwLAQ1BMebrFvWSfkw4xg4fBGwDhz9/GN85No+Js772V5ey
8lRiL6meRVWxMlLyWcxGd8JjcC5yX/iAUQ3SBGCLqW7unWjjg7CTd+AMBwcqPGrv
ax8q6eFVguJcHJAjMnKf6HAy4cpK3s+uMoUBCGnszSN12B3ysKfyC4pNO/pix5tA
Q5v8aRqTeFPh5zmNhWo0KGPzplTPqRQSHDl7GDQC8Ru3MhzFkeWzHsexjZVwS6W2
DPcYpuuAsA0XOZIZiQIzBBABCgAdFiEEEBpxaxYrAOVb7eoFrbv4YQo3ibcFAmQF
0u0ACgkQrbv4YQo3ibccwg/9F2Xuic3nhKxRbB3mJeDo6SYQETa/Gh1qQ34+8zlt
8UMazOx67gnYQfy+pXjro6eQ2up0a4eUYezcNOudqAQD21nRz3HA6EQVNcE/TzEA
xl5CJntTaLOt7S+EDXFW5BuQIvhhoMGgm8+WNVgA0EJ7tfL0OcYBSvr19fqwChEn
9c14cSk6mgHSsleP5NvskYN053pxHwy0LTSb8YBBv52th37t/CRFC1363rS5q+D7
JixFopd1O5pKpA5ipvE4gGgRjPtwjx0SjjepwK/3fuhEJQQyKzTIKlMfu2Dj/iR2
Li1Sfccau5LQXOj9fUITU3u1YG7yrm8VGzT7ao4d+KRwgMLjd2pLqiGIbbJwGBiP
FRmtilWQoeIlmSlFX4obAA517DOK0pW1mH8+eEn4EJd3SekT3yzFyKTASv0J48Z8
3F928xg+eZvHxVC0t1J+J5IG0gt3EEncuWKIPQGR7PiQbti6R3FQVTz6WfMWOebP
Qi0E9F/Aqakr6Vj2sKGrDq+ebpaF5G8Yw1YrUl2IDiPzkCegp3ZbI0wh11Xvzhi8
LXPQGK4jBQas4G8cegfitzmtdGRHYrbMv0R9I4mvaL+WlOuD2AvyVG28lguqVhnN
AZP+ohdquYyX2CNCVvbKWAtXo6Ur0vWG8BL8m6defAtEkIwVBALaOHQOSI3aNUz4
lwy4OARkBcm/EgorBgEEAZdVAQUBAQdAsefmSfxEOdOr02+K/6noYCuJ1FeAWVz6
jFYQ+9w6jggDAQgHiH4EGBYKACYWIQS+1KHTZVW2gS6fq9rjxAH2DXCdWQUCZAXJ
vwIbDAUJB4TOAAAKCRDjxAH2DXCdWRl4AP9h5ot212BK29S6ZcMBhHvmtF5PG1oD
c7LnZycSRmbFiwEAndCMpAGOhDW8iVgDd0wLQq/ZMPe+xccfG1b3zFH2EgE=
=iiAT
-----END PGP PUBLIC KEY BLOCK-----</pre></div></div></div><div class=sect3><h4 id=_doceng_secretaryfreebsd_org>D.1.4. <code>&lt;<a href=mailto:doceng-secretary@FreeBSD.org>doceng-secretary@FreeBSD.org</a>></code><a class=anchor href=#_doceng_secretaryfreebsd_org></a></h4><div class="literalblock literal-block-margin"><div class=content><pre>pub   rsa2048/E1C03580AEB45E58 2019-10-31 [SC] [expires: 2022-10-30]
      Key fingerprint = F24D 7B32 B864 625E 5541  A0E4 E1C0 3580 AEB4 5E58
uid                            FreeBSD Doceng Team Secretary &lt;doceng-secretary@freebsd.org&gt;
sub   rsa2048/9EA8D713509472FC 2019-10-31 [E] [expires: 2022-10-30]</pre></div></div><div class="literalblock literal-block-margin"><div class=content><pre>-----BEGIN PGP PUBLIC KEY BLOCK-----

mQENBF27FFcBCADeoSsIgyQUY8vREwkTikwFFlNg31MVy5s/Nq1cNK1PRfRMnprS
yfB62KqbYuz16bmQKaA9zHN4FGfiTvR6tl66LVHm1s/5HPiLv8sP14GsruLro9zN
v72dO7a9i68bMw+jarPOnu9dGiDFEI0dACOkdCGEYKEUapQeNpmWRrQ46BeXyFwF
JcNx76bJJUkwk6fWC0W63D762e6lCEX6ndoaPjjLBnFvtx13heNGUc8RukBwe2mA
U5pSGHj47J05bdWiRSwZaXa8PcW+20zTWaP755w7zWe4h60GANY7OsT9nuOqsioJ
QonxTrJuZweKRV8fNQ1EfDws3HZr7/7iXvO3ABEBAAG0PEZyZWVCU0QgRG9jZW5n
IFRlYW0gU2VjcmV0YXJ5IDxkb2Nlbmctc2VjcmV0YXJ5QGZyZWVic2Qub3JnPokB
VAQTAQoAPhYhBPJNezK4ZGJeVUGg5OHANYCutF5YBQJduxRXAhsDBQkFo5qABQsJ
CAcDBRUKCQgLBRYDAgEAAh4BAheAAAoJEOHANYCutF5YB2IIALw+EPYmOz9qlqIn
oTFmk/5MrcdzC5iLEfxubbF6TopDWsWPiOh5mAuvfEmROSGf6ctvdYe9UtQV3VNY
KeeyskeFrIBOFo2KG/dFqKPAWef6IfhbW3HWDWo5uOBg01jHzQ/pB1n6SMKiXfsM
idL9wN+UQKxF3Y7S/bVrZTV0isRUolO9+8kQeSYT/NMojVM0H2fWrTP/TaNEW4fY
JBDAl5hsktzdl8sdbNqdC0GiX3xb4GvgVzGGQELagsxjfuXk6PfOyn6Wx2d+yRcI
FrKojmhihBp5VGFQkntBIXQkaW0xhW+WBGxwXdaAl0drQlZ3W+edgdOl705x73kf
Uw3Fh2a5AQ0EXbsUVwEIANEPAsltM4vFj2pi5xEuHEcZIrIX/ZJhoaBtZkqvkB+H
4pu3/eQHK5hg0Dw12ugffPMz8mi57iGNI9TXd8ZYMJxAdvEZSDHCKZTX9G+FcxWa
/AzKNiG25uSISzz7rMB/lV1gofCdGtpHFRFTiNxFcoacugTdlYDiscgJZMJSg/hC
GXBdEKXR5WRAgAGandcL8llCToOt1lZEOkd5vJM861w6evgDhAZ2HGhRuG8/NDxG
r4UtlnYGUCFof/Q4oPNbDJzmZXF+8OQyTNcEpVD3leEOWG1Uv5XWS2XKVHcHZZ++
ISo/B5Q6Oi3SJFCVV9f+g09YF+PgfP/mVMBgif2fT20AEQEAAYkBPAQYAQoAJhYh
BPJNezK4ZGJeVUGg5OHANYCutF5YBQJduxRXAhsMBQkFo5qAAAoJEOHANYCutF5Y
kecIAMTh2VHQqjXHTszQMsy3NjiTVVITI3z+pzY0u2EYmLytXQ2pZMzLHMcklmub
5po0X4EvL6bZiJcLMI2mSrOs0Gp8P3hyMI40IkqoLMp7VA2LFlPgIJ7K5W4oVwf8
khY6lw7qg2l69APm/MM3xAyiL4p6MU8tpvWg5AncZ6lxyy27rxVflzEtCrKQuG/a
oVaOlMjH3uxvOK6IIxlhvWD0nKs/e2h2HIAZ+ILE6ytS5ZEg2GXuigoQZdEnv71L
xyvE9JANwGZLkDxnS5pgN2ikfkQYlFpJEkrNTQleCOHIIIp8vgJngEaP51xOIbQM
CiG/y3cmKQ/ZfH7BBvlZVtZKQsI=
=MQKT
-----END PGP PUBLIC KEY BLOCK-----</pre></div></div></div></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: 11 december 2021 by <a href="https://cgit.freebsd.org/doc/commit/?id=2b027dd017" target=_blank>Sergio Carlavilla Delgado</a></p></div><div class=buttons><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#book-preface>Voorwoord</a><ul><li><a href=#preface-audience>Bedoeld publiek</a></li><li><a href=#preface-changes-from3>Wijzigingen ten opzichte van de derde editie</a></li><li><a href=#preface-changes-from2>Wijzigingen ten opzichte van de tweede editie (2004)</a></li><li><a href=#preface-changes>Veranderingen ten opzichte van de eerste editie (2001)</a></li><li><a href=#preface-overview>De opbouw van dit boek</a></li><li><a href=#preface-conv>Overeenkomsten in dit boek</a></li><li><a href=#preface-acknowledgements>Dankwoorden</a></li></ul></li><li><a href=#getting-started>Deel I: Beginnen</a><ul><li><a href=#introduction>Hoofdstuk 1. Introductie</a></li><li><a href=#install>Hoofdstuk 2. FreeBSD installeren op FreeBSD 8.X en eerder</a></li><li><a href=#bsdinstall>Hoofdstuk 3. FreeBSD 9.X en nieuwer installeren</a></li><li><a href=#basics>Hoofdstuk 4. UNIX® beginselen</a></li><li><a href=#ports>Hoofdstuk 5. Applicaties installeren: pakketten en ports</a></li><li><a href=#x11>Hoofdstuk 6. Het X Window systeem</a></li></ul></li><li><a href=#common-tasks>Deel II: Algemene taken</a><ul><li><a href=#desktop>Hoofdstuk 7. Bureaubladapplicaties</a></li><li><a href=#multimedia>Hoofdstuk 8. Multimedia</a></li><li><a href=#kernelconfig>Hoofdstuk 9. De FreeBSD-kernel instellen</a></li><li><a href=#printing>Hoofdstuk 10. Afdrukken</a></li><li><a href=#linuxemu>Hoofdstuk 11. Linux® binaire compatibiliteit</a></li></ul></li><li><a href=#system-administration>Deel III: Systeembeheer</a><ul><li><a href=#config-tuning>Hoofdstuk 12. Instellingen en optimalisatie</a></li><li><a href=#boot>Hoofdstuk 13. Het FreeBSD opstartproces</a></li><li><a href=#users>Hoofdstuk 14. Gebruikers- en basisaccountbeheer</a></li><li><a href=#security>Hoofdstuk 15. Beveiliging</a></li><li><a href=#jails>Hoofdstuk 16. Jails</a></li><li><a href=#mac>Hoofdstuk 17. Verplichte Toegangscontrole (MAC)</a></li><li><a href=#audit>Hoofdstuk 18. Security Event Auditing</a></li><li><a href=#disks>Hoofdstuk 19. Opslag</a></li><li><a href=#geom>Hoofdstuk 20. GEOM. Modulair schijftransformatie raamwerk</a></li><li><a href=#filesystems>Hoofdstuk 21. Ondersteuning van bestandssystemen</a></li><li><a href=#virtualization>Hoofdstuk 22. Virtualisatie</a></li><li><a href=#l10n>Hoofdstuk 23. Lokalisatie - I18N/L10N gebruiken en instellen</a></li><li><a href=#updating-upgrading>Hoofdstuk 24. FreeBSD updaten en upgraden</a></li><li><a href=#dtrace>Hoofdstuk 25. DTrace</a></li></ul></li><li><a href=#network-communication>Deel IV: Netwerkcommunicatie</a><ul><li><a href=#serialcomms>Hoofdstuk 26. Seriële communicatie</a></li><li><a href=#ppp-and-slip>Hoofdstuk 27. PPP en SLIP</a></li><li><a href=#mail>Hoofdstuk 28. Elektronische mail</a></li><li><a href=#network-servers>Hoofdstuk 29. Netwerkdiensten</a></li><li><a href=#firewalls>Hoofdstuk 30. Firewalls</a></li><li><a href=#advanced-networking>Hoofdstuk 31. Geavanceerde netwerken</a></li></ul></li><li><a href=#appendices>Deel V: Appendix</a><ul><li><a href=#mirrors>Bijlage A: FreeBSD verkrijgen</a></li><li><a href=#bibliography>Bijlage B: Bibliography</a></li><li><a href=#eresources>Bijlage C: Bronnen op Internet</a></li><li><a href=#pgpkeys>Bijlage D: PGP sleutels</a></li></ul></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/nl/books/handbook/handbook_nl.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/nl/book target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/nl/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>Dutch</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/nl class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/nl/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>