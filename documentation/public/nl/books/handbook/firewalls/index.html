<!doctype html><html class=theme-light lang=nl><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/nl/books/handbook/firewalls/><title>Hoofdstuk 30. Firewalls | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Hoofdstuk 30. Firewalls"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="nl"><meta property="og:url" content="https://docs.freebsd.org/nl/books/handbook/firewalls/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/nl\/books\/handbook\/firewalls\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/nl>Documentation portal</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/nl/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/nl/books>Books</a></li><li><a href=https://docs.freebsd.org/nl/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/nl/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=nl>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/preface/>Voorwoord</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-audience>Bedoeld publiek</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-changes-from3>Wijzigingen ten opzichte van de derde editie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-changes-from2>Wijzigingen ten opzichte van de tweede editie (2004)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-changes>Veranderingen ten opzichte van de eerste editie (2001)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-overview>De opbouw van dit boek</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-conv>Overeenkomsten in dit boek</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-acknowledgements>Dankwoorden</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/parti/>Deel I. Beginnen</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/introduction/>Hoofdstuk 1. Introductie</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/introduction/#introduction-synopsis>1.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/introduction/#nutshell>1.2. Welkom bij FreeBSD!</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/introduction/#history>1.3. Over het FreeBSD Project</a></li></ul></li><li><input type=checkbox id=chapter-6aaec170775233b7c45f6cdcfb70d466 class=toggle>
<label class="icon cursor" for=chapter-6aaec170775233b7c45f6cdcfb70d466><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/install/>Hoofdstuk 2. FreeBSD installeren op FreeBSD 8.X en eerder</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-synopsis>2.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-hardware>2.2. Hardware-eisen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-pre>2.3. Voorbereidende taken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-start>2.4. Beginnen met de installatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#using-sysinstall>2.5. Inleiding Sysinstall</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-steps>2.6. Schijfruimte toewijzen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-choosing>2.7. Wat installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-media>2.8. Installatiemedia kiezen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-final-warning>2.9. De installatie bevestigen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-post>2.10. Instellingen na de installatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-trouble>2.11. Problemen oplossen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-advanced>2.12. Installeren voor gevorderden</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-diff-media>2.13. Aangepaste installatiemedia maken</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/bsdinstall/>Hoofdstuk 3. FreeBSD 9.X en nieuwer installeren</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/bsdinstall/#bsdinstall-synopsis>33.1. Overzicht</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/basics/>Hoofdstuk 4. UNIX® beginselen</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#basics-synopsis>4.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#consoles>4.2. Virtuele consoles en terminals</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#permissions>4.3. Rechten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#dirstructure>4.4. Mappenstructuur</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#disk-organization>4.5. Organisatie van schijven</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#mount-unmount>4.6. Het koppelen en ontkoppelen van bestandssystemen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#basics-processes>4.7. Processen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#basics-daemons>4.8. Daemons, signalen en het stoppen van processen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#shells>4.9. Shells</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#editors>4.10. Teksteditors</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#basics-devices>4.11. Apparaten en apparaatnodes</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#binary-formats>4.12. Binaire formaten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#basics-more-information>4.13. Meer informatie</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/ports/>Hoofdstuk 5. Applicaties installeren: pakketten en ports</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-synopsis>5.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-overview>5.2. Overzicht van softwareinstallatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-finding-applications>5.3. Applicaties zoeken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#packages-using>5.4. Het pakkettensysteem gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-using>5.5. De Portscollectie gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-nextsteps>5.6. Activiteiten na het installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-broken>5.7. Omgaan met kapotte ports</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/x11/>Hoofdstuk 6. Het X Window systeem</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x11-synopsis>6.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x-understanding>6.2. X begrijpen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x-install>6.3. X11 installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x-config>6.4. X11 instellen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x-fonts>6.5. Lettertypen gebruiken in X11</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x-xdm>6.6. De X beeldschermmanager</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x11-wm>6.7. Bureaubladomgevingen</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/partii/>Deel II. Algemene taken</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/desktop/>Hoofdstuk 7. Bureaubladapplicaties</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-synopsis>7.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-browsers>7.2. Browsers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-productivity>7.3. Productiviteit</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-viewers>7.4. Documentviewers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-finance>7.5. Financiën</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-summary>7.6. Samenvatting</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/>Hoofdstuk 8. Multimedia</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#multimedia-synopsis>8.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#sound-setup>8.2. Geluidskaart installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#sound-mp3>8.3. MP3 audio</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#video-playback>8.4. Video afspelen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#tvcard>8.5. TV-kaarten installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#mythtv>8.6. MythTV</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#scanners>8.7. Scanners</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/>Hoofdstuk 9. De FreeBSD-kernel instellen</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-synopsis>9.1. Samenvatting</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-custom-kernel>9.2. Redenen om een aangepaste kernel te bouwen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-devices>9.3. De systeemhardware vinden</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-modules>9.4. Kernel stuurprogramma’s, subsystemen, en modules</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-building>9.5. Bouwen en installeren van een aangepaste kernel</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-config>9.6. Het instellingenbestand</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-trouble>9.7. Problemen oplossen</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/printing/>Hoofdstuk 10. Afdrukken</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-synopsis>10.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-intro-spooler>10.2. Inleiding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-intro-setup>10.3. Standaardinstallatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-advanced>10.4. Geavanceerde printerinstallatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-using>10.5. Printers gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-lpd-alternatives>10.6. Alternatieven voor het standaard wachtrijsysteem</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-troubleshooting>10.7. Problemen oplossen</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/>Hoofdstuk 11. Linux® binaire compatibiliteit</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-synopsis>11.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-lbc-install>11.2. Installatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-mathematica>11.3. Mathematica® installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-maple>11.4. Maple™ installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-matlab>11.5. MATLAB® installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-oracle>11.6. Oracle® installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-advanced>11.7. Gevorderde onderwerpen</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/partiii/>Deel III. Systeembeheer</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/config/>Hoofdstuk 12. Instellingen en optimalisatie</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#config-synopsis>12.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-initial>12.2. Initiële instellingen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-core-configuration>12.3. Hoofdinstellingen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-appconfig>12.4. Toepassingen instellen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-starting-services>12.5. Diensten starten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-cron>12.6. <code>cron</code> instellen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-rcd>12.7. Gebruik van rc met FreeBSD</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#config-network-setup>12.8. Netwerkkaarten instellen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-virtual-hosts>12.9. Virtuele hosts</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-syslog>12.10. De systeemlogger syslogd configureren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-configfiles>12.11. Instellingenbestanden</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-sysctl>12.12. Optimaliseren met sysctl</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-disk>12.13. Harde schijven optimaliseren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-kernel-limits>12.14. Fijnafstemming van kernellimieten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#adding-swap-space>12.15. Wisselbestandruimte toevoegen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#acpi-overview>12.16. Energie- en bronnenbeheer</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#ACPI-debug>12.17. FreeBSD ACPI gebruiken en debuggen</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/boot/>Hoofdstuk 13. Het FreeBSD opstartproces</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-synopsis>13.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-introduction>13.2. Het bootprobleem</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-blocks>13.3. De bootmanager en opstartstadia</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-kernel>13.4. Interactie met de kernel tijdens opstarten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#device-hints>13.5. Device hints</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-init>13.6. Init: start van procesbesturing</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-shutdown>13.7. Afsluitvolgorde</a></li></ul></li><li><input type=checkbox id=chapter-d251c21b963b5ab783e5aec225e02b5a class=toggle>
<label class="icon cursor" for=chapter-d251c21b963b5ab783e5aec225e02b5a><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/users/>Hoofdstuk 14. Gebruikers- en basisaccountbeheer</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-synopsis>14.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-introduction>14.2. Inleiding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-superuser>14.3. Het superuser-account</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-system>14.4. Systeemaccounts</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-user>14.5. Gebruikersaccounts</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-modifying>14.6. Accounts wijzigen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-limiting>14.7. Gebruikers beperken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-groups>14.8. Groepen</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/security/>Hoofdstuk 15. Beveiliging</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#security-synopsis>15.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#security-intro>15.2. Introductie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#securing-freebsd>15.3. FreeBSD beveiligen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#crypt>15.4. DES, Blowfish, MD5, SHA256, SHA512 en crypt</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#one-time-passwords>15.5. Eenmalige wachtwoorden</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#tcpwrappers>15.6. TCP Wrappers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#kerberos5>15.7. Kerberos5</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#openssl>15.8. OpenSSL</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#ipsec>15.9. VPN via IPsec</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#openssh>15.10. OpenSSH</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#fs-acl>15.11. Bestandssysteem toegangscontrolelijsten (ACLs)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#security-portaudit>15.12. Monitoren van beveiligingsproblemen met andere software</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#security-advisories>15.13. FreeBSD beveiligingswaarschuwingen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#security-accounting>15.14. Procesaccounting</a></li></ul></li><li><input type=checkbox id=chapter-1a2a8e719703649c2c66d99aa7a25fd4 class=toggle>
<label class="icon cursor" for=chapter-1a2a8e719703649c2c66d99aa7a25fd4><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/jails/>Hoofdstuk 16. Jails</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-synopsis>16.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-terms>16.2. Termen en begrippen van jails</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-intro>16.3. Introductie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-build>16.4. Creeëren en controleren van jails</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-tuning>16.5. Optimaliseren en administratie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-application>16.6. Toepassing van jails</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/mac/>Hoofdstuk 17. Verplichte Toegangscontrole (MAC)</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-synopsis>17.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-inline-glossary>17.2. Sleuteltermen in dit hoofdstuk</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-initial>17.3. Uitleg over MAC</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-understandlabel>17.4. MAC-labels begrijpen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-planning>17.5. De beveiligingsconfiguratie plannen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-modules>17.6. Module-instellingen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-seeotheruids>17.7. MAC-module seeotheruids</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-bsdextended>17.8. MAC-module bsdextended</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-ifoff>17.9. MAC-module ifoff</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-portacl>17.10. MAC-module portacl</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-partition>17.11. MAC-module partition</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-mls>17.12. MAC-module Multi-Level Security</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-biba>17.13. MAC-module Biba</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-lomac>17.14. MAC-module LOMAC</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-implementing>17.15. Nagios in een MAC-jail</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-userlocked>17.16. Gebruikers afsluiten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-troubleshoot>17.17. Problemen oplossen met het MAC-raamwerk</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/audit/>Hoofdstuk 18. Security Event Auditing</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/audit/#audit-synopsis>18.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/audit/#audit-inline-glossary>18.2. Sleutelwoorden in dit hoofdstuk</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/audit/#audit-install>18.3. Installeren van audit ondersteuning.</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/audit/#audit-config>18.4. Audit Configuratie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/audit/#audit-administration>18.5. Het audit subsysteem beheren.</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/disks/>Hoofdstuk 19. Opslag</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-synopsis>19.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-naming>19.2. Apparaatnamen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-adding>19.3. Schijven toevoegen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#raid>19.4. RAID</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#usb-disks>19.5. USB-opslagapparaten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#creating-cds>19.6. Optische media (CD’s) aanmaken en gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#creating-dvds>19.7. Optische media (DVD’s) aanmaken en gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#floppies>19.8. Diskettes aanmaken en gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#backups-tapebackups>19.9. Gegevensbanden aanmaken en gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#backups-floppybackups>19.10. Naar diskettes back-uppen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#backup-strategies>19.11. Back-up strategieën</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#backup-basics>19.12. Back-upbeginselen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-virtual>19.13. Netwerk-, geheugen-, en bestandsgebaseerde bestandssystemen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#snapshots>19.14. Snapshots van bestandssystemen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#quotas>19.15. Bestandssysteemquota</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-encrypting>19.16. Schijfpartities versleutelen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#swap-encrypting>19.17. Het versleutelen van de wisselbestand ruimte</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-hast>19.18. Highly Available Storage (HAST)</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/geom/>Hoofdstuk 20. GEOM: Modulair schijftransformatie raamwerk</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#geom-synopsis>20.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#GEOM-intro>20.2. GEOM inleiding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#GEOM-striping>20.3. RAID0 - aaneengeschakeld</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#GEOM-mirror>20.4. RAID1 - spiegelen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#GEOM-raid3>20.5. RAID3 - Striping op byte-niveau met toegewijde pariteit</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#geom-ggate>20.6. GEOM Gate netwerk apparaten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#geom-glabels>20.7. Het labelen van schijven</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#geom-gjournal>20.8. UFS logboeken door middel van GEOM</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/filesystems/>Hoofdstuk 21. Ondersteuning van bestandssystemen</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/filesystems/#filesystems-synopsis>21.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/filesystems/#filesystems-zfs>21.2. Het Z File System (ZFS)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/filesystems/#filesystems-linux>21.3. Linux® bestandssystemen</a></li></ul></li><li><input type=checkbox id=chapter-375257268d95faaf87faf4f7a2e6aa67 class=toggle>
<label class="icon cursor" for=chapter-375257268d95faaf87faf4f7a2e6aa67><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/virtualization/>Hoofdstuk 22. Virtualisatie</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/virtualization/#virtualization-synopsis>22.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/virtualization/#virtualization-guest>22.2. FreeBSD als een gast-besturingssysteem</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/virtualization/#virtualization-host>22.3. FreeBSD als een gastheer-besturingssysteem</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/l10n/>Hoofdstuk 23. Lokalisatie - I18N/L10N gebruiken en instellen</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/l10n/#l10n-synopsis>23.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/l10n/#l10n-basics>23.2. Beginselen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/l10n/#using-localization>23.3. Lokalisatie gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/l10n/#l10n-compiling>23.4. I18N-programma’s compileren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/l10n/#lang-setup>23.5. FreeBSD lokaliseren naar talen</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/>Hoofdstuk 24. FreeBSD updaten en upgraden</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#updating-upgrading-synopsis>24.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>24.2. FreeBSD Update</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#updating-upgrading-portsnap>24.3. Portsnap: een updategereedschap voor de Portscollectie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#updating-upgrading-documentation>24.4. De documentatie bijwerken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#current-stable>24.5. Een ontwikkelingstak volgen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#synching>24.6. Broncode synchroniseren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#makeworld>24.7. De "wereld" opnieuw bouwen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#make-delete-old>24.8. Het verwijderen van overbodige bestanden, directories en bibliotheken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#small-lan>24.9. Meerdere machines bijwerken</a></li></ul></li><li><input type=checkbox id=chapter-29c1eeb0e9dedc487a98399e2737ee8a class=toggle>
<label class="icon cursor" for=chapter-29c1eeb0e9dedc487a98399e2737ee8a><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/>Hoofdstuk 25. DTrace</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/#dtrace-synopsis>25.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/#dtrace-implementation>25.2. Implementatieverschillen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/#dtrace-enable>25.3. Ondersteuning voor DTrace aanzetten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/#dtrace-using>25.4. DTrace gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/#dtrace-language>25.5. De taal D</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/partiv/>Deel IV. Netwerkcommunicatie</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/>Hoofdstuk 26. Seriële communicatie</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#serial-synopsis>26.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#serial>26.2. Inleiding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#term>26.3. Terminals</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#dialup>26.4. Inbeldienst</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#dialout>26.5. Uitbeldienst</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#serialconsole-setup>26.6. Seriële console opzetten</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/>Hoofdstuk 27. PPP en SLIP</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>27.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#userppp>27.2. Gebruikmaken van gebruiker-PPP</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#ppp>27.3. Kernel-PPP gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#ppp-troubleshoot>27.4. Het problemen oplossen van PPP-verbindingen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#pppoe>27.5. PPP gebruiken over Ethernet (PPPoE)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#pppoa>27.6. Gebruik maken van PPP over ATM (PPPoA)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#slip>27.7. Gebruik maken van SLIP</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/mail/>Hoofdstuk 28. Elektronische mail</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-synopsis>28.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-using>28.2. Gebruik maken van elektronische mail</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#sendmail>28.3. sendmail instellen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-changingmta>28.4. De Mail Transfer Agent vervangen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-trouble>28.5. Problemen oplossen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-advanced>28.6. Geavanceerde onderwerpen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#SMTP-UUCP>28.7. SMTP met UUCP</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#outgoing-only>28.8. Instellen om alleen te versturen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#SMTP-dialup>28.9. Mail gebruiken met een inbelverbinding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#SMTP-Auth>28.10. SMTP-authenticatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-agents>28.11. Mail User Agents</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-fetchmail>28.12. fetchmail gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-procmail>28.13. procmail gebruiken</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/>Hoofdstuk 29. Netwerkdiensten</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-servers-synopsis>29.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-inetd>29.2. De inetd"Super-Server"</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-nfs>29.3. Netwerkbestandssysteem (NFS)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-nis>29.4. Netwerkinformatiesysteem (NIS/YP)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-dhcp>29.5. Automatisch netwerk instellen (DHCP)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-dns>29.6. Domeinnaamsysteem (DNS)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-apache>29.7. Apache HTTP server</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-ftp>29.8. File Transfer Protocol (FTP)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-samba>29.9. Bestands- en printdiensten voor Microsoft® Windows® cliënten (Samba)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-ntp>29.10. Tijd synchroniseren met NTP</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-syslogd>29.11. Hosts op afstand loggen met <code>syslogd</code></a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle checked>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/>Hoofdstuk 30. Firewalls</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-intro>30.1. Inleiding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-concepts>30.2. Firewallconcepten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-apps>30.3. Firewallsoftware</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-pf>30.4. De OpenBSD Packet Filter (PF) en ALTQ</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-ipf>30.5. De IPFILTER (IPF) firewall</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-ipfw>30.6. IPFW</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/>Hoofdstuk 31. Geavanceerde netwerken</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#advanced-networking-synopsis>31.1. Samenvatting</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-routing>31.2. Gateways en routes</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-wireless>31.3. Draadloze netwerken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-bluetooth>31.4. Bluetooth</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-bridging>31.5. Bridging</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-aggregation>31.6. Verbindingsaggregatie en failover</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-diskless>31.7. Schijfloos werken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-pxe-nfs>31.8. Met PXE en een NFS-root-bestandssysteem opstarten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-isdn>31.9. ISDN</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-natd>31.10. Network Address Translation</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-ipv6>31.11. IPv6</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-atm>31.12. Asynchronous Transfer Mode (ATM)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#carp>31.13. Common Address Redundancy Protocol (CARP)</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/partv/>Deel V. Appendix</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/>Bijlage A. FreeBSD verkrijgen</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#mirrors-cdrom>A.1. CD-ROM en DVD uitgevers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#mirrors-ftp>A.2. FTP sites</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#mirrors-svn>A.3. Subversion-sites</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#anoncvs>A.4. Anonieme CVS</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#ctm>A.5. CTM gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#cvsup>A.6. CVSup gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#cvs-tags>A.7. CVS labels</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#mirrors-rsync>A.8. rsync sites</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/>Bijlage B. Bibliografie</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-freebsd>B.1. Boeken & tijdschriften over FreeBSD</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-userguides>B.2. Voor gebruikers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-adminguides>B.3. Voor beheerders</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-programmers>B.4. Voor programmeurs</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-osinternals>B.5. Dieper in het besturingssysteem</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-security>B.6. Over beveiliging</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-hardware>B.7. Over hardware</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-history>B.8. UNIX® geschiedenis</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-journals>B.9. Tijdschriften en periodieken</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/eresources/>Bijlage C. Bronnen op Internet</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/eresources/#eresources-mail>C.1. Mailinglijsten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/eresources/#eresources-news>C.2. Usenet-nieuwsgroepen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/eresources/#eresources-web>C.3. World wide webservers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/eresources/#eresources-email>C.4. Email-adressen</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/pgpkeys/>Bijlage D. PGP sleutels</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Beambten</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>Hoofdstuk 30. Firewalls</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#firewalls-intro>30.1. Inleiding</a></li><li><a href=#firewalls-concepts>30.2. Firewallconcepten</a></li><li><a href=#firewalls-apps>30.3. Firewallsoftware</a></li><li><a href=#firewalls-pf>30.4. De OpenBSD Packet Filter (PF) en ALTQ</a></li><li><a href=#firewalls-ipf>30.5. De IPFILTER (IPF) firewall</a></li><li><a href=#firewalls-ipfw>30.6. IPFW</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=firewalls-intro>30.1. Inleiding<a class=anchor href=#firewalls-intro></a></h2><div class=sectionbody><div class=paragraph><p>Firewalls bieden de mogelijkheid om inkomend en uitgaand verkeer op een systeem te filteren. Een firewall gebruikt daarvoor een of meer groepen regels ("rules") om netwerkpakketten te inspecteren als ze binnenkomen of weggaan door netwerkverbindingen en staat dat verkeer dan toe of blokkeert het. De regels van een firewall kunnen één of meerdere eigenschappen van pakketten onderzoeken waaronder, maar niet uitsluitend, het protocol, het bron- of bestemmingsadres en de bron- en bestemmingspoort.</p></div><div class=paragraph><p>Firewalls kunnen de veiligheid van een host of netwerk enorm vergroten. Ze kunnen één of meer van de volgende dingen doen:</p></div><div class=ulist><ul><li><p>Applicaties, diensten en machines op een intern netwerk te beschermen tegen ongewild verkeer van het Internet.</p></li><li><p>Toegang tot Internet voor interne hosts te limiteren of uitschakelen.</p></li><li><p>Ondersteuning bieden voor netwerkadres vertaling ("network address translation" of NAT), waarmee er vanaf een intern netwerk met private IP adressen een Internetverbinding gedeeld kan worden met één IP adres of met een groep van publieke adressen die automatisch wordt toegewezen.</p></li></ul></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Hoe pakketfilteringsregels op de juiste wijze samengesteld kunnen worden;</p></li><li><p>De verschillen tussen de firewalls die bij FreeBSD worden geleverd;</p></li><li><p>Hoe de OpenBSD firewall PF te gebruiken en in te stellen;</p></li><li><p>Hoe IPFILTER te gebruiken en in te stellen;</p></li><li><p>Hoe IPFW te gebruiken en in te stellen.</p></li></ul></div><div class=paragraph><p>Er wordt aangenomen dat de lezer van dit hoofdstuk:</p></div><div class=ulist><ul><li><p>Basisbegrip heeft van FreeBSD en Internetconcepten.</p></li></ul></div></div></div><div class=sect1><h2 id=firewalls-concepts>30.2. Firewallconcepten<a class=anchor href=#firewalls-concepts></a></h2><div class=sectionbody><div class=paragraph><p>Er zijn twee basismogelijkheden om sets met regels te maken voor firewalls: "inclusief" of "exclusief". Een exclusieve firewall staat al het verkeer door behalve het verkeer dat past bij de set met regels. Een inclusieve firewall doet het tegenovergestelde. Die staat alleen verkeer toe dat past bij de regels en blokkeert al het overige verkeer.</p></div><div class=paragraph><p>Een inclusieve firewall biedt veel betere controle over het uitgaande verkeer, waardoor het een betere keuze is voor systemen die diensten op het publieke Internet aanbieden. Het beheert ook het type verkeer dat van het publieke Internet afkomt en toegang heeft tot uw privé-netwerk. Al het verkeer dat niet aan de regels voldoet wordt geblokkeerd en gelogd, dat is zo ontworpen. Inclusieve firewalls zijn over het algemeen veiliger dan exclusieve firewalls omdat ze het risico dat ongewenst verkeer door ze heen gaat aanzienlijk verminderen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Tenzij anders aangegeven, creëeren alle configuraties en voorbeelden van regelverzamelingen in dit hoofdstuk inclusieve firewalls.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De beveiliging kan nog verder vergroot worden met een "stateful firewall". Dit type firewall houdt bij welke connecties er door de firewall tot stand zijn gekomen en laat alleen verkeer door dat bij een bestaande connectie hoort of onderdeel is van een connectie in opbouw. Het nadeel van een stateful firewall is dat die kwetsbaar kan zijn voor Ontzegging van Dienst (DoS) aanvallen als er een groot aantal nieuwe verbindingen binnen korte tijd wordt opgezet. Met de meeste firewalls is het mogelijk een combinatie te maken van stateful en niet stateful gedrag om een optimale firewall voor een site te maken.</p></div></div></div><div class=sect1><h2 id=firewalls-apps>30.3. Firewallsoftware<a class=anchor href=#firewalls-apps></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD heeft drie soorten firewallsoftware in de basisinstallatie. Dat zijn: IPFILTER (ook bekend als IPF), IPFIREWALL (ook bekend als IPFW) en de pakketfilter van OpenBSD (ook bekend als PF). FreeBSD heeft ook twee ingebouwde pakketten voor het regelen van verkeer (in de basis het beheersen van bandbreedtegebruik): <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a>. Dummynet is traditioneel sterk verbonden met IPFW en ALTQ met PF. Het vormgeven van verkeer voor IPFILTER kan momenteel gedaan worden met IPFILTER voor NAT en filtering en IPFW met <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a> <em>of</em> door PF met ALTQ te gebruiken. IPFW en PF gebruiken allemaal regels om de toegang van pakketten tot een systeem te regelen, hoewel ze dat op andere manieren doen en ze een andere regelsyntaxis hebben.</p></div><div class=paragraph><p>De reden dat er meerdere firewallpakketten in FreeBSD zitten is dat verschillende mensen verschillende eisen en voorkeuren hebben. Geen enkel firewallpakket is het beste.</p></div><div class=paragraph><p>De schrijver van dit artikel geeft de voorkeur aan IPFILTER omdat daarmee stateful regels minder complex zijn toe te passen in een omgeving waar NAT wordt gebruikt en IPF heeft een ingebouwde FTP proxy waardoor de regels voor het veilig gebruiken van FTP eenvoudiger worden.</p></div><div class=paragraph><p>Omdat alle firewalls gebaseerd zijn op het inspecteren van aangegeven controlevelden in pakketten, moet iemand die sets van firewallregels opstelt begrijpen hoe TCP/IP werkt, welke waarde de controlevelden kunnen hebben en hoe die waarden gebruikt worden in normaal verkeer. Op de volgende webpagina wordt een prima uitleg gegeven: <a href=http://www.ipprimer.com/overview.cfm>http://www.ipprimer.com/overview.cfm</a>.</p></div></div></div><div class=sect1><h2 id=firewalls-pf>30.4. De OpenBSD Packet Filter (PF) en ALTQ<a class=anchor href=#firewalls-pf></a></h2><div class=sectionbody><div class=paragraph><p>Vanaf juli 2003 is de OpenBSD firewalltoepassing PF geporteerd naar FreeBSD en beschikbaar gekomen in de FreeBSD Portscollectie. In 2004 was FreeBSD 5.3 de eerste release die PF bevatte is integraal onderdeel van het basissysteem. PF is een complete en volledige firewall die optioneel ALTQ bevat (Alternate Queuing). ALTQ biedt Quality of Service (QoS) functionaliteit.</p></div><div class=paragraph><p>het OpenBSD Project levert een uitstekend werk wat betreft het onderhouden van de <a href=http://www.openbsd.org/faq/pf/>PF FAQ</a>. Zodoende zal deze sectie van het handboek zich richten op PF met betrekking tot FreeBSD terwijl het ook wat algemene informatie over het gebruik zal geven. Voor gedetailleerde gebruikersinformatie wordt naar de <a href=http://www.openbsd.org/faq/pf/>PF FAQ</a> verwezen.</p></div><div class=paragraph><p>Meer informatie over PF voor FreeBSD staat op <a href=http://pf4freebsd.love2party.net/>http://pf4freebsd.love2party.net/</a>.</p></div><div class=sect2><h3 id=_de_laadbare_kernelmodules_voor_pf_gebruiken>30.4.1. De laadbare kernelmodules voor PF gebruiken<a class=anchor href=#_de_laadbare_kernelmodules_voor_pf_gebruiken></a></h3><div class=paragraph><p>Voeg de volgende regel toe aan <span class=filename>/etc/rc.conf</span> om de kernelmodule PF te laden:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Draai vervolgens het opstartscript om de module te laden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service pf start</span></code></pre></div></div><div class=paragraph><p>Merk op dat de PF module niet laadt als het het instellingenbestand met de regelverzameling niet kan vinden. De standaardlocatie is <span class=filename>/etc/pf.conf</span>. Als de regelverzameling voor PF zich elders bevindt, kan PF worden verteld om daar te kijken een regel analoog aan de volgende aan <span class=filename>/etc/rc.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_rules=&#34;/pad/naar/pf.conf&#34;</pre></div></div><div class=paragraph><p>Het voorbeeld <span class=filename>pf.conf</span> bestand kan gevonden worden in <span class=filename>/usr/shared/examples/pf</span></p></div><div class=paragraph><p>De module PF kan ook handmatig vanaf de opdrachtregel geladen worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload pf.ko</span></code></pre></div></div><div class=paragraph><p>Logondersteuning voor PF wordt geleverd door <code>pflog.ko</code> en kan worden geladen door de volgende regel aan <span class=filename>/etc/rc.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>pflog_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Draai vervolgens het opstartscript om de module te laden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service pflog start</span></code></pre></div></div><div class=paragraph><p>Als u andere mogelijkheden van PF nodig heeft dient u ondersteuning voor PF in de kernel te compileren.</p></div></div><div class=sect2><h3 id=_kernelopties_voor_pf>30.4.2. Kernelopties voor PF<a class=anchor href=#_kernelopties_voor_pf></a></h3><div class=paragraph><p>Hoewel het niet nodig is om ondersteuning voor PF in de kernel te compileren, biedt dit wel de mogelijkheid om van een van PF’s geavanceerde mogelijkheden gebruik te maken die niet in de laadbare module zitten, namelijk <a href="https://man.freebsd.org/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;format=html">pfsync(4)</a>, dat een pseudo-apparaat is dat zekere veranderingen aan de toestandstabel die door PF wordt gebruikt prijsgeeft. Het kan worden gecombineerd met <a href="https://man.freebsd.org/cgi/man.cgi?query=carp&amp;sektion=4&amp;format=html">carp(4)</a> om failover firewalls aan te maken die gebruik maken van PF. Meer informatie over CARP kan gevonden worden in <a href=../advanced-networking/#carp>Common Address Redundancy Protocol (CARP)</a> van het Handboek.</p></div><div class=paragraph><p>De kernelopties voor PF kunnen gevonden worden in <span class=filename>/usr/src/sys/conf/NOTES</span> en zijn hieronder gereproduceerd:</p></div><div class="literalblock programlisting"><div class=content><pre>device pf
device pflog
device pfsync</pre></div></div><div class=paragraph><p>De optie <code>device pf</code> schakelt ondersteuning voor de "Packet Filter" firewall (<a href="https://man.freebsd.org/cgi/man.cgi?query=pf&amp;sektion=4&amp;format=html">pf(4)</a>) in.</p></div><div class=paragraph><p>De optie <code>device pflog</code> schakelt het optionele <a href="https://man.freebsd.org/cgi/man.cgi?query=pflog&amp;sektion=4&amp;format=html">pflog(4)</a> pseudo-netwerkapparaat in dat gebruikt kan worden om verkeer te loggen naar een <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> descriptor. De <a href="https://man.freebsd.org/cgi/man.cgi?query=pflogd&amp;sektion=8&amp;format=html">pflogd(8)</a> daemon kan gebruikt worden om de logboekinformatie naar schijf te schrijven.</p></div><div class=paragraph><p>De optie <code>device pfsync</code> schakelt het optionele <a href="https://man.freebsd.org/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;format=html">pfsync(4)</a> pseudo netwerkapparaat in waarmee de toestandswijzigingen gemonitord kunnen worden.</p></div></div><div class=sect2><h3 id=_beschikbare_opties_voor_rc_conf>30.4.3. Beschikbare opties voor <span class=filename>rc.conf</span><a class=anchor href=#_beschikbare_opties_voor_rc_conf></a></h3><div class=paragraph><p>De volgende <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> statements stellen PF en <a href="https://man.freebsd.org/cgi/man.cgi?query=pflog&amp;sektion=4&amp;format=html">pflog(4)</a> in tijdens het opstarten:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_enable=&#34;YES&#34;                 # Schakel PF in (laad module als nodig)
pf_rules=&#34;/etc/pf.conf&#34;         # bestand met regels voor pf
pf_flags=&#34;&#34;                     # aanvullende vragen voor opstarten pfctl
pflog_enable=&#34;YES&#34;              # start pflogd(8)
pflog_logfile=&#34;/var/log/pflog&#34;  # waar pflogd het logboekbestand moet opslaan
pflog_flags=&#34;&#34;                  # aanvullende vlaggen voor opstarten pflogd</pre></div></div><div class=paragraph><p>Als er een LAN achter de firewall staat en er pakketten doorgestuurd moeten worden naar computers op het LAN of als NAT actief is, dan is de volgende optie ook nodig:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;            # Schakel in als LAN gateway</pre></div></div></div><div class=sect2><h3 id=_filterregels_aanmaken>30.4.4. Filterregels aanmaken<a class=anchor href=#_filterregels_aanmaken></a></h3><div class=paragraph><p>PF leest de instelregels van <a href="https://man.freebsd.org/cgi/man.cgi?query=pf.conf&amp;sektion=5&amp;format=html">pf.conf(5)</a> (standaard <span class=filename>/etc/pf.conf</span>) en het verandert, verwijdert, of geeft pakketten door aan de hand van de regels of definities die daar zijn gespecificeerd. De FreeBSD-installatie bevat een aantal voorbeeldbestanden in <span class=filename>/usr/shared/examples/pf/</span>. In de <a href=http://www.openbsd.org/faq/pf/>PF FAQ</a> staat een complete behandeling van de PF regels.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Houd tijdens het doornemen van de <a href=http://www.openbsd.org/faq/pf>PF FAQ</a> in de gaten dat verschillende versies van FreeBSD verschillende versies van PF kunnen bevatten. Momenteel gebruikt FreeBSD 8.<em>X</em> dezelfde versie van PF als OpenBSD 4.1. FreeBSD 9.<em>X</em> en hoger gebruiken dezelfde versie van PF als OpenBSD 4.5.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De <a href=https://lists.FreeBSD.org/subscription/freebsd-pf>FreeBSD pakketfilter mailinglijst</a> is een goede plaats om vragen over het instellen en draaien van de PF firewall te stellen. Vergeet niet de mailinglijstarchieven te controleren alvorens vragen te stellen!</p></div></div><div class=sect2><h3 id=_werken_met_pf>30.4.5. Werken met PF<a class=anchor href=#_werken_met_pf></a></h3><div class=paragraph><p>Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;format=html">pfctl(8)</a> om PF te beheren. Hieronder staan wat nuttige commando’s (bekijk de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;format=html">pfctl(8)</a> voor alle beschikbare opties):</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Commando</th><th class="tableblock halign-left valign-top">Doel</th><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top"></th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -e</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PF aanzetten</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -d</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PF uitzetten</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -F all -f /etc/pf.conf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Spoel alle regels door (nat, filter, toestand, tabel, etc.) en herlaad vanuit het bestand <span class=filename>/etc/pf.conf</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -s [ rules | nat | state ]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Rapporteer over de filterregels, NAT-regels, of toestandstabel</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -vnf /etc/pf.conf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Controleer <span class=filename>/etc/pf.conf</span> op fouten, maar laad de regelverzameling niet</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table></div><div class=sect2><h3 id=_altq_inschakelen>30.4.6. ALTQ inschakelen<a class=anchor href=#_altq_inschakelen></a></h3><div class=paragraph><p>ALTQ is alleen beschikbaar ondersteuning ervoor in de FreeBSD Kernel te compileren. ALTQ wordt niet door alle netwerkkaartstuurprogramma’s ondersteund. In <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> staat een lijst met ondersteunde stuurprogramma’s voor de betreffende versie.</p></div><div class=paragraph><p>Met de volgende opties wordt ALTQ ingeschakeld en additionele functionaliteit toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>options         ALTQ
options         ALTQ_CBQ        # Class Bases Queuing (CBQ)
options         ALTQ_RED        # Random Early Detection (RED)
options         ALTQ_RIO        # RED In/Out
options         ALTQ_HFSC       # Hierarchical Packet Scheduler (HFSC)
options         ALTQ_PRIQ       # Priority Queuing (PRIQ)
options         ALTQ_NOPCC      # Required for SMP build</pre></div></div><div class=paragraph><p><code>options ALTQ</code> schakelt het ALTQ raamwerk in.</p></div><div class=paragraph><p><code>options ALTQ_CBQ</code> schakelt <em>Class Based Queuing</em> (CBQ) in. Met CBQ kan de bandbreedte van een verbinding worden opgedeeld in verschillende klassen of wachtrijen om verkeer te prioriteren op basis van filterregels.</p></div><div class=paragraph><p><code>options ALTQ_RED</code> schakelt <em>Random Early Detection</em> (RED) in. RED wordt gebruikt om netwerkverstopping te voorkomen. RED doet dit door de lengte van de wachtrij te meten en die te vergelijken met de minimale en maximale drempelwaarden voor de wachtrij. Als de wachtrij groter is dan de maximale waarde worden alle nieuwe pakketten genegeerd. Het werkt naar zijn naam, dus RED negeert willekeurig pakketten van verschillende verbindingen.</p></div><div class=paragraph><p><code>options ALTQ_RIO</code> schakelt <em>Random Early Detection In and Out</em> in.</p></div><div class=paragraph><p><code>options ALTQ_HFSC</code> schakelt de <em>Hierarchical Fair Service Curve Packet Scheduler</em> in. Meer informatie over HFSC staat op <a href=http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html>http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html</a>.</p></div><div class=paragraph><p><code>options ALTQ_PRIQ</code> schakelt <em>Priority Queuing</em> (PRIQ) in. PRIQ laat verkeer dat in een hogere wachtrij staat altijd eerder door.</p></div><div class=paragraph><p><code>options ALTQ_NOPCC</code> schakelt SMP ondersteuning voor ALTQ in. Deze optie is verplicht op SMP systemen.</p></div></div></div></div><div class=sect1><h2 id=firewalls-ipf>30.5. De IPFILTER (IPF) firewall<a class=anchor href=#firewalls-ipf></a></h2><div class=sectionbody><div class=paragraph><p>Darren Reed is de auteur van IPFILTER, dat niet afhankelijk is van één besturingssysteem. Het is een open source applicatie die is geporteerd naar FreeBSD, NetBSD, OpenBSD, SunOS, HP/UX en Solaris besturingssystemen. IPFILTER wordt actief ondersteund en onderhouden en er worden regelmatig nieuwe versies uigebracht.</p></div><div class=paragraph><p>IPFILTER is gebaseerd op een firewall aan de kernelkant en een NAT mechanisme dat gecontroleerd en gemonitord kan worden door programma’s in userland. De firewallregels kunnen ingesteld of verwijderd worden met het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a>. De NAT regels kunnen ingesteld of verwijderd worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=8&amp;format=html">ipnat(8)</a>. Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> kan actuele statistieken leveren voor de kernelonderdelen van IPFILTER. <a href="https://man.freebsd.org/cgi/man.cgi?query=ipmon&amp;sektion=8&amp;format=html">ipmon(8)</a> kan acties van IPFILTER wegschrijven naar logboekbestanden van het systeem.</p></div><div class=paragraph><p>IPF is oorspronkelijk geschreven met logica die regels verwerkte volgens het principe "de laatst passende regel wint" en gebruikte toen alleen staatloze regels. In de loop der tijd is IPF verbeterd en zijn de opties <code>quick</code> en <code>keep state</code> toegevoegd waarmee de logica van het verwerken van regels drastisch is gemoderniseerd. In de officiële documentatie van IPF worden alleen de regels en verwerkingslogica behandeld. De moderne functies worden alleen behandeld als opties, waardoor hun nut dat er een veel betere en veiligere firewall mee te maken volledig onderbelicht blijft.</p></div><div class=paragraph><p>De instructies in dit hoofdstuk zijn gebaseerd op regels die gebruik maken van de optie <code>quick</code> en de stateful optie <code>keep state</code>. Dit is het raamwerk waarmee een set van inclusieve firewallregels wordt samengesteld.</p></div><div class=paragraph><p>Voor een gedetailleerde uitleg over de verwerking van de verouderde regels zie <a href=http://www.munk.me.uk/ipf/ipf-howto.html>http://www.munk.me.uk/ipf/ipf-howto.html</a> en <a href=http://coombs.anu.edu.au/~avalon/ip-filter.html>http://coombs.anu.edu.au/~avalon/ip-filter.html</a>.</p></div><div class=paragraph><p>De IPF FAQ is te vinden op <a href=http://www.phildev.net/ipf/index.html>http://www.phildev.net/ipf/index.html</a>.</p></div><div class=paragraph><p>Een doorzoekbaar archief van de open-source IPFilter mailing lijst is beschikbaar op <a href="http://marc.theaimsgroup.com/?l=ipfilter">http://marc.theaimsgroup.com/?l=ipfilter</a>.</p></div><div class=sect2><h3 id=_ipf_inschakelen>30.5.1. IPF inschakelen<a class=anchor href=#_ipf_inschakelen></a></h3><div class=paragraph><p>IPF zit in de basisinstallatie van FreeBSD als een aparte "run time" laadbare module. Een systeem laadt de IPF kernel laadbare module dynamisch als <code>ipfilter_enable="YES"</code> in <span class=filename>rc.conf</span> staat. Voor de laadbare module zijn de opties <code>logging</code> en <code>default pass all</code> ingeschakeld. IPF hoeft niet in de kernel gecompileerd te worden om het standaardgedrag te wijzigen naar <code>block all</code>. Dat is mogelijk door op het einde van de regelverzameling een regel <code>block all</code> toe te voegen die al het verkeer blokkeert.</p></div></div><div class=sect2><h3 id=_kernelopties>30.5.2. Kernelopties<a class=anchor href=#_kernelopties></a></h3><div class=paragraph><p>Het is niet verplicht om IPF in te schakelen door de volgende opties in de FreeBSD kernel te compileren. Dit wordt alleen beschreven als achtergrondinformatie. Door IPF in de kernel te compileren wordt de laadbare module niet gebruikt.</p></div><div class=paragraph><p>Voorbeeld kernelinstellingen voor IPF staan beschreven in de <span class=filename>/usr/src/sys/i386/conf/LINT</span> in de kernelbroncode en worden hier beschreven:</p></div><div class="literalblock programlisting"><div class=content><pre>options IPFILTER
options IPFILTER_LOG
options IPFILTER_DEFAULT_BLOCK</pre></div></div><div class=paragraph><p><code>options IPFILTER</code> schakelt ondersteuning voor de "IPFILTER" firewall in.</p></div><div class=paragraph><p><code>options IPFILTER_LOG</code> schakelt de optie in waarmee IPF verkeer kan loggen door het naar het <span class=filename>ipl</span> pakketloggende pseudo-apparaat te schrijven voor iedere regel met het sleutelwoord <code>log</code> erin.</p></div><div class=paragraph><p><code>options IPFILTER_DEFAULT_BLOCK</code> wijzigt het standaardgedrag zodat ieder pakket waarop geen enkele <code>pass</code> regel van toepassing is wordt geblokkeerd.</p></div><div class=paragraph><p>Deze instelling worden pas actief nadat een kernel waarvoor deze instellingen zijn gemaakt is gebouwd en geïnstalleerd.</p></div></div><div class=sect2><h3 id=_beschikbare_opties_voor_rc_conf_2>30.5.3. Beschikbare opties voor <span class=filename>rc.conf</span><a class=anchor href=#_beschikbare_opties_voor_rc_conf_2></a></h3><div class=paragraph><p>De volgende instellingen moeten in <span class=filename>/etc/rc.conf</span> staan om IPF bij het opstarten te activeren:</p></div><div class="literalblock programlisting"><div class=content><pre>ipfilter_enable=&#34;YES&#34;             # Start ipf firewall
ipfilter_rules=&#34;/etc/ipf.rules&#34;   # laad regels uit het doelbestand
ipmon_enable=&#34;YES&#34;                # Start IP monitor log
ipmon_flags=&#34;-Ds&#34;                 # D = start als daemon
                                  # s = log naar syslog
                                  # v = log tcp window, ack, seq
                                  # n = vertaal IP &amp; poort naar namen</pre></div></div><div class=paragraph><p>Als er een LAN achter de firewall staat dat gebruik maakt van IP-adressen uit de private reeks, dan moet de volgende optie ook ingesteld worden om NAT-functionaliteit in te schakelen:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;              # Schakel in als LAN gateway
ipnat_enable=&#34;YES&#34;                # Start ipnat functie
ipnat_rules=&#34;/etc/ipnat.rules&#34;    # bestand met regels voor ipnat</pre></div></div></div><div class=sect2><h3 id=_ipf>30.5.4. IPF<a class=anchor href=#_ipf></a></h3><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> wordt gebruikt om het bestand met firewallregels te laden. Gewoonlijk wordt er een bestand aangemaakt waarin de situatieafhankelijke regels staan waarmee in één keer de bestaande regels kunnen worden vervangen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipf -Fa -f /etc/ipf.rules</span></code></pre></div></div><div class=paragraph><p><code>-Fa</code>: verwijder alle interne tabellen met regels.</p></div><div class=paragraph><p><code>-f</code>: laad het aangegeven bestand met regels.</p></div><div class=paragraph><p>Hiermee wordt het mogelijk wijzigingen te maken aan het bestand met eigen regels en met <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> de firewall aan te passen met verse regels zonder het systeem te booten. Deze methode is erg handig om nieuwe regels te testen omdat dit zo vaak als nodig gedaan kan worden.</p></div><div class=paragraph><p>In <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> worden alle opties die beschikbaar zijn toegelicht.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> verwacht dat het bestand met regels een standaard tekstbestand is. Het accepteert geen bestand met regels dat is opgesteld als een script dat gebruik maakt van substitutie.</p></div><div class=paragraph><p>Er is wel een mogelijkheid om IPF regels op te stellen en gebruik te maken van substitutie. Meer informatie staat in <a href=#firewalls-ipf-rules-script>Script met regels met substitutie bouwen</a>.</p></div></div><div class=sect2><h3 id=_ipfstat>30.5.5. IPFSTAT<a class=anchor href=#_ipfstat></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> haalt de totalen van de statistieken op die horen bij de firewall sinds die is gestart en toont deze. Het kan ook zijn dat de tellers in tussentijd op nul zijn gesteld met <code>ipf -Z</code>.</p></div><div class=paragraph><p>In <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> worden alle details behandeld.</p></div><div class=paragraph><p>Standaard ziet <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> uitvoer er ongeveer als volgt uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>input packets: blocked 99286 passed 1255609 nomatch 14686 counted 0
output packets: blocked 4200 passed 1284345 nomatch 14687 counted 0
input packets logged: blocked 99286 passed 0
output packets logged: blocked 0 passed 0
packets logged: input 0 output 0
log failures: input 3898 output 0
fragment state<span class=o>(</span><span class=k>in</span><span class=o>)</span>: kept 0 lost 0
fragment state<span class=o>(</span>out<span class=o>)</span>: kept 0 lost 0
packet state<span class=o>(</span><span class=k>in</span><span class=o>)</span>: kept 169364 lost 0
packet state<span class=o>(</span>out<span class=o>)</span>: kept 431395 lost 0
ICMP replies: 0 TCP RSTs sent: 0
Result cache hits<span class=o>(</span><span class=k>in</span><span class=o>)</span>: 1215208 <span class=o>(</span>out<span class=o>)</span>: 1098963
IN Pullups succeeded: 2 failed: 0
OUT Pullups succeeded: 0 failed: 0
Fastroute successes: 0 failures: 0
TCP <span class=nb>cksum </span>fails<span class=o>(</span><span class=k>in</span><span class=o>)</span>: 0 <span class=o>(</span>out<span class=o>)</span>: 0
Packet log flags <span class=nb>set</span>: <span class=o>(</span>0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Als er als optie <code>-i</code> voor inkomend of <code>-o</code> voor uitgaand wordt meegegeven, dan zal het commando de juiste lijst met regels die de kernel op dat moment gebruikt wordt weergeven.</p></div><div class=paragraph><p><code>ipfstat -in</code> toont de tabel met regels voor inkomend verkeer met regelnummers</p></div><div class=paragraph><p><code>ipfstat -on</code> toont de tabel met regels voor uitgaand verkeer met regelnummers</p></div><div class=paragraph><p>De uitvoer ziet er ongeveer als volgt uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>@1 pass out on xl0 from any to any
@2 block out on dc0 from any to any
@3 pass out quick on dc0 proto tcp/udp from any to any keep state</code></pre></div></div><div class=paragraph><p><code>ipfstat -ih</code> toont de tabel met regels voor inkomend verkeer, waarbij voor iedere regel staat hoe vaak die van toepassing was.</p></div><div class=paragraph><p><code>ipfstat -oh</code> toont de tabel met regels voor uitgaand verkeer, waarbij voor iedere regel staat hoe vaak die van toepassing was.</p></div><div class=paragraph><p>De uitvoer ziet er ongeveer als volgt uit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>2451423 pass out on xl0 from any to any
354727 block out on dc0 from any to any
430918 pass out quick on dc0 proto tcp/udp from any to any keep state</code></pre></div></div><div class=paragraph><p>Een van de belangrijkste functies van <code>ipfstat</code> is de vlag <code>-t</code> waarmee de staat-tabel wordt getoond op een wijze die vergelijkbaar is met de wijze waarop <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> de draaiende FreeBSD procestabel toont. Als een firewall wordt aangevallen, dan geeft deze functie de mogelijkheid om de pakketten van de aanvaller te identificeren en nader te onderzoeken. De optionele subvlaggen bieden de mogelijkheid om een bron of bestemmings IP adres, poort of protocol aan te geven dat gemonitord moet worden. Details zijn na te lezen in <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a>.</p></div></div><div class=sect2><h3 id=_ipmon>30.5.6. IPMON<a class=anchor href=#_ipmon></a></h3><div class=paragraph><p>Om <a href="https://man.freebsd.org/cgi/man.cgi?query=ipmon&amp;sektion=8&amp;format=html">ipmon(8)</a> te laten werken zoals bedoeld, moet de kerneloptie <code>IPFILTER_LOG</code> aan staan. Dit commando kan op twee verschillende wijzen gebruikt worden. De standaard is van toepassing als het commando op de commandoregel wordt ingegeven zonder de optie <code>-D</code>.</p></div><div class=paragraph><p>De daemon wordt gebruikt als continu een systeemlogboek bijgewerkt moet worden zodat het mogelijk is om gebeurtenissen in het verleden te bekijken. Zo zijn FreeBSD en IPFILTER ingesteld om samen te werken. FreeBSD heeft ingebouwde mogelijkheden om automatisch syslogs te roteren. Daarom is het beter om de uitvoer naar <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> te schrijven dan naar een gewoon bestand. In de standaardversie van <span class=filename>rc.conf</span> is te zien dat de instelling <code>ipmon_flags</code> de waarde <code>-Ds</code> heeft:</p></div><div class="literalblock programlisting"><div class=content><pre>ipmon_flags=&#34;-Ds&#34; # D = start als daemon
                  # s = log naar syslog
                  # v = log tcp window, ack, seq
                  # n = vertaal IP &amp; poort naar namen</pre></div></div><div class=paragraph><p>De voordelen van loggen zijn duidelijk. Het biedt de mogelijkheid om na het feit informatie na te zien als: welke pakketten heeft de firewall laten vallen, waar kwamen ze vandaan en waar gingen ze heen? Dit zijn allemaal voordelen als het gaat om uitvinden waar een aanvaller vandaan komt en wat deze heeft geprobeerd.</p></div><div class=paragraph><p>Zelfs als loggen is ingeschakeld, logt IPF nog niets uit zichzelf. De beheerder van de firewall beslist welke regels in de regelverzameling iets weg moeten schrijven door het sleutelwoord <code>log</code> aan die regels toe te voegen. Gewoonlijk worden alleen <code>deny</code> regels gelogd.</p></div><div class=paragraph><p>Het is heel normaal om als laatste regel een <code>deny</code> regel aan de set met regels toe te voegen waar het sleutelwoord <code>log</code> in staat. Zo krijgt een beheerder alle pakketten te zien waarop geen enkele regel van toepassing was.</p></div></div><div class=sect2><h3 id=_loggen_met_ipmon>30.5.7. Loggen met IPMON<a class=anchor href=#_loggen_met_ipmon></a></h3><div class=paragraph><p>Syslogd heeft een eigen methode om logboekgegevens te scheiden. Het maakt gebruik van speciale groepen die "facility" en "level" heten. <a href="https://man.freebsd.org/cgi/man.cgi?query=ipmon&amp;sektion=8&amp;format=html">ipmon(8)</a> in <code>-Ds</code> mode gebruikt <code>local0</code> als "facility"naam. Alle door <a href="https://man.freebsd.org/cgi/man.cgi?query=ipmon&amp;sektion=8&amp;format=html">ipmon(8)</a> gelogde gegevens gaan standaard naar de naam <code>security</code>. De nu volgende levels kunnen gebruikt worden om de gelogde gegevens nog verder uit elkaar te trekken als dat gewenst is.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>LOG_INFO – pakketten gelogd met het sleutelwoord <span class=s2>&#34;log&#34;</span> als actie <span class=k>in </span>plaats van pass of block.
LOG_NOTICE – gelogde pakketten die ook zijn doorgelaten
LOG_WARNING – gelogde pakketten die ook geblokkeerd zijn
LOG_ERR – gelogde pakketten die een verkeerde opbouw hebben, <span class=s2>&#34;short&#34;</span></code></pre></div></div><div class=paragraph><p>Om IPFILTER alle gelogde gegevens naar <span class=filename>/var/log/ipfilter.log</span> te laten schrijven, dient dat bestand vooraf te bestaan. Dat kan met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/log/ipfilter.log</span></code></pre></div></div><div class=paragraph><p>De functionaliteit van <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> wordt beheerd met instellingen in <span class=filename>/etc/syslog.conf</span>. Dit bestand biedt aanzienlijke flexibiliteit in hoe syslog omgaat met systeemberichten die door softwaretoepassingen als IPF worden gegeven.</p></div><div class=paragraph><p>Zo kan de volgende instelling toegevoegd worden aan <span class=filename>/etc/syslog.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>local0.* /var/log/ipfilter.log</pre></div></div><div class=paragraph><p>Het deel <code>local0.*</code> betekent dat alle logberichten naar de aangegeven plaats geschreven moeten worden.</p></div><div class=paragraph><p>Om de wijzigingen in <span class=filename>/etc/syslog.conf</span> actief te maken kan er opnieuw opgestart worden of is het mogelijk de daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> een schop te geven zodat <span class=filename>/etc/syslog.conf</span> opnieuw wordt ingelezen met <code>/etc/rc.d/syslogd reload</code>. Het PID (procesnummer) is te achterhalen door een overzicht van taken te tonen met <code>ps -ax</code>. Het PID is het nummer in de linker kolom voor de regel waarop "syslog" staat.</p></div><div class=paragraph><p>Vaak wordt vergeten <span class=filename>/etc/newsyslog.conf</span> te wijzigen om het nieuw aangemaakte logboekbestand te laten roteren.</p></div></div><div class=sect2><h3 id=_de_opmaak_van_gelogde_berichten>30.5.8. De opmaak van gelogde berichten<a class=anchor href=#_de_opmaak_van_gelogde_berichten></a></h3><div class=paragraph><p>Berichten die door <code>ipmon</code> wordt gezonden bestaan uit velden die gescheiden worden door een spatie. Velden die in alle berichten zitten zijn:</p></div><div class="olist arabic"><ol class=arabic><li><p>De datum waarop het pakket is ontvangen.</p></li><li><p>De tijd waarop het pakket is ontvangen weergegeven als HH:MM:SS.F voor uren, minuten, seconden en fracties van een seconde. De fractie kan meerdere cijfers lang zijn.</p></li><li><p>De naam van de interface waarop het pakket is ontvangen, bijvoorbeeld <span class=filename>dc0</span>.</p></li><li><p>De groep en regelnummer van de regel, bijvoorbeeld <code>@0:17</code>.</p></li></ol></div><div class=paragraph><p>Deze kunnen ingezien worden met <code>ipfstat -in</code>.</p></div><div class="olist arabic"><ol class=arabic><li><p>De acties: <code>p</code> voor doorgelaten ("passed"), <code>b</code> voor geblokkeerd ("blocked"), <code>S</code> voor een verkeerd pakket ("short packet"), <code>n</code> voor dat er geen enkele regel van toepassing was, <code>L</code> voor een logboekregel. De volgorde waarin deze acties getoond worden is: S, p, b, n, L. Een hoofdletter <code>P</code> of <code>B</code> betekent dat het pakket gelogd is vanwege een globale instelling, niet vanwege één regel in het bijzonder.</p></li><li><p>De adressen. Dit zijn eigenlijk drie velden: het bronadres en poort gescheiden door een komma, het symbool → en het bestemmingsadres en poort, bijvoorbeeld: <code>209.53.17.22,80 → 198.73.220.17,1722</code>.</p></li><li><p>Achter <code>PR</code> staat de naam van het protocol of het nummer, bijvoorbeeld <code>PR tcp</code>.</p></li><li><p>Achter <code>len</code> staan de lengte van de pakketkop en de totale lengte van het pakket, bijvoorbeeld <code>len 20 40</code>.</p></li></ol></div><div class=paragraph><p>Als het pakket een TCP pakket is, dan is er nog een veld dat begint met een verbindingsstreepje met daarachter letters die overeenkomen met vlaggen die ingeschakeld waren. In <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=5&amp;format=html">ipf(5)</a> is een lijst met letters en bijbehorende vlaggen te vinden.</p></div><div class=paragraph><p>Als het pakket een ICMP pakket is, dan worden aan het einde twee velden toegevoegd. Het eerste is altijd <code>ICMP</code> en het volgende het ICMP bericht en subbericht type, gescheiden door een slash, bijvoorbeeld <code>ICMP 3/3</code> voor "een poort niet bereikbaar" bericht.</p></div></div><div class=sect2><h3 id=firewalls-ipf-rules-script>30.5.9. Script met regels met substitutie bouwen<a class=anchor href=#firewalls-ipf-rules-script></a></h3><div class=paragraph><p>Geoefende gebruikers van IPF maken een bestand dat de regels bevat en stellen dat op zo’n manier op dat het uitgevoerd kan worden als een script met substitutie. Het grote voordeel van deze werkwijze is dat er dan alleen de waarde geassocieerd met een symbolische naam gewijzigd hoeft te worden en dat als het script opnieuw wordt uitgevoerd, op alle plaatsen waar de variabele wordt gebruikt, de nieuwe waarde in de regels wordt opgenomen. Omdat het een script is, kan substitutie gebruik worden om vaak voorkomende waarden de definiëren zodat ze in meerdere regels vervangen kunnen worden. Dit wordt geïllustreerd in het onderstaande voorbeeld.</p></div><div class=paragraph><p>De syntaxis die in het script wordt gebruikt is compatibel met de shells <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=tcsh&amp;sektion=1&amp;format=html">tcsh(1)</a>.</p></div><div class=paragraph><p>Velden waarvoor substitutie van toepassing is worden vooraf gegaan door het dollarteken <code>$</code>.</p></div><div class=paragraph><p>Definities worden niet vooraf gegaan door het voorvoegsel $.</p></div><div class=paragraph><p>De waarden van een definitie moet omsloten worden door dubbele aanhalingstekens (<code>"</code>).</p></div><div class=paragraph><p>Een set regels begint wellicht als volgt:</p></div><div class="literalblock programlisting"><div class=content><pre>############## Begin IPF regels script #########################
oif=&#34;dc0&#34;            # naam van de uitgaande interface
odns=&#34;192.0.2.11&#34;    # IP adres van DNS server ISP
myip=&#34;192.0.2.7&#34;     # statische IP adres gekregen van ISP
ks=&#34;keep state&#34;
fks=&#34;flags S keep state&#34;

# Er kan gekozen worden om dit script te gebruiken om een eigen
# /etc/ipf.rules script te maken of dit script kan gebruikt worden
# &#34;as is&#34;
#
# Haal bij één van deze regels het commentaarteken weg
# en plaats hem bij de ander.
#
# 1) Deze kan gebruikt worden om /etc/ipf.rules te maken:
#cat &gt; /etc/ipf.rules &lt;&lt; EOF
# 2) Deze kan gebruikt worden om het script &#34;as is&#34; te starten:
# Let op: er moet een lege regel zijn na het EOF teken.
/sbin/ipf -Fa -f - &lt;&lt; EOF

# Verleen toegang tot de DNS van de ISP.
pass out quick on $oif proto tcp from any to $odns port = 53 $fks
pass out quick on $oif proto udp from any to $odns port = 53 $ks

# Sta uitgaand verkeer voor niet beveiligd www verkeer toe
pass out quick on $oif proto tcp from $myip to any port = 80 $fks

# Sta uitgaand verkeer voor beveiligd www verkeer toe (https over TLS SSL)
pass out quick on $oif proto tcp from $myip to any port = 443 $fks
EOF
################## Einde IPF regels script ########################</pre></div></div><div class=paragraph><p>Dat is alles. De regels zijn niet van belang in dit voorbeeld, maar tonen hoe substitutievelden worden gedefinieerd en hoe ze worden gebruikt. Als het bovenstaande voorbeeld de inhoud van <span class=filename>/etc/ipf.rules.script</span> was, dan konden deze regels herladen worden door het vanaf de commandoregel aan te roepen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sh /etc/ipf.rules.script</span></code></pre></div></div><div class=paragraph><p>Er is wel een probleem met het gebruik van regels in combinatie met substitutie. IPF snapt het niet en kan deze scripts niet direct lezen.</p></div><div class=paragraph><p>Dit script kan gebruikt worden op één van de volgende twee manieren:</p></div><div class=ulist><ul><li><p>Haal het commentaarteken weg bij de regel die begint met <code>cat</code> en zet het commentaarteken bij de regel die begint met <code>/sbin/ipf</code>. Plaats <code>ipfilter_enable="YES"</code> in <span class=filename>/etc/rc.conf</span> zoals gewoonlijk en start het script eenmalig na elke wijziging om <span class=filename>/etc/ipf.rules</span> te maken of bij te werken.</p></li><li><p>Schakel IPFILTER uit in de systeem opstart scripts door <code>ipfilter_enable="NO"</code> toe te voegen aan <span class=filename>/etc/rc.conf</span> (dit is de standaardwaarde).</p><div class=paragraph><p>Voeg een script zoals de volgende toe aan de opstartmap <span class=filename>/usr/local/etc/rc.d</span>. Het script zou een duidelijke naam moeten hebben zoals <span class=filename>ipf.loadrules.sh</span>. De uitbreiding <span class=filename>.sh</span> is noodzakelijk.</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
sh /etc/ipf.rules.script</pre></div></div><div class=paragraph><p>De permissies op dit script moeten zijn: lezen,schrijven en uitvoeren voor de gebruiker <code>root</code>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 700 /usr/local/etc/rc.d/ipf.loadrules.sh</span></code></pre></div></div></li></ul></div><div class=paragraph><p>Als het systeem nu herstart, worden de regels via het script gestart.</p></div></div><div class=sect2><h3 id=_sets_van_ipf_regels>30.5.10. Sets van IPF regels<a class=anchor href=#_sets_van_ipf_regels></a></h3><div class=paragraph><p>Een set regels is een groep IPF-regels die is gemaakt om pakketten toe te staan of te blokkeren op basis van de eigenschappen van dat pakket. De bi-directionele uitwisseling van pakketten tussen hosts bestaat uit een gesprek dat een sessie heet. De set van firewallregels verwerkt zowel de pakketten die arriveren van het publieke Internet, als de pakketten die door het systeem zijn geproduceerd als een antwoord erop. Elke TCP/IP-dienst (telnet, www, mail, enzovoorts) is vooraf gedefinieerd door een protocol en bevoorrechte (luister)poort. Pakketten bedoeld voor een speciale dienst beginnen bij het bronadres gebruik makend van een onbevoorrechte (hogere orde) poort en komen aan bij de specifieke dienstpoort op het bestemmingsadres. Alle bovengenoemde parameters (poorten en adressen) kunnen gebruikt worden als selectiecriteria om regels aan te maken die diensten zullen toestaan of blokkeren.</p></div><div class=paragraph><p>IPF is oorspronkelijk geschreven met logica die regels verwerkte volgens het principe "de laatst passende regel wint" en gebruikte toen alleen staatloze regels. In de loop der tijd is IPF verbeterd en zijn de opties "quick" en "keep state" toegevoegd waarmee de logica van het verwerken van regels drastisch is gemoderniseerd.</p></div><div class=paragraph><p>De instructies in dit hoofdstuk zijn gebaseerd op regels die gebruik maken van de optie "quick" en de stateful optie "keep state". Dit is het raamwerk waarmee een set van inclusieve firewallregels wordt samengesteld.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Werk bij het wijzigen van firewallregels <em>zeer voorzichtig</em>. Met sommige instellingen is een server <em>niet meer bereikbaar</em>. Om het veilig te spelen is het aan te raden de eerste instellingen vanaf het console te maken, in plaats van via ssh.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_regelsyntaxis>30.5.11. Regelsyntaxis<a class=anchor href=#_regelsyntaxis></a></h3><div class=paragraph><p>De regelsyntaxis die hier wordt besproken is versimpeld door alleen de moderne stateful regels en de "eerste van toepassing zijnde regel wint" te belichten. De complete regelsyntaxis is na te lezen in <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a>.</p></div><div class=paragraph><p>Het karakter <code>#</code> wordt gebruikt om het begin van een opmerking te markeren en zowel op een eigen regel als achter een firewallregel staan. Lege regels worden genegeerd.</p></div><div class=paragraph><p>Regels bevatten sleutelwoorden die in een bepaalde volgorde van links naar rechts op een regel horen te staan. Sleutelwoorden worden vet weergegeven. Sommige sleutelwoorden hebben subopties die zelf ook weer sleutelwoorden hebben die ook weer subopties kunnen hebben. Alle opties die hier direct onder staan, worden daaronder uitgebreid weergegeven en verderop in dit hoofdstuk in een aparte paragraaf behandeld.</p></div><div class=paragraph><p><em>ACTIE IN/UIT OPTIES SELECTIE STATEFUL PROTO BRON_ADR,BEST_ADR OBJECT POORT_NUM TCP_VLAG STATEFUL</em></p></div><div class=paragraph><p><em>ACTIE</em> = block | pass</p></div><div class=paragraph><p><em>IN/UIT</em> = in | out</p></div><div class=paragraph><p><em>OPTIES</em> = log | quick | on interfacenaam</p></div><div class=paragraph><p><em>SELECTIE</em> = protowaarde | bron/bestemming IP | poort = nummer | flags flag-value</p></div><div class=paragraph><p><em>PROTO</em> = tcp/udp | udp | tcp | icmp</p></div><div class=paragraph><p><em>BRON_ADR,BEST_ADR</em> = all | from object to object</p></div><div class=paragraph><p><em>OBJECT</em> = IP adres | any</p></div><div class=paragraph><p><em>POORT_NUM</em> = poortnummer</p></div><div class=paragraph><p><em>TCP_VLAG</em> = S</p></div><div class=paragraph><p><em>STATEFUL</em> = keep state</p></div><div class=sect3><h4 id=_actie>30.5.11.1. ACTIE<a class=anchor href=#_actie></a></h4><div class=paragraph><p>De actie geeft aan wat er met het pakket gedaan moet worden als het van toepassing is op de rest van de filterregel. Iedere regel <em>moet</em> een actie hebben. De volgende acties zijn mogelijk:</p></div><div class=paragraph><p><code>block</code> geeft aan dat het pakket moet verdwijnen als de parameters van toepassing zijn op het pakket.</p></div><div class=paragraph><p><code>pass</code> geeft aan dat het pakket doorgelaten moet worden als de parameters van toepassing zijn op het pakket.</p></div></div><div class=sect3><h4 id=_inuit>30.5.11.2. IN/UIT<a class=anchor href=#_inuit></a></h4><div class=paragraph><p>Een verplicht onderdeel voor iedere filterregel waarin expliciet wordt aangegeven op welke zijde van de in/uit deze van toepassing is. Het volgende sleutelwoord moet <code>in</code> of <code>out</code> zijn en één van de twee moet gecodeerd worden, anders is de regel syntactisch onjuist.</p></div><div class=paragraph><p><code>in</code> betekent dat de regel van toepassing is op inkomende pakketten.</p></div><div class=paragraph><p><code>out</code> betekent dat de regel van toepassing is op inkomende pakketten.</p></div></div><div class=sect3><h4 id=_opties>30.5.11.3. OPTIES<a class=anchor href=#_opties></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Deze opties moeten in de volgorde waarin ze hier beschreven staan gebruikt worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p><code>log</code> geeft aan dat het pakket naar het <span class=filename>ipl</span> logboekbestand geschreven moeten worden (zoals verderop beschreven staat in de paragraaf "Loggen") als de regel van toepassing is op het pakket.</p></div><div class=paragraph><p><code>quick</code> geeft aan dat als een regel van toepassing is, dat de laatste regel moet zijn die wordt gecontroleerd, waardoor er een pad wordt "kortgesloten" waardoor de volgende regels voor dat pakket niet meer gecontroleerd worden. Deze optie is voor de moderne regels eigenlijk verplicht.</p></div><div class=paragraph><p><code>on</code> geeft de interface aan die in de parameters meegenomen moet worden. De namen van interfaces kunnen getoond worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a>. Als deze optie wordt gebruikt, kan een regel alleen van toepassing zijn als het pakket door de aangegeven interface gaat in de richting die is aangegeven (<code>in</code>/<code>out</code>). Ook deze optie is verplicht voor de moderne regels.</p></div><div class=paragraph><p>Als een pakket wordt gelogd, dan worden de koppen van het pakket weggeschreven naar het ipl pakketloggende pseudo-apparaat. Direct na het sleutelwoord <code>log</code> mogen de volgende opties gebruikt worden (in de aangegeven volgorde):</p></div><div class=paragraph><p><code>body</code> geeft aan dat de eerste 128 bytes van de inhoud van het pakket worden opgeslagen na de kop.</p></div><div class=paragraph><p><code>first</code>; als het sleutelwoord <code>log</code> samen met een optie <code>keep state</code> wordt gebruikt, wordt het aangeraden om deze optie ook te gebruiken zodat alleen het pakket dat als eerste in de sessie van toepassing was en niet ook alle pakketten die daarna in de sessie volgens <code>keep state</code> van toepassing zijn.</p></div></div><div class=sect3><h4 id=_selectie>30.5.11.4. SELECTIE<a class=anchor href=#_selectie></a></h4><div class=paragraph><p>De sleutelwoorden in deze paragraaf worden gebruikt om attributen van het pakket dat wordt geïnspecteerd te beschrijven om te bepalen of een regel wel of niet van toepassing is. Er is een sleutelwoord <code>subject</code> en er zijn subopties waarvan er één of meer gekozen moeten worden. De volgende attributen zijn beschikbaar voor het proces en moeten in de aangegeven volgorde worden gebruikt:</p></div></div><div class=sect3><h4 id=_proto>30.5.11.5. PROTO<a class=anchor href=#_proto></a></h4><div class=paragraph><p><code>proto</code> is het <code>subject</code> sleutelwoord dat moet worden aangegeven samen met een van de sleutelwoorden uit de subopties. De waarde geeft een bepaald protocol aan dat van toepassing moet zijn. Ook deze optie is verplicht voor de moderne regels.</p></div><div class=paragraph><p><code>tcp/udp</code>, <code>tcp</code>, <code>udp</code>, <code>icmp</code> of ieder ander protocol dat in <span class=filename>/etc/protocols</span> staat wordt herkend en kan gebruikt worden. Het bijzondere protocolsleutelwoord <code>tcp/udp</code> kan gebruikt worden om zowel voor TCP- als UDP-pakketten van toepassing te laten zijn. Het is toegevoegd voor het gemak om vrijwel gelijke regels te voorkomen.</p></div></div><div class=sect3><h4 id=_bron_adrbest_adr>30.5.11.6. BRON_ADR/BEST_ADR<a class=anchor href=#_bron_adrbest_adr></a></h4><div class=paragraph><p>Het sleutelwoord <code>all</code> is in feite hetzelfde als <code>from any to any</code> zonder overige parameters.</p></div><div class=paragraph><p><code>from bron to bestemming</code>; de sleutelwoorden <code>from</code> en <code>to</code> worden gebruikt om te testen op IP-adressen. In regels moet <em>zowel</em> een bron- <em>als</em> bestemmings-IP-adres aangegeven worden. <code>any</code> is een bijzonder sleutelwoord dat van toepassing is op ieder IP-adres. Voorbeelden van gebruik: <code>from any to any</code> of <code>from 0.0.0.0/0 to any</code> of <code>from any to 0.0.0.0/0</code> of <code>from 0.0.0.0 to any</code> of <code>from any to 0.0.0.0</code>.</p></div><div class=paragraph><p>Het is vaak lastig om te komen tot een reeks IP-adressen die zich niet gemakkelijk laten uitdrukken met de gepunte numerieke vorm/ maskerlengte notatie. De port <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/ipcalc/>net-mgmt/ipcalc</a> kan gebruikt worden om de berekeningen te vereenvoudigen. Aanvullende informatie is beschikbaar op de webpagina van het gereedschap: <a href=http://jodies.de/ipcalc>http://jodies.de/ipcalc</a>.</p></div></div><div class=sect3><h4 id=_poort>30.5.11.7. POORT<a class=anchor href=#_poort></a></h4><div class=paragraph><p>Als in een regel op een poort wordt gecontroleerd, voor bron- of bestemmingspoort of beiden, dan is dat alleen van toepassing op TCP- en UDP-pakketten. Bij het maken van poortvergelijkingen kunnen zowel de dienstnamen uit <span class=filename>/etc/services</span> als een uit een natuurlijk getal bestaand poortnummer ingesteld worden. Als de poort onderdeel is van het <code>from</code> object dan wordt het vergeleken met het poortnummer van de bron en als het onderdeel is van het <code>to</code> object, dan wordt het vergeleken met het poortnummer van de bestemming. Het gebruik van het <code>to</code> object is in de moderne regels verplicht en neemt de vorm aan van <code>from any to any port = 80</code>.</p></div><div class=paragraph><p>Enkelvoudige poortvergelijkingen kunnen op verschillende manieren gedaan worden met een aantal verschillende operatoren. Er kunnen ook reeksen van poorten ingesteld worden.</p></div><div class=paragraph><p>poort "=" | "!=" | "&lt;" | ">" | "⇐" | ">=" | "eq" | "ne" | "lt" | "gt" | "le" | "ge"</p></div><div class=paragraph><p>Reeksen van poorten worden met de volgende optie aangegeven: poort &lt;> | >&lt;</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>De volgende twee parameters die betrekking hebben op bron en bestemming, zijn verplicht in de moderne regels.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_tcp_vlag>30.5.11.8. TCP_VLAG<a class=anchor href=#_tcp_vlag></a></h4><div class=paragraph><p>Vlaggen zijn alleen beschikbaar voor het filteren van TCP. De letters staan voor de mogelijke vlaggen die bekeken kunnen worden in de kop van een TCP-pakket.</p></div><div class=paragraph><p>In de moderne regels wordt de optie <code>flags S</code> gebruikt om het verzoek tot het starten van een TCP sessie.</p></div></div><div class=sect3><h4 id=_stateful>30.5.11.9. STATEFUL<a class=anchor href=#_stateful></a></h4><div class=paragraph><p><code>keep state</code> geeft aan dat in een regel met <code>pass</code> voor alle pakketten die van toepassing zijn stateful gefilterd moet worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Deze optie is voor moderne regels verplicht.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=_stateful_filteren>30.5.12. Stateful filteren<a class=anchor href=#_stateful_filteren></a></h3><div class=paragraph><p>Met stateful filteren wordt verkeer benaderd als een uitwisseling van pakketten tussen twee kanten die een sessie zijn. Als het is ingeschakeld, dan maakt het <code>keep state</code> mechanisme dynamisch interne regels voor pakketten die in de sessie horen te volgen. Het kan bekijken of de karakteristieken van de sessie tussen verzender en ontvanger de juiste procedure volgen. Alle pakketten die niet passen in de sessie, worden automatisch geblokkeerd.</p></div><div class=paragraph><p><code>keep state</code> staat ook ICMP-pakketten toe die gerelateerd zijn aan een TCP- of UDP-sessie. Dus als er een ICMP-type 3 code 4 komt in antwoord op websurfen, dat wordt toegestaan van binnen naar buiten door een <code>keep state</code> regel, dan wordt dat toegelaten. Pakketten waarvan IPF zeker is dat ze onderdeel zijn van de sessie worden toegelaten, zelfs als ze van een ander protocol zijn.</p></div><div class=paragraph><p>Wat er gebeurt: pakketten die naar buiten gaan op de interface die met Internet is verbonden worden eerst vergeleken met de dynamische staattabel. Als een pakket voldoet aan de verwachting van het volgende pakket in de sessie, dan mag het de firewall verlaten en wordt de toestand van de sessie in de dynamische toestandstabel bijgewerkt. Pakketten die niet bij een reeds actieve sessie horen, worden tegen de uitgaande regelverzameling gecontroleerd.</p></div><div class=paragraph><p>Pakketten die binnenkomen op de interface die met Internet is verbonden worden eerst vergeleken met de dynamische staattabel. Als een pakket voldoet aan de verwachting van het volgende pakket in de sessie, dan mag het de firewall verlaten en wordt de toestand van de sessie in de dynamische toestandstabel bijgewerkt. Pakketten die niet bij een reeds actieve sessie horen, worden vergeleken met de regelverzameling voor binnenkomend verkeer.</p></div><div class=paragraph><p>Als de sessie wordt beëindigd wordt het uit de dynamische staattabel verwijderd.</p></div><div class=paragraph><p>Met stateful filteren is het mogelijk om de focus te leggen op het blokkeren of toestaan van nieuwe sessies. Als een nieuwe sessie tot stand mag komen, dan worden alle volgende pakketten automatisch doorgelaten en al het vervalste verkeer wordt automatisch tegengehouden. Als een nieuwe sessie wordt geweigerd, dan wordt geen enkel pakket doorgelaten. Met stateful filteren zijn er uitgebreide mogelijkheden voor onderzoek om bescherming te bieden tegen de veelheid aan aanvallen die tegenwoordig door aanvallers worden uitgevoerd.</p></div></div><div class=sect2><h3 id=_voorbeeld_van_inclusieve_regels>30.5.13. Voorbeeld van inclusieve regels<a class=anchor href=#_voorbeeld_van_inclusieve_regels></a></h3><div class=paragraph><p>De onderstaande regels zijn een voorbeeld van hoe een erg veilige inclusieve firewall opgezet kan worden. Een inclusieve firewall staat alleen diensten toe die passen bij de <code>pass</code>-regels en blokkeert al het overige verkeer. Firewalls die bedoeld zijn om andere machines te beschermen, ook wel "netwerk-firewalls" genoemd, dienen tenminste twee interfaces te hebben, die over het algemeen zijn ingesteld om de ene kant te vertrouwen (het LAN) maar niet de andere (het publieke Internet). Ook kan een firewall worden ingesteld om alleen het systeem te beschermen waarop het draait-dit wordt een "host-gebaseerde firewall" genoemd, en is in het bijzonder geschikt voor servers op een onvertrouwd netwerk.</p></div><div class=paragraph><p>Alle UNIX® systemen en dus ook FreeBSD zijn zo ontworpen dat ze voor interne communicatie de interface <span class=filename>lo0</span> en IP adres <code>127.0.0.1</code> gebruiken. De firewall moet dit interne verkeer gewoon doorgang laten vinden.</p></div><div class=paragraph><p>Voor de interface die is verbonden met het publieke Internet worden regels gemaakt waarmee de toegang voor uitgaande en binnenkomende verbindingen worden geautoriseerd en beheerst. Dit kan de PPP-interface <span class=filename>tun0</span> zijn of de netwerkkaart die is verbonden met een xDSL- of kabelmodem.</p></div><div class=paragraph><p>In gevallen dat er één of meer netwerkkaarten zijn aangesloten op private netwerksegmenten kunnen er regels op de firewall nodig zijn om pakketten die van die LAN-interfaces afkomen vrije doorgang te geven naar elkaar en/of naar buiten (het Internet).</p></div><div class=paragraph><p>De regels worden opgedeeld in drie onderdelen: eerst de vertrouwde interfaces, dan het publieke uitgaande interface en als laatste het onvertrouwde publieke binnenkomende interfaces.</p></div><div class=paragraph><p>In iedere sectie moeten zo staan dat de regels die het meest gebruikt worden vóór de regels die minder vaak gebruikt worden staan. De laatste regel van een onderdeel geeft aan dat al het overige verkeer op die interface in die richting geblokkeerd en gelogd moet worden.</p></div><div class=paragraph><p>In het onderdeel Uitgaand staan alleen regels met <code>pass</code> die parameters bevatten om uniek individuele diensten identificeren die het publieke Internet mogen benaderen. Bij al die regels staan de opties <code>quick</code>, <code>on</code>, <code>proto</code>, <code>port</code> en <code>keep state</code> aan. De regels met <code>proto tcp</code> maken ook gebruik van de optie <code>flag</code> om te bekijken of het een pakket betreft voor het opzetten van een sessie om de stateful functionaliteit aan te sturen.</p></div><div class=paragraph><p>In het onderdeel Inkomend staan eerst alle regels voor het blokkeren van ongewenste pakketten, om twee redenen. Als eerste kan het zo zijn dat kwaadaardige pakketten gedeeltelijk overeenkomen met legitiem verkeer. Deze pakketten moeten worden weggegooid in plaats van binnengelaten te worden, gebaseerd op hun gedeeltelijke match met de <code>allow</code>-regels. De tweede reden is dat bekende en oninteressante verwerpingen stil geblokkeerd kunnen worden in plaats van gevangen en gelogd te worden door de laatste regels in de sectie. De laatste regel in elke sectie blokkeert en logt alle pakketten en kan worden gebruikt voor het wettelijke bewijs nodig om degenen die uw systeem aanvallen aan te klagen.</p></div><div class=paragraph><p>Waar ook gezorgd voor moet worden is dat al het verkeer dat wordt geweigerd geen antwoord verstuurd. Ongeldige pakketten dienen gewoon te verdwijnen. Zo weet een aanvaller niet of een pakket het doelsysteem wel heeft bereikt. Zo kan een aanvaller geen informatie verzamelen over een systeem: hoe minder informatie er over een systeem beschikbaar is, hoe meer tijd iemand erin moet steken voordat er iets slechts gedaan kan worden. Regels die een optie <code>log first</code> bevatten, zullen alleen de eerste keer dat de gebeurtenis voorkomt de gebeurtenis loggen. Deze optie is opgenomen in de voorbeeldregel <code>nmap OS fingerpint</code>. Het gereedschap <a class=package href=https://cgit.freebsd.org/ports/tree/security/nmap/>security/nmap</a> wordt vaak door aanvallers gebruikt om het besturingssysteem van uw server proberen te achterhalen.</p></div><div class=paragraph><p>We raden aan om telkens als er logmeldingen van een regel met de optie <code>log first</code> komen, <code>ipfstat -hio</code> uit te voeren om te bekijken hoe vaak de regel van toepassing is geweest. Een groot aantal overeenkomsten geeft gewoonlijk aan dat de firewall overspoeld wordt, met andere woorden aangevallen wordt.</p></div><div class=paragraph><p>Het bestand <span class=filename>/etc/services</span> kan gebruikt worden om onbekende poortnummers op te zoeken. Ook kan <a href=http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers>http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers</a> worden bezocht en het poortnummer worden opgezocht om het doel van een bepaalde poort uit te vinden.</p></div><div class=paragraph><p>Op de volgende link worden poortnummers van Trojans beschreven: <a href=http://www.sans.org/security-resources/idfaq/oddports.php>http://www.sans.org/security-resources/idfaq/oddports.php</a>.</p></div><div class=paragraph><p>De onderstaande set regels is een complete en erg veilige <code>inclusieve</code> set met regels voor een firewall die is getest op productiesystemen. Deze set met regels is eenvoudig aan te passen voor uw eigen systeem. Maak gewoon commentaar van elke <code>pass</code>-regel voor een dienst die niet gewenst is.</p></div><div class=paragraph><p>Logberichten die niet gewenst zijn, zijn uit te sluiten door een <code>block</code>-regel toe te voegen in het begin van het onderdeel Inkomend.</p></div><div class=paragraph><p>Voor de onderstaande regels dient de <span class=filename>dc0</span> interfacenaam in iedere regel vervangen te worden door de echte interfacenaam van de netwerkkaart in het systeem die met het publieke Internet is verbonden. Voor gebruikers van PPP zou dat <span class=filename>tun0</span> zijn.</p></div><div class=paragraph><p>Dit zou de inhoud van <span class=filename>/etc/ipf.rules</span> kunnen zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>#################################################################
# Geen beperkingen op de interface aan de LAN kant.
# Niet nodig als er geen LAN is.
################################################################

#pass out quick on xl0 all
#pass in quick on xl0 all

#################################################################
# Geen beperkingen op de loopback interface
#################################################################
pass in quick on lo0 all
pass out quick on lo0 all

#################################################################
# Interface aan het publieke Internet (onderdeel Uitgaand).
# Inspecteer verzoeken om een sessie te starten van achter de
# firewall op het private netwerk of vanaf deze gateway-server
# naar het publieke Internet.
#################################################################

# Geef toegang tot de DNS server van de ISP.
# xxx moet het IP adres van de DNS van de ISP zijn.
# Dupliceer deze regels als een ISP meerdere DNS servers heeft.
# Haal het IP adres evt. uit /etc/resolv.conf.
pass out quick on dc0 proto tcp from any to xxx port = 53 flags S keep state
pass out quick on dc0 proto udp from any to xxx port = 53 keep state

# Geef toegang tot de DHCP server van de ISP voor kabel- en
# xDSL-netwerken. Deze regel is niet nodig als gebruik gemaakt worden
# van PPP naar het publieke Internet. In dat geval kan de hele groep
# verwijderd worden. Gebruik de volgende regel en controleer het
# logboek voor het IP adres. Wijzig dan het IP adres in de regel
# commentaar hieronder en verwijder de eerste regel.
pass out log quick on dc0 proto udp from any to any port = 67 keep state
#pass out quick on dc0 proto udp from any to z.z.z.z port = 67 keep state

# Sta niet beveiligd www verkeer toe.
pass out quick on dc0 proto tcp from any to any port = 80 flags S keep state

# Sta beveiligd www verkeer over TLS SSL toe.
pass out quick on dc0 proto tcp from any to any port = 443 flags S keep state

# Sta het verzenden en ontvangen van e-mail toe.
pass out quick on dc0 proto tcp from any to any port = 110 flags S keep state
pass out quick on dc0 proto tcp from any to any port = 25 flags S keep state

# Sta Time toe.
pass out quick on dc0 proto tcp from any to any port = 37 flags S keep state

# Sta uitgaand NNTP nieuws toe.
pass out quick on dc0 proto tcp from any to any port = 119 flags S keep state

# Sta uitgaande lokale niet beveiligde FTP (ook van LAN-gebruikers) toe
# (zowel passieve als actieve modes).  Deze functie maakt gebruik van
# de in IP-NAT ingebouwde FTP-proxy die in het bestand met NAT-regels
# staat om dit in één regel te laten werken. Als er met
# pkg_add pakketten toegevoegd moeten kunnen worden op een systeem, dan
# is deze regel nodig.
pass out quick on dc0 proto tcp from any to any port = 21 flags S keep state

# Sta uitgaande SSH/SFTP/SCP toe (vervangingen van telnet/rlogin/FTP)
# Deze functie maakt gebruik van SSH (secure shell)
pass out quick on dc0 proto tcp from any to any port = 22 flags S keep state

# Sta uitgaande niet beveiligde telnet toe.
pass out quick on dc0 proto tcp from any to any port = 23 flags S keep state

# Sta de FreeBSD CVSUP-functie toe.
pass out quick on dc0 proto tcp from any to any port = 5999 flags S keep state

# Sta ping toe naar het publieke Internet.
pass out quick on dc0 proto icmp from any to any icmp-type 8 keep state

# Sta whois toe vanaf het LAN naar het publieke Internet.
pass out quick on dc0 proto tcp from any to any port = 43 flags S keep state

# Blokkeer en log het eerste voorkomen van al het andere dat probeert
# buiten te komen. Deze regel implementeert de standaard-blokkade.
block out log first quick on dc0 all

#################################################################
# Interface aan het publieke Internet (onderdeel Inkomend).
# Inspecteert pakketten die van het publieke Internet komen
# met als bestemming deze gateway-server of het private netwerk.
#################################################################

# Blokkeer al het verkeer voor niet-routeerbare of gereserveerde
# adresreeksen.
block in quick on dc0 from 192.168.0.0/16 to any    #RFC 1918 privaat IP
block in quick on dc0 from 172.16.0.0/12 to any     #RFC 1918 privaat IP
block in quick on dc0 from 10.0.0.0/8 to any        #RFC 1918 privaat IP
block in quick on dc0 from 127.0.0.0/8 to any       #loopback
block in quick on dc0 from 0.0.0.0/8 to any         #loopback
block in quick on dc0 from 169.254.0.0/16 to any    #DHCP auto-config
block in quick on dc0 from 192.0.2.0/24 to any      #gereserveerd voor documentatie
block in quick on dc0 from 204.152.64.0/23 to any   #Sun cluster interconnect
block in quick on dc0 from 224.0.0.0/3 to any       #Klasse D &amp; E multicast

##### Blokkeer wat vervelende dingen ############
# die niet in de logboeken moeten komen.

# Blokkeer fragmenten.
block in quick on dc0 all with frags

# Block korte TCP pakketten.
block in quick on dc0 proto tcp all with short

# Blokkeer source gerouteerde pakketten.
block in quick on dc0 all with opt lsrr
block in quick on dc0 all with opt ssrr

# Blokkeer pogingen voor nmap OS fingerprint.
# Blokkeer het eerste voorkomen ervan voor de IP-adressen
block in log first quick on dc0 proto tcp from any to any flags FUP

# Blokkeer alles met speciale opties.
block in quick on dc0 all with ipopts

# Blokkeer publieke pings.
block in quick on dc0 proto icmp all icmp-type 8

# Blokkeer ident.
block in quick on dc0 proto tcp from any to any port = 113

# Blokkeer alle Netbios diensten. 137=naam, 138=datagram, 139=sessie.
# Netbios is de Windows(R) bestandsdeeldienst.
# Blokkeer Windows(R) hosts2 name server verzoeken 81.
block in log first quick on dc0 proto tcp/udp from any to any port = 137
block in log first quick on dc0 proto tcp/udp from any to any port = 138
block in log first quick on dc0 proto tcp/udp from any to any port = 139
block in log first quick on dc0 proto tcp/udp from any to any port = 81

# Sta inkomend verkeer toe van de DHCP server van de ISP. Deze regel
# moet het IP adres van de DHCP server van de ISP bevatten omdat die
# de enige toegestane bron van dit type pakketten moet zijn. Alleen
# van belang voor kabel en xDSL instellingen. Deze regel is niet nodig
# voor PPP verbindingen naar het publieke Internet.  Dit is hetzelfde
# IP adres dat in het Uitgaande onderdeel is opgezocht.
pass in quick on dc0 proto udp from z.z.z.z to any port = 68 keep state

# Sta inkomend webverkeer toe omdat er een Apache server draait.
pass in quick on dc0 proto tcp from any to any port = 80 flags S keep state

# Sta niet beveiligde telnet sessie toe vanaf het publieke Internet.
# Dit heeft het label niet veilig omdat gebruikersnaam en
# wachtwoord als platte tekst over Internet gaan. Als er geen telnet
# server draait, hoeft deze regel niet actief te zijn.
#pass in quick on dc0 proto tcp from any to any port = 23 flags S keep state

# Sta beveiligde FTP, telnet en SCP toe vanaf Internet.
# Deze functie gebruikt SSH (secure shell).
pass in quick on dc0 proto tcp from any to any port = 22 flags S keep state

# Blokkeer en log het eerste voorkomen van al het andere dat probeert
# binnen te komen. Het loggen van alleen het eerste voorkomen stopt
# een ontzegging van dienst aanval die gericht is op het laten
# vollopen van de partitie waarop de logboeken staan. Deze regel implementeert
# de standaard blokkade.
block in log first quick on dc0 all
################### Einde van de regels ###################################</pre></div></div></div><div class=sect2><h3 id=_nat>30.5.14. NAT<a class=anchor href=#_nat></a></h3><div class=paragraph><p>NAT staat voor <em>Network Address Translation</em> (netwerkadres vertaling). In Linux® heet dit IP Masquerading. Een van de vele mogelijkheden die IPF NAT kan bieden is het delen van één IP adres op het publieke Internet met een LAN achter een firewall.</p></div><div class=paragraph><p>De vraag zou kunnen rijzen waarom iemand dat zou willen. ISP’s wijzen normaliter namelijk dynamisch een IP adres toe aan hun niet-commerciële gebruikers. Dynamisch betekent hier dat het IP-adres iedere dat er wordt ingebeld of dat het kabel- of xDSL-modem uit- en aangeschakeld wordt anders kan zijn. Dit dynamische IP-adres wordt gebruikt om uw systeem op het publieke Internet te identificeren.</p></div><div class=paragraph><p>Stel dat er vijf PC’s in een huis staan en iedere computer in dat huis heeft toegang tot Internet nodig. Dan zouden er bij een ISP vijf individuele accounts moeten zijn en vijf telefoonlijnen om dat te realiseren.</p></div><div class=paragraph><p>Met NAT is er maar één account bij een ISP nodig. De andere vier PC’s moeten met kabels op een switch worden aangesloten waarop ook een FreeBSD systeem is aangesloten dat binnen uw LAN als gateway gaat opereren. NAT zal automatisch de private LAN IP adressen van alle PC’s vertalen naar een enkel publiek IP-adres als de pakketten de firewall naar het Internet verlaten.</p></div><div class=paragraph><p>Er is een speciale reeks van IP-adressen gereserveerd voor NAT op private LANs. Volgens RFC 1918 kunnen de volgende reeksen IP-adressen gebruikt worden op private netwerken die nooit direct op het publieke Internet gerouteerd worden.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Eerste IP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Laatste IP</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.255.255.255</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>172.16.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>172.31.255.255</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.255.255</code></p></td></tr></tbody></table></div><div class=sect2><h3 id=_ipnat>30.5.15. IPNAT<a class=anchor href=#_ipnat></a></h3><div class=paragraph><p>NAT regels worden geladen met <code>ipnat</code>. De NAT regels worden vaak opgeslagen in <span class=filename>/etc/ipnat.rules</span>. Meer details staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=8&amp;format=html">ipnat(8)</a>.</p></div><div class=paragraph><p>Bij het maken van wijzigingen aan de NAT-regels nadat NAT gestart is, wordt aangeraden de wijziging aan het bestand met regels te maken en daarna <code>ipnat -CF</code> te gebruiken om alle actieve NAT-regels te wissen. Daarna kunnen de regels uit het bestand weer als volgt geladen worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -CF -f /etc/ipnat.rules</span></code></pre></div></div><div class=paragraph><p>Gebruiksgegevens over NAT kunnen getoond worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -s</span></code></pre></div></div><div class=paragraph><p>De huidige inhoud van de NAT tabellen kan getoond worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -l</span></code></pre></div></div><div class=paragraph><p>Met het volgende commando kan de uitgebreide rapportage worden ingeschakeld en dan wordt informatie over het verwerken van verkeer en de actieve regels getoond:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -v</span></code></pre></div></div></div><div class=sect2><h3 id=_ipnat_regels>30.5.16. IPNAT regels<a class=anchor href=#_ipnat_regels></a></h3><div class=paragraph><p>NAT regels zijn erg flexibel en er kunnen veel dingen mee gedaan worden om behoeften van bedrijven en thuisgebruikers in te vullen.</p></div><div class=paragraph><p>De syntaxis van de regels die hier wordt toegelicht is vereenvoudigd om te passen bij een niet-commerciële omgeving. De complete syntaxis is na te lezen in <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=5&amp;format=html">ipnat(5)</a>.</p></div><div class=paragraph><p>De syntaxis voor een NAT regel ziet er ongeveer als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>map IF LAN_IP_REEKS -&gt; PUBLIEK_ADRES</pre></div></div><div class=paragraph><p>De regel begint met het sleutelwoord <code>map</code>.</p></div><div class=paragraph><p><em>IF</em> dient vervangen te worden door de aanduiding van de externe interface.</p></div><div class=paragraph><p><em>LAN_IP_REEKS</em> is de reeks die clients op een LAN gebruiken, meestal iets van <code>192.168.1.0/24</code>.</p></div><div class=paragraph><p><em>PUBLIEK_ADRES</em> kan het publieke IP adres zijn of een speciaal sleutelwoord <code>0.32</code>, wat betekent dat het IP adres van <em>IF</em> gebruikt moet worden.</p></div></div><div class=sect2><h3 id=_hoe_nat_werkt>30.5.17. Hoe NAT werkt<a class=anchor href=#_hoe_nat_werkt></a></h3><div class=paragraph><p>Een pakket komt vanaf het LAN aan bij de firewall en heeft een publieke bestemming. Het wordt verwerkt door de filterregels voor inkomend verkeer en daarna krijgt NAT de kans zijn regels op het pakket toe te passen. De regels worden van boven naar beneden toegepast en de eerste regel die van toepassing is wint. NAT controleert voor alle regels het pakket op interfacenaam en bron IP adres. Als de interfacenaam van een pakket past bij een NAT regel dan wordt het bron IP adres van dat pakket gecontroleerd, dat is dus een IP adres op het private LAN, om te bekijken of het valt in de reeks die is opgegeven aan de linkerkant van een NAT regel. Als ook dat klopt, dan wordt het bron IP adres van het pakket vervangen ("rewritten") door een publiek IP adres dat verkregen kan zijn met het sleutelwoord <code>0.32</code>. NAT werkt dan zijn interne NAT tabel bij, zodat als er een pakket uit die sessie terugkomt van het publieke Internet, dat pakket weer gepast kan worden bij het originele private IP adres en door de firewallregels gefilterd kan worden om daarna, als dat mag, naar een client gestuurd te worden.</p></div></div><div class=sect2><h3 id=_ipnat_inschakelen>30.5.18. IPNAT inschakelen<a class=anchor href=#_ipnat_inschakelen></a></h3><div class=paragraph><p>Voor IPNAT zijn de onderstaande instellingen in <span class=filename>/etc/rc.conf</span> beschikbaar.</p></div><div class=paragraph><p>Om verkeer tussen interfaces te kunnen routeren:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Om IPNAT automatisch te starten:</p></div><div class="literalblock programlisting"><div class=content><pre>ipnat_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Om aan te geven waar de IPNAT regels staan:</p></div><div class="literalblock programlisting"><div class=content><pre>ipnat_rules=&#34;/etc/ipnat.rules&#34;</pre></div></div></div><div class=sect2><h3 id=_nat_voor_een_groot_lan>30.5.19. NAT voor een groot LAN<a class=anchor href=#_nat_voor_een_groot_lan></a></h3><div class=paragraph><p>Voor netwerken met grote aantallen PC’s of netwerken met meerdere LAN’s kan het een probleem worden om al die private IP adressen met één enkel publiek IP adres te vervangen, omdat vaak dezelfde poortnummers gebruikt worden. Er zijn twee manieren om dit probleem op te lossen.</p></div><div class=sect3><h4 id=_aangeven_welke_poorten_te_gebruiken>30.5.19.1. Aangeven welke poorten te gebruiken<a class=anchor href=#_aangeven_welke_poorten_te_gebruiken></a></h4><div class=paragraph><p>Een normale regel voor NAT ziet er als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0.32</pre></div></div><div class=paragraph><p>Met de bovenstaande regel blijft de bronpoort ongewijzigd als het pakket door IPNAT gaat. Door gebruik te maken van het sleutelwoord <code>portmap</code> kan IPNAT ingesteld worden om alleen bronpoorten in de aangegeven reeks te gebruiken. Zo stelt de onderstaande regel in dat IPNAT de bronpoort aanpast naar een poortnummer dat in de aangegeven reeks valt:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0.32 portmap tcp/udp 20000:60000</pre></div></div><div class=paragraph><p>Het kan nog eenvoudiger door gebruik te maken van het sleutelwoord <code>auto</code> zodat IPNAT zelf bepaalt welke poorten gebruikt kunnen worden:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0.32 portmap tcp/udp auto</pre></div></div></div><div class=sect3><h4 id=_meerdere_publieke_adressen_gebruiken>30.5.19.2. Meerdere publieke adressen gebruiken<a class=anchor href=#_meerdere_publieke_adressen_gebruiken></a></h4><div class=paragraph><p>In grote netwerken komt er een moment waarop er gewoon te veel adressen zijn om te bedienen met één IP adres. Als er een blok van publiekelijke IP adressen beschikbaar is, dan kunnen deze adressen gebruikt worden in een "poel", welke door IPNAT gebruikt kan worden om één van de adressen te gebruiken als uitgaand adres.</p></div><div class=paragraph><p>Bijvoorbeeld om alle pakketten te verstoppen achter één een enkel IP adres:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.1</pre></div></div><div class=paragraph><p>Een reeks van publiekelijke IP adressen kan gespecificeerd worden met een netwerkmasker:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.1-10</pre></div></div><div class=paragraph><p>of door gebruik van de CIDR notatie:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.0/24</pre></div></div></div></div><div class=sect2><h3 id=_poorten_omleiden>30.5.20. Poorten omleiden<a class=anchor href=#_poorten_omleiden></a></h3><div class=paragraph><p>Het is erg gebruikelijk om een webserver, mailserver, database server en DNS server op verschillende computers op een LAN te draaien. Het uitgaande verkeer van die servers kan dan met NAT afgehandeld worden, maar er moet ook ingesteld worden dat inkomend verkeer bij de juiste computer terecht komt. IPNAT gebruikt daarvoor de opties in NAT waarmee verkeer omgeleid kan worden. Als bijvoorbeeld een webserver op het LAN-adres <code>10.0.10.25</code> draait en het enkele publieke IP adres zou <code>20.20.20.5</code> zijn, dan zou de regel er als volgt uit zien:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 20.20.20.5/32 port 80 -&gt; 10.0.10.25 port 80</pre></div></div><div class=paragraph><p>of:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 0.0.0.0/32 port 80 -&gt; 10.0.10.25 port 80</pre></div></div><div class=paragraph><p>Voor een DNS server op een LAN die ook vanuit Internet bereikbaar met zijn en die draait op <code>10.0.10.33</code> zou de regel er als volgt uit zien:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 20.20.20.5/32 port 53 -&gt; 10.0.10.33 port 53 udp</pre></div></div></div><div class=sect2><h3 id=_ftp_en_nat>30.5.21. FTP en NAT<a class=anchor href=#_ftp_en_nat></a></h3><div class=paragraph><p>FTP is dinosaurus uit het tijdperk van voor Internet was zoals het nu is, toen onderzoeksinstellingen met elkaar verbonden waren via huurlijnen en FTP de aangewezen methode was om bestanden met elkaar uit te wisselen. Maar bij het gebruik van FTP worden gebruikersnaam en wachtwoord als platte tekst verzonden en het protocol is nooit aangepast. FTP is er in twee smaken: actief en passief. Het verschil zit 'm in hoe het datakanaal wordt opgezet. De passieve variant is veiliger voor een gebruiker omdat bij deze variant beide communicatiekanalen door de cliënt zelf worden opgezet. Op de volgende pagina zijn details over FTP na te lezen: <a href=http://www.slacksite.com/other/ftp.html>http://www.slacksite.com/other/ftp.html</a>.</p></div><div class=sect3><h4 id=_ipnat_regels_2>30.5.21.1. IPNAT-regels<a class=anchor href=#_ipnat_regels_2></a></h4><div class=paragraph><p>IPNAT heeft een speciale FTP-proxy ingebouwd die kan worden ingeschakeld met een NAT-<code>map</code>-regel. Die kan al het uitgaande verkeer monitoren wat betreft opstartverzoeken voor sessies voor actieve en passieve FTP en dynamisch tijdelijke filterregels maken die alleen het poortnummer dat echt in gebruik is voor het datakanaal doorlaten. Hiermee wordt een veiligheidsrisico dat normaal gepaard gaat met FTP, namelijk het toestaan van grote reeksen hoge poortnummers, weggenomen.</p></div><div class=paragraph><p>De volgende regel handelt al het FTP verkeer van het LAN af:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 10.0.10.0/29 -&gt; 0/32 proxy port 21 ftp/tcp</pre></div></div><div class=paragraph><p>De regel hieronder handelt het FTP verkeer van de gateway zelf af:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 0.0.0.0/0 -&gt; 0/32 proxy port 21 ftp/tcp</pre></div></div><div class=paragraph><p>Deze laatste regel handelt al het niet-FTP verkeer voor het LAN af:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 10.0.10.0/29 -&gt; 0/32</pre></div></div><div class=paragraph><p>De FTP-afbeeldregel hoort voor de normale regels te staan. Alle pakketten worden als eerste vergeleken met de eerste regel en zo verder. Eerst wordt gekeken over de interfacenaam overeenkomt, daarna het bron IP adres van het LAN en dan of het een FTP pakket is. Als dat allemaal klopt, dan maakt de speciale FTP proxy een tijdelijke filterregel die de pakketten uit de FTP sessie naar binnen en buiten doorlaat en ook NAT toepast op de FTP pakketten. Alle pakketten van het LAN die niet van het protocoltype FTP zijn en dus niet bij de eerste regel passen, worden tegen de derde regel gehouden die van toepassing is vanwege de interface en bron IP adres, zodat er dan NAT op toegepast wordt.</p></div></div><div class=sect3><h4 id=_ipnat_ftp_filterregels>30.5.21.2. IPNAT FTP filterregels<a class=anchor href=#_ipnat_ftp_filterregels></a></h4><div class=paragraph><p>Als de NAT-FTP-proxy wordt gebruikt is er maar één filterregel voor FTP nodig. Zonder de FTP-proxy zouden er drie regels nodig zijn:</p></div><div class="literalblock programlisting"><div class=content><pre># Sta LAN client toe te FTP-en naar Internet
# Actieve en passieve modes
pass out quick on rl0 proto tcp from any to any port = 21 flags S keep state

# Sta opzetten van het datakanaal voor passieve mode toe voor hoge poorten
pass out quick on rl0 proto tcp from any to any port &gt; 1024 flags S keep state

# Laat het datakanaal van de FTP server binnen voor actieve mode
pass in quick on rl0 proto tcp from any to any port = 20 flags S keep state</pre></div></div></div></div></div></div><div class=sect1><h2 id=firewalls-ipfw>30.6. IPFW<a class=anchor href=#firewalls-ipfw></a></h2><div class=sectionbody><div class=paragraph><p>IPFIREWALL (IPFW) is een firewall die binnen FreeBSD wordt ontwikkeld en onderhouden door vrijwillige leden van de staf. Het maakt gebruik van verouderde staatloze regels en een verouderde techniek om te realiseren wat eenvoudige stateful logica zou kunnen heten.</p></div><div class=paragraph><p>De verzameling voorbeeldregels van IPFW (die in <span class=filename>/etc/rc.firewall</span> en <span class=filename>/etc/rc.firewall6</span> staan) uit de standaard FreeBSD-installatie is redelijk eenvoudig en niet voorbereid om zonder wijzigingen gebruikt te worden. Het voorbeeld maakt geen gebruik van stateful filteren, wat een voordeel is in de meeste situaties. Daarom worden deze regels niet als basis gebruikt in dit onderdeel.</p></div><div class=paragraph><p>De staatloze syntaxis van IPFW is krachtig door de technisch geavanceerde mogelijkheden van de regelsyntaxis die de kennis van de gemiddelde gebruiker van firewalls ver overstijgt. IPFW is gericht op de professionele gebruiker of de gevorderde thuisgebruiker die hoge eisen stelt aan de wijze waarop er met pakketten wordt omgegaan. Voordat de kracht van de IPFW regels echt ingezet kan worden, moet de gebruiker veel weten over de verschillende protocollen en de wijze waarop pakketten in elkaar zitten. Het tot op dat niveau behandelen van stof valt buiten de doelstellingen van dit Handboek.</p></div><div class=paragraph><p>IPFW bestaat uit zeven componenten: de verwerkingseenheid voor de firewallregels, verantwoording, loggen, regels met <code>divert</code> (omleiden) waarmee NAT gebruikt kan worden en de speciale gevorderde mogelijkheden voor bandbreedtebeheer met DUMMYNET, de <code>fwd rule</code> forward-mogelijkheid, de bridge-mogelijkheden en de ipstealth-mogelijkheden. IPFW ondersteunt zowel IPv4 als IPv6.</p></div><div class=sect2><h3 id=firewalls-ipfw-enable>30.6.1. IPFW inschakelen<a class=anchor href=#firewalls-ipfw-enable></a></h3><div class=paragraph><p>IPFW zit bij de basisinstallatie van FreeBSD als een losse tijdens runtime laadbare module. Het systeem laadt de kernelmodule dynamisch als in <span class=filename>rc.conf</span> de regel <code>firewall_enable="YES"</code> staat. IPFW hoeft niet in de FreeBSD kernel gecompileerd te worden.</p></div><div class=paragraph><p>Na het rebooten van een systeem met <code>firewall_enable="YES"</code> in <span class=filename>rc.conf</span> is het volgende bericht op het scherm te zien tijdens het booten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ipfw2 initialized, divert disabled, rule-based forwarding disabled, default to deny, logging disabled</code></pre></div></div><div class=paragraph><p>In de laadbare module zit de mogelijkheid om te loggen gecompileerd. Er is een knop in <span class=filename>/etc/sysctl.conf</span> om loggen aan te zetten en de uitgebreide loglimiet in te stellen. Door deze regels toe te voegen, staat loggen aan bij toekomstige herstarts:</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.verbose=1
net.inet.ip.fw.verbose_limit=5</pre></div></div></div><div class=sect2><h3 id=firewalls-ipfw-kernel>30.6.2. Kernelopties<a class=anchor href=#firewalls-ipfw-kernel></a></h3><div class=paragraph><p>Het is niet verplicht om IPFW in te schakelen door het mee te compileren in de FreeBSD kernel. Dit wordt alleen beschreven als achtergrondinformatie.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL</pre></div></div><div class=paragraph><p>Met <code>IPFIREWALL</code> wordt IPFW ingeschakeld als deel van de kernel.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_VERBOSE</pre></div></div><div class=paragraph><p>Met <code>IPFIREWALL_VERBOSE</code> wordt het loggen van pakketten die worden verwerkt met IPFW mogelijk die het sleutelwoord <code>log</code> in een regel hebben staan.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_VERBOSE_LIMIT=5</pre></div></div><div class=paragraph><p>Limiteert het aantal pakketten dat per regel wordt gelogd via <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a>. Deze optie kan gebruikt worden in vijandige omgevingen waar de activiteit van een firewall gelogd moet worden. Hierdoor kan een mogelijke ontzegging van dienst aanval door het vol laten lopen van syslog voorkomen worden.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_DEFAULT_TO_ACCEPT</pre></div></div><div class=paragraph><p>Met <code>IPFIREWALL_DEFAULT_TO_ACCEPT</code> wordt standaard alles door de firewall doorgelaten. Dit wordt aangeraden als iemand voor het eerst een firewall opzet.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPDIVERT</pre></div></div><div class=paragraph><p>Met <code>IPDIVERT</code> wordt de NAT functionaliteit ingeschakeld.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De firewall zal alle binnenkomende en uitgaande pakketten blokkeren als de kerneloptie <code>IPFIREWALL_DEFAULT_TO_ACCEPT</code> of een regel om deze verbindingen expliciet toe te staan ontbreekt.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=firewalls-ipfw-rc>30.6.3. <span class=filename>/etc/rc.conf</span> opties<a class=anchor href=#firewalls-ipfw-rc></a></h3><div class=paragraph><p>Start de firewall:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Om één van de standaard firewall types die geleverd wordt door FreeBSD te selecteren, lees <span class=filename>/etc/rc.firewall</span>, maak een selectie en plaats het in de volgende regel:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_type=&#34;open&#34;</pre></div></div><div class=paragraph><p>Beschikbare waardes voor deze instelling zijn:</p></div><div class=ulist><ul><li><p><code>open</code> - laat al het verkeer door.</p></li><li><p><code>client</code> - beschermt alleen deze machine.</p></li><li><p><code>simple</code> - beschermt het hele netwerk.</p></li><li><p><code>closed</code> - blokkeert alle IP-verkeer, behalve voor lokaal verkeer.</p></li><li><p><code>UNKNOWN</code> - voorkomt het laden de firewall-regels.</p></li><li><p><span class=filename>bestandsnaam</span> - absoluut pad naar een bestand dat firewall-regels bevat.</p></li></ul></div><div class=paragraph><p>Het is mogelijk om twee verschillende manieren te gebruiken voor speciaal gemaakte regels voor de ipfw firewall. één daarvan is door het zetten van de <code>firewall_type</code> variabele naar een absoluut pad van een bestand, welke <em>firewall-regels</em> bevat, zonder enige specifieke opties voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a>. Het volgende is een eenvoudig voorbeeld van een bestand met regelverzamelingen dat al het inkomend en uitgaand verkeer blokkeert:</p></div><div class="literalblock programlisting"><div class=content><pre>add deny in
add deny out</pre></div></div><div class=paragraph><p>Aan de andere kant is het mogelijk om de variabele <code>firewall_script</code> in te stellen op een absoluut pad van een uitvoerbaar script, welke inclusief <code>ipfw</code> commando’s uitgevoerd wordt tijdens het opstarten van het systeem. Een geldig script met regels dat gelijkwaardig is aan het bestand met regels hierboven, zou het volgende zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh

ipfw -q flush

ipfw add deny in
ipfw add deny out</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als <code>firewall_type</code> is gezet naar <code>client</code> of <code>simple</code> moeten de standaard regels die gevonden kunnen worden in <span class=filename>/etc/rc.firewall</span> gecontroleerd worden om te zien of deze configuratie voldoet voor de machine. Let ook op dat alle voorbeelden die gebruikt zijn in dit hoofdstuk ervan uitgaan dat de <code>firewall_script</code> variabele gezet is naar <span class=filename>/etc/ipfw.rules</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om loggen in te schakelen:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_logging=&#34;YES&#34;</pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Het enige dat de variabele <code>firewall_logging</code> doet is de sysctl variabele <code>net.inet.ip.fw.verbose</code> op de waarde <code>1</code> zetten (zie <a href=#firewalls-ipfw-enable>IPFW inschakelen</a>). Er is geen variabele in <span class=filename>rc.conf</span> om logboeklimieten in te stellen, maar dat kan ingesteld worden via een sysctl variabele, handmatig of via <span class=filename>/etc/sysctl.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.verbose_limit=5</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Als de machine in kwestie een gateway is, dus Network Address Translation (NAT) diensten levert via <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a>, dan staat in <a href=../advanced-networking/#network-natd>Network Address Translation</a> meer informatie over de benodigde instellingen voor <span class=filename>/etc/rc.conf</span>.</p></div></div><div class=sect2><h3 id=firewalls-ipfw-cmd>30.6.4. Het commando <code>IPFW</code><a class=anchor href=#firewalls-ipfw-cmd></a></h3><div class=paragraph><p>Gewoonlijk wordt <code>ipfw</code> gebruikt om met de hand enkelvoudige regels toe te voegen of te verwijderen als IPFW actief is. Het probleem met deze methode is dat, als het systeem wordt uitgezet alle regels die gewijzigd of verwijderd zijn verloren gaan. Door alle regels in een bestand op te nemen dat bij het booten wordt geladen of door het bestand waarin de wijzigingen zijn gemaakt als een machine draait te laden bestaat die probleem niet.</p></div><div class=paragraph><p>Met <code>ipfw</code> kunnen de actieve regels van de firewall op het scherm getoond worden. De verantwoordingsmogelijkeden van <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> maken dynamisch tellers aan voor iedere regel en houden die bij voor alle pakketten die van toepassing zijn op die regel. Tijdens het testen van een regel is het afbeelden van de regel met zijn teller een van de manieren om te bepalen of de regel werkt.</p></div><div class=paragraph><p>Om alle regels in volgorde te tonen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw list</span></code></pre></div></div><div class=paragraph><p>Om alle regels te tonen met de tijd waarop deze voor het laatst van toepassing was:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -t list</span></code></pre></div></div><div class=paragraph><p>Het volgende commando kan gebruikt worden om de verantwoordingsinformatie, pakkettellers en de regel zelf te tonen. De eerste kolom is het regelnummer met daarachter het aantal keren dat de regel van toepassing was voor inkomend verkeer, gevolgd door het aantal keren dat de regel van toepassing was voor uitgaand verkeer. Als laatste wordt de regel zelf getoond:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -a list</span></code></pre></div></div><div class=paragraph><p>Ook kunnen onder de statische regels de dynamische regels getoond worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -d list</span></code></pre></div></div><div class=paragraph><p>En de dynamische regels die verlopen zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -d -e list</span></code></pre></div></div><div class=paragraph><p>De tellers op nul gesteld worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw zero</span></code></pre></div></div><div class=paragraph><p>Alleen de tellers voor regel met nummer <em>NUM</em> op nul stellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw zero NUM</span></code></pre></div></div></div><div class=sect2><h3 id=firewalls-ipfw-rules>30.6.5. Sets van IPFW regels<a class=anchor href=#firewalls-ipfw-rules></a></h3><div class=paragraph><p>Een verzameling regels is een groep IPFW-regels die is gemaakt om pakketten toe te staan of te blokkeren op basis van de inhoud van dat pakket. De bi-directionele uitwisseling van pakketten tussen hosts bestaat uit een gesprek dat een sessie heet. De verzameling van firewallregels beoordeelt zowel de pakketten die aankomen van de host op het publieke Internet als de pakketten die op het systeem ontstaan als antwoord daarop. Iedere TCP/IP-dienst als telnet, www, mail, etc, heeft zijn eigen protocol en bevoorrechte (luister)poort. Pakketten bestemd voor een specifieke poort verlaten het bronadres via een onbevoorrechte (hogere) poort en doelen op de specifieke dienstpoort op het bestemmingsadres. Alle bovenstaande parameters (poorten en adressen) kunnen gebruikt worden als selectiecriteria om regels aan te maken die diensten doorlaten of blokkeren.</p></div><div class=paragraph><p>Als een pakket de firewall binnenkomt wordt het vergeleken met de eerste regel in de set regels en zo gaat dat voor iedere regel vanaf boven tot beneden. Als een regel van toepassing is op een pakket, dan wordt het actieveld van de regel uitgevoerd. Dit wordt de "de eerst passende regel wint" zoekmethode genoemd. Als een pakket bij geen enkele regel past, dan wordt de verplichte standaardregel 65535 van IPFW toegepast, die alle pakketten weigert zonder een antwoord terug te sturen naar de verzender.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het zoeken gaat door na regels met <code>count</code>, <code>skipto</code> en <code>tee</code>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De instructies in dit onderdeel zijn gebaseerd op regels die gebruik maken van de stateful opties <code>keep state</code>, <code>limit</code>, <code>in</code>, <code>out</code> en <code>via</code>. Dit is het raamwerk waarmee een set van inclusieve firewallregels wordt samengesteld.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Wees voorzichtig tijdens het werken met firewall-regels, het is gemakkelijk om uzelf uit te sluiten.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=firewalls-ipfw-rules-syntax>30.6.5.1. Regelsyntaxis<a class=anchor href=#firewalls-ipfw-rules-syntax></a></h4><div class=paragraph><p>De regelsyntaxis zoals hier toegelicht is vereenvoudigd door alleen te tonen wat nodig is om een standaard inclusieve set met firewallregels te maken. De complete beschrijving van alle mogelijkheden staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a>.</p></div><div class=paragraph><p>Regels bevatten sleutelwoorden die in een bepaalde volgorde van links naar rechts op een regel horen te staan. Sleutelwoorden worden vet weergegeven. Sommige sleutelwoorden hebben subopties die zelf ook weer sleutelwoorden hebben die ook weer subopties kunnen hebben.</p></div><div class=paragraph><p>Het karakter <code>#</code> wordt gebruikt om het begin van een opmerking te markeren en kan zowel op een eigen regel als achter een firewallregel staan. Lege regels worden genegeerd.</p></div><div class=paragraph><p><em>CMD REGEL_NUMMER ACTIE LOGGEN SELECTIE STATEFUL</em></p></div><div class=sect4><h5 id=_cmd>30.6.5.1.1. CMD<a class=anchor href=#_cmd></a></h5><div class=paragraph><p>Iedere regel moet beginnen met <span class=parameter>add</span> om hem toe te voegen aan de tabel met regels.</p></div></div><div class=sect4><h5 id=_regel_nummer>30.6.5.1.2. REGEL_NUMMER<a class=anchor href=#_regel_nummer></a></h5><div class=paragraph><p>Elke regel is geassocieerd met een regel_nummer van 1 tot en met 65535.</p></div></div><div class=sect4><h5 id=_actie_2>30.6.5.1.3. ACTIE<a class=anchor href=#_actie_2></a></h5><div class=paragraph><p>Bij een regel kunnen één of meer acties horen die worden uitgevoerd als een regel geldt voor een pakket.</p></div><div class=paragraph><p><span class=parameter>allow | accept | pass | permit</span></p></div><div class=paragraph><p>Deze opties betekenen allemaal hetzelfde: als de regel geldt voor een pakket, laat dat pakket dan door en stop met het zoeken naar geldende regels.</p></div><div class=paragraph><p><span class=parameter>check-state</span></p></div><div class=paragraph><p>Vergelijkt het pakket met de tabel met dynamische regels. Als het erin staat, dan wordt de actie van de dynamisch door deze regel gemaakte regel uitgevoerd. Anders wordt er verder gezocht door de regels. Een regel met check-state heeft geen selectiecriteria. Als er geen regel met check-state in de set met regels staat, dan wordt de tabel met dynamische regels bij het eerste voorkomen van keep-state of limit gecontroleerd.</p></div><div class=paragraph><p><span class=parameter>deny | drop</span></p></div><div class=paragraph><p>Deze opties betekenen hetzelfde: als de regel geldt voor een pakket, blokkeer dat pakket dan en stop met het zoeken naar geldende regels.</p></div></div><div class=sect4><h5 id=_loggen>30.6.5.1.4. Loggen<a class=anchor href=#_loggen></a></h5><div class=paragraph><p><span class=parameter>log</span> of <span class=parameter>logamount</span></p></div><div class=paragraph><p>Als een regel met het sleutelwoord <code>log</code> van toepassing is op een pakket, dan wordt er een bericht naar <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> geschreven met de faciliteitsnaam SECURITY. Er wordt alleen een bericht geschreven als het aantal voor die regel gelogde pakketten niet groter is dan de instelling van de parameter logamount. Als er geen <code>logamount</code> is ingesteld, dan wordt de limiet uit de <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> variabele <code>net.inet.ip.fw.verbose_limit</code> gehaald. In beide gevallen bestaat er in het geval de waarde nul is geen limiet. Als de limiet is bereikt, dan kan het loggen weer ingeschakeld worden door de teller voor het loggen weer op nul te zetten voor die regel met <code>ipfw reset log</code>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er wordt gelogd als een pakket zeker past bij een regel, maar voordat de actie (bijvoorbeeld <span class=parameter>accept</span> of <code>deny</code>) op een pakket wordt toegepast. Uiteindelijk bepaalt de gebruiker zelf voor welke regels loggen wordt ingeschakeld.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_selectie_2>30.6.5.1.5. Selectie<a class=anchor href=#_selectie_2></a></h5><div class=paragraph><p>De sleutelwoorden in deze paragraaf beschrijven de attributen van een pakket die gecontroleerd worden bij het bepalen of een regel wel of niet op een pakket van toepassing is. De attributen waarop gecontroleerd kan worden moeten in de beschreven volgorde gebruikt worden.</p></div><div class=paragraph><p><span class=parameter>udp | tcp | icmp</span></p></div><div class=paragraph><p>Naast de hierboven aangegeven protocollen kunnen alle in <span class=filename>/etc/protocols</span> beschreven protocollen gebruikt worden. De waarde die wordt opgegeven is het protocol dat van toepassing moet zijn. Dit attribuut is verpicht.</p></div><div class=paragraph><p><span class=parameter>from bron to best</span></p></div><div class=paragraph><p>De sleutelwoorden <code>from</code> en <code>to</code> worden gebruikt om te bekijken of een regel van toepassing is op IP-adressen. Een regel moet <em>zowel</em> bron- als bestemmingsadressen bevatten. <code>any</code> is een bijzonder sleutelwoord dat van toepassing is op alle IP-adressen. <code>me</code> is een bijzonder sleutelwoord dat van toepassing is op alle IP-adressen die ingesteld zijn op interfaces van een FreeBSD systeem om de PC waarop de firewall draait te vertegenwoordigen (deze machine). Zo kan dit onderdeel bijvoorbeeld de volgende vormen aannemen: <code>from me to any</code>, <code>from any to me</code>, <code>from 0.0.0.0/0 to any</code>, <code>from any to 0.0.0.0/0</code>, <code>from 0.0.0.0 to any</code>, <code>from any to 0.0.0.0</code> of <code>from me to 0.0.0.0</code>. IP-adressen mogen ingevoerd worden in de vorm numeriek, door punten gescheiden adres/maskerlengte (CIDR-notatie) of als een enkelvoudig IP-adres in de vorm numeriek, door punten gescheiden. De port <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/ipcalc/>net-mgmt/ipcalc</a> kan gebruikt worden om de berekeningen e vereenvoudigen. Aanvullende informatie is beschikbaar op de webpagina van het programma: <a href=http://jodies.de/ipcalc>http://jodies.de/ipcalc</a>.</p></div><div class=paragraph><p><span class=parameter>poortnummer</span></p></div><div class=paragraph><p>Wordt gebruikt voor protocollen die poortnummers ondersteunen (als TCP en UDP). Het gebruik van een poortnummer is verplicht. Er mogen ook dienstnamen uit <span class=filename>/etc/services</span> gebruikt worden in plaats van nummers.</p></div><div class=paragraph><p><span class=parameter>in | out</span></p></div><div class=paragraph><p>Is op respectievelijk inkomende of uitgaande pakketten van toepassing. De sleutelwoorden <code>in</code> of <code>out</code> zijn verplicht in een regel.</p></div><div class=paragraph><p><span class=parameter>via IF</span></p></div><div class=paragraph><p>Deze parameter geeft aan op welke interface de regel van toepassing is, waarbij <code>IF</code> de exacte naam van de bedoelde interface is.</p></div><div class=paragraph><p><span class=parameter>setup</span></p></div><div class=paragraph><p>Dit is een verplicht sleutelwoord waarmee wordt aangegeven dat er gezocht wordt naar een pakket met het verzoek tot het opstarten van een TCP sessie.</p></div><div class=paragraph><p><span class=parameter>keep-state</span></p></div><div class=paragraph><p>Dit is een verplicht sleutelwoord. Als er een pakket op een regel met <span class=parameter>keep-state</span> van toepassing is, dan wordt er door de firewall een dynamische regel gemaakt die bi-directioneel verkeer zal toestaan tussen bron en bestemming en de bijbehorende poorten voor hetzelfde protocol.</p></div><div class=paragraph><p><span class=parameter>limit {bron-adr | bron-poort | best-adr | best-poort}</span></p></div><div class=paragraph><p>De firewall staat maar <em>N</em> verbindingen toe met dezelfde groep parameters uit een regel. Er kunnen één of meer van de parameters bron- of bestemmingsadres en bron- en bestemmingspoort gebruikt worden. <span class=parameter>limit</span> en <span class=parameter>keep-state</span> kunnen niet in dezelfde regel gebruikt worden. De optie <span class=parameter>limit</span> geeft dezelfde mogelijkheden als <span class=parameter>keep-state</span> en voegt daar zijn eigen mogelijkheden aan toe.</p></div></div></div><div class=sect3><h4 id=_regeloptie_stateful>30.6.5.2. Regeloptie stateful<a class=anchor href=#_regeloptie_stateful></a></h4><div class=paragraph><p>Bij stateful filteren wordt verkeer bekeken als bi-directioneel verkeer dat samen een sessie vormt. Het heeft de mogelijkheid om te bepalen of de sessie tussen de zender en de ontvanger op de juiste wijze voortgaat. Alle pakketten die niet precies in de verwachting van een sessie passen worden automatisch als fout geblokkeerd.</p></div><div class=paragraph><p>De optie <code>check-state</code> wordt gebruikt om aan te geven waar IPFW-regels tegen de mogelijkheden voor dynamische regels gehouden moeten worden. Als er een passende regel bij een pakket wordt gevonden, dan kan dat pakket de firewall verlaten en wordt een nieuwe regel gemaakt voor het volgende pakket dat wordt verwacht in de sessie. Als er geen regel van toepassing is op het pakket, dan wordt de volgende regel in de groep regels getest.</p></div><div class=paragraph><p>De mogelijkheden voor dynamische regels zijn kwetsbaar voor een aanval die SYN-flood heet, waarmee wordt geprobeerd een zeer groot aantal regels aan te laten maken. Om deze aanval tegen te gaan, is de optie <code>limit</code> beschikbaar. Met deze optie kan het maximaal aantal simultane sessies geregeld worden op basis van bron en bestemmingsvelden. Als het aantal sessies gelijk aan het maximale aantal sessies is, wordt een pakket voor een nieuwe sessie geweigerd.</p></div></div><div class=sect3><h4 id=_firewallberichten_loggen>30.6.5.3. Firewallberichten loggen<a class=anchor href=#_firewallberichten_loggen></a></h4><div class=paragraph><p>De voordelen van loggen zijn duidelijk. Het biedt de mogelijkheid om na het feit informatie na te zien als: welke pakketten heeft de firewall laten vallen, waar kwamen ze vandaan en waar gingen ze heen. Dit zijn allemaal voordelen als het gaat om uitvinden waar een aanvaller vandaan komt en wat hij heeft geprobeerd.</p></div><div class=paragraph><p>Zelfs als logging is ingeschakeld logt IPFW nog niets uit zichzelf. De beheerder van de firewall beslist welke actieve regels iets weg moeten schrijven door het sleutelwoord <code>log</code> aan die regels toe te voegen. Gewoonlijk worden alleen <code>deny</code>-regels gelogd. Dit geldt bijvoorbeeld voor de <code>deny</code>-regel voor inkomende ICMP pings. Het is gebruikelijk om de standaardregel "ipfw default deny everything" te dupliceren, daar <code>log</code> in op te nemen, en deze als laatste in de verzameling met regels te plaatsen. Zo zijn alle pakketten te zien die niet voldeden aan ook maar één regel.</p></div><div class=paragraph><p>Loggen heeft ook mogelijke nadelen. Het is mogelijk om te veel te loggen en dan om te komen in logboekgegevens die uiteindelijk een schijf kunnen vullen. Een DoS aanval om een schijf met logs te vullen is een van de oudst bekende typen DoS aanvallen. Logberichten van de firewall worden niet alleen naar syslogd geschreven, maar ook op het <code>root</code> console getoond waar ze snel erg vervelend kunnen worden.</p></div><div class=paragraph><p>De kerneloptie <code>IPFIREWALL_VERBOSE_LIMIT=5</code> beperkt het aantal opeenvolgende berichten dat naar <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> wordt geschreven voor één specifieke regel. Als deze optie is ingeschakeld, worden in dit geval maximaal vijf berichten voor dezelfde regel gemeld. Als er meer berichten op dezelfde regel zouden zijn, zou dat als volgt aan syslogd gemeld worden:</p></div><div class="literalblock programlisting"><div class=content><pre>last message repeated 45 times</pre></div></div><div class=paragraph><p>Standaard worden alle gelogde pakketten weggeschreven naar <span class=filename>/var/log/security</span>, wat is ingesteld in <span class=filename>/etc/syslog.conf</span>.</p></div></div><div class=sect3><h4 id=firewalls-ipfw-rules-script>30.6.5.4. Regelscript bouwen<a class=anchor href=#firewalls-ipfw-rules-script></a></h4><div class=paragraph><p>De meeste ervaren gebruikers van IPFW maken een bestand waarin de regels staan en stellen dat zo op dat het als script uitgevoerd kan worden. Het grootste voordeel van deze methode is dat de firewallregels allemaal vervangen kunnen worden zonder dat het systeem opnieuw gestart moet worden. Deze methode is ook erg geschikt voor het testen van regels omdat de procedure zo vaak als nodig uitgevoerd kan worden. Omdat het een script is, kan er gebruik gemaakt worden van substitutie zodat veel gebruikte waarden verduidelijkt en in meerdere regels toegepast kunnen worden. In het volgende voorbeeld wordt hier gebruik van gemaakt.</p></div><div class=paragraph><p>De syntaxis die in het script wordt gebruikt is compatibel met de shells <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=tcsh&amp;sektion=1&amp;format=html">tcsh(1)</a>. Velden waarvoor substitutie van toepassing is worden vooraf gegaan door het dollarteken $. Definities worden niet vooraf gegaan door het voorvoegsel $. De waarden van een substitutie moet omsloten worden door "dubbele aanhalingstekens".</p></div><div class=paragraph><p>Een bestand met regels kan als volgt beginnen:</p></div><div class="literalblock programlisting"><div class=content><pre>############### begin voorbeeldscript ipfw regels ##############
#
ipfw -q -f flush       # Verwijder alle bestaande regels.
# Stel standaarden in.
oif=&#34;tun0&#34;             # uitgaande interface.
odns=&#34;192.0.2.11&#34;      # IP adres DNS server ISP.
cmd=&#34;ipfw -q add &#34;     # Voorvoegsel voor regel.
ks=&#34;keep-state&#34;        # Te lui om iedere keer in te typen.
$cmd 00500 check-state
$cmd 00502 deny all from any to any frag
$cmd 00501 deny tcp from any to any established
$cmd 00600 allow tcp from any to any 80 out via $oif setup $ks
$cmd 00610 allow tcp from any to $odns 53 out via $oif setup $ks
$cmd 00611 allow udp from any to $odns 53 out via $oif $ks
################### einde voorbeeldscript ipfw regels ###########</pre></div></div><div class=paragraph><p>Dat is alles. De feitelijke functie van de regels is in dit voorbeeld van ondergeschikt belang. Dit was slechts een voorbeeld om het gebruik van substitutie te illustreren.</p></div><div class=paragraph><p>Als het bovenstaande voorbeeld de inhoud van <span class=filename>/etc/ipfw.rules</span> was, dan kon het herladen worden met het volgende commando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sh /etc/ipfw.rules</span></code></pre></div></div><div class=paragraph><p><span class=filename>/etc/ipfw.rules</span> zou overal kunnen staan met iedere gewenste naam.</p></div><div class=paragraph><p>Wat in het bovenstaande voorbeeld met een bestand is gerealiseerd, kan ook met de hand:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -q -f flush</span>
<span class=c># ipfw -q add 00500 check-state</span>
<span class=c># ipfw -q add 00502 deny all from any to any frag</span>
<span class=c># ipfw -q add 00501 deny tcp from any to any established</span>
<span class=c># ipfw -q add 00600 allow tcp from any to any 80 out via tun0 setup keep-state</span>
<span class=c># ipfw -q add 00610 allow tcp from any to 192.0.2.11 53 out via tun0 setup keep-state</span>
<span class=c># ipfw -q add 00611 allow udp from any to 192.0.2.11 53 out via tun0 keep-state</span></code></pre></div></div></div><div class=sect3><h4 id=_verzameling_van_stateful_regels>30.6.5.5. Verzameling van stateful regels<a class=anchor href=#_verzameling_van_stateful_regels></a></h4><div class=paragraph><p>De volgende verzameling van regels, waarin geen gebruik gemaakt wordt van NAT, is een voorbeeld van hoe een erg veilige inclusieve firewall kan worden opgezet. Een inclusieve firewall laat alleen diensten toe waarvoor <code>pass</code> regels van toepassing zijn en blokkeert al het andere verkeer. Firewalls die ontworpen zijn om hele netwerksegmenten te beschermen hebben tenminste twee interfaces waarvoor regels moeten zijn die de firewall in staat stellen zijn werk te doen.</p></div><div class=paragraph><p>Alle UNIX® systemen en dus ook FreeBSD zijn zo ontworpen dat ze voor interne communicatie de interface <span class=filename>lo0</span> en IP adres <code>127.0.0.1</code> gebruiken. De firewall moet dit interne verkeer gewoon doorgang laten vinden.</p></div><div class=paragraph><p>Voor de interface die is verbonden met het publieke Internet worden regels gemaakt waarmee sessies naar het Internet mogelijk gemaakt worden en toegang wordt gegeven voor pakketten die uit die sessies terug komen. Dit kan de gebruikers-PPP-interface <span class=filename>tun0</span> zijn of de netwerkkaart die is verbonden met een xDSL of kabelmodem.</p></div><div class=paragraph><p>In gevallen dat er meer dan één netwerkkaart is aangesloten op het private netwerk achter de firewall, moeten er op de firewall-regels zijn om het verkeer tussen die interfaces vrije doorgang te geven.</p></div><div class=paragraph><p>De regels worden opgedeeld in drie onderdelen: alle interfaces met vrije doorgang, uitgaand op publieke interfaces en inkomend op publieke interfaces.</p></div><div class=paragraph><p>De volgorde van de regels in iedere sectie voor publieke interfaces moet zo zijn dat de regels die het meest gebruikt worden vóór de regels staan die minder vaak gebruikt worden. De laatste regel van een onderdeel geeft aan dat al het overige verkeer op die interface in die richting geblokkeerd en gelogd moet worden.</p></div><div class=paragraph><p>In het onderdeel Uitgaand van de volgende verzameling regels staan alleen regels met <code>allow</code> die parameters bevatten om individuele diensten beschikbaar te maken die publieke toegang tot Internet mogen hebben Al die regels moeten gebruik maken van de opties <code>proto</code>, <code>port</code>, <code>in/out</code>, <code>via</code> en <code>keep-state</code>. De regels met <code>proto tcp</code> maken ook gebruik van <code>setup</code> om te bekijken of het een pakket betreft voor het opzetten van een sessie om de stateful functionaliteit aan te sturen.</p></div><div class=paragraph><p>In het onderdeel Inkomend staan als eerste alle regels voor het blokkeren van ongewenste pakketten, om twee redenen. Als eerste kan het zo zijn dat kwaadaardige pakketten gedeeltelijk overeenkomen met legitiem verkeer. Deze regels moeten worden geblokkeerd in plaats van te worden binnengelaten, gebaseerd op hun gedeeltelijke overeenkomst met <code>allow</code>-regels. De tweede reden is dat nu ongewenste pakketten die vaak voorkomen en die bij voorkeur niet in de logboeken voorkomen niet meer van toepassing zijn op de laatste regel van het onderdeel waarin ze zouden worden gelogd. Met de laatste regel van dit onderdeel worden alle overige pakketten geblokkeerd en gelogd en ze kunnen bewijsmateriaal zijn in een zaak tegen iemand die heeft geprobeerd een systeem aan te vallen.</p></div><div class=paragraph><p>Iets waarop u ook moet letten is dat voor al het verkeer dat wordt geweigerd geen antwoord wordt gestuurd. Die pakketten verdwijnen gewoon. Zo weet een aanvaller niet of een pakket het doelsysteem wel heeft bereikt. Zo kan een aanvaller geen informatie verzamelen over een systeem: hoe minder informatie er over een systeem beschikbaar is, hoe veiliger het is. Als er pakketten gelogd worden met een onbekend poortnummer, dan is de functie van dat poortnummer na te zoeken in <span class=filename>/etc/services</span> of op <a href=http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers>http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers</a>. Op de volgende link worden poortnummers van Trojans beschreven: <a href=http://www.sans.org/security-resources/idfaq/oddports.php>http://www.sans.org/security-resources/idfaq/oddports.php</a>.</p></div></div><div class=sect3><h4 id=_voorbeeld_van_een_set_inclusieve_regels>30.6.5.6. Voorbeeld van een set inclusieve regels<a class=anchor href=#_voorbeeld_van_een_set_inclusieve_regels></a></h4><div class=paragraph><p>Het volgende voorbeeld is een complete inclusieve verzameling van regels die geen gebruik maakt van NAT. Deze verzameling van regels is veilig om deze regels op uw eigen systemen te gebruiken. Dit kan door commentaar te maken van een <code>pass</code>-regel voor een dienst die niet gewenst is. Logberichten die niet gewenst zijn, zijn uit te sluiten door een <code>deny</code>-regel toe te voegen aan het onderdeel Inkomend. Voor de onderstaande regels dient de interfacenaam <span class=filename>dc0</span> in iedere regel vervangen te worden door de interfacenaam van de netwerkkaart in het systeem die met het publieke Internet is verbonden. Voor gebruikers van PPP zou dat <span class=filename>tun0</span> zijn.</p></div><div class=paragraph><p>Er zit een merkbare structuur in het gebruik van deze regels:</p></div><div class=ulist><ul><li><p>Alle regels die een verzoek zijn voor het opzetten van een sessie gebruiken <code>keep-state</code>.</p></li><li><p>Alle diensten die vanaf Internet bereikbaar zijn gebruiken de optie <code>limit</code> om "flooding" te voorkomen.</p></li><li><p>Alle regels gebruiken <code>in</code> of <code>out</code> om de richting aan te geven.</p></li><li><p>Alle regels gebruiken <code>via <em>interfacenaam</em></code> om aan te geven op welke interface de regel van toepassing is.</p></li></ul></div><div class=paragraph><p>De volgende regels zouden in <span class=filename>/etc/ipfw.rules</span> kunnen staan:</p></div><div class="literalblock programlisting"><div class=content><pre>################ Begin bestand met IPFW regels ###############################
# Verwijder eerst de bestaande regels.
ipfw -q -f flush

# Stel commando voorvoegsel in.
cmd=&#34;ipfw -q add&#34;
pif=&#34;dc0&#34;     # Interfacenaam van NIC die verbinding
              # met het publieke Internet heeft.

#################################################################
# Geen beperkingen op de interface aan de LAN kant. Alleen nodig
# als er een LAN is. Wijzig xl0 naar de gebruikte interfacenaam.
#################################################################
#$cmd 00005 allow all from any to any via xl0

#################################################################
# Geen beperkingen op de loopback interface.
#################################################################
$cmd 00010 allow all from any to any via lo0

#################################################################
# Sta het pakket toe als het aan de tabel met dynamische regels
# was toegevoegd met een &#39;allow keep-state&#39; commando.
#################################################################
$cmd 00015 check-state

#################################################################
# Interface aan het publieke Internet (onderdeel Uitgaand).
# Inspecteer verzoeken om een sessie te starten van achter de
# firewall op het private netwerk of vanaf de server zelf naar
# het publieke Internet.
#################################################################

# Geef toegang tot de DNS server van de ISP.
# x.x.x.x moet het IP adres van de DNS van de ISP zijn.
# Dupliceer deze regels als een ISP meerdere DNS servers heeft.
# Haal het IP adres evt. uit /etc/resolv.conf
$cmd 00110 allow tcp from any to x.x.x.x 53 out via $pif setup keep-state
$cmd 00111 allow udp from any to x.x.x.x 53 out via $pif keep-state

# Geef toegang tot de DHCP server van de ISP voor kabel- en
# xDSL-netwerken. Deze regel is niet nodig als gebruik gemaakt worden
# van PPP naar het publieke Internet. In dat geval kan de hele groep
# verwijderd worden. Gebruik de volgende regel en controleer het
# logboek voor het IP adres. Wijzig dan het IP adres in de regel
# commentaar hieronder en verwijder de eerste regel.
$cmd 00120 allow log udp from any to any 67 out via $pif keep-state
#$cmd 00120 allow udp from any to x.x.x.x 67 out via $pif keep-state

# Sta niet beveiligd www verkeer toe.
$cmd 00200 allow tcp from any to any 80 out via $pif setup keep-state

# Sta beveiligd www verkeer over TLS SSL toe.
$cmd 00220 allow tcp from any to any 443 out via $pif setup keep-state

# Sta het verzenden en ontvangen van e-mail toe.
$cmd 00230 allow tcp from any to any 25 out via $pif setup keep-state
$cmd 00231 allow tcp from any to any 110 out via $pif setup keep-state

# Sta de FreeBSD CVSUP functie toe voor uid root.
$cmd 00240 allow tcp from me to any out via $pif setup keep-state uid root

# Sta ping toe.
$cmd 00250 allow icmp from any to any out via $pif keep-state

# Sta Time toe naar buiten.
$cmd 00260 allow tcp from any to any 37 out via $pif setup keep-state

# Sta NNTP nieuws toe naar buiten.
$cmd 00270 allow tcp from any to any 119 out via $pif setup keep-state

# Sta beveiligde FTP, Telnet en SCP toe naar buiten.
# Deze functie maakt gebruik van SSH (secure shell).
$cmd 00280 allow tcp from any to any 22 out via $pif setup keep-state

# Sta whois toe naar buiten.
$cmd 00290 allow tcp from any to any 43 out via $pif setup keep-state

# Blokkeer en log al het andere dat probeert buiten te komen.
# Deze regel dwingt de &#39;block all&#39; logica af.
$cmd 00299 deny log all from any to any out via $pif

#################################################################
# Interface aan het publieke Internet (onderdeel Inkomend).
# Inspecteert pakketten die van het publieke Internet komen
# met als bestemming de host zelf of het private netwerk.
#################################################################

# Blokkeer al het verkeer voor niet-routeerbare of gereserveerde
# adresreeksen.
$cmd 00300 deny all from 192.168.0.0/16 to any in via $pif   #RFC 1918 privaat IP
$cmd 00301 deny all from 172.16.0.0/12 to any in via $pif     #RFC 1918 privaat IP
$cmd 00302 deny all from 10.0.0.0/8 to any in via $pif        #RFC 1918 privaat IP
$cmd 00303 deny all from 127.0.0.0/8 to any in via $pif       #loopback
$cmd 00304 deny all from 0.0.0.0/8 to any in via $pif         #loopback
$cmd 00305 deny all from 169.254.0.0/16 to any in via $pif    #DHCP auto-config
$cmd 00306 deny all from 192.0.2.0/24 to any in via $pif      #gereserveerd voor documentatie
$cmd 00307 deny all from 204.152.64.0/23 to any in via $pif   #Sun cluster interconnect
$cmd 00308 deny all from 224.0.0.0/3 to any in via $pif       #Klasse D &amp; E multicast

# Blokkeer publieke pings.
$cmd 00310 deny icmp from any to any in via $pif

# Blokkeer ident.
$cmd 00315 deny tcp from any to any 113 in via $pif

# Blokkeer alle Netbios diensten. 137=naam, 138=datagram, 139=sessie.
# Netbios is de Windows(R) bestandsdeeldienst.
# Blokkeer Windows hosts2 name server verzoeken 81.
$cmd 00320 deny tcp from any to any 137 in via $pif
$cmd 00321 deny tcp from any to any 138 in via $pif
$cmd 00322 deny tcp from any to any 139 in via $pif
$cmd 00323 deny tcp from any to any 81 in via $pif

# Blokkeer gefragmenteerde pakketten.
$cmd 00330 deny all from any to any frag in via $pif

# Blokkeer ACK pakketten die niet in de tabel met dynamische regels
# staan.
$cmd 00332 deny tcp from any to any established in via $pif

# Geef toegang tot de DHCP server van de ISP voor kabel- en
# xDSL-netwerken. Deze regel is niet nodig als gebruik gemaakt worden
# van PPP naar het publieke Internet. In dat geval kan de hele groep
# verwijderd worden. Hier wordt hetzelfde IP adres gebruikt als in de
# sectie voor Uitgaand verkeer.
#$cmd 00360 allow udp from any to x.x.x.x 67 in via $pif keep-state

# Sta inkomend webverkeer toe omdat er een Apache server draait.
$cmd 00400 allow tcp from any to me 80 in via $pif setup limit src-addr 2

# Sta beveiligde FTP, telnet en SCP toe vanaf Internet.
$cmd 00410 allow tcp from any to me 22 in via $pif setup limit src-addr 2

# Sta niet beveiligde telnet sessie toe vanaf het publieke Internet.
# Dit heeft het label ``niet veilig&#39;&#39; omdat gebruikersnaam en
# wachtwoord als platte tekst over Internet gaan. Als er geen telnet
# server draait, hoeft deze regel niet actief te zijn.
$cmd 00420 allow tcp from any to me 23 in via $pif setup limit src-addr 2

# Weiger en log alle niet toegestane inkomende verbindingen van buiten.
$cmd 00499 deny log all from any to any in via $pif

# Al het andere verkeer wordt standaard geblokkeerd. Weiger en log alle
# pakketten die tot hier zijn gekomen om te bekijken welke het waren.
$cmd 00999 deny log all from any to any
################ Einde bestand met IPFW regels ########################</pre></div></div></div><div class=sect3><h4 id=_voorbeeld_nat_en_stateful_regels>30.6.5.7. Voorbeeld NAT en stateful regels<a class=anchor href=#_voorbeeld_nat_en_stateful_regels></a></h4><div class=paragraph><p>Om NAT met IPFW te gebruiken moeten een extra aantal instellingen gemaakt worden. In het instellingenbestand voor de kernel moet <code>option IPDIVERT</code> toegevoegd worden aan de andere opties van IPFIREWALL.</p></div><div class=paragraph><p>Naast de normale IPFW opties in <span class=filename>/etc/rc.conf</span> zijn de volgende nodig:</p></div><div class="literalblock programlisting"><div class=content><pre>natd_enable=&#34;YES&#34;                   # Schakel NATD in
natd_interface=&#34;rl0&#34;                # interfacenaam voor de publieke Internet NIC
natd_flags=&#34;-dynamic -m&#34;            # -m = behoud poortnummers als mogelijk</pre></div></div><div class=paragraph><p>Stateful regels samen met de regel <code>divert natd</code> (Network Address Translation) gebruiken maakt het schrijven van regels veel gecompliceerder. De plaats van de regels met <code>check-state</code> en <code>divert natd</code> zijn van kritiek belang. De logica bestaat niet langer uit het eenvoudigweg van boven naar beneden doorwerken van de regels. Er wordt dan ook een nieuw type actie gebruik: <code>skipto</code>. Bij het gebruik van <code>skipto</code> is het verplicht iedere regel te nummeren zodat duidelijk is waar een <code>skipto</code> precies heen springt.</p></div><div class=paragraph><p>Hieronder staat een groep regels zonder commentaar waarin een manier om pakketten door de groep regels te leiden wordt aangegeven.</p></div><div class=paragraph><p>De verwerking begint met de eerste regel en er wordt steeds een volgende regel gecontroleerd tot het einde wordt bereikt of totdat een regel op het gecontroleerde pakket van toepassing is, en het pakket uit de firewall wordt vrijgelaten. In het voorbeeld zijn de regels 100, 101, 450, 500, en 510 van belang. Die regels regelen de vertaling van inkomende en uitgaande pakketten zodat er in de tabel met de dynamische <code>keep-state</code>-regels altijd het private IP-adres staat. Daarnaast is het van belang op te merken dat er in alle <code>allow</code>- en <code>deny</code>-regels de richting van het pakket wordt gecontroleerd (inkomend of uitgaand) en over welke interface het pakket gaat. Merk ook op dat alle uitgaande verzoeken voor het starten van een sessie met een <code>skipto</code> naar regel 500 gaan voor NAT.</p></div><div class=paragraph><p>Stel dat een gebruiker zijn webbrowser gebruikt om een webpagina op te halen. Webpagina’s worden over poort 80 verzonden. Er komt een pakket de firewall binnen dat niet past bij regel 100 omdat het naar buiten gaat en niet naar binnen. Het komt voorbij regel 101 omdat dit het eerste pakket is en er dus nog niets over in de dynamische keep-state tabel staat. Als het pakket bij 125 aankomt blijkt het te passen bij die regel. Het gaat naar buiten door de interface aan het publieke Internet. Het pakket heeft dan nog steeds het bron-IP-adres van het private LAN. Als blijkt dat deze regel geldt, dan gebeuren er twee dingen: door <code>keep-state</code> wordt er een regel in de dynamische keep-state tabel gezet en wordt de aangegeven actie uitgevoerd. De actie is onderdeel van de informatie uit de dynamische tabel. In dit geval is het <code>skipto rule 500</code>. In regel 500 wordt NAT op het IP-adres van het pakket toegepast en dan kan het weg. Dit is van groot belang. Dit pakket komt aan op zijn bestemming en als er een pakket als antwoord terug komt, dan begint de verwerking van het antwoordpakket weer van voor af aan. Nu voldoet het aan regel 100 en dus wordt het bestemmingsadres vertaald naar het bijbehorende IP-adres op het LAN. Daarna past het bij de <code>check-state</code>-regel en wordt een vermelding in de tabel gevonden wat betekent dat er een bestaande sessie is en wordt het doorgelaten naar het LAN. Het gaat dan naar de PC op het LAN die als eerste een pakket heeft verzonden en die verstuurt een nieuw pakket met de vraag om een volgend segment met gegevens naar de server. Nu blijkt bij controle van de <code>check-state</code>-regel dat die op het pakket van toepassing moet zijn en er staat een vermelding in de tabel voor uitgaand verkeer. Daarom wordt de bijbehorende actie <code>skipto rule 500</code> uitgevoerd. Het pakket springt naar regel 500, er wordt NAT op toegepast en het kan zijn weg vervolgen.</p></div><div class=paragraph><p>Wat betreft binnenkomende pakketten wordt alles dat onderdeel is van een bestaande sessie automatisch afgehandeld door de <code>check-state</code>-regel en de correct geplaatste <code>divert natd</code>-regels. Nu hoeven alleen de foute pakketten nog geweigerd te worden en moeten de inkomende geauthoriseerde diensten doorgelaten worden. In dit geval draait er een Apache server op de firewall-machine die vanaf Internet bereikbaar moet zijn. Het nieuwe inkomende pakket past bij regel 100 en het IP-adres wordt aangepast aan het interne IP-adres van de firewall-machine. Dat pakket wordt dan gecontroleerd op alle ongewenste eigenschappen en komt uiteindelijk aan bij regel 425 die van toepassing blijkt te zijn. In dat geval kunnen er twee dingen gebeuren: de pakketregel wordt in de dynamische keep-state tabel gezet, maar nu wordt het aantal nieuwe sessies dat van het bron IP-adres komt gelimiteerd tot twee. Dit is een bescherming tegen DoS-aanvallen op de dienst die op dat poortnummer wordt aangeboden. De actie is <code>allow</code>, dus het pakket wordt tot het LAN toegelaten. Voor het pakket dat als antwoord wordt verstuurd herkent de <code>check-state</code> regel dat het pakket bij een bestaande sessie hoort. Het stuurt het naar regel 500 voor NAT en stuurt het via de uitgaande interface weg.</p></div><div class=paragraph><p>Voorbeeld Set Regels #1:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
cmd=&#34;ipfw -q add&#34;
skip=&#34;skipto 500&#34;
pif=rl0
ks=&#34;keep-state&#34;
good_tcpo=&#34;22,25,37,43,53,80,443,110,119&#34;

ipfw -q -f flush

$cmd 002 allow all from any to any via xl0  # exclude LAN traffic
$cmd 003 allow all from any to any via lo0  # exclude loopback traffic

$cmd 100 divert natd ip from any to any in via $pif
$cmd 101 check-state

# Toegestaan uitgaand verkeer.
$cmd 120 $skip udp from any to xx.168.240.2 53 out via $pif $ks
$cmd 121 $skip udp from any to xx.168.240.5 53 out via $pif $ks
$cmd 125 $skip tcp from any to any $good_tcpo out via $pif setup $ks
$cmd 130 $skip icmp from any to any out via $pif $ks
$cmd 135 $skip udp from any to any 123 out via $pif $ks

# Blokkeer al het verkeer voor niet-routeerbare of gereserveerde
# adresreeksen.
$cmd 300 deny all from 192.168.0.0/16  to any in via $pif  #RFC 1918 privaat IP
$cmd 301 deny all from 172.16.0.0/12   to any in via $pif  #RFC 1918 privaat IP
$cmd 302 deny all from 10.0.0.0/8      to any in via $pif  #RFC 1918 privaat IP
$cmd 303 deny all from 127.0.0.0/8     to any in via $pif  #loopback
$cmd 304 deny all from 0.0.0.0/8       to any in via $pif  #loopback
$cmd 305 deny all from 169.254.0.0/16  to any in via $pif  #DHCP auto-config
$cmd 306 deny all from 192.0.2.0/24    to any in via $pif  #gereserveerd voor documentatie
$cmd 307 deny all from 204.152.64.0/23 to any in via $pif  #Sun cluster
$cmd 308 deny all from 224.0.0.0/3     to any in via $pif  #Klasse D &amp; E multicast

# Toegestaan inkomend verkeer.
$cmd 400 allow udp from xx.70.207.54 to any 68 in $ks
$cmd 420 allow tcp from any to me 80 in via $pif setup limit src-addr 1

$cmd 450 deny log ip from any to any

# Dit is de &#39;skipto&#39; locatie voor de uitgaande stateful regels.
$cmd 500 divert natd ip from any to any out via $pif
$cmd 510 allow ip from any to any

######################## Einde regels  ##################</pre></div></div><div class=paragraph><p>Het volgende voorbeeld doet vrijwel hetzelfde als het bovenstaande, maar volgt een zelfdocumenterende stijl voor het opstellen van regels en commentaar waardoor minder ervaren gebruikers beter kunnen begrijpen wat de regels doen.</p></div><div class=paragraph><p>Voorbeeld Set Regels #2:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
################ Begin bestand met IPFW regels ###############################
# Verwijder eerst de bestaande regels.
ipfw -q -f flush

# Stel commando voorvoegsel in.
cmd=&#34;ipfw -q add&#34;
skip=&#34;skipto 800&#34;
pif=&#34;rl0&#34;     # Interfacenaam van NIC die verbinding
              # met het publieke Internet heeft.

#################################################################
# Geen beperkingen op de interface aan de LAN kant.
# Wijzig xl0 naar de gebruikte interfacenaam.
#################################################################
$cmd 005 allow all from any to any via xl0

#################################################################
# Geen beperkingen op de loopback interface.
#################################################################
$cmd 010 allow all from any to any via lo0

#################################################################
# Controleer of pakket inkomend is. NAT in dat geval.
#################################################################
$cmd 014 divert natd ip from any to any in via $pif

#################################################################
# Sta het pakket toe als het aan de tabel met dynamische regels
# was toegevoegd met een &#39;allow keep-state&#39; commando.
#################################################################
$cmd 015 check-state

#################################################################
# Interface aan het publieke Internet (onderdeel Uitgaand).
# Inspecteer verzoeken om een sessie te starten van achter de
# firewall op het private netwerk of vanaf de server zelf naar
# het publieke Internet.
#################################################################

# Geef toegang tot de DNS server van de ISP.
# x.x.x.x moet het IP adres van de DNS van de ISP zijn.
# Dupliceer deze regels als een ISP meerdere DNS servers heeft.
# Haal het IP adres evt. uit /etc/resolv.conf
$cmd 020 $skip tcp from any to x.x.x.x 53 out via $pif setup keep-state

# Geef toegang tot de DHCP server van de ISP voor kabel en xDSL.
$cmd 030 $skip udp from any to x.x.x.x 67 out via $pif keep-state

# Sta niet beveiligd www verkeer toe.
$cmd 040 $skip tcp from any to any 80 out via $pif setup keep-state

# Sta beveiligd www verkeer over TLS SSL toe.
$cmd 050 $skip tcp from any to any 443 out via $pif setup keep-state

# Sta het verzenden en ontvangen van e-mail toe.
$cmd 060 $skip tcp from any to any 25 out via $pif setup keep-state
$cmd 061 $skip tcp from any to any 110 out via $pif setup keep-state

# Sta de FreeBSD CVSUP functie toe voor uid root.
$cmd 070 $skip tcp from me to any out via $pif setup keep-state uid root

# Sta ping toe naar het publieke Internet.
$cmd 080 $skip icmp from any to any out via $pif keep-state

# Sta Time toe.
$cmd 090 $skip tcp from any to any 37 out via $pif setup keep-state

# Sta NNTP nieuws toe.
$cmd 100 $skip tcp from any to any 119 out via $pif setup keep-state

# Sta beveiligde FTP, Telnet en SCP toe.
# Deze functie maakt gebruik van SSH (secure shell).
$cmd 110 $skip tcp from any to any 22 out via $pif setup keep-state

# Sta whois toe.
$cmd 120 $skip tcp from any to any 43 out via $pif setup keep-state

# Sta NPT tijdserver toe.
$cmd 130 $skip udp from any to any 123 out via $pif keep-state

#################################################################
# Interface aan het publieke Internet (onderdeel Inkomend).
# Inspecteert pakketten die van het publieke Internet komen met
# als bestemming deze gateway-server zelf of het private netwerk.
#################################################################

# Blokkeer al het verkeer voor niet-routeerbare of gereserveerde
# adresreeksen.
$cmd 300 deny all from 192.168.0.0/16  to any in via $pif  #RFC 1918 privaat IP
$cmd 301 deny all from 172.16.0.0/12   to any in via $pif  #RFC 1918 privaat IP
$cmd 302 deny all from 10.0.0.0/8      to any in via $pif  #RFC 1918 privaat IP
$cmd 303 deny all from 127.0.0.0/8     to any in via $pif  #loopback
$cmd 304 deny all from 0.0.0.0/8       to any in via $pif  #loopback
$cmd 305 deny all from 169.254.0.0/16  to any in via $pif  #DHCP auto-config
$cmd 306 deny all from 192.0.2.0/24    to any in via $pif  #gereserveerd voor documentatie
$cmd 307 deny all from 204.152.64.0/23 to any in via $pif  #Sun cluster
$cmd 308 deny all from 224.0.0.0/3     to any in via $pif  #Klasse D &amp; E multicast

# Blokkeer ident.
$cmd 315 deny tcp from any to any 113 in via $pif

# Blokkeer alle Netbios diensten. 137=naam, 138=datagram, 139=sessie.
# Netbios is de Windows® bestandsdeeldienst.
# Blokkeer Windows hosts2 name server verzoeken 81.
$cmd 320 deny tcp from any to any 137 in via $pif
$cmd 321 deny tcp from any to any 138 in via $pif
$cmd 322 deny tcp from any to any 139 in via $pif
$cmd 323 deny tcp from any to any 81  in via $pif

# Blokkeer gefragmenteerde pakketten.
$cmd 330 deny all from any to any frag in via $pif

# Blokkeer ACK pakketten die niet in de tabel met dynamische regels
# staan.
$cmd 332 deny tcp from any to any established in via $pif

# Geef toegang tot de DHCP server van de ISP voor kabel- en
# xDSL-netwerken. Deze regel is niet nodig als gebruik gemaakt worden
# van PPP naar het publieke Internet. In dat geval kan de hele groep
# verwijderd worden. Hier wordt hetzelfde IP adres gebruikt als in de
# sectie voor Uitgaand verkeer.
$cmd 360 allow udp from x.x.x.x to any 68 in via $pif keep-state

# Sta inkomend webverkeer toe omdat er een Apache server draait.
$cmd 370 allow tcp from any to me 80 in via $pif setup limit src-addr 2

# Sta beveiligde FTP, telnet en SCP toe vanaf Internet.
$cmd 380 allow tcp from any to me 22 in via $pif setup limit src-addr 2

# Sta niet beveiligde telnet sessie toe vanaf het publieke Internet.
# Dit heeft het label ``niet veilig&#39;&#39; omdat gebruikersnaam en
# wachtwoord als platte tekst over Internet gaan. Als er geen telnet
# server draait, hoeft deze regel niet actief te zijn.
#$cmd 390 allow tcp from any to me 23 in via $pif setup limit src-addr 2

# Weiger en log alle niet toegestane inkomende verbindingen vanaf het
# publieke Internet.
$cmd 400 deny log all from any to any in via $pif

# Weiger en log alle niet toegestane uitgaande verbindingen naar
# Internet.
$cmd 450 deny log all from any to any out via $pif

# Dit is de &#39;skipto&#39; locatie voor de uitgaande stateful regels
$cmd 800 divert natd ip from any to any out via $pif
$cmd 801 allow ip from any to any

# Al het andere verkeer wordt standaard geblokkeerd. Weiger en log alle
# pakketten die tot hier zijn gekomen om te bekijken welke het waren.
$cmd 999 deny log all from any to any
################ Einde bestand met IPFW regels ########################</pre></div></div></div></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: 9 maart 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=https://docs.freebsd.org/nl/books/handbook/network-servers class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#firewalls-intro>30.1. Inleiding</a></li><li><a href=#firewalls-concepts>30.2. Firewallconcepten</a></li><li><a href=#firewalls-apps>30.3. Firewallsoftware</a></li><li><a href=#firewalls-pf>30.4. De OpenBSD Packet Filter (PF) en ALTQ</a></li><li><a href=#firewalls-ipf>30.5. De IPFILTER (IPF) firewall</a></li><li><a href=#firewalls-ipfw>30.6. IPFW</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/nl/books/handbook/handbook_nl.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/nl/_index target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/nl/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>Dutch</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/nl class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/nl/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>