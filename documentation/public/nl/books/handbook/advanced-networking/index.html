<!doctype html><html class=theme-light lang=nl><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/><title>Hoofdstuk 31. Geavanceerde netwerken | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Hoofdstuk 31. Geavanceerde netwerken"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="nl"><meta property="og:url" content="http://172.16.201.134:1313/nl/books/handbook/advanced-networking/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/nl\/books\/handbook\/advanced-networking\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/nl>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/nl/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/nl/books>Books</a></li><li><a href=http://172.16.201.134:1313/nl/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/nl/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=nl>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/preface/>Voorwoord</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/preface/#preface-audience>Bedoeld publiek</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/preface/#preface-changes-from3>Wijzigingen ten opzichte van de derde editie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/preface/#preface-changes-from2>Wijzigingen ten opzichte van de tweede editie (2004)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/preface/#preface-changes>Veranderingen ten opzichte van de eerste editie (2001)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/preface/#preface-overview>De opbouw van dit boek</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/preface/#preface-conv>Overeenkomsten in dit boek</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/preface/#preface-acknowledgements>Dankwoorden</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/parti/>Deel I. Beginnen</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/introduction/>Hoofdstuk 1. Introductie</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/introduction/#introduction-synopsis>1.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/introduction/#nutshell>1.2. Welkom bij FreeBSD!</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/introduction/#history>1.3. Over het FreeBSD Project</a></li></ul></li><li><input type=checkbox id=chapter-6aaec170775233b7c45f6cdcfb70d466 class=toggle>
<label class="icon cursor" for=chapter-6aaec170775233b7c45f6cdcfb70d466><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/install/>Hoofdstuk 2. FreeBSD installeren op FreeBSD 8.X en eerder</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-synopsis>2.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-hardware>2.2. Hardware-eisen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-pre>2.3. Voorbereidende taken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-start>2.4. Beginnen met de installatie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#using-sysinstall>2.5. Inleiding Sysinstall</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-steps>2.6. Schijfruimte toewijzen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-choosing>2.7. Wat installeren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-media>2.8. Installatiemedia kiezen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-final-warning>2.9. De installatie bevestigen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-post>2.10. Instellingen na de installatie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-trouble>2.11. Problemen oplossen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-advanced>2.12. Installeren voor gevorderden</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/install/#install-diff-media>2.13. Aangepaste installatiemedia maken</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/bsdinstall/>Hoofdstuk 3. FreeBSD 9.X en nieuwer installeren</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/bsdinstall/#bsdinstall-synopsis>33.1. Overzicht</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/basics/>Hoofdstuk 4. UNIX® beginselen</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#basics-synopsis>4.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#consoles>4.2. Virtuele consoles en terminals</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#permissions>4.3. Rechten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#dirstructure>4.4. Mappenstructuur</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#disk-organization>4.5. Organisatie van schijven</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#mount-unmount>4.6. Het koppelen en ontkoppelen van bestandssystemen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#basics-processes>4.7. Processen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#basics-daemons>4.8. Daemons, signalen en het stoppen van processen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#shells>4.9. Shells</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#editors>4.10. Teksteditors</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#basics-devices>4.11. Apparaten en apparaatnodes</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#binary-formats>4.12. Binaire formaten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/basics/#basics-more-information>4.13. Meer informatie</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/ports/>Hoofdstuk 5. Applicaties installeren: pakketten en ports</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/ports/#ports-synopsis>5.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ports/#ports-overview>5.2. Overzicht van softwareinstallatie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ports/#ports-finding-applications>5.3. Applicaties zoeken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ports/#packages-using>5.4. Het pakkettensysteem gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ports/#ports-using>5.5. De Portscollectie gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ports/#ports-nextsteps>5.6. Activiteiten na het installeren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ports/#ports-broken>5.7. Omgaan met kapotte ports</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/x11/>Hoofdstuk 6. Het X Window systeem</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/x11/#x11-synopsis>6.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/x11/#x-understanding>6.2. X begrijpen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/x11/#x-install>6.3. X11 installeren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/x11/#x-config>6.4. X11 instellen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/x11/#x-fonts>6.5. Lettertypen gebruiken in X11</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/x11/#x-xdm>6.6. De X beeldschermmanager</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/x11/#x11-wm>6.7. Bureaubladomgevingen</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/partii/>Deel II. Algemene taken</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/desktop/>Hoofdstuk 7. Bureaubladapplicaties</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/desktop/#desktop-synopsis>7.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/desktop/#desktop-browsers>7.2. Browsers</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/desktop/#desktop-productivity>7.3. Productiviteit</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/desktop/#desktop-viewers>7.4. Documentviewers</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/desktop/#desktop-finance>7.5. Financiën</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/desktop/#desktop-summary>7.6. Samenvatting</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/multimedia/>Hoofdstuk 8. Multimedia</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/multimedia/#multimedia-synopsis>8.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/multimedia/#sound-setup>8.2. Geluidskaart installeren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/multimedia/#sound-mp3>8.3. MP3 audio</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/multimedia/#video-playback>8.4. Video afspelen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/multimedia/#tvcard>8.5. TV-kaarten installeren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/multimedia/#mythtv>8.6. MythTV</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/multimedia/#scanners>8.7. Scanners</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/kernelconfig/>Hoofdstuk 9. De FreeBSD-kernel instellen</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/kernelconfig/#kernelconfig-synopsis>9.1. Samenvatting</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/kernelconfig/#kernelconfig-custom-kernel>9.2. Redenen om een aangepaste kernel te bouwen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/kernelconfig/#kernelconfig-devices>9.3. De systeemhardware vinden</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/kernelconfig/#kernelconfig-modules>9.4. Kernel stuurprogramma’s, subsystemen, en modules</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/kernelconfig/#kernelconfig-building>9.5. Bouwen en installeren van een aangepaste kernel</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/kernelconfig/#kernelconfig-config>9.6. Het instellingenbestand</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/kernelconfig/#kernelconfig-trouble>9.7. Problemen oplossen</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/printing/>Hoofdstuk 10. Afdrukken</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/printing/#printing-synopsis>10.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/printing/#printing-intro-spooler>10.2. Inleiding</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/printing/#printing-intro-setup>10.3. Standaardinstallatie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/printing/#printing-advanced>10.4. Geavanceerde printerinstallatie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/printing/#printing-using>10.5. Printers gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/printing/#printing-lpd-alternatives>10.6. Alternatieven voor het standaard wachtrijsysteem</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/printing/#printing-troubleshooting>10.7. Problemen oplossen</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/linuxemu/>Hoofdstuk 11. Linux® binaire compatibiliteit</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/linuxemu/#linuxemu-synopsis>11.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/linuxemu/#linuxemu-lbc-install>11.2. Installatie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/linuxemu/#linuxemu-mathematica>11.3. Mathematica® installeren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/linuxemu/#linuxemu-maple>11.4. Maple™ installeren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/linuxemu/#linuxemu-matlab>11.5. MATLAB® installeren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/linuxemu/#linuxemu-oracle>11.6. Oracle® installeren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/linuxemu/#linuxemu-advanced>11.7. Gevorderde onderwerpen</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/partiii/>Deel III. Systeembeheer</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/config/>Hoofdstuk 12. Instellingen en optimalisatie</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#config-synopsis>12.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-initial>12.2. Initiële instellingen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-core-configuration>12.3. Hoofdinstellingen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-appconfig>12.4. Toepassingen instellen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-starting-services>12.5. Diensten starten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-cron>12.6. <code>cron</code> instellen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-rcd>12.7. Gebruik van rc met FreeBSD</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#config-network-setup>12.8. Netwerkkaarten instellen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-virtual-hosts>12.9. Virtuele hosts</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-syslog>12.10. De systeemlogger syslogd configureren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-configfiles>12.11. Instellingenbestanden</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-sysctl>12.12. Optimaliseren met sysctl</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-disk>12.13. Harde schijven optimaliseren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#configtuning-kernel-limits>12.14. Fijnafstemming van kernellimieten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#adding-swap-space>12.15. Wisselbestandruimte toevoegen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#acpi-overview>12.16. Energie- en bronnenbeheer</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/config/#ACPI-debug>12.17. FreeBSD ACPI gebruiken en debuggen</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/boot/>Hoofdstuk 13. Het FreeBSD opstartproces</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/boot/#boot-synopsis>13.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/boot/#boot-introduction>13.2. Het bootprobleem</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/boot/#boot-blocks>13.3. De bootmanager en opstartstadia</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/boot/#boot-kernel>13.4. Interactie met de kernel tijdens opstarten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/boot/#device-hints>13.5. Device hints</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/boot/#boot-init>13.6. Init: start van procesbesturing</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/boot/#boot-shutdown>13.7. Afsluitvolgorde</a></li></ul></li><li><input type=checkbox id=chapter-d251c21b963b5ab783e5aec225e02b5a class=toggle>
<label class="icon cursor" for=chapter-d251c21b963b5ab783e5aec225e02b5a><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/users/>Hoofdstuk 14. Gebruikers- en basisaccountbeheer</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/users/#users-synopsis>14.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/users/#users-introduction>14.2. Inleiding</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/users/#users-superuser>14.3. Het superuser-account</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/users/#users-system>14.4. Systeemaccounts</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/users/#users-user>14.5. Gebruikersaccounts</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/users/#users-modifying>14.6. Accounts wijzigen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/users/#users-limiting>14.7. Gebruikers beperken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/users/#users-groups>14.8. Groepen</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/security/>Hoofdstuk 15. Beveiliging</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#security-synopsis>15.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#security-intro>15.2. Introductie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#securing-freebsd>15.3. FreeBSD beveiligen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#crypt>15.4. DES, Blowfish, MD5, SHA256, SHA512 en crypt</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#one-time-passwords>15.5. Eenmalige wachtwoorden</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#tcpwrappers>15.6. TCP Wrappers</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#kerberos5>15.7. Kerberos5</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#openssl>15.8. OpenSSL</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#ipsec>15.9. VPN via IPsec</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#openssh>15.10. OpenSSH</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#fs-acl>15.11. Bestandssysteem toegangscontrolelijsten (ACLs)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#security-portaudit>15.12. Monitoren van beveiligingsproblemen met andere software</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#security-advisories>15.13. FreeBSD beveiligingswaarschuwingen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/security/#security-accounting>15.14. Procesaccounting</a></li></ul></li><li><input type=checkbox id=chapter-1a2a8e719703649c2c66d99aa7a25fd4 class=toggle>
<label class="icon cursor" for=chapter-1a2a8e719703649c2c66d99aa7a25fd4><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/jails/>Hoofdstuk 16. Jails</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/jails/#jails-synopsis>16.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/jails/#jails-terms>16.2. Termen en begrippen van jails</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/jails/#jails-intro>16.3. Introductie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/jails/#jails-build>16.4. Creeëren en controleren van jails</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/jails/#jails-tuning>16.5. Optimaliseren en administratie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/jails/#jails-application>16.6. Toepassing van jails</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/mac/>Hoofdstuk 17. Verplichte Toegangscontrole (MAC)</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-synopsis>17.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-inline-glossary>17.2. Sleuteltermen in dit hoofdstuk</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-initial>17.3. Uitleg over MAC</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-understandlabel>17.4. MAC-labels begrijpen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-planning>17.5. De beveiligingsconfiguratie plannen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-modules>17.6. Module-instellingen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-seeotheruids>17.7. MAC-module seeotheruids</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-bsdextended>17.8. MAC-module bsdextended</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-ifoff>17.9. MAC-module ifoff</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-portacl>17.10. MAC-module portacl</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-partition>17.11. MAC-module partition</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-mls>17.12. MAC-module Multi-Level Security</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-biba>17.13. MAC-module Biba</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-lomac>17.14. MAC-module LOMAC</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-implementing>17.15. Nagios in een MAC-jail</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-userlocked>17.16. Gebruikers afsluiten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mac/#mac-troubleshoot>17.17. Problemen oplossen met het MAC-raamwerk</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/audit/>Hoofdstuk 18. Security Event Auditing</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/audit/#audit-synopsis>18.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/audit/#audit-inline-glossary>18.2. Sleutelwoorden in dit hoofdstuk</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/audit/#audit-install>18.3. Installeren van audit ondersteuning.</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/audit/#audit-config>18.4. Audit Configuratie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/audit/#audit-administration>18.5. Het audit subsysteem beheren.</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/disks/>Hoofdstuk 19. Opslag</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#disks-synopsis>19.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#disks-naming>19.2. Apparaatnamen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#disks-adding>19.3. Schijven toevoegen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#raid>19.4. RAID</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#usb-disks>19.5. USB-opslagapparaten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#creating-cds>19.6. Optische media (CD’s) aanmaken en gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#creating-dvds>19.7. Optische media (DVD’s) aanmaken en gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#floppies>19.8. Diskettes aanmaken en gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#backups-tapebackups>19.9. Gegevensbanden aanmaken en gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#backups-floppybackups>19.10. Naar diskettes back-uppen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#backup-strategies>19.11. Back-up strategieën</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#backup-basics>19.12. Back-upbeginselen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#disks-virtual>19.13. Netwerk-, geheugen-, en bestandsgebaseerde bestandssystemen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#snapshots>19.14. Snapshots van bestandssystemen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#quotas>19.15. Bestandssysteemquota</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#disks-encrypting>19.16. Schijfpartities versleutelen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#swap-encrypting>19.17. Het versleutelen van de wisselbestand ruimte</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/disks/#disks-hast>19.18. Highly Available Storage (HAST)</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/geom/>Hoofdstuk 20. GEOM: Modulair schijftransformatie raamwerk</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/geom/#geom-synopsis>20.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/geom/#GEOM-intro>20.2. GEOM inleiding</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/geom/#GEOM-striping>20.3. RAID0 - aaneengeschakeld</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/geom/#GEOM-mirror>20.4. RAID1 - spiegelen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/geom/#GEOM-raid3>20.5. RAID3 - Striping op byte-niveau met toegewijde pariteit</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/geom/#geom-ggate>20.6. GEOM Gate netwerk apparaten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/geom/#geom-glabels>20.7. Het labelen van schijven</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/geom/#geom-gjournal>20.8. UFS logboeken door middel van GEOM</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/filesystems/>Hoofdstuk 21. Ondersteuning van bestandssystemen</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/filesystems/#filesystems-synopsis>21.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/filesystems/#filesystems-zfs>21.2. Het Z File System (ZFS)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/filesystems/#filesystems-linux>21.3. Linux® bestandssystemen</a></li></ul></li><li><input type=checkbox id=chapter-375257268d95faaf87faf4f7a2e6aa67 class=toggle>
<label class="icon cursor" for=chapter-375257268d95faaf87faf4f7a2e6aa67><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/virtualization/>Hoofdstuk 22. Virtualisatie</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/virtualization/#virtualization-synopsis>22.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/virtualization/#virtualization-guest>22.2. FreeBSD als een gast-besturingssysteem</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/virtualization/#virtualization-host>22.3. FreeBSD als een gastheer-besturingssysteem</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/l10n/>Hoofdstuk 23. Lokalisatie - I18N/L10N gebruiken en instellen</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/l10n/#l10n-synopsis>23.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/l10n/#l10n-basics>23.2. Beginselen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/l10n/#using-localization>23.3. Lokalisatie gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/l10n/#l10n-compiling>23.4. I18N-programma’s compileren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/l10n/#lang-setup>23.5. FreeBSD lokaliseren naar talen</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/cutting-edge/>Hoofdstuk 24. FreeBSD updaten en upgraden</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/cutting-edge/#updating-upgrading-synopsis>24.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>24.2. FreeBSD Update</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/cutting-edge/#updating-upgrading-portsnap>24.3. Portsnap: een updategereedschap voor de Portscollectie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/cutting-edge/#updating-upgrading-documentation>24.4. De documentatie bijwerken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/cutting-edge/#current-stable>24.5. Een ontwikkelingstak volgen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/cutting-edge/#synching>24.6. Broncode synchroniseren</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/cutting-edge/#makeworld>24.7. De "wereld" opnieuw bouwen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/cutting-edge/#make-delete-old>24.8. Het verwijderen van overbodige bestanden, directories en bibliotheken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/cutting-edge/#small-lan>24.9. Meerdere machines bijwerken</a></li></ul></li><li><input type=checkbox id=chapter-29c1eeb0e9dedc487a98399e2737ee8a class=toggle>
<label class="icon cursor" for=chapter-29c1eeb0e9dedc487a98399e2737ee8a><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/dtrace/>Hoofdstuk 25. DTrace</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/dtrace/#dtrace-synopsis>25.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/dtrace/#dtrace-implementation>25.2. Implementatieverschillen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/dtrace/#dtrace-enable>25.3. Ondersteuning voor DTrace aanzetten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/dtrace/#dtrace-using>25.4. DTrace gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/dtrace/#dtrace-language>25.5. De taal D</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/partiv/>Deel IV. Netwerkcommunicatie</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/serialcomms/>Hoofdstuk 26. Seriële communicatie</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/serialcomms/#serial-synopsis>26.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/serialcomms/#serial>26.2. Inleiding</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/serialcomms/#term>26.3. Terminals</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/serialcomms/#dialup>26.4. Inbeldienst</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/serialcomms/#dialout>26.5. Uitbeldienst</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/serialcomms/#serialconsole-setup>26.6. Seriële console opzetten</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/ppp-and-slip/>Hoofdstuk 27. PPP en SLIP</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>27.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ppp-and-slip/#userppp>27.2. Gebruikmaken van gebruiker-PPP</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ppp-and-slip/#ppp>27.3. Kernel-PPP gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ppp-and-slip/#ppp-troubleshoot>27.4. Het problemen oplossen van PPP-verbindingen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ppp-and-slip/#pppoe>27.5. PPP gebruiken over Ethernet (PPPoE)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ppp-and-slip/#pppoa>27.6. Gebruik maken van PPP over ATM (PPPoA)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/ppp-and-slip/#slip>27.7. Gebruik maken van SLIP</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/mail/>Hoofdstuk 28. Elektronische mail</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#mail-synopsis>28.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#mail-using>28.2. Gebruik maken van elektronische mail</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#sendmail>28.3. sendmail instellen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#mail-changingmta>28.4. De Mail Transfer Agent vervangen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#mail-trouble>28.5. Problemen oplossen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#mail-advanced>28.6. Geavanceerde onderwerpen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#SMTP-UUCP>28.7. SMTP met UUCP</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#outgoing-only>28.8. Instellen om alleen te versturen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#SMTP-dialup>28.9. Mail gebruiken met een inbelverbinding</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#SMTP-Auth>28.10. SMTP-authenticatie</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#mail-agents>28.11. Mail User Agents</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#mail-fetchmail>28.12. fetchmail gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mail/#mail-procmail>28.13. procmail gebruiken</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/>Hoofdstuk 29. Netwerkdiensten</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-servers-synopsis>29.1. Overzicht</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-inetd>29.2. De inetd"Super-Server"</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-nfs>29.3. Netwerkbestandssysteem (NFS)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-nis>29.4. Netwerkinformatiesysteem (NIS/YP)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-dhcp>29.5. Automatisch netwerk instellen (DHCP)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-dns>29.6. Domeinnaamsysteem (DNS)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-apache>29.7. Apache HTTP server</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-ftp>29.8. File Transfer Protocol (FTP)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-samba>29.9. Bestands- en printdiensten voor Microsoft® Windows® cliënten (Samba)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-ntp>29.10. Tijd synchroniseren met NTP</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/network-servers/#network-syslogd>29.11. Hosts op afstand loggen met <code>syslogd</code></a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/firewalls/>Hoofdstuk 30. Firewalls</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/firewalls/#firewalls-intro>30.1. Inleiding</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/firewalls/#firewalls-concepts>30.2. Firewallconcepten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/firewalls/#firewalls-apps>30.3. Firewallsoftware</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/firewalls/#firewalls-pf>30.4. De OpenBSD Packet Filter (PF) en ALTQ</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/firewalls/#firewalls-ipf>30.5. De IPFILTER (IPF) firewall</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/firewalls/#firewalls-ipfw>30.6. IPFW</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle checked>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/>Hoofdstuk 31. Geavanceerde netwerken</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#advanced-networking-synopsis>31.1. Samenvatting</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-routing>31.2. Gateways en routes</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-wireless>31.3. Draadloze netwerken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-bluetooth>31.4. Bluetooth</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-bridging>31.5. Bridging</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-aggregation>31.6. Verbindingsaggregatie en failover</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-diskless>31.7. Schijfloos werken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-pxe-nfs>31.8. Met PXE en een NFS-root-bestandssysteem opstarten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-isdn>31.9. ISDN</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-natd>31.10. Network Address Translation</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-ipv6>31.11. IPv6</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#network-atm>31.12. Asynchronous Transfer Mode (ATM)</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/advanced-networking/#carp>31.13. Common Address Redundancy Protocol (CARP)</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/partv/>Deel V. Appendix</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/mirrors/>Bijlage A. FreeBSD verkrijgen</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/mirrors/#mirrors-cdrom>A.1. CD-ROM en DVD uitgevers</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mirrors/#mirrors-ftp>A.2. FTP sites</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mirrors/#mirrors-svn>A.3. Subversion-sites</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mirrors/#anoncvs>A.4. Anonieme CVS</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mirrors/#ctm>A.5. CTM gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mirrors/#cvsup>A.6. CVSup gebruiken</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mirrors/#cvs-tags>A.7. CVS labels</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/mirrors/#mirrors-rsync>A.8. rsync sites</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/bibliography/>Bijlage B. Bibliografie</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/bibliography/#bibliography-freebsd>B.1. Boeken & tijdschriften over FreeBSD</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/bibliography/#bibliography-userguides>B.2. Voor gebruikers</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/bibliography/#bibliography-adminguides>B.3. Voor beheerders</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/bibliography/#bibliography-programmers>B.4. Voor programmeurs</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/bibliography/#bibliography-osinternals>B.5. Dieper in het besturingssysteem</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/bibliography/#bibliography-security>B.6. Over beveiliging</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/bibliography/#bibliography-hardware>B.7. Over hardware</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/bibliography/#bibliography-history>B.8. UNIX® geschiedenis</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/bibliography/#bibliography-journals>B.9. Tijdschriften en periodieken</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/eresources/>Bijlage C. Bronnen op Internet</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/eresources/#eresources-mail>C.1. Mailinglijsten</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/eresources/#eresources-news>C.2. Usenet-nieuwsgroepen</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/eresources/#eresources-web>C.3. World wide webservers</a></li><li><a href=http://172.16.201.134:1313/nl/books/handbook/eresources/#eresources-email>C.4. Email-adressen</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=http://172.16.201.134:1313/nl/books/handbook/pgpkeys/>Bijlage D. PGP sleutels</a><ul><li><a href=http://172.16.201.134:1313/nl/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Beambten</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>Hoofdstuk 31. Geavanceerde netwerken</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#advanced-networking-synopsis>31.1. Samenvatting</a></li><li><a href=#network-routing>31.2. Gateways en routes</a></li><li><a href=#network-wireless>31.3. Draadloze netwerken</a></li><li><a href=#network-bluetooth>31.4. Bluetooth</a></li><li><a href=#network-bridging>31.5. Bridging</a></li><li><a href=#network-aggregation>31.6. Verbindingsaggregatie en failover</a></li><li><a href=#network-diskless>31.7. Schijfloos werken</a></li><li><a href=#network-pxe-nfs>31.8. Met PXE en een NFS-root-bestandssysteem opstarten</a></li><li><a href=#network-isdn>31.9. ISDN</a></li><li><a href=#network-natd>31.10. Network Address Translation</a></li><li><a href=#network-ipv6>31.11. IPv6</a></li><li><a href=#network-atm>31.12. Asynchronous Transfer Mode (ATM)</a></li><li><a href=#carp>31.13. Common Address Redundancy Protocol (CARP)</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=advanced-networking-synopsis>31.1. Samenvatting<a class=anchor href=#advanced-networking-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>Dit hoofdstuk zal een aantal onderwerpen over geavanceerde netwerken behandelen.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk is bekend:</p></div><div class=ulist><ul><li><p>De beginselen van gateways en routes.</p></li><li><p>Hoe IEEE® 802.11- en Bluetooth®-apparaten te installeren.</p></li><li><p>Hoe FreeBSD als een bridge te laten werken.</p></li><li><p>Hoe een schijfloze machine vanaf het netwerk op te starten.</p></li><li><p>Hoe opstarten met netwerk-PXE en een NFS-root-bestandssysteem te installeren.</p></li><li><p>Hoe Network Address Translation te installeren.</p></li><li><p>Hoe IPv6 op een FreeBSD-machine te installeren.</p></li><li><p>Hoe ATM in te stellen.</p></li><li><p>Hoe de mogelijkheden van CARP, het Common Address Redundancy Protocol, aan te zetten en te benutten.</p></li></ul></div><div class=paragraph><p>Voordat dit hoofdstuk gelezen wordt, dient de lezer:</p></div><div class=ulist><ul><li><p>De beginselen van de scripts in <span class=filename>/etc/rc</span> te begrijpen.</p></li><li><p>Bekend te zijn met basisnetwerktermen.</p></li><li><p>Te weten hoe een nieuwe FreeBSD-kernel in te stellen en te installeren (<a href=../kernelconfig/#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li><li><p>Te weten hoe aanvullende software van derde partijen te installeren (<a href=../ports/#ports>Applicaties installeren. pakketten en ports</a>).</p></li></ul></div></div></div><div class=sect1><h2 id=network-routing>31.2. Gateways en routes<a class=anchor href=#network-routing></a></h2><div class=sectionbody><div class=paragraph><p>Indien een machine een andere machine over een netwerk wil vinden, dient er een mechanisme te zijn dat beschrijft hoe van de ene naar de andere machine te gaan. Dit wordt <em>routen</em> genoemd. Een "route" is een gedefinieerd adressenpaar: een "bestemming" en een "gateway". Het paar geeft aan dat door deze <em>gateway</em> gecommuniceerd moet worden om bij deze <em>bestemming</em> aan te komen. Er zijn drie soorten bestemmingen: individuele host, subnetten en "standaard". De "standaardroute" wordt gebruikt indien geen van de andere routes van toepassing zijn. Verderop wordt verder op standaardroutes ingegaan. Er zijn ook drie soorten gateways: individuele hosts, interfaces (ook wel "verbindingen " genoemd), en Ethernet-hardware-adressen (MAC-adressen).</p></div><div class=sect2><h3 id=_een_voorbeeld>31.2.1. Een voorbeeld<a class=anchor href=#_een_voorbeeld></a></h3><div class=paragraph><p>Om de verschillende aspecten van routen te illustreren, wordt het volgende voorbeeld van <code>netstat</code> gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% netstat <span class=nt>-r</span>
Routing tables

Destination      Gateway            Flags     Refs     Use     Netif Expire

default          outside-gw         UGSc       37      418      ppp0
localhost        localhost          UH          0      181       lo0
test0            0:e0:b5:36:cf:4f   UHLW        5    63288       ed0     77
10.20.30.255     <span class=nb>link</span><span class=c>#1             UHLW        1     2421</span>
example.com      <span class=nb>link</span><span class=c>#1             UC          0        0</span>
host1            0:e0:a8:37:8:1e    UHLW        3     4601       lo0
host2            0:e0:a8:37:8:1e    UHLW        0        5       lo0 <span class=o>=&gt;</span>
host2.example.com <span class=nb>link</span><span class=c>#1             UC          0        0</span>
224              <span class=nb>link</span><span class=c>#1             UC          0        0</span></code></pre></div></div><div class=paragraph><p>De eerste twee regels geven de standaardroute (die behandeld wordt in de <a href=#network-routing-default>volgende sectie</a>) en de <code>localhost</code>-route aan.</p></div><div class=paragraph><p>De interface (kolom <code>Netif</code>) dat deze routeertabel aangeeft om voor <code>localhost</code> te gebruiken is <span class=filename>lo0</span>, ook bekend als het teruglusapparaat. Dit geeft aan dat alle verkeer voor deze bestemming intern gehouden moet worden, in plaats van het over het LAN te sturen, aangezien het alleen aankomt op de plaats waar het verzonden werd.</p></div><div class=paragraph><p>Het volgende dat opvalt zijn de adressen die beginnen met <code>0:e0:</code>. Dit zijn Ethernet-hardware adressen, ook bekend als MAC-adressen. FreeBSD zal automatisch elke host (<code>test0</code> in het voorbeeld) op het lokale Ethernet identificeren en een route voor die host toevoegen, direct van deze host over de Ethernet-interface, <span class=filename>ed0</span>. Er is ook een timeout (kolom <code>Expire</code>) met deze routesoort geassocieerd, die gebruikt wordt indien er binnen een bepaalde tijd geen bericht komt van de host. Indien dit gebeurt, wordt de route naar deze host automatisch verwijderd. Deze hosts worden geïdentificeerd door middel van een mechanisme dat bekend staat als RIP (Routing Information Protocol), dat routes naar lokale hosts bepaald door middel van een kortste-pad algoritme.</p></div><div class=paragraph><p>FreeBSD zal ook subnetroutes voor het lokale subnet toevoegen (<code>10.20.30.255</code> is het broadcast-adres voor het subnet <code>10.20.30</code>, en <code>example.com</code> is de domeinnaam die bij dat subnet hoort). De aanduiding <code>link#1</code> verwijst naar de eerste Ethernetkaart in de machine. Merk op dat voor hen geen aanvullende interface is gespecificeerd.</p></div><div class=paragraph><p>Voor beide groepen (lokale netwerkhosts en lokale subnetten) worden de routes automatisch ingesteld door een daemon genaamd routed. Indien dit niet draait, zullen alleen routes die statisch gedefinieerd (i.e., expliciet vermeld zijn) bestaan.</p></div><div class=paragraph><p>De regel met <code>host1</code> verwijst naar deze host, het kent deze door het Ethernetadres. Aangezien het de zendende host is, weet FreeBSD dat het de teruglus-interface (<span class=filename>lo0</span>) moet gebruiken, in plaats van het over de Ethernet-interface te verzenden.</p></div><div class=paragraph><p>De twee regels met <code>host2</code> geven een voorbeeld van wat er gebeurt als een alias met <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> gebruikt wordt (in de sectie over Ethernet staan redenen waarom dit gedaan wordt). Het symbool <code>⇒</code> na de interface <span class=filename>lo0</span> zegt dat niet alleen de teruglus gebruikt wordt (aangezien dit adres ook verwijst naar de lokale host), maar specifiek dat dit een alias is. Zulke routes verschijnen alleen op de hosts die de alias ondersteunen; alle andere hosts op het lokale netwerk vermelden simpelweg een regel met <code>link#1</code> voor zulke routes.</p></div><div class=paragraph><p>De laatste regel (bestemming subnet <code>224</code>) heeft te maken met multicasten, wat in een andere sectie besproken wordt.</p></div><div class=paragraph><p>Als laatste staan in de kolom <code>Flags</code> verschillende attributen. Hieronder staat een korte tabel met enkele van deze vlaggen en hun betekenis:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>U</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Up: De route is actief.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>H</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Host: De bestemming van de route is een enkele host.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>G</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gateway: Stuur alles voor deze bestemming door naar dit verre systeem, dat zoekt daar uit waar het verder naar te sturen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>S</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Statisch: Deze route was handmatig ingesteld, dus niet automatisch door het systeem aangemaakt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>C</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Kloon: Maakt op basis van deze route een nieuwe route aan voor machines waarmee verbinding wordt gemaakt. Dit soort routes wordt gewoonlijk in lokale netwerken gebruikt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>W</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>WasGekloond: Geeft aan dat een route automatisch was ingesteld gebaseerd op een LAN (kloon)-route.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>L</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Verbinding: De route maakt gebruik van verwijzingen naar Ethernet-hardware.</p></td></tr></tbody></table></div><div class=sect2><h3 id=network-routing-default>31.2.2. Standaardroutes<a class=anchor href=#network-routing-default></a></h3><div class=paragraph><p>Wanneer het lokale systeem een verbinding met een verre host moet maken, controleert het de routeertabel op reeds bekende paden. Indien de verre host binnen een subnet valt waarvan bekend is hoe het bereikt kan worden (gekloonde routes), controleert het systeem of het met de daarbij behorende interface verbinding kan maken.</p></div><div class=paragraph><p>Indien alle bekende paden falen, heeft het systeem één laatste mogelijkheid: de "standaardroute". Deze route is een speciaal soort gateway-route (gewoonlijk de enig aanwezige in het systeem) en is altijd gemarkeerd met een <code>c</code> in het vlaggenveld. Voor hosts op een LAN staat deze gateway ingesteld op de machine die een directe verbinding met de buitenwereld heeft (via een PPP-verbinding, DSL, kabelmodem, T1, of een ander netwerkinterface).</p></div><div class=paragraph><p>Indien de standaardroute wordt ingesteld voor een machine die zelf als gateway naar de buitenwereld werkt, zal de standaardroute de gateway-machine van de internetprovider zijn.</p></div><div class=paragraph><p>Hieronder volgt een voorbeeld van standaardroutes. Dit is een veelgebruikte opstelling:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/net-routing.png alt="net routing"></div></div><div class=paragraph><p>De hosts <code>Lokaal1</code> en <code>Lokaal2</code> staan op deze site. <code>Lokaal1</code> is verbonden met een internetprovider via een inbel-PPP-verbinding. Deze PPP-server is door een LAN verbonden met een andere gateway-computer door een externe interface naar de Internet-feed van de internetprovider.</p></div><div class=paragraph><p>De standaardroutes voor de machines zijn:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Host</th><th class="tableblock halign-left valign-top">Standaard gateway</th><th class="tableblock halign-left valign-top">Interface</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ethernet</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>T1-GW</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PPP</p></td></tr></tbody></table><div class=paragraph><p>Een veelvoorkomende vraag is "Waarom (of hoe) moet worden ingesteld dat <code>T1-GW</code> de standaard gateway is voor <code>Lokaal1</code>, in plaats van de server van de internetprovider waarmee het verbonden is?".</p></div><div class=paragraph><p>Onthoud dat, aangezien de PPP-interface een adres gebruikt op het lokale netwerk van de internetprovider voor deze kant van de verbinding, routes voor alle andere machines op het lokale netwerk van de internetprovider automatisch aangemaakt worden. Daarom is het al bekend hoe de machine <code>T1-GW</code> bereikt kan worden, dus is de tussenstap dat het verkeer eerst naar de server van de internetprovider gestuurd wordt niet nodig.</p></div><div class=paragraph><p>Het is gebruikelijk om het adres <code>X.X.X.1</code> te gebruiken als het gateway-adres voor het lokale netwerk. Dus (gebruikmakend van hetzelfde voorbeeld), indien de lokale klasse-C adresruimte <code>10.20.30</code> was en de internetprovider <code>10.9.9</code> gebruikte, zouden de standaardroutes als volgt zijn:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Host</th><th class="tableblock halign-left valign-top">Standaardroute</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal2 (10.20.30.2)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal1 (10.20.30.1)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lokaal1 (10.20.30.1, 10.9.9.30)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>T1-GW (10.9.9.1)</p></td></tr></tbody></table><div class=paragraph><p>De standaardroute kan eenvoudig in <span class=filename>/etc/rc.conf</span> gedefinieerd worden. In dit voorbeeld werd de volgende regel aan <span class=filename>/etc/rc.conf</span> van <code>Lokaal2</code> toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;10.20.30.1&#34;</pre></div></div><div class=paragraph><p>Het is ook mogelijk dit met het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=route&amp;sektion=8&amp;format=html">route(8)</a> direct vanaf de opdrachtregel te doen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add default 10.20.30.1</span></code></pre></div></div><div class=paragraph><p>Voor meer informatie over het handmatig manipuleren van netwerkrouteertabellen kan de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=route&amp;sektion=8&amp;format=html">route(8)</a> geraadpleegd worden.</p></div></div><div class=sect2><h3 id=network-dual-homed-hosts>31.2.3. Dual Homed machines<a class=anchor href=#network-dual-homed-hosts></a></h3><div class=paragraph><p>Er is nog één andere soort opstelling die behandeld dient te worden, en dat is een host die in twee verschillende netwerken zit. Technisch gezien telt elke machine die als gateway dienst doet (in bovenstaand voorbeeld door een PPP-verbinding te gebruiken) als een dual-homed host. Maar de term wordt echt alleen gebruikt om naar een machine te verwijzen die in twee LAN’s zit.</p></div><div class=paragraph><p>In het ene geval heeft de machine twee Ethernetkaarten, waarbij elke kaart een adres op de gescheiden subnetten heeft. Een alternatief is dat de machine slechts één Ethernetkaart heeft en gebruikt maakt van <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> aliasing. Het eerste wordt gebruikt indien er twee fysiek gescheiden Ethernet-netwerken in gebruik zijn, het laatste indien er één fysiek netwerksegment is, maar er twee logisch gescheiden subnetten zijn.</p></div><div class=paragraph><p>In beide gevallen worden er routeertabellen aangemaakt zodat elk subnet weet dat deze machine de gedefinieerde gateway (ingaande route) naar het andere subnet is. Deze opstelling, waarbij de machine dienst doet als router tussen de twee subnetten, wordt vaak gebruikt voor het implementeren van pakketfilters of firewall-beveiliging in één of beide richtingen.</p></div><div class=paragraph><p>Om deze machine daadwerkelijk pakketten te laten forwarden tussen de twee interfaces, moet aan FreeBSD verteld worden dat het deze mogelijkheid aan moet zetten. In de volgende sectie staan meer details over hoe dit te doen.</p></div></div><div class=sect2><h3 id=network-dedicated-router>31.2.4. Een router bouwen<a class=anchor href=#network-dedicated-router></a></h3><div class=paragraph><p>Een netwerkrouter is simpelweg een systeem dat pakketten van de ene naar de andere interface doorstuurt. Internetstandaarden en goede ontwerppraktijken verhinderen het FreeBSD Project dit standaard in FreeBSD aan te zetten. Deze mogelijkheid kan worden aangezet door de volgende variabele in <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> op <code>YES</code> in te stellen:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;	# Op YES instellen indien deze host een gateway is</pre></div></div><div class=paragraph><p>Deze optie stelt de <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> variabele <code>net.inet.ip.forwarding</code> in op <code>1</code>. Indien het nodig is om het routen tijdelijk te stoppen, kan deze variabele tijdelijk op <code>0</code> worden teruggezet.</p></div><div class=paragraph><p>De nieuwe router heeft routes nodig om te weten waar het het verkeer naar toe moet sturen. Voor een eenvoudig netwerk kunnen statische routes gebruikt worden. FreeBSD wordt met het standaard BSD routeer-daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=routed&amp;sektion=8&amp;format=html">routed(8)</a> geleverd, dat RIP (zowel versie 1 en versie 2) en IRDP spreekt. Ondersteuning voor BGP v4, OSPF v2, en andere slimme routeerprotocollen is beschikbaar via het pakket <a class=package href=https://cgit.freebsd.org/ports/tree/net/zebra/>net/zebra</a>. Ook zijn commerciële producten als GateD® beschikbaar voor complexere netwerkrouteer-oplossingen.</p></div></div><div class=sect2><h3 id=network-static-routes>31.2.5. Statische routes opzetten<a class=anchor href=#network-static-routes></a></h3><div class=sect3><h4 id=_handmatige_configuratie>31.2.5.1. Handmatige configuratie<a class=anchor href=#_handmatige_configuratie></a></h4><div class=paragraph><p>Er wordt van het volgende netwerk uitgegaan:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/static-routes.png alt="static routes"></div></div><div class=paragraph><p>In dit scenario is <code>RouterA</code> een FreeBSD-machine die dienst doet als router naar de rest van het Internet. Het heeft een standaardroute ingesteld op <code>10.0.0.1</code>, dat het in staat stelt om verbindingen met de buitenwereld te maken. Er wordt aangenomen dat <code>RouterB</code> reeds juist is ingesteld en dat het weet hoe het waar naar toe moet gaan. (In dit plaatje is dit simpel. Voeg een standaardroute op <code>RouterB</code> toe door <code>192.168.1.1</code> als gateway te gebruiken.)</p></div><div class=paragraph><p>De routeertabel voor <code>RouterA</code> zou er ongeveer als volgt uitzien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% netstat <span class=nt>-nr</span>
Routing tables

Internet:
Destination        Gateway            Flags    Refs      Use  Netif  Expire
default            10.0.0.1           UGS         0    49378    xl0
127.0.0.1          127.0.0.1          UH          0        6    lo0
10.0.0.0/24          <span class=nb>link</span><span class=c>#1             UC          0        0    xl0</span>
192.168.1.0/24       <span class=nb>link</span><span class=c>#2             UC          0        0    xl1</span></code></pre></div></div><div class=paragraph><p>Met de huidige routeertabel is <code>RouterA</code> niet in staat om Intern Net 2 te bereiken. Het heeft geen route voor <code>192.168.2.0/24</code>. Een manier om dit te verhelpen is om de route handmatig toe te voegen. Het volgende commando voegt het netwerk Intern Net 2 toe aan de routeertabel van <code>RouterA</code> door <code>192.168.1.2</code> als de volgende hop te gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add -net 192.168.2.0/24 192.168.1.2</span></code></pre></div></div><div class=paragraph><p>Nu kan <code>RouterA</code> elke host op het netwerk <code>192.168.2.0/24</code> bereiken.</p></div></div><div class=sect3><h4 id=_persistente_configuratie>31.2.5.2. Persistente configuratie<a class=anchor href=#_persistente_configuratie></a></h4><div class=paragraph><p>Bovenstaand voorbeeld is perfect voor het instellen van een statische route op een draaiend systeem. Een probleem is dat de routeerinformatie verdwijnt indien de FreeBSD-machine opnieuw wordt opgestart. Aanvullende statische routes kunnen in <span class=filename>/etc/rc.conf</span> opgenomen worden:</p></div><div class="literalblock programlisting"><div class=content><pre># Voeg Intern Net 2 als een statische route toe
static_routes=&#34;internnet2&#34;
route_internnet2=&#34;-net 192.168.2.0/24 192.168.1.2&#34;</pre></div></div><div class=paragraph><p>De instellingsvariabele <code>static_routes</code> is een lijst van strings gescheiden door een spatie. Elke string verwijst naar een routenaam. Bovenstaand voorbeeld heeft slechts één string in <code>static_routes</code>. Dit is de string <em>internnet2</em>. Vervolgens wordt een instellingsvariabele <code>route_internnet2</code> toegevoegd waarin alle instellingsparameters staan die aan het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=route&amp;sektion=8&amp;format=html">route(8)</a> moeten worden doorgegeven. Voor bovenstaand voorbeeld zou het volgende commando zijn gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add -net 192.168.2.0/24 192.168.1.2</span></code></pre></div></div><div class=paragraph><p>Dus is <code>"-net 192.168.2.0/24 192.168.1.2"</code> nodig.</p></div><div class=paragraph><p>Zoals hierboven is vermeld is het mogelijk om meerdere strings in <code>static_routes</code> te hebben. Dit maakt het mogelijk om meerdere statische routes aan te maken. De volgende regels geven een voorbeeld van het toevoegen van statische routes voor de netwerken <code>192.168.0.0/24</code> en <code>192.168.1.0/24</code> op een denkbeeldige router:</p></div><div class="literalblock programlisting"><div class=content><pre>static_routes=&#34;net1 net2&#34;
route_net1=&#34;-net 192.168.0.0/24 192.168.0.1&#34;
route_net2=&#34;-net 192.168.1.0/24 192.168.1.1&#34;</pre></div></div></div></div><div class=sect2><h3 id=network-routing-propagation>31.2.6. Routes propageren<a class=anchor href=#network-routing-propagation></a></h3><div class=paragraph><p>Er is al gesproken over hoe routes naar de buitenwereld te definiëren, maar niet over hoe de buitenwereld ons kan vinden.</p></div><div class=paragraph><p>Het is al bekend dat routeertabellen aangemaakt kunnen worden zodat al het verkeer voor een bepaalde adresruimte (in ons voorbeeld een klasse-C subnet) naar een bepaalde host op dat netwerk gezonden kan worden, dat de ingaande pakketten doorgeeft.</p></div><div class=paragraph><p>Wanneer een adresruimte aan een site wordt toegewezen, stelt de serviceprovider al hun routeertabellen zodanig in dat al het verkeer voor het bijhorende subnet naar de PPP-verbinding van de site gezonden wordt. Maar hoe weten sites door het land heen hoe naar de internetprovider van deze site te versturen?</p></div><div class=paragraph><p>Er bestaat een systeem (dat veel lijkt op de gedistribueerde DNS-informatie) dat alle toegewezen adresruimtes bijhoudt, en hun verbindingspunt met de Internet Backbone definieert. De "Backbone" zijn de grote kabels die Internetverkeer door het land en over de wereld sturen. Elke backbone-machine heeft een kopie van een master-verzameling van tabellen, die verkeer voor een bepaald netwerk naar een bepaalde backbone-carrier sturen, en van daaruit naar een keten van serviceproviders totdat het netwerk van de site bereikt is.</p></div><div class=paragraph><p>Het is de taak van de serviceprovider om bij de backbone-sites aan te geven dat zij het verbindingspunt (en dus het ingaande pad) zijn voor de site. Dit staat bekend als routepropagatie.</p></div></div><div class=sect2><h3 id=network-routing-troubleshooting>31.2.7. Problemen oplossen<a class=anchor href=#network-routing-troubleshooting></a></h3><div class=paragraph><p>Soms is er een probleem met routepropagatie en kunnen sommige sites geen verbinding maken. Misschien is het nuttigste commando om proberen uit te zoeken waar het routen misgaat <a href="https://man.freebsd.org/cgi/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a>. Het is ook nuttig als er geen verbinding mogelijk lijkt met een verre machine (dus als <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> faalt).</p></div><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a> wordt gedraaid met de naam van de verre host waarmee geprobeerd wordt te verbinden. Het laat de gateway-hosts zien langs het gepoogde pad, dat uiteindelijk de doelhost bereikt, of wegens een gebrek aan verbinding afgebroken wordt.</p></div><div class=paragraph><p>Raadpleeg voor meer informatie de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a>.</p></div></div><div class=sect2><h3 id=network-routing-multicast>31.2.8. Multicast routen<a class=anchor href=#network-routing-multicast></a></h3><div class=paragraph><p>FreeBSD ondersteunt zowel multicast-applicaties als multicast routen van huis uit. Voor multicast-applicaties is geen speciale configuratie van FreeBSD nodig; applicaties draaien over het algemeen als geleverd. Voor multicast routen dient ondersteuning in de kernel gecompileerd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>options MROUTING</pre></div></div><div class=paragraph><p>Ook dient de multicast-routeer-daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a> ingesteld worden zodat het tunnels en DVMRP via <span class=filename>/etc/mrouted.conf</span> aanmaakt. Kijk voor meer details over multicast-instellingen in de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a> multicast-routeer-daemon implementeert het multicast-routeer-protocol DVRMP welke in veel multicast-installaties grotendeels is vervangen door <a href="https://man.freebsd.org/cgi/man.cgi?query=pim&amp;sektion=4&amp;format=html">pim(4)</a>. <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a> en de gerelateerde <a href="https://man.freebsd.org/cgi/man.cgi?query=map-mbone&amp;sektion=8&amp;format=html">map-mbone(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=mrinfo&amp;sektion=8&amp;format=html">mrinfo(8)</a> gereedschappen zijn beschikbaar in de FreeBSD Ports Collectie als <a class=package href=https://cgit.freebsd.org/ports/tree/net/mrouted/>net/mrouted</a>.</p></div></td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=network-wireless>31.3. Draadloze netwerken<a class=anchor href=#network-wireless></a></h2><div class=sectionbody><div class=sect2><h3 id=_de_beginselen_van_draadloos_netwerken>31.3.1. De beginselen van draadloos netwerken<a class=anchor href=#_de_beginselen_van_draadloos_netwerken></a></h3><div class=paragraph><p>De meeste draadloze netwerken zijn op de IEEE® 802.11 standaarden gebaseerd. Een eenvoudig draadloos netwerk bestaat uit meerdere stations die met radio’s communiceren die in de 2,4GHz of de 5GHz band uitzenden (alhoewel dit regionaal varieert en het ook verandert om communicatie in de 2,3GHz en de 4,9GHz banden mogelijk te maken).</p></div><div class=paragraph><p>802.11-netwerken zijn op twee manieren georganiseerd: in <em>infrastructuurmodus</em> treedt één station als meester op, alle andere stations associëren met dit station; dit netwerk staat bekend als een BSS en het meesterstation heet een toegangspunt (AP). In een BSS gaat alle communicatie via het AP; zelfs als een station met een ander draadloos station wil communiceren gaan de boodschappen door het AP. In de tweede netwerkvorm is er geen meester en communiceren de stations direct. Deze netwerkvorm is een IBSS en staat gewoonlijk bekend als een <em>ad-hoc netwerk</em>.</p></div><div class=paragraph><p>802.11 netwerken begonnen in de 2,4GHz band waarbij gebruik werd gemaakt van protocollen die door de IEEE® 802.11 en 802.11b standaarden worden gedefinieerd. Deze specificaties omvatten de werkfrequenties, karakteristieken van de MAC-lagen waaronder frame- en zendsnelheden (communicatie kan met verschillende snelheden plaatsvinden). Later definieerde de 802.11a-standaard het werken in de 5GHz band, inclusief andere mechanismen voor signalering en hogere zendsnelheden. Nog later werd de 802.11g-standaard gedefinieerd om gebruik te kunnen maken van de signalerings- en zendmechanismen van 802.11a in de 2,4GHz band zodanig dat het met terugwerkende kracht werkt op 802.11b-netwerken.</p></div><div class=paragraph><p>Afgezien van de onderliggende zendtechnieken beschikken 802.11-netwerken over een verscheidenheid aan beveiligingstechnieken. De originele 802.11-specificaties definieerden een eenvoudig beveiligingsprotocol genaamd WEP. Dit protocol maakt gebruik van een vaste, van te voren gedeelde sleutel en het cryptografische algoritme RC4 om de gegevens die over het netwerk verstuurd worden te coderen. Alle stations dienen dezelfde sleutel te gebruiken om te kunnen communiceren. Het is bewezen dat dit mechanisme eenvoudig te kraken is en wordt nu, afgezien om voorbijgaande gebruikers te ontmoedigen het netwerk te gebruiken, nog zelden gebruikt. De huidige beveiligingsmethoden worden gegeven door de IEEE® 802.11i specificatie dat nieuwe cryptografische algoritmen en een aanvullend protocol om stations aan een toegangspunt te authenticeren en om sleutels voor gegevenscommunicatie uit te wisselen definieert. Verder worden cryptografische sleutels periodiek ververst en zijn er mechanismen om indringpogingen te detecteren (en om indringpogingen tegen te gaan). Een andere specificatie van een veelgebruikt beveiligingsprotocol in draadloze netwerken is WPA. Dit was een voorloper op 802.11i en gedefinieerd door een industriegroep als een tussenmaatregel terwijl er gewacht werd op de ratificatie van 802.11i. WPA specificeert een deel van de eisen van 802.11i en is ontworpen voor implementatie op verouderde hardware. In het bijzonder vereist WPA alleen de TKIP-sleutel die van de originele WEP-sleutel is afgeleid. 802.11i staat het gebruik van TKIP toe maar vereist ook ondersteuning voor een sterkere sleutel, AES-CCM, om gegevens te versleutelen. (De AES-sleutel was niet nodig in WPA omdat het rekenkundig te kostbaar werd geacht voor implementatie op verouderde hardware.)</p></div><div class=paragraph><p>Afgezien van de bovenstaande protocolstandaarden is de andere belangrijke standaard waarvan bewustzijn belangrijk is 802.11e. Deze standaard definieert het opstellen van multimediatoepassingen zoals gestroomde video en voice over IP (VoIP) binnen een 802.11-netwerk. Net als 802.11i heeft ook 802.11e een voorgaande specificatie genaamd WME (later hernoemd tot WMM) die door een industriegroep is gedefinieerd als een deelverzameling van 802.11e die nu kan worden gebruikt om multimediatoepassingen mogelijk te maken terwijl er gewacht wordt op de uiteindelijke ratificatie van 802.11e. Het belangrijkste om over 802.11e en WME/WMM te weten is dat ze gepriotiseerd verkeersgebruik van een draadloos netwerk mogelijk maken door middel van Quality of Service (QoS) protocollen en protocollen voor verbeterde mediatoegang. Een juiste implementatie van deze protocollen maken snelle gegevensbursts en gepriotiseerde verkeersstromen mogelijk.</p></div><div class=paragraph><p>FreeBSD ondersteunt netwerken die met 802.11a, 802.11b, en 802.11g werken. Ook worden de veiligheidsprotocollen WPA en 802.11i ondersteund (samen met 11a, 11b, of 11g) en QoS en de verkeerspriorisatieprotocollen die nodig zijn voor de protocollen WME/WMM worden voor een beperkte verzameling draadloze apparatuur ondersteund.</p></div></div><div class=sect2><h3 id=network-wireless-basic>31.3.2. Basisinstallatie<a class=anchor href=#network-wireless-basic></a></h3><div class=sect3><h4 id=_kernelinstellingen>31.3.2.1. Kernelinstellingen<a class=anchor href=#_kernelinstellingen></a></h4><div class=paragraph><p>Om van een draadloos netwerk gebruik te maken is het nodig om een draadloze netwerkkaart te hebben en om de kernel met de juiste ondersteuning voor draadloze netwerken in te stellen. Het laatste is verdeeld in meerdere modulen zodat alleen de software ingesteld hoeft te worden die daadwerkelijk gebruikt zal worden.</p></div><div class=paragraph><p>Ten eerste is een draadloos netwerkapparaat nodig. De meestgebruikte apparaten zijn degenen die onderdelen van Atheros gebruiken. Deze apparaten worden ondersteund door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a> en voor hen dient de volgende regel aan <span class=filename>/boot/loader.conf</span> toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>if_ath_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het stuurprogramma voor Atheros is opgedeeld in drie verschillende delen: het eigenlijke stuurprogramma (<a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a>), de ondersteuningslaag voor de hardware die chip-specifieke functies afhandelt (<a href="https://man.freebsd.org/cgi/man.cgi?query=ath_hal&amp;sektion=4&amp;format=html">ath_hal(4)</a>), en een algoritme om de snelheid om frames te verzenden te kiezen uit een reeks mogelijke waarden (hier ath_rate_sample). Indien deze ondersteuning als kernelmodules wordt geladen, zullen de afhankelijkheden automatisch afgehandeld worden. Voor andere apparaten dan die van Atheros dient de module voor dat stuurprogramma geladen te worden; bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>if_wi_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>voor apparaten die op onderdelen van Intersil Prism zijn gebaseerd (stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=wi&amp;sektion=4&amp;format=html">wi(4)</a>).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In de rest van dit document zal een <a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a> apparaat gebruikt worden, de naam van het apparaat in de voorbeelden dient aangepast te worden aan de lokale installatie. Een lijst van beschikbare draadloze stuurprogramma’s en ondersteunde adapters staat in de FreeBSD Hardware Notes. Kopieën hiervan voor verschillende uitgaven en architecturen zijn beschikbaar op de <a href=http://www.FreeBSD.org/releases/>Uitgave Informatie</a> pagina van de FreeBSD website. Indien er geen origineel stuurprogramma voor het draadloze apparaat bestaat, is het mogelijk om te proberen om direct het stuurprogramma van Windows® proberen te gebruiken met behulp van de stuurprogramma-wrapper <a href=../config/#config-network-ndis>NDIS</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Daarvoor zijn ook de modules nodig die cryptografische ondersteuning implementeren voor de te gebruiken veiligheidsprotocollen. Het is de bedoeling dat ze dynamisch door de module <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan&amp;sektion=4&amp;format=html">wlan(4)</a> worden geladen maar momenteel dienen ze handmatig ingesteld te worden. De volgende modules zijn beschikbaar: <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_wep&amp;sektion=4&amp;format=html">wlan_wep(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_ccmp&amp;sektion=4&amp;format=html">wlan_ccmp(4)</a>, en <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_tkip&amp;sektion=4&amp;format=html">wlan_tkip(4)</a>. Zowel de stuurprogramma’s <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_ccmp&amp;sektion=4&amp;format=html">wlan_ccmp(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_tkip&amp;sektion=4&amp;format=html">wlan_tkip(4)</a> zijn alleen nodig indien het veiligheidsprotocol WPA en/of 802.11i gebruikt wordt. Indien het netwerk encryptieloos dient te zijn, is de ondersteuning van <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_wep&amp;sektion=4&amp;format=html">wlan_wep(4)</a> niet nodig. Om deze modules tijdens het opstarten te laden, dienen de volgende regels aan <span class=filename>/boot/loader.conf</span> toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>wlan_wep_load=&#34;YES&#34;
wlan_ccmp_load=&#34;YES&#34;
wlan_tkip_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Nadat deze informatie aan het instellingenbestand om het systeem op te starten (i.e., <span class=filename>/boot/loader.conf</span>) is toegevoegd, is het noodzakelijk om de FreeBSD-computer opnieuw op te starten. Indien het ongewenst is om de computer nu opnieuw op te starten, kunnen de modules ook handmatig worden geladen door <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> te gebruiken.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien het gebruik van modules ongewenst is, kunnen deze stuurprogramma’s in de kernel worden gecompileerd door de volgende regels aan het kernelinstellingenbestand toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>device wlan              # 802.11 ondersteuning
device wlan_wep          # 802.11 WEP-ondersteuning
device wlan_ccmp         # 802.11 CCMP-ondersteuning
device wlan_tkip         # 802.11 TKIP-ondersteuning
device wlan_amrr	 # AMRR controle-algoritme voor zendsnelheid
device ath	         # Atheros PCI/Cardbus netwerkkaarten
device ath_hal		 # Ondersteuning voor PCI/cardbus chips
options AH_SUPPORT_AR5146 # zet AR5146 tx/rx descriptors aan
device ath_rate_sample   # SampleRate verzendsnelheid-controle voor ath</pre></div></div><div class=paragraph><p>Met deze informatie in het kernelinstellingenbestand kan de kernel opnieuw gecompileerd en de FreeBSD-computer opnieuw opgestart worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Wanneer het systeem draait, is het mogelijk om enige informatie over de draadloze apparaten in de opstartboodschappen te vinden, zoals:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ath0: &lt;Atheros 5212&gt; mem 0x88000000-0x8800ffff irq 11 at device 0.0 on cardbus1
ath0: <span class=o>[</span>ITHREAD]
ath0: AR2413 mac 7.9 RF2413 phy 4.5</code></pre></div></div></div></div><div class=sect2><h3 id=_infrastructuurmodus>31.3.3. Infrastructuurmodus<a class=anchor href=#_infrastructuurmodus></a></h3><div class=paragraph><p>De infrastructuur- of BSS-modus is de modus die normaliter gebruikt wordt. In deze modus zijn een aantal draadloze toegangspunten verbonden met een bedraad netwerk. Elk draadloos netwerk heeft een eigen naam, deze naam wordt de SSID van het netwerk genoemd. Draadloze cliënten verbinden zich met de draadloze toegangspunten.</p></div><div class=sect3><h4 id=_freebsd_cliënten>31.3.3.1. FreeBSD cliënten<a class=anchor href=#_freebsd_cliënten></a></h4><div class=sect4><h5 id=_hoe_toegangspunten_te_vinden>31.3.3.1.1. Hoe toegangspunten te vinden<a class=anchor href=#_hoe_toegangspunten_te_vinden></a></h5><div class=paragraph><p>Voor het scannen van netwerken wordt het commando <code>ifconfig</code> gebruikt. Het kan even duren voordat dit verzoek is afgehandeld aangezien het systeem op elke beschikbare draadloze frequentie naar toegangspunten moet zoeken. Alleen de super-gebruiker kan zo’n scan opzetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 up scan</span>
SSID/MESH ID  BSSID              CHAN RATE   S:N     INT CAPS
dlinkap       00:13:46:49:41:76   11   54M <span class=nt>-90</span>:96 100 EPS  WPA WME
freebsdap     00:11:95:c3:0d:ac    1   54M <span class=nt>-83</span>:96 100 EPS  WPA</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De interface dient als up te worden gemarkeerd voordat het scannen begint. Voor verdere scans is het niet nodig om de interface als up te markeren.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De uitvoer van een scanverzoek vermeld elk gevonden BSS/IBSS-netwerk. Naast de naam van het netwerk, <code>SSID</code>, staat het <code>BSSID</code>, wat het MAC-adres van het toegangspunt is. Het veld <code>CAPS</code> identificeert het type van elk netwerk en de mogelijkheden van de stations die daar werkzaam zijn:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 1. Station Capability Codes</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Capability Code</th><th class="tableblock halign-left valign-top">Betekenis</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>E</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Uitgebreide dienstenverzameling (ESS). Geeft aan dat het station deel uitmaakt van een infrastructuurnetwerk (in tegenstelling tot een IBSS-/ ad-hoc-netwerk).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>I</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IBSS-/ad-hoc-netwerk. Geeft aan dat het station deel uitmaakt van een ad-hoc-netwerk (in tegenstelling tot een ESS-netwerk).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>P</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Privacy. Vertrouwelijkheid is vereist voor alle gegevensframes die binnen het BSS worden uitgewisseld. Dit betekent dat dit BSS eist dat het station cryptografische middelen als WEP, TKIP of AES-CCMP dient te gebruiken om de gegevensframes die met anderen worden uitgewisseld te versleutelen en te ontsleutelen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>S</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Korte preambule. Geeft aan dat het netwerk korte preambules gebruikt (gedefinieerd in 802.11b Hoge Snelheid/DSSS PHY, korte preambule gebruikt een 56-bits synchronisatieveld in tegenstelling tot een 128-bits dat bij lange preambules wordt gebruikt).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>s</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Korte slottijd. Geeft aan dat het 802.11g-netwerk een korte slottijd gebruikt omdat er geen verouderde (802.11b) stations aanwezig zijn.</p></td></tr></tbody></table><div class=paragraph><p>Het is ook mogelijk om de huidige lijst van bekende netwerken weer te geven met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig scan0 list scan</span></code></pre></div></div><div class=paragraph><p>Deze informatie kan automatisch bijgewerkt worden door de adapter of handmatig met een <code>scan</code> verzoek. Oude gegevens worden automatisch uit de cache verwijderd, dus kan deze lijst na verloop van tijd korter worden tenzij er meer scanverzoeken gedaan worden.</p></div></div><div class=sect4><h5 id=_basisinstellingen>31.3.3.1.2. Basisinstellingen<a class=anchor href=#_basisinstellingen></a></h5><div class=paragraph><p>Deze sectie geeft een eenvoudig voorbeeld hoe de draadloze netwerkadapter in FreeBSD zonder encryptie aan de praat te krijgen. Nadat deze concepten bekend zijn, wordt het sterk aangeraden om <a href=#network-wireless-wpa>WPA</a> te gebruiken om de draadloze netwerken op te zetten.</p></div><div class=paragraph><p>Er zijn drie basisstappen om een draadloos netwerk in te stellen: een toegangspunt kiezen, het station authenticeren, en een IP-adres instellen. De volgende secties behandelen elk een stap.</p></div><div class=sect5><h6 id=_een_toegangspunt_kiezen>31.3.3.1.2.1. Een toegangspunt kiezen<a class=anchor href=#_een_toegangspunt_kiezen></a></h6><div class=paragraph><p>In de meeste gevallen is het voldoende om het systeem een toegangspunt gebaseerd op de ingebouwde heuristieken te laten kiezen. Dit is het standaardgedrag wanneer een interface als up wordt gemarkeerd of als een interface wordt ingesteld door het te noemen in <span class=filename>/etc/rc.conf</span>, bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;DHCP&#34;</pre></div></div><div class=paragraph><p>Indien er meerdere toegangspunten zijn en het gewenst is om een specifieke te kiezen, kan dit met het SSID:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;ssid uw_ssid_hier DHCP&#34;</pre></div></div><div class=paragraph><p>In een omgeving waar meerdere toegangspunten hetzelfde SSID hebben (vaak gedaan om roamen eenvoudiger te maken) kan het nodig zijn om met één specifiek apparaat te associëren. In dit geval kan ook het BSSID van het toegangspunt gespecificeerd worden (het SSID kan ook weggelaten worden):</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;ssid uw_ssid_hier bssid xx:xx:xx:xx:xx:xx DHCP</pre></div></div><div class=paragraph><p>Er zijn andere manieren om de keuze van een toegangspunt te beperken zoals het beperken van het aantal frequenties waarop het systeem scant. Dit kan handig zijn bij multi-band-netwerkkaarten aangezien het scannen van alle mogelijke kanalen tijdrovend kan zijn. Om de werking tot een specifieke band te beperken kan de parameter <code>mode</code> gebruikt worden; bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;mode 11g ssid uw_ssid_hier DHCP&#34;</pre></div></div><div class=paragraph><p>zal de kaart forceren om te werken in 802.11g welke alleen voor 2,4GHz frequenties is gedefinieerd dus de 5GHz kanalen blijven buiten beschouwing. Andere manieren om dit te doen zijn de parameter <code>channel</code>, om bewerkingen op één specifieke frequentie vast te zetten, en de parameter <code>chanlist</code>, om een lijst van te scannen kanalen te specificeren. Meer informatie over deze parameters kan in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> gevonden worden.</p></div></div><div class=sect5><h6 id=_authenticatie>31.3.3.1.2.2. Authenticatie<a class=anchor href=#_authenticatie></a></h6><div class=paragraph><p>Nadat er een toegangspunt is gekozen moet het station zich authenticeren voordat het gegevens kan versturen. Authenticatie kan op verschillende manieren gebeuren. Het meest gebruikte schema wordt open authenticatie genoemd en staat doe dat elk station aan het netwerk deelneemt en communiceert. Deze manier van authenticatie dient gebruikt te worden voor testdoeleinden tijdens het voor de eerste keer opzetten van een draadloos netwerk. Andere schema’s vereisen dat cryptografische overeenkomsten voltooid worden voordat gegevensverkeer kan stromen; ofwel door vooraf gedeelde sleutels of geheimen te gebruiken, of door complexere schema’s te gebruiken welke achterliggende diensten zoals RADIUS betrekken. De meeste gebruikers zullen open authenticatie gebruiken welke de standaardinstelling is. De dan meest voorkomende opstelling is WPA-PSK, ook bekend als WPA Personal, welke <a href=#network-wireless-wpa-wpa-psk>hieronder</a> beschreven is.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien er een Apple® AirPort® Extreme basisstation als toegangspunt wordt gebruikt kan het nodig zijn om gedeelde-sleutel-authenticatie samen met een WEP-sleutel in te stellen. Dit kan gedaan worden in het bestand <span class=filename>/etc/rc.conf</span> of door het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant&amp;sektion=8&amp;format=html">wpa_supplicant(8)</a> te gebruiken. Indien er een enkel AirPort® basisstation wordt gebruikt kan de toegang met zoiets als het volgende worden ingesteld:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;authmode shared wepmode on weptxkey 1 wepkey 01234567 DHCP&#34;</pre></div></div><div class=paragraph><p>Over het algemeen dient authenticatie via gedeelde sleutels worden voorkomen omdat het materiaal van de WEP-sleutel op een zeer afgedwongen manier gebruikt wordt wat het zelfs gemakkelijker maakt om de sleutel te kraken. Indien WEP gebruikt moet worden (bijvoorbeeld voor compatibiliteit met verouderde apparaten) is het beter om WEP met <code>open</code> authenticatie te gebruiken. Meer informatie met betrekking tot WEP kan gevonden worden in <a href=#network-wireless-wep>WEP</a>.</p></div></td></tr></tbody></table></div></div><div class=sect5><h6 id=_een_ip_adres_verkrijgen_met_dhcp>31.3.3.1.2.3. Een IP-adres verkrijgen met DHCP<a class=anchor href=#_een_ip_adres_verkrijgen_met_dhcp></a></h6><div class=paragraph><p>Nadat het toegangspunt is gekozen en de parameters voor de authenticatie zijn ingesteld, dient er een IP-adres ter communicatie verkregen worden. In de meeste gevallen wordt het draadloze IP-adres verkregen via DHCP. Om dat te bereiken, dient <span class=filename>/etc/rc.conf</span> bewerkt te worden en <code>DHCP</code> aan de instellingen voor het apparaat toegevoegd te worden zoals in de verschillende bovenstaande voorbeelden is laten zien:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;DHCP&#34;</pre></div></div><div class=paragraph><p>Op dit moment kan de draadloze interface geactiveerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif start</span></code></pre></div></div><div class=paragraph><p>Wanneer de interface draait, kan <code>ifconfig</code> gebruikt worden om de status van de interface <span class=filename>ath0</span> te zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        ether 00:11:95:d5:43:62
	inet 192.168.1.00 netmask 0xffffff00 broadcast 192.168.1.255
        media: IEEE 802.11 Wireless Ethernet OFDM/54Mbps mode 11g
        status: associated
        ssid dlinkap channel 11 <span class=o>(</span>2462 Mhz 11g<span class=o>)</span> bssid 00:13:46:49:41:76
	country US ecm authmode OPEN privacy OFF txpower 21.5 bmiss 7
	scanvalid 60 bgscan bgscanintvl 300 bgscanidle 250 roam:rssi 7
	roam:rate 5 protmode CTS wme burst</code></pre></div></div><div class=paragraph><p>Het <code>status: associated</code> betekent dat er verbinding is met een draadloos netwerk (in dit geval met het netwerk <code>dlinkap</code>). Het gedeelte <code>bssid 00:13:46:49:41:76</code> is het MAC-adres van het toegangspunt; de gedeelte met <code>authmode</code> vertelt dat de communicatie niet versleuteld is.</p></div></div><div class=sect5><h6 id=_statisch_ip_adres>31.3.3.1.2.4. Statisch IP-adres<a class=anchor href=#_statisch_ip_adres></a></h6><div class=paragraph><p>In het geval dat het niet mogelijk is om een IP-adres van een DHCP-server te krijgen, kan er een vast IP-adres worden ingesteld. Vervang het sleutelwoord <code>DHCP</code> van hierboven met de adresinformatie. Zorg ervoor dat de andere parameters voor het selecteren van een toegangspunt behouden blijven:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;inet 192.168.1.100 netmask 255.255.255.0 ssid uw_ssid_hier&#34;</pre></div></div></div></div><div class=sect4><h5 id=network-wireless-wpa>31.3.3.1.3. WPA<a class=anchor href=#network-wireless-wpa></a></h5><div class=paragraph><p>WPA (Wi-Fi Protected Access) is een beveiligingsprotocol dat samen met 802.11-netwerken wordt gebruikt om het gebrek aan degelijke authenticatie en de zwakte van <a href=#network-wireless-wep>WEP</a> te benadrukken. WPA verbetert het 802.1X-authenticatieprotocol en gebruikt een sleutel gekozen uit meerdere in plaats van WEP voor gegevensintegriteit. De enige sleutel welke WPA vereist is TKIP (Temporary Key Integrity Protocol). TKIP is een sleutel dat de basis-RC4-sleutel welke door WEP wordt gebruikt uitbreidt door integriteitscontroles, knoeidetectie, en maatregelen om op elke gedetecteerde inbraak te reageren toe te voegen. TKIP is ontworpen om op verouderde hardware met enkel wijzigingen in software te draaien; het representeert een compromis dat de veiligheid verbetert maar nog steeds niet geheel immuun is tegen aanvallen. WPA specificeert ook de sleutel AES-CCMP als een alternatief voor TKIP welke te verkiezen is indien mogelijk; voor deze specificatie wordt gewoonlijk de term WPA2 (of RSN) gebruikt.</p></div><div class=paragraph><p>WPA definieert protocollen voor authenticatie en versleuteling. Authenticatie gebeurt het meeste door één van deze twee technieken te gebruiken: door 802.1X en een achterliggende authenticatiedienst zoals RADIUS, of door een minimale overeenkomst tussen het station en het toegangspunt door een van te voren gedeeld geheim te gebruiken. Het eerste wordt vaak WPA Enterprise genoemd en het laatste staat bekend als WPA Personal. Aangezien de meeste mensen geen achterliggende RADIUS-server voor hun draadloos netwerk zullen opzetten, is WPA-PSK veruit de meest gebruikte configuratie voor WPA.</p></div><div class=paragraph><p>Het beheer van de draadloze verbinding en de authenticatie (sleutelonderhandeling of authenticatie met een server) gebeurt met het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant&amp;sektion=8&amp;format=html">wpa_supplicant(8)</a>. Dit programma vereist dat er een instellingenbestand, <span class=filename>/etc/wpa_supplicant.conf</span>, draait. Meer informatie over dit bestand kan in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant.conf&amp;sektion=5&amp;format=html">wpa_supplicant.conf(5)</a> worden gevonden.</p></div><div class=sect5><h6 id=network-wireless-wpa-wpa-psk>31.3.3.1.3.1. WPA-PSK<a class=anchor href=#network-wireless-wpa-wpa-psk></a></h6><div class=paragraph><p>WPA-PSK, ook bekend als WPA-Personal, is gebaseerd op een vooraf gedeelde sleutel (PSK) gegenereerd vanuit een gegeven wachtwoord die gebruikt zal worden als de hoofdsleutel in het draadloze netwerk. Dit betekent dat alle draadloze gebruikers dezelfde sleutel zullen delen. WPA-PSK is bedoeld voor kleine netwerken waar het gebruik van een authenticatieserver niet mogelijk of gewenst is.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Gebruik altijd sterke wachtwoorden welke voldoende lang zijn en opgebouwd zijn uit een grote tekenverzameling zodat ze niet gemakkelijk worden geraden of aangevallen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De eerste stap is het instellen van het bestand <span class=filename>/etc/wpa_supplicant.conf</span> met het SSID en de vooraf gedeelde sleutel van het netwerk:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34;
  psk=&#34;freebsdmall&#34;
}</pre></div></div><div class=paragraph><p>Daarna zal in <span class=filename>/etc/rc.conf</span> worden aangegeven dat de draadloze configuratie met WPA zal gebeuren en dat het IP-adres met DHCP zal worden verkregen:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>Hierna kan de interface geactiveerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif start</span>
Starting wpa_supplicant.
DHCPDISCOVER on wlan0 to 255.255.255.255 port 67 interval 5
DHCPDISCOVER on wlan0 to 255.255.255.255 port 67 interval 6
DHCPOFFER from 192.168.0.1
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.1
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet OFDM/36Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class=paragraph><p>Ook kan gepoogd worden dit handmatig in te stellen door hetzelfde <span class=filename>/etc/wpa_supplicant.conf</span> als <a href=#network-wireless-wpa-wpa-psk>hierboven</a> te gebruiken, en dit te draaien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># wpa_supplicant -i wlan0 -c /etc/wpa_supplicant.conf</span>
Trying to associate with 00:11:95:c3:0d:ac <span class=o>(</span><span class=nv>SSID</span><span class=o>=</span><span class=s1>&#39;freebsdap&#39;</span> <span class=nv>freq</span><span class=o>=</span>2412 MHz<span class=o>)</span>
Associated with 00:11:95:c3:0d:ac
WPA: Key negotiation completed with 00:11:95:c3:0d:ac <span class=o>[</span><span class=nv>PTK</span><span class=o>=</span>CCMP <span class=nv>GTK</span><span class=o>=</span>CCMP]
CTRL-EVENT-CONNECTED - Connection to 00:11:95:c3:0d:ac completed <span class=o>(</span>auth<span class=o>)</span> <span class=o>[</span><span class=nb>id</span><span class=o>=</span>0 <span class=nv>idstr</span><span class=o>=]</span></code></pre></div></div><div class=paragraph><p>De volgende stap is het lanceren van het commando <code>dhclient</code> om een IP-adres van de DHCP-server te krijgen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dhclient wlan0</span>
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.1
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
<span class=c># ifconfig wlan0</span>
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet OFDM/36Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON defxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><span class=filename>/etc/rc.conf</span> heeft een regel <code>ifconfig_wlan0</code> met de tekst <code>DHCP</code> (zoals <code>ifconfig_wlan0="DHCP"</code>), <code>dhclient</code> zal automatisch gestart worden nadat <code>wpa_supplicant</code> geassocieerd is met het toegangspunt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Als DHCP niet mogelijk of gewenst is, kan een statisch IP-adres worden ingesteld nadat <code>wpa_supplicant</code> het station heeft geauthenticeerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 inet 192.168.0.100 netmask 255.255.255.0</span>
<span class=c># ifconfig wlan0</span>
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.100 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet OFDM/36Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class=paragraph><p>Indien DHCP niet wordt gebruikt, dienen ook de standaard gateway en de naamserver handmatig ingesteld te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add default uw_standaard_router</span>
<span class=c># echo &#34;nameserver uw_DNS_server&#34; &gt;&gt; /etc/resolv.conf</span></code></pre></div></div></div><div class=sect5><h6 id=network-wireless-wpa-eap-tls>31.3.3.1.3.2. WPA met EAP-TLS<a class=anchor href=#network-wireless-wpa-eap-tls></a></h6><div class=paragraph><p>De tweede manier om WPA te gebruiken is met een achterliggende 802.1X-authenticatieserver. In dit geval wordt het WPA-Enterprise genoemd om het verschil met het minder veilige WPA-Personal met de vooraf gedeelde sleutel aan te duiden. Authenticatie is in WPA-Enterprise gebaseerd op EAP (Extensible Authentication Protocol).</p></div><div class=paragraph><p>EAP wordt niet met een encryptiemethode geleverd. In plaats daarvan was het besloten om EAP in een versleutelde tunnel te omsluiten. Er bestaan vele EAP-authenticatiemethodes, de meest voorkomende zijn EAP-TLS, EAP-TTLS, en EAP-PEAP.</p></div><div class=paragraph><p>EAP-TLS (EAP met Transport Layer Security) is een zeer goed ondersteund authenticatieprotocol in de draadloze wereld aangezien het de eerste EAP-methode was die gecertificeerd werd door de <a href=http://www.wi-fi.org>Wi-Fi alliantie</a>. EAP-TLS vereist dat er drie certificaten draaien: het CA-certificaat (geïnstalleerd op alle machines), het servercertificaat voor de authenticatieserver, en een cliëntcertificaat voor elke draadloze cliënt. Bij deze EAP-methode authenticeren zowel de authenticatieserver als de draadloze cliënt elkaar door hun respectievelijke certificaten te laten zien, en ze controleren dat deze certificaten zijn getekend door de certificatenauthoriteit (CA) van de organisatie.</p></div><div class=paragraph><p>Zoals voorheen gebeurt het instellen via <span class=filename>/etc/wpa_supplicant.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34; <i class=conum data-value=1></i><b>(1)</b>
  proto=RSN  <i class=conum data-value=2></i><b>(2)</b>
  key_mgmt=WPA-EAP <i class=conum data-value=3></i><b>(3)</b>
  eap=TLS <i class=conum data-value=4></i><b>(4)</b>
  identity=&#34;loader&#34; <i class=conum data-value=5></i><b>(5)</b>
  ca_cert=&#34;/etc/certs/cacert.pem&#34; <i class=conum data-value=6></i><b>(6)</b>
  client_cert=&#34;/etc/certs/clientcert.pem&#34; <i class=conum data-value=7></i><b>(7)</b>
  private_key=&#34;/etc/certs/clientkey.pem&#34; <i class=conum data-value=8></i><b>(8)</b>
  private_key_passwd=&#34;freebsdmallclient&#34; <i class=conum data-value=9></i><b>(9)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Dit veld geeft de naam van het netwerk (SSID) aan.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Hier wordt het RSN (IEEE® 802.11i) protocol gebruikt, ofwel WPA2.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>De regel <code>key_mgmt</code> verwijst naar het gebruikte sleutelbeheerprotocol. In dit geval is het WPA dat EAP-authenticatie gebruikt: <code>WPA-EAP</code>.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>In dit veld wordt de EAP-methode voor de verbinding genoemd.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Het veld <code>identity</code> bevat de identiteitsstring voor EAP.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Het veld <code>ca_cert</code> geeft de padnaam van het CA-certificaatbestand aan. Dit bestand is nodig om het servercertificaat te controleren.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>De regel <code>client_cert</code> geeft de padnaam van het cliëntcertificaatbestand aan. Dit certificaat is uniek voor elke draadloze cliënt van het netwerk.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>Het veld <code>private_key</code> is de padnaam naar het bestand dat de privésleutel van het cliëntcertificaat bevat.</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>Het veld <code>private_key_passwd</code> bevat het wachtwoord voor de privésleutel.</td></tr></tbody></table></div><div class=paragraph><p>Voeg vervolgens de volgende regels toe aan <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>De volgende stap is het activeren van de interface:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif start</span>
Starting wpa_supplicant.
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.20
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet DS/11Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class=paragraph><p>Zoals eerder is laten zien, is het ook mogelijk om de interface handmatig te activeren met zowel de commando’s <code>wpa_supplicant</code> en <code>ifconfig</code>.</p></div></div><div class=sect5><h6 id=network-wireless-wpa-eap-ttls>31.3.3.1.3.3. WPA met EAP-TTLS<a class=anchor href=#network-wireless-wpa-eap-ttls></a></h6><div class=paragraph><p>Bij EAP-TLS hebben zowel de authenticatieserver als de cliënt een certificaat nodig, met EAP-TTLS (EAP-Tunneled Transport Layer Security) is een cliëntcertificaat optioneel. Deze methode komt in de buurt van wat sommige beveiligde websites doen, waar de webserver een veilige SSL-tunnel kan aanmaken zelfs als de bezoekers geen certificaten aan de cliëntkant hebben. EAP-TTLS zal de versleutelde TLS-tunnel gebruiken voor het veilig transporteren van de authenticatiegegevens.</p></div><div class=paragraph><p>De instellingen worden gedaan via het bestand <span class=filename>/etc/wpa_supplicant.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34;
  proto=RSN
  key_mgmt=WPA-EAP
  eap=TTLS <i class=conum data-value=1></i><b>(1)</b>
  identity=&#34;test&#34; <i class=conum data-value=2></i><b>(2)</b>
  password=&#34;test&#34; <i class=conum data-value=3></i><b>(3)</b>
  ca_cert=&#34;/etc/certs/cacert.pem&#34; <i class=conum data-value=4></i><b>(4)</b>
  phase2=&#34;auth=MD5&#34; <i class=conum data-value=5></i><b>(5)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Dit veld noemt de EAP-methode voor de verbinding.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Het veld <code>identity</code> bevat de identiteitsstring voor EAP-authenticatie binnen de versleutelde TLS-tunnel.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Het veld <code>password</code> bevat het wachtwoord voor de EAP-authenticatie.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Het veld <code>ca_cert</code> wijst naar de padnaam van het CA-certificaatbestand. Dit bestand is nodig om het servercertificaat te controleren.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Dit veld noemt de gebruikte authenticatiemethode in de versleutelde TLS-tunnel. In dit geval is EAP met MD5-Challenge gebruikt. De "binnenste authenticatie"-fase wordt vaak "phase2" genoemd.</td></tr></tbody></table></div><div class=paragraph><p>Ook dienen de volgende regels toegevoegd te worden aan <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_ath0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>De volgende stap is het activeren van de interface:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif start</span>
Starting wpa_supplicant.
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 7
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 15
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 21
DHCPACK from 192.168.0.20
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet autoselect DS/11Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div></div><div class=sect5><h6 id=network-wireless-wpa-eap-peap>31.3.3.1.3.4. WPA met EAP-PEAP<a class=anchor href=#network-wireless-wpa-eap-peap></a></h6><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>PEAPv0/EAP-MSCHAPv2 is de meest gebruikelijke PEAP-methode. In de rest van dit document wordt de term PEAP gebruikt om naar die methode te verwijzen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>PEAP (Beveiligd EAP) is ontworpen als een alternatief voor EAP-TTLS, en is de meest gebruikte EAP-standaard na EAP-TLS. Met andere woorden, als u een netwerk met verschillende besturingssystemen heeft, zou PEAP de meest ondersteunde standaard moeten zijn na EAP-TLS.</p></div><div class=paragraph><p>PEAP is soortgelijk aan EAP-TTLS: het gebruikt een server-side certificaat om de cliënten te authenticeren door een beveiligde TLS-tunnel tussen de cliënt en de authenticatieserver aan te maken, welke de uitwisseling van de authenticatie-informatie beschermt. Vanuit een beveiligingsoogpunt gezien is het verschil tussen EAP-TTLS en PEAP dat PEAP-authenticatie de gebruikersnaam onversleuteld uitzendt, alleen het wachtwoord wordt in de beveiligde TLS-tunnel verzonden. EAP-TTLS gebruikt de TLS-tunnel voor zowel de gebruikersnaam als het wachtwoord.</p></div><div class=paragraph><p>Het bestand <span class=filename>/etc/wpa_supplicant.conf</span> dient gewijzigd te worden om de EAP-PEAP-gerelateerde instellingen toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34;
  proto=RSN
  key_mgmt=WPA-EAP
  eap=PEAP <i class=conum data-value=1></i><b>(1)</b>
  identity=&#34;test&#34; <i class=conum data-value=2></i><b>(2)</b>
  password=&#34;test&#34; <i class=conum data-value=3></i><b>(3)</b>
  ca_cert=&#34;/etc/certs/cacert.pem&#34; <i class=conum data-value=4></i><b>(4)</b>
  phase1=&#34;peaplabel=0&#34; <i class=conum data-value=5></i><b>(5)</b>
  phase2=&#34;auth=MSCHAPV2&#34; <i class=conum data-value=6></i><b>(6)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Dit veld noemt de EAP-methode voor de verbinding.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Het veld <code>identity</code> bevat de identiteitsstring voor EAP-authenticatie binnen de versleutelde TLS-tunnel.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Het veld <code>password</code> bevat het wachtwoord voor de EAP-authenticatie.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Het veld <code>ca_cert</code> wijst naar de padnaam van het CA-certificaatbestand. Dit bestand is nodig om het servercertificaat te controleren.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Dit veld bevat de parameters voor de eerste fase van authenticatie (de TLS-tunnel). Afhankelijk van de gebruikte authenticatieserver moet er een specifiek label voor authenticatie worden opgegeven. In de meeste gevallen zal het label "client EAP encryption" zijn welke ingesteld is door <code>peaplabel=0</code> te gebruiken. Meer informatie kan in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant.conf&amp;sektion=5&amp;format=html">wpa_supplicant.conf(5)</a> gevonden worden.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Dit veld noemt het authenticatieprotocol dat in de versleutelde TLS-tunnel gebruikt wordt. In het geval van PEAP is dit <code>auth=MSCHAPV2</code>.</td></tr></tbody></table></div><div class=paragraph><p>Het volgende dient te worden toegevoegd aan <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>Hierna kan de interface worden geactiveerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service netif start</span>
Starting wpa_supplicant.
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 7
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 15
DHCPREQUEST on wlan0 to 255.255.255.255 port 67 interval 21
DHCPACK from 192.168.0.20
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet autoselect DS/11Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div></div></div><div class=sect4><h5 id=network-wireless-wep>31.3.3.1.4. WEP<a class=anchor href=#network-wireless-wep></a></h5><div class=paragraph><p>WEP (Wired Equivalent Privacy) maakt deel uit van de oorspronkelijke 802.11 standaard. Er is geen authenticatiemechanisme, slechts een zwakke vorm van toegangscontrole, en het is gemakkelijk te kraken.</p></div><div class=paragraph><p>WEP kan worden opgezet met <code>ifconfig</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 inet 192.168.1.100 netmask 255.255.255.0 \</span>
	    ssid mijn_net wepmode on weptxkey 3 wepkey 3:0x3456789012</code></pre></div></div><div class=ulist><ul><li><p>De <code>weptxkey</code> geeft aan welke WEP-sleutel zal worden gebruikt tijdens het verzenden. Hier wordt de derde sleutel gebruikt. Dit dient overeen te komen met de instelling in het toegangspunt. Probeer, indien onbekend is welke sleutel door het toegangspunt wordt gebruikt, <code>1</code> (i.e., de eerste sleutel) voor deze waarde te gebruiken.</p></li><li><p>De <code>wepkey</code> selecteert één van de WEP-sleutels in. Het dient in het formaat <em>index:sleutel</em> te zijn. Sleutel <code>1</code> wordt als standaard gebruikt; de index hoeft alleen ingesteld te worden als we een andere dan de eerste sleutel gebruiken.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De <code>0x3456789012</code> dient vervangen te worden door de sleutel die ingesteld is voor gebruik met het toegangspunt.</p></div></td></tr></tbody></table></div></li></ul></div><div class=paragraph><p>Het wordt aangeraden om de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> te lezen voor verdere informatie.</p></div><div class=paragraph><p>De faciliteit <code>wpa_supplicant</code> kan ook gebruikt worden om de draadloze interface in te stellen voor WEP. Het bovenstaande voorbeeld kan worden ingesteld door de volgende regels toe te voegen aan <span class=filename>/etc/wpa_supplicant.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;mijn_net&#34;
  key_mgmt=NONE
  wep_key3=3456789012
  wep_tx_keyidx=3
}</pre></div></div><div class=paragraph><p>Daarna:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># wpa_supplicant -i wlan0 -c /etc/wpa_supplicant.conf</span>
Trying to associate with 00:13:46:49:41:76 <span class=o>(</span><span class=nv>SSID</span><span class=o>=</span><span class=s1>&#39;dlinkap&#39;</span> <span class=nv>freq</span><span class=o>=</span>2437 MHz<span class=o>)</span>
Associated with 00:13:46:49:41:76</code></pre></div></div></div></div></div><div class=sect2><h3 id=_ad_hoc_modus>31.3.4. Ad-hoc-modus<a class=anchor href=#_ad_hoc_modus></a></h3><div class=paragraph><p>IBSS-modus, ook ad-hoc-modus genoemd, is ontworpen voor point-to-point-verbindingen. Om bijvoorbeeld een ad-hoc-netwerk tussen de machine <code>A</code> en de machine <code>B</code> op te zetten, is het slechts nodig om twee IP-adressen en een SSID te kiezen.</p></div><div class=paragraph><p>Op machine <code>A</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode adhoc</span>
<span class=c># ifconfig wlan0 inet 192.168.0.1 netmask 255.255.255.0 ssid freebsdap</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:c3:0d:ac
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;adhoc&gt;
	  status: running
	  ssid freebsdap channel 2 <span class=o>(</span>2417 Mhz 11g<span class=o>)</span> bssid 02:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 scanvalid 60
	  protmode CTS wme burst</code></pre></div></div><div class=paragraph><p>De parameter <code>adhoc</code> geeft aan dat de interface in de IBSS-modus draait.</p></div><div class=paragraph><p>Op <code>B</code> zal het mogelijk moeten zijn om <code>A</code> te detecteren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode adhoc</span>
<span class=c># ifconfig wlan0 up scan</span>
  SSID/MESH ID    BSSID              CHAN RATE   S:N     INT CAPS
  reebsdap       02:11:95:c3:0d:ac    2   54M <span class=nt>-64</span>:-96  100 IS   WME</code></pre></div></div><div class=paragraph><p>De <code>I</code> in de uitvoer bevestigt dat machine <code>A</code> in ad-hoc-modus verkeert. Het is slechts nodig om <code>B</code> met een ander IP-adres in te stellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 inet 192.168.0.2 netmask 255.255.255.0 ssid freebsdap</span>
<span class=c># ifconfig wlan0 ssid freebsdap mediaopt adhoc inet 192.168.0.2 netmask 255.255.255.0</span>
<span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:d5:43:62
	  inet 192.168.0.2 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;adhoc&gt;
	  status: running
	  ssid freebsdap channel 2 <span class=o>(</span>2417 Mhz 11g<span class=o>)</span> bssid 02:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 scanvalid 60
	  protmode CTS wme burst</code></pre></div></div><div class=paragraph><p>Zowel <code>A</code> als <code>B</code> zijn nu klaar om informatie uit te wisselen.</p></div></div><div class=sect2><h3 id=network-wireless-ap>31.3.5. FreeBSD Host Toegangspunten<a class=anchor href=#network-wireless-ap></a></h3><div class=paragraph><p>FreeBSD kan als toegangspunt (AP) functioneren wat de noodzaak om een hardwarematig AP te kopen of een ad-hoc-netwerk te draaien wegneemt. Dit kan bijzonder nuttig zijn indien de FreeBSD-machine als gateway naar een ander netwerk (bijvoorbeeld het Internet) functioneert.</p></div><div class=sect3><h4 id=network-wireless-ap-basic>31.3.5.1. Basisinstellingen<a class=anchor href=#network-wireless-ap-basic></a></h4><div class=paragraph><p>Voordat de FreeBSD-machine als een AP wordt ingesteld, dient de kernel te worden ingesteld met de juiste ondersteuning voor draadloos netwerken voor de draadloze kaart. Ook dient er ondersteuning voor de te gebruiken beveiligingsprotocollen te worden toegevoegd. Meer details staan in <a href=#network-wireless-basic>Basisinstallatie</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Momenteel staan de NDIS-stuurprogrammawrapper en de stuurprogramma’s van Windows® het werken als AP niet toe. Alleen originele draadloze FreeBSD-stuurprogramma’s ondersteunen AP-modus.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Wanneer de ondersteuning voor draadloos netwerken is geladen, kan gecontroleerd worden of het draadloze apparaat de hostgebaseerde toegangspuntmodus ondersteunt (ook bekend als hostap-modus):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 list caps</span>
<span class=nv>drivercaps</span><span class=o>=</span>6f85edc1&lt;STA,FF,TURBOP,IBSS,HOSTAP,AHDEMO,TXPMGT,SHSLOT,SHPREAMBLE,MONITOR,MBSS,WPA1,WPA2,BURST,WME,WDS,BGSCAN,TXFRAG&gt;
<span class=nv>cryptocaps</span><span class=o>=</span>1f&lt;WEP,TKIP,AES,AES_CCM,TKIPMIC&gt;</code></pre></div></div><div class=paragraph><p>Deze uitvoer geeft de mogelijkheden van de kaart weer, het woord <code>HOSTAP</code> bevestigt dat deze draadloze kaart als toegangspunt kan functioneren. Ook worden verschillende ondersteunde versleutelmethoden genoemd: WEP, TKIP, AES, enzovoorts. Deze informatie is belangrijk om te weten welke beveiligingsprotocollen gebruikt kunnen worden op het toegangspunt.</p></div><div class=paragraph><p>Het draadloze apparaat kan enkel in hostap-modus worden gezet tijdens het creeëren van het netwerk pseudo-device dus een vooraf aangemaakt apparaat moet eerst verwijderd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 destroy</span></code></pre></div></div><div class=paragraph><p>waarna deze opnieuw aangemaakt kan worden met de juiste parameters:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode hostap</span>
<span class=c># ifconfig wlan0 inet 192.168.0.1 netmask 255.255.255.0 ssid freebsdap mode 11g channel 1</span></code></pre></div></div><div class=paragraph><p>Gebruik nogmaals <code>ifconfig</code> om de status van de interface <span class=filename>wlan0</span> te zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:c3:0d:ac
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	  status: running
	  ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 scanvalid 60
	  protmode CTS wme burst dtimperiod 1 <span class=nt>-dfs</span></code></pre></div></div><div class=paragraph><p>De parameter <code>hostap</code> geeft aan dat de interface in hostgebaseerde toegangspuntmodus draait.</p></div><div class=paragraph><p>Het instellen van de interface kan automatisch tijdens het opstarten gedaan worden door de volgende regels aan <span class=filename>/etc/rc.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
create_args_wlan0=&#34;wlanmode hostap&#34;
ifconfig_wlan0=&#34;inet 192.168.0.1 netmask 255.255.255.0 ssid freebsdap mode 11g channel 1&#34;</pre></div></div></div><div class=sect3><h4 id=_hostgebaseerde_toegangspunt_zonder_authenticatie_of_versleuteling>31.3.5.2. Hostgebaseerde toegangspunt zonder authenticatie of versleuteling<a class=anchor href=#_hostgebaseerde_toegangspunt_zonder_authenticatie_of_versleuteling></a></h4><div class=paragraph><p>Hoewel het niet aangeraden wordt om een AP zonder enige vorm van authenticatie of encryptie te draaien, is dit een eenvoudige manier om te controleren of het AP werkt. Deze configuratie is ook belangrijk voor het debuggen van problemen met cliënten.</p></div><div class=paragraph><p>Nadat het AP is ingesteld als eerder is laten zien, is het mogelijk om van een andere draadloze machine een scan te beginnen om het AP te vinden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 up scan</span>
SSID/MESH ID    BSSID              CHAN RATE   S:N     INT CAPS
freebsdap       00:11:95:c3:0d:ac    1   54M <span class=nt>-66</span>:-96  100 ES   WME</code></pre></div></div><div class=paragraph><p>De cliëntmachine heeft het AP gevonden en kan ermee geassocieerd worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig ath0 ssid freebsdap inet 192.168.0.2 netmask 255.255.255.0</span>
  ifconfig wlan0
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:d5:43:62
	  inet 192.168.0.2 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet OFDM/54Mbps mode 11g
	  status: associated
	  ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 bmiss 7
	  scanvalid 60 bgscan bgscanintvl 300 bgscanidle 250 roam:rssi 7
	  roam:rate 5 protmode CTS wme burst</code></pre></div></div></div><div class=sect3><h4 id=_wpa_hostgebaseerde_toegangspunt>31.3.5.3. WPA hostgebaseerde toegangspunt<a class=anchor href=#_wpa_hostgebaseerde_toegangspunt></a></h4><div class=paragraph><p>Deze sectie zal zich richten op opzetten van een FreeBSD toegangspunt dat het beveiligingsprotocol WPA gebruikt. Meer details over WPA en het instellen van op WPA gebaseerde draadloze cliënten kan gevonden worden in <a href=#network-wireless-wpa>WPA</a>.</p></div><div class=paragraph><p>De daemon hostapd wordt gebruikt om cliëntauthenticatie en sleutelbeheer op het toegangspunt met WPA af te handelen.</p></div><div class=paragraph><p>In het volgende zullen alle instellingsbewerkingen worden uitgevoerd op de FreeBSD-machine die als AP dienst doet. Wanneer het AP correct werkt, zou hostapd automatisch tijdens het opstarten aangezet moeten worden met de volgende regel in <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hostapd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Zorg ervoor dat voordat geprobeerd wordt om hostapd in te stellen, de basisinstellingen die in <a href=#network-wireless-ap-basic>Basisinstellingen</a> zijn geïntroduceerd zijn uitgevoerd.</p></div><div class=sect4><h5 id=_wpa_psk>31.3.5.3.1. WPA-PSK<a class=anchor href=#_wpa_psk></a></h5><div class=paragraph><p>WPA-PSK is bedoeld voor kleine netwerken waar het gebruik van een achterliggende authenticatieserver niet mogelijk of gewenst is.</p></div><div class=paragraph><p>Het instellen wordt gedaan in het bestand <span class=filename>/etc/hostapd.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>interface=wlan0 <i class=conum data-value=1></i><b>(1)</b>
debug=1 <i class=conum data-value=2></i><b>(2)</b>
ctrl_interface=/var/run/hostapd <i class=conum data-value=3></i><b>(3)</b>
ctrl_interface_group=wheel <i class=conum data-value=4></i><b>(4)</b>
ssid=freebsdap <i class=conum data-value=5></i><b>(5)</b>
wpa=1 <i class=conum data-value=6></i><b>(6)</b>
wpa_passphrase=freebsdmall <i class=conum data-value=7></i><b>(7)</b>
wpa_key_mgmt=WPA-PSK <i class=conum data-value=8></i><b>(8)</b>
wpa_pairwise=CCMP TKIP <i class=conum data-value=9></i><b>(9)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Dit veld geeft aan welke draadloze interface voor het toegangspunt wordt gebruikt.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Dit veld stelt het verbositeitsniveau in dat tijdens het draaien van hostapd wordt gebruikt. Een waarde van <code>1</code> vertegenwoordigt het minimale niveau.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Het veld <code>ctrl_interface</code> geeft de padnaam van de door hostapd gebruikte map om de domeinsocketbestanden voor communicatie met externe programma’s zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=hostapd_cli&amp;sektion=8&amp;format=html">hostapd_cli(8)</a> in op te slaan. Hier wordt de standaardwaarde gebruikt.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>De regel <code>ctrl_interface_group</code> stelt de groep in (hier is het de groep <code>wheel</code>) die toegang heeft tot de controle interfacebestanden.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Het veld <code>wpa</code> maakt WPA mogelijk en specificeert welk WPA-authenticatieprotocol nodig zal zijn. De waarde <code>1</code> stelt het AP in op WPA-PSK.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Het veld <code>wpa_passphrase</code> bevat het ASCII-wachtwoord voor de WPA-authenticatie.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>De regel <code>wpa_key_mgmt</code> verwijst naar het gebruikte sleutelbeheerprotocol. In dit geval is dat WPA-PSK.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>Het veld <code>wpa_pairwise</code> geeft aan welke versleutelingsalgoritmes door het toegangspunt worden geaccepteerd. Hier worden zowel de versleuteling TKIP (WPA) en CCMP (WPA2) geaccepteerd. De versleuteling CCMP is een alternatief voor TKIP en wordt sterk aangeraden indien mogelijk; TKIP dient alleen gebruikt te worden voor stations die geen CCMP aankunnen.</td></tr></tbody></table></div><div class=paragraph><p>De volgende stap is het starten van hostapd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service hostapd forcestart</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 2290
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255dddd
	  inet6 fe80::211:95ff:fec3:dac%ath0 prefixlen 64 scopeid 0x4
	  ether 00:11:95:c3:0d:ac
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;hostap&gt;
	  status: associated
	  ssid freebsdap channel 1 bssid 00:11:95:c3:0d:ac
	  authmode WPA2/802.11i privacy MIXED deftxkey 2 TKIP 2:128-bit txpowmax 36 protmode CTS dtimperiod 1 bintval 100</code></pre></div></div><div class=paragraph><p>Het toegangspunt draait nu, de cliënten kunnen er nu mee worden geassocieerd, zie <a href=#network-wireless-wpa>WPA</a> voor meer details. Het is mogelijk om de stations die met het AP geassocieerd zijn te zien door het commando <code>ifconfig wlan0 list</code> te gebruiken.</p></div></div></div><div class=sect3><h4 id=_wep_hostgebaseerd_toegangspunt>31.3.5.4. WEP hostgebaseerd toegangspunt<a class=anchor href=#_wep_hostgebaseerd_toegangspunt></a></h4><div class=paragraph><p>Het wordt niet aangeraden om WEP te gebruiken om een toegangspunt op te zetten aangezien er geen authenticatiemechanisme is en het gemakkelijk is te kraken. Sommige verouderde draadloze kaarten ondersteunen alleen WEP als een beveiligingsprotocol, met deze kaarten is het alleen mogelijk om een AP zonder authenticatie of encryptie of een AP dat het WEP-protocol gebruikt op te zetten.</p></div><div class=paragraph><p>Het draadloze apparaat kan nu in hostap-modus worden gezet en ingesteld worden met het juiste SSID en IP-adres:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode hostap</span>
<span class=c># ifconfig wlan0 inet 192.168.0.1 netmask 255.255.255.0 \</span>
  ssid freebsdap wepmode on weptxkey 3 wepkey 3:0x3456789012 mode 11g</code></pre></div></div><div class=ulist><ul><li><p>Het <code>weptxkey</code> geeft aan welke WEP-sleutel tijdens het zenden zal worden gebruikt. Hier wordt de derde sleutel gebruikt (merk op dat de nummering van de sleutels bij <code>1</code> begint). Deze parameter moet gespecificeerd worden om de gegevens daadwerkelijk te versleutelen.</p></li><li><p>Het <code>wepkey</code> geeft aan dat de geselecteerde WEP-sleutel wordt ingesteld. Het dient in het formaat <em>index:key</em> te zijn, indien de index niet is gegeven, wordt sleutel <code>1</code> gebruikt. Dus indien een andere sleutel dan de eerste wordt gebruikt dient de index te worden ingesteld.</p></li></ul></div><div class=paragraph><p>Weer wordt <code>ifconfig</code> gebruikt om de status van de interface <span class=filename>wlan0</span> te zien:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:c3:0d:ac
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;hostap&gt;
	  status: running
	  ssid freebsdap channel 4 <span class=o>(</span>2427 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy ON deftxkey 3 wepkey 3:40-bit
	  txpower 21.5 scanvalid 60 protmode CTS wme burst dtimperiod 1 <span class=nt>-dfs</span></code></pre></div></div><div class=paragraph><p>Vanaf een andere draadloze machine is het mogelijk om een scan te beginnen om het AP te vinden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 up scan</span>
SSID            BSSID              CHAN RATE  S:N   INT CAPS
freebsdap       00:11:95:c3:0d:ac    1   54M 22:1   100 EPS</code></pre></div></div><div class=paragraph><p>De cliëntmachine heeft het toegangspunt gevonden en kan ermee geassocieerd worden door de juiste parameters (sleutel, enz.) te gebruiken, zie <a href=#network-wireless-wep>WEP</a> voor meer details.</p></div></div></div><div class=sect2><h3 id=_zowel_de_bekabelde_als_de_draadloze_verbinding_gebruiken>31.3.6. Zowel de bekabelde als de draadloze verbinding gebruiken<a class=anchor href=#_zowel_de_bekabelde_als_de_draadloze_verbinding_gebruiken></a></h3><div class=paragraph><p>Een bekabelde verbinding biedt betere prestaties en betrouwbaarheid, terwijl een draadloze verbinding meer flexibiliteit en mobiliteit biedt; laptop-gebruikers zullen dit willen combineren en naadloos tussen de twee overschakelen.</p></div><div class=paragraph><p>In FreeBSD is het mogelijk om twee of meer netwerkinterfaces te combineren in een "failover"-opstelling, dit houdt in dat de meest geprefereerde en best beschikbare verbinding van een groep van netwerkinterfaces wordt gebruikt, en het besturingssysteem automatisch te laten overschakelen wanneer de status van de verbinding verandert.</p></div><div class=paragraph><p>Link-aggregatie en failover worden behandeld in <a href=#network-aggregation>Verbindingsaggregatie en failover</a>, een voorbeeld voor het gebruik van zowel een bekabelde als een draadloze verbinding wordt gegeven in <a href=#networking-lagg-wired-and-wireless>Failover-modus tussen bekabelde en draadloze interfaces</a>.</p></div></div><div class=sect2><h3 id=_problemen_verhelpen>31.3.7. Problemen verhelpen<a class=anchor href=#_problemen_verhelpen></a></h3><div class=paragraph><p>Indien er problemen met het draadloos netwerk zijn, zijn er een aantal stappen die genomen kunnen worden om het probleem te helpen verhelpen.</p></div><div class=ulist><ul><li><p>Indien het toegangspunt niet vermeld wordt tijdens het scannen, controleer dan of het draadloze apparaat niet is ingesteld op een beperkt aantal kanalen.</p></li><li><p>Indien het niet mogelijk is om met een toegangspunt te associëren, controleer dan of de instellingen van het station overeenkomen met die van het toegangspunt. Dit omvat het authenticatieschema en de beveiligingsprotocollen. Versimpel de configuratie zoveel mogelijk. Indien een beveiligingsprotocol als WPA of WEP wordt gebruikt, stel het toegangspunt dan in voor open authenticatie en geen beveiliging en kijk of er verkeer door kan.</p></li><li><p>Wanneer er met het toegangspunt geassocieerd kan worden, stel dan een diagnose over alle beveiligingsinstellingen met eenvoudige gereedschappen zoals <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a>.</p><div class=paragraph><p><code>wpa_supplicant</code> biedt veel ondersteuning voor debuggen; probeer het handmatig te draaien met de optie <code>-dd</code> en controleer de systeemlogs.</p></div></li><li><p>Er zijn ook veel debug-gereedschappen op lagere niveaus. Het is mogelijk om debugberichten in de laag die het 802.11 protocol ondersteunt aan te zetten door het programma <code>wlandebug</code> te gebruiken dat gevonden wordt in <span class=filename>/usr/src/tools/tools/net80211</span>. Bijvoorbeeld:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># wlandebug -i ath0 +scan+auth+debug+assoc</span>
  net.wlan.0.debug: 0 <span class=o>=&gt;</span> 0xc80000&lt;assoc,auth,scan&gt;</code></pre></div></div><div class=paragraph><p>kan worden gebruikt om consoleberichten aan te zetten die te maken hebben met het scannen van toegangspunten en het uitvoeren van 802.11 handshakes die nodig zijn om communicatie te regelen.</p></div><div class=paragraph><p>Er worden ook veel nuttige statistieken door de 802.11 laag bijgehouden; het gereedschap <code>wlanstats</code> geeft deze informatie weer. Deze statistieken zouden alle fouten die door de 802.11 laag zijn geïdentificeerd moeten identificeren. Let erop dat sommige fouten worden geïdentificeerd in de apparaatstuurprogramma’s die onder de 802.11 laag liggen zodat ze niet verschijnen. Voor het diagnosticeren van apparaatspecifieke problemen dient de documentatie van het stuurprogramma geraadpleegd te worden.</p></div></li></ul></div><div class=paragraph><p>Indien de bovenstaande informatie niet helpt om het probleem te verhelderen, stuur dan een probleemrapport op inclusief de uitvoer van de bovenstaande gereedschappen.</p></div></div></div></div><div class=sect1><h2 id=network-bluetooth>31.4. Bluetooth<a class=anchor href=#network-bluetooth></a></h2><div class=sectionbody><div class=sect2><h3 id=_introductie>31.4.1. Introductie<a class=anchor href=#_introductie></a></h3><div class=paragraph><p>Bluetooth is een draadloze technologie om persoonlijke netwerken aan te maken die in de vrije 2,4GHz-band werken binnen een straal van 10 meter. Deze netwerken worden gewoonlijk ad-hoc gevormd en bestaan uit draagbare apparaten zoals mobiele telefoons, handhelds en laptops. In tegenstelling tot die andere populaire draadloze techniek, Wi-Fi, biedt Bluetooth een hoger niveau van serviceprofielen, zoals FTP-achtige bestandsservers, pushing van bestanden, stemtransport, emulatie van seriële lijnen, en meer.</p></div><div class=paragraph><p>De Bluetooth stack is in FreeBSD geïmplementeerd door gebruik te maken van het Netgraph-raamwerk (zie <a href="https://man.freebsd.org/cgi/man.cgi?query=netgraph&amp;sektion=4&amp;format=html">netgraph(4)</a>). Veel van de Bluetooth USB-dongles worden ondersteund door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_ubt&amp;sektion=4&amp;format=html">ng_ubt(4)</a>. Apparaten gebaseerd op de Broadcom BCM2033 chip worden ondersteund door de stuurprogramma’s <a href="https://man.freebsd.org/cgi/man.cgi?query=ubtbcmfw&amp;sektion=4&amp;format=html">ubtbcmfw(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_ubt&amp;sektion=4&amp;format=html">ng_ubt(4)</a>. De 3Com Bluetooth PC Card 3CRWB60-A wordt ondersteund door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_bt3c&amp;sektion=4&amp;format=html">ng_bt3c(4)</a>. Seriële en op UART gebaseerde Bluetooth-apparaten worden ondersteund via <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_h4&amp;sektion=4&amp;format=html">ng_h4(4)</a>, en <a href="https://man.freebsd.org/cgi/man.cgi?query=hcseriald&amp;sektion=8&amp;format=html">hcseriald(8)</a>. Deze sectie beschrijft het gebruik van de USB Bluetooth-dongle.</p></div></div><div class=sect2><h3 id=_het_apparaat_inprikken>31.4.2. Het apparaat inprikken<a class=anchor href=#_het_apparaat_inprikken></a></h3><div class=paragraph><p>Standaard zijn stuurprogramma’s voor Bluetooth-apparaten beschikbaar als kernelmodules. Voordat een apparaat wordt aangekoppeld, dient het stuurprogramma in de kernel geladen te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload ng_ubt</span></code></pre></div></div><div class=paragraph><p>Indien het Bluetooth-apparaat tijdens het opstarten van het systeem in het systeem aanwezig is, kan de module vanuit <span class=filename>/boot/loader.conf</span> geladen worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ng_ubt_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Prik de USB-dongle in. Uitvoer vergelijkbaar aan de onderstaande zal op de console (of in syslog) verschijnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ubt0: vendor 0x0a12 product 0x0001, rev 1.10/5.25, addr 2
ubt0: Interface 0 endpoints: <span class=nv>interrupt</span><span class=o>=</span>0x81, bulk-in<span class=o>=</span>0x82, bulk-out<span class=o>=</span>0x2
ubt0: Interface 1 <span class=o>(</span>alt.config 5<span class=o>)</span> endpoints: isoc-in<span class=o>=</span>0x83, isoc-out<span class=o>=</span>0x3,
      <span class=nv>wMaxPacketSize</span><span class=o>=</span>49, <span class=nv>nframes</span><span class=o>=</span>6, buffer <span class=nv>size</span><span class=o>=</span>294</code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a> wordt gebruikt om de Bluetooth-stack te starten en te stoppen. Het is een goed idee om de stack te stoppen voordat het apparaat wordt losgekoppeld, maar het is (gewoonlijk) niet fataal. Tijdens het starten van de stack verschijnt er uitvoer vergelijkbaar met de onderstaande:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service bluetooth start ubt0</span>
BD_ADDR: 00:02:72:00:d4:1a
Features: 0xff 0xff 0xf 00 00 00 00 00
&lt;3-Slot&gt; &lt;5-Slot&gt; &lt;Encryption&gt; &lt;Slot offset&gt;
&lt;Timing accuracy&gt; &lt;Switch&gt; &lt;Hold mode&gt; &lt;Sniff mode&gt;
&lt;Park mode&gt; &lt;RSSI&gt; &lt;Channel quality&gt; &lt;SCO <span class=nb>link</span><span class=o>&gt;</span>
&lt;HV2 packets&gt; &lt;HV3 packets&gt; &lt;u-law log&gt; &lt;A-law log&gt; &lt;CVSD&gt;
&lt;Paging scheme&gt; &lt;Power control&gt; &lt;Transparent SCO data&gt;
Max. ACL packet size: 192 bytes
Number of ACL packets: 8
Max. SCO packet size: 64 bytes
Number of SCO packets: 8</code></pre></div></div></div><div class=sect2><h3 id=_host_controller_interface_hci>31.4.3. Host Controller Interface (HCI)<a class=anchor href=#_host_controller_interface_hci></a></h3><div class=paragraph><p>Het Host Controller Interface (HCI) biedt een opdrachtinterface naar de controller van de basisband en de verbindingsbeheerder, en toegang tot hardwarestatus en controleregisters. Deze interface biedt een uniforme manier om de mogelijkheden van de basisband van Bluetooth te benaderen. De HCI-laag op de gastheer wisselt gegevens en opdrachten uit met de HCI-firmware in de Bluetooth-hardware. Het stuurprogramma voor de Host Controller Transport Layer (i.e., de fysieke bus) biedt aan beide HCI-lagen de mogelijkheid om informatie met elkaar uit te wisselen.</p></div><div class=paragraph><p>Voor een enkel Bluetooth-apparaat wordt een enkele Netgraph knoop van het type <em>hci</em> aangemaakt. De HCI-knoop is normaliter verbonden met de knoop van het Bluetooth-apparaatstuurprogramma (naar beneden toe) en de L2CAP-knoop (naar boven toe). Alle HCI-bewerkingen dienen te worden uitgevoerd op de HCI-knoop en niet op de knoop van het apparaatstuurprogramma. De standaardnaam voor de HCI-knoop is "devicehci". Kijk voor meer details in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_hci&amp;sektion=4&amp;format=html">ng_hci(4)</a>.</p></div><div class=paragraph><p>Eén van de meest voorkomende taken is het ontdekken van Bluetooth-apparaten binnen radiobereik. Deze bewerking wordt <em>ondervragen</em> genoemd. Ondervragen en andere HCI-gerelateerde bewerkingen worden uitgevoerd met het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=hccontrol&amp;sektion=8&amp;format=html">hccontrol(8)</a>. Het onderstaande voorbeeld laat zien hoe kan worden uitgezocht welke Bluetooth-apparaten zich binnen het bereik bevinden. De lijst met apparaten zou binnen enkele seconden moeten binnenkomen. Bedenk dat een apparaat op afstand alleen antwoord op de ondervraging zal geven indien het in <em>ontdekbare</em> modus staat.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% hccontrol <span class=nt>-n</span> ubt0hci inquiry
Inquiry result, <span class=nv>num_responses</span><span class=o>=</span>1
Inquiry result <span class=c>#0</span>
       BD_ADDR: 00:80:37:29:19:a4
       Page Scan Rep. Mode: 0x1
       Page Scan Period Mode: 00
       Page Scan Mode: 00
       Class: 52:02:04
       Clock offset: 0x78ef
Inquiry complete. Status: No error <span class=o>[</span>00]</code></pre></div></div><div class=paragraph><p><code>BD_ADDR</code> is een uniek adres van een Bluetooth-apparaat, vergelijkbaar met een MAC-adres van een netwerkkaart. Dit adres is nodig voor verdere communicatie met een apparaat. Het is mogelijk om een menselijk leesbare naam aan een BD_ADDR toe te kennen. Het bestand <span class=filename>/etc/bluetooth/hosts</span> bevat informatie over de bekende Bluetooth-gastheren. Het volgende voorbeeld laat zien hoe de menselijk leesbare naam dat aan het apparaat op afstand was toegekend te verkrijgen is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% hccontrol <span class=nt>-n</span> ubt0hci remote_name_request 00:80:37:29:19:a4
BD_ADDR: 00:80:37:29:19:a4
Name: Pav<span class=s1>&#39;s T39</span></code></pre></div></div><div class=paragraph><p>Tijdens het uitvoeren van een ondervraging op een Bluetooth-apparaat op afstand zal het de computer als "uw.gastheer.naam (ubt0)" vinden. De naam die aan het lokale apparaat is toegekend, kan altijd gewijzigd worden.</p></div><div class=paragraph><p>Het Bluetooth-systeem biedt een punt-naar-punt-verbinding (slechts twee Bluetooth-eenheden betrokken), of een punt-naar-veelpunt-verbinding. Bij een punt-naar-veelpunt-verbinding wordt de verbinding met meerdere Bluetooth-apparaten gedeeld. Het volgende voorbeeld laat zien hoe de lijst met actieve basisbandverbindingen voor het lokale apparaat te verkrijgen is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% hccontrol <span class=nt>-n</span> ubt0hci read_connection_list
Remote BD_ADDR    Handle Type Mode Role Encrypt Pending Queue State
00:80:37:29:19:a4     41  ACL    0 MAST    NONE       0     0 OPEN</code></pre></div></div><div class=paragraph><p>Een <em>verbindingshandvat</em> is nuttig indien het beëindigen van de basisbandverbinding noodzakelijk is. Normaalgesproken is het niet nodig om dit handmatig te doen. De stack zal automatisch niet-actieve basisbandverbindingen beëindigen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hccontrol -n ubt0hci disconnect 41</span>
Connection handle: 41
Reason: Connection terminated by <span class=nb>local </span>host <span class=o>[</span>0x16]</code></pre></div></div><div class=paragraph><p>Raadpleeg <code>hccontrol help</code> voor een volledige lijst van beschikbare HCI-opdrachten. Voor de meeste HCI-opdrachten zijn geen beheerdersrechten nodig.</p></div></div><div class=sect2><h3 id=_logical_link_control_and_adaptation_protocol_l2cap>31.4.4. Logical Link Control and Adaptation Protocol (L2CAP)<a class=anchor href=#_logical_link_control_and_adaptation_protocol_l2cap></a></h3><div class=paragraph><p>Het Logical Link Control and Adaptation Protocol (L2CAP) biedt verbindingsgeoriënteerde en verbindingsloze gegevensdiensten met mogelijkheden om protocollen te multiplexen en mogelijkheden voor segmentatie/herassemblage voor protocollen in hogere lagen. L2CAP staat toe dat protocollen en toepassingen in hogere lagen L2CAP-gegevenspakketten met een maximale lengte van 64 kB te verzenden en ontvangen.</p></div><div class=paragraph><p>L2CAP is op het concept van <em>kanalen</em> gebaseerd. Een kanaal is een logische verbinding bovenop een basisbandverbinding. Elk kanaal is op een veel-op-één manier aan een enkel protocol gebonden. Aan hetzelfde protocol kunnen meerdere kanalen worden gebonden, maar één kanaal kan niet aan meerdere protocollen worden gebonden. Elk L2CAP-pakket dat op een kanaal wordt ontvangen, wordt naar het juiste hogere protocol doorgestuurd. Meerdere kanalen kunnen dezelfde basisbandverbinding delen.</p></div><div class=paragraph><p>Voor elk Bluetooth-apparaat wordt een enkele Netgraph-knoop van het soort <em>l2cap</em> aangemaakt. De L2CAP-knoop is normaalgesproken verbonden met de Bluetooth HCI-knoop (naar beneden toe) en de knopen van de stopcontacten voor Bluetooth (naar boven toe). De standaardnaam voor de L2CAP-knoop is "devicel2cap". Zie voor meer details de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_l2cap&amp;sektion=4&amp;format=html">ng_l2cap(4)</a>.</p></div><div class=paragraph><p>Een nuttig commando is <a href="https://man.freebsd.org/cgi/man.cgi?query=l2ping&amp;sektion=8&amp;format=html">l2ping(8)</a>, dat gebruikt kan worden om andere apparaten te pingen. Sommige Bluetooth-implementaties geven niet alle verzonden gegevens terug, dus is <code>0 bytes</code> normaal in het volgende voorbeeld.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># l2ping -a 00:80:37:29:19:a4</span>
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>0 <span class=nb>time</span><span class=o>=</span>48.633 ms <span class=nv>result</span><span class=o>=</span>0
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>1 <span class=nb>time</span><span class=o>=</span>37.551 ms <span class=nv>result</span><span class=o>=</span>0
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>2 <span class=nb>time</span><span class=o>=</span>28.324 ms <span class=nv>result</span><span class=o>=</span>0
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>3 <span class=nb>time</span><span class=o>=</span>46.150 ms <span class=nv>result</span><span class=o>=</span>0</code></pre></div></div><div class=paragraph><p>Met het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=l2control&amp;sektion=8&amp;format=html">l2control(8)</a> kunnen verschillende bewerkingen op L2CAP-knopen worden uitgevoerd. Dit voorbeeld laat zien hoe de lijst met logische verbindingen (kanalen) en de lijst met basisbandverbindingen voor het lokale apparaat verkregen kunnen worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% l2control <span class=nt>-a</span> 00:02:72:00:d4:1a read_channel_list
L2CAP channels:
Remote BD_ADDR     SCID/ DCID   PSM  IMTU/ OMTU State
00:07:e0:00:0b:ca    66/   64     3   132/  672 OPEN
% l2control <span class=nt>-a</span> 00:02:72:00:d4:1a read_connection_list
L2CAP connections:
Remote BD_ADDR    Handle Flags Pending State
00:07:e0:00:0b:ca     41 O           0 OPEN</code></pre></div></div><div class=paragraph><p>Een ander diagnostisch programma is <a href="https://man.freebsd.org/cgi/man.cgi?query=btsockstat&amp;sektion=1&amp;format=html">btsockstat(1)</a>. Het heeft ongeveer hetzelfde doel als <a href="https://man.freebsd.org/cgi/man.cgi?query=netstat&amp;sektion=1&amp;format=html">netstat(1)</a>, maar dan voor Bluetooth-netwerkgerelateerde gegevensstructuren. Het onderstaande voorbeeld laat dezelfde logische verbinding zien als die van <a href="https://man.freebsd.org/cgi/man.cgi?query=l2control&amp;sektion=8&amp;format=html">l2control(8)</a> hierboven.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% btsockstat
Active L2CAP sockets
PCB      Recv-Q Send-Q Local address/PSM       Foreign address   CID   State
c2afe900      0      0 00:02:72:00:d4:1a/3     00:07:e0:00:0b:ca 66    OPEN
Active RFCOMM sessions
L2PCB    PCB      Flag MTU   Out-Q DLCs State
c2afe900 c2b53380 1    127   0     Yes  OPEN
Active RFCOMM sockets
PCB      Recv-Q Send-Q Local address     Foreign address   Chan DLCI State
c2e8bc80      0    250 00:02:72:00:d4:1a 00:07:e0:00:0b:ca 3    6    OPEN</code></pre></div></div></div><div class=sect2><h3 id=_het_rfcomm_protocol>31.4.5. Het RFCOMM-protocol<a class=anchor href=#_het_rfcomm_protocol></a></h3><div class=paragraph><p>Het RFCOMM-protocol biedt emulatie van seriële poorten over het L2CAP-protocol. Het protocol is gebaseerd op de ETSI-standaard TS 07.10. RFCOMM is een eenvoudig transportprotocol, met aanvullende voorzieningen om de 9 circuits van RS-232- (EIATIA-232-E-) seriële poorten te emuleren. Het RFCOMM-protocol ondersteunt tot 60 gelijktijdige verbindingen (RFCOMM-kanalen) tussen twee Bluetooth-apparaten.</p></div><div class=paragraph><p>Het is de bedoeling van RFCOMM dat in een volledig communicatiepad twee toepassingen op verschillende apparaten draaien (de eindpunten van de communicatie) met daartussen een communicatiesegment. RFCOMM is bedoeld om de toepassingen te beheren die gebruik maken van de seriële poorten van de apparaten waarop ze zijn geïnstalleerd. Het communicatiesegment is een directe Bluetooth-verbinding van het ene apparaat naar het andere.</p></div><div class=paragraph><p>RFCOMM houdt zich alleen bezig met de verbinding tussen twee apparaten bij directe verbindingen, of tussen het apparaat en een modem in het geval van een netwerk. RFCOMM kan andere opstellingen ondersteunen, zoals modules die via draadloze Bluetooth-technologie communiceren aan de ene kant, en een draadinterface aanbieden aan de andere kant.</p></div><div class=paragraph><p>In FreeBSD is het RFCOMM-protocol in de laag van de Bluetooth-stopcontacten geïmplementeerd.</p></div></div><div class=sect2><h3 id=_het_paren_van_apparaten>31.4.6. Het paren van apparaten<a class=anchor href=#_het_paren_van_apparaten></a></h3><div class=paragraph><p>Standaard is Bluetooth-communicatie niet geauthenticeerd en kan elk apparaat met elk ander apparaat praten. Een Bluetooth-apparaat (bijvoorbeeld een mobiele telefoon) kan ervoor kiezen dat voor bepaalde diensten authenticatie nodig is (bijvoorbeeld voor de inbeldienst). Bluetooth-authenticatie geschied normaalgesproken met <em>PIN-codes</em>. Een PIN-code is een ACII-reeks van maximaal 16 tekens lang. De gebruiker dient dezelfde PIN-code op beide apparaten in te voeren. Nadat de gebruiker de PIN-code heeft ingevoerd, zullen beide apparaten een <em>verbindingssleutel</em> aanmaken. Hierna kan de verbindingssleutel òfwel in de apparaten zelf, òfwel in een permanente opslag worden opgeslagen. De volgende keer zullen beide apparaten de van tevoren aangemaakte verbindingssleutel gebruiken. Bovenstaande procedure wordt <em>paren</em> genoemd. Merk op dat indien een apparaat de verbindingssleutel verliest, het paren moet worden herhaald.</p></div><div class=paragraph><p>De daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=hcsecd&amp;sektion=8&amp;format=html">hcsecd(8)</a> is verantwoordelijk voor het behandelen van alle verzoeken voor Bluetooth-authenticatie. Het standaard instellingenbestand is <span class=filename>/etc/bluetooth/hcsecd.conf</span>. Een voorbeeldsectie voor een mobiele telefoon waarvan de PIN-code willekeurig op "1234" is hieronder beschreven:</p></div><div class="literalblock programlisting"><div class=content><pre>device {
	bgaddr	00:80:37:29:19:a4;
	name	&#34;Pav&#39;s T39&#34;;
	key	nokey;
	pin	&#34;1234&#34;;
      }</pre></div></div><div class=paragraph><p>Er is geen limiet voor PIN-codes (behalve de lengte). Voor sommige apparaten (bijvoorbeeld Bluetooth-headsets) kan de PIN-code vast zijn ingebouwd. De schakelaar <code>-d</code> dwingt de daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=hcsecd&amp;sektion=8&amp;format=html">hcsecd(8)</a> om op de voorgrond te blijven, zodat het gemakkelijk is om te zien wat er gebeurt. Stel het andere apparaat in om paarverzoeken te ontvangen en initialiseer de Bluetooth-verbinding naar het andere apparaat. Het apparaat moet zeggen dat het paarverzoek geaccepteerd is en om de PIN-code vragen. Geef dezelfde PIN-code op als in <span class=filename>hcsecd.conf</span>. Nu zijn de PC en het andere apparaat gepaard. Als alternatief kan paren op het andere apparaat worden geïnitialiseerd.</p></div><div class=paragraph><p>De volgende regel kan aan het bestand <span class=filename>/etc/rc.conf</span> worden toegevoegd om hcsecd automatisch met het systeem op te starten:</p></div><div class="literalblock programlisting"><div class=content><pre>hcsecd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het volgende is een voorbeeld van de uitvoer van de daemon hcsecd:</p></div><div class="literalblock programlisting"><div class=content><pre>hcsecd[16484]: Got Link_Key_Request event from &#39;ubt0hci&#39;, remote bdaddr 0:80:37:29:19:a4
hcsecd[16484]: Found matching entry, remote bdaddr 0:80:37:29:19:a4, name &#39;Pav&#39;s T39&#39;, link key doesn&#39;t exist
hcsecd[16484]: Sending Link_Key_Negative_Reply to &#39;ubt0hci&#39; for remote bdaddr 0:80:37:29:19:a4
hcsecd[16484]: Got PIN_Code_Request event from &#39;ubt0hci&#39;, remote bdaddr 0:80:37:29:19:a4
hcsecd[16484]: Found matching entry, remote bdaddr 0:80:37:29:19:a4, name &#39;Pav&#39;s T39&#39;, PIN code exists
hcsecd[16484]: Sending PIN_Code_Reply to &#39;ubt0hci&#39; for remote bdaddr 0:80:37:29:19:a4</pre></div></div></div><div class=sect2><h3 id=_service_discovery_protocol_sdp>31.4.7. Service Discovery Protocol (SDP)<a class=anchor href=#_service_discovery_protocol_sdp></a></h3><div class=paragraph><p>Het Service Discovery Protocol (SDP) biedt voor cliënttoepassingen de mogelijkheid om diensten te ontdekken die door servertoepassingen worden aangeboden alsook de kenmerken van deze diensten. De kenmerken van een dienst omvatten de soort of klasse van de aangeboden dienst en de informatie over het mechanisme of protocol dat nodig is om de dienst te gebruiken.</p></div><div class=paragraph><p>SDP omvat communicatie tussen een SDP-server en een SDP-cliënt. De server houdt een lijst van dienstenregistraties bij die de eigenschappen van de diensten beschrijven die met de server geassocieerd zijn. Elke dienstregistratie bevat informatie over een enkele dienst. Een cliënt kan informatie over een dienstregistratie opvragen die door de SDP-server wordt bijgehouden door een SDP-verzoek in te dienen. Indien de cliënt, of een toepassing die met de cliënt geassocieerd is, besluit om de dienst te gebruiken, moet het een aparte verbinding naar de aanbieder van de dienst openen om de dienst te gebruiken. SDP biedt een mechanisme om diensten en hun attributen te ontdekken, maar het biedt geen mechanisme om die diensten te gebruiken.</p></div><div class=paragraph><p>Normaalgesproken zoekt een SDP-cliënt naar diensten naar aanleiding van enkele gewenste eigenschappen van die diensten. Soms is het echter wenselijk om te ontdekken welke soorten diensten door de dienstregistraties van een SDP-server worden beschreven zonder enige voorkennis van deze diensten. Dit kijken naar alle aangeboden diensten wordt <em>browsen</em> genoemd.</p></div><div class=paragraph><p>De Bluetooth SDP-server <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a> en de opdrachtregelcliënt <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpcontrol&amp;sektion=8&amp;format=html">sdpcontrol(8)</a> zitten in de standaard FreeBSD-installatie. Het volgende voorbeeld laat zien hoe een SDP-browse query uit te voeren.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sdpcontrol <span class=nt>-a</span> 00:01:03:fc:6e:ec browse
Record Handle: 00000000
Service Class ID List:
        Service Discovery Server <span class=o>(</span>0x1000<span class=o>)</span>
Protocol Descriptor List:
        L2CAP <span class=o>(</span>0x0100<span class=o>)</span>
                Protocol specific parameter <span class=c>#1: u/int/uuid16 1</span>
                Protocol specific parameter <span class=c>#2: u/int/uuid16 1</span>

Record Handle: 0x00000001
Service Class ID List:
        Browse Group Descriptor <span class=o>(</span>0x1001<span class=o>)</span>

Record Handle: 0x00000002
Service Class ID List:
        LAN Access Using PPP <span class=o>(</span>0x1102<span class=o>)</span>
Protocol Descriptor List:
        L2CAP <span class=o>(</span>0x0100<span class=o>)</span>
        RFCOMM <span class=o>(</span>0x0003<span class=o>)</span>
                Protocol specific parameter <span class=c>#1: u/int8/bool 1</span>
Bluetooth Profile Descriptor List:
        LAN Access Using PPP <span class=o>(</span>0x1102<span class=o>)</span> ver. 1.0</code></pre></div></div><div class="olist lowerroman"><ol class=lowerroman type=i><li><p>enzovoorts. Merk op dat elke dienst een lijst met attributen heeft (bijvoorbeeld een RFCOMM-kanaal). Afhankelijk van de dienst kan het nodig zijn om een aantekening van sommige attributen te maken. Sommige Bluetooth-implementaties ondersteunen dienst-browsen niet en zullen een lege lijst teruggeven. In dit geval is het mogelijk om naar de specifieke dienst te zoeken. Het onderstaande voorbeeld laat zien hoe naar de dienst OBEX Object Push (OPUSH) gezocht kan worden:</p></li></ol></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sdpcontrol <span class=nt>-a</span> 00:01:03:fc:6e:ec search OPUSH</code></pre></div></div><div class=paragraph><p>Het aanbieden van diensten op FreeBSD aan Bluetooth-cliënten wordt gedaan met de server <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a>. De volgende regel kan aan het bestand <span class=filename>/etc/rc.conf</span> worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>sdpd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het daemon sdpd kan worden gestart met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sdpd start</span></code></pre></div></div><div class=paragraph><p>De plaatselijke servertoepassing die Bluetooth-diensten wil aanbieden aan verre cliënten zal de dienst registreren bij de plaatselijke SDP-daemon. Een voorbeeld van zo’n toepassing is <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a>. Nadat het gestart is zal het de Bluetooth LAN-dienst bij de plaatselijke SDP-daemon registreren.</p></div><div class=paragraph><p>De lijst met diensten die bij de plaatselijke SDP-server zijn geregistreerd kan worden opgevraagd door te SDP-browsen via het plaatselijke controlekanaal:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sdpcontrol -l browse</span></code></pre></div></div></div><div class=sect2><h3 id=_dial_up_networking_dun_en_netwerktoegang_met_ppp_lan_profielen>31.4.8. Dial-Up Networking (DUN) en netwerktoegang met PPP (LAN) profielen<a class=anchor href=#_dial_up_networking_dun_en_netwerktoegang_met_ppp_lan_profielen></a></h3><div class=paragraph><p>Het inbelnetwerk (DUN) profiel wordt het meeste gebruikt met modems en mobiele telefoons. De volgende scenario’s worden in dit profiel behandeld:</p></div><div class=ulist><ul><li><p>het gebruik van een mobiele telefoon of modem door een computer als een draadloze modem voor het verbinden met een inbelserver voor Internet-toegang, of voor andere inbeldiensten;</p></li><li><p>het gebruik van een mobiele telefoon of modem door een computer om gegevensoproepen te ontvangen.</p></li></ul></div><div class=paragraph><p>Het profiel voor netwerktoegang met PPP (LAN) kan in de volgende situaties gebruikt worden:</p></div><div class=ulist><ul><li><p>LAN-toegang voor een enkel Bluetooth-apparaat;</p></li><li><p>LAN-toegang voor meerdere Bluetooth-apparaten;</p></li><li><p>PC naar PC (door PPP-netwerken over een seriële kabel te emuleren).</p></li></ul></div><div class=paragraph><p>Op FreeBSD zijn beide profielen geïmplementeerd met <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> - een wrapper die een RFCOMM Bluetooth-verbinding omzet in iets waar PPP mee overweg kan. Voordat een profiel gebruikt kan worden, dient een nieuw PPP-label in het bestand <span class=filename>/etc/ppp/ppp.conf</span> te worden aangemaakt. Raadpleeg de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> voor voorbeelden.</p></div><div class=paragraph><p>In het volgende voorbeeld zal <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> gebruikt worden om RFCOMM-verbinding met een ver apparaat met BD_ADDR 00:80:37:29:19:a4 op een DUN RFCOMM-kanaal te maken. Het eigenlijke RFCOMM-kanaalnummer wordt via SDP van het verre apparaat verkregen. Het is mogelijk om het RFCOMM-kanaal handmatig op te geven, en in dat geval zal <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> het SDP-verzoek niet uitvoeren. Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpcontrol&amp;sektion=8&amp;format=html">sdpcontrol(8)</a> om het RFCOMM-kanaal op het verre apparaat te achterhalen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rfcomm_pppd -a 00:80:37:29:19:a4 -c -C dun -l rfcomm-dialup</span></code></pre></div></div><div class=paragraph><p>Om netwerktoegang met PPP (LAN) aan te bieden moet de server <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a> draaien. Er dient een nieuwe regel voor LAN-cliënten in het bestand <span class=filename>/etc/ppp/ppp.conf</span> aangemaakt te worden. Raadpleeg de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> voor voorbeelden. Tenslotte dient de RFCOMM PPP-server op een geldig RFCOMM-kanaal gestart te worden. De RFCOMM PPP-server zal automatisch de Bluetooth LAN-dienst bij de plaatselijke SDP-daemon registreren. Het volgende voorbeeld laat zien hoe een RFCOMM PPP-server te starten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rfcomm_pppd -s -C 7 -l rfcomm-server</span></code></pre></div></div></div><div class=sect2><h3 id=_het_obex_object_push_opush_profiel>31.4.9. Het OBEX Object Push (OPUSH) profiel<a class=anchor href=#_het_obex_object_push_opush_profiel></a></h3><div class=paragraph><p>OBEX is een veelgebruikt protocol voor eenvoudige bestandsoverdrachten tussen mobiele apparaten. Het primaire gebruik is infraroodcommunicatie, waar het wordt gebruikt voor generieke bestandsoverdrachten tussen notebooks of PDA’s, en om visitekaarten en kalenderregels tussen mobiele telefoons en andere apparaten met PIM-toepassingen over te dragen.</p></div><div class=paragraph><p>De OBEX-server en clieënt zijn geïmplenteerd als een pakket van derde partij, obexapp, dat beschikbaar is als de port <a class=package href=https://cgit.freebsd.org/ports/tree/comms/obexapp/>comms/obexapp</a>.</p></div><div class=paragraph><p>De OBEX-cliënt wordt gebruikt om objecten naar en/of van de OBEX-server te duwen/trekken. Een object kan bijvoorbeeld een visitekaart of een afspraak zijn. De OBEX-cliënt kan het RFCOMM-kanaalnummer van het verre apparaat via SDP opvragen. Dit kan gedaan worden door de dienstnaam in plaats van het RFCOMM-kanaalnummer op te geven. De ondersteunde dienstnamen zijn: IrMC, FTRN, en OPUSH. Het is mogelijk om het RFCOMM-kanaal als een nummer op te geven. Het onderstaande is een voorbeeld van een OBEX-sessie, waar een apparaatinformatie-object van de mobiele telefoon wordt getrokken, en een nieuw object (een visitekaart) in de gids van de telefoon wordt geduwd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% obexapp <span class=nt>-a</span> 00:80:37:29:19:a4 <span class=nt>-C</span> IrMC
obex&gt; get telecom/devinfo.txt devinfo-t39.txt
Success, response: OK, Success <span class=o>(</span>0x20<span class=o>)</span>
obex&gt; put new.vcf
Success, response: OK, Success <span class=o>(</span>0x20<span class=o>)</span>
obex&gt; di
Success, response: OK, Success <span class=o>(</span>0x20<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Om de dienst OBEX Object Push aan te bieden, moet de server <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a> draaien. Er moet een hoofdmap worden aangemaakt waarin alle binnenkomende objecten worden opgeslagen. Het standaardpad naar de hoofdmap is <span class=filename>/var/spool/obex</span>. Tenslotte moet de OBEX-server op een geldig RFCOMM-kanaal worden gestart. De OBEX-server zal automatisch de dienst OBEX Object Push bij de plaatselijke SDP-daemon registeren. Het onderstaande voorbeeld laat zien hoe de OBEX-server gestart wordt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># obexapp -s -C 10</span></code></pre></div></div></div><div class=sect2><h3 id=_serial_port_profile_spp>31.4.10. Serial Port Profile (SPP)<a class=anchor href=#_serial_port_profile_spp></a></h3><div class=paragraph><p>Het Seriële Poort Profiel (SPP) zorgt ervoor dat Bluetooth-apparaten RS232 (of gelijkwaardige) seriële kabels kunnen emuleren. Het scenario dat dit profiel behandelt zorgt ervoor dat oude toepassingen Bluetooth kunnen gebruiken als vervanging van kabels, door gebruik te maken van een virtuele seriële poort.</p></div><div class=paragraph><p>Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_sppd&amp;sektion=1&amp;format=html">rfcomm_sppd(1)</a> implementeert het Seriële Poort profiel. Een pseudo-tty wordt gebruikt als abstractie voor een virtuele seriële poort. Onderstaand voorbeeld laat zien hoe met een Seriële Poortdienst voor verre apparaten te verbinden. Merk op dat het niet nodig is om een RFCOMM-kanaal te kiezen - <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_sppd&amp;sektion=1&amp;format=html">rfcomm_sppd(1)</a> kan het via SDP van het verre apparaat verkrijgen. Dit kan worden overruled door een RFCOMM-kanaal op de opdrachtregel te specificeren.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rfcomm_sppd -a 00:07:E0:00:0B:CA -t /dev/ttyp6</span>
rfcomm_sppd[94692]: Starting on /dev/ttyp6...</code></pre></div></div><div class=paragraph><p>Als er een verbinding is, kan de pseudo-tty als seriële poort worden gebruikt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -l ttyp6</span></code></pre></div></div></div><div class=sect2><h3 id=_problemen_oplossen>31.4.11. Problemen oplossen<a class=anchor href=#_problemen_oplossen></a></h3><div class=sect3><h4 id=_een_apparaat_op_afstand_kan_geen_verbinding_maken>31.4.11.1. Een apparaat op afstand kan geen verbinding maken<a class=anchor href=#_een_apparaat_op_afstand_kan_geen_verbinding_maken></a></h4><div class=paragraph><p>Sommige oudere Bluetooth-apparaten ondersteunen het wisselen van rol niet. Standaard probeert FreeBSD, wanneer het een nieuwe verbinding accepteert, een rolwisseling uit te voeren en meester te worden. Apparaten die dit niet ondersteunen zullen niet kunnen verbinden. Merk op dat van rol wordt gewisseld wanneer een nieuwe verbinding wordt gemaakt, dus het is niet mogelijk om het verre apparaat te vragen of het rolwisseling ondersteunt. Er is een HCI-optie om rolwisselen aan de plaatselijke kant uit te zetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hccontrol -n ubt0hci write_node_role_switch 0</span></code></pre></div></div></div><div class=sect3><h4 id=_er_gaat_iets_mis_kan_ik_precies_zien_wat_er_gebeurt>31.4.11.2. Er gaat iets mis, kan ik precies zien wat er gebeurt?<a class=anchor href=#_er_gaat_iets_mis_kan_ik_precies_zien_wat_er_gebeurt></a></h4><div class=paragraph><p>Ja, dit is mogelijk. Gebruik het pakket hcidump, dat beschikbaar is als de port <a class=package href=https://cgit.freebsd.org/ports/tree/comms/hcidump/>comms/hcidump</a>. Het gereedschap hcidump is vergelijkbaar met <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a>. Het kan gebruikt worden om de inhoud van Bluetooth-pakketten op de terminal te laten zien en om de Bluetooth-pakketten naar een bestand te schrijven.</p></div></div></div></div></div><div class=sect1><h2 id=network-bridging>31.5. Bridging<a class=anchor href=#network-bridging></a></h2><div class=sectionbody><div class=sect2><h3 id=_introductie_2>31.5.1. Introductie<a class=anchor href=#_introductie_2></a></h3><div class=paragraph><p>Soms is het handig om één fysiek netwerk (zoals een Ethernet-segment) in twee gescheiden netwerksegmenten te verdelen zonder de noodzaak om een IP-subnet aan te maken en een router te gebruiken om de segmenten met elkaar te verbinden. Een apparaat dat twee netwerken op deze manier met elkaar verbindt wordt een "bridge (brug)" genoemd. Een FreeBSD-systeem met twee netwerkkaarten kan als bridge dienen.</p></div><div class=paragraph><p>De bridge werkt door de adressen van de MAC-laag (Ethernetadressen) van de apparaten op elke netwerkinterface te leren. Het stuurt alleen verkeer tussen twee netwerken door indien de bron en het doel zich op verschillende netwerken bevinden.</p></div><div class=paragraph><p>In vele opzichten is een bridge als een Ethernet-switch met erg weinig poorten.</p></div></div><div class=sect2><h3 id=_situaties_waarin_bridging_juist_is>31.5.2. Situaties waarin bridging juist is<a class=anchor href=#_situaties_waarin_bridging_juist_is></a></h3><div class=paragraph><p>Er zijn vandaag de dag veel situaties waarin een bridge gebruikt wordt.</p></div><div class=sect3><h4 id=_netwerken_verbinden>31.5.2.1. Netwerken verbinden<a class=anchor href=#_netwerken_verbinden></a></h4><div class=paragraph><p>Het basisgebruik van een bridge is het met elkaar verbinden van twee of meer netwerksegmenten. Er zijn vele redenen om een hostgebaseerde bridge te gebruiken in plaats van simpele netwerkapparaten zoals kabelbeperkingen, firewalling of het verbinden van pseudonetwerken zoals een interface van een virtuële machine. Een bridge kan ook een draadloze interface die in hostap-modus draait met een bedraad netwerk verbinden en als een toegangspunt dienen.</p></div></div><div class=sect3><h4 id=_filteringbandbreedtebeheersende_firewall>31.5.2.2. Filtering/Bandbreedtebeheersende firewall<a class=anchor href=#_filteringbandbreedtebeheersende_firewall></a></h4><div class=paragraph><p>Een gebruikelijke situatie dient zich voor wanneer de functionaliteit van een firewall nodig is zonder routing of network address translation (NAT).</p></div><div class=paragraph><p>Een voorbeeld is een klein bedrijf dat via DSL of ISDN met hun internetprovider verbonden is. Dit bedrijf heeft 13 wereldwijd bereikbare IP-adressen van de internetprovider en 10 PC’s op hun netwerk. In deze situatie is een firewall die op een router gebaseerd is lastig wegens subnet-problemen.</p></div><div class=paragraph><p>Een firewall die op een bridge gebaseerd is kan ingesteld en net na de DSL- of ISDN-router geplaatst worden zonder dat er problemen met IP-nummers optreden.</p></div></div><div class=sect3><h4 id=_netwerktap>31.5.2.3. Netwerktap<a class=anchor href=#_netwerktap></a></h4><div class=paragraph><p>Een bridge kan twee netwerksegmenten verbinden en kan gebruikt worden om alle Ethernetframes die tussen dezen voorbijkomen te inspecteren. Dit kan òfwel vanuit het gebruik van <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a>/<a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a> op de bridge-interface òfwel door een kopie van alle frames naar een extra interface (overspanpoort) te versturen.</p></div></div><div class=sect3><h4 id=_laag_2_vpn>31.5.2.4. Laag 2 VPN<a class=anchor href=#_laag_2_vpn></a></h4><div class=paragraph><p>Twee Ethernetnetwerken kunnen over een IP-verbinding verbonden worden door de netwerken naar een EtherIP-tunnel te bridgen of met een oplossing gebaseerd po <a href="https://man.freebsd.org/cgi/man.cgi?query=tap&amp;sektion=4&amp;format=html">tap(4)</a> zoals OpenVPN.</p></div></div><div class=sect3><h4 id=_laag_2_redundancy>31.5.2.5. Laag 2 Redundancy<a class=anchor href=#_laag_2_redundancy></a></h4><div class=paragraph><p>Een netwerk kan met meerdere verbindingen verbonden worden en het Spanning Tree Protocol gebruiken om overbodige paden te blokkeren. Een Ethernetnetwerk kan alleen juist functioneren indien er slechts één actief pad bestaat tussen twee apparaten, Spanning Tree zal lussen detecteren en de overbodige verbindingen in een geblokkeerde toestand zetten. Indien een van de actieve verbindingen faalt zal het protocol een andere boom berekenen en een van de geblokkeerde paden weer activeren om de verbindingen naar alle punten in het netwerk te herstellen.</p></div></div></div><div class=sect2><h3 id=_de_kernel_instellen>31.5.3. De kernel instellen<a class=anchor href=#_de_kernel_instellen></a></h3><div class=paragraph><p>Deze sectie behandelt de bridges geïmplementeerd met <a href="https://man.freebsd.org/cgi/man.cgi?query=if_bridge&amp;sektion=4&amp;format=html">if_bridge(4)</a>, een stuurprogramma dat bridges met netgraph implementeert is ook beschikbaar, zie voor meer informatie de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_bridge&amp;sektion=4&amp;format=html">ng_bridge(4)</a>.</p></div><div class=paragraph><p>Het bridge-stuurprogramma is een kernelmodule en zal automatisch door <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> worden geladen wanneer er een bridge-interface wordt aangemaakt. Het is mogelijk om de bridge in de kernel te compileren door <code>device if_bridge</code> aan het kernelinstellingenbestand toe te voegen.</p></div><div class=paragraph><p>Pakketfiltering kan met elk firewall-pakket worden gebruikt dat via het raamwerk <a href="https://man.freebsd.org/cgi/man.cgi?query=pfil&amp;sektion=9&amp;format=html">pfil(9)</a> aankoppelt. De firewall kan als een module worden geladen of in de kernel worden gecompileerd.</p></div><div class=paragraph><p>De bridge kan als met <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a> als een verkeersregelaar worden gebruikt.</p></div></div><div class=sect2><h3 id=_de_bridge_inschakelen>31.5.4. De bridge inschakelen<a class=anchor href=#_de_bridge_inschakelen></a></h3><div class=paragraph><p>De bridge wordt aangemaakt door interfaces te klonen. Om een bridge aan te maken wordt <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> gebruikt, indien het bridge-stuurprogramma niet in de kernel aanwezig is zal het automatisch worden geladen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge create</span>
<span class=c># ifconfig bridge0</span>
bridge0: <span class=nv>flags</span><span class=o>=</span>8802&lt;BROADCAST,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether 96:3d:4b:f1:79:7a
        <span class=nb>id </span>00:00:00:00:00:00 priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 <span class=nb>timeout </span>1200
        root <span class=nb>id </span>00:00:00:00:00:00 priority 0 ifcost 0 port 0</code></pre></div></div><div class=paragraph><p>Een bridge-interface is aangemaakt en er is automatisch een random gegenereerd Ethernetadres aan toegekend. De parameters <code>maxaddr</code> en <code>timeout</code> bepalen hoeveel MAC-adressen de bridge in de doorstuurtabel houdt en hoeveel seconden voordat elke regel wordt verwijderd nadat het voor het laatst gezien is. De andere parameters bepalen hoe Spanning Tree werkt.</p></div><div class=paragraph><p>Voeg de netwerkinterfaces die lid zijn aan de bridge toe. Om de bridge pakketten te laten doorsturen dienen alle lidinterfaces en de bridge actief te zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 addm fxp0 addm fxp1 up</span>
<span class=c># ifconfig fxp0 up</span>
<span class=c># ifconfig fxp1 up</span></code></pre></div></div><div class=paragraph><p>De bridge stuurt nu Ethernet-frames door tussen <span class=filename>fxp0</span> en <span class=filename>fxp1</span>. De overeenkomstige configuratie in <span class=filename>/etc/rc.conf</span> zodat de bridge tijdens het opstarten wordt aangemaakt is:</p></div><div class="literalblock programlisting"><div class=content><pre>cloned_interfaces=&#34;bridge0&#34;
ifconfig_bridge0=&#34;addm fxp0 addm fxp1 up&#34;
ifconfig_fxp0=&#34;up&#34;
ifconfig_fxp1=&#34;up&#34;</pre></div></div><div class=paragraph><p>Indien de bridge-gastheer een IP-adres nodig heeft dan is de juiste plaats om dit in te stellen op de bridge-interface zelf in plaats van op een van de lidinterfaces. Dit kan statisch of via DHCP worden ingesteld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 inet 192.168.0.1/24</span></code></pre></div></div><div class=paragraph><p>Het is ook mogelijk om een IPv6-adres aan een bridge-interface toe te kennen.</p></div></div><div class=sect2><h3 id=_firewalls_gebruiken>31.5.5. Firewalls gebruiken<a class=anchor href=#_firewalls_gebruiken></a></h3><div class=paragraph><p>Wanneer pakketten worden gefilterd, zullen gebridgede pakketten het filter inbound op de vertrekkende interface passeren, op de bridge-interface en outbound op de bestemde interface. Elke stap kan uitgezet worden. Wanneer de richting van het pakketverkeer belangrijk is, kan de firewall het beste op de lidinterfaces draaien en niet op de bridge zelf.</p></div><div class=paragraph><p>De bridge heeft verschillende aanpasbare instellingen voor het doorlaten van non-IP- en ARP-pakketten, en een laag 2 firewall met IPFW. Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=if_bridge&amp;sektion=4&amp;format=html">if_bridge(4)</a> voor meer informatie.</p></div></div><div class=sect2><h3 id=_opspannende_boom>31.5.6. Opspannende boom<a class=anchor href=#_opspannende_boom></a></h3><div class=paragraph><p>Het bridge-stuurprogramma implementeert het Rapid Spanning Tree Protocol (RSTP of 802.1w) met terugwaartse compatibiliteit met het verouderde Spanning Tree Protocol (STP). Spanning Tree wordt gebruikt om lussen in een netwerktopologie te detecteren en verwijderen. RSTP biedt snellere convergentie naar een opspannende boom dan het verouderde STP, het protocol wisselt informatie met naburige switches uit om snel naar forwarding over te gaan zonder lussen te creëren. FreeBSD ondersteunt RSTP en STP als opties, waarbij RSTP de standaard is.</p></div><div class=paragraph><p>Spanning Tree kan op lidinterfaces worden geactiveerd met het commando <code>stp</code>. Voor een bridge met <span class=filename>fxp0</span> en <span class=filename>fxp1</span> alle huidige interfaces, wordt STP met het volgende geactiveerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 stp fxp0 stp fxp1</span>
bridge0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether d6:cf:d5:a0:94:6d
        <span class=nb>id </span>00:01:02:4b:d4:50 priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 <span class=nb>timeout </span>1200
        root <span class=nb>id </span>00:01:02:4b:d4:50 priority 32768 ifcost 0 port 0
        member: fxp0 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 3 priority 128 path cost 200000 proto rstp
                role designated state forwarding
        member: fxp1 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 4 priority 128 path cost 200000 proto rstp
                role designated state forwarding</code></pre></div></div><div class=paragraph><p>De bridge heeft spanning tree ID <code>00:01:02:4b:d4:50</code> en prioriteit <code>32768</code>. Aangezien het <code>root id</code> hetzelfde is geeft dit aan dat dit de hoofdbridge voor de boom is.</p></div><div class=paragraph><p>Een andere bridge in het netwerk heeft spanning tree ook geactiveerd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>bridge0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether 96:3d:4b:f1:79:7a
        <span class=nb>id </span>00:13:d4:9a:06:7a priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 <span class=nb>timeout </span>1200
        root <span class=nb>id </span>00:01:02:4b:d4:50 priority 32768 ifcost 400000 port 4
        member: fxp0 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 4 priority 128 path cost 200000 proto rstp
                role root state forwarding
        member: fxp1 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 5 priority 128 path cost 200000 proto rstp
                role designated state forwarding</code></pre></div></div><div class=paragraph><p>De reegl <code>root id 00:01:02:4b:d4:50 priority 32768 ifcost 400000 port 4</code> geeft aan dat de hoofdbridge <code>00:01:02:4b:d4:50</code> is zoals boven en dat de padkosten <code>400000</code> zijn vanaf deze bridge, het pad naar de hoofdbridge gaat via <code>port 4</code> welke <span class=filename>fxp0</span> is.</p></div></div><div class=sect2><h3 id=_geavanceerd_bridgen>31.5.7. Geavanceerd bridgen<a class=anchor href=#_geavanceerd_bridgen></a></h3><div class=sect3><h4 id=_verkeersstromen_reconstrueren>31.5.7.1. Verkeersstromen reconstrueren<a class=anchor href=#_verkeersstromen_reconstrueren></a></h4><div class=paragraph><p>De bridge ondersteunt monitormodus, waarin de pakketten worden verwijderd nadat ze door <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> zijn verwerkt, en ze niet verder verwerkt of doorgestuurd worden. Dit kan worden gebruikt om de invoer van twee of meer interfaces naar een enkele <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a>-stroom te multiplexen. Dit is nuttig voor het reconstrueren van het verkeer voor netwerktaps welke de RX/TX-signalen over twee verschillende interfaces uitzenden.</p></div><div class=paragraph><p>Om de invoer van vier netwerkinterfaces als één stroom te lezen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 addm fxp0 addmfxp1 addm fxp2 addm fxp3 monitor up</span>
<span class=c># tcpdump -i bridge0</span></code></pre></div></div></div><div class=sect3><h4 id=_span_poorten>31.5.7.2. SPAN poorten<a class=anchor href=#_span_poorten></a></h4><div class=paragraph><p>Van elk Ethernet-frame dat door de bridge wordt ontvangen wordt er een kopie naar de aangewezen SPAN-poort verstuurd. Het aantal geconfigureerde SPAN-poorten op een bridge is onbeperkt, indien een interface aangewezen is als SPAN-poort kan het niet ook als gewone bridgepoort gebruikt worden. Dit is het nuttigste voor het passief afluisteren van een gebridged netwerk op een andere host die met een van de SPAN-poorten van de bridge verbonden is.</p></div><div class=paragraph><p>Om een kopie van alle frames naar de interface <span class=filename>fxp4</span> te versturen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 span fxp4</span></code></pre></div></div></div><div class=sect3><h4 id=_privé_interfaces>31.5.7.3. Privé-interfaces<a class=anchor href=#_privé_interfaces></a></h4><div class=paragraph><p>Een privé-interface stuurt geen verkeer door naar poorten die niet ook een privé-interface zijn. Het verkeer wordt onvoorwaardelijk geblokkeerd, dus worden er geen Ethernetframes doorgestuurd, inclusief ARP. Indien verkeer selectief dient te worden geblokkeerd dient er in plaats hiervan een firewall gebruikt te worden.</p></div></div><div class=sect3><h4 id=_klevende_interfaces>31.5.7.4. Klevende interfaces<a class=anchor href=#_klevende_interfaces></a></h4><div class=paragraph><p>Indien een lidinterface van een bridge als klevend is gemarkeerd worden dynamisch geleerde adresregels als statisch behandelt wanneer ze in de doorstuurcache komen. Klevende interfaces vallen nooit uit de cache en worden nooit vervangen, zelfs niet als het adres op een andere interface wordt gezien. Dit biedt het voordeel van statische adresregels zonder dat de doorstuurtabel van te voren gevuld hoeft te worden, cliënten die geleerd zijn op een bepaald segment van de bridge kunnen niet roamen naar een ander segment.</p></div><div class=paragraph><p>Een ander voorbeeld voor het gebruik van klevende adressen zou het combineren van de bridge met VLANs zijn om een router te creëren waar klantnetwerken geïsoleerd zijn zonder dat IP-adresruimte verspild wordt. Neem aan dat <code>KlantA</code> op <code>vlan100</code> zit en <code>KlantB</code> op <code>vlan101</code>. De bridge heeft het adres <code>192.168.0.1</code> en is tevens een internet-router.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 addm vlan100 sticky vlan100 addm vlan101 sticky vlan101</span>
<span class=c># ifconfig bridge0 inet 192.168.0.1/24</span></code></pre></div></div><div class=paragraph><p>Beide cliënten zien <code>192.168.0.1</code> als hun standaard gateway en aangezien de bridge-cache kleverig is kunnen ze niet het MAC-adres van de andere klant spoofen om hun verkeer op te vangen.</p></div><div class=paragraph><p>Alle communicatie tussen de VLANs kan geblokkeerd worden door het gebruik van privé-interfaces (of een firewall):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 private vlan100 private vlan101</span></code></pre></div></div><div class=paragraph><p>De klanten zijn compleet geïsoleerd van elkaar, het volledige <code>/24</code> adresruimte kan zonder subnetten toegewezen worden.</p></div></div><div class=sect3><h4 id=_adresbeperkingen>31.5.7.5. Adresbeperkingen<a class=anchor href=#_adresbeperkingen></a></h4><div class=paragraph><p>Het aantal unieke bron-MAC-adressen achter een interface kan beperkt zijn. Wanneer de limiet bereikt is worden pakketten met een onbekend bronadres gedropt totdat een bestaande ingang in de host-cache vervalt of wordt verwijderd.</p></div><div class=paragraph><p>Het volgende voorbeeld stelt het maximum aantal Ethernetapparaten voor <code>KlantA</code> op <code>vlan100</code> in op 10.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 ifmaxaddr vlan100 10</span></code></pre></div></div></div><div class=sect3><h4 id=_snmp_monitoring>31.5.7.6. SNMP-monitoring<a class=anchor href=#_snmp_monitoring></a></h4><div class=paragraph><p>De bridge-interface en STP-parameters kunnen gemonitord worden via het SNMP-daemon dat met het basis FreeBSD-systeem wordt meegeleverd. De geëxporteerde bridge-MIBs houden zich aan de standaarden van de IETF zodat elke SNMP-cliënt of monitorpakket kan worden gebruikt om de gegevens te verzamelen.</p></div><div class=paragraph><p>Op de bridge-machine dient de regel <code>begemotSnmpdModulePath."bridge" = "/usr/lib/snmp_bridge.so"</code> van <span class=filename>/etc/snmp.config</span> geactiveerd te worden en het daemon bsnmpd gestart te worden. Andere instellingen zoals gemeenschapsnamen en toegangslijsten dienen eventueel aangepast te worden. Zie <a href="https://man.freebsd.org/cgi/man.cgi?query=bsnmpd&amp;sektion=1&amp;format=html">bsnmpd(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=snmp_bridge&amp;sektion=3&amp;format=html">snmp_bridge(3)</a> voor meer informatie.</p></div><div class=paragraph><p>Het volgende voorbeeld gebruikt de software Net-SNMP (<a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/net-snmp/>net-mgmt/net-snmp</a> om een bridge te ondervragen, de port <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/bsnmptools/>net-mgmt/bsnmptools</a> kan ook worden gebruikt. Voeg de volgende regels toe aan <span class=filename>$HOME/.snmp/snmp.conf</span> op de SNMP-cliënt-host om de MIB-definities van de bridge in Net-SNMP te importeren:</p></div><div class="literalblock programlisting"><div class=content><pre>mibdirs +/usr/shared/snmp/mibs
mibs +BRIDGE-MIB:RSTP-MIB:BEGEMOT-MIB:BEGEMOT-BRIDGE-MIB</pre></div></div><div class=paragraph><p>Om een enkele bridge via de IETF BRIDGE-MIB (RFC4188) te monitoren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% snmpwalk <span class=nt>-v</span> 2c <span class=nt>-c</span> public bridge1.example.com mib-2.dot1dBridge
BRIDGE-MIB::dot1dBaseBridgeAddress.0 <span class=o>=</span> STRING: 66:fb:9b:6e:5c:44
BRIDGE-MIB::dot1dBaseNumPorts.0 <span class=o>=</span> INTEGER: 1 ports
BRIDGE-MIB::dot1dStpTimeSinceTopologyChange.0 <span class=o>=</span> Timeticks: <span class=o>(</span>189959<span class=o>)</span> 0:31:39.59 centi-seconds
BRIDGE-MIB::dot1dStpTopChanges.0 <span class=o>=</span> Counter32: 2
BRIDGE-MIB::dot1dStpDesignatedRoot.0 <span class=o>=</span> Hex-STRING: 80 00 00 01 02 4B D4 50
...
BRIDGE-MIB::dot1dStpPortState.3 <span class=o>=</span> INTEGER: forwarding<span class=o>(</span>5<span class=o>)</span>
BRIDGE-MIB::dot1dStpPortEnable.3 <span class=o>=</span> INTEGER: enabled<span class=o>(</span>1<span class=o>)</span>
BRIDGE-MIB::dot1dStpPortPathCost.3 <span class=o>=</span> INTEGER: 200000
BRIDGE-MIB::dot1dStpPortDesignatedRoot.3 <span class=o>=</span> Hex-STRING: 80 00 00 01 02 4B D4 50
BRIDGE-MIB::dot1dStpPortDesignatedCost.3 <span class=o>=</span> INTEGER: 0
BRIDGE-MIB::dot1dStpPortDesignatedBridge.3 <span class=o>=</span> Hex-STRING: 80 00 00 01 02 4B D4 50
BRIDGE-MIB::dot1dStpPortDesignatedPort.3 <span class=o>=</span> Hex-STRING: 03 80
BRIDGE-MIB::dot1dStpPortForwardTransitions.3 <span class=o>=</span> Counter32: 1
RSTP-MIB::dot1dStpVersion.0 <span class=o>=</span> INTEGER: rstp<span class=o>(</span>2<span class=o>)</span></code></pre></div></div><div class=paragraph><p>De waarde <code>dot1dStpTopChanges.0</code> is twee wat betekent dat de topologie van de STP-bridge twee maal veranderd is, een topologieverandering houdt in dat één of meerdere links in het netwerk zijn veranderd of hebben gefaald en dat er een nieuwe boom is berekend. De waarde <code>dot1dStpTimeSinceTopologyChange.0</code> laat zien wanneer dit gebeurde.</p></div><div class=paragraph><p>Om meerdere bridge-interfaces te monitoren kan men het privé BEGEMOT-BRIDGE-MIB gebruiken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% snmpwalk <span class=nt>-v</span> 2c <span class=nt>-c</span> public bridge1.example.com
enterprises.fokus.begemot.begemotBridge
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseName.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> STRING: bridge0
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseName.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> STRING: bridge2
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseAddress.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> STRING: e:ce:3b:5a:9e:13
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseAddress.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> STRING: 12:5e:4d:74:d:fc
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseNumPorts.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> INTEGER: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseNumPorts.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> INTEGER: 1
...
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTimeSinceTopologyChange.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> Timeticks: <span class=o>(</span>116927<span class=o>)</span> 0:19:29.27 centi-seconds
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTimeSinceTopologyChange.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> Timeticks: <span class=o>(</span>82773<span class=o>)</span> 0:13:47.73 centi-seconds
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTopChanges.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> Counter32: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTopChanges.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> Counter32: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeStpDesignatedRoot.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> Hex-STRING: 80 00 00 40 95 30 5E 31
BEGEMOT-BRIDGE-MIB::begemotBridgeStpDesignatedRoot.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> Hex-STRING: 80 00 00 50 8B B8 C6 A9</code></pre></div></div><div class=paragraph><p>Om de bridge-interface die via de subboom <code>mib-2.dot1dBridge</code> wordt gemonitord te veranderen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% snmpset <span class=nt>-v</span> 2c <span class=nt>-c</span> private bridge1.example.com
BEGEMOT-BRIDGE-MIB::begemotBridgeDefaultBridgeIf.0 s bridge2</code></pre></div></div></div></div></div></div><div class=sect1><h2 id=network-aggregation>31.6. Verbindingsaggregatie en failover<a class=anchor href=#network-aggregation></a></h2><div class=sectionbody><div class=sect2><h3 id=_introductie_3>31.6.1. Introductie<a class=anchor href=#_introductie_3></a></h3><div class=paragraph><p>De interface <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> maakt het mogelijk om meerdere netwerkinterfaces te aggregeren in één virtueel interface voor het bieden van fout-tolerante en zeer snelle verbindingen.</p></div></div><div class=sect2><h3 id=_werkmodi>31.6.2. Werkmodi<a class=anchor href=#_werkmodi></a></h3><div class=dlist><dl><dt class=hdlist1>Failover</dt><dd><p>Zendt en ontvangt verkeer alleen door de meesterpoort. Wanneer de meesterpoort niet beschikbaar is, wordt de volgende actieve poort gebruikt. De eerste toegevoegde interface is de meesterpoort; alle interfaces die hierna zijn toegevoegd worden gebruikt als failover-apparaten. Als failover naar een niet-meesterpoort plaatsvindt, dan wordt de originele poort de meester wanneer deze weer beschikbaar wordt.</p></dd><dt class=hdlist1>Cisco® Fast EtherChannel®</dt><dd><p>Cisco® Fast EtherChannel® (FEC), is een statische installatie en onderhandelt niet over aggregatie met de peer noch wisselt het frames uit om de verbinding te monitoren. Indien de switch LACP ondersteunt dient dat gebruikt te worden.</p><div class=paragraph><p>FEC balanceert uitgaand verkeer over de actieve poorten gebaseerd op gehashde informatie over protocolheaders en accepteert inkomend verkeer van elke actieve poort. De hash bevat het Ethernet bron- en doeladres, en indien beschikbaar, de VLAN-tag, en de IPv4/IPv6 bron- en doeladressen.</p></div></dd><dt class=hdlist1>LACP</dt><dd><p>Het IEEE® 802.3ad Link Aggregation Control Protocol (LACP) en het Marker Protocol. LACP onderhandelt met de peer over een verzameling aggregeerbare verbindingen in één of meerdere Link Aggregated Groups (LAG). Elke LAG is opgebouwd uit poorten die dezelfde snelheid hebben, ingesteld op full-duplex werking. Het verkeer zal over de poorten in de LAG gebalanceerd worden met de hoogste totaalsnelheid, in de meeste gevallen zal er slechts één LAG zijn die alle poorten bevat. Wanneer er fysieke verbindingen veranderen, zal Link Aggregation snel naar een nieuwe opstelling convergeren.</p><div class=paragraph><p>LACP balanceert uitgaand verkeer over de actieve poorten gebaseerd op gehashde informatie over protocolheaders en accepteert inkomend verkeer van elke actieve poort. De hash bevat het Ethernet bron- en doeladres, en indien beschikbaar, de VLAN-tag, en de IPv4/IPv6 bron- en doeladressen.</p></div></dd><dt class=hdlist1>Loadbalance</dt><dd><p>Dit is een alias van de <em>FEC</em> modus.</p></dd><dt class=hdlist1>Round-Robin</dt><dd><p>Distribueert uitgaand verkeer door middel van een round-robin scheduler over alle actieve poorten en accepteert inkomend verkeer van elke actieve poort. Deze modus schendt Ethernet frame-ordering en dient met zorg gebruikt te worden.</p></dd></dl></div></div><div class=sect2><h3 id=_voorbeelden>31.6.3. Voorbeelden<a class=anchor href=#_voorbeelden></a></h3><div id=networking-lacp-aggregation-cisco class=exampleblock><div class=title>Voorbeeld 1. LACP-aggregatie met een Cisco® switch</div><div class=content><div class=paragraph><p>Dit voorbeeld verbindt twee interfaces op een FreeBSD-machine met de switch als een enkele loadgebalanceerde en fout-tolerante verbinding. Er kunnen meer interfaces worden toegevoegd om de doorvoer en fouttolerantie te verhogen. Aangezien frame-ordering verplicht is op Ethernetverbindingen stroomt al het verkeer tussen twee stations altijd over dezelfde fysieke verbinding zodat de maximum snelheid beperkt wordt tot die van één interface. Het verzendalgoritme probeert zoveel mogelijk informatie te gebruiken voor het onderscheiden van verschillende verkeersstromen en deze over de beschikbare interfaces te balanceren.</p></div><div class=paragraph><p>Voeg op de Cisco® switch de interfaces <em>FastEthernet0/1</em> en <em>FastEthernet0/2</em> aan de kanaalgroep <em>1</em> toe:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>interface FastEthernet0/1
 channel-group 1 mode active
 channel-protocol lacp
<span class=o>!</span>
interface FastEthernet0/2
 channel-group 1 mode active
 channel-protocol lacp</code></pre></div></div><div class=paragraph><p>Maak de <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a>-interface aan met <em>fxp0</em> en <em>fxp1</em> en activeer de interface met IP-adres <em>10.0.0.3/24</em>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig fxp0 up</span>
<span class=c># ifconfig fxp1 up</span>
<span class=c># ifconfig lagg0 create</span>
<span class=c># ifconfig lagg0 up laggproto lacp laggport fxp0 laggport fxp1 10.0.0.3/24</span></code></pre></div></div><div class=paragraph><p>Bekijk de interfacestatus van ifconfig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0</span></code></pre></div></div><div class=paragraph><p>Poorten die als <em>ACTIVE</em> zijn gemarkeerd zijn lid van de actieve aggregatiegroep waarover onderhandeld is met de verre switch en waarover verkeer zal worden verzonden en ontvangen. Gebruik de uitgebreide uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> om de LAG-identifiers te bekijken.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>lagg0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>8&lt;VLAN_MTU&gt;
        ether 00:05:5d:71:8d:b8
        media: Ethernet autoselect
        status: active
        laggproto lacp
        laggport: fxp1 <span class=nv>flags</span><span class=o>=</span>1c&lt;ACTIVE,COLLECTING,DISTRIBUTING&gt;
        laggport: fxp0 <span class=nv>flags</span><span class=o>=</span>1c&lt;ACTIVE,COLLECTING,DISTRIBUTING&gt;</code></pre></div></div><div class=paragraph><p>Gebruik, om de toestand van de poorten op de switch te bekijken, <code>show lacp neighbor</code>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>switch# show lacp neighbor
Flags:  S - Device is requesting Slow LACPDUs
        F - Device is requesting Fast LACPDUs
        A - Device is <span class=k>in </span>Active mode       P - Device is <span class=k>in </span>Passive mode

Channel group 1 neighbors

Partner<span class=s1>&#39;s information:

                  LACP port                        Oper    Port     Port
Port      Flags   Priority  Dev ID         Age     Key     Number   State
Fa0/1     SA      32768     0005.5d71.8db8  29s    0x146   0x3      0x3D
Fa0/2     SA      32768     0005.5d71.8db8  29s    0x146   0x4      0x3D</span></code></pre></div></div><div class=paragraph><p>Gebruik voor meer detail het commando <code>show lacp neighbor detail</code>.</p></div><div class=paragraph><p>Voeg de volgende regels aan <span class=filename>/etc/rc.conf</span> toe om deze informatie na het opnieuw starten te behouden:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;up&#34;
ifconfig_fxp1=&#34;up&#34;
cloned_interfaces=&#34;lagg0&#34;
ifconfig_lagg0=&#34;laggproto lacp laggport fxp0 laggport fxp1 10.0.0.3/24&#34;</pre></div></div></div></div><div id=networking-lagg-failover class=exampleblock><div class=title>Voorbeeld 2. Failover-modus</div><div class=content><div class=paragraph><p>Failover-modus kan worden gebruikt om op een secondaire interface over te schakelen wanneer de verbinding op de meesterinterface verloren is. Activeer de onderliggende fysieke interface. Creëer de interface <code>lagg0</code>, met <em>fxp0</em> als de meesterinterface en <em>fxp1</em> als de secondaire interface en ken er IP-adres <em>10.0.0.15/24</em> aan toe:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig fxp0 up</span>
<span class=c># ifconfig fxp1 up</span>
<span class=c># ifconfig lagg0 create</span>
<span class=c># ifconfig lagg0 up laggproto failover laggport fxp0 laggport fxp1 10.0.0.15/24</span></code></pre></div></div><div class=paragraph><p>De interface zal er ongeveer als volgt uitzien, de grote verschillen zullen het MAC-adres en de apparaatnamen zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0</span>
lagg0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>8&lt;VLAN_MTU&gt;
        ether 00:05:5d:71:8d:b8
        inet 10.0.0.15 netmask 0xffffff00 broadcast 10.0.0.255
        media: Ethernet autoselect
        status: active
        laggproto failover
        laggport: fxp1 <span class=nv>flags</span><span class=o>=</span>0&lt;<span class=o>&gt;</span>
        laggport: fxp0 <span class=nv>flags</span><span class=o>=</span>5&lt;MASTER,ACTIVE&gt;</code></pre></div></div><div class=paragraph><p>Het verkeer zal worden verzonden en ontvangen op <em>fxp0</em>. Indien de verbinding op <em>fxp0</em> verloren is, zal <em>fxp1</em> de actieve verbinding worden. Indien de verbinding op de meesterinterface hersteld is, zal het weer de actieve verbinding worden.</p></div><div class=paragraph><p>Voeg de volgende regels aan <span class=filename>/etc/rc.conf</span> toe om deze informatie na het opnieuw starten te behouden:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;up&#34;
ifconfig_fxp1=&#34;up&#34;
cloned_interfaces=&#34;lagg0&#34;
ifconfig_lagg0=&#34;laggproto lacp laggport fxp0 laggport fxp1 10.0.0.15/24&#34;</pre></div></div></div></div><div id=networking-lagg-wired-and-wireless class=exampleblock><div class=title>Voorbeeld 3. Failover-modus tussen bekabelde en draadloze interfaces</div><div class=content><div class=paragraph><p>Voor laptop-gebruikers is het normaliter wenselijk om het draadloze interface als secundair interface te gebruiken indien het bekabelde interface niet beschikbaar is. Met <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> is het mogelijk om één IP-adres te gebruiken en het bekabelde interface voor zowel prestatie als veiligheid te prefereren terwijl de mogelijkheid behouden blijft om de draadloze verbinding te gebruiken.</p></div><div class=paragraph><p>In deze opstelling dient het MAC-adres van het onderliggende draadloze interface overschreven te worden om met dat van <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> overeen te komen, welke afkomstig is van het primaire interface dat wordt gebruikt, het bekabelde interface.</p></div><div class=paragraph><p>In deze opstelling wordt het bekabelde interface, <em>bge0</em> als meester gebruikt, en het draadloze interface, <em>wlan0</em>, als het failover-interface. <em>wlan0</em> was aangemaakt vanuit <em>iwn0</em> voor welke het MAC-adres van de bekabelde verbinding zal worden gebruikt. De eerste stap is om het MAC-adres van het bekabelde interface te verkrijgen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c>#  ifconfig bge0</span>
bge0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
      <span class=nv>options</span><span class=o>=</span>19b&lt;RXCSUM,TXCSUM,VLAN_MTU,VLAN_HWTAGGING,VLAN_HWCSUM,TSO4&gt;
      ether 00:21:70:da:ae:37
      inet6 fe80::221:70ff:feda:ae37%bge0 prefixlen 64 scopeid 0x2
      nd6 <span class=nv>options</span><span class=o>=</span>29&lt;PERFORMNUD,IFDISABLED,AUTO_LINKLOCAL&gt;
      media: Ethernet autoselect <span class=o>(</span>1000baseT &lt;full-duplex&gt;<span class=o>)</span>
      status: active</code></pre></div></div><div class=paragraph><p><em>bge0</em> kan vervangen worden door het eigenlijke interface, er zal een andere regel met <code>ether</code> verschijnen, dit is het MAC-adres van het bekabelde interface. Om het onderliggende draadloze interface, <em>iwn0</em> te wijzigen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig iwn0 ether 00:21:70:da:ae:37</span></code></pre></div></div><div class=paragraph><p>Activeer het draadloze interface maar geef er nog geen IP-adres aan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev iwn0 ssid mijn_router up</span></code></pre></div></div><div class=paragraph><p>Activeer de interface <em>bge0</em>. Maak het <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a>-interface aan met <em>bge0</em> als meester, en met failover naar <em>wlan0</em> indien nodig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bge0 up</span>
<span class=c># ifconfig lagg0 create</span>
<span class=c># ifconfig lagg0 up laggproto failover laggport bge0 laggport wlan0</span></code></pre></div></div><div class=paragraph><p>Het interface zal er ongeveer als volgt uitzien, de grootste verschillen zullen het MAC-adres en de apparaatnamen zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0</span>
lagg0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
      <span class=nv>options</span><span class=o>=</span>8&lt;VLAN_MTU&gt;
      ether 00:21:70:da:ae:37
      media: Ethernet autoselect
      status: active
      laggproto failover
      laggport: wlan0 <span class=nv>flags</span><span class=o>=</span>0&lt;<span class=o>&gt;</span>
      laggport: bge0 <span class=nv>flags</span><span class=o>=</span>5&lt;MASTER,ACTIVE&gt;</code></pre></div></div><div class=paragraph><p>Start vervolgens de DHCP-cliënt om een IP-adres te verkrijgen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dhclient lagg0</span></code></pre></div></div><div class=paragraph><p>Om deze configuratie bij het opstarten te behouden, kan het volgende aan <span class=filename>/etc/rc.conf</span> worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_bge0=&#34;up&#34;
ifconfig_iwn0=&#34;ether 00:21:70:da:ae:37&#34;
wlans_iwn0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA&#34;
cloned_interfaces=&#34;lagg0&#34;
ifconfig_lagg0=&#34;laggproto failover laggport bge0 laggport wlan0 DHCP&#34;</pre></div></div></div></div></div></div></div><div class=sect1><h2 id=network-diskless>31.7. Schijfloos werken<a class=anchor href=#network-diskless></a></h2><div class=sectionbody><div class=paragraph><p>Een FreeBSD-machine kan over het netwerk opstarten en zonder een plaatselijke schijf werken, door gebruik te maken van bestandssystemen die van een NFS-server aangekoppeld worden. Er zijn geen systeemwijzigingen nodig anders dan de standaard instellingenbestanden. Dit soort systemen is relatief eenvoudig op te zetten omdat alle noodzakelijke elementen al aanwezig zijn:</p></div><div class=ulist><ul><li><p>Er zijn minstens twee manieren om de kernel over het netwerk te laden:</p><div class=ulist><ul><li><p>PXE: De Intel® Preboot eXecution Environment is een vorm een smart boot ROM dat in sommige netwerkkaarten en moederborden is ingebouwd. Bekijk de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> voor meer informatie.</p></li><li><p>De poort Etherboot (<a class=package href=https://cgit.freebsd.org/ports/tree/net/etherboot/>net/etherboot</a>) maakt code aan dat naar een ROM geschreven kan worden en dat kernels over het netwerk opstart. De code kan òfwel naar een opstart-PROM op een netwerkkaart geflashed worden, òfwel van een floppy (of harde) schijf geladen worden, òfwel van een draaiend MS-DOS® systeem geladen worden. Vele netwerkkaarten worden ondersteund.</p></li></ul></div></li><li><p>Een voorbeeldscript (<span class=filename>/usr/shared/examples/diskless/clone_root</span>) vergemakkelijkt het aanmaken en beheren van het root bestandssysteem van het werkstation op de server. Het kan nodig zijn dat het script wat aangepast moet worden, maar het zorgt voor een snelle start.</p></li><li><p>Er bestaan standaardbestanden voor het opstarten van het systeem in <span class=filename>/etc</span> om een systeemstart zonder schijf te detecteren en te ondersteunen.</p></li><li><p>Het gebruik van een wisselbestand, indien nodig, kan worden gedaan naar òfwel een NFS bestand òfwel naar een plaatselijke schijf.</p></li></ul></div><div class=paragraph><p>Er zijn vele manieren om een schijfloos werkstation op te zetten. Hierbij zijn veel elementen betrokken, en vele kunnen aan de eigen smaak worden aangepast. Het volgende beschrijft variaties met betrekking tot het installeren van een compleet systeem, waarbij de nadruk ligt op de eenvoud en de compatibiliteit met de standaard opstartscripts van FreeBSD. Het beschreven systeem heeft de volgende eigenschappen:</p></div><div class=ulist><ul><li><p>De schijfloze werkstations gebruiken een gedeeld bestandssysteem voor <span class=filename>/</span>, dat alleen gelezen kan worden, en een gedeeld bestandssysteem voor <span class=filename>/usr</span>, dat eveneens alleen gelezen kan worden.</p><div class=paragraph><p>Het root-bestandssysteem is een kopie van een standaard root-bestandssysteem voor FreeBSD (typisch van een server), waarbij enkele instellingenbestanden zijn overschreven door versies die specifiek zijn voor een schijfloos systeem of, mogelijk, door het werkstation horen waar ze bij horen.</p></div><div class=paragraph><p>De delen van het root-bestandssysteem die beschrijfbaar moeten zijn, zijn overdekt met <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> bestandssystemen. Alle veranderingen gaan verloren indien het systeem opnieuw wordt opgestart.</p></div></li><li><p>De kernel is overgedragen en òfwel met Etherboot òfwel met PXE geladen, aangezien sommige situaties het gebruik van één van de methodes kan eisen.</p></li></ul></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Het systeem zoals hierboven beschreven is onveilig. Het dient in een beschermd gebied van een netwerk te functioneren, en niet vertrouwd te worden door andere hosts.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Alle informatie in deze sectie is getest met FreeBSD 5.2.1-RELEASE.</p></div><div class=sect2><h3 id=_achtergrondinformatie>31.7.1. Achtergrondinformatie<a class=anchor href=#_achtergrondinformatie></a></h3><div class=paragraph><p>Het installeren van schijfloze werkstations is zowel vrij rechttoe-rechtaan als foutgevoelig. Deze fouten zijn soms moeilijk vast te stellen wegens een aantal redenen. Bijvoorbeeld:</p></div><div class=ulist><ul><li><p>Opties die tijdens het compileren zijn opgegeven kunnen verschillend gedrag tonen tijdens het draaien.</p></li><li><p>Foutmeldingen zijn vaak cryptisch of geheel afwezig.</p></li></ul></div><div class=paragraph><p>Op dit gebied is het bezit van wat achtergrondkennis over de gebruikte mechanismen zeer nuttig om mogelijke problemen op te lossen.</p></div><div class=paragraph><p>Voor een succesvol opstarten dienen verschillende handelingen uitgevoerd te worden:</p></div><div class=ulist><ul><li><p>De machine moet een aantal initiële parameters zoals het IP-adres, de bestandsnaam van de executable, de naam van de server, en het root-pad verkrijgen. Dit wordt gedaan door gebruik te maken van de DHCP of BOOTP protocollen. DHCP is een compatible uitbreiding van BOOTP, het gebruikt dezelfde poorten en het pakketformaat heeft dezelfde basis.</p><div class=paragraph><p>Het is mogelijk om een systeem in te stellen zodat het alleen BOOTP gebruikt. Het serverprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=bootpd&amp;sektion=8&amp;format=html">bootpd(8)</a> wordt met het basissysteem van FreeBSD meegeleverd.</p></div><div class=paragraph><p>DHCP biedt echter een aantal voordelen boven BOOTP (fijnere instellingenbestanden, mogelijkheid om PXE te gebruiken, en vele anderen die niet direct verband houden met schijfloos werken), er zal hoofdzakelijk een opstelling met DHCP worden beschreven, met analoge voorbeelden voor <a href="https://man.freebsd.org/cgi/man.cgi?query=bootpd&amp;sektion=8&amp;format=html">bootpd(8)</a> indien mogelijk. De voorbeeldopstelling zal het softwarepakket van ISC DHCP gebruiken (versie 3.0.1.r12 was geïnstalleerd op de testserver).</p></div></li><li><p>De machine moet één of meerdere programma’s naar het plaatselijke geheugen versturen. Eén van TFTP of NFS wordt gebruikt. De keuze tussen TFTP en NFS is op verschillende plaatsen een optie tijdens het compileren. Een veelgemaakte fout is het opgeven van bestandsnamen voor het verkeerde protocol: TFTP verstuurd typisch alle bestanden vanuit één map op de server, en verwacht dat alle bestandsnamen relatief aan deze map zijn; NFS verwacht absolute bestandspaden.</p></li><li><p>De mogelijke tussentijdse opstartprogramma’s en de kernel dienen geïnitialiseerd en uitgevoerd te worden. Er zijn enkele belangrijke variaties op dit gebied:</p><div class=ulist><ul><li><p>PXE zal <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> laden, wat een aangepaste versie is van de lader voor stage drie van FreeBSD. <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> zal de meeste parameters verkrijgen die noodzakelijk zijn om het systeem op te starten, en zal ze in de kernelomgeving laten staan voordat het de controle overdraagt. Het is in dit geval mogelijk om een <span class=filename>GENERIC</span> kernel te gebruiken.</p></li><li><p>Etherboot zal met minder voorbereiding direct de kernel laden. Hiervoor is het noodzakelijk om een kernel met specifieke opties te bouwen.</p><div class=paragraph><p>PXE en Etherboot werken beide even goed; echter, omdat kernels normaalgesproken meer werk overlaten aan <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a>, is PXE de te verkiezen methode.</p></div><div class=paragraph><p>Indien het BIOS en de netwerkkaarten PXE ondersteunen, dient dat waarschijnlijk gebruikt te worden.</p></div></li></ul></div></li><li><p>Tenslotte: de machine heeft toegang tot de bestandssystemen nodig. NFS wordt in alle gevallen gebruikt.</p></li></ul></div><div class=paragraph><p>Zie ook de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=diskless&amp;sektion=8&amp;format=html">diskless(8)</a>.</p></div></div><div class=sect2><h3 id=_installatie_instructies>31.7.2. Installatie-instructies<a class=anchor href=#_installatie_instructies></a></h3><div class=sect3><h4 id=_instellen_met_behulp_van_isc_dhcp>31.7.2.1. Instellen met behulp van ISC DHCP<a class=anchor href=#_instellen_met_behulp_van_isc_dhcp></a></h4><div class=paragraph><p>De ISC DHCP server kan zowel verzoeken voor BOOTP als DHCP beantwoorden.</p></div><div class=paragraph><p>ISC DHCP 4.2 maakt geen deel uit van het basissysteem. Eerst dient de poort <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-server/>net/isc-dhcp42-server</a> of het corresponderende pakket geïnstalleerd te worden.</p></div><div class=paragraph><p>Wanneer ISC DHCP is geïnstalleerd, heeft het een instellingenbestand nodig om te draaien (normaliter <span class=filename>/usr/local/etc/dhcpd.conf</span> genoemd). Hieronder volgt een voorbeeld met commentaar, waarbij host <code>margaux</code> gebruik maakt van Etherboot en <code>corbieres</code> gebruik maakt van PXE:</p></div><div class="literalblock programlisting"><div class=content><pre>default-lease-time 600;
max-lease-time 7200;
authoritative;

option domain-name &#34;example.com&#34;;
option domain-name-servers 192.168.4.1;
option routers 192.168.4.1;

subnet 192.168.4.0 netmask 255.255.255.0 {
  use-host-decl-names on; <i class=conum data-value=1></i><b>(1)</b>
  option subnet-mask 255.255.255.0;
  option broadcast-address 192.168.4.255;

  host margaux {
    hardware ethernet 01:23:45:67:89:ab;
    fixed-address margaux.example.com;
    next-server 192.168.4.4; <i class=conum data-value=2></i><b>(2)</b>
    filename &#34;/data/misc/kernel.diskless&#34;; <i class=conum data-value=3></i><b>(3)</b>
    option root-path &#34;192.168.4.4:/data/misc/diskless&#34;; <i class=conum data-value=4></i><b>(4)</b>
  }
  host corbieres {
    hardware ethernet 00:02:b3:27:62:df;
    fixed-address corbieres.example.com;
    next-server 192.168.4.4;
    filename &#34;pxeboot&#34;;
    option root-path &#34;192.168.4.4:/data/misc/diskless&#34;;
  }
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Deze optie vertelt dhcpd om de waarde die in de verklaringen voor <code>host</code> staan te versturen als de hostnaam voor de schijfloze host. Een andere mogelijkheid is om <code>option host-name margaux</code> binnen de verklaringen voor <code>host</code> op te nemen.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>De aanwijzing <code>next-server</code> bepaalt de TFTP of NFS server die gebruikt moet worden voor het laden van het lader- of kernelbestand (standaard wordt dezelfde host als voor de DHCP-server gebruikt).</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>De aanwijzing <code>filename</code> bepaalt het bestand dat Etherboot of PXE gebruikt voor de volgende uitvoerstap. Het dient gespecificeerd te worden volgens de gebruikte verzendmethode. Voor Etherboot kan tijdens het compileren worden opgegeven of het NFS of TFTP moet gebruiken. De FreeBSD-poort stelt standaard NFS in. PXE gebruikt TFTP, vandaar dat hier een relatieve bestandsnaam wordt gebruikt (dit kan afhangen van de instellingen van de TFTP-server, maar het is de gewoonte). Verder geldt dat PXE <span class=filename>pxeboot</span> en niet de kernel laadt. Er zijn andere interessante mogelijkheden, zoals het laden van <span class=filename>pxeboot</span> vanuit de map <span class=filename>/boot</span> van een FreeBSD CD-ROM (aangezien <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> de <span class=filename>GENERIC</span> kernel kan laden, bestaat de mogelijkheid om PXE te gebruiken om van een CDROM op afstand op te starten.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>De optie <code>root-path</code> definieert het pad naar het root-bestandssysteem, in de gebruikelijke notatie van NFS. Indien PXE gebruikt wordt, is het mogelijk om het IP-adres van de host weg te laten zolang de kerneloptie BOOTP niet geactiveerd is. De NFS-server is dan dezelfde als die van TFTP.</td></tr></tbody></table></div></div><div class=sect3><h4 id=_configuratie_door_gebruik_van_bootp>31.7.2.2. Configuratie door gebruik van BOOTP<a class=anchor href=#_configuratie_door_gebruik_van_bootp></a></h4><div class=paragraph><p>Hieronder staan de equivalente instellingen voor bootpd (gereduceerd tot één cliënt). Dit staat in <span class=filename>/etc/bootptab</span>.</p></div><div class=paragraph><p>Merk op dat Etherboot gecompileerd dient te worden met de afwijkende optie <code>NO_DHCP_SUPPORT</code> om BOOTP te gebruiken, en dat PXEDHCP <em>nodig heeft</em>. Het enige duidelijke voordeel van bootpd is dat het in het basissysteem zit.</p></div><div class="literalblock programlisting"><div class=content><pre>.def100:\
  :hn:ht=1:sa=192.168.4.4:vm=rfc1048:\
  :sm=255.255.255.0:\
  :ds=192.168.4.1:\
  :gw=192.168.4.1:\
  :hd=&#34;/tftpboot&#34;:\
  :bf=&#34;/kernel.diskless&#34;:\
  :rp=&#34;192.168.4.4:/data/misc/diskless&#34;:

margaux:ha=0123456789ab:tc=.def100</pre></div></div></div><div class=sect3><h4 id=_een_opstartprogramma_voorbereiden_met_etherboot>31.7.2.3. Een opstartprogramma voorbereiden met Etherboot<a class=anchor href=#_een_opstartprogramma_voorbereiden_met_etherboot></a></h4><div class=paragraph><p>De <a href=http://etherboot.sourceforge.net>website van Etherboot</a> bevat <a href=http://etherboot.sourceforge.net/doc/html/userman/t1.html>uitgebreide documentatie</a> die over het algemeen is bedoeld voor Linux-systemen, maar die desalniettemin bruikbare informatie bevat. Het volgende geeft een samenvatting over hoe Etherboot op een FreeBSD-systeem te gebruiken.</p></div><div class=paragraph><p>Ten eerste dient het pakket of de poort <a class=package href=https://cgit.freebsd.org/ports/tree/net/etherboot/>net/etherboot</a> geïnstalleerd te worden.</p></div><div class=paragraph><p>De instellingen van Etherboot (i.e., om TFTP in plaats van NFS te gebruiken) kunnen gewijzigd worden door het bestand <span class=filename>Config</span> in de bronmap van Etherboot te bewerken.</p></div><div class=paragraph><p>Hieronder zal een opstartdiskette gebruikt worden. Raadpleeg voor andere methoden (PROM, of een MS-DOS®-programma) de documentatie van Etherboot.</p></div><div class=paragraph><p>Om een opstartdiskette te maken, dient er een diskette in het diskettestation van de machine aanwezig te zijn waarop Etherboot is geïnstalleerd, daarna dient er naar de map <span class=filename>src</span> in de mapboom van Etherboot gegaan te worden, en het volgende ingetypt te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmake bin32/apparaatsoort.fd0</span></code></pre></div></div><div class=paragraph><p><em>apparaatsoort</em> hangt af van het soort Ethernetkaart dat in het schijfloze werkstation aanwezig is. Raadpleeg het bestand <span class=filename>NIC</span> in dezelfde map om het juiste <em>apparaatsoort</em> te bepalen.</p></div></div><div class=sect3><h4 id=_opstarten_met_pxe>31.7.2.4. Opstarten met PXE<a class=anchor href=#_opstarten_met_pxe></a></h4><div class=paragraph><p>Standaard laadt de lader <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> de kernel via NFS. Het kan zodanig gecompileerd worden dat het TFTP gebruikt door de optie <code>LOADER_TFTP_SUPPORT</code> in <span class=filename>/etc/make.conf</span> te specificeren. Raadpleeg het commentaar in <span class=filename>/usr/shared/examples/etc/make.conf</span> voor instructies.</p></div><div class=paragraph><p>Er zijn nog twee andere opties voor <span class=filename>make.conf</span> die nuttig kunnen zijn bij het opzetten van een schijfloze machine die als seriële console gebruikt wordt: <code>BOOT_PXELDR_PROBE_KEYBOARD</code>, en <code>BOOT_PXELDR_ALWAYS_SERIAL</code>.</p></div><div class=paragraph><p>Om PXE bij het opstarten van de machine te gebruiken, is het gewoonlijk nodig om de optie <code>Boot from network</code> in het BIOS te selecteren, of om een functietoets tijdens de initialisatie van de PC in te typen.</p></div></div><div class=sect3><h4 id=_de_tftp_en_nfs_servers_instellen>31.7.2.5. De TFTP en NFS servers instellen<a class=anchor href=#_de_tftp_en_nfs_servers_instellen></a></h4><div class=paragraph><p>Indien PXE of Etherboot gebruikt wordt, welke is ingesteld om TFTP te gebruiken, is het nodig om tftpd op de bestandsserver aan te zetten:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Maak een map aan van waaruit tftpd de bestanden serveert, bijvoorbeeld <span class=filename>/tftpboot</span>.</p></li><li><p>Voeg deze regel toe aan <span class=filename>/etc/inetd.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>tftp	dgram	udp	wait	root	/usr/libexec/tftpd	tftpd -l -s /tftpboot</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het schijnt dat sommige versies van PXE de TCP-versie van TFTP vereisen. In dit geval dient een tweede regel toegevoegd te worden, waarbij <code>dgram udp</code> door <code>stream tcp</code> vervangen wordt.</p></div></td></tr></tbody></table></div></li><li><p>inetd dient de instellingenbestanden opnieuw te lezen. De regel <code>inetd_enable="YES"</code> dient in het bestand <span class=filename>/etc/rc.conf</span> aanwezig te zijn voor de juiste werking van deze opdracht:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd restart</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>De map <span class=filename>tftpboot</span> kan overal op de server geplaatst worden. De plaats dient zowel in <span class=filename>inetd.conf</span> als in <span class=filename>dhcpd.conf</span> ingesteld te worden.</p></div><div class=paragraph><p>In alle gevallen dient er ook voor gezorgd te worden dat NFS aanstaat en dat het juiste bestandssysteem op de NFS-server geëxporteerd wordt.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Voeg het volgende toe aan <span class=filename>/etc/rc.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>nfs_server_enable=&#34;YES&#34;</pre></div></div></li><li><p>Exporteer het bestandssysteem waar de schijfloze root-map zich bevindt door het volgende aan <span class=filename>/etc/exports</span> toe te voegen (pas het aankoppelpunt van het volume aan en vervang <em>margaux corbieres</em> door de namen van de schijfloze werkstations):</p><div class="literalblock programlisting"><div class=content><pre>/data/misc -alldirs -ro margaux corbieres</pre></div></div></li><li><p>mountd dient het instellingenbestand opnieuw te lezen. Indien het nodig was om NFS in <span class=filename>/etc/rc.conf</span> tijdens de eerste stap aan te zetten, is het waarschijnlijk gewenst om in plaats hiervan opnieuw op te starten.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service mountd restart</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=_een_schijfloze_kernel_bouwen>31.7.2.6. Een schijfloze kernel bouwen<a class=anchor href=#_een_schijfloze_kernel_bouwen></a></h4><div class=paragraph><p>Indien Etherboot gebruikt wordt, is het nodig om een kernelinstellingenbestand voor de schijfloze cliënt met de volgende opties (naast de gebruikelijke) aan te maken:</p></div><div class="literalblock programlisting"><div class=content><pre>options	BOOTP		# Gebruik BOOTP om het IP-adres en de hostnaam te verkrijgen
options	BOOTP_NFSROOT	# NFS-mount het root-bestandssysteem door gebruik te maken van de informatie van BOOTP</pre></div></div><div class=paragraph><p>Het kan ook gewenst zijn om <code>BOOTP_NFSV3</code>, <code>BOOT_COMPAT</code>, en <code>BOOTP_WIRED_TO</code> te gebruiken (raadpleeg hiervoor <span class=filename>NOTES</span>).</p></div><div class=paragraph><p>De namen van deze opties zijn historisch en enigszins misleidend aangezien ze eigenlijk onverschillig gebruik van DHCP en BOOTP in de kernel mogelijk maken (het is ook mogelijk om strikt gebruik van BOOTP of DHCP te forceren).</p></div><div class=paragraph><p>De kernel dient gebouwd te worden (zie <a href=../kernelconfig/#kernelconfig>De FreeBSD-kernel instellen</a>) en gekopieerd te worden naar de plaats die in <span class=filename>dhcpd.conf</span> is aangegeven.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien PXE gebruikt wordt, is het bouwen van een kernel met bovenstaande opties niet strikt noodzakelijk (maar wel aangeraden). Door deze opties aan te zetten zullen er meer verzoeken voor DHCP tijdens het opstarten van de kernel verstuurd worden, met in sommige speciale gevallen een klein risico op inconsistentie tussen de nieuwe waarden en degenen die door <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> zijn ontvangen. Het voordeel van het gebruik van deze opties is dat de hostnaam als een bijverschijnsel wordt ingesteld. In de andere gevallen dient de hostnaam op een andere manier ingesteld te worden, bijvoorbeeld in een cliënt-specifiek bestand <span class=filename>rc.conf</span>.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Om laadbaar te zijn met Etherboot, dienen de apparaataanwijzingen in de kernel gecompileerd te worden. Normaalgesproken wordt hiervoor de volgende optie in het instellingenbestand gebruikt (zie het instellingencommentaarbestand <span class=filename>NOTES</span>):</p></div><div class="literalblock programlisting"><div class=content><pre>hints		&#34;GENERIC.hints&#34;</pre></div></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_het_root_bestandssysteem_voorbereiden>31.7.2.7. Het root-bestandssysteem voorbereiden<a class=anchor href=#_het_root_bestandssysteem_voorbereiden></a></h4><div class=paragraph><p>Er dient een root-bestandssysteem voor de schijfloze werkstations op de plaats die als <code>root-path</code> in <span class=filename>dhcpd.conf</span> staat aangegeven aangemaakt te worden.</p></div><div class=sect4><h5 id=_make_world_gebruiken_om_het_root_bestandssysteem_te_bevolken>31.7.2.7.1. <code>make world</code> gebruiken om het root-bestandssysteem te bevolken<a class=anchor href=#_make_world_gebruiken_om_het_root_bestandssysteem_te_bevolken></a></h5><div class=paragraph><p>Deze methode is snel en installeert een compleet maagdelijk systeem (niet alleen het root-bestandssysteem) in <code>DESTDIR</code>. Hiervoor dient slechts het volgende script uitgevoerd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
export DESTDIR=/data/misc/diskless
mkdir -p ${DESTDIR}
cd /usr/src; make buildworld &amp;&amp; make buildkernel
make installworld &amp;&amp; make installkernel
cd /usr/src/etc; make distribution</pre></div></div><div class=paragraph><p>Nadat dit gedaan is, kunnen <span class=filename>/etc/rc.conf</span> en <span class=filename>/etc/fstab</span> die in <code>DESTDIR</code> geplaatst zijn naar behoefte worden aangepast.</p></div></div></div><div class=sect3><h4 id=_swapruimte_instellen>31.7.2.8. Swapruimte instellen<a class=anchor href=#_swapruimte_instellen></a></h4><div class=paragraph><p>Indien nodig kan een wisselbestand dat zich op de server bevindt via NFS worden benaderd.</p></div><div class=sect4><h5 id=_swapruimte_via_nfs>31.7.2.8.1. Swapruimte via NFS<a class=anchor href=#_swapruimte_via_nfs></a></h5><div class=paragraph><p>De kernel biedt geen ondersteuning om swapruimte via NFS tijdens het opstarten aan te zetten. De swapruimte moet door de opstartscripts worden aangezet, door een beschrijfbaar bestandssysteem aan te koppelen en een wisselbestand aan te maken en aan te zetten. De volgende opdracht maakt een wisselbestand van de juiste grootte aan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/pad/naar/wisselbestand bs=1k count=1 oseek=100000</span></code></pre></div></div><div class=paragraph><p>Om het aan te zetten dient de volgende regel aan <span class=filename>/etc/rc.conf</span> te worden toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>swapfile=/pad/naar/wisselbestand</pre></div></div></div></div><div class=sect3><h4 id=_diverse_problemen>31.7.2.9. Diverse problemen<a class=anchor href=#_diverse_problemen></a></h4><div class=sect4><h5 id=_draaien_met_een_alleen_lezen_usr>31.7.2.9.1. Draaien met een alleen-lezen <span class=filename>/usr</span><a class=anchor href=#_draaien_met_een_alleen_lezen_usr></a></h5><div class=paragraph><p>Indien het schijfloze werkstation is ingesteld om X te draaien, is het nodig om het instellingenbestand van XDM te wijzigen, dat standaard het foutenlogboek in <span class=filename>/usr</span> plaatst.</p></div></div><div class=sect4><h5 id=_gebruik_maken_van_een_niet_freebsd_server>31.7.2.9.2. Gebruik maken van een niet-FreeBSD-server<a class=anchor href=#_gebruik_maken_van_een_niet_freebsd_server></a></h5><div class=paragraph><p>Indien de server voor het root-bestandssysteem geen FreeBSD draait, is het nodig om het root-bestandssysteem op een FreeBSD-machine aan te maken, en het daarna naar de bestemming te kopiëren, door gebruik te maken van <code>tar</code> of <code>cpio</code>.</p></div><div class=paragraph><p>In deze situatie zijn er af en toe problemen met de speciale bestanden in <span class=filename>/dev</span>, vanwege verschillen in de groottes van grote/kleine integers. Een oplossing voor dit probleem is om een map van de niet-FreeBSD-server te exporteren, deze map op een FreeBSD-machine aan te koppelen, en <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> te gebruiken om de apparaatknooppunten transparant voor de gebruiker toe te wijzen.</p></div></div></div></div></div></div><div class=sect1><h2 id=network-pxe-nfs>31.8. Met PXE en een NFS-root-bestandssysteem opstarten<a class=anchor href=#network-pxe-nfs></a></h2><div class=sectionbody><div class=paragraph><p>Het Preboot eXecution Environment (PXE) van Intel® maakt het mogelijk om het besturingssysteem over het netwerk op te starten. Ondersteuning voor PXE wordt normaliter aangeboden in het BIOS van moderne moederborden, waar het kan worden aangezet in de instellingen van het BIOS wat opstarten over het netwerk mogelijk maakt. Een volledig werkende PXE-opstelling vereist ook correct geconfigureerde DHCP- en TFTP-servers.</p></div><div class=paragraph><p>Wanneer de gastheercomputer opstart, krijgt het informatie over DHCP over waar de intiële bootloader staat via TFTP. Nadat de gastheercomputer deze informatie heeft ontvangen, downloadt het de bootloader via TFTP en voert het vervolgens de bootloader uit. Dit is gedocumenteerd in sectie 2.2.1 van de <a href=http://download.intel.com/design/archives/wfm/downloads/pxespec.pdf>Preboot Execution Environment (PXE) Specification</a>. In FreeBSD is de bootloader die tijdens het PXE-proces wordt opgehaald <span class=filename>/boot/pxeboot</span>. Terwijl <span class=filename>/boot/pxeboot</span> wordt uitgevoerd, wordt de kernel van FreeBSD geladen en wordt er verder gegaan met de rest van de opstartprocedure van FreeBSD. Kijk voor meer informatie over het opstartproces van FreeBSD in <a href=../boot/#boot>Het FreeBSD opstartproces</a>.</p></div><div class=sect2><h3 id=_de_chroot_omgeving_voor_het_nfs_root_bestandssysteem_instellen>31.8.1. De <code>chroot</code>-omgeving voor het NFS-root-bestandssysteem instellen<a class=anchor href=#_de_chroot_omgeving_voor_het_nfs_root_bestandssysteem_instellen></a></h3><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Kies een map uit voor een installatie van FreeBSD die over NFS aangekoppeld kan worden. Bijvoorbeeld een map als <span class=filename>/b/tftpboot/FreeBSD/install</span>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># export NFSROOTDIR=/b/tftpboot/FreeBSD/install</span>
<span class=c># mkdir -p ${NFSROOTDIR}</span></code></pre></div></div></li><li><p>Stel de NFS-server in door de instructies in <a href=../network-servers/#network-configuring-nfs>NFS instellen</a> op te volgen.</p></li><li><p>Exporteer de map via NFS door het volgende aan <span class=filename>/etc/exports</span> toe te voegen:</p><div class="literalblock programlisting"><div class=content><pre>/b -ro -alldirs</pre></div></div></li><li><p>Herstart de NFS-server:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service nfsd restart</span></code></pre></div></div></li><li><p>Stel <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> in door de stappen zoals in <a href=../network-servers/#network-inetd-settings>Instellingen</a> beschreven op te volgen.</p></li><li><p>Voeg de volgende regel toe aan <span class=filename>/etc/inetd.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>tftp dgram udp wait root /usr/libexec/tftpd tftpd -l -s /b/tftpboot</pre></div></div></li><li><p>Herstart inetd:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd restart</span></code></pre></div></div></li><li><p><a href=#makeworld>Herbouw de kernel en userland van FreeBSD</a>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make buildworld</span>
<span class=c># make buildkernel</span></code></pre></div></div></li><li><p>Installeer FreeBSD in de map die over NFS is aangekoppeld:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make installworld DESTDIR=${NFSROOTDIR}</span>
<span class=c># make installkernel DESTDIR=${NFSROOTDIR}</span>
<span class=c># make distribution DESTDIR=${NFSROOTDIR}</span></code></pre></div></div></li><li><p>Test dat de TFTP-server werkt en dat het de bootloader dat via PXE verkregen zal worden kan downloaden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tftp localhost</span>
tftp&gt; get FreeBSD/install/boot/pxeboot
Received 264951 bytes <span class=k>in </span>0.1 seconds</code></pre></div></div></li><li><p>Voeg een regel aan <span class=filename>${NFSROOTDIR}/etc/fstab</span> toe om het root-bestandssysteem over NFS aan te koppelen:</p><div class="literalblock programlisting"><div class=content><pre># Device                                            Mountpoint    FSType   Options  Dump Pass
mijnhost.example.com:/b/tftpboot/FreeBSD/install      /         nfs      ro        0    0</pre></div></div><div class=paragraph><p>Vervang <em>mijnhost.example.com</em> door de hostnaam of het IP-adres van uw NFS-server. In dit voorbeeld wordt het root-bestandssysteem als alleen-lezen aangekoppeld om te voorkomen dat NFS-cliënten per ongeluk de inhoud van het root-bestandssysteem wissen.</p></div></li><li><p>Stel het root-wachtwoord in voor de <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a>-omgeving.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chroot ${NFSROOTDIR}</span>
<span class=c># passwd</span></code></pre></div></div><div class=paragraph><p>Dit stelt het root-wachtwoord in voor cliëntmachines die over PXE opstarten.</p></div></li><li><p>Maak root-logins over SSH mogelijk voor cliëntmachines die met PXE opstarten door <span class=filename>${NFSROOTDIR}/etc/ssh/sshd_config</span> te bewerken en de optie <code>PermitRootLogin</code> aan te zetten. Dit is gedocumenteerd in <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd_config&amp;sektion=5&amp;format=html">sshd_config(5)</a>.</p></li><li><p>Pas andere wijzigingen toe aan de <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a>-omgeving in ${NFSROOTDIR}. Deze wijzigingen zouden het toevoegen van pakketten met <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>, het bewerken van het wachtwoordbestand met <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> of het bewerken van <a href="https://man.freebsd.org/cgi/man.cgi?query=amd.conf&amp;sektion=8&amp;format=html">amd.conf(8)</a>-projecties voor automatisch aankoppelen kunnen zijn. Bijvoorbeeld:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chroot ${NFSROOTDIR}</span>
<span class=c># pkg_add -r bash</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect2><h3 id=_geheugenbestandssystemen_die_gebruikt_worden_door_etcrc_initdiskless_configureren>31.8.2. Geheugenbestandssystemen die gebruikt worden door <span class=filename>/etc/rc.initdiskless</span> configureren<a class=anchor href=#_geheugenbestandssystemen_die_gebruikt_worden_door_etcrc_initdiskless_configureren></a></h3><div class=paragraph><p>Als u vanaf een NFS-rootvolume opstart, detecteert <span class=filename>/etc/rc</span> dat u over NFS opstartte en draait het het script <span class=filename>/etc/rc.initdiskless</span>. Lees het commentaar in dit script om te begrijpen wat er gebeurt. Het is nodig om <span class=filename>/etc</span> en <span class=filename>/var</span> geheugen-backed te maken omdat deze mappen schrijfbaar moeten zijn, maar de NFS-rootmap is alleen-lezen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chroot ${NFSROOTDIR}</span>
<span class=c># mkdir -p conf/base</span>
<span class=c># tar -c -v -f conf/base/etc.cpio.gz --format cpio --gzip etc</span>
<span class=c># tar -c -v -f conf/base/var.cpio.gz --format cpio --gzip var</span></code></pre></div></div><div class=paragraph><p>Wanneer het systeem opstart, zullen er geheugen-bestandssystemen voor <span class=filename>/etc</span> en <span class=filename>/var</span> worden aangemaakt en aangekoppeld, en zal de inhoud van de <span class=filename>cpio.gz</span>-bestanden er naartoe worden gekopieerd.</p></div></div><div class=sect2><h3 id=network-pxe-setting-up-dhcp>31.8.3. Een DHCP-server prepareren<a class=anchor href=#network-pxe-setting-up-dhcp></a></h3><div class=paragraph><p>PXE heeft een geprepareerde TFTP-server en DHCP-server nodig. De DHCP-server hoeft niet per së dezelfde machine te zijn als de TFTP-server, maar het dient bereikbaar te zijn in uw netwerk.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Installeer de DHCP-server door de instructies op te volgen zoals beschreven in <a href=../network-servers/#network-dhcp-server>Een DHCP-server installeren en instellen</a>. Zorg ervoor dat <span class=filename>/etc/rc.conf</span> en <span class=filename>/usr/local/etc/dhcpd.conf</span> correct zijn geconfigureerd.</p></li><li><p>Stel in <span class=filename>/usr/local/etc/dhcpd.conf</span><code>next-server</code>, <code>filename</code> en <code>option root-path</code> in om het IP-adres van uw TFTP-server, het pad naar <span class=filename>/boot/pxeboot</span> en het pad naar het NFS-root-bestandssysteem op te geven. Hier is een voorbeeld van de instellingen voor <span class=filename>dhcpd.conf</span>:</p><div class="literalblock programlisting"><div class=content><pre>subnet 192.168.0.0 netmask 255.255.255.0 {
   range 192.168.0.2 192.168.0.3 ;
   option subnet-mask 255.255.255.0 ;
   option routers 192.168.0.1 ;
   option broadcast-address 192.168.0.255 ;
   option domain-name-server 192.168.35.35, 192.168.35.36 ;
   option domain-name &#34;example.com&#34;;

   # IP-adres van TFTP server
   next-server 192.168.0.1 ;

   # pad van bootloader verkregen via TFTP
   filename &#34;FreeBSD/install/boot/pxeboot&#34; ;

   # pxeboot bootloader zal proberen om deze map te NFS-mounten voor root-FS
   option root-path &#34;192.168.0.1:/b/tftpboot/FreeBSD/install/&#34; ;
}</pre></div></div></li></ol></div></div></div></div><div class=sect2><h3 id=_de_pxe_cliënt_configureren_en_verbindingsproblemen_opsporen>31.8.4. De PXE-cliënt configureren en verbindingsproblemen opsporen<a class=anchor href=#_de_pxe_cliënt_configureren_en_verbindingsproblemen_opsporen></a></h3><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Ga naar het BIOS-configuratiemenu wanneer de cliëntmachine opstart. Stel het BIOS zo in dat het van het netwerk opstart. Indien alle vorige configuratiestappen correct zijn, zou alles "gewoon" moeten werken.</p></li><li><p>Gebruik de poort <a class=package href=https://cgit.freebsd.org/ports/tree/net/wireshark/>net/wireshark</a> om netwerkverkeer met betrekking tot het PXE-opstartproces te debuggen, wat geïllustreerd is in onderstaand diagram. In <a href=#network-pxe-setting-up-dhcp>Een DHCP-server prepareren</a> is een voorbeeldconfiguratie gegeven waarbij de DHCP-, TFTP- en NFS-servers op dezelfde machine staan. Deze servers kunnen echter op verschillende machines staan.</p><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/pxe-nfs.png alt="pxe nfs"></div><div class=title>Figuur 1. PXE-opstartproces met NFS-root-mount</div></div></li><li><p>Controleer dat het bestand <span class=filename>pxeboot</span> via TFTP kan worden verkregen. Kijk op uw TFTP-server in <span class=filename>/var/log/xferlog</span> om er zeker van de zijn dat het bestand <span class=filename>pxeboot</span> van de juiste locatie is opgehaald. Om de configuratie met bovenstaande <span class=filename>dhcpd.conf</span> te testen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tftp 192.168.0.1</span>
tftp&gt; get FreeBSD/install/boot/pxeboot
Received 264951 bytes <span class=k>in </span>0.1 seconds</code></pre></div></div><div class=paragraph><p>Lees <a href="https://man.freebsd.org/cgi/man.cgi?query=tftpd&amp;sektion=8&amp;format=html">tftpd(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=tftp&amp;sektion=1&amp;format=html">tftp(1)</a>. De <code>BUGS</code> secties in deze pagina’s documenteren enkele beperkingen van TFTP.</p></div></li><li><p>Controleer dat het root-bestandssysteem via NFS kan worden aangekoppeld. Om de configuratie met bovenstaande <span class=filename>dhcpd.conf</span> te testen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t nfs 192.168.0.1:/b/tftpboot/FreeBSD/install /mnt</span></code></pre></div></div></li><li><p>Lees de code in <span class=filename>src/sys/boot/i386/libi386/pxe.c</span> om te begrijpen hoe de <span class=filename>pxeboot</span>-lader variabelen als <code>boot.nfsroot.server</code> en <code>boot.nfsroot.path</code> instelt. Deze variabelen worden vervolgens gebruikt in de root-aankoppelcode voor diskvrij NFS in <span class=filename>src/sys/nfsclient/nfs_diskless.c</span>.</p></li><li><p>Lees <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a>.</p></li></ol></div></div></div></div></div></div><div class=sect1><h2 id=network-isdn>31.9. ISDN<a class=anchor href=#network-isdn></a></h2><div class=sectionbody><div class=paragraph><p>Een goede bron voor informatie over de technologie van en hardware over ISDN is <a href=http://www.alumni.caltech.edu/~dank/isdn/>Dan Kegel’s ISDN Page</a>.</p></div><div class=paragraph><p>Hieronder staat een snelle eenvoudige handleiding voor ISDN:</p></div><div class=ulist><ul><li><p>Indien u in Europa leeft is het raadzaam om de sectie over ISDN-kaarten te bestuderen.</p></li><li><p>Indien het plan is om ISDN hoofdzakelijk te gebruiken om via een niet-toegewijde inbellijn een verbinding met het Internet te maken, zijn Terminal Adapters wellicht een optie. Dit biedt de meeste flexibiliteit, en de minste problemen bij het wisselen van providers.</p></li><li><p>Indien twee LANs met elkaar verbonden worden, of indien er een toegewijde ISDN-verbinding wordt gebruikt om met het Internet te verbinden, is het gebruik van een zelfstandige router/bridge te overwegen.</p></li></ul></div><div class=paragraph><p>Financiële kosten zijn een belangrijke factor in de uiteindelijke oplossing. De volgende opties zijn gesorteerd in volgorde van oplopende kosten.</p></div><div class=sect2><h3 id=network-isdn-cards>31.9.1. ISDN-kaarten<a class=anchor href=#network-isdn-cards></a></h3><div class=paragraph><p>De ISDN-implementatie in FreeBSD biedt alleen ondersteuning voor de DSS1/Q.931 (of Euro-ISDN) standaard indien passieve kaarten gebruikt worden. Sommige actieve kaarten worden ondersteund indien de firmware ook ondersteuning voor andere signaleringsprotocollen biedt; dit omvat ook de eerst ondersteunde Primary Rate (PRI) ISDN-kaart.</p></div><div class=paragraph><p>De isdn4bsd-software biedt de mogelijkheid om met andere ISDN-routers te verbinden door òfwel IP over rauwe HDLC òfwel synchrone PPP te gebruiken: òfwel via kernel-PPP met <code>isppp</code>, een aangepast stuurprogramma voor <a href="https://man.freebsd.org/cgi/man.cgi?query=sppp&amp;sektion=4&amp;format=html">sppp(4)</a>, òfwel via het gebruikersprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a>. Door het gebruikersprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> te gebruiken, is het combineren van twee of meer ISDN B-kanalen mogelijk. Ook zijn een toepassing die de telefoon beantwoordt en vele gereedschappen zoals een 300 Baud-modem in software beschikbaar.</p></div><div class=paragraph><p>Een groeiend aantal ISDN-kaarten voor de PC wordt door FreeBSD ondersteund en volgens de rapportages wordt het succesvol in heel Europa en in vele andere delen van de wereld gebruikt.</p></div><div class=paragraph><p>De ondersteunde passieve ISDN-kaarten zijn meestal uitgerust met de Infineon (voormalig Siemens) ISAC/HSCX/IPAC ISDN-chipsets, maar ook worden ISDN-kaarten ondersteund met chips van Cologne Chip (alleen ISA-bus), PCI-kaarten met Winbond W6692-chips, enkele kaarten met combinaties van Tiger300/320/ISAC chipsets en enkele kaarten die gebaseerd zijn op fabrikantspecifieke chipsets zoals de AVM Fritz!Card PCI V.1.0 en de AVM Fritz!Card PnP.</p></div><div class=paragraph><p>Momenteel zijn de actieve ISDN-kaarten die ondersteund worden de AVM B1 (ISA en PCI) BRI-kaarten en de AVM T1 PCI PRI-kaarten.</p></div><div class=paragraph><p>Kijk voor documentatie over isdn4bsd op de <a href=http://www.freebsd-support.de/i4b/>homepage van isdn4bsd</a>, welke ook verwijzingen naar tips, errata, en veel meer documentatie zoals het <a href=http://people.FreeBSD.org/~hm/>isdn4bsd handboek</a> bevat.</p></div><div class=paragraph><p>Indien er interesse is om ondersteuning voor een ander ISDN-protocol, een momenteel niet-ondersteunde ISDN-kaart voor de PC, of een andere verbetering voor isdn4bsd toe te voegen, dient er contact opgenomen te worden met Hellmuth Michaelis &lt;<a href=mailto:hm@FreeBSD.org>hm@FreeBSD.org</a>>.</p></div><div class=paragraph><p>Voor vragen over het installeren, instellen, en problemen met isdn4bsd oplossen is er een mailinglijst, <a href=https://lists.FreeBSD.org/subscription/freebsd-isdn>freebsd-isdn</a>, beschikbaar.</p></div></div><div class=sect2><h3 id=_isdn_terminal_adapters>31.9.2. ISDN Terminal Adapters<a class=anchor href=#_isdn_terminal_adapters></a></h3><div class=paragraph><p>Terminal adapters (TA) zijn voor ISDN wat modems voor gewone telefoonlijnen zijn.</p></div><div class=paragraph><p>De meeste TA’s gebruiken de standaard opdrachtenverzameling van de Hayes-modem, en kunnen direct als vervanging van een modem gebruikt worden.</p></div><div class=paragraph><p>Een TA zal als een gewoon modem werken behalve dat de verbindings- en doorvoersnelheden veel hoger zullen zijn dan van het oude modem. Het is noodzakelijk om <a href=../ppp-and-slip/#ppp>PPP</a> precies hetzelfde als voor het modem in te stellen. Zorg ervoor dat de seriële snelheid zo hoog mogelijk wordt ingesteld.</p></div><div class=paragraph><p>Het grootste voordeel van met een TA met een internetprovider te verbinden is de mogelijkheid tot dynamisch PPP. Aangezien IP-adresruimte steeds schaarser wordt, zijn de meeste providers niet meer bereid om een statisch IP te geven. De meeste zelfstandige routers zijn niet in staat tot dynamische IP-toewijzing.</p></div><div class=paragraph><p>TA’s zijn geheel afhankelijk van het PPP-daemon dat gedraaid wordt voor hun mogelijkheden en stabiliteit van de verbinding. Dit maakt het mogelijk om gemakkelijk om op een FreeBSD-machine van een modem naar ISDN over te gaan, indien PPP reeds is ingesteld. Echter, dezelfde problemen die er waren met het PPP-programma zullen blijven voorkomen.</p></div><div class=paragraph><p>Indien maximale stabiliteit gewenst is, dient de kernel <a href=../ppp-and-slip/#ppp>PPP</a>-, niet de <a href=../ppp-and-slip/#userppp>gebruikers-PPP</a>-optie gebruikt te worden.</p></div><div class=paragraph><p>Van de volgende TA’s is bekend dat ze met FreeBSD werken:</p></div><div class=ulist><ul><li><p>Motorola BitSurfer en BitSurfer Pro</p></li><li><p>Adtran</p></li></ul></div><div class=paragraph><p>De meeste andere TA’s zullen waarschijnlijk ook werken, TA-verkopers proberen er zeker van te zijn dat hun product het meeste van de AT-opdrachtverzameling van het standaardmodem accepteert.</p></div><div class=paragraph><p>Het echte probleem met externe TA’s is dat, net zoals bij modems, een goede seriële kaart in de computer nodig is.</p></div><div class=paragraph><p>Voor een goed begrip van seriële apparaten dient de tutorial <a href=https://docs.freebsd.org/en/articles/serial-uart/>FreeBSD Serial Hardware</a> en de verschillen tussen asynchrone en synchrone seriële poorten gelezen te worden.</p></div><div class=paragraph><p>Een TA die op een standaard seriële poort (asynchroon) van een PC draait beperkt de snelheid tot 115.2 Kbps, zelfs als er een 128 Kbps-verbinding beschikbaar is. Om de volledige 128 Kbps waartoe ISDN in staat is te gebruiken, dient de TA op een synchrone seriële kaart overgeplaatst te worden.</p></div><div class=paragraph><p>Het kopen van een interne TA voorkomt het probleem van synchroon/asynchroon niet. Interne TA’s hebben simpelweg een seriële poortchip van een standaard PC ingebouwd. Dit ontlast de gebruiker alleen van het kopen van nog een seriële kabel en het vinden van nog een leeg elektronisch uitbreidingsslot.</p></div><div class=paragraph><p>Een synchrone kaart met een TA is minstens zo snel als een zelfstandige router, en wanneer het door een eenvoudige 386 met FreeBSD erop wordt aangestuurd, waarschijnlijk flexibeler.</p></div><div class=paragraph><p>De keuze tussen synchrone kaart/TA en zelfstandige router is grotendeels religieus. Hierover zijn wat discussies in de mailinglijsten gevoerd. Het wordt aangeraden om de <a href=https://www.FreeBSD.org/search/>archieven</a> te doorzoeken voor de volledige discussie.</p></div></div><div class=sect2><h3 id=_zelfstandige_isdn_bridgesrouters>31.9.3. Zelfstandige ISDN bridges/routers<a class=anchor href=#_zelfstandige_isdn_bridgesrouters></a></h3><div class=paragraph><p>ISDN-bridges of -routers zijn in het geheel niet specifiek voor FreeBSD of enig ander besturingssysteem. Raadpleeg voor een volledigere beschrijving van de technologie van routing en bridging een referentieboek over netwerken.</p></div><div class=paragraph><p>In deze sectie zullen de termen router en bridge door elkaar worden gebruikt.</p></div><div class=paragraph><p>Aangezien de prijzen van eenvoudige ISDN-routers/-bridges zakken, zal dit waarschijnlijk een steeds populairdere keuze worden. Een ISDN-router is en kleine doos die direct in het plaatselijke Ethernetnetwerk geprikt wordt, en zijn eigen verbinding met de andere bridge/router beheert. Het heeft ingebouwde software om via PPP en andere populaire protocollen te communiceren.</p></div><div class=paragraph><p>Een router staat veel snellere doorvoer dan een standaard-TA toe, aangezien het een volledig synchrone ISDN-verbinding zal gebruiken.</p></div><div class=paragraph><p>Het grootste probleem met ISDN-routers en -bridges is dat samenwerking tussen fabrikanten nog steeds een probleem kan zijn. Indien er plannen zijn om met een internetprovider te verbinden, is het raadzaam de wensen met hen te bespreken.</p></div><div class=paragraph><p>Indien er gepland is om twee LAN-segmenten met elkaar te verbinden, zoals het thuis-LAN en het kantoor-LAN, is dit de eenvoudigste en onderhoudarmste oplossing. Aangezien de apparatuur voor beide kanten van de verbinding wordt gekocht is het zeker dat de verbinding zal werken.</p></div><div class=paragraph><p>De volgende installatie kan worden gebruikt om bijvoorbeeld een thuiscomputer of een netwerk van een afdelingskantoor met een netwerk van het hoofdkantoor te verbinden:</p></div><div class=exampleblock><div class=title>Voorbeeld 4. Netwerk van afdelingskantoor of thuis</div><div class=content><div class=paragraph><p>Het netwerk gebruikt een topologie gebaseerd op een bus met een 10 base 2 Ethernet ("thinnet"). Verbind indien nodig de router met de netwerkkabel met een AUI/10BT transceiver.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/isdn-bus.png alt="10 Base 2 Ethernet"></div></div><div class=paragraph><p>Wanneer het thuis-/afdelingskantoornetwerk uit slechts één computer bestaat kan een twisted-pair crossover-kabel gebruikt worden om direct met de zelfstandige router te verbinden.</p></div></div></div><div class=exampleblock><div class=title>Voorbeeld 5. Hoofdkantoor- of ander LAN</div><div class=content><div class=paragraph><p>Het netwerk gebruikt een stertopologie met 10 base T Ethernet ("Twisted Pair").</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/isdn-twisted-pair.png alt="ISDN Netwerkdiagram"></div></div></div></div><div class=paragraph><p>Een groot voordeel van de meeste routers/bridges is dat ze <em>gelijktijdig</em> 2 <em>gescheiden onafhankelijke</em> PPP-verbindingen met 2 gescheiden sites toestaan. Dit wordt door de meeste TA’s niet ondersteund, behalve voor specifieke (gewoonlijk dure) modellen die twee seriële poorten hebben. Dit dient niet met kanaalbinding, MPP, etcetera verward te worden.</p></div><div class=paragraph><p>Dit kan een erg handige eigenschap zijn indien, bijvoorbeeld, er een toegewijde ISDN-verbinding op kantoor is en het gewenst is om deze af te tappen, maar een andere ISDN-lijn op het werk ongewenst is. Een router op kantoor kan een toegewijde B-kanaal verbinding (64 Kbps) met het Internet beheren en het andere B-kanaal voor een gescheiden gegevensverbinding gebruiken. Het tweede B-kanaal kan voor inbellen, uitbellen, of dynamisch binden (MPP, etcetera) gebruikt worden met het eerste B-kanaal voor meer bandbreedte.</p></div><div class=paragraph><p>Een Ethernet-bridge staat ook toe om meer dan alleen IP-verkeer te verzenden. Het is ook mogelijk om IPX/SPX of enig ander protocol te gebruiken.</p></div></div></div></div><div class=sect1><h2 id=network-natd>31.10. Network Address Translation<a class=anchor href=#network-natd></a></h2><div class=sectionbody><div class=sect2><h3 id=network-natoverview>31.10.1. Overzicht<a class=anchor href=#network-natoverview></a></h3><div class=paragraph><p>Het Network Address Translation daemon van FreeBSD, in het algemeen bekend als <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a>, is een daemon dat rauwe binnenkomende IP-pakketten accepteert, de bron naar die van de plaatselijke machine verandert en de pakketten terug in de uitgaande IP-pakketstroom injecteert. <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> doet dit door het IP-adres en de poort van de bron zo te veranderen dat wanneer de gegevens weer ontvangen worden, het in staat is om de originele plaats van de gegevens te achterhalen en ze door te sturen naar de originele aanvrager.</p></div><div class=paragraph><p>NAT wordt het meest gebruikt wat in het algemeen bekend is als het delen van een Internetverbinding.</p></div></div><div class=sect2><h3 id=network-natsetup>31.10.2. Installatie<a class=anchor href=#network-natsetup></a></h3><div class=paragraph><p>Wegens de krimpende IP-ruimte in IPv4, en het groeiend aantal gebruikers van consumentenlijnen op hoge snelheid zoals kabel of DSL, hebben steeds meer mensen een oplossing als het delen van een Internetverbinding nodig. Vanwege de mogelijkheid om meerdere computers online te verbinden door één verbinding en IP-adres is <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> een redelijke keuze.</p></div><div class=paragraph><p>In de meeste gevallen heeft een gebruiker een machine verbonden met een kabel- of DSL-lijn met één IP-adres en is het gewenst om deze ene verbonden computer te gebruiken om Internettoegang aan meerdere computers over een LAN te geven.</p></div><div class=paragraph><p>Hiervoor dient de FreeBSD-machine op het Internet dienst doen als gateway. Deze gateway-machine heeft twee NICs nodig - één voor de verbinding met de Internetrouter, de andere voor de verbinding met het LAN. Alle machines op het LAN zijn verbonden door een hub of switch.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er zijn vele manieren om een LAN via een FreeBSD-gateway met het Internet te verbinden. Dit voorbeeld behandelt slechts een gateway met tenminste twee NICs.</p></div></td></tr></tbody></table></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/natd.png alt=Netwerkschema></div></div><div class=paragraph><p>Dit soort installaties wordt in het algemeen gebruikt om een Internetverbinding te delen. Eén van de LAN-machines is verbonden met het Internet. De rest van de machines hebben internettoegang via die "gateway"-machine.</p></div></div><div class=sect2><h3 id=network-natdloaderconfiguration>31.10.3. Bootloader-configuratie<a class=anchor href=#network-natdloaderconfiguration></a></h3><div class=paragraph><p>De mogelijkheden van de kernel voor network address translation met <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> staan niet aan in <span class=filename>GENERIC</span>, maar ze kunnen worden voorgeladen tijdens het opstarten door enkele opties aan <span class=filename>/boot/loader.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>ipfw_load=&#34;YES&#34;
ipdivert_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ook moet de tunable <code>net.inet.ip.fw.default_to_accept</code> op <code>1</code> worden gezet:</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.default_to_accept=&#34;1&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is een goed idee om deze optie aan te zetten tijdens de eerste pogingen om een firewall en NAT gateway te installeren. Op deze manier zal het standaardbeleid van <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> <code>allow ip from any to any</code> zijn in plaats van het minder vrije <code>deny ip from any to any</code>, en zal het iets moeilijker zijn om buitengesloten te worden net na het opnieuw opstarten van het systeem.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=network-natdkernconfiguration>31.10.4. Kernelconfiguratie<a class=anchor href=#network-natdkernconfiguration></a></h3><div class=paragraph><p>Wanneer modules geen optie zijn of wanneer het gewenst is om alle benodigde mogelijkheden in de draaiende kernel te bouwen, dienen de volgende opties in het kernelinstellingenbestand aanwezig te zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>options IPFIREWALL
options IPDIVERT</pre></div></div><div class=paragraph><p>De volgende opties kunnen ook van pas komen:</p></div><div class="literalblock programlisting"><div class=content><pre>options IPFIREWALL_DEFAULT_TO_ACCEPT
options IPFIREWALL_VERBOSE</pre></div></div></div><div class=sect2><h3 id=network-natdsystemconfiguration>31.10.5. Systeeminstellingen voor het opstarten<a class=anchor href=#network-natdsystemconfiguration></a></h3><div class=paragraph><p>Om de firewall en NAT tijdens het opstarten aan te zetten, moet het volgende in <span class=filename>/etc/rc.conf</span> staan:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34; <i class=conum data-value=1></i><b>(1)</b>
firewall_enable=&#34;YES&#34; <i class=conum data-value=2></i><b>(2)</b>
firewall_type=&#34;OPEN&#34; <i class=conum data-value=3></i><b>(3)</b>
natd_enable=&#34;YES&#34;
natd_interface=&#34;fxp0&#34; <i class=conum data-value=4></i><b>(4)</b>
natd_flags=&#34;&#34; <i class=conum data-value=5></i><b>(5)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Stelt de machine in om dienst te doen als gateway. Het draaien van <code>sysctl net.inet.ip.forwarding=1</code> heeft hetzelfde effect.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Activeert de firewall-regels in <span class=filename>/etc/rc.firewall</span> tijdens het opstarten.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Dit specificeert een vooraf gedefinieerde verzameling van firewall-regels die alles binnenlaat. Raadpleeg <span class=filename>/etc/rc.firewall</span> voor aanvullende types.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Geeft aan welke interface te gebruiken om pakketten naar door te sturen (de interface die met het Internet verbonden is).</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Alle aanvullende instelopties die tijdens het opstarten aan <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> worden doorgegeven.</td></tr></tbody></table></div><div class=paragraph><p>Het gedefinieerd hebben van de bovenstaande opties in <span class=filename>/etc/rc.conf</span> zal <code>natd -interface fxp0</code> draaien tijdens het opstarten. Dit kan ook handmatig worden gedraaid.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is ook mogelijk om een instellingenbestand voor <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> te gebruiken als er teveel opties zijn om door te geven. In dit geval dient het instellingenbestand te worden gedefinieerd door de volgende regel aan <span class=filename>/etc/rc.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>natd_flags=&#34;-f /etc/natd.conf&#34;</pre></div></div><div class=paragraph><p>Het bestand <span class=filename>/etc/natd.conf</span> zal een lijst met instelopties bevatten, één per regel. Het geval in de volgende sectie bijvoorbeeld zal het volgende bestand gebruiken:</p></div><div class="literalblock programlisting"><div class=content><pre>redirect_port tcp 192.168.0.2:6667 6667
redirect_port tcpc 192.168.0.3:80 80</pre></div></div><div class=paragraph><p>Raadpleeg voor meer informatie over het instellingenbestand het gedeelte over de optie <code>-f</code> van de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Elke machine en interface achter het LAN dient een IP-adres in de privé-netwerkruimte toegewezen te krijgen zoals gedefinieerd in <a href=ftp://ftp.isi.edu/in-notes/rfc1918.txt>RFC 1918</a> en een standaard gateway van het interne IP-adres van de natd-machine hebben.</p></div><div class=paragraph><p>Bijvoorbeeld, cliënt <code>A</code> en <code>B</code> achter het LAN hebben IP-adressen <code>192.168.0.2</code> en <code>192.168.0.3</code>, terwijl de LAN-interface van de natd-machine IP-adres <code>192.168.0.1</code> heeft. De standaard gateway van cliënt <code>A</code> en <code>B</code> dient ingesteld te worden op die van de natd-machine, <code>192.168.0.1</code>. Voor de externe, of Internet-interface van de natd-machine zijn geen speciale wijzigingen nodig om <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> te laten werken.</p></div></div><div class=sect2><h3 id=network-natdport-redirection>31.10.6. Poorten omleiden<a class=anchor href=#network-natdport-redirection></a></h3><div class=paragraph><p>Het nadeel van <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> is dat de LAN-cliënten niet vanaf het Internet toegankelijk zijn. Cliënten op het LAN kunnen uitgaande verbinden naar de wereld maken maar kunnen geen inkomende verbindingen ontvangen. Dit vormt een probleem wanneer geprobeerd wordt om Internetdiensten op een van de LAN-cliëntmachines te draaien. Een eenvoudige om dit te omzeilen is om bepaalde Internetpoorten op de natd-machine om te leiden naar een LAN-cliënt.</p></div><div class=paragraph><p>Bijvoorbeeld, er draait een IRC-server op cliënt <code>A</code>, en er draait een webserver op cliënt <code>B</code>. Om dit goed te laten werken, dienen verbindingen die worden ontvangen op poorten 6667 (IRC) en 80 (web) te worden omgeleid naar de respectievelijke machines.</p></div><div class=paragraph><p>De optie <code>-redirect_port</code> dient aan <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> met de juiste opties te worden doorgegeven. De syntaxis is als volgt:</p></div><div class="literalblock programlisting"><div class=content><pre>     -redirect_port proto doelIP:doelPOORT[-doelPOORT]
                 [aliasIP:]aliasPOORT[-aliasPOORT]
                 [verIP[:verrePOORT[-verrePOORT]]]</pre></div></div><div class=paragraph><p>In het bovenstaand voorbeeld dienen de argumenten te zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>     -redirect_port tcp 192.168.0.2:6667 6667
-redirectport tcp 192.168.0.3:80 80</pre></div></div><div class=paragraph><p>Dit zal de juiste <em>tcp</em>-poorten naar de LAN-cliënt-machines omleiden.</p></div><div class=paragraph><p>Het argument <code>-redirect_port</code> kan worden gebruikt om poortbereiken over individuele poorten aan te geven. Bijvoorbeeld, <em>tcp 192.168.0.2:2000-3000 2000-3000</em> zal alle verbindingen die op poorten 2000 tot 3000 worden ontvangen omleiden naar poorten 2000 tot 3000 op cliënt <code>A</code>.</p></div><div class=paragraph><p>Deze opties kunnen worden gebruikt wanneer <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> direct wordt gedraaid, wanneer ze zijn geplaatst in de optie <code>natd_flags=""</code> van <span class=filename>/etc/rc.conf</span>, of wanneer ze via een instellingenbestand worden doorgegeven.</p></div><div class=paragraph><p>Raadpleeg voor meer instelopties <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a>.</p></div></div><div class=sect2><h3 id=network-natdaddress-redirection>31.10.7. Adressen omleiden<a class=anchor href=#network-natdaddress-redirection></a></h3><div class=paragraph><p>Adressen omleiden is handig wanneer er verschillende IP-adressen beschikbaar zijn, maar ze op één machine moeten zitten. Hiermee kan <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> aan elke LAN-cliënt een eigen extern IP-adres toewijzen. Vervolgens overschrijft <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> de uitgaande pakketten van de LAN-cliënten met het juiste IP-adres en leidt het al het binnenkomende verkeer op dat ene IP-adres terug naar de specifieke LAN-cliënt. Dit staat ook bekend als statisch NAT. Bijvoorbeeld, de IP-adressen <code>128.1.1.1</code>, <code>128.1.1.2</code>, en <code>1281.2..3</code> behoren toe aan de natd gateway-machine. <code>128.1.1.1</code> kan gebruikt worden als het externe IP-adres van de natd gateway-machine, terwijl <code>128.1.1.2</code> en <code>128.1.1.3</code> terug worden gestuurd naar de LAN-cliënten <code>A</code> en <code>B</code>.</p></div><div class=paragraph><p>De syntaxis van <code>-redirect_address</code> is als volgt:</p></div><div class="literalblock programlisting"><div class=content><pre>-redirect_address lokaalIP publiekIP</pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>lokaalIP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het interne IP-adres van de LAN-cliënt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>publiekIP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Het externe IP-adres overeenkomend met de LAN-cliënt.</p></td></tr></tbody></table><div class=paragraph><p>In het voorbeeld zou dit argument zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>-redirect_address 192.168.0.2 128.1.1.2
-redirect_address 192.168.0.3 128.1.1.3</pre></div></div><div class=paragraph><p>Net zoals <code>-redirect_port</code> worden ook deze argumenten geplaatst in de optie <code>natd_flags=""</code> van <span class=filename>/etc/rc.conf</span>, of doorgegeven via een instellingenbestand. Met adresomleiding is het omleiden van poorten niet nodig aangezien alle gegevens die op een bepaald IP-adres worden ontvangen worden omgeleidt.</p></div><div class=paragraph><p>Het externe IP-adres op de natd machine dient actief en naar een externe interface gealiased te zijn. In <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> staat hoe dit te doen.</p></div></div></div></div><div class=sect1><h2 id=network-ipv6>31.11. IPv6<a class=anchor href=#network-ipv6></a></h2><div class=sectionbody><div class=paragraph><p>IPv6 (ook bekend als IPng "IP next generation") is de nieuwe versie van het welbekende IP-protocol (ook bekend als IPv4). Net zoals de andere huidige *BSD-systemen, bevat FreeBSD de referentie-implementatie van KAME IPv6. Het FreeBSD-systeem wordt dus geleverd met alles wat nodig is om met IPv6 te experimenteren. Deze sectie richt zich op het ingesteld en draaiend krijgen van IPv6.</p></div><div class=paragraph><p>In de vroege jaren 1990 werden mensen zich bewust van de snel krimpende adresruimte van IPv4. De uitbreidingssnelheid van het Internet baarde twee grote zorgen:</p></div><div class=ulist><ul><li><p>Geen adresruimte meer. Tegenwoordig is dit niet zo’n probleem meer aangezien RFC1918 voor privé-adresruimte (<code>10.0.0.0/8</code>, <code>172.16.0.0/12</code>, en <code>192.168.0.0/16</code>) en Network Address Translation (NAT) worden gebruikt.</p></li><li><p>De regels in de routeertabellen werden te groot. Dit is tegenwoordig nog steeds een probleem.</p></li></ul></div><div class=paragraph><p>IPv6 behandelt deze en vele andere zaken:</p></div><div class=ulist><ul><li><p>128-bits adresruimte. Met andere woorden, er zijn theoretisch 340.282.366.920.938.463.463.374.607.431.768.211.456 adressen beschikbaar. Dit betekent dat er ongeveer 6,67 * 10^27 IPv6-adressen per vierkante meter op onze planeet beschikbaar zijn.</p></li><li><p>Routers zullen alleen netwerkaggregatie-adressen in hun routeertabellen opslaan en dus de gemiddelde ruimte van een routeertabel verkleinen tot 8192 regels.</p></li></ul></div><div class=paragraph><p>IPv6 heeft ook vele andere nuttige eigenschappen zoals:</p></div><div class=ulist><ul><li><p>Automatische adresconfiguratie (<a href=http://www.ietf.org/rfc/rfc2462.txt>RFC2462</a>)</p></li><li><p>Anycast-adressen ("ééen-van-velen")</p></li><li><p>Verplichte multicast-adressen</p></li><li><p>IPsec (IP security)</p></li><li><p>Versimpelde structuur van de headers</p></li><li><p>Mobiele IP</p></li><li><p>Overgangsmechanismen voor IPv6 naar IPv4</p></li></ul></div><div class=paragraph><p>Bekijk voor meer informatie:</p></div><div class=ulist><ul><li><p>IPv6-overzicht op <a href=http://playground.sun.com/pub/ipng/html/ipng-main.html>playground.sun.com</a></p></li><li><p><a href=http://www.kame.net>KAME.net</a></p></li></ul></div><div class=sect2><h3 id=_achtergrond_over_ipv6_adressen>31.11.1. Achtergrond over IPv6 adressen<a class=anchor href=#_achtergrond_over_ipv6_adressen></a></h3><div class=paragraph><p>Er zijn verschillende soorten IPv6-adressen: unicast, anycast, en multicast.</p></div><div class=paragraph><p>Unicast-adressen zijn de bekende adressen. Een pakket dat naar een unicast-adres wordt verzonden arriveert precies op de interface dat bij dat adres hoort.</p></div><div class=paragraph><p>Anycast-adressen zijn syntactisch niet van unicast-adressen te onderscheiden maar ze adresseren een groep interfaces. Een pakket dat bestemd is voor een anycast-adres zal bij de dichtstbijzijnde interface arriveren (in router-metrieken). Anycast-adressen mogen alleen door routers worden gebruikt.</p></div><div class=paragraph><p>Multicast-adressen identificeren een groep interfaces. Een pakket dat bestemd is voor en multicast-adres zal bij alle interfaces die bij de multicast-groep horen arriveren.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het broadcast-adres van IPv4 (gewoonlijk <code>xxx.xxx.xxx.255</code>) wordt in IPv6 met multicast-adressen uitgedrukt.</p></div></td></tr></tbody></table></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 2. Gereserveerde IPv6-adressen</caption><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">IPv6-adres</th><th class="tableblock halign-left valign-top">Prefixlengte (bits)</th><th class="tableblock halign-left valign-top">Beschrijving</th><th class="tableblock halign-left valign-top">Opmerkingen</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>128 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>niet gespecificeerd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>cf. <code>0.0.0.0</code> in IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::1</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>128 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>teruglusadres</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>cf. <code>127.0.0.1</code> in IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::00:xx:xx:xx:xx</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>96 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ingebouwd IPv4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De laagste 32 bits zijn het IPv4-adres. Ook "IPv4 compatibel IPv6-adres" genoemd.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::ff:xx:xx:xx:xx</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>96 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IPv4-afgebeeld IPv6-adres</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De laagste 32 bits zijn het IPv4-adres. Voor hosts die geen IPv6 ondersteunen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fe80::</code> - <code>feb::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>10 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>link-lokaal</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>cf. teruglusadres in IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fec0::</code> - <code>fef::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>10 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>site-lokaal</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ff::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>multicast</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>001</code> (base 2)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3 bits</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>globale unicast</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Alle globale unicast-adressen worden vanuit deze pool toegewezen. De eerste 3 bits zijn "001".</p></td></tr></tbody></table></div><div class=sect2><h3 id=_ipv6_adressen_lezen>31.11.2. IPv6-adressen lezen<a class=anchor href=#_ipv6_adressen_lezen></a></h3><div class=paragraph><p>De canonieke vorm wordt weergegeven als: <code>x:x:x:x:x:x:x:x</code>, waarbij elke "x" een 16-bits hexadecimale waarde is. Bijvoorbeeld <code>FEBC:A574:382B:23C1:AA49:4592:4EFE:9982</code></p></div><div class=paragraph><p>Vaak bevat een adres lange deelstrings van allen nullen, daarom kan per adres één zo’n deelstring worden afgekort als "::". Ook kunnen maximaal drie voorlopende "0"'s per hexadecimaal viertal worden weggelaten. Bijvoorbeeld, <code>fe80::1</code> komt overeen met de canonieke vorm <code>fe80:0000:0000:0000:0000:0000:0000:0001</code>.</p></div><div class=paragraph><p>Een derde vorm is het schrijven van de laatste 32 bits in de bekende (decimale) IPv4-stijl met punten "." als scheidingstekens. Bijvoorbeeld, <code>2002::10.0.0.1</code> komt overeen met de (hexadecimale) canonieke representatie <code>2002:0000:0000:0000:0000:0000:0a00:0001</code> wat weer hetzelfde is als <code>2002::a00:1</code>.</p></div><div class=paragraph><p>Op dit punt dient de lezer het volgende te begrijpen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig</span></code></pre></div></div><div class="literalblock programlisting"><div class=content><pre>rl0: flags=8943&lt;UP,BROADCAST,RUNNING,PROMISC,SIMPLEX,MULTICAST&gt; mtu 1500
        inet 10.0.0.10 netmask 0xffffff00 broadcast 10.0.0.255
        inet6 fe80::200:21ff:fe03:8e1%rl0 prefixlen 64 scopeid 0x1
        ether 00:00:21:03:08:e1
	media: Ethernet autoselect (100baseTX )
        status: active</pre></div></div><div class=paragraph><p><code>fe80::200:21ff:fe03:8e1%rl0</code> is een automatisch ingesteld link-lokaal adres. Het is als deel van de automatische instelling vanuit het MAC-adres aangemaakt.</p></div><div class=paragraph><p>Kijk voor verdere informatie over de structuur van IPv6-adressen op <a href=http://www.ietf.org/rfc/rfc3513.txt>RFC3513</a>.</p></div></div><div class=sect2><h3 id=_verbinding_krijgen>31.11.3. Verbinding krijgen<a class=anchor href=#_verbinding_krijgen></a></h3><div class=paragraph><p>Er zijn momenteel vier manieren om met andere IPv6-hosts en -netwerken te verbinden:</p></div><div class=ulist><ul><li><p>Neem contact op met de Internetprovider om te zien of ze al IPv6 aanbieden.</p></li><li><p><a href=http://www.sixxs.net>SixXS</a> biedt wereldwijd tunnels met eindpunten aan.</p></li><li><p>Tunnelen via 6-naar-4 (<a href=http:///www.ietf.org/rfc/rfc3608.txt>RFC3068</a>)</p></li><li><p>Gebruik de poort <a class=package href=https://cgit.freebsd.org/ports/tree/net/freenet6/>net/freenet6</a> indien er een inbelverbinding wordt gebruikt.</p></li></ul></div></div><div class=sect2><h3 id=_dns_in_de_ipv6_wereld>31.11.4. DNS in de IPv6-wereld<a class=anchor href=#_dns_in_de_ipv6_wereld></a></h3><div class=paragraph><p>Er waren twee soorten DNS-records voor IPv6. De IETF heeft A6-records overbodig verklaard. AAAA-records zijn nu de standaard.</p></div><div class=paragraph><p>AAAA-records gebruiken gaat rechttoe-rechtaan. Wijs de hostnaam toe aan het nieuwe IPv6-adres dat net ontvangen is door het volgende aan de DNS-bestand voor primaire zones toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>MIJNHOSTNAAM          AAAA    MIJNIPv6ADRES</pre></div></div><div class=paragraph><p>Vraag het aan de DNS-provider indien de DNS-zones niet zelf worden geserveerd. De huidige versies van bind (versie 8.3 en 9) en <a class=package href=https://cgit.freebsd.org/ports/tree/dns/djbdns/>dns/djbdns</a> (met de IPv6-patch) ondersteunen AAAA-records.</p></div></div><div class=sect2><h3 id=_de_benodigde_wijzigingen_doorvoeren_in_etcrc_conf>31.11.5. De benodigde wijzigingen doorvoeren in <span class=filename>/etc/rc.conf</span><a class=anchor href=#_de_benodigde_wijzigingen_doorvoeren_in_etcrc_conf></a></h3><div class=sect3><h4 id=_ipv6_cliëntinstellingen>31.11.5.1. IPv6-cliëntinstellingen<a class=anchor href=#_ipv6_cliëntinstellingen></a></h4><div class=paragraph><p>Deze instellingen helpen bij het configureren van een machine in het LAN die als cliënt in plaats van router dienst zal doen. Om <a href="https://man.freebsd.org/cgi/man.cgi?query=rtsol&amp;sektion=8&amp;format=html">rtsol(8)</a> automatisch de interface tijdens het opstarten te laten configureren op FreeBSD 9.<em>X</em> en nieuwer dient het volgende aan <span class=filename>rc.conf</span> toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_prefer=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Voeg voor FreeBSD 8.<em>X</em> en ouder het volgende toe:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Voeg het volgende toe om statisch een IP-adres zoals <code>2001:471:1f11:251:290:27ff:fee0:2093</code> aan de interface <span class=filename>fxp0</span> toe te voegen voor FreeBSD 9.<em>X</em>:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0_ipv6=&#34;2001:471:1f11:251:290:27ff:fee0:2093 prefixlen 64&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Zorg ervoor dat <em>prefixlen 64</em> wordt vervangen door de juiste waarde voor het subnet van de computer.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Voeg voor FreeBSD 8.<em>X</em> het volgende toe:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_ifconfig_fxp0=&#34;2001:471:1f11:251:290:27ff:fee0:2093&#34;</pre></div></div><div class=paragraph><p>Voeg het volgende aan <span class=filename>/etc/rc.conf</span> toe om een standaardrouter <code>2001:471:1f11:251::1</code> toe te wijzen:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_defaultrouter=&#34;2001:471:1f11:251::1&#34;</pre></div></div></div><div class=sect3><h4 id=_ipv6_routergateway_instellingen>31.11.5.2. IPv6 router/gateway instellingen<a class=anchor href=#_ipv6_routergateway_instellingen></a></h4><div class=paragraph><p>Deze paragraaf helpt bij het opvolgen van de aanwijzingen die de tunnelprovider heeft gegeven en ze om te zetten in instellingen die blijven na een herstart. Om de tunnel tijdens het opstarten te herstellen kan het volgende in <span class=filename>/etc/rc.conf</span> gebruikt worden:</p></div><div class=paragraph><p>Noem de generieke tunnelinterfaces die zullen worden ingesteld, bijvoorbeeld <span class=filename>gif0</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>gif_interfaces=&#34;gif0&#34;</pre></div></div><div class=paragraph><p>Om de interface met een lokaal eindpunt <em>MIJN_IPv4_ADRES</em> in te stellen naar een ver eindpunt <em>VER_IPv4_ADRES</em>:</p></div><div class="literalblock programlisting"><div class=content><pre>gifconfig_gif0=&#34;MIJN_IPv4_ADRES VER_IPv4_ADRES&#34;</pre></div></div><div class=paragraph><p>Voeg het volgende toe om het IPv6-adres dat is toegewezen als het eindpunt van de IPv6-tunnel te gebruiken voor FreeBSD 9.<em>X</em> en nieuwer:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_gif0_ipv6=&#34;inet6 MIJN_TOEGEWEZEN_IPv6_TUNNEL_EINDPUNT_ADRES&#34;</pre></div></div><div class=paragraph><p>Voeg voor FreeBSD 8.<em>X</em> en eerder het volgende toe:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_ifconfig_gif0=&#34;MIJN_TOEGEWEZEN_IPv6_TUNNEL_EINDPUNT_ADRES&#34;</pre></div></div><div class=paragraph><p>Nu hoeft alleen de standaardroute voor IPv6 ingesteld te worden. Dit is de andere kant van de IPv6-tunnel:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_defaultrouter=&#34;MIJN_IPv6_VER_TUNNEL_EINDPUNT_ADRES&#34;</pre></div></div></div><div class=sect3><h4 id=_ipv6_tunnelinstellingen>31.11.5.3. IPv6-tunnelinstellingen<a class=anchor href=#_ipv6_tunnelinstellingen></a></h4><div class=paragraph><p>Indien de server gebruikt wordt om IPv6 tussen de rest van het netwerk en de wereld te routen, is ook de volgende instelling in <span class=filename>/etc/rc.conf</span> nodig:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_gateway_enable=&#34;YES&#34;</pre></div></div></div></div><div class=sect2><h3 id=_routeradvertentie_en_automatische_hostconfiguratie>31.11.6. Routeradvertentie en automatische hostconfiguratie<a class=anchor href=#_routeradvertentie_en_automatische_hostconfiguratie></a></h3><div class=paragraph><p>Deze sectie helpt bij het instellen van <a href="https://man.freebsd.org/cgi/man.cgi?query=rtadvd&amp;sektion=8&amp;format=html">rtadvd(8)</a> om de standaard IPv6-route te adverteren.</p></div><div class=paragraph><p>Het volgende is nodig in <span class=filename>/etc/rc.conf</span> om <a href="https://man.freebsd.org/cgi/man.cgi?query=rtadvd&amp;sektion=8&amp;format=html">rtadvd(8)</a> aan te zetten:</p></div><div class="literalblock programlisting"><div class=content><pre>rtadvd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Het is belangrijk om de interface te specificeren waarop het IPv6-routerverzoek plaatsvindt. Om bijvoorbeeld <a href="https://man.freebsd.org/cgi/man.cgi?query=rtadvd&amp;sektion=8&amp;format=html">rtadvd(8)</a> te vertellen om <span class=filename>fxp0</span> te gebruiken:</p></div><div class="literalblock programlisting"><div class=content><pre>rtadvd_interfaces=&#34;fxp0&#34;</pre></div></div><div class=paragraph><p>Nu dient het instellingenbestand <span class=filename>/etc/rtadvd.conf</span> aangemaakt te worden. Hier is een voorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>fxp0:\
	:addrs#1:addr=&#34;2001:471:1f11:246::&#34;:prefixlen#64:tc=ether:</pre></div></div><div class=paragraph><p>Vervang <span class=filename>fxp0</span> door de interface die gebruikt gaat worden.</p></div><div class=paragraph><p>Vervang vervolgens <code>2001:471:1f11:246::</code> met de prefix van uw toewijzing.</p></div><div class=paragraph><p>Indien een <code>/64</code> subnet is toegewezen, hoeft er verder niets veranderd te worden. In andere gevallen dient de juiste waarde voor <code>prefixlen#</code> gebruikt te worden.</p></div></div></div></div><div class=sect1><h2 id=network-atm>31.12. Asynchronous Transfer Mode (ATM)<a class=anchor href=#network-atm></a></h2><div class=sectionbody><div class=sect2><h3 id=_klassiek_ip_configureren_over_atm_pvcs>31.12.1. Klassiek IP configureren over ATM (PVCs)<a class=anchor href=#_klassiek_ip_configureren_over_atm_pvcs></a></h3><div class=paragraph><p>Klassiek IP over ATM (CLIP) is de eenvoudigste methode om Asynchronous Transfer Mode (ATM) met IP te gebruiken. Het kan met geswitchte verbindingen (SVCs) en met permanente verbindingen (PVCs) gebruikt worden. Deze sectie beschrijft hoe een netwerk gebaseerd op PVCs op te zetten.</p></div><div class=sect3><h4 id=_volledig_geschakelde_configuraties>31.12.1.1. Volledig geschakelde configuraties<a class=anchor href=#_volledig_geschakelde_configuraties></a></h4><div class=paragraph><p>De eerste methode om een CLIP met PVCs op te zetten is om elke machine met elke andere machine in het netwerk te verbinden via een toegewijde PVC. Hoewel dit eenvoudig te configureren is, wordt het onpraktisch voor een groter aantal machines. Dit netwerk gaat ervan uit dat er vier machines in het netwerk zijn, allen verbonden met het ATM netwerk met een ATM adapterkaart. De eerste stap is het plannen van de IP-adressen en de ATM verbindingen tussen de machines. Het volgende wordt gebruikt:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Host</th><th class="tableblock halign-left valign-top">IP-adres</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostA</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.1</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostB</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.2</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.3</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.4</code></p></td></tr></tbody></table><div class=paragraph><p>Om een volledig geschakeld net te bouwen is er een ATM-verbinding nodig tussen elk paar machines:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Machines</th><th class="tableblock halign-left valign-top">VPI.VCI koppel</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostA</code> - <code>hostB</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostA</code> - <code>hostC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.101</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostA</code> - <code>hostD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.102</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostB</code> - <code>hostC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.103</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostB</code> - <code>hostD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.104</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hostC</code> - <code>hostD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.105</p></td></tr></tbody></table><div class=paragraph><p>De VPI- en VCI-waarde kunnen aan beide kanten van de verbinding verschillen, maar voor de eenvoud wordt aangenomen dat ze hetzelfde zijn. Vervolgens dienen de ATM-interfaces op elke host geconfigureerd te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>hostA# ifconfig hatm0 192.168.173.1 up
hostB# ifconfig hatm0 192.168.173.2 up
hostC# ifconfig hatm0 192.168.173.3 up
hostD# ifconfig hatm0 192.168.173.4 up</code></pre></div></div><div class=paragraph><p>aannemende dat de ATM-interface op alle hosts <span class=filename>hatm0</span> is. Nu dienen de PVCs op <code>hostA</code> geconfigureerd te worden (er wordt aangenomen dat ze reeds op de ATM-switches zijn geconfigureerd, raadpleeg de handleiding van de switch hoe dit te doen).</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>hostA# atmconfig natm add 192.168.173.2 hatm0 0 100 llc/snap ubr
hostA# atmconfig natm add 192.168.173.3 hatm0 0 101 llc/snap ubr
hostA# atmconfig natm add 192.168.173.4 hatm0 0 102 llc/snap ubr

hostB# atmconfig natm add 192.168.173.1 hatm0 0 100 llc/snap ubr
hostB# atmconfig natm add 192.168.173.3 hatm0 0 103 llc/snap ubr
hostB# atmconfig natm add 192.168.173.4 hatm0 0 104 llc/snap ubr

hostC# atmconfig natm add 192.168.173.1 hatm0 0 101 llc/snap ubr
hostC# atmconfig natm add 192.168.173.2 hatm0 0 103 llc/snap ubr
hostC# atmconfig natm add 192.168.173.4 hatm0 0 105 llc/snap ubr

hostD# atmconfig natm add 192.168.173.1 hatm0 0 102 llc/snap ubr
hostD# atmconfig natm add 192.168.173.2 hatm0 0 104 llc/snap ubr
hostD# atmconfig natm add 192.168.173.3 hatm0 0 105 llc/snap ubr</code></pre></div></div><div class=paragraph><p>Uiteraard kunnen ook andere verkeerscontracten dan UBR worden gebruikt indien de ATM-adapter die ondersteunt. In dit geval wordt de naam van het verkeerscontract gevolgd door de parameters van het verkeer. Hulp voor het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=atmconfig&amp;sektion=8&amp;format=html">atmconfig(8)</a> kan verkregen worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atmconfig help natm add</span></code></pre></div></div><div class=paragraph><p>of in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=atmconfig&amp;sektion=8&amp;format=html">atmconfig(8)</a>.</p></div><div class=paragraph><p>Dezelfde configuratie kan ook bereikt worden via <span class=filename>/etc/rc.conf</span>. Voor <code>hostA</code> wordt dit:</p></div><div class="literalblock programlisting"><div class=content><pre>network_interfaces=&#34;lo0 hatm0&#34;
ifconfig_hatm0=&#34;inet 192.168.173.1 up&#34;
natm_static_routes=&#34;hostB hostC hostD&#34;
route_hostB=&#34;192.168.173.2 hatm0 0 100 llc/snap ubr&#34;
route_hostC=&#34;192.168.173.3 hatm0 0 101 llc/snap ubr&#34;
route_hostD=&#34;192.168.173.4 hatm0 0 102 llc/snap ubr&#34;</pre></div></div><div class=paragraph><p>De huidige toestand van alle CLIP routes kan worden verkregen met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>hostA# atmconfig natm show</code></pre></div></div></div></div></div></div><div class=sect1><h2 id=carp>31.13. Common Address Redundancy Protocol (CARP)<a class=anchor href=#carp></a></h2><div class=sectionbody><div class=paragraph><p>Het Common Address Redundancy Protocol, of CARP, staat toe dat meerdere hosts hetzelfde IP-adres gebruiken. In sommige opstellingen wordt dit gebruikt voor beschikbaarheid of loadbalancing. Hosts kunnen ook gescheiden IP-adressen gebruiken, zoals in het voorbeeld dat hier is gegeven.</p></div><div class=paragraph><p>Om ondersteuning voor CARP aan te zetten, dient de FreeBSD-kernel herbouwd zoals beschreven in <a href=../kernelconfig/#kernelconfig>De FreeBSD-kernel instellen</a> met de volgende optie:</p></div><div class="literalblock programlisting"><div class=content><pre>device	carp</pre></div></div><div class=paragraph><p>Als alternatief kan de <span class=filename>if_carp.ko</span> module geladen worden tijdens het opstarten. Voeg de volgende regel toe aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>if_carp_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>De functionaliteit van CARP zou nu beschikbaar moeten zijn en kan met verschillende <code>sysctl</code>-OIDs worden bijgesteld:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">OID</th><th class="tableblock halign-left valign-top">Beschrijving</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.allow</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Accepteer inkomende CARP pakketten. Staat standaard aan.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.preempt</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Deze optie zet alle CARP interfaces down op de host wanneer er een down gaat. Staat standaard uit.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.log</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>De waarde <code>0</code> zet alle logging uit. De waarde <code>1</code> zet het loggen van slechte CARP-pakketten aan. Waardes hoger dan <code>1</code> zet het loggen van toestandsveranderingen van de CARP interfaces aan. De standaardwaarde is <code>1</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.arpbalance</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Balanceer lokaal netwerkverkeer met ARP. Staat standaard uit.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.suppress_preempt</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Een alleen-lezen OID die de toestand van preëmptie-onderdrukking weergeeft. Preëmptie kan worden onderdrukt wanneer de verbinding op een interface afwezig is. De waarde <code>0</code> betekent dat preëmptie niet onderdrukt is. Elk probleem verhoogt deze OID.</p></td></tr></tbody></table><div class=paragraph><p>De CARP-apparaten zelf kunnen met het commando <code>ifconfig</code> worden aangemaakt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig carp0 create</span></code></pre></div></div><div class=paragraph><p>In een echte omgeving hebben deze interfaces unieke identificatienummers, bekend als een VHID, nodig. Dit VHID of Virtual Host Identification zal worden gebruikt om de hosts op het netwerk te onderscheiden.</p></div><div class=sect2><h3 id=_carp_gebruiken_voor_serverbeschikbaarheid>31.13.1. CARP gebruiken voor serverbeschikbaarheid<a class=anchor href=#_carp_gebruiken_voor_serverbeschikbaarheid></a></h3><div class=paragraph><p>Eén gebruik van CARP, zoals boven aangegeven, is serverbeschikbaarheid. Dit voorbeeld geeft failover-ondersteuning voor drie hosts, met allemaal een uniek IP-adres en dezelfde webinhoud. Deze machines zullen samen met een Round Robin DNS configuratie dienst doen. De failover-machine zal twee aanvullende CARP-interfaces hebben, één voor elk van de IP’s van de contentservers. Wanneer er een storing optreedt, zou de failover-server het IP-adres van de falende machine moeten oppikken. Dit betekent dat de storing geheel onmerkbaar zou moeten zijn voor de gebruiker. De failover-server heeft dezelfde inhoud en diensten nodig als de andere contentservers waarvoor het moet invallen.</p></div><div class=paragraph><p>De twee machines dienen identiek geconfigureerd te worden op de gegeven hostnamen en VHIDs na. Dit voorbeeld noemt deze machines respectievelijk <code>hosta.example.org</code> en <code>hostb.example.org</code>. Ten eerste dienen de benodigde regels voor een CARP-configuratie aan <span class=filename>rc.conf</span> te worden toegevoegd. Voor <code>hosta.example.org</code> dient het bestand <span class=filename>rc.conf</span> de volgende regels te bevatten:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;hosta.example.org&#34;
ifconfig_fxp0=&#34;inet 192.168.1.3 netmask 255.255.255.0&#34;
cloned_interfaces=&#34;carp0&#34;
ifconfig_carp0=&#34;vhid 1 pass testpass 192.168.1.50/24&#34;</pre></div></div><div class=paragraph><p>Op <code>hostb.example.org</code> dienen de volgende regels in <span class=filename>rc.conf</span> te staan:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;hostb.example.org&#34;
ifconfig_fxp0=&#34;inet 192.168.1.4 netmask 255.255.255.0&#34;
cloned_interfaces=&#34;carp0&#34;
ifconfig_carp0=&#34;vhid 2 pass testpass 192.168.1.51/24&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is erg belangrijk dat de wachtwoorden die met de optie <code>pass</code> aan <code>ifconfig</code> gegeven zijn, identiek zijn. De <span class=filename>carp</span> apparaten zullen alleen luisteren naar en advertenties accepteren van machines met het juiste wachtwoord. Het VHID dient ook verschillend te zijn voor elke machine.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De derde machine, <code>provider.example.org</code>, dient voorbereidt te worden op het afhandelen van failover van beide hosts. Deze machine heeft twee <span class=filename>carp</span> apparaten nodig, één om elke host af te handelen. De juiste instelregels voor <span class=filename>rc.conf</span> zullen ongeveer gelijk zijn aan de volgende:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;provider.example.org&#34;
ifconfig_fxp0=&#34;inet 192.168.1.5 netmask 255.255.255.0&#34;
cloned_interfaces=&#34;carp0 carp1&#34;
ifconfig_carp0=&#34;vhid 1 advskew 100 pass testpass 192.168.1.50/24&#34;
ifconfig_carp1=&#34;vhid 2 advskew 100 pass testpass 192.168.1.51/24&#34;</pre></div></div><div class=paragraph><p>Met twee <span class=filename>carp</span> apparaten is <code>provider.example.org</code> in staat om het IP-adres van de andere machine op te pikken wanneer de ene niet meer antwoordt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De standaard FreeBSD-kernel <em>kan</em> preëmptie geactiveerd hebben. In dat geval hoeft <code>provider.example.org</code> het IP-adres niet terug te geven aan de originele contentserver. In dit geval kan het nodig zijn dat een beheerder handmatig het IP terug aan de meester moet geven. Het volgende commando dient op <code>provider.example.org</code> gegeven te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig carp0 down &amp;&amp; ifconfig carp0 up</span></code></pre></div></div><div class=paragraph><p>Dit dient gedaan te worden op de <span class=filename>carp</span> interface die met de juiste host overeenkomt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Op dit moment dient CARP volledig actief en beschikbaar voor testen te zijn. Voor het testen dienen òfwel het netwerken herstart te worden, òf de machines dienen opnieuw opgestart te worden.</p></div><div class=paragraph><p>Meer informatie is altijd beschikbaar in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=carp&amp;sektion=4&amp;format=html">carp(4)</a></p></div></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: 9 maart 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=http://172.16.201.134:1313/nl/books/handbook/firewalls class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=http://172.16.201.134:1313/nl/books/handbook/partv class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#advanced-networking-synopsis>31.1. Samenvatting</a></li><li><a href=#network-routing>31.2. Gateways en routes</a></li><li><a href=#network-wireless>31.3. Draadloze netwerken</a></li><li><a href=#network-bluetooth>31.4. Bluetooth</a></li><li><a href=#network-bridging>31.5. Bridging</a></li><li><a href=#network-aggregation>31.6. Verbindingsaggregatie en failover</a></li><li><a href=#network-diskless>31.7. Schijfloos werken</a></li><li><a href=#network-pxe-nfs>31.8. Met PXE en een NFS-root-bestandssysteem opstarten</a></li><li><a href=#network-isdn>31.9. ISDN</a></li><li><a href=#network-natd>31.10. Network Address Translation</a></li><li><a href=#network-ipv6>31.11. IPv6</a></li><li><a href=#network-atm>31.12. Asynchronous Transfer Mode (ATM)</a></li><li><a href=#carp>31.13. Common Address Redundancy Protocol (CARP)</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/nl/books/handbook/handbook_nl.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/nl/_index target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/nl/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Choose language">
<span>Dutch</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/nl class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/nl/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>