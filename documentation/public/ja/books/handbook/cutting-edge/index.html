<!doctype html><html class=theme-light lang=ja><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="freebsd-update もしくは Git を使った FreeBSD システムを最新の状態に更新する方法、ベースシステム全体を再構築しインストールする方法などの説明"><meta name=keywords content="updating,upgrading,documentation,FreeBSD-STABLE,FreeBSD-CURRENT,Security Patches"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/><title>第16章 FreeBSD のアップデートとアップグレード | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="第16章 FreeBSD のアップデートとアップグレード"><meta property="og:description" content="freebsd-update もしくは Git を使った FreeBSD システムを最新の状態に更新する方法、ベースシステム全体を再構築しインストールする方法などの説明"><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="ja"><meta property="og:url" content="http://172.16.201.134:1313/ja/books/handbook/cutting-edge/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/ja\/books\/handbook\/cutting-edge\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/ja>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/ja/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/ja/books>Books</a></li><li><a href=http://172.16.201.134:1313/ja/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/ja/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=ja>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/preface/>前書き</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-audience>想定している読者</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-changes-from3>第 3 版からの変更</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-changes-from2>第 2 版 (2004) からの変更</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-changes>第 1 版 (2001) からの変更</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-overview>この文書の構成</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-conv>この文書で用いられている表記法</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-acknowledgements>謝辞</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/parti/>パートI. 導入</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/introduction/>第1章 はじめに</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/introduction/#introduction-synopsis>1.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/introduction/#nutshell>1.2. FreeBSD へようこそ!</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/introduction/#history>1.3. FreeBSD プロジェクトについて</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/>第2章 FreeBSD のインストール</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-synopsis>2.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-hardware>2.2. 最小ハードウェア要件</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-pre>2.3. インストール前に行う作業</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-start>2.4. インストールの開始</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#using-bsdinstall>2.5. bsdinstall の使用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-partitioning>2.6. ディスク領域の割り当て</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-fetching-distribution>2.7. 配布ファイルのダウンロード</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-post>2.8. ネットワークインターフェース、アカウント、タイムゾーン、 サービスおよびセキュリティオプションの設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-install-trouble>2.9. トラブルシューティング</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#using-live-cd>2.10. Live CD を使う</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/basics/>第3章 FreeBSD の基礎知識</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#basics-synopsis>3.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#consoles>3.2. 仮想コンソールと端末</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#users-synopsis>3.3. ユーザと基本的なアカウント管理</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#permissions>3.4. 許可属性</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#dirstructure>3.5. ディレクトリ構造</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#disk-organization>3.6. ディスク構成</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#mount-unmount>3.7. ファイルシステムのマウントとアンマウント</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#basics-processes>3.8. プロセスおよびデーモン</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#shells>3.9. シェル</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#editors>3.10. テキストエディタ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#basics-devices>3.11. デバイスとデバイスノード</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#basics-more-information>3.12. マニュアルページ</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/ports/>第4章 アプリケーションのインストール - packages と ports</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-synopsis>4.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-overview>4.2. ソフトウェアのインストール</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-finding-applications>4.3. ソフトウェアの探し方</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#pkgng-intro>4.4. pkg によるバイナリ package の管理</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-using>4.5. Ports Collection の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-poudriere>4.6. Poudriere を用いた package の構築</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-nextsteps>4.7. インストール後の作業</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-broken>4.8. うまく動作しない ports に遭遇した場合には</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/x11/>第5章 X Window System</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x11-synopsis>5.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-understanding>5.2. 用語の説明</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-install>5.3. Xorg のインストール</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-config>5.4. Xorg の設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-fonts>5.5. Xorg でのフォントの使用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-xdm>5.6. X ディスプレイマネージャ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x11-wm>5.7. デスクトップ環境</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-compiz-fusion>5.8. Compiz Fusion のインストール</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x11-troubleshooting>5.9. トラブルシューティング</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/partii/>パートII. 日々の生活</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/>第6章 デスクトップアプリケーション</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/#desktop-synopsis>6.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/#desktop-browsers>6.2. ブラウザ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/#desktop-productivity>6.3. 生産的なアプリケーション</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/#desktop-viewers>6.4. ドキュメントビューア</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/#desktop-finance>6.5. 財務管理ソフトウェア</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/>第7章 マルチメディア</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#multimedia-synopsis>7.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#sound-setup>7.2. サウンドカードの設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#sound-mp3>7.3. MP3 オーディオ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#video-playback>7.4. ビデオ再生</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#tvcard>7.5. TV カードの設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#mythtv>7.6. MythTV</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#scanners>7.7. 画像スキャナ</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/>第8章 FreeBSD カーネルのコンフィグレーション</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-synopsis>8.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-custom-kernel>8.2. なぜカスタムカーネルを作るか?</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-devices>8.3. システムのハードウェアについて知る</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-config>8.4. コンフィグレーションファイル</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-building>8.5. カスタムカーネルの構築とインストール</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-trouble>8.6. 問題が起きた場合には</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/printing/>第9章 プリンタの利用</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-synopsis>9.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-intro-spooler>9.2. はじめに</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-intro-setup>9.3. 基本的な設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-advanced>9.4. プリンタ設定上級編</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-using>9.5. プリンタを使う</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-lpd-alternatives>9.6. 標準スプーラの代替品</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-troubleshooting>9.7. トラブルシューティング</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/linuxemu/>第10章 Linux® バイナリ互換機能</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/linuxemu/#linuxemu-synopsis>10.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/linuxemu/#linuxemu-lbc-install>10.2. Linux® バイナリ互換機能の設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/linuxemu/#linuxemu-advanced>10.3. 高度なトピックス</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/partiii/>パートIII. システム管理</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/config/>第11章 設定とチューニング</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#_この章では>11.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-core-configuration>11.2. 中核となる設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-appconfig>11.3. アプリケーションの設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-starting-services>11.4. サービスの起動</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-virtual-hosts>11.5. バーチャルホスト</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-configfiles>11.6. 設定ファイル</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-sysctl>11.7. sysctl によるチューニング</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-disk>11.8. ディスクのチューニング</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-kernel-limits>11.9. Kernel 制限のチューニング</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/boot/>第12章 FreeBSD の起動のプロセス</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/boot/#boot-synopsis>12.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/boot/#boot-introduction>12.2. FreeBSD の起動プロセス</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/boot/#device-hints>12.3. Device Hints</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/boot/#boot-shutdown>12.4. シャットダウン動作</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/security/>第13章 セキュリティ</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-synopsis>13.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-intro>13.2. はじめに</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#one-time-passwords>13.3. ワンタイムパスワード</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#tcpwrappers>13.4. TCP Wrappers</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#kerberos5>13.5. Kerberos5</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#openssl>13.6. OpenSSL</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#ipsec>13.7. VPN over IPsec</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#openssh>13.8. OpenSSH</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#fs-acl>13.9. ファイルシステムアクセス制御リスト (ACL)</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-portaudit>13.10. サードパーティ製ソフトウェアのセキュリティ問題を監視する</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-advisories>13.11. FreeBSD セキュリティ勧告</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-accounting>13.12. プロセスアカウンティング</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-resourcelimits>13.13. リソースの制限</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/disks/>第14章 ストレージ</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#disks-synopsis>14.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#disk-naming>14.2. デバイス名</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#disks-adding>14.3. ディスクの追加</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#raid>14.4. RAID</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#creating-cds>14.5. 光メディア (CD & DVD) の作成と使用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#floppies>14.6. フロッピーディスクの作成と使用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#backups-tapebackups>14.7. データテープの作成と使用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#backups-floppybackups>14.8. フロッピーディスクへのバックアップ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#backup-basics>14.9. バックアップの基本</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#disks-virtual>14.10. ネットワーク、メモリ、そしてファイルベースのファイルシステム</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#snapshots>14.11. ファイルシステムのスナップショット</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#quotas>14.12. ファイルシステムクォータ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#disks-encrypting>14.13. ディスクパーティションの暗号化</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/l10n/>第15章 地域化 (localization) - i18n/L10n の利用と設定</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/l10n/#l10n-synopsis>15.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/l10n/#using-localization>15.2. 地域化の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/l10n/#l10n-compiling>15.3. 国際化 (i18n) に対応したアプリケーションを見つける</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/l10n/#lang-setup>15.4. 特定の言語にロケールを設定する</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle checked>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/>第16章 FreeBSD のアップデートとアップグレード</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#updating-upgrading-synopsis>16.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>16.2. FreeBSD Update</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#updating-bootcode>16.3. ブートコードのアップデート</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#updating-upgrading-documentation>16.4. ドキュメントのアップデート</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#current-stable>16.5. 開発ブランチを追いかける</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#makeworld>16.6. ソースを用いた FreeBSD のアップデート</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#small-lan>16.7. 複数のマシンで追いかける</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/partiv/>パートIV. ネットワーク通信</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/>第17章 シリアル通信</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#serial-synopsis>17.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#serial>17.2. はじめに</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#term>17.3. シリアル端末</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#dialup>17.4. ダイアルインサービス</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#dialout>17.5. ダイアルアウトサービス</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#serialconsole-setup>17.6. シリアルコンソールの設定</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/>第18章 PPP と SLIP</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/#_この章では>18.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/#userppp>18.2. ユーザ ppp の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/#ppp>18.3. カーネル PPP の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/#pppoe>18.4. PPP オーバイーサネット (PPPoE) の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/#slip>18.5. SLIP の利用</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/mail/>第19章 電子メール</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#mail-synopsis>19.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#mail-using>19.2. 電子メールを使う</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#sendmail>19.3. sendmail の設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#mail-changingmta>19.4. MTA の変更</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#mail-trouble>19.5. トラブルシュート</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#mail-advanced>19.6. 先進的なトピックス</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#SMTP-UUCP>19.7. UUCP とともに SMTP を使う</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#SMTP-dialup>19.8. ダイアルアップ接続でメールを使う</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#SMTP-Auth>19.9. SMTP 認証</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/>第20章 高度なネットワーク</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#advanced-networking-synopsis>20.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-routing>20.2. ゲートウェイと経路</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-wireless>20.3. 無線ネットワーク</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-bluetooth>20.4. Bluetooth</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-bridging>20.5. ブリッジ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-nfs>20.6. NFS</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-diskless>20.7. ディスクレス稼働</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-isdn>20.8. ISDN</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-nis>20.9. NIS/YP</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-dhcp>20.10. DHCP</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-dns>20.11. DNS</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-ntp>20.12. NTP</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-natd>20.13. ネットワークアドレス変換 (NAT)</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-inetd>20.14. inetd"スーパサーバ"</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-plip>20.15. パラレルライン IP (PLIP)</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-ipv6>20.16. IPv6</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/partv/>パートV. 付録</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/mirrors/>付録A FreeBSD の入手方法</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/mirrors/#mirrors>A.1. Mirrors</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mirrors/#git>A.2. Git の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mirrors/#svn>A.3. Subversion の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mirrors/#mirrors-cdrom>A.4. CD および DVD セット</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/>付録B. 参考図書</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-freebsd>B.1. FreeBSD 専門の書籍</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-userguides>B.2. 利用者向けのガイド</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-adminguides>B.3. 管理者向けのガイド</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#_プログラマ向けのガイド>B.4. プログラマ向けのガイド</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#_オペレーティングシステム内部>B.5. オペレーティングシステム内部</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#_セキュリティの参考資料>B.6. セキュリティの参考資料</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-hardware>B.7. ハードウェアの参考資料</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-history>B.8. UNIX® の歴史</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-journals>B.9. 定期刊行物、雑誌およびジャーナル</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/eresources/>付録 C. インターネット上のリソース</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/eresources/#eresources-www>C.1. ウェブサイト</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/eresources/#eresources-mail>C.2. メーリングリスト</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/eresources/#eresources-news>C.3. Usenet ニュースグループ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/eresources/#eresources-web>C.4. オフィシャルミラー</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/pgpkeys/>付録 D. OpenPGP Keys</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/pgpkeys/#pgpkeys-officers>D.1. オフィサ</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>第16章 FreeBSD のアップデートとアップグレード</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#updating-upgrading-synopsis>16.1. この章では</a></li><li><a href=#updating-upgrading-freebsdupdate>16.2. FreeBSD Update</a></li><li><a href=#updating-bootcode>16.3. ブートコードのアップデート</a></li><li><a href=#updating-upgrading-documentation>16.4. ドキュメントのアップデート</a></li><li><a href=#current-stable>16.5. 開発ブランチを追いかける</a></li><li><a href=#makeworld>16.6. ソースを用いた FreeBSD のアップデート</a></li><li><a href=#small-lan>16.7. 複数のマシンで追いかける</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=updating-upgrading-synopsis>16.1. この章では<a class=anchor href=#updating-upgrading-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>あるリリースから次のリリースまでの期間にも、 FreeBSD の開発は休みなく続けられています。
最新の開発ツリーと同期することを好む人がいる一方で、公式のリリース版を好んで使う方もいます。
しかしながら、公式のリリースといえども、 セキュリティや他の重要な修正のため、時にはアップデートが必要となります。
FreeBSD は手元のシステムを最新の開発ツリーと同期するために必要なツールをすべて用意しているので、使用しているバージョンに関わらず、これらのツールを使って簡単にシステムのバージョンをアップグレードできます。
この章では、開発ブランチを追いかける方法、および、FreeBSD システムをアップデートする基本的なツールについて解説します。</p></div><div class=paragraph><p>この章では以下について説明します。</p></div><div class=ulist><ul><li><p>freebsd-update もしくは Git を使った FreeBSD システムの更新方法</p></li><li><p>インストールされているシステムと、変更が行われていない状態との比較方法</p></li><li><p>Git またはドキュメント用の ports を使って、 インストールされているドキュメントを最新版にアップデートする方法</p></li><li><p>2 つの開発ブランチ、FreeBSD-STABLE と FreeBSD-CURRENT の違いについて</p></li><li><p>ベースシステム全体を再構築しインストールする方法</p></li></ul></div><div class=paragraph><p>この章を読む前に、以下の準備をしましょう。</p></div><div class=ulist><ul><li><p>ネットワーク接続の適切な設定 (<a href=../advanced-networking/#advanced-networking>高度なネットワーク</a>)</p></li><li><p>サードパーティ製のソフトウェアのインストール方法の習得 (<a href=../ports/#ports>アプリケーションのインストール - packages と ports</a>)</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>この章を通じて、FreeBSD のソースコードのダウンロードやアップデートに <code>git</code> が使われています。
必要に応じて <a class=package href=https://cgit.freebsd.org/ports/tree/devel/git/>devel/git</a> port または package が使われることもあります。</p></div></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=updating-upgrading-freebsdupdate>16.2. FreeBSD Update<a class=anchor href=#updating-upgrading-freebsdupdate></a></h2><div class=sectionbody><div class=paragraph><p>すみやかにセキュリティパッチを適用し、 オペレーティングシステムをアップグレードして、 最新のリリースに保つことは、システム管理における重要な側面です。
これらの処理を行うために FreeBSD には <code>freebsd-update</code> と呼ばれるユーティリティが用意されています。</p></div><div class=paragraph><p>このユーティリティを用いると、FreeBSD のセキュリティおよび eratta アップデートをバイナリによって行うことができます。
手動でパッチもしくは新しいカーネルをコンパイルし、インストールする必要はありません。
バイナリアップデートは、セキュリティチームがサポートしているすべてのアーキテクチャとリリースで利用できます。
<a href=https://www.FreeBSD.org/ja/security/>https://www.FreeBSD.org/ja/security/</a> には、サポートが行われているリリースや保守終了予定日の一覧があります。</p></div><div class=paragraph><p>このユーティリティは、マイナーリリースであったり、他のリリースブランチへのアップグレードにも対応しています。
新しいリリースにアップデートする前に、アップデートしようとしているリリースのアナウンスに目を通し、重要な情報がないかどうかを確認してください。
リリースのアナウンスは <a href=https://www.FreeBSD.org/ja/releases/>https://www.FreeBSD.org/ja/releases/</a> で確認できます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>もし <a href="https://man.freebsd.org/cgi/man.cgi?query=crontab&amp;sektion=5&amp;format=html">crontab(5)</a> の中に <a href="https://man.freebsd.org/cgi/man.cgi?query=freebsd-update&amp;sektion=8&amp;format=html">freebsd-update(8)</a> の機能が含まれていたら、 オペレーティングシステムのアップグレード作業を終えるまでは無効にしてください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>この節では、<code>freebsd-update</code> で使われる設定ファイルの説明、 セキュリティパッチの適応方法のデモンストレーション、 オペレーティングシステムをアップグレードする際に考慮すべき点について説明します。</p></div><div class=sect2><h3 id=freebsdupdate-config-file>16.2.1. 設定ファイル<a class=anchor href=#freebsdupdate-config-file></a></h3><div class=paragraph><p><code>freebsd-update</code> のデフォルトの設定ファイルは、そのままでも用いることができます。
<span class=filename>/etc/freebsd-update.conf</span> の設定をデフォルトからきめ細かく調整して、 アップデートプロセスを制御するユーザもいます。
利用可能なオプションについてはこのファイルのコメントで説明されていますが、以下の項目については補足が必要でしょう。</p></div><div class="literalblock programlisting"><div class=content><pre># Components of the base system which should be kept updated.
Components world kernel</pre></div></div><div class=paragraph><p>このパラメータは、FreeBSD のどの部分を最新に維持するかを設定します。
デフォルトでは、ベースシステム全体、そしてカーネルをアップデートします。
<code>src/base</code> や <code>src/sys</code> のように、個々の項目を指定することもできます。
この部分についてはデフォルトのままにしておき、アップデートする項目をユーザがリストに加える形にするのがベストでしょう。
ソースコードとバイナリが同期していないと、長い年月の間に悲惨な結果がもたらされる可能性があります。</p></div><div class="literalblock programlisting"><div class=content><pre># Paths which start with anything matching an entry in an IgnorePaths
# statement will be ignored.
IgnorePaths /boot/kernel/linker.hints</pre></div></div><div class=paragraph><p><span class=filename>/bin</span> や <span class=filename>/sbin</span> 等の特定のディレクトリをアップデートで変更しないように、これらのパスを追加してください。
このオプションは、ローカルの変更点を <code>freebsd-update</code> が上書きすることを防ぐ目的にも利用できます。</p></div><div class="literalblock programlisting"><div class=content><pre># Paths which start with anything matching an entry in an UpdateIfUnmodified
# statement will only be updated if the contents of the file have not been
# modified by the user (unless changes are merged; see below).
UpdateIfUnmodified /etc/ /var/ /root/ /.cshrc /.profile</pre></div></div><div class=paragraph><p>このオプションは、指定したディレクトリにある設定ファイルを、ローカルで変更されていない場合のみアップデートします。
ユーザがこれらのファイルを変更していると、変更されたファイルの自動アップデートは行われません。
他に、<code>KeepModifiedMetadata</code> という別のオプションが存在します。
このオプションは、<code>freebsd-update</code> がマージ中に変更点を保存するようにします。</p></div><div class="literalblock programlisting"><div class=content><pre># When upgrading to a new FreeBSD release, files which match MergeChanges
# will have any local changes merged into the version from the new release.
MergeChanges /etc/ /var/named/etc/ /boot/device.hints</pre></div></div><div class=paragraph><p><code>freebsd-update</code> がマージすべきファイルが存在するディレクトリの一覧です。
ファイルのマージのプロセスは、<a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> と同様 <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> パッチの連続ですが、選択肢は少なく、マージを承認するか、エディタを起動するか、<code>freebsd-update</code> を中断するかどうかを選んでください。
もし、心配な点があれば、<span class=filename>/etc</span> をバックアップしてからマージを承認してください。
<code>mergemaster</code> の詳細な情報については、<a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> で確認してください。</p></div><div class="literalblock programlisting"><div class=content><pre># Directory in which to store downloaded updates and temporary
# files used by FreeBSD Update.
# WorkDir /var/db/freebsd-update</pre></div></div><div class=paragraph><p>ここではすべてのパッチや一次ファイルを置くディレクトリを指定しています。
バージョンをアップグレードするのであれば、この場所には少なくともギガバイトの空き容量が必要です。</p></div><div class="literalblock programlisting"><div class=content><pre># When upgrading between releases, should the list of Components be
# read strictly (StrictComponents yes) or merely as a list of components
# which *might* be installed of which FreeBSD Update should figure out
# which actually are installed and upgrade those (StrictComponents no)?
# StrictComponents no</pre></div></div><div class=paragraph><p>このオプションを <code>yes</code> に設定すると、<code>freebsd-update</code> は <code>Components</code> のリストが完全に正しいと判断し、このリスト以外の変更点については取り扱いません。
<code>freebsd-update</code> は、効率的に <code>Components</code> リストに属するファイルをアップデートします。</p></div><div class=paragraph><p>詳細については、<a href="https://man.freebsd.org/cgi/man.cgi?query=freebsd-update.conf&amp;sektion=5&amp;format=html">freebsd-update.conf(5)</a> を参照してください。</p></div></div><div class=sect2><h3 id=freebsdupdate-security-patches>16.2.2. セキュリティパッチの適用<a class=anchor href=#freebsdupdate-security-patches></a></h3><div class=paragraph><p>FreeBSD のセキュリティパッチを適用する過程は簡単になりました。
管理者は <code>freebsd-update</code> を使うことで、 システムを完全にパッチがあたった状態に保つ事ができます。
FreeBSD セキュリティ勧告の詳細については、<a href=../security/#security-advisories>FreeBSD セキュリティ勧告</a> の節で説明されています。</p></div><div class=paragraph><p>以下のコマンドを実行すると、FreeBSD のセキュリティパッチがダウンロードされ、インストールされます。
最初のコマンドは、未対応のパッチがあるかどうかを調べます。
もし未対応のパッチがある場合には、パッチが当てられた際に変更されるファイルのリストが作成されます。
2 番目のコマンドはパッチを適用します。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update fetch</span>
<span class=c># freebsd-update install</span></code></pre></div></div><div class=paragraph><p>アップデートによってカーネルにパッチが適用された場合には、システムを再起動して新しいカーネルで起動する必要があります。
もし、実行中のバイナリにパッチが適用された場合には、パッチが当てられたバイナリが使われるように、影響するアプリケーションを再起動する必要があります。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>通常、ユーザはシステムを再起動する必要があります。
カーネルアップデートによりシステムの再起動が必要かどうかを調べるには、<code>freebsd-version -k</code> と <code>uname -r</code> を実行してください。
これら 2 つのコマンドの結果が異なる場合には、システムを再起動してください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>毎日一度アップデートがないかどうかを自動的に確認するように設定するには、 以下のエントリを <span class=filename>/etc/crontab</span> に追加してください。</p></div><div class="literalblock programlisting"><div class=content><pre>@daily                                  root    freebsd-update cron</pre></div></div><div class=paragraph><p>パッチが存在すると、自動的にダウンロードされますが、適用はされません。
<code>root</code>宛てにメールで、ダウンロードされたパッチを確認し、<code>freebsd-update install</code> とともに手動でインストールする必要のあることが通知されます。</p></div><div class=paragraph><p>うまく行かなかった場合には、<code>freebsd-update</code> を以下のように実行すると、最後の変更までロールバックできます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update rollback</span>
Uninstalling updates... <span class=k>done</span>.</code></pre></div></div><div class=paragraph><p>カーネルまたはカーネルモジュールがアップデートされた場合には、 完了後にもう一度システムを再起動して、 影響のあったバイナリを再起動してください。</p></div><div class=paragraph><p><code>freebsd-update</code> ユーティリティが自動的にアップデートするカーネルは <span class=filename>GENERIC</span> のみです。
カスタムカーネルをインストールしている場合には、<code>freebsd-update</code> によりインストールした後、カーネルを再構築し、もう一度インストールする必要があります。
デフォルトのカーネルの名前は <em>GENERIC</em> です。
<a href="https://man.freebsd.org/cgi/man.cgi?query=uname&amp;sektion=1&amp;format=html">uname(1)</a> コマンドを使ってインストールされているかどうかを確認できます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><span class=filename>GENERIC</span> カーネルを、常に <span class=filename>/boot/GENERIC</span> に置いておいてください。
さまざまな問題を解決する際や、バージョンをアップグレードする際に助けとなります。
<span class=filename>GENERIC</span> カーネルを用意する方法については、<a href=#freebsd-update-custom-kernel-9x>FreeBSD 9.X 以降のシステムにおけるカスタムカーネル</a> を参照してください。</p></div></td></tr></tbody></table></div><div class=paragraph><p><span class=filename>/etc/freebsd-update.conf</span> のデフォルトの設定を変更しない限り、<code>freebsd-update</code> は、他の更新と共にカーネルソースをアップデートします。
新しいカスタムカーネルの再構築と再インストールは、通常通り行うことができます。</p></div><div class=paragraph><p><code>freebsd-update</code> は、常にカーネルをアップデートするとは限りません。
<code>freebsd-update install</code> によってカーネルソースが変更されなかった場合には、カスタムカーネルを再構築する必要はありません。
しかしながら <code>freebsd-update</code> は、<span class=filename>/usr/src/sys/conf/newvers.sh</span> を常にアップデートします。
これは、現在のシステムのパッチレベルを <code>uname -r</code> が <code>-p</code> で表示する時にこのファイルが参照されます。
そのため、何も変更されていない場合でも、カスタムカーネルを再構築することにより、<code>uname</code> がシステムの正確なパッチレベルを報告するようになります。
各システムにインストールされているアップデートをすばやく把握できるようになるので、特に複数のシステムを管理するときに助けとなります。</p></div></div><div class=sect2><h3 id=freebsdupdate-upgrade>16.2.3. メジャーおよびマイナーバージョンのアップグレード<a class=anchor href=#freebsdupdate-upgrade></a></h3><div class=paragraph><p>FreeBSD のマイナーバージョン間のアップグレード、たとえば、FreeBSD 9.0 から FreeBSD 9.1 へのアップグレードは、<em>マイナーバージョン</em> アップグレードと呼ばれます。
<em>メジャーバージョン</em> アップグレードは、FreeBSD 9.X から FreeBSD 10.X へのアップグレードといった、FreeBSD のメジャーバージョンが変わるようなアップグレードのことです。
どちらのアップグレードも、<code>freebsd-update</code> のターゲットにリリース番号を指定する事で実行できます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>カスタムカーネルを使っているシステムでは、アップグレードを行う前に <span class=filename>GENERIC</span> カーネルが、<span class=filename>/boot/GENERIC</span> に置かれている事を確認してください。
<span class=filename>GENERIC</span> カーネルを用意する方法については、<a href=#freebsd-update-custom-kernel-9x>FreeBSD 9.X 以降のシステムにおけるカスタムカーネル</a> を参照してください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>以下のコマンドを実行すると、FreeBSD 9.0 のシステムを FreeBSD 9.1 にアップグレードします。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update -r 9.1-RELEASE upgrade</span></code></pre></div></div><div class=paragraph><p>コマンドを実行すると、<code>freebsd-update</code> は設定ファイルと現在のシステムを評価し、 アップデートするために必要な情報を収集します。
画面には、どのコンポーネントが認識され、どのコンポーネントが認識されていないといったリストが表示されます。
たとえば以下のように表示されます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Looking up update.FreeBSD.org mirrors... 1 mirrors found.
Fetching metadata signature <span class=k>for </span>9.0-RELEASE from update1.FreeBSD.org... <span class=k>done</span><span class=nb>.</span>
Fetching metadata index... <span class=k>done</span><span class=nb>.</span>
Inspecting system... <span class=k>done</span><span class=nb>.</span>

The following components of FreeBSD seem to be installed:
kernel/smp src/base src/bin src/contrib src/crypto src/etc src/games
src/gnu src/include src/krb5 src/lib src/libexec src/release src/rescue
src/sbin src/secure src/share src/sys src/tools src/ubin src/usbin
world/base world/info world/lib32 world/manpages

The following components of FreeBSD <span class=k>do </span>not seem to be installed:
kernel/generic world/catpages world/dict world/doc world/games
world/proflibs

Does this look reasonable <span class=o>(</span>y/n<span class=o>)</span>? y</code></pre></div></div><div class=paragraph><p>ここで、<code>freebsd-update</code> はアップグレードに必要なすべてのファイルをダウンロードします。
何をインストールし、どのように進むかといった質問をされることもあります。</p></div><div class=paragraph><p>カスタムカーネルを使っていると、上記のステップ中に以下のような警告が表示されます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>WARNING: This system is running a <span class=s2>&#34;MYKERNEL&#34;</span> kernel, which is not a
kernel configuration distributed as part of FreeBSD 9.0-RELEASE.
This kernel will not be updated: you MUST update the kernel manually
before running <span class=s2>&#34;/usr/sbin/freebsd-update install&#34;</span></code></pre></div></div><div class=paragraph><p>この時点ではこの警告を無視してもかまいません。
アップデートされた <span class=filename>GENERIC</span> カーネルは、アップグレードプロセスの途中で利用されます。</p></div><div class=paragraph><p>すべてのパッチがローカルシステムへダウンロードされたら、次にパッチが適用されます。
このプロセスには時間がかかります。
この時間はコンピュータの性能およびワークロードに依存します。
その後、設定ファイルがマージされます。
このプロセスでは、ユーザはファイルをマージするか、画面上にエディタを立ち上げて手動でマージするかを尋ねられます。
プロセスが進むごとに、成功したマージのすべての結果の情報がユーザに示されます。
マージに失敗したり、無視した場合には、プロセスが中断します。
ユーザによっては <span class=filename>/etc</span> のバックアップを取り、<span class=filename>master.passwd</span> や <span class=filename>group</span> のような重要なファイルを後で手動でマージする方もいます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>すべてのパッチは別のディレクトリでマージされており、まだ、システムには反映されていません。
すべてのパッチが正しく適用され、すべての設定ファイルがマージされてプロセスがスムーズに進んだら、ユーザは以下のコマンドを用いて、変更点をディスクに反映してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>パッチは最初にカーネルとカーネルモジュールに対して当てられます。
システムがカスタムカーネルを実行している場合には、<a href="https://man.freebsd.org/cgi/man.cgi?query=nextboot&amp;sektion=8&amp;format=html">nextboot(8)</a> を使って次回の再起動時のカーネルを、アップデートされた <span class=filename>/boot/GENERIC</span> に設定してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># nextboot -k GENERIC</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p><span class=filename>GENERIC</span> カーネルで再起動する前に、カーネルにシステムが適切に起動するために必要なすべてのドライバが含まれていること、もしアップデートしているコンピュータがリモートでアクセスしているのであれば、ネットワーク接続に必要なすべてのドライバも含まれていることを確認してください。
特に、これまで実行しているカスタムカーネルが、カーネルモジュールとして提供されているビルドインの機能を含んでいるのであれば、これらのモジュールを一時的に <span class=filename>/boot/loader.conf</span> の機能を用いて、<span class=filename>GENERIC</span> に読み込んでください。
アップグレードプロセスが終わるまでは、重要ではないサービスを無効にするとともに、必要のないディスクやネットワークのマウントなども避けることが推奨されています。</p></div></td></tr></tbody></table></div><div class=paragraph><p>アップデートされたカーネルでコンピュータを再起動してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown -r now</span></code></pre></div></div><div class=paragraph><p>システムがオンラインに戻ったら、以下のコマンドを使って <code>freebsd-update</code> を再び実行してください。
アップデートプロセスの状態は保存されているので、<code>freebsd-update</code> を実行すると、古い共有ライブラリおよびオブジェクトファイルを削除するステップに進みます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>使用しているライブラリのバージョン番号の付けられ方によって、 3 つのインストールフェーズが 2 つになる場合もあります。</p></div></td></tr></tbody></table></div><div class=paragraph><p>アップグレードはこれで終了です。
もしメジャーアップグレードを行った場合には、<a href=#freebsdupdate-portsrebuild>メジャーバージョンアップグレード後の package のアップグレード</a> で説明されているようにすべての ports および package を再構築してください。</p></div><div class=sect3><h4 id=freebsd-update-custom-kernel-9x>16.2.3.1. FreeBSD 9.X 以降のシステムにおけるカスタムカーネル<a class=anchor href=#freebsd-update-custom-kernel-9x></a></h4><div class=paragraph><p><code>freebsd-update</code> を使う前に、<span class=filename>GENERIC</span> カーネルが <span class=filename>/boot/GENERIC</span> に置かれていることを確認してください。
ただ一度だけカスタムカーネルを構築したのであれば、<span class=filename>/boot/kernel.old</span> は <span class=filename>GENERIC</span> カーネルそのものです。
このディレクトリの名前を <span class=filename>/boot/GENERIC</span> へと変更してください。</p></div><div class=paragraph><p>もし、2 回以上カスタムカーネルを構築した後であったり、カスタムカーネルを構築した回数がわからなければ、現在のオペレーティングシステムのバージョンの <span class=filename>GENERIC</span> カーネルを入手してください。
コンピュータへの物理的なアクセスが可能であれば、インストールメディアから <span class=filename>GENERIC</span> カーネルをインストールできます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /cdrom</span>
<span class=c># cd /cdrom/usr/freebsd-dist</span>
<span class=c># tar -C/ -xvf kernel.txz boot/kernel/kernel</span></code></pre></div></div><div class=paragraph><p>別な方法としては、 <span class=filename>GENERIC</span> カーネルをソースから再構築して、 インストールしてください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make kernel __MAKE_CONF=/dev/null SRCCONF=/dev/null</span></code></pre></div></div><div class=paragraph><p><code>freebsd-update</code> がこのカーネルを <span class=filename>GENERIC</span> カーネルとして認識するために、<span class=filename>GENERIC</span> コンフィグレーションファイルは、とにかく変更してはいけません。
また、特別なオプションを指定しないで構築してください。</p></div><div class=paragraph><p><code>freebsd-update</code> は、<span class=filename>/boot/GENERIC</span> が存在する事だけを必要とするので、<span class=filename>GENERIC</span> カーネルで再起動する必要はありません。</p></div></div><div class=sect3><h4 id=freebsdupdate-portsrebuild>16.2.3.2. メジャーバージョンアップグレード後の package のアップグレード<a class=anchor href=#freebsdupdate-portsrebuild></a></h4><div class=paragraph><p>一般的に、マイナーバージョンアップグレードの後では、インストールされているアプリケーションは、問題なく動作するでしょう。
メジャーバージョンが異なるとアプリケーションバイナリーインタフェース (ABI) が異なるため、サードパーティ製のアプリケーションの多くは動作しなくなるでしょう。
メジャーバージョンアップグレード後には、インストールされているすべての packages, ports をアップグレードする必要があります。
package は、<code>pkg upgrade</code> を使ってアップグレードできます。
インストールされている ports をアップグレードする場合には、<a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portmaster/>ports-mgmt/portmaster</a> といったユーティリティを使ってください。</p></div><div class=paragraph><p>すべての package の強制的なアップグレードでは、バージョン番号が上がらない package に対しても、リポジトリから最新のバージョンで、インストールされている package を置き換えます。
FreeBSD のメージャーバージョンが変わるようなアップグレードでは、ABI のバージョンも変わるため、このようなアップグレードが必要になります。
強制的なアップグレードを行うには、以下のように実行してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg-static upgrade -f</span></code></pre></div></div><div class=paragraph><p>インストールされているすべてのアプリケーションを再構築するには、以下のコマンドを実行してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster -af</span></code></pre></div></div><div class=paragraph><p>このコマンドを実行すると、設定を変更するオプションを持つアプリケーションは、設定変更のスクリーンを表示し、ユーザからの指示待ちの状態で停止します。
この振る舞いをやめ、デフォルトのオプションを使用するには、上記のコマンドに <code>-G</code> を含めてください。</p></div><div class=paragraph><p>ソフトウェアのアップグレードが終わったら、最後にもう一度 <code>freebsd-update</code> を実行して、すべてのアップグレードプロセスのやり残し作業を行い、アップグレードのプロセスを完了してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div><div class=paragraph><p><span class=filename>GENERIC</span> カーネルを一時的に読み込んでいたのであれば、<a href=../kernelconfig/#kernelconfig>FreeBSD カーネルのコンフィグレーション</a> に書かれている手順に従って、新しいカスタムを構築し、インストールしてください。</p></div><div class=paragraph><p>コンピュータを再起動し、新しい FreeBSD を立ち上げてください。
これでアップグレードのプロセスは完了です。</p></div></div></div><div class=sect2><h3 id=freebsdupdate-system-comparison>16.2.4. システムの状態の比較<a class=anchor href=#freebsdupdate-system-comparison></a></h3><div class=paragraph><p><code>freebsd-update</code> を用いて、インストールされている FreeBSD の状態と、正しく動作することが分かっている状態とを比較できます。
このコマンドは、現在のシステムのユーティリティ、ライブラリ、設定ファイルを評価するので、組み込みの侵入検知システム (IDS) として使うことができます。</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>このコマンドは、<a class=package href=https://cgit.freebsd.org/ports/tree/security/snort/>security/snort</a> のような本当の IDS の置き換えになるものではありません。
<code>freebsd-update</code> はデータをディスクに保存するので、不正な変更が行われる可能性があります。
<code>kern.securelevel</code> と、<code>freebsd-update</code> のデータを使用しないときに、読み取りのみの許可属性に設定されているファイルシステムに置くことで、不正な変更の可能性を低くできますが、よりよい解決方法は、DVD または安全に保存されている外部 USB ディスクのような安全なディスクとシステムを比較することです。
組み込まれているユーティリティを用いた、別の方法による IDS 機能については、<a href=../security/#security-ids>FreeBSD バイナリによる検出</a> の節をご覧ください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>比較を行うには、 結果の出力先のファイル名を指定してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update IDS &gt;&gt; outfile.ids</span></code></pre></div></div><div class=paragraph><p>システムは検査され、リリースファイルの SHA256 ハッシュ値と現在インストールされているファイルのハッシュ値がファイルの一覧と共に、指定した出力先のファイルに送られます。</p></div><div class=paragraph><p>これらの行は極めて長いのですが、出力形式は簡単にすぐに解析できます。
たとえば、これらのリリースで異なっているすべてのファイルを知りたいのであれば、以下のコマンドを実行してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat outfile.ids | awk &#39;{ print $1 }&#39; | more</span>
/etc/master.passwd
/etc/motd
/etc/passwd
/etc/pf.conf</code></pre></div></div><div class=paragraph><p>上の表示例では出力は切り捨てられており、実際にはもっと多くのファイルが存在します。
これらのファイルには、運用中に変更されるファイルがあります。
たとえば、<span class=filename>/etc/passwd</span> はユーザがシステムに追加されると変更されます。
また、カーネルモジュールは、<code>freebsd-update</code> によりアップデートされるため、変更されます。
このような特別なファイルやディレクトリを除外するには、それらを <span class=filename>/etc/freebsd-update.conf</span> の <code>IDSIgnorePaths</code> オプションに追加してください。</p></div></div></div></div><div class=sect1><h2 id=updating-bootcode>16.3. ブートコードのアップデート<a class=anchor href=#updating-bootcode></a></h2><div class=sectionbody><div class=paragraph><p>ブートコードおよびブートローダのアップデートプロセスについては、
<a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=gptboot&amp;sektion=8&amp;format=html">gptboot(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=gptzfsboot&amp;sektion=8&amp;format=html">gptzfsboot(8)</a> および <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.efi&amp;sektion=8&amp;format=html">loader.efi(8)</a> のマニュアルを参照してください。</p></div></div></div><div class=sect1><h2 id=updating-upgrading-documentation>16.4. ドキュメントのアップデート<a class=anchor href=#updating-upgrading-documentation></a></h2><div class=sectionbody><div class=paragraph><p>ドキュメントは、FreeBSD オペレーティングシステムの必須要素です。
FreeBSD ドキュメントの最新バージョンは、FreeBSD ウェブサイト (<a href=https://docs.FreeBSD.org/>Documentation Portal</a>) から入手できますが、 FreeBSD ウェブサイト、ハンドブック、FAQ および文書の最新版をローカルに用意しておくと便利です。</p></div><div class=paragraph><p>この章では、ソースまたは Ports Collection を使って、ローカルの FreeBSD ドキュメントを最新に保つ方法を説明します。</p></div><div class=paragraph><p>ドキュメントを編集したり、ドキュメントの誤りを報告する方法については、新しい貢献者のための FreeBSD ドキュメンテーションプロジェクト入門 (<a href=https://docs.freebsd.org/en/books/fdp-primer/>FreeBSD Documentation Project Primer</a>) をご覧ください。</p></div><div class=sect2><h3 id=updating-installed-documentation>16.4.1. ソースから FreeBSD ドキュメントをインストールする<a class=anchor href=#updating-installed-documentation></a></h3><div class=paragraph><p>ソースから FreeBSD ドキュメントを構築するのに必要なツールは、FreeBSD のベースシステムには含まれていません。
必要なツールは、新しい貢献者のための FreeBSD ドキュメンテーションプロジェクト入門で <a href=https://docs.freebsd.org/en/books/fdp-primer/#overview-quick-start>説明されているステップ</a> に従ってインストールしてください。</p></div><div class=paragraph><p>インストールしたら、git を使って、ドキュメントのソースをダウンロードしてください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># git clone https://git.FreeBSD.org/doc.git /usr/doc</span></code></pre></div></div><div class=paragraph><p>最初にドキュメントのソースをダウンロードするには少し時間がかかります。
ダウンロードが終わるまでお待ちください。</p></div><div class=paragraph><p>ダウンロードしたドキュメントのソースをアップデートするには、 以下のコマンドを実行してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># git pull</span></code></pre></div></div><div class=paragraph><p>最新のドキュメントのソースのスナップショットを <span class=filename>/usr/doc</span> に用意できたら、インストールされているドキュメントをアップデートする準備はすべて整いました。</p></div><div class=paragraph><p>ドキュメントをアップデートするには、以下のように入力してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc</span>
<span class=c># make</span></code></pre></div></div></div></div></div><div class=sect1><h2 id=current-stable>16.5. 開発ブランチを追いかける<a class=anchor href=#current-stable></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD には二つの開発ブランチがあります。 それは FreeBSD-CURRENT と FreeBSD-STABLE です。</p></div><div class=paragraph><p>この節ではそれぞれのブランチと対象としている読者についての説明と、 どのようにしてシステムの対応するブランチを最新の状態に保つかについて説明します。</p></div><div class=sect2><h3 id=current>16.5.1. FreeBSD-CURRENT を使う<a class=anchor href=#current></a></h3><div class=paragraph><p>FreeBSD-CURRENT とは FreeBSD の開発の "最前線" なので、FreeBSD-CURRENT のユーザは高い技術力を持つことが要求されます。
そこまでの技術力を持っていないが、開発ブランチを追いかけたいと考えているユーザは、かわりに FreeBSD-STABLE を追いかけると良いでしょう。</p></div><div class=paragraph><p>FreeBSD-CURRENT は FreeBSD の最新のソースコードであり、中には現在開発途上のソフトウェア、実験的な変更、あるいは過渡的な機能などが含まれています。
また、この中に入っている機能がすべて、次の公式リリースに入るとは限りません。
FreeBSD-CURRENT をソースからほぼ毎日コンパイルしている人はたくさんいますが、短い期間ではコンパイルさえできない状態になっている時期もあります。
これらの問題は可能な限り迅速に解決されますが、FreeBSD-CURRENT が不幸をもたらすか、それとも新しい機能をもたらすかは、まさにソースコードを同期した瞬間によるのです!</p></div><div class=paragraph><p>FreeBSD-CURRENT は、次の 3 つの重要なグループを対象としています。</p></div><div class="olist arabic"><ol class=arabic><li><p>ソースツリーのある部分に関して活発に作業している FreeBSD コミュニティのメンバ。</p></li><li><p>活発にテストしている FreeBSD コミュニティのメンバ。 彼らは、種々の問題を解決するのに時間を惜しまない人々であり、 さまざまな変更に関する提案や FreeBSD の大まかな方向付けを行ないたいと思っている人々でもあり、 パッチも提出します。</p></li><li><p>さまざまな事に目を向け、 参考のために最新のソースを使いたいと思っていたり、 時々コメントやコードを寄稿したいと考えているユーザ。</p></li></ol></div><div class=paragraph><p>FreeBSD-CURRENT は、次のリリースの前に、最も早く新しい機能を入手する手段として、期待しては<em>いけません</em>。
リリース前の機能は十分にテストされていないため、バグを含んでいる可能性が大いにあるためです。
また、バグを修正するための素早い方法でもありません。
いかなるコミットは、元からあるバグを修正するのと同じく、新しいバグを生み出すおそれがあります。
FreeBSD-CURRENT には "公式のサポート" はありません。</p></div><div class=paragraph><p>FreeBSD-CURRENT を追いかけるには</p></div><div class="olist arabic"><ol class=arabic><li><p><a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT メーリングリスト</a> と <a href=https://lists.FreeBSD.org/subscription/dev-commits-src-main>Commit messages for the main branch of the src repository</a> メーリングリストに加わってください。
さまざまな人がシステムの現在の状態について述べているコメントを見たり、FreeBSD-CURRENT の現在の状態に関する重要な情報を見逃さないために、 <em>必須の</em> ことです。</p><div class=paragraph><p><a href=https://lists.FreeBSD.org/subscription/dev-commits-src-main>Commit messages for the main branch of the src repository</a> メーリングリストでは、それぞれの変更についての commit ログが記録されています。
また、それに関して起こり得る副作用の情報を得ることができますので、参加する価値のあるメーリングリストです。</p></div><div class=paragraph><p>これらのメーリングリストに入るには、 <a href=https://lists.freebsd.org>FreeBSD リストサーバ</a> をたどって参加したいメーリングリストをクリックし、手順の説明にしたがってください。
FreeBSD-CURRENT だけでなく、ソースツリー全体の変更点を追いかけるのであれば、 <a href=https://lists.FreeBSD.org/subscription/dev-commits-src-all>Commit messages for all branches of the src repository</a> メーリングリストを購読してください。</p></div></li><li><p>FreeBSD-CURRENT のソースを同期してください。
通常は <code>git</code> を使って FreeBSD Git リポジトリの <code>main</code> ブランチから -CURRENT コードをチェックアウトしてください (<a href=../mirrors/#git>「Git を使う」</a> を参照してください)。</p></li><li><p>リポジトリのサイズが大きいため、興味のある部分や、パッチを当てる部分のソースのみを同期するユーザもいます。
しかしながら、ソースからオペレーティングシステムをコンパイルしようと思っているユーザは、一部分だけではなく、FreeBSD-CURRENT の <em>すべて</em> をダウンロードする必要があります。</p><div class=paragraph><p>FreeBSD-CURRENT をコンパイルする前に <span class=filename>/usr/src/Makefile</span> を注意深く読み、<a href=#makeworld>ソースを用いた FreeBSD のアップデート</a> に書かれている手順に従ってください。
<a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT メーリングリスト</a> と <span class=filename>/usr/src/UPDATING</span> を読めば、次のリリースへ向けて移ってゆくに当たって、ときどき必要となる既存システムからの新システムの構築手順についての最新情報が得られるでしょう。</p></div></li><li><p>アクティブになってください! FreeBSD-CURRENT のユーザには、 拡張やバグ潰しに関して提案することが勧められています。 コードを伴う提案はいつでも歓迎されます!</p></li></ol></div></div><div class=sect2><h3 id=stable>16.5.2. FreeBSD-STABLE を使う<a class=anchor href=#stable></a></h3><div class=paragraph><p>FreeBSD-STABLE とは定期的に公開されるリリースを作成するための開発ブランチです。
このブランチに加えられる変更は FreeBSD-CURRENT よりゆっくりで、原則として、事前に FreeBSD-CURRENT で試験ずみであるという特徴があります。
ただ<em>そうであっても</em>、これは開発用ブランチの一つであり、ある時点における FreeBSD-STABLE のソースがどんな場合にも使えるものであるとは限りません。
このブランチはもう一つの開発の流れというだけであって、エンドユーザ向けのものではありません。
もし試験をする資源的な余裕がない場合は、代わりに最新の FreeBSD リリースを使ってください。</p></div><div class=paragraph><p>FreeBSD の開発プロセスに興味があったり、それに対する貢献を考えていて、特にそれが次回の FreeBSD のリリースに関係するものであるなら FreeBSD-STABLE を追うことを考えると良いでしょう。</p></div><div class=paragraph><p>FreeBSD-STABLE ブランチはいつもコンパイルができ、安定に動作すべきですが、それが保証されているというわけではありません。
FreeBSD-STABLE のユーザは FreeBSD-CURRENT よりも多いため、FreeBSD-CURRENT で発見されなかったバグが FreeBSD-STABLE で発見され、ときどきそれが問題となることがあるのは避けることができません。
このような理由から、盲目的に FreeBSD-STABLE を追いかけるべきではありません。
特に、開発環境もしくはテスト環境でコードを十分に試験せずに、プロダクション品質が要求されるサーバを FreeBSD-STABLE にアップグレードしては<em>いけません</em>。</p></div><div class=paragraph><p>FreeBSD-STABLE を追いかけるには</p></div><div class="olist arabic"><ol class=arabic><li><p>FreeBSD-STABLE の構築に関連する事柄や、その他の注意すべき点 に関する情報を得るために、 <a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; メーリングリスト</a> メーリングリストに加わってください。
また開発者は議論の余地がある修正や変更を考えている場合に、このメーリングリストで公表し、提案された変更に関して問題が生じるかどうかを返答する機会をユーザに与えます。</p><div class=paragraph><p>追いかけているブランチに関連する git メーリングリストに参加してください。
たとえば、14-STABLE ブランチを追いかけているユーザは <a href=https://lists.FreeBSD.org/subscription/dev-commits-src-branches>Commit messages for the stable branches of the src repository</a> メーリングリストに参加してください。
このリストでは、変更がなされるごとに作成される commit log やそれに伴う起こりうる副作用についての情報が記録されています。</p></div><div class=paragraph><p>これらのメーリングリストに入るには、 <a href=https://lists.freebsd.org>FreeBSD リストサーバ</a> をたどって参加したいメーリングリストをクリックし、手順の説明にしたがってください。
ソースツリー全体の変更点を追いかけるには、 <a href=https://lists.FreeBSD.org/subscription/dev-commits-src-all>Commit messages for all branches of the src repository</a> メーリングリストを購読してください。</p></div></li><li><p>新しい FreeBSD-STABLE システムをインストールするには、 <a href=../mirrors/#mirrors>ミラーサイト</a> から最近の FreeBSD-STABLE リリースをインストールするか、毎月公開されている FreeBSD-STABLE からビルドされたスナップショットを使ってください。
スナップショットの詳細については、<a href=https://www.FreeBSD.org/ja/snapshots/>www.freebsd.org/ja/snapshots</a> をご覧ください。</p><div class=paragraph><p>既に FreeBSD が動いているシステムを FreeBSD-STABLE にアップグレードするには、<code>git</code> を使って、希望する開発ブランチのソースをチェックアウしてください。
<code>stable/9</code> といったブランチ名は、<a href=https://www.FreeBSD.org/releng/>www.freebsd.org/releng</a> で説明されています。</p></div></li><li><p>FreeBSD-STABLE をコンパイルしたり FreeBSD-STABLE へとアップグレードする前に、 <span class=filename>/usr/src/Makefile</span> を注意深く読み、 <a href=#makeworld>ソースを用いた FreeBSD のアップデート</a> に書かれている手順に従ってください。
<a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; メーリングリスト</a> と <span class=filename>/usr/src/UPDATING</span> を読んで、次のリリースへ向けて移ってゆくに当たって、ときどき必要となる既存システムからの新システムの構築手順についての最新情報を得てください。</p></li></ol></div></div><div class=sect2><h3 id=translate-n-number>16.5.3. n-番号<a class=anchor href=#translate-n-number></a></h3><div class=paragraph><p>バグを追跡する際は、問題が発生したシステムの構築に用いられたソースコードのバージョンを把握することが重要となります。
FreeBSD は、バージョン情報をカーネルのコンパイル時に埋め込みます。
<a href="https://man.freebsd.org/cgi/man.cgi?query=uname&amp;sektion=1&amp;format=html">uname(1)</a> を使ってこの情報を調べることができます。以下はその例です。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>uname</span> <span class=nt>-v</span>
FreeBSD 14.0-CURRENT <span class=c>#112 main-n247514-031260d64c18: Tue Jun 22 20:43:19 MDT 2021     fred@machine:/usr/home/fred/obj/usr/home/fred/git/head/amd64.amd64/sys/FRED</span></code></pre></div></div><div class=paragraph><p>最後のフィールドから、カーネル名、ビルドを行ったユーザ、およびコンパイルを行った場所がわかります。
また、4 番目のフィールドは、いくつかの要素から構成されていることがわかります。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>main-n247514-031260d64c18

main		<i class=conum data-value=1></i><b>(1)</b>
n247514		<i class=conum data-value=2></i><b>(2)</b>
031260d64c18	<i class=conum data-value=3></i><b>(3)</b>
		<i class=conum data-value=4></i><b>(4)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Git ブランチ名。
注意: n-番号の比較は、FreeBSD プロジェクトで作成されたブランチ
(<code>main</code>, <code>stable/XX</code> および <code>releng/XX</code>) でのみ有効です。
ローカルブランチでは、親ブランチのコミットと n-番号が重複してしまいます。</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>n-番号は、ハッシュ値が含まれるようになった git リポジトリの使用開始からのコミットを数えたものです。</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>チェックアウトしたツリーのハッシュ値。</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td><code>-dirty</code> が表示されることがあります。
変更点がコミットされていないツリーでカーネルが構築された場合に表示されます。
この例では、チェックアウトから変更なく FRED カーネルが構築されたため、出力されていません。</td></tr></tbody></table></div><div class=paragraph><p><code>git rev-list</code> コマンドを使って、ハッシュ値に対応する n-番号を調べることができます。
以下はその例です。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% git rev-list <span class=nt>--first-parent</span> <span class=nt>--count</span> 031260d64c18 <i class=conum data-value=1></i><b>(1)</b>
247514 <i class=conum data-value=2></i><b>(2)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>変換する git ハッシュ値 (ここでは先の例のハッシュ値を使用しています)</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>n-番号</td></tr></tbody></table></div><div class=paragraph><p>この数字は通常それほど重要ではありません。
しかしながら、バグの修正がコミットされた時には、この数字を使うことで、使用しているシステムでバグが修正されているかどうかを簡単に調べることができます。
ハッシュ値は簡単に目にする識別子である一方で n-番号はそうではありません。
そのため、開発者は通常 n-番号ではなくコミットのハッシュ値
(または、ハッシュ値を含む URL) を参照します。
セキュリティ勧告および errata 情報では n-番号が示されており、使用しているシステムの番号と直接比較できます。
<code>git rev-list</code> コマンドは、レポジトリのリビジョンをすべてカウントしますが、git の shallow clone はその情報を取得しないため、shallow clone を使用しなければならない場合には、n-番号は信頼できません。</p></div></div></div></div><div class=sect1><h2 id=makeworld>16.6. ソースを用いた FreeBSD のアップデート<a class=anchor href=#makeworld></a></h2><div class=sectionbody><div class=paragraph><p>ソースをコンパイルしてFreeBSD をアップデートする方法は、 バイナリを用いたアップデートに比べ、いくつもの利点があります。 特定のハードウェアをうまく利用するためのオプションを設定してコードを構築できます。
ベースシステムの特定の箇所の設定をデフォルトの設定から変更したり、必要がない部分を完全に削除して構築することもできます。
システムを構築することによるアップデートは、バイナリアップデートをインストールするだけのアップデートに比べ時間がかかりますが、利用環境に合わせた FreeBSD を作成するような完全なカスタマイズが可能です。</p></div><div class=sect2><h3 id=updating-src-quick-start>16.6.1. クィックスタート<a class=anchor href=#updating-src-quick-start></a></h3><div class=paragraph><p>以下は FreeBSD をソースから構築してアップデートする典型的な方法についてのクイックリファレンスです。
その後の節では、各プロセスをより詳細に説明します。</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> から <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> に移行する際に、初めて <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> を実行すると、変更点が不適切にマージされ、衝突が起きてしまうことがあります。
これを避けるには、ソースを更新して新しく buildworld を行う <strong>前に</strong> 以下のステップを行ってください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># etcupdate extract </span><i class=conum data-value=1></i><b>(1)</b>
<span class=c># etcupdate diff </span><i class=conum data-value=2></i><b>(2)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td><span class=filename>/etc</span> ファイルを保存するデータベースをブートストラップしてください。
詳細については、 <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> を参照してください。</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>ブートストラップ後、差分を確認してください。
不必要なローカルでの変更点をなくし、将来的なアップデートにおいて、衝突が起きる可能性が低くなるようにしてください。</td></tr></tbody></table></div></td></tr></tbody></table></div><div class="exampleblock procedure"><div class=content><div class=ulist><ul><li><p>アップデートおよびビルド</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># git pull /usr/src  </span><i class=conum data-value=1></i><b>(1)</b>
/usr/src/UPDATING の確認 <i class=conum data-value=2></i><b>(2)</b>
<span class=c># cd /usr/src          </span><i class=conum data-value=3></i><b>(3)</b>
<span class=c># make -j4 buildworld  </span><i class=conum data-value=4></i><b>(4)</b>
<span class=c># make -j4 kernel      </span><i class=conum data-value=5></i><b>(5)</b>
<span class=c># shutdown -r now      </span><i class=conum data-value=6></i><b>(6)</b>
<span class=c># etcupdate -p         </span><i class=conum data-value=7></i><b>(7)</b>
<span class=c># cd /usr/src          </span><i class=conum data-value=8></i><b>(8)</b>
<span class=c># make installworld    </span><i class=conum data-value=9></i><b>(9)</b>
<span class=c># etcupdate -B         </span><i class=conum data-value=10></i><b>(10)</b>
<span class=c># shutdown -r now      </span><i class=conum data-value=11></i><b>(11)</b></code></pre></div></div></li></ul></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>最新版のソースを入手してください。 ソースの入手およびアップデートに関する情報については <a href=#updating-src-obtaining-src>ソースコードのアップデート</a> をご覧ください。</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>ソースの構築の前後で必要となる手動の作業について、 <span class=filename>/usr/src/UPDATING</span> を確認してください。</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>ソースが置かれているディレクトリに移動してください。</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>world (カーネルを除くすべて) をコンパイルしてください。</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>カーネルをコンパイルしてインストールしてください。 ここに書かれているコマンドは、<code>make buildkernel installkernel</code> と同じです。</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>新しいカーネルを使うため、 システムを再起動してください。</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>installworld を行う前に、<span class=filename>/etc/</span> に置かれている設定ファイルのアップデートとマージを行ってください。</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>ソースが置かれているディレクトリに移動してください。</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>world をインストールしてください。</td></tr><tr><td><i class=conum data-value=10></i><b>10</b></td><td><span class=filename>/etc/</span> に置かれている設定ファイルのアップデートとマージを行ってください。</td></tr><tr><td><i class=conum data-value=11></i><b>11</b></td><td>新しく構築された world およびカーネルを利用するため、 システムを再起動してください。</td></tr></tbody></table></div></div></div></div><div class=sect2><h3 id=updating-src-preparing>16.6.2. ソースを用いたアップデートのための準備<a class=anchor href=#updating-src-preparing></a></h3><div class=paragraph><p><span class=filename>/usr/src/UPDATING</span> を読んでください。 このファイルには、 アップデートの前後で必要となる手動の作業について書かれています。</p></div></div><div class=sect2><h3 id=updating-src-obtaining-src>16.6.3. ソースコードのアップデート<a class=anchor href=#updating-src-obtaining-src></a></h3><div class=paragraph><p>FreeBSD のソースコードは <span class=filename>/usr/src/</span> に置かれています。
このソースコードのアップデートには、Git バージョン管理システムを利用する方法が推奨されています。
まず、ソースコードがバージョン管理下にあることを確認してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># git remote --v</span>
origin  https://git.freebsd.org/src.git <span class=o>(</span>fetch<span class=o>)</span>
origin  https://git.freebsd.org/src.git <span class=o>(</span>push<span class=o>)</span></code></pre></div></div><div class=paragraph><p>この結果は、<span class=filename>/usr/src/</span> がバージョン管理下にあり、<a href="https://man.freebsd.org/cgi/man.cgi?query=git&amp;sektion=1&amp;format=html">git(1)</a> を使ってアップデートできることを示しています。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># git pull /usr/src</span></code></pre></div></div><div class=paragraph><p>このディレクトリをアップデートしていない期間が長いと、アップデートのプロセスには時間がかかります。
このプロセスが終わると、ソースコードは最新となり、次節以降で説明する構築のプロセスを実行できます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=title>ソースコードの入手</div><div class=paragraph><p><code>fatal: not a git repository</code> と出力された場合には、ファイルがなかったり、別な方法によりインストールされているので、新しくソースコードをチェックアウトする必要があります。</p></div><table id=updating-src-obtaining-src-repopath class="tableblock frame-all grid-all stretch"><caption class=title>表 1. FreeBSD のバージョンおよびリポジトリブランチ</caption><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">uname -r の出力</th><th class="tableblock halign-left valign-top">リポジトリパス</th><th class="tableblock halign-left valign-top">説明</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code><em>X.Y</em>-RELEASE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>releng/<em>X.Y</em></code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>このリリースバージョンに対する重大なセキュルティへの対応およびバグの修正パッチのみが適用されています。 このブランチは、ほとんどのユーザに推奨されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code><em>X.Y</em>-STABLE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>stable/<em>X</em></code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>リリースバージョンに対し、そのブランチにおけるすべての開発の成果が反映されたものです。
<em>STABLE</em> では、Applications Binary Interface (ABI) は変更されないため、このブランチのシステムであれば、以前のバージョンでコンパイルされたソフトウェアを実行できます。
たとえば、FreeBSD 10.1 で実行するようにコンパイルされたソフトウェアは、その後構築された FreeBSD 10-STABLE 上でも実行できます。</p><p class=tableblock>STABLE ブランチは、 時期によってはユーザに影響するようなバグや非互換性を持つことがあります。 これらは通常すぐに修正されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code><em>X</em>-CURRENT</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>main</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>リリースが行われていない最新の FreeBSD の開発バージョンです。 CURRENT ブランチは大きなバグや非互換があることもあるので、 高度な知識を持ったユーザのみ使用が推奨されます。</p></td></tr></tbody></table><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=uname&amp;sektion=1&amp;format=html">uname(1)</a> を使って FreeBSD のバージョンを確認してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># uname -r</span>
10.3-RELEASE</code></pre></div></div><div class=paragraph><p><a href=#updating-src-obtaining-src-repopath>FreeBSD のバージョンおよびリポジトリブランチ</a> から分かるように、<code>10.3-RELEASE</code> のアップデートのためのソースコードのパスは、<code>releng/10.3</code> です。
このパスは、ソースコードをチェックアウトする時に使います。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mv /usr/src /usr/src.bak  </span><i class=conum data-value=1></i><b>(1)</b>
<span class=c># git clone --branch releng/10.3 https://git.FreeBSD.org/src.git /usr/src </span><i class=conum data-value=2></i><b>(2)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>この古いディレクトリを、 邪魔にならないように移動してください。 このディレクトリ以下に対して変更を行ってなければ、 削除しても構わないでしょう。</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>リポジトリの URL に <a href=#updating-src-obtaining-src-repopath>FreeBSD のバージョンおよびリポジトリブランチ</a> に記載されているパスを追加します。 3 番目のパラメータには、 ローカルシステム上でソースコードが置かれるディレクトリを指定します。</td></tr></tbody></table></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=updating-src-building>16.6.4. ソースからの構築<a class=anchor href=#updating-src-building></a></h3><div class=paragraph><p>まず最初に <em>world</em> (カーネルを除くオペレーティングシステムのすべて) をコンパイルします。
このステップを最初に実行するのは、カーネルの構築を最新のツールを使って行うようにするためです。
このステップが終わったら、カーネルそのものを構築します。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make buildworld</span>
<span class=c># make buildkernel</span></code></pre></div></div><div class=paragraph><p>コンパイルされたコードは <span class=filename>/usr/obj</span> に書き出されます。</p></div><div class=paragraph><p>これは基本のステップです。
構築をコントロールする追加のオプションについては、 以下で説明します。</p></div><div class=sect3><h4 id=updating-src-building-clean-build>16.6.4.1. クリーンビルドの実行<a class=anchor href=#updating-src-building-clean-build></a></h4><div class=paragraph><p>FreeBSD ビルドシステムのいくつかのバージョンは、オブジェクトが一時的に置かれるディレクトリ <span class=filename>/usr/obj</span> に前回のコンパイルされたコードを残します。
これにより、変更されていないコードを再コンパイルせずにすむので、その後の構築時間を短縮できます。
すべてを再構築するには、構築を開始する前に、<code>cleanworld</code> を実行してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make cleanworld</span></code></pre></div></div></div><div class=sect3><h4 id=updating-src-building-jobs>16.6.4.2. ジョブの数の設定<a class=anchor href=#updating-src-building-jobs></a></h4><div class=paragraph><p>マルチコアプロセッサを搭載するシステムでは、構築のためのジョブの数を増やすことで、構築にかかる時間を短縮できます。
<code>sysctl hw.ncpu</code> を使って、コアの数を確認してください。
ジョブの数がどのように構築の速さに影響するかを確実に知るには、プロセッサにより異なりますし、FreeBSD のバージョンにより使用されるビルドシステムも変わるため、実際に試してみるしか方法はありません。
試してみる最初のジョブの数の候補としては、コアの数の半分から倍の数の間で検討してみてください。
ジョブの数は、<code>-j</code> を使って指定します。</p></div><div id=updating-src-building-jobs-example class=exampleblock><div class=title>例 1. 構築のジョブの数を増やす</div><div class=content><div class=paragraph><p>以下は 4 つのジョブで world とカーネルを構築する例です。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -j4 buildworld buildkernel</span></code></pre></div></div></div></div></div><div class=sect3><h4 id=updating-src-building-only-kernel>16.6.4.3. カーネルのみを構築する<a class=anchor href=#updating-src-building-only-kernel></a></h4><div class=paragraph><p>ソースコードが変更された場合には、<code>buildworld</code> を完了しなければいけません。
その後、いつでも <code>buildkernel</code> でカーネルを構築できます。
カーネルだけを構築するには、以下のように実行してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make buildkernel</span></code></pre></div></div></div><div class=sect3><h4 id=updating-src-building-custom-kernel>16.6.4.4. カスタムカーネルの構築<a class=anchor href=#updating-src-building-custom-kernel></a></h4><div class=paragraph><p>FreeBSD 標準のカーネルは、<span class=filename>GENERIC</span> と呼ばれる <em>カーネルコンフィグレーションファイル</em> に基づいています。
<span class=filename>GENERIC</span> カーネルには、最も良く使われるデバイスドライバやオプションが含まれています。
しかしながら、特定の目的に合わせてデバイスドライバやオプションを削除したり追加するためには、カスタムカーネルを構築することが有用であったり、必要となることがあります。</p></div><div class=paragraph><p>たとえば、極端に RAM が制限されているような小さな組み込みのコンピュータを開発しているユーザであれば、 必要のないデバイスドライバやオプションを削除することで、 カーネルを少しでも小さくできるでしょう。</p></div><div class=paragraph><p>カーネルのコンフィグレーションファイルは、 <span class=filename>/usr/src/sys/arch/conf/</span> に置かれています。ここで、 <em>arch</em> は <code>uname -m</code> の出力です。 ほとんどのコンピュータは <code>amd64</code> であり、 コンフィグレーションファイルが置かれているディレクトリは <span class=filename>/usr/src/sys/amd64/conf/</span> です。</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p><span class=filename>/usr/src</span> は、削除されたり作り直されたりする可能性があるため、カスタムカーネルのコンフィグレーションファイルは、<span class=filename>/root</span> のような別のディレクトリで管理することが好ましいです。
カーネルコンフィグレーションファイルは、<span class=filename>conf</span> ディレクトリにリンクします。
このディレクトリが削除されたり、上書きされた場合には、カーネルコンフィグレーションファイルを新しいディレクトリにもう一度リンクしてください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>カスタムコンフィグレーションファイルは、<span class=filename>GENERIC</span> コンフィグレーションファイルをコピーして作成できます。
たとえば、ストレージサーバ用の <span class=filename>STORAGESERVER</span> という名前の新しいカスタムカーネルは、以下のようにして作成できます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp /usr/src/sys/amd64/conf/GENERIC /root/STORAGESERVER</span>
<span class=c># cd /usr/src/sys/amd64/conf</span>
<span class=c># ln -s /root/STORAGESERVER .</span></code></pre></div></div><div class=paragraph><p>その後 <span class=filename>/root/STORAGESERVER</span> を編集し、 <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=5&amp;format=html">config(5)</a> で示されるデバイスやオプションを追加したり削除してください。</p></div><div class=paragraph><p>コマンドラインからカーネルコンフィグレーションファイルを <code>KERNCONF</code> に指定することで、 カスタムカーネルを構築できます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make buildkernel KERNCONF=STORAGESERVER</span></code></pre></div></div></div></div><div class=sect2><h3 id=updating-src-installing>16.6.5. コンパイルされたコードのインストール<a class=anchor href=#updating-src-installing></a></h3><div class=paragraph><p><code>buildworld</code> および <code>buildkernel</code> が完了したら、 新しいカーネルと world をインストールしてください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make installkernel</span>
<span class=c># shutdown -r now</span>
<span class=c># cd /usr/src</span>
<span class=c># make installworld</span>
<span class=c># shutdown -r now</span></code></pre></div></div><div class=paragraph><p>カスタムカーネルを構築した場合は、 新しいカスタムカーネルを <code>KERNCONF</code> に設定して実行してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make installkernel KERNCONF=STORAGESERVER</span>
<span class=c># shutdown -r now</span>
<span class=c># cd /usr/src</span>
<span class=c># make installworld</span>
<span class=c># shutdown -r now</span></code></pre></div></div></div><div class=sect2><h3 id=updating-src-completing>16.6.6. アップデートの完了<a class=anchor href=#updating-src-completing></a></h3><div class=paragraph><p>アップデートの完了までに、いくつかの最終作業が残されています。
デフォルトから変更した設定ファイルを新しいバージョンのファイルにマージし、古くなったライブラリを見つけて削除した後に、システムを再起動します。</p></div><div class=sect3><h4 id=updating-src-completing-merge-etcupdate>16.6.6.1. <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> を用いた設定ファイルのマージ<a class=anchor href=#updating-src-completing-merge-etcupdate></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> は、<span class=filename>/etc/</span> 以下のファイルのように installworld のプロセスで更新されないファイルをアップデートするツールです。
このツールは、ローカルにあるファイルに対する変更点を 3-way マージでアップデートします。
<a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> の対話的なプロンプトと対照的に、このツールはユーザによる操作を最小限になるように設計されています。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>一般的に、<a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> は、実行する際に特定の引数を必要としません。
しかしながら、<a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> を最初に使用した際に、どのようなアップデートが行われたかの健全性をチェックする便利なコマンドがあります。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># etcupdate diff</span></code></pre></div></div><div class=paragraph><p>このコマンドにより、ユーザは設定の変更を検証できます。</p></div></td></tr></tbody></table></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> が自動的にファイルをマージできない場合には、
以下を実行することで、手動の操作により衝突を解決できます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># etcupdate resolve</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> から <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> に移行する際に、
最初に <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> を実行すると、不適切に変更点がマージされ、誤った衝突が起こる可能性があります。
これを避けるには、ソースを更新して新しく buildworld を行う <strong>前に</strong> 以下のステップを行ってください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># etcupdate extract </span><i class=conum data-value=1></i><b>(1)</b>
<span class=c># etcupdate diff </span><i class=conum data-value=2></i><b>(2)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td><span class=filename>/etc</span> ファイルを保存するデータベースをブートストラップしてください。
詳細については、 <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> を参照してください。</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>ブートストラップ後、差分を確認してください。
不必要なローカルでの変更点をなくし、将来的なアップデートにおいて、衝突が起きる可能性が低くなるようにしてください。</td></tr></tbody></table></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=updating-src-completing-merge-mergemaster>16.6.6.2. <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> を用いた設定ファイルのマージ<a class=anchor href=#updating-src-completing-merge-mergemaster></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> を用いることで、システムの設定ファイルに行われている変更を、これらのファイルの新しいバージョンにマージできます。
<a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> は、設定ファイルのアップデートで推奨されている <a href="https://man.freebsd.org/cgi/man.cgi?query=etcupdate&amp;sektion=8&amp;format=html">etcupdate(8)</a> の代価のツールです。
<code>-Ui</code> オプションを使って <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> を実行すると、 ユーザが手を加えていないファイルのアップデートおよび新しく追加されたファイルのインストールを自動的に行います。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mergemaster -Ui</span></code></pre></div></div><div class=paragraph><p>ファイルのマージを手動で行う必要がある時は、ファイルの中で残す箇所の選択を対話的におこなうようなインタフェースが表示さます。
詳細については、<a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> をご覧ください。</p></div></div><div class=sect3><h4 id=updating-src-completing-check-old>16.6.6.3. 使われなくなったファイルやライブラリの確認<a class=anchor href=#updating-src-completing-check-old></a></h4><div class=paragraph><p>アップデート後に、使われなくなったファイルやディレクトリが残ることがあります。
これらのファイルは、</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make check-old</span></code></pre></div></div><div class=paragraph><p>で確認でき、以下のようにして削除できます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make delete-old</span></code></pre></div></div><div class=paragraph><p>同様に使われなくなったライブラリが残ることもあります。 これらのライブラリは、</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make check-old-libs</span></code></pre></div></div><div class=paragraph><p>で確認でき、以下のようにして削除できます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make delete-old-libs</span></code></pre></div></div><div class=paragraph><p>これらの古いライブラリを利用しているプログラムは、ライブラリが削除されると動かなくなります。
これらのプログラムは、古いライブラリを削除した後に、再構築もしくは置き換える必要があります。</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>古いファイルとディレクトリのすべてを削除しても問題ないことを確認したら、コマンドに <code>BATCH_DELETE_OLD_FILES</code> を設定することで、各ファイルを削除する際に <kbd>y</kbd> および <kbd>Enter</kbd> を押さなくても済むようにできます。
以下はその例です。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make BATCH_DELETE_OLD_FILES=yes delete-old-libs</span></code></pre></div></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=updating-src-completing-restart>16.6.6.4. アップデート後の再起動<a class=anchor href=#updating-src-completing-restart></a></h4><div class=paragraph><p>コンピュータを再起動して、すべての変更を反映させることが、 アップデートの最後におこなう作業です。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown -r now</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=small-lan>16.7. 複数のマシンで追いかける<a class=anchor href=#small-lan></a></h2><div class=sectionbody><div class=paragraph><p>複数のコンピュータで同じソースツリーを追いかけていて、全部のマシンにソースをダウンロードして全部を再構築するのは、ディスクスペース、ネットワーク帯域、そして CPU サイクルの無駄使いです。
解決策は 1 つのマシンに仕事のほとんどをさせ、残りのマシンは NFS 経由でそれをマウントする、というものです。
このセクションではそのやり方を概観します。NFS の使い方の詳細については、<a href=../advanced-networking/#network-nfs>「NFS」</a> をご覧下さい。</p></div><div class=paragraph><p>まず初めに、同じバイナリで動かそうとするマシンたちを決めます。
このマシンたちのことを<em>ビルドセット</em>と呼びます。
それぞれのマシンはカスタムカーネルを持っているかもしれませんが、同じユーザランドバイナリを動かそうというのです。
このビルドセットから、 <em>ビルドマシン</em>となるマシンを 1 台選びます。
ベースシステムとカーネルを構築するのはこのマシンになります。
理想的には、このマシンは <code>make buildworld</code> と <code>make buildkernel</code> を実行するのに十分な CPU を持った速いマシンであるべきです。</p></div><div class=paragraph><p><em>テストマシン</em> となるべきマシンも選んでください。
更新されたソフトウェアを使う前にそのマシンでテストするのです。
テストマシンはかなり長い時間落ちていても だいじょうぶなマシン<em>であったほうがいいでしょう</em>。
ビルドマシンでもかまいませんが、ビルドマシンである必要はありません。</p></div><div class=paragraph><p>このビルドセットのマシンはすべて <span class=filename>/usr/obj</span> と <span class=filename>/usr/src</span> をビルドマシンから FTP 経由でマウントする必要があります。
ビルドセット自体が複数ある場合は、<span class=filename>/usr/src</span> はひとつのビルドマシン上にあるべきです。
他のマシンからはそれを NFS マウントするようにしましょう。</p></div><div class=paragraph><p>ビルドセットのすべてのマシン上の <span class=filename>/etc/make.conf</span> と <span class=filename>/etc/src.conf</span> がビルドマシンと一致していることを確認してください。
つまり、ビルドマシンはビルドセットのどのマシンもインストールしようとしているベースシステムを全部ビルドしなければならないということです。
また、各ビルドマシンは <span class=filename>/etc/make.conf</span> にそれぞれのビルドマシンのカーネル名を <code>KERNCONF</code> で指定し、ビルドマシンは自分自身のカーネルから順に全部のカーネル名を <code>KERNCONF</code> にリストアップしてください。
ビルドマシンは各マシンのカーネル設定ファイルを <span class=filename>/usr/src/sys/arch/conf</span> に持っていなければなりません。</p></div><div class=paragraph><p>ビルドマシンにて、<a href=#makeworld>ソースを用いた FreeBSD のアップデート</a> に書いてあるようにカーネルとベースシステムを構築してください。
でも、まだビルドマシンにはインストールしないでください。
そのかわり、ビルドしたカーネルをテストマシンにインストールしてください。
FTP 経由で <span class=filename>/usr/src</span> および <span class=filename>/usr/obj</span> をテストマシンにマウントしてください。
その後、<code>shutdown now</code> を実行してシングルユーザモードに移行し、新しいカーネルとベースシステムをインストールし、いつもするように <code>mergemaster</code> を実行してください。
終わったら、再起動して通常のマルチユーザ動作に戻します。</p></div><div class=paragraph><p>テストマシンにあるものすべてがちゃんと動いている確信が得られたら、同じ手順でビルドセットの他のマシンにも新しいソフトウェアをインストールします。</p></div><div class=paragraph><p>ports ツリーにも同じ方法が使えます。
最初のステップは、ビルドセットのすべてのマシンが NFS 経由で <span class=filename>/usr/ports</span> をマウントすることです。
そして、distfiles を共有するように <span class=filename>/etc/make.conf</span> を設定します。
NFS マウントによってマップされる <code>root</code> ユーザが何であれ、<code>DISTDIR</code> はそのユーザが書き込める共通の共有ディレクトリに設定する必要があります。
ports をローカルでビルドする場合には、各マシンは <code>WRKDIRPREFIX</code> を自分のマシンのビルドディレクトリに設定しなければなりません。
また、ビルドシステムが packages をビルドしてビルドセットのコンピュータに配布するのであれば、<code>DISTDIR</code> と同じようにビルドシステム上の <code>PACKAGES</code> ディレクトリも設定してください。</p></div></div></div></div><hr><div class=last-modified><p><strong>最終更新日</strong>: 2024年3月9日 by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=http://172.16.201.134:1313/ja/books/handbook/l10n class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=http://172.16.201.134:1313/ja/books/handbook/partiv class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#updating-upgrading-synopsis>16.1. この章では</a></li><li><a href=#updating-upgrading-freebsdupdate>16.2. FreeBSD Update</a></li><li><a href=#updating-bootcode>16.3. ブートコードのアップデート</a></li><li><a href=#updating-upgrading-documentation>16.4. ドキュメントのアップデート</a></li><li><a href=#current-stable>16.5. 開発ブランチを追いかける</a></li><li><a href=#makeworld>16.6. ソースを用いた FreeBSD のアップデート</a></li><li><a href=#small-lan>16.7. 複数のマシンで追いかける</a></li></ul></nav><hr><div class=resources><h3>リソース</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="PDF 版のダウンロード"></i><a href=https://download.freebsd.org/doc/ja/books/handbook/handbook_ja.pdf>PDF 版のダウンロード</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/ja/_index target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/ja/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Choose language">
<span>日本語</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/ja class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/ja/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>