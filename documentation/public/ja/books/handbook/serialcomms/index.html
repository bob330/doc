<!doctype html><html class=theme-light lang=ja><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/><title>第17章 シリアル通信 | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="第17章 シリアル通信"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="ja"><meta property="og:url" content="http://172.16.201.134:1313/ja/books/handbook/serialcomms/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/ja\/books\/handbook\/serialcomms\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/ja>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/ja/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/ja/books>Books</a></li><li><a href=http://172.16.201.134:1313/ja/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/ja/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=ja>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/preface/>前書き</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-audience>想定している読者</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-changes-from3>第 3 版からの変更</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-changes-from2>第 2 版 (2004) からの変更</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-changes>第 1 版 (2001) からの変更</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-overview>この文書の構成</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-conv>この文書で用いられている表記法</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/preface/#preface-acknowledgements>謝辞</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/parti/>パートI. 導入</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/introduction/>第1章 はじめに</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/introduction/#introduction-synopsis>1.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/introduction/#nutshell>1.2. FreeBSD へようこそ!</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/introduction/#history>1.3. FreeBSD プロジェクトについて</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/>第2章 FreeBSD のインストール</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-synopsis>2.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-hardware>2.2. 最小ハードウェア要件</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-pre>2.3. インストール前に行う作業</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-start>2.4. インストールの開始</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#using-bsdinstall>2.5. bsdinstall の使用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-partitioning>2.6. ディスク領域の割り当て</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-fetching-distribution>2.7. 配布ファイルのダウンロード</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-post>2.8. ネットワークインターフェース、アカウント、タイムゾーン、 サービスおよびセキュリティオプションの設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#bsdinstall-install-trouble>2.9. トラブルシューティング</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bsdinstall/#using-live-cd>2.10. Live CD を使う</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/basics/>第3章 FreeBSD の基礎知識</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#basics-synopsis>3.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#consoles>3.2. 仮想コンソールと端末</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#users-synopsis>3.3. ユーザと基本的なアカウント管理</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#permissions>3.4. 許可属性</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#dirstructure>3.5. ディレクトリ構造</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#disk-organization>3.6. ディスク構成</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#mount-unmount>3.7. ファイルシステムのマウントとアンマウント</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#basics-processes>3.8. プロセスおよびデーモン</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#shells>3.9. シェル</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#editors>3.10. テキストエディタ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#basics-devices>3.11. デバイスとデバイスノード</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/basics/#basics-more-information>3.12. マニュアルページ</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/ports/>第4章 アプリケーションのインストール - packages と ports</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-synopsis>4.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-overview>4.2. ソフトウェアのインストール</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-finding-applications>4.3. ソフトウェアの探し方</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#pkgng-intro>4.4. pkg によるバイナリ package の管理</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-using>4.5. Ports Collection の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-poudriere>4.6. Poudriere を用いた package の構築</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-nextsteps>4.7. インストール後の作業</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ports/#ports-broken>4.8. うまく動作しない ports に遭遇した場合には</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/x11/>第5章 X Window System</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x11-synopsis>5.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-understanding>5.2. 用語の説明</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-install>5.3. Xorg のインストール</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-config>5.4. Xorg の設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-fonts>5.5. Xorg でのフォントの使用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-xdm>5.6. X ディスプレイマネージャ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x11-wm>5.7. デスクトップ環境</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x-compiz-fusion>5.8. Compiz Fusion のインストール</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/x11/#x11-troubleshooting>5.9. トラブルシューティング</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/partii/>パートII. 日々の生活</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/>第6章 デスクトップアプリケーション</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/#desktop-synopsis>6.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/#desktop-browsers>6.2. ブラウザ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/#desktop-productivity>6.3. 生産的なアプリケーション</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/#desktop-viewers>6.4. ドキュメントビューア</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/desktop/#desktop-finance>6.5. 財務管理ソフトウェア</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/>第7章 マルチメディア</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#multimedia-synopsis>7.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#sound-setup>7.2. サウンドカードの設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#sound-mp3>7.3. MP3 オーディオ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#video-playback>7.4. ビデオ再生</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#tvcard>7.5. TV カードの設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#mythtv>7.6. MythTV</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/multimedia/#scanners>7.7. 画像スキャナ</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/>第8章 FreeBSD カーネルのコンフィグレーション</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-synopsis>8.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-custom-kernel>8.2. なぜカスタムカーネルを作るか?</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-devices>8.3. システムのハードウェアについて知る</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-config>8.4. コンフィグレーションファイル</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-building>8.5. カスタムカーネルの構築とインストール</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/kernelconfig/#kernelconfig-trouble>8.6. 問題が起きた場合には</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/printing/>第9章 プリンタの利用</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-synopsis>9.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-intro-spooler>9.2. はじめに</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-intro-setup>9.3. 基本的な設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-advanced>9.4. プリンタ設定上級編</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-using>9.5. プリンタを使う</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-lpd-alternatives>9.6. 標準スプーラの代替品</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/printing/#printing-troubleshooting>9.7. トラブルシューティング</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/linuxemu/>第10章 Linux® バイナリ互換機能</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/linuxemu/#linuxemu-synopsis>10.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/linuxemu/#linuxemu-lbc-install>10.2. Linux® バイナリ互換機能の設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/linuxemu/#linuxemu-advanced>10.3. 高度なトピックス</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/partiii/>パートIII. システム管理</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/config/>第11章 設定とチューニング</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#_この章では>11.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-core-configuration>11.2. 中核となる設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-appconfig>11.3. アプリケーションの設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-starting-services>11.4. サービスの起動</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-virtual-hosts>11.5. バーチャルホスト</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-configfiles>11.6. 設定ファイル</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-sysctl>11.7. sysctl によるチューニング</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-disk>11.8. ディスクのチューニング</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/config/#configtuning-kernel-limits>11.9. Kernel 制限のチューニング</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/boot/>第12章 FreeBSD の起動のプロセス</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/boot/#boot-synopsis>12.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/boot/#boot-introduction>12.2. FreeBSD の起動プロセス</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/boot/#device-hints>12.3. Device Hints</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/boot/#boot-shutdown>12.4. シャットダウン動作</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/security/>第13章 セキュリティ</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-synopsis>13.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-intro>13.2. はじめに</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#one-time-passwords>13.3. ワンタイムパスワード</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#tcpwrappers>13.4. TCP Wrappers</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#kerberos5>13.5. Kerberos5</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#openssl>13.6. OpenSSL</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#ipsec>13.7. VPN over IPsec</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#openssh>13.8. OpenSSH</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#fs-acl>13.9. ファイルシステムアクセス制御リスト (ACL)</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-portaudit>13.10. サードパーティ製ソフトウェアのセキュリティ問題を監視する</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-advisories>13.11. FreeBSD セキュリティ勧告</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-accounting>13.12. プロセスアカウンティング</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/security/#security-resourcelimits>13.13. リソースの制限</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/disks/>第14章 ストレージ</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#disks-synopsis>14.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#disk-naming>14.2. デバイス名</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#disks-adding>14.3. ディスクの追加</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#raid>14.4. RAID</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#creating-cds>14.5. 光メディア (CD & DVD) の作成と使用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#floppies>14.6. フロッピーディスクの作成と使用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#backups-tapebackups>14.7. データテープの作成と使用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#backups-floppybackups>14.8. フロッピーディスクへのバックアップ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#backup-basics>14.9. バックアップの基本</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#disks-virtual>14.10. ネットワーク、メモリ、そしてファイルベースのファイルシステム</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#snapshots>14.11. ファイルシステムのスナップショット</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#quotas>14.12. ファイルシステムクォータ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/disks/#disks-encrypting>14.13. ディスクパーティションの暗号化</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/l10n/>第15章 地域化 (localization) - i18n/L10n の利用と設定</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/l10n/#l10n-synopsis>15.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/l10n/#using-localization>15.2. 地域化の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/l10n/#l10n-compiling>15.3. 国際化 (i18n) に対応したアプリケーションを見つける</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/l10n/#lang-setup>15.4. 特定の言語にロケールを設定する</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/>第16章 FreeBSD のアップデートとアップグレード</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#updating-upgrading-synopsis>16.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>16.2. FreeBSD Update</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#updating-bootcode>16.3. ブートコードのアップデート</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#updating-upgrading-documentation>16.4. ドキュメントのアップデート</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#current-stable>16.5. 開発ブランチを追いかける</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#makeworld>16.6. ソースを用いた FreeBSD のアップデート</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/cutting-edge/#small-lan>16.7. 複数のマシンで追いかける</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/partiv/>パートIV. ネットワーク通信</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle checked>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/>第17章 シリアル通信</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#serial-synopsis>17.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#serial>17.2. はじめに</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#term>17.3. シリアル端末</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#dialup>17.4. ダイアルインサービス</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#dialout>17.5. ダイアルアウトサービス</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/serialcomms/#serialconsole-setup>17.6. シリアルコンソールの設定</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/>第18章 PPP と SLIP</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/#_この章では>18.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/#userppp>18.2. ユーザ ppp の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/#ppp>18.3. カーネル PPP の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/#pppoe>18.4. PPP オーバイーサネット (PPPoE) の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip/#slip>18.5. SLIP の利用</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/mail/>第19章 電子メール</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#mail-synopsis>19.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#mail-using>19.2. 電子メールを使う</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#sendmail>19.3. sendmail の設定</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#mail-changingmta>19.4. MTA の変更</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#mail-trouble>19.5. トラブルシュート</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#mail-advanced>19.6. 先進的なトピックス</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#SMTP-UUCP>19.7. UUCP とともに SMTP を使う</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#SMTP-dialup>19.8. ダイアルアップ接続でメールを使う</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mail/#SMTP-Auth>19.9. SMTP 認証</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/>第20章 高度なネットワーク</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#advanced-networking-synopsis>20.1. この章では</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-routing>20.2. ゲートウェイと経路</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-wireless>20.3. 無線ネットワーク</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-bluetooth>20.4. Bluetooth</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-bridging>20.5. ブリッジ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-nfs>20.6. NFS</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-diskless>20.7. ディスクレス稼働</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-isdn>20.8. ISDN</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-nis>20.9. NIS/YP</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-dhcp>20.10. DHCP</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-dns>20.11. DNS</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-ntp>20.12. NTP</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-natd>20.13. ネットワークアドレス変換 (NAT)</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-inetd>20.14. inetd"スーパサーバ"</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-plip>20.15. パラレルライン IP (PLIP)</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/advanced-networking/#network-ipv6>20.16. IPv6</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/partv/>パートV. 付録</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/mirrors/>付録A FreeBSD の入手方法</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/mirrors/#mirrors>A.1. Mirrors</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mirrors/#git>A.2. Git の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mirrors/#svn>A.3. Subversion の利用</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/mirrors/#mirrors-cdrom>A.4. CD および DVD セット</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/>付録B. 参考図書</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-freebsd>B.1. FreeBSD 専門の書籍</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-userguides>B.2. 利用者向けのガイド</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-adminguides>B.3. 管理者向けのガイド</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#_プログラマ向けのガイド>B.4. プログラマ向けのガイド</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#_オペレーティングシステム内部>B.5. オペレーティングシステム内部</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#_セキュリティの参考資料>B.6. セキュリティの参考資料</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-hardware>B.7. ハードウェアの参考資料</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-history>B.8. UNIX® の歴史</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/bibliography/#bibliography-journals>B.9. 定期刊行物、雑誌およびジャーナル</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/eresources/>付録 C. インターネット上のリソース</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/eresources/#eresources-www>C.1. ウェブサイト</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/eresources/#eresources-mail>C.2. メーリングリスト</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/eresources/#eresources-news>C.3. Usenet ニュースグループ</a></li><li><a href=http://172.16.201.134:1313/ja/books/handbook/eresources/#eresources-web>C.4. オフィシャルミラー</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=http://172.16.201.134:1313/ja/books/handbook/pgpkeys/>付録 D. OpenPGP Keys</a><ul><li><a href=http://172.16.201.134:1313/ja/books/handbook/pgpkeys/#pgpkeys-officers>D.1. オフィサ</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>第17章 シリアル通信</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#serial-synopsis>17.1. この章では</a></li><li><a href=#serial>17.2. はじめに</a></li><li><a href=#term>17.3. シリアル端末</a></li><li><a href=#dialup>17.4. ダイアルインサービス</a></li><li><a href=#dialout>17.5. ダイアルアウトサービス</a></li><li><a href=#serialconsole-setup>17.6. シリアルコンソールの設定</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=serial-synopsis>17.1. この章では<a class=anchor href=#serial-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>Unix は現在に至るまで、常にシリアル通信機能をサポートしていました。 実際、本当に初期の Unix マシンは、ユーザとの入出力にシリアル通信を使っていました。 10 文字毎秒のシリアルプリンタ、 キーボードから構成された "端末(terminal)" が広く使われていた当時とは、 何もかもがすっかり変わっています。この章では、FreeBSD でシリアル通信を行なういくつかの方法について説明しています。</p></div><div class=paragraph><p>この章を読むと、以下のことがわかります。</p></div><div class=ulist><ul><li><p>FreeBSD システムへの端末の接続方法</p></li><li><p>リモートホストへダイヤルするためのモデムの使い方</p></li><li><p>リモートのユーザがモデムでシステムにログインできるようにする方法</p></li><li><p>シリアルコンソールからのシステム起動方法</p></li></ul></div><div class=paragraph><p>この章を読む前に、以下のことを行っておくべきです。</p></div><div class=ulist><ul><li><p>新しいカーネルを構成してインストールする方法を覚える (<a href=../kernelconfig/#kernelconfig>FreeBSD カーネルのコンフィグレーション</a>)。</p></li><li><p>Unix のパーミッションとプロセスについて理解する (<a href=../basics/#basics>UNIX の基礎知識</a>)。</p></li><li><p>FreeBSD で使おうとしているシリアルハードウェア (モデムまたはマルチポートカード) のテクニカルマニュアルを読めるようにする。</p></li></ul></div></div></div><div class=sect1><h2 id=serial>17.2. はじめに<a class=anchor href=#serial></a></h2><div class=sectionbody><div class=sect2><h3 id=serial-terminology>17.2.1. 用語解説<a class=anchor href=#serial-terminology></a></h3><div class=dlist><dl><dt class=hdlist1>bps</dt><dd><p>Bits per Second の略で、 データの転送速度を表す単位。</p></dd><dt class=hdlist1>DTE</dt><dd><p>Data Terminal Equipment の略。 たとえばコンピュータ本体のこと</p></dd><dt class=hdlist1>DCE</dt><dd><p>Data Communications Equipment の略で、具体的にはモデムのこと。</p></dd><dt class=hdlist1>RS-232</dt><dd><p>EIA (米電気産業協会) のハードウェアシリアル通信の標準規格</p></dd></dl></div><div class=paragraph><p>通信におけるデータ転送速度に関して、 このセクションでは "ボー" (baud) という用語は使いません。 ボーというのは一定時間に生じうる電気的状態の変化の数を表すにすぎず、 "bps" (bits per second) という単位の方が<em>正しい</em>からです (少なくとも、こういう表現をしておけば、 意地の悪い人に怒られることもないのではないかと思います)。</p></div></div><div class=sect2><h3 id=serial-cables-ports>17.2.2. ケーブルとポート<a class=anchor href=#serial-cables-ports></a></h3><div class=paragraph><p>モデムまたはシリアル端末を FreeBSD システムに接続するためには、 コンピュータ上のシリアルポートと、 シリアルデバイスに接続する適切なケーブルが必要です。 ハードウェアとそれが必要とするケーブルについてよく理解しているなら、 この節は飛ばしても問題ありません。</p></div><div class=sect3><h4 id=term-cables>17.2.2.1. ケーブル<a class=anchor href=#term-cables></a></h4><div class=paragraph><p>シリアルケーブルにはさまざまな種類があります。 我々の目的にあうもっとも一般的な 2 種類は、 ヌルモデムケーブル と、スタンダード (ストレート) RS-232 ケーブルです ハードウェアの説明文書に必要なケーブルの種類が記載されているはずです。</p></div><div class=sect4><h5 id=term-cables-null>17.2.2.1.1. ヌルモデムケーブル<a class=anchor href=#term-cables-null></a></h5><div class=paragraph><p>ヌルモデムケーブル (またはリバースケーブルあるいはクロ スケーブル) は、たとえば "signal ground" 信号のように、いくつかの信 号はそのまま通しますが、 他の信号は途中で入れ替えて通します。たとえば、"send data" 信号のピンは、反対側のコネクタの "receive data" 信号の ピンと繋がっています。</p></div><div class=paragraph><p>自分で使うケーブルは自分で作りたいということであれば、 端末で使うヌルモデムケーブルを作成できます。この表では、 RS-232C の信号線の名前と、DB-25 コネクタ上のピンの番 号を示しています。</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><thead><tr><th class="tableblock halign-left valign-top">Signal</th><th class="tableblock halign-left valign-top">Pin #</th><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top">Pin #</th><th class="tableblock halign-left valign-top">Signal</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>TxD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>connects to</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RxD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RxD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>connects to</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TxD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>connects to</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>connects to</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>connects to</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>connects to</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>connects to</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>DCD と RST では、コネクタ内部でピン4を5に接続し、 そして逆側のコネクタのピン8と接続します。</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=term-cables-std>17.2.2.1.2. スタンダード RS-232C ケーブル<a class=anchor href=#term-cables-std></a></h5><div class=paragraph><p>スタンダードシリアルケーブル (またはストレートケーブル) の場合は、すべての RS-232C 信号をそのまま通します。つまり、片方の "send data" 信号のピンは、逆側の "send data" 信号のピンと繋がっています。モデムを FreeBSD に接続するときや、一部の端末を接続するときにこのタイプの ケーブルを使用します。</p></div></div></div><div class=sect3><h4 id=term-ports>17.2.2.2. ポート<a class=anchor href=#term-ports></a></h4><div class=paragraph><p>シリアルポートは、FreeBSDが動作しているホスト コンピュータと端 末の間でデータのやりとりを行うために用いるデバイスです。 ここでは、現在存在するポートの種類と FreeBSD でのポートのアクセス方法について解 説します。</p></div><div class=sect4><h5 id=term-portkinds>17.2.2.2.1. ポートの種類<a class=anchor href=#term-portkinds></a></h5><div class=paragraph><p>シリアルポートには何種類かのものがあります。 ケーブルを購 入したり自作したりする前に、 そのケーブルのコネクタの形状が端末および FreeBSD システムのポートの形状と一致していることを 確認してください。</p></div><div class=paragraph><p>ほとんどの端末は DB25 ポートを搭載しています。 FreeBSDが動作しているも のを含めて、PCは DB25 または DB9 ポートを搭載しています。マルチポート のシリアルカードの場合は、RJ-12 や RJ-45 のポートを搭載しているかもし れません。</p></div><div class=paragraph><p>利用されているポートの種類に関しては、 ハードウェアについてきたドキュメントを参照してください。 また、多くの場合、ポートの形状から判断することもできるでしょう。</p></div></div><div class=sect4><h5 id=term-portnames>17.2.2.2.2. ポートの名前<a class=anchor href=#term-portnames></a></h5><div class=paragraph><p>FreeBSDでは、<span class=filename>/dev</span> ディレクトリ内のエントリを介 してシリアルポートへのアクセスがおこなわれます。 2種類の異なったエン トリがあります。</p></div><div class=ulist><ul><li><p>着信用のポートの名前は、 <span class=filename>/dev/ttydN</span> (<em>N</em> は 0から始まるポート番号) となっています。一般に端末の接続には 着信用ポートを用います。着信用のポートでは、 シリアルラインのデータ キャリア検出 (DCD) 信号がオンになっている必要があります。</p></li><li><p>発信用のポートの名前は、 <span class=filename>/dev/cuaaN</span> となっています。 発信用のポートは普通モデムの接続に用い、端末の接続には 利用しません。ただ、 ケーブルまたは端末がキャリア検出信号を使えない タイプのものの場合は、 発信用のポートを使うとよいでしょう。</p></li></ul></div><div class=paragraph><p>たとえば、端末を一つ目のシリアルポート (MS-DOS でいうところの <span class=filename>COM1</span>) に接 続したとすると、<span class=filename>/dev/ttyd0</span> がこの端末を指すことになります。また、 二つ目のシリアルポート (<span class=filename>COM2</span>) ならば <span class=filename>/dev/ttyd1</span> となり、 以下この形式のデバイスエントリを使います。</p></div></div></div></div><div class=sect2><h3 id=_カーネルの設定>17.2.3. カーネルの設定<a class=anchor href=#_カーネルの設定></a></h3><div class=paragraph><p>デフォルトでは、FreeBSD は 4 つのシリアルポートに対応しています。MS-DOS の世界では、 <span class=filename>COM1</span>, <span class=filename>COM2</span>, <span class=filename>COM3</span> および <span class=filename>COM4</span> と呼ばれています。 FreeBSD では、現在のところ BocaBoard の 1008 や 2016 などの、 "単純な"マルチポートシリアルインタフェースや、 Digiboard や Stallion Technologies が製造しているよりインテリジェントなマルチポートカードにも対応しています。 しかしながら、デフォルトのカーネルは、標準の COM ポートしか見ません。</p></div><div class=paragraph><p>搭載されているシリアルポートのいずれかを、 カーネルが認識しているかどうか確認したい場合は、 カーネルの起動時のメッセージを注意深く見るか、あるいは <code>/sbin/dmesg</code> コマンドを使って、 起動時の出力メッセージを確認してください。特に、 <code>sio</code> で始まるメッセージをよく見てください。</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>以下のコマンドで <code>sio</code> という文字列を含むメッセージだけを表示できます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/dmesg | grep &#39;sio&#39;</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>たとえば、シリアルポートを四つ持つシステムの場合は、 以下のようなシリアルポートに関するメッセージがカーネルによって表示されます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sio0 at 0x3f8-0x3ff irq 4 on isa
sio0: <span class=nb>type </span>16550A
sio1 at 0x2f8-0x2ff irq 3 on isa
sio1: <span class=nb>type </span>16550A
sio2 at 0x3e8-0x3ef irq 5 on isa
sio2: <span class=nb>type </span>16550A
sio3 at 0x2e8-0x2ef irq 9 on isa
sio3: <span class=nb>type </span>16550A</code></pre></div></div><div class=paragraph><p>もし、カーネルに正常に認識されないポートがある場合は、 おそらくカスタマイズした FreeBSD カーネルを構築する必要があるでしょう。 カーネルコンフィグレーションの詳細については <a href=../kernelconfig/#kernelconfig>FreeBSD カーネルのコンフィグレーション</a> をご覧ください。</p></div><div class=paragraph><p>カーネルコンフィグレーションの該当するデバイス行は、 次のようになります。</p></div><div class="literalblock programlisting"><div class=content><pre>device		sio0	at isa? port &#34;IO_COM1&#34; tty irq 4 vector siointr
device		sio1	at isa? port &#34;IO_COM2&#34; tty irq 3 vector siointr
device		sio2	at isa? port &#34;IO_COM3&#34; tty irq 5 vector siointr
device		sio3	at isa? port &#34;IO_COM4&#34; tty irq 9 vector siointr</pre></div></div><div class=paragraph><p>システムに搭載されていないデバイスに関する記述は、 コメントアウトまたは削除してしまってかまいません。 <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> のマニュアルを見て、 マルチポートのボードのためのコンフィグレーションファイルの記述の仕方を確認してください。 デバイスのフラグの指定方法がバージョンによって異なりますので、 別のバージョンの FreeBSD で利用していたコンフィグレーションファイルを流用する場合には十分注意してください。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>なお、<code>port "IO_COM1"</code>, <code>IO_COM2</code>, <code>IO_COM3</code> および <code>IO_COM4</code> は、 それぞれのポートの一般的なアドレスである <code>0x3f8</code>, <code>0x2f8</code>, <code>0x3e8</code> および <code>0x2e8</code> を表します。また、割り込み番号 4, 3, 5 と 9 は、それぞれ <span class=filename>COM1:</span> から <span class=filename>COM4:</span> のポートで一般的に使用される IRQ です。また、ISA バスのコンピュータの場合、 一般的なシリアルポートは複数のポートで一つの IRQ を共有することが <em>できません</em>ので注意が必要です (マルチポートのシリアルボードの場合は、複数の 16550A ベースのポートで一つまたは二つの IRQ を共有するための機構を備えています)。</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_デバイススペシャルファイル>17.2.4. デバイススペシャルファイル<a class=anchor href=#_デバイススペシャルファイル></a></h3><div class=paragraph><p>カーネルに組み込まれているほとんどのデバイスは、 <span class=filename>/dev</span> ディレクトリにある、 "デバイススペシャルファイル"を介してアクセスされます。 <span class=filename>sio</span> デバイスの場合は、着信用の <span class=filename>/dev/ttydN</span> および、発信用の <span class=filename>/dev/cuaaN</span> が利用されます。さらに、FreeBSD は、初期化デバイス (<span class=filename>/dev/ttyidN</span> と <span class=filename>/dev/cuai0N</span>) およびロッキングデバイス (<span class=filename>/dev/ttyldN</span> と <span class=filename>/dev/cual0N</span>) も用意しています。 初期化デバイスは、通信ポートがオープンされる度に、 そのポートの初期設定を行うために使われます。たとえば、 <code>RTS/CTS</code> によるフロー制御を行うモデムが接続されている場合の <code>crtscts</code> などのパラメータの初期化が行われます。 ロッキングデバイスは、ポートの設定をロックし、 他のユーザやプログラムにこれらを変更されることのないようにするために利用されます。 通信ポートの設定、デバイスのロックと初期化および設定の変更に関しては、 それぞれ <a href="https://man.freebsd.org/cgi/man.cgi?query=termios&amp;sektion=4&amp;format=html">termios(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> と <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a> のマニュアルをご覧ください。</p></div><div class=sect3><h4 id=_デバイススペシャルファイルの作成>17.2.4.1. デバイススペシャルファイルの作成<a class=anchor href=#_デバイススペシャルファイルの作成></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>FreeBSD 5.0 には、 必要に応じてデバイスノードを自動的に作成する <code>devfs</code> ファイルシステムがあります。 <code>devfs</code> が有効になっているバージョンの FreeBSD を動かしているなら、 この節は飛ばしてかまいません。</p></div></td></tr></tbody></table></div><div class=paragraph><p>デバイススペシャルファイルの管理は、ディレクトリ <span class=filename>/dev</span> にあるシェルスクリプト <code>MAKEDEV</code> で行います。 <code>MAKEDEV</code> を使って、 <span class=filename>COM1</span> (ポート 0) をダイアルアップのポートとして利用するための デバイススペシャルファイルを作るには、 <span class=filename>/dev</span> に <code>cd</code> してから、 <code>MAKEDEV ttyd0</code> と実行してください。 同様に、<code>MAKEDEV ttyd1</code> とすることで、 <span class=filename>COM2</span> (ポート 1) 用のデバイススペシャルファイルを作成できます。</p></div><div class=paragraph><p><code>MAKEDEV</code> は、 <span class=filename>/dev/ttydN</span> のデバイススペシャルファイルだけでなく、 <span class=filename>/dev/cuaaN</span>, <span class=filename>/dev/cuaiaN</span>, <span class=filename>/dev/cualaN</span>, <span class=filename>/dev/ttyldN</span> および <span class=filename>/dev/ttyidN</span> ノードも作成します。</p></div><div class=paragraph><p>デバイススペシャルファイルの作成後、 これらのファイルの許可属性が適切に設定されていて、 これらのデバイスを利用してもよいユーザのみが読み書きできるようになっていることを確認してください (特に <span class=filename>/dev/cua*</span> の許可属性には注意を払ってください)。 この確認を怠ると、 一般のユーザがあなたのモデムを使うことができるようなことになりかねません。 デフォルトの <span class=filename>/dev/cua*</span> の許可属性は、以下のようになっていて、 たいていの場合適切なものだと思います。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>crw-rw----    1 uucp     dialer    28, 129 Feb 15 14:38 /dev/cuaa1
crw-rw----    1 uucp     dialer    28, 161 Feb 15 14:38 /dev/cuaia1
crw-rw----    1 uucp     dialer    28, 193 Feb 15 14:38 /dev/cuala1</code></pre></div></div><div class=paragraph><p>上の設定では、ユーザ <code>uucp</code> と、グループ <code>dialer</code> に属するユーザが発信用のデバイスを利用できます。</p></div></div></div><div class=sect2><h3 id=serial-hw-config>17.2.5. シリアルポートの設定<a class=anchor href=#serial-hw-config></a></h3><div class=paragraph><p><span class=filename>ttydN</span> (または <span class=filename>cuaaN</span>) デバイスは、 アプリケーション上でシリアルポートをオープンする時に使用する、 標準的なデバイスです。プロセスがデバイスをオープンする際、端末 I/O 設定のデフォルトセットが適用されます。これらの設定内容は、 次のコマンドで確認することができます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># stty -a -f /dev/ttyd1</span></code></pre></div></div><div class=paragraph><p>このデバイスの設定を変更した場合、 その設定はデバイスがクローズされるまで有効です。 デバイスが再びオープンされる時、デフォルトの設定値に戻ります。 デフォルトの設定を変更するためには、"初期状態" を設定したいデバイスをオープンして調節できます。 たとえば、<span class=filename>ttyd5</span> というデバイスに対して、デフォルトで <code>CLOCAL</code> モード, 8 bits, <code>XON/XOFF</code> フロー制御を設定したい場合は、 次のように入力してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># stty -f /dev/ttyid5 clocal cs8 ixon ixoff</span></code></pre></div></div><div class=paragraph><p>システム全体のシリアルデバイス初期化は <span class=filename>/etc/rc.serial</span> で制御されています。 このファイルは、シリアルデバイスのデフォルトの設定を決めます。</p></div><div class=paragraph><p>また、"ロック状態"のデバイスに調節を加えることで、 アプリケーションがある種の設定を変更してしまうことを防げます。 たとえば、<span class=filename>ttyd5</span> の速度を 57600 bps に固定したい場合には、次のように入力してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># stty -f /dev/ttyld5 57600</span></code></pre></div></div><div class=paragraph><p>これで、<span class=filename>ttyd5</span> をオープンして、 シリアルポートの転送スピードを変更しようとするアプリケーションは 57600 bps で頭打ちになります。</p></div><div class=paragraph><p>本来、初期状態やロックされているデバイスに書き込めるのは <code>root</code> アカウントだけにすべきです。</p></div></div></div></div><div class=sect1><h2 id=term>17.3. シリアル端末<a class=anchor href=#term></a></h2><div class=sectionbody><div class=paragraph><p>シリアル端末を利用することで、 コンピュータのコンソールのそばにいないときや、 手近にネットワーク接続されているコンピュータがないときでも、 FreeBSD の機能を便利に、かつ安価に利用することができます。 ここでは、FreeBSD にシリアル端末を接続する方法を解説します。</p></div><div class=sect2><h3 id=term-uses>17.3.1. 端末の種類と利用方法<a class=anchor href=#term-uses></a></h3><div class=paragraph><p>もともと Unix システムにはコンソールがありませんでした。 ユーザはコンピュータのシリアルポートに接続された端末からログインしてプログラムを利用していました。 ちょうどモデムと通信ソフトを使ってリモートのコンピュータにログインし、 テキストベースのプログラムを利用するのとよく似ています。</p></div><div class=paragraph><p>最近の PC は、 高品質の画像を表示できるコンソールを搭載していますが、 ほとんどすべての Unix 系 OS には未だにシリアルポートを使ってログインするための機能があり、 FreeBSD でもこの機能がサポートされています。 現在使用されていないシリアルポートに端末を接続することでシステムにログインし、 通常はコンソールや X ウィンドウシステムの <code>xterm</code> のウィンドウ上で起動しているテキストベースのプログラムであれば何でも利用できます。</p></div><div class=paragraph><p>職場での利用ということで考えるならば、FreeBSD が動作しているコンピュータに接続された何台ものシリアル端末を各社員の机に配置するというようなことが可能です。 また、家庭での利用方法としては、余っている古い IBM PC や Macintosh を FreeBSD が動いているパワフルなコンピュータの端末として利用できます。 普通ならシングルユーザのコンピュータを、 パワフルなマルチユーザのシステムに変えることができるのです。</p></div><div class=paragraph><p>FreeBSD では、以下に挙げる 3 種類の端末が利用できます。</p></div><div class=ulist><ul><li><p><a href=#term-dumb>ダム (dumb) 端末</a></p></li><li><p><a href=#term-pcs>PCを利用した端末</a></p></li><li><p><a href=#term-x>X 端末</a></p></li></ul></div><div class=paragraph><p>以下は、それぞれについての解説です。</p></div><div class=sect3><h4 id=term-dumb>17.3.1.1. ダム端末<a class=anchor href=#term-dumb></a></h4><div class=paragraph><p>ダム端末は、 シリアルライン経由でのコンピュータとの接続専用のハードウェアです。 ダム端末は、テキストの送受信および表示ができる程度の計算能力しかもっていないので、 "dumb" (間抜け) というように呼ばれています。 この端末上でプログラムを実行することはできません。 テキストエディタ、コンパイラ、E-mail、 ゲームなどなどのプログラムを実行するのは、 ダム端末を接続しているコンピュータの方です。</p></div><div class=paragraph><p>Digital Equipment 社の VT-100 や、Wyse 社の WY-75 を初めとして、多くのメーカが何百種類ものダム端末を作っています。 ほとんどどんな種類のダム端末でも FreeBSD に接続して使用できます。さらに、 高性能の端末の中には画像を取り扱えるものもありますが、 限られた数のソフトウェアパッケージしかこういった機能には対応していません。</p></div><div class=paragraph><p>ダム端末は、 X ウィンドウシステムで提供されるようなグラフィックアプリケーションを必要としない職場で広く用いられています。</p></div></div><div class=sect3><h4 id=term-pcs>17.3.1.2. PC を端末として利用する<a class=anchor href=#term-pcs></a></h4><div class=paragraph><p><a href=#term-dumb>ダム端末</a> がテキストの表示および送受信の機能をそなえただけのものならば、 言うまでもなく、どんな PC もダム端末になり得ます。 必要なものは適切なケーブルと、その PC の上で動作する<em>端末エミュレーション</em> を行うソフトウェアのみです。</p></div><div class=paragraph><p>このような環境は、家庭においてよく利用されます。 たとえば、あなたの同居人が FreeBSD のコンソールを専有している時などに、 あまりパワーのないコンピュータを FreeBSD システムにシリアル端末として接続し、 その端末上でテキストだけを用いる作業をおこなうことができます。</p></div></div><div class=sect3><h4 id=term-x>17.3.1.3. X 端末<a class=anchor href=#term-x></a></h4><div class=paragraph><p>X 端末は、 既存のものの中で最も洗練された種類の端末といえます。 X 端末は、たいていの場合シリアルポートではなく、 イーサネットのようなネットワークを利用した接続をおこないます。 また、アプリケーションの利用においても、 テキストベースのものだけでなく、 X アプリケーションの利用が可能です。</p></div><div class=paragraph><p>ここでは、参考までに端末について紹介しただけで、 X 端末の設定や利用についての解説は <em>おこないません</em>。</p></div></div></div><div class=sect2><h3 id=term-config>17.3.2. 設定<a class=anchor href=#term-config></a></h3><div class=paragraph><p>ここでは、端末からのログインを可能にするために必要な FreeBSD 側の設定について解説します。 既に端末を接続するポートが利用できるように kernel の設定をおこない、端末が接続されているものと考えて、解説を進め ます。</p></div><div class=paragraph><p><a href=../boot/#boot>FreeBSD の起動のプロセス</a> で述べたように <code>init</code> プロセスは、 システム起動時にすべてのプロセス管理や初期化をおこなっています。 <code>init</code> が行っている仕事の一つは、 <span class=filename>/etc/ttys</span> ファイルを読んで、利用可能な端末上で <code>getty</code> プロセスを起動することです。 <code>getty</code> プロセスは、 ログイン名を読み込み <code>login</code> プログラムを起動します。</p></div><div class=paragraph><p>したがって、FreeBSD の端末を設定するには、 <code>root</code> で次の手順を踏まなければなりません。</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>端末を接続するポートの <span class=filename>/dev</span> のエントリが含ま れている行がまだ存在しなければ、これを <span class=filename>/etc/ttys</span> に追加してく ださい。</p></li><li><p><code>/usr/libexec/getty</code> が対象となるポートに対して 実行されるように指定してください。また、 <span class=filename>/etc/gettytab</span> ファイ ル内の適切な <em>getty</em> タイプのエントリを指定してください。</p></li><li><p>デフォルトのターミナルタイプを指定してください。</p></li><li><p>対象となるポートを "on" に設定してください。</p></li><li><p>そのポートが "secure" であるかどうかを指定してください。</p></li><li><p><code>init</code> に <span class=filename>/etc/ttys</span> を読み込みなおさせてく ださい。</p></li></ol></div></div></div><div class=paragraph><p>また、必要に応じて <span class=filename>/etc/gettytab</span> を変更し、上の 2で使用する <em>getty</em> のエントリを追加してください。 この章ではこの方法については特に解説しませんので、<a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a> および <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a> のマニュアルをご覧ください。</p></div><div class=sect3><h4 id=term-etcttys>17.3.2.1. <span class=filename>/etc/ttys</span> へのエントリの追加<a class=anchor href=#term-etcttys></a></h4><div class=paragraph><p><span class=filename>/etc/ttys</span> には、 FreeBSDシステム上のログインを許可するすべての ポートを記述します。たとえば、一つ目の仮想コンソール <span class=filename>ttyv0</span> のエン トリもこのファイルにあります。このエントリのおかげで、 コンソールからの ログインが可能になっています。 このファイルには、他の仮想コンソール、シ リアルポートおよび仮想端末のエントリも含まれています。 端末を接続する場合は、そのポートの <span class=filename>/dev</span> のエントリを、 <span class=filename>/dev</span> の部分を省略して記述します (たとえば <span class=filename>/dev/ttyv0</span> については、 <span class=filename>ttyv0</span> として記述します)。</p></div><div class=paragraph><p>FreeBSD のデフォルトのインストール状態では、 <span class=filename>ttyd0</span> から <span class=filename>ttyd3</span> までの、初めの 4 つのシリアルポートに対応した <span class=filename>/etc/ttys</span> ファイルが置かれています。 これらのポートのいずれかに端末を接続する場合は、 新たにエントリを追加する必要はありません。</p></div><div id=ex-etc-ttys class=exampleblock><div class=title>例 1. 端末の項目を <span class=filename>/etc/ttys</span> に追加する</div><div class=content><div class=paragraph><p>システムに 2 台の端末、Wyse-50 と、VT-100 端末をエミュレートしている Procomm 端末ソフトウェアを動かしている古い 286 IBM PC をシステムに接続しようとしていると考えてください。 Wyse は 2 番目のシリアルポートに、286 は 6 番目のシリアルポート (マルチポートシリアルカード上のポート) に接続します。 <span class=filename>/etc/ttys</span> 内の対応する項目は次のようになります。</p></div><div class="literalblock programlisting"><div class=content><pre>ttyd1  &#34;/usr/libexec/getty std.38400&#34;  wy50  on  insecure
ttyd5   &#34;/usr/libexec/getty std.19200&#34;  vt100  on  insecure</pre></div></div><div class=ulist><ul><li><p>最初のフィールドには、通常 <span class=filename>/dev</span> にある端末のスペシャルファイル名を指定します。</p></li><li><p>2 番目のフィールドは、 この回線に対して実行するコマンドで、通常は <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a> です。<code>getty</code> は、回線を初期化して開き、速度を設定して、 ユーザ名を入力するプロンプトを出して <a href="https://man.freebsd.org/cgi/man.cgi?query=login&amp;sektion=1&amp;format=html">login(1)</a> プログラムを実行します。<code>getty</code> プログラムは、 コマンドラインから (省略可能な) パラメータ <em>getty</em> タイプを受け取ります。 <em>getty</em> タイプは、 bps レートやパリティのような端末回線の特性を示します。 <code>getty</code> プログラムは、 これらの特性を <span class=filename>/etc/gettytab</span> ファイルから読み込みます。<span class=filename>/etc/gettytab</span> ファイルには、 端末回線について新旧多くの項目があります。 ほとんどの場合、<code>std</code> で始まる項目は、ケーブルで接続された端末に働きます。 これらの項目はパリティを無視します。110 から 115200 までの間の bps レートそれぞれに対して一つ <code>std</code> 項目があります。もちろん、 このファイルに独自の項目を加えてもかまいません。 <a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a> のマニュアルに詳しい情報が載っています。<span class=filename>/etc/ttys</span> ファイルに <em>getty</em> タイプを設定する時は、 端末の通信設定が対応していることを確かめましょう。たとえば、Wyse-50 はパリティなしで、38400 bps で接続します。286 PC はパリティなしで、19200 bps で接続します。</p></li><li><p>第 3 フィールドは、その tty 回線に通常つながる端末の種別です。 ダイアルアップポートでは、実際、 ユーザがどんな種類の端末やソフトウェアで接続してくることもありうるので、 このフィールドには <code>unknown</code> または <code>dialup</code> がよく使われています。 ケーブルで配線された端末については、 端末種別は変わりませんので、<a href="https://man.freebsd.org/cgi/man.cgi?query=termcap&amp;sektion=5&amp;format=html">termcap(5)</a> データベースファイルから実際の端末種別を、 このフィールドに記入できます。我々の例では、Wyse-50 には実際の端末種別を使っていますが、 Procomm を動かしている 286 PC は、VT-100 をエミュレートするように設定します。</p></li><li><p>4 番目のフィールドは、 ポートを有効にすべきかどうかを指定します。 ここに <code>on</code> と記入すると、 <code>init</code> プロセスが 2 番目のフィールドに記載されているプログラム、 <code>getty</code> を起動します。 このフィールドを <code>off</code> にすると、 <code>getty</code> は動かず、 そのポートからはログインできません。</p></li><li><p>最後のフィールドは、 そのポートが安全かどうか指定します。 あるポートが安全だということは、そのポートから <code>root</code> (またはその他の UID が 0 の) アカウントのログインを許可してよいと信頼しているということです。 安全でないポートからは、<code>root</code> のログインは許可されません。安全でないポートでは、 ユーザは特権を持たないアカウントでログインした後に、 <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> や類似の仕組みを使ってスーパユーザ特権を獲得します。鍵のかかる部屋にある端末であっても、"insecure" にしておくことが強く推奨されます。 スーパユーザ特権が必要なら、ログインしてから <code>su</code> を使うのは十分簡単です。</p></li></ul></div></div></div></div><div class=sect3><h4 id=term-hup>17.3.2.2. <code>init</code> にファイル <span class=filename>/etc/ttys</span> の再読み込みをさせる<a class=anchor href=#term-hup></a></h4><div class=paragraph><p>必要な変更を <span class=filename>/etc/ttys</span> ファイルに加えたら、SIGHUP (ハングアップ) シグナルを <code>init</code> プロセスに送って設定ファイルを強制的に再読み込みさせます。 たとえば</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -HUP 1</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>init</code> は、システムで最初に起動するプロセスなので、 PID は常に 1 です。</p></div></td></tr></tbody></table></div><div class=paragraph><p>すべての設定が正しくおこなわれ、 すべてのケーブルがただしく接続されていて、 かつ端末の電源が入っていれば、この時点で各端末で <code>getty</code> プロセスが動いていて、 ログインプロンプトが表示されているはずです。</p></div></div></div><div class=sect2><h3 id=term-debug>17.3.3. 接続のトラブルシューティング<a class=anchor href=#term-debug></a></h3><div class=paragraph><p>細心の注意を払って設定をおこなっても、 ときには端末の接続がう まくいかない場合があるでしょう。以下に、 よく見られる問題とその解決方法 を示します。</p></div><div class=sect3><h4 id=_ログインプロンプトが表示されない>17.3.3.1. ログインプロンプトが表示されない<a class=anchor href=#_ログインプロンプトが表示されない></a></h4><div class=paragraph><p>端末の電源が接続され、 スイッチが入っていることを確認してください。もし、PC を端末として利用している場合は、 通信ソフトが適切なシリアルポー トを利用する設定になっているかどうか確かめてください。</p></div><div class=paragraph><p>ケーブルがしっかりと端末と FreeBSDが動作しているコンピュータの両方に接続され ていることを確認してください。また、 正しい種類のケーブルを利用している か確かめてください。</p></div><div class=paragraph><p>端末と FreeBSD の間の通信速度とパリティの設定が一致していることを確認 してください。 出力をモニタに表示するタイプの端末の場合は、モニタ のコントラストと明るさの設定を確認してください。また、 出力が印刷 されるタイプの端末の場合は、 紙とインクが十分にあるかどうかを確かめてく ださい。</p></div><div class=paragraph><p><code>getty</code> が動いていて、 端末を認識していることを確認してください。 たとえば、動作中の <code>getty</code> プロセスの一覧を <code>ps</code> で取得するには、以下のように入力してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ps -axww|grep getty</span></code></pre></div></div><div class=paragraph><p>その端末に対応する項目が表示されるはずです。 たとえば、以下の表示例は、<code>getty</code> は 2 番目のシリアルポート (<code>ttyd1</code>) に対して <span class=filename>/etc/gettytab</span> 中の <code>std.38400</code> エントリを使って動作しているということを示しています。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>22189  d1  Is+    0:00.03 /usr/libexec/getty std.38400 ttyd1</code></pre></div></div><div class=paragraph><p>もし、<code>getty</code> プロセスが一つも動いていないようであれば、 <span class=filename>/etc/ttys</span> の中で、 そのポートを利用可能にする設定をしたかどうか確かめてください。 また、<span class=filename>ttys</span> ファイルを変更したら、<code>kill -HUP 1</code> を実行するのを忘れないでください。</p></div></div><div class=sect3><h4 id=_ログインプロンプトの代わりにゴミが表示される>17.3.3.2. ログインプロンプトの代わりにゴミが表示される<a class=anchor href=#_ログインプロンプトの代わりにゴミが表示される></a></h4><div class=paragraph><p>端末と FreeBSD の間の通信速度およびパリティの設定が一致していることを確 かめてください。また、<code>getty</code> プロセスの情報を調べて、適切な <em>getty</em> のタイプが使用されていることを確認してください。間違った <em>getty</em> タイプが使用されている場合は、 <span class=filename>/etc/ttys</span> を修正し てから、 <code>kill -HUP 1</code> を実行してください。</p></div></div><div class=sect3><h4 id=_文字が重複して表示される入力したパスワードが表示される>17.3.3.3. 文字が重複して表示される、入力したパスワードが表示される<a class=anchor href=#_文字が重複して表示される入力したパスワードが表示される></a></h4><div class=paragraph><p>端末または通信ソフトの設定で、"半二重 (half duplex)" あるいは "ローカ ルエコー" となっているところを、"全二重 (full duplex)" に変更してください。</p></div></div></div></div></div><div class=sect1><h2 id=dialup>17.4. ダイアルインサービス<a class=anchor href=#dialup></a></h2><div class=sectionbody><div class=paragraph><p><em>訳: . 6 September 1996.</em></p></div><div class=paragraph><p>FreeBSD システムをダイアルインサービス用に設定することは、 端末の代わりにモデムを扱うこと以外は、 端末の接続によく似ています。</p></div><div class=sect2><h3 id=_外づけモデムと内蔵モデムについて>17.4.1. 外づけモデムと内蔵モデムについて<a class=anchor href=#_外づけモデムと内蔵モデムについて></a></h3><div class=paragraph><p>ダイアルアップのサービスに関していえば、 外づけのモデムの方が適している ようです。これは、 多くの外づけのモデムは設定を不揮発ラムに書き込んで半 永久的に保存することができますし、また RS-232 に関する重要な情報を知る ための点滅するライトによるインディケータが 搭載されているからです。点滅 するライトは、 システムを見に来た訪問者に強い印象を与えるという効果だけ でなく、モデムが適切に動作しているかどうかを知るためにも 有効です。</p></div><div class=paragraph><p>一方、たいていの内蔵型のモデムには 不揮発性ラムが搭載されていないため、ディップ スイッチの変更以外に設定を保存する方法がありません。また、も しインディケータがついていても、おそらくコンピュータのケース カバーが 外されていなければその状態を確認するのは 難しいでしょう。</p></div><div class=sect3><h4 id=_モデムとケーブル>17.4.1.1. モデムとケーブル<a class=anchor href=#_モデムとケーブル></a></h4><div class=paragraph><p>外付けモデムを使用しているなら、 それにあったケーブルが必要です。 通常の信号が全て接続されている限り、標準的な RS-232C ケーブルで十分でしょう。</p></div><div class=ulist><ul><li><p>Transmitted Data (SD)</p></li><li><p>Received Data (RD)</p></li><li><p>Request to Send (RTS)</p></li><li><p>Clear to Send (CTS)</p></li><li><p>Data Set Ready (DSR)</p></li><li><p>Data Terminal Ready (DTR)</p></li><li><p>Carrier Detect (CD)</p></li><li><p>Signal Ground (SG)</p></li></ul></div><div class=paragraph><p>FreeBSD で 2400bps 以上の転送速度を利用する場合には、 フロー制御のため に RTS 信号と CTS 信号が必要です。また、 接続の確立と回線の切 断を検出するために CD 信号を利用します。さらに、 DTR 信号を使っ て回線切断後のモデムのリセットを行います。ケーブルの中には、 総ての必要 な信号線が接続されていないものもありますので、 たとえば、回線切断後でも ログイン セッションが残ってしまうといった問題が発生した場合などには、 ケーブルに問題がある可能性もあります。</p></div><div class=paragraph><p>FreeBSD も他の Unix 系 OS と同様、回線の接続およ び切断の検出や回線の切断および回線切断後の モデムの初期化にハードウェア シグナルを利用します。FreeBSD は、モデムに対するコマンドの送信やモデ ムの状態の監視を行いません。パソコンで運用されている BBS への接続に慣 れている方にとっては、 ちょっとめんどうかもしれませんね。</p></div></div></div><div class=sect2><h3 id=_シリアル_インタフェースについて>17.4.2. シリアル インタフェースについて<a class=anchor href=#_シリアル_インタフェースについて></a></h3><div class=paragraph><p>FreeBSD では、NS8250-、NS16450-、NS16550- および NS16550A- に基づ いた EIA RS-232C (CCITT V.24) 規格のシリアル インタフェースをサポート しています。8250 および 16450 ベースのディバイスには1文字のキャラクタ バッファが搭載されています。また、16550 系のディバイスには、 16文字分 のバッファが搭載されていて、 はるかによいパフォーマンスを得られます (ただし、無印の 16550 では、バグがあって 16 文字バッファが利用できませ んので、可能であれば 16550A 系のディバイスを利用してください)。1文字 のバッファの物は、 16550 系のものと比べて OS にかける負荷が大きいので、16550A 系ディバイスの利用を強く推奨します。多数のシリアル ポートを利 用する場合や、負荷の高いシステムにおいては、 16550A 系ディバイスを使う ことで、 エラー発生率を低く押さえることができます。</p></div></div><div class=sect2><h3 id=_概要>17.4.3. 概要<a class=anchor href=#_概要></a></h3><div class=paragraph><p>端末に関しては、 ダイアルイン接続に割り当てられたそれぞれのシリアルポートに対して、 <code>init</code> が <code>getty</code> を起動します。たとえば、モデムが <span class=filename>/dev/ttyd0</span> に割り当てられていたら、<code>ps ax</code> コマンドを実行すると、以下のような出力が得られるはずです。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>4850 ??  I      0:00.09 /usr/libexec/getty V19200 ttyd0</code></pre></div></div><div class=paragraph><p>ユーザがモデムに電話をかけ、モデム同士が接続されると、 モデムの CD (Carrier Detect) が検出されます。その結果、 kernel がキャリア信号を検出して、<code>getty</code> によるポートのオープンの処理が終了します。 <code>getty</code> は、<code>login:</code> プロンプトを指定されている初期回線速度で送信します。 <code>getty</code> は、 正常に文字列を受信できるかどうか監視し、通常の設定では、 もし異常な文字列を検出した場合 (理由としては、 <code>getty</code> の速度とモデ ムの接続速度が異なっているような場合が考えられます)、 正常に文字列が 受信できるまで、<code>getty</code> は速度を変え続けます。</p></div><div class=paragraph><p>ユーザがログイン名を入力すると、 <code>getty</code> は <span class=filename>/usr/bin/login</span> を起動して、 パスワードの入力を要求し、その 後ユーザのシェルを起動します。</p></div></div><div class=sect2><h3 id=_設定ファイル>17.4.4. 設定ファイル<a class=anchor href=#_設定ファイル></a></h3><div class=paragraph><p>FreeBSD のシステムへのダイアルアップによるアクセスを実現するために編集が必要と思われる設定ファイルが、 <span class=filename>/etc</span> ディレクトリに 3 つあります。まず、 <span class=filename>/etc/gettytab</span> には、 <span class=filename>/usr/libexec/getty</span> デーモンの設定を記述します。つぎに、 <span class=filename>/etc/ttys</span> に保存されている情報から、 <span class=filename>/sbin/init</span> はどの <span class=filename>tty</span> デバイスに対して <code>getty</code> のプロセスを実行するべきか判断します。 最後に、<span class=filename>/etc/rc.serial</span> スクリプトに、 シリアルポートの初期化のためのコマンドを記述することができます。</p></div><div class=paragraph><p>Unix にダイアルアップモデムを接続する方法には、 二つの考え方があります。一つの方法は、 ダイアルインしてくるユーザの接続速度に関係なく、 常にモデムとローカルのコンピュータの RS-232 インタフェースの接続速度を一定に保つように設定する方法です。 この設定の長所は、ユーザがダイアルインして接続されると、 即座にシステムからのログインプロンプトが送信されるということです。 短所は、システムが実際のモデム間の速度を知ることができないために、 Emacs のようなフルスクリーンのプログラムが、 端末との接続速度が遅い場合でも、 そのような場合に効果的な方法で画面出力を行わない点です。</p></div><div class=paragraph><p>もう一つは、モデムの RS-232 インタフェースとコンピュータの接続速度を、 モデム間の接続速度に応じて変化させるような設定です。たとえば、 モデム間 の接続が V.32bis (14.4 Kbps) ならば、 モデムとコンピュータの間の接続を 19.2 Kbps とし、 モデム間の接続が 2400 bps の時には、モデムとコンピュータ間も 2400 bps で接続するような設定をします。この場合、 <code>getty</code> は、モデムが返すリザルトコードからモデムとコンピュータの接続速度を認識することができませんので、 <code>getty</code> は、まず初期速度で <code>login:</code> という文字列を送信して、それに対する応答の文字列を監視します。 ここで、ユーザ側の端末に無意味な文字列が表示された場合、 ユーザは意味のある文字列を受信するまで Enter キーを繰り返し押さなければならないということを知っていると仮定しています。 もし接続速度が間違っている場合、<code>getty</code> は、 ユーザから送られた文字を無意味な文字列として扱い、 次の速度を試します。そして、ここで再度 <code>login:</code> プロンプトを送信します。 この一連の動作が異常な回数繰り返されることも考えられますが、 普通は 1 度か 2 度のキー入力があれば、 ユーザはまともなプロンプトを受信できます。 このログインの動作が前者の固定速度による方法に比べて美しくないのは明らかですが、 この方法では、低速度で接続しているユーザに対するフルスクリーンのプログラムからのレスポンスが改善されます。</p></div><div class=paragraph><p>このセクションでは、両方の設定方法について解説しますが、 どちらかというとモデム間の速度に応じて RS-232 インタフェースの速度が変化するような 設定の方に偏った説明になってしまうと思います。</p></div><div class=sect3><h4 id=_etcgettytab>17.4.4.1. <span class=filename>/etc/gettytab</span><a class=anchor href=#_etcgettytab></a></h4><div class=paragraph><p><span class=filename>/etc/gettytab</span> は、<a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a> の設定ファイルで、<a href="https://man.freebsd.org/cgi/man.cgi?query=termcap&amp;sektion=5&amp;format=html">termcap(5)</a> と同様の形式で記述されます。ファイルのフォーマットや定 義できる機能についての詳細については、<a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a> のマニュアルを ご覧ください。</p></div><div class=sect4><h5 id=_固定速度の設定>17.4.4.1.1. 固定速度の設定<a class=anchor href=#_固定速度の設定></a></h5><div class=paragraph><p>モデムとコンピュータ間の通信速度を固定して使う場合、 おそらく <span class=filename>/etc/gettytab</span> に特に変更を加える必要はないはずです。</p></div></div><div class=sect4><h5 id=_可変速度の設定>17.4.4.1.2. 可変速度の設定<a class=anchor href=#_可変速度の設定></a></h5><div class=paragraph><p><code>getty</code> が利用するモデムとコンピュータの接続速度に関する情報を <span class=filename>/etc/gettytab</span> に記述する必要があります。もし、2400 bps のモ デムをお使いになるのであれば、既存の <code>D2400</code> のエントリがそのまま利 用できるでしょう。</p></div><div class="literalblock programlisting"><div class=content><pre>#
# Fast dialup terminals, 2400/1200/300 rotary (can start either way)
#
D2400|d2400|Fast-Dial-2400:\
        :nx=D1200:tc=2400-baud:
3|D1200|Fast-Dial-1200:\
        :nx=D300:tc=1200-baud:
5|D300|Fast-Dial-300:\
        :nx=D2400:tc=300-baud:</pre></div></div><div class=paragraph><p>高速モデムをお使いの場合は、おそらく <span class=filename>/etc/gettytab</span> に新たなエントリを追加する必要があります。 以下の例は、14.4 Kbps のモデムを、 最大インタフェース速度を 19.2 Kbps として利用するためのエントリです。</p></div><div class="literalblock programlisting"><div class=content><pre>#
# Additions for a V.32bis Modem
#
um|V300|High Speed Modem at 300,8-bit:\
        :nx=V19200:tc=std.300:
un|V1200|High Speed Modem at 1200,8-bit:\
        :nx=V300:tc=std.1200:
uo|V2400|High Speed Modem at 2400,8-bit:\
        :nx=V1200:tc=std.2400:
up|V9600|High Speed Modem at 9600,8-bit:\
        :nx=V2400:tc=std.9600:
uq|V19200|High Speed Modem at 19200,8-bit:\
        :nx=V9600:tc=std.19200:</pre></div></div><div class=paragraph><p>上記の例を利用した場合、 パリティなし、8ビットの接続が行われます。</p></div><div class=paragraph><p>上記の例では、まず 19.2 Kbps (V.32bis) によるモデムとコンピュータ間の接続を試み、続いて 9600 bps (V.32)、2400 bps、1200 bps、300 bpsと順に試み、再び 19.2 Kbps による接続を試みるという循環に入ります。 この接続速度の循環は、<code>nx=</code>("next table") の機能で実現されています。また、 各行はそれぞれ <code>tc=</code>("table continuation") の機能を使って、 その他の接続速度に依存した "標準的な" 設定を取り込んでいます。</p></div><div class=paragraph><p>もし、お使いのモデムが 28.8 Kbps であったり、14.4 Kbps の圧縮転送の機能を有効に利用したい場合は、19.2 Kbps よりも速い速度を利用するように設定する必要があります。 以下に 57.6 Kbps から接続を試みる <span class=filename>gettytab</span> の設定例を示しておきます。</p></div><div class="literalblock programlisting"><div class=content><pre>#
# Additions for a V.32bis or V.34 Modem
# Starting at 57.6 Kbps
#
vm|VH300|Very High Speed Modem at 300,8-bit:\
        :nx=VH57600:tc=std.300:
vn|VH1200|Very High Speed Modem at 1200,8-bit:\
        :nx=VH300:tc=std.1200:
vo|VH2400|Very High Speed Modem at 2400,8-bit:\
        :nx=VH1200:tc=std.2400:
vp|VH9600|Very High Speed Modem at 9600,8-bit:\
        :nx=VH2400:tc=std.9600:
vq|VH57600|Very High Speed Modem at 57600,8-bit:\
        :nx=VH9600:tc=std.57600:</pre></div></div><div class=paragraph><p>もし、お使いの CPU が低速のものであったり、CPU に対する負荷が高い場合で、16550A 系のシリアルポートをお使いでない場合、 57.6 Kbps の接続において、<code>sio</code> の "silo" エラーが発生するかもしれません。</p></div></div></div><div class=sect3><h4 id=dialup-ttys>17.4.4.2. <span class=filename>/etc/ttys</span><a class=anchor href=#dialup-ttys></a></h4><div class=paragraph><p><span class=filename>/etc/ttys</span> ファイルの設定は、<a href=#ex-etc-ttys>端末の項目を <span class=filename>/etc/ttys</span> に追加する</a> で扱われています。 モデムの設定も似たようなものですが、<code>getty</code> に異なる引数を渡して、異なる端末種別を指定しなければなりません。 固定速度および可変速度両方に共通する形式は次のようになります。</p></div><div class="literalblock programlisting"><div class=content><pre>ttyd0   &#34;/usr/libexec/getty xxx&#34;   dialup on</pre></div></div><div class=paragraph><p>1 番目の項目は、このエントリで対象とするデバイススペシャルファイルです。 上の例では <code>ttyd0</code> として、 <span class=filename>/dev/ttyd0</span> を <code>getty</code> に監視させることを表しています。2 番目の項目 <code>"/usr/libexec/getty xxx"</code> (<em>xxx</em> は初期段階で使われる <span class=filename>gettytab</span> のエントリに置き換えてください) が、<code>init</code> がこのディバイスに対して起動するプロセスです。3 番目の <code>dialup</code> は、デフォルトのターミナルタイプです。 4 番目の <code>on</code> は、 この行が有効であることを <code>init</code> に対して示しています。5 番目の項目に <code>secure</code> を指定することもできますが、これは、 たとえばシステムのコンソールのように、 物理的に安全な端末に対してのみ指定するようにしてください。</p></div><div class=paragraph><p>デフォルトのターミナルタイプ (上記の例では <code>dialup</code>) は、ローカルのユーザの好みによって異なってきます。 ユーザがログインスクリプトをカスタマイズして、ターミナルタイプが <code>dialup</code> の時には自動的に他のターミナルタイプを設定できるように、 ダイアルアップのポートのデフォルトのターミナルタイプには <code>dialup</code> が伝統的に用いられています。 しかし、筆者のサイトでは、ほとんどのユーザが VT102 エミュレーションを使っているので、 ダイアルアップのポートのデフォルトターミナルタイプとして <code>vt102</code> を指定しています。</p></div><div class=paragraph><p><span class=filename>/etc/ttys</span> の修正がすんだら、 以下のようなコマンドを使って <code>init</code> プロセスに HUP シグナルを送り、<span class=filename>/etc/ttys</span> を読み込み直させてください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -HUP 1</span></code></pre></div></div><div class=paragraph><p>ただ、もし初めてシステムを設定しているのであれば、 モデムが適切に設定されて接続されるまでは、 <code>init</code> に対してシグナルを送らない方がいいかもしれません。</p></div><div class=sect4><h5 id=_固定速度の設定_2>17.4.4.2.1. 固定速度の設定<a class=anchor href=#_固定速度の設定_2></a></h5><div class=paragraph><p>速度を固定する設定では、<span class=filename>/etc/ttys</span> の中で、<code>getty</code> に対し て固定速度のエントリを指定する必要があります。たとえば、 以下の例はポートのスピードが 19.2 Kbps に固定されたモデムのための <span class=filename>ttys</span> のエントリです。</p></div><div class="literalblock programlisting"><div class=content><pre>ttyd0   &#34;/usr/libexec/getty std.19200&#34;   dialup on</pre></div></div><div class=paragraph><p>モデムが異なる速度で固定されている場合は、 <code>std.19200</code> のかわりに <code>std.speed</code> を適切な値に置き換えたものにしてください。 <span class=filename>/etc/gettytab</span> に挙がっている適切な種類を使うようにしてください。</p></div></div><div class=sect4><h5 id=_可変速度の設定_2>17.4.4.2.2. 可変速度の設定<a class=anchor href=#_可変速度の設定_2></a></h5><div class=paragraph><p>可変速度の設定では、<span class=filename>ttys</span> のエントリが、<span class=filename>/etc/gettytab</span> の中の適切な "自動速度調整" の初期設定のエントリを参照していなければな りません。 たとえば、もし前述の 19.2 Kbps から接続を試みる可変速度の設定例 (<code>V19200</code> の <span class=filename>gettytab</span> エントリ)をそのまま <em>ttys</em> に追加したのであれば、 <span class=filename>ttys</span> エントリは以下のようになります。</p></div><div class="literalblock programlisting"><div class=content><pre>ttyd0   &#34;/usr/libexec/getty V19200&#34;   dialup on</pre></div></div></div></div><div class=sect3><h4 id=_etcrc_serial>17.4.4.3. <span class=filename>/etc/rc.serial</span><a class=anchor href=#_etcrc_serial></a></h4><div class=paragraph><p>V.32、V.32bis または V.34 モデムのような高速モデムを利用する場合、ハードウェア (<span class=filename>RTS/CTS</span>) フロー制御を行う必要があります。FreeBSD kernel のモデムポートにハードウェアフロー制御のフラグを設定するための <code>stty</code> コマンドを、 <span class=filename>/etc/rc.serial</span> に記述できます。</p></div><div class=paragraph><p>たとえば、シリアルポート 1 番 (<span class=filename>COM2</span>) のダイヤルインおよびダイヤルアウト初期化デバイスに <code>termios</code> フラグ <code>crtscts</code> を設定するには、次の行を <span class=filename>/etc/rc.serial</span> に追加するとよいでしょう。</p></div><div class="literalblock programlisting"><div class=content><pre># Serial port initial configuration
stty -f /dev/ttyid1 crtscts
stty -f /dev/cuai01 crtscts</pre></div></div></div></div><div class=sect2><h3 id=_モデムの設定>17.4.5. モデムの設定<a class=anchor href=#_モデムの設定></a></h3><div class=paragraph><p>もし、あなたのモデムがパラメータを不揮発ラムに 保存できるタイプならば、MS-DOS 上の Telix や FreeBSD 上の <code>tip</code> などのような通信プログラム を使って、 パラメータを設定してください。<code>getty</code> が利用する初期速度でモデムに接続して、以下の条件を満たすよ うに不揮発ラムの設定を変更してください。</p></div><div class=ulist><ul><li><p>接続時に CD 信号がオンになる</p></li><li><p>接続時に DTR がオンになり、 オフで回線を切断しモ デムをリセットする。</p></li><li><p>送信時フロー制御には CTS を利用。</p></li><li><p>XON/XOFF によるフロー制御を行わない。</p></li><li><p>受信時のフロー制御は RTS を使用。</p></li><li><p>Quiet mode (リザルト コードを返さない)</p></li><li><p>コマンド エコーを返さない。</p></li></ul></div><div class=paragraph><p>これらを実現するためのコマンドやディップ スイッチの設定に関しては、モ デムのマニュアルを参照してください。</p></div><div class=paragraph><p>以下に、USRobotics Sportster の 14,400 bps の外づけモデムの設定例を示 しておきます。</p></div><div class="literalblock programlisting"><div class=content><pre>ATZ
ATC1D2H1I0R2W</pre></div></div><div class=paragraph><p>ことのついでに、たとえば、V42.bis や MNP5 のデータ圧縮を使用するかど うかなどのモデムの他の設定について確認、 調整しておくのもよいかもしれま せん。</p></div><div class=paragraph><p>さらに、USRobotics Sportster の 14,400 bps の外づけモデムでは、以下の ようなディップ スイッチの設定も必要です。他のモデムをお使いの方も、以 下の例を設定の参考にしてください。</p></div><div class=ulist><ul><li><p>スイッチ 1: UP - DTR 標準</p></li><li><p>スイッチ 2: N/A (リザルトコードを単語形式にするか数値形式にするか)</p></li><li><p>スイッチ 3: UP - リザルトコードを返さない</p></li><li><p>スイッチ 4: DOWN - コマンドエコーを返さない</p></li><li><p>スイッチ 5: UP - 自動着信</p></li><li><p>スイッチ 6: UP - CD 標準</p></li><li><p>スイッチ 7: UP - 不揮発ラムからデフォルト値をロードする</p></li><li><p>スイッチ 8: N/A (Smart Mode/Dumb Mode)</p></li></ul></div><div class=paragraph><p>リザルト コードを返さないように設定しておかないと、 <code>getty</code> が誤っ て <code>login:</code> プロンプトをコマンド モードのモデムに送信してしまった場 合に、 モデムがこの入力をエコーしたり、この入力に対するリザルト コード を返してしまったりすることになります。この結果として、 モデムと <code>getty</code> の間で延々と無意味なやりとりが続いてしまう可能性があります。</p></div><div class=sect3><h4 id=_固定速度の設定_3>17.4.5.1. 固定速度の設定<a class=anchor href=#_固定速度の設定_3></a></h4><div class=paragraph><p>固定速度の設定では、 モデムとコンピュータ間の通信速度をモデムとモデム間 の接続速度に関係なく、常に一定に保つように、 モデムを設定する必要があり ます。USRobotics Sportster の 14,400 bps 外づけモデムの場合、以下のコ マンドで、 モデムとコンピュータ間の速度が、コマンド送信時の速度に固定さ れます。</p></div><div class="literalblock programlisting"><div class=content><pre>ATZ
ATB1W</pre></div></div></div><div class=sect3><h4 id=_可変速度の設定_3>17.4.5.2. 可変速度の設定<a class=anchor href=#_可変速度の設定_3></a></h4><div class=paragraph><p>可変速度の設定では、シリアル ポートの速度が、 着信速度に応じて変化する ように設定しなければいけません。 USRobotics Sporster の 14,400 bps 外 づけモデムの場合、 以下のコマンドで、エラー訂正機能を利用した通信の場合 は、 コマンドを送信した時の通信速度にシリアル ポートの速度を固定し、エ ラー訂正機能を利用しない接続では、 シリアル ポートの速度が変化するよう に設定されます。</p></div><div class="literalblock programlisting"><div class=content><pre>ATZ
ATB2W</pre></div></div></div><div class=sect3><h4 id=_モデムの設定の確認>17.4.5.3. モデムの設定の確認<a class=anchor href=#_モデムの設定の確認></a></h4><div class=paragraph><p>ほとんどの高速モデムには、 現在の設定をある程度人間にも理解できる形式に して表示させるコマンドがあります。USRobotics Sporster の 14,400 bps 外づけモデムの場合は、<code>ATI5</code> コマンドで、現在の不揮発ラムの設定を 表示することができます。 さらに、ディップ スイッチの設定も含めた現在の 設定を確認するためには、<code>ATZ</code> コマンドを送信してから、<code>ATI4</code> コマンドを送信してください。</p></div><div class=paragraph><p>他のメーカーのモデムをお使いの場合は、 モデムのマニュアルで設定値の確認 方法を確認してください。</p></div></div></div><div class=sect2><h3 id=_トラブルシューティング>17.4.6. トラブルシューティング<a class=anchor href=#_トラブルシューティング></a></h3><div class=paragraph><p>以下の手順でダイアル アップ モデムの動作を確認することができます。</p></div><div class=sect3><h4 id=_freebsd_システムの動作確認>17.4.6.1. FreeBSD システムの動作確認<a class=anchor href=#_freebsd_システムの動作確認></a></h4><div class=paragraph><p>モデムを FreeBSD システムに接続し、 システムをブートします。あなたのモ デムにモデムの状態を確認するためのインジケータがあれば、 DTR のイ ンジケータの状態に注目してください。もし、 システムのコンソールに <code>login:</code> プロンプトが表示された時に、DTR のインジケータが点灯 すれば、FreeBSD が適切なポートに対して <code>getty</code> を起動し、モデムへ の着信を待っている状態であることを意味しています。</p></div><div class=paragraph><p>もし DTR のインジケータが点灯しない場合は、システムのコンソールから FreeBSD にログインして、<code>ps ax</code> を実行し、 FreeBSD が適切なポートに対して<code>getty</code> プロセスを起動しようとしているのかどうか確認してください。 プロセスに関する情報の中に、 以下のような行が表示されるはずです。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  114 ??  I      0:00.10 /usr/libexec/getty V19200 ttyd0
  115 ??  I      0:00.10 /usr/libexec/getty V19200 ttyd1</code></pre></div></div><div class=paragraph><p>モデムにまだ着信がない状態の時に、 以下のように上とは異なる出力があった 場合、<code>getty</code> は既にモデム ポートのオープンを終了したということに なります。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  114 d0  I      0:00.10 /usr/libexec/getty V19200 ttyd0</code></pre></div></div><div class=paragraph><p><code>getty</code> は、CD (carrier detect) 信号がオンの状態になるまで、 ポートのオープンを完了することはできませんので、 この場合は接続に問題が あるか、あるいはモデムの設定に問題があることが考えられます。</p></div><div class=paragraph><p>もし、期待した <span class=filename>ttydN</span> ポートをオープンしようとしている <code>getty</code> が見あたらない場合は、再度 <span class=filename>/etc/ttys</span> の内容を確認し、 書式などに誤りがないか 調べてみてください。また、ログ ファイル <span class=filename>/var/log/messages</span> に <code>init</code> および <code>getty</code> から何か出力がないかどうかも確認してみてく ださい。 もし何かメッセージが記録されていたら、再度 <span class=filename>/etc/ttys</span>、 <span class=filename>/etc/gettytab</span> の二つの設定ファイルと、 ディバイス スペシャルファイル <span class=filename>/dev/ttydN</span> を確認し、 記述に誤りがないか、足りないエントリがないか、 足りないディバイス スペシャルファイルがないかといった 点について調べてみてください。</p></div></div><div class=sect3><h4 id=_モデムで接続してみる>17.4.6.2. モデムで接続してみる<a class=anchor href=#_モデムで接続してみる></a></h4><div class=paragraph><p>実際にモデムを使って別のコンピュータから 接続してみてください。この時、8 ビット、パリティなし、 1 ストップビットで接続するようにしてください。 接続後すぐにプロンプトが返ってこない場合や、 無意味な文字列が表示される 場合は、1秒に1回くらいの割合で Enter キーを押してみてください。 しばらくたって、なおも <code>login:</code> プロンプトが現れない場合 は、<code>BREAK</code> 信号を送信してみてください。この時、端末側で使って いるモデムが高速モデムならば、 このモデムのインタフェースの接続速度を固 定してから、 再度ダイアル インしてみてください。(たとえば、USRobotics Sportster の場合は、<code>ATB1</code>)</p></div><div class=paragraph><p>それでもまだ <code>login:</code> プロンプトが表示されない場合は、 <span class=filename>/etc/gettytab</span> の以下の点について再度確認してみてください。</p></div><div class=ulist><ul><li><p><span class=filename>/etc/ttys</span> の対応する行の 2番目の項目で、<span class=filename>/etc/gettytab</span> の中で定義されているエントリが指定されているか</p></li><li><p>各 <code>nx=</code> で <span class=filename>/etc/gettytab</span> の中で定義されているもの が指定されているか</p></li><li><p>各 <code>tc=</code> で <span class=filename>/etc/gettytab</span> の中で定義されているもの が指定されているか</p></li></ul></div><div class=paragraph><p>もしダイアル インしても、FreeBSD システム側のモデムが応答しない場合は、FreeBSD 側のモデムが DTR がオンになった時に電話にでるように設定さ れているかを確認してください。 もしモデムの設定に問題がなさそうならば、 モデムのインジケータ (がもしあれば) で、 DTR がオンになっているか を確認してください。</p></div><div class=paragraph><p>この確認のステップを数回繰り返しても うまくいかない場合は、一度休憩して、 しばらくたってから挑戦してみましょう。それでもだめなら、 おそらく <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD general questions メーリングリスト</a> にあなたのモデムについての情報と問題を書いたメールを送れ ば、 メーリング リストのメンバーが問題の解決を助けるべく努力してくれる でしょう。</p></div></div></div></div></div><div class=sect1><h2 id=dialout>17.5. ダイアルアウトサービス<a class=anchor href=#dialout></a></h2><div class=sectionbody><div class=paragraph><p>以下はモデムを利用して他のコンピュータと 接続する方法を説明しています。 これはリモートホストとターミナル接続を確立するための 適切な方法です。</p></div><div class=paragraph><p>これは BBS に接続するときによく使います。</p></div><div class=paragraph><p>この種の接続は PPP 接続に問題がある場合、Internet 上にあるファイルを 転送するのに非常に役に立ちます。FTP で何らかのファイルを転送したいのに PPP 接続を確立できない場合は、ファイルを FTP 転送するためにターミナルセッション を利用します。そして ZMODEM を利用してファイルを転送します。</p></div><div class=sect2><h3 id=_私の_hayes_モデムはサポートされていません_どうすればよいでしょう>17.5.1. 私の Hayes モデムはサポートされていません、 どうすればよいでしょう?<a class=anchor href=#_私の_hayes_モデムはサポートされていません_どうすればよいでしょう></a></h3><div class=paragraph><p>実際、<code>tip</code> の マニュアルページは古くなっています。既に Hayes ダイアラが組み込まれています。<span class=filename>/etc/remote</span> ファイル中で <code>at=hayes</code> を使ってください。</p></div><div class=paragraph><p>Hayes ドライバは、最近のモデムの新しい機能である <code>BUSY</code>、<code>NO DIALTONE</code>、 <code>CONNECT 115200</code>などのメッセージを 認識できるほど賢くはなく、単に混乱を起こすだけです。 <code>tip</code>を使う場合には、 (<code>ATX0W</code> とするなどして) これらの メッセージを表示させないようにしなくてはいけません。</p></div><div class=paragraph><p>また、<code>tip</code> のダイアルのタイムアウトは 60秒です。モデムの タイムアウト設定はそれより短くすべきであり、 そうしないと <code>tip</code> は通信に問題があると判断するでしょう。 <code>ATS7=45W</code> を実行してください。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>デフォルトの <code>tip</code> は、 Hayes モデムに完全に対応しているわけではありません。解決方法は <span class=filename>/usr/src/usr.bin/tip/tip</span> の下の <span class=filename>tipconf.h</span> を変更することです。 もちろんこれにはソース配布ファイルが必要です。</p></div><div class=paragraph><p><code>#define HAYES 0</code> と記述されている行を <code>#define HAYES 1</code> と変更し、そして <code>make</code>, <code>make install</code> を実行します。これでうまく動作するでしょう。</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=direct-at>17.5.2. これらの AT コマンドを入力するには?<a class=anchor href=#direct-at></a></h3><div class=paragraph><p><span class=filename>/etc/remote</span> ファイルの中で "direct" エントリを作ります。たとえばモデムが 1番目のシリアルポートである <span class=filename>/dev/cuaa0</span> に接続されている場合、次のようにします:</p></div><div class="literalblock programlisting"><div class=content><pre>cuaa0:dv=/dev/cuaa0:br#19200:pa=none</pre></div></div><div class=paragraph><p>モデムがサポートする最大の bps レートを br フィールドに使います。そして <code>tip cuaa0</code> を実行すると、モデムが利用できるようになります。</p></div><div class=paragraph><p><span class=filename>/dev/cuaa0</span> がシステムに存在しない場合は、次のようにします:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /dev</span>
<span class=c># sh MAKEDEV cuaa0</span></code></pre></div></div><div class=paragraph><p>または <code>root</code> になって以下のように <code>cu</code> コマンドを実行します:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -lline -sspeed</span></code></pre></div></div><div class=paragraph><p><em>line</em> にはシリアルポートを指定します (例えば <span class=filename>/dev/cuaa0</span>)。そして <em>speed</em> には接続する速度を指定します (例えば <code>57600</code>)。その後 AT コマンドを実行したら、<kbd>~.</kbd> と入力すれば終了します。</p></div></div><div class=sect2><h3 id=_pn_機能の_記号が使えません>17.5.3. pn 機能の <code>@</code> 記号が使えません!<a class=anchor href=#_pn_機能の_記号が使えません></a></h3><div class=paragraph><p>電話番号 (pn) 機能の中での <code>@</code> 記号は、 tip に <span class=filename>/etc/phone</span> にある電話番号を参照するように伝えます。しかし <code>@</code> の文字は <span class=filename>/etc/remote</span> のような 設定ファイルの中では特殊文字となります。 バックスラッシュを使ってエスケープをおこないます:</p></div><div class="literalblock programlisting"><div class=content><pre>pn=\@</pre></div></div></div><div class=sect2><h3 id=_コマンドラインから電話番号を指定するには>17.5.4. コマンドラインから電話番号を指定するには?<a class=anchor href=#_コマンドラインから電話番号を指定するには></a></h3><div class=paragraph><p>"generic" エントリと呼ばれるものを <span class=filename>/etc/remote</span> に追加します。 例えば次のようにします:</p></div><div class="literalblock programlisting"><div class=content><pre>tip115200|Dial any phone number at 115200 bps:\
	    :dv=/dev/cuaa0:br#115200:at=hayes:pa=none:du:
tip57600|Dial any phone number at 57600bps:\
	    :dv=/dev/cuaa0:br#57600:at=hayes:pa=none:du:</pre></div></div><div class=paragraph><p>そして</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tip -115200 5551234</span></code></pre></div></div><div class=paragraph><p>のように利用できます。 <code>tip</code> より <code>cu</code> を使いたい場合、 <code>cu</code> の generic エントリを使います。</p></div><div class="literalblock programlisting"><div class=content><pre>cu115200|Use cu to dial any number at 115200bps:\
	:dv=/dev/cuaa1:br#57600:at=hayes:pa=none:du:</pre></div></div><div class=paragraph><p>そして</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu 5551234 -s 115200</span></code></pre></div></div><div class=literalblock><div class=content><pre>と実行します。</pre></div></div></div><div class=sect2><h3 id=_毎回_bps_レートを入力しなければいけませんか>17.5.5. 毎回 bps レートを入力しなければいけませんか?<a class=anchor href=#_毎回_bps_レートを入力しなければいけませんか></a></h3><div class=paragraph><p><code>tip1200</code> や <code>cu1200</code> 用のエントリを記述し、適切な通信速度を br フィールドに設定します。<code>tip</code> は 1200 bps が正しいデフォルト値であるとみなすので、 <code>tip1200</code> エントリを参照します。もちろん 1200 bps を使わなければならないわけではありません。</p></div></div><div class=sect2><h3 id=_ターミナルサーバを経由して複数のホストへアクセスしたいです>17.5.6. ターミナルサーバを経由して複数のホストへアクセスしたいです<a class=anchor href=#_ターミナルサーバを経由して複数のホストへアクセスしたいです></a></h3><div class=paragraph><p>毎回接続されるのを待って <code>CONNECT host</code> と入力する かわりに、tip の <code>cm</code> 機能を使います。 例えば、<span class=filename>/etc/remote</span> に次のようなエントリを追加します:</p></div><div class="literalblock programlisting"><div class=content><pre>pain|pain.deep13.com|Forrester&#39;s machine:\
	:cm=CONNECT pain\n:tc=deep13:
muffin|muffin.deep13.com|Frank&#39;s machine:\
	:cm=CONNECT muffin\n:tc=deep13:
deep13:Gizmonics Institute terminal server:\
	:dv=/dev/cuaa2:br#38400:at=hayes:du:pa=none:pn=5551234:</pre></div></div><div class=paragraph><p>これで、<code>tip pain</code> や <code>tip muffin</code> と実行すると pain や muffin のホストに接続することができ、 <code>tip deep13</code> を実行するとターミナルサーバに接続します。</p></div></div><div class=sect2><h3 id=_tip_を使ってそれぞれのサイトの_複数の回線に接続できますか>17.5.7. tip を使ってそれぞれのサイトの 複数の回線に接続できますか?<a class=anchor href=#_tip_を使ってそれぞれのサイトの_複数の回線に接続できますか></a></h3><div class=paragraph><p>これは大学に電話回線がいくつかあって 数千人の学生が接続しようとする 場合によくある問題です。</p></div><div class=paragraph><p>あなたの大学のエントリを <span class=filename>/etc/remote</span> ファイルに作成して、<code>pn</code> のフィールドには <code>@</code> を使います:</p></div><div class="literalblock programlisting"><div class=content><pre>big-university:\
	:pn=\@:tc=dialout
dialout:\
	:dv=/dev/cuaa3:br#9600:at=courier:du:pa=none:</pre></div></div><div class=paragraph><p>そして <span class=filename>/etc/phone</span> ファイルに大学の電話番号の一覧を書きます:</p></div><div class="literalblock programlisting"><div class=content><pre>big-university 5551111
big-university 5551112
big-university 5551113
big-university 5551114</pre></div></div><div class=paragraph><p><code>tip</code> は一連の電話番号を試みて、 最終的に接続できなければあきらめます。 リトライを続けさせたい場合は、<code>tip</code> を while ループに入れて 実行します。</p></div></div><div class=sect2><h3 id=_ctrlp_を_1_回送るために_ctrlp_を_2_度押す必要があるのはなぜ>17.5.8. <span class=keyseq><kbd>Ctrl</kbd>+<kbd>P</kbd></span> を 1 回送るために <span class=keyseq><kbd>Ctrl</kbd>+<kbd>P</kbd></span> を 2 度押す必要があるのはなぜ?<a class=anchor href=#_ctrlp_を_1_回送るために_ctrlp_を_2_度押す必要があるのはなぜ></a></h3><div class=paragraph><p><span class=keyseq><kbd>Ctrl</kbd>+<kbd>P</kbd></span> はデフォルトの "force (強制)" 文字であり、 <code>tip</code> に次の文字が リテラルデータであることを伝えます。force 文字は "変数の設定" を意味する <code>~s</code> エスケープによって他の文字にすることができます。</p></div><div class=paragraph><p><code>~sforce=single-char</code> と入力して改行します。<em>single-char</em> は、任意の 1 バイト文字です。 <em>single-char</em> を省略すると NUL 文字になり、これは <span class=keyseq><kbd>Ctrl</kbd>+<kbd>2</kbd></span> や <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Space</kbd></span> を押しても入力できます。また、 <em>single-char</em> に <span class=keyseq><kbd>Shift</kbd>+<kbd>Ctrl</kbd>+<kbd>6</kbd></span> を割り当てる方法を使っているターミナルサーバもあります。</p></div><div class=paragraph><p><span class=filename>$HOME/.tiprc</span> に次のように定義することで、任意の文字を force 文字として利用できます:</p></div><div class="literalblock programlisting"><div class=content><pre>force=single-char</pre></div></div></div><div class=sect2><h3 id=_打ち込んだ文字が突然すべて大文字になりました>17.5.9. 打ち込んだ文字が突然すべて大文字になりました??<a class=anchor href=#_打ち込んだ文字が突然すべて大文字になりました></a></h3><div class=paragraph><p><span class=keyseq><kbd>Ctrl</kbd>+<kbd>A</kbd></span> を押してしまい、caps-lock キーが壊れている場合のために設計された <code>tip</code> の "raise character" モードに入ったのでしょう。 既に述べたように <code>~s</code> を使って、 <code>raisechar</code> をより適切な値に 変更してください。もしこれら両方の機能を使用しないのであれば、 force 文字と同じ設定にすることもできます。</p></div><div class=paragraph><p>以下は <span class=keyseq><kbd>Ctrl</kbd>+<kbd>2</kbd></span> や <span class=keyseq><kbd>Ctrl</kbd>+<kbd>A</kbd></span> などを頻繁に使う必要のある Emacs ユーザにうってつけの .tiprc ファイルのサンプルです。</p></div><div class="literalblock programlisting"><div class=content><pre>force=^^
raisechar=^^</pre></div></div><div class=paragraph><p>^^ は <span class=keyseq><kbd>Shift</kbd>+<kbd>Ctrl</kbd>+<kbd>6</kbd></span> です。</p></div></div><div class=sect2><h3 id=_tip_でファイルを転送するには>17.5.10. <code>tip</code> でファイルを転送するには?<a class=anchor href=#_tip_でファイルを転送するには></a></h3><div class=paragraph><p>もし他の Unix のシステムと接続しているなら、 <code>~p</code>(put) や <code>~t</code>(take) でファイルの送受信ができます。これらのコマンドは 相手のシステムの上で <code>cat</code> や <code>echo</code> を実行することで 送受信をします。 書式は以下のようになります:
<code>~p</code> ローカルのファイル名 [ リモートのファイル名 ]
<code>~t</code> リモートのファイル名 [ ローカルのファイル名 ]</p></div><div class=paragraph><p>この方法ではエラーチェックをおこないませんので、zmodem などの他のプロトコルを使った方がよいでしょう。</p></div></div><div class=sect2><h3 id=_tip_から_zmodem_を実行するには>17.5.11. <code>tip</code> から zmodem を実行するには?<a class=anchor href=#_tip_から_zmodem_を実行するには></a></h3><div class=paragraph><p>ファイルを受信するには、 リモート側で送信プログラムを起動します。そして <code>~C rz</code> と入力すると、ローカル側へのファイルの受信が 始まります。</p></div><div class=paragraph><p>ファイルを送信するには、 リモート側で受信プログラムを起動します。そして <code>~C sz files</code> と入力すると、 リモート側への ファイルの送信が始まります。</p></div></div></div></div><div class=sect1><h2 id=serialconsole-setup>17.6. シリアルコンソールの設定<a class=anchor href=#serialconsole-setup></a></h2><div class=sectionbody><div class=sect2><h3 id=serialconsole-intro>17.6.1. 導入<a class=anchor href=#serialconsole-intro></a></h3><div class=paragraph><p>FreeBSD は、 コンソールとしてシリアルポート上のダム端末しか持たないシステムでも起動します。 この様な構成はきっと次のような二種類の人達に便利でしょう。それは、 キーボードやモニタのないマシンに FreeBSD をインストールしたいシステム管理者と、 カーネルやデバイスドライバをデバッグしたい開発者です。</p></div><div class=paragraph><p><a href=../boot/#boot>FreeBSD の起動のプロセス</a> で説明されているように、 FreeBSD は 3 ステージ構成のブートストラップを用いています。 最初の 2 つのステージは、 ブートディスクにある FreeBSD スライスの最初に格納されている、 ブートブロックのコードが行います。 それからブートブロックは、第 3 ステージのコードとしてブートローダ (<span class=filename>/boot/loader</span>) を読み込み、実行します。</p></div><div class=paragraph><p>シリアルコンソールを設定するためには、ブートブロックコード、 ブートローダコード、カーネルを設定する必要があります。</p></div></div><div class=sect2><h3 id=serialconsole-howto>17.6.2. シリアルコンソールの設定<a class=anchor href=#serialconsole-howto></a></h3><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>シリアルケーブルを用意してください。</p><div class=paragraph><p>ヌルモデムケーブル、 もしくは標準シリアルケーブルとヌルモデムアダプタが必要となります。 シリアルケーブルについては <a href=#serial-cables-ports>ケーブルとポート</a> をご覧ください。</p></div></li><li><p>キーボードをはずして下さい。</p><div class=paragraph><p>たいていの PC システムは Power-On Self-Test (POST) の間にキーボードを検出し、もし見つからなければエラーと なります。また、キーボードがないことを大きな音で知らせ、 キーボードが接続されるまでは起動を中断するようなマシンもあります。</p></div><div class=paragraph><p>コンピュータがエラーを表示していても、 とにかく起動するなら特別な対応は必要ありません (Phoenix BIOS を搭載しているマシンには、 <code>Keyboard failed</code> と表示されても、正常に起動するものがあります)。</p></div><div class=paragraph><p>あなたのコンピュータがキーボードを接続していない状態で 起動しないようなら、(もし可能ならば) エラーを無視するように BIOS を設定する必要があります。設定方法の詳細については、 マザーボードのマニュアルを調べてください。</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>BIOS の設定でキーボードを "Not installed" にするということは、キーボードを使えないということを 意味しているわけでは<em>ありません</em>。これは、BIOS がキーボードがなくても文句を言わないように、電源投入時には キーボードを探すな、と指示するだけです。このフラグを "Not installed" にしていてもキーボードを 接続したままにできますし、ちゃんと動作します。</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>あなたのシステムが PS/2 マウスを使っているなら、 おそらくマウスもキーボード同様にはずす必要があるでしょう。 というのは、PS/2 マウスは部分的にキーボードとハードウェアを 共有しており、マウスを接続したままにしていると、 キーボードも存在する、と誤って検出してしまう可能性があるからです。 AMI BIOS を持つ Gateway 2000 Pentium 90MHz システム はこれに該当すると言われています。 一般的にこれは問題ではありません。なぜなら、どっちにしても マウスはキーボードなしではたいして役に立たないからです。</p></div></td></tr></tbody></table></div></li><li><p><span class=filename>COM1</span> (<span class=filename>sio0</span>) にダム端末を接続してください。</p><div class=paragraph><p>ダム端末がなければ、かわりに古い PC/XT でモデム プログラムを走らせて使ったり、シリアルポートに他の Unix マシンを繋いだりできます。もしも <span class=filename>COM1</span> (<span class=filename>sio0</span>) がなければ、作成してください。 今のところ、<span class=filename>COM1</span> 以外のポートを 選択するためにはブートブロックの再コンパイルが必要です。 すでに <span class=filename>COM1</span> を他の装置に 使っていた場合は、一時的にその装置をはずして いったん FreeBSD がうまく動作してから、 新しいブートブロックとカーネルをインストールしてください。 (上記はとにかくファイル/演算/端末サーバの <span class=filename>COM1</span> が利用可能であると仮定して います。あなたが本当に何かのために <span class=filename>COM1</span> が必要 (で、なおかつその何かを <span class=filename>COM2</span> (<span class=filename>sio1</span>) に付け替えることができない) ならば、多分、そもそも 悩んでる場合ではありません。)</p></div></li><li><p>カーネルコンフィグファイルの <span class=filename>COM1</span> (<span class=filename>sio0</span>) に適切なフラグを 設定していることを確認してください。</p><div class=paragraph><p>関連するフラグ:</p></div><div class=dlist><dl><dt class=hdlist1><code>0x10</code></dt><dd><p>このポートのコンソールサポートを有効にします。 このフラグが設定されない場合、他のフラグは無視されます。 現在のところ、一つのポートしかコンソールサポートを有効に できません。(config ファイルに書かれた順番で) 最初にこのフラグを 指定されたポートが選択されます。 なお、このオプションを指定するだけでシリアルポートが コンソールとして使えるわけではありません。 このフラグと一緒に、以下のフラグも指定するかもしくは <code>-h</code> オプションも使ってください。</p></dd><dt class=hdlist1><code>0x20</code></dt><dd><p>後述される <code>-h</code> オプション を無視して、(他に優先度の高いコンソールがない限り) このポートをコンソールとして指定します。 このフラグは FreeBSD バージョン 2.<em>X</em> の <code>COMCONSOLE</code> オプションに対応するものです。 フラグ <code>0x20</code> は必ず フラグ <code>0x10</code> と一緒に指定されなければなりません。</p></dd><dt class=hdlist1><code>0x40</code></dt><dd><p>(<code>0x10</code> と組み合わせることで) このポートを予約し、通常のアクセスができない ようにします。 このフラグは、シリアルコンソールとして使いたいポートに 指定すべきではありません。 唯一の使い道は、ユニットがカーネルのリモートデバッグ用 であることを指定することです。 リモートデバッグの詳細については <a href=https://docs.freebsd.org/en/books/developers-handbook/>The Developer’s Handbook</a> を参照してください。</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>FreeBSD 4.0 以降では、 フラグ <code>0x40</code> の意味が若干異なり、 シリアルポートにリモートデバッグを指定するためには、 別のフラグを使います。</p></div></td></tr></tbody></table></div><div class=paragraph><p>例:</p></div><div class="literalblock programlisting"><div class=content><pre>device sio0 at isa? port &#34;IO_COM1&#34; tty flags 0x10 irq 4</pre></div></div><div class=paragraph><p>詳細については <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> のマニュアルを参照してください。</p></div><div class=paragraph><p>もしこれらのフラグがセットされていなければ、(別のコンソールで) UserConfig を実行するか、 カーネルを再コンパイルする必要があります。</p></div></dd></dl></div></li><li><p>ブートドライブの <code>a</code> パーティションの ルートディレクトリに <span class=filename>boot.config</span> を作成してください。</p><div class=paragraph><p>このファイルは、ブートブロックコードに対してどのように システムを起動したいかを教えます。 シリアルコンソールを活かすためには、以下のオプションを幾つか - 複数の場合も一行で、設定する必要があります:</p></div><div class=dlist><dl><dt class=hdlist1><code>-h</code></dt><dd><p>内蔵コンソールとシリアルコンソールの切替えを行います。 これを使用してコンソールデバイスを変更できます。 例えば、内蔵 (ビデオ) コンソールからブートした場合、 カーネルとブートローダがコンソールデバイスとして シリアルポートを使用するようにするため、 <code>-h</code> を使って指示できます。 反対に、シリアルポートからブートした場合、 ブートローダとカーネルがコンソールとして代わりに ビデオディスプレイを使用するようにするため、 <code>-h</code> を使用できます。</p></dd><dt class=hdlist1><code>-D</code></dt><dd><p>シングルとデュアルのコンソール設定を切り替えます。 シングル設定では、上記の <code>-h</code> オプションの状態によって、コンソールは内蔵コンソール (ビデオディスプレイ)かシリアルポートのいずれかになります。 デュアルコンソール設定では、ビデオディスプレイと シリアルポートの両方が、<code>-h</code> オプションの状態によらず、同時にコンソールになります。 しかし、デュアルコンソール設定は、ブートブロックが 実行されている間でしか効果を持ちません。 一旦ブートローダに制御が移ると、<code>-h</code> オプションによって指定されたコンソールが 唯一のコンソールになります。</p></dd><dt class=hdlist1><code>-P</code></dt><dd><p>ブートブロックがキーボードを検出するようにします。 キーボードが発見できなかった場合には、 <code>-D</code> と <code>-h</code> オプションが自動的にセットされます。</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>現バージョンのブートブロックでは容量の制限により、 <code>-P</code> オプションは拡張キーボードしか 検出できません。キーが 101 個より少ない (そして F11 と F12 がない) キーボードは検出されない可能性があります。 この制限から、いくつかのラップトップコンピュータの キーボードは正しく検出されないでしょう。 もし、あなたのシステムがこのようなキーボードを使っているのであれば、 <code>-P</code> オプションを外してください。 残念ながら、この問題の回避策はありません。</p></div></td></tr></tbody></table></div><div class=paragraph><p><code>-P</code> オプションを使ってコンソールを 自動的に選ぶか、<code>-h</code> オプションを使って シリアルコンソールを有効にしてください。</p></div><div class=paragraph><p>さらに <a href="https://man.freebsd.org/cgi/man.cgi?query=boot&amp;sektion=8&amp;format=html">boot(8)</a> で説明されている他のオプションも使う ことができます。</p></div><div class=paragraph><p><code>-P</code> 以外のオプションはブートローダ (<span class=filename>/boot/loader</span>) に渡されます。 ブートローダは、<code>-h</code> オプションだけの状態を 調べることで内蔵ビデオとシリアルポートのどちらがコンソールに なるのか決めます。 つまり、<span class=filename>/boot.config</span> の中で <code>-D</code> オプションを指定して <code>-h</code> オプションを指定しなかった場合、 ブートブロック実行中でのみシリアルポートをコンソールとして 使うことができます。ブートローダは内蔵ビデオディスプレイを コンソールとして使います。</p></div></dd></dl></div></li><li><p>マシンを起動する。</p><div class=paragraph><p>FreeBSD を起動したとき、ブートブロックは <span class=filename>/boot.config</span> の内容をコンソールに表示 します。例えば、</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/boot.config: <span class=nt>-P</span>
Keyboard: no</code></pre></div></div><div class=paragraph><p>行の二番目は、 <span class=filename>/boot.config</span> にオプション <code>-P</code> が指定してあるときだけ表示され、 キーボードが存在するかどうかを表します。 これらのメッセージは、シリアルか内蔵のいずれか、 あるいはその両方のコンソールに表示されます。 どちらに表示されるかは、 <span class=filename>/boot.config</span> の設定によって変わります。</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">オプション指定</th><th class="tableblock halign-left valign-top">メッセージの表示される場所</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>なし</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-h</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-D</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアルと内蔵の両方</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-Dh</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアルと内蔵の両方</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>、キーボードが存在する場合</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>、キーボードが存在しない場合</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr></tbody></table><div class=paragraph><p>このメッセージが表示された後、 ブートブロックがブートローダのロードを再開し、 他の全てのメッセージがコンソールに表示されるまで、 若干時間がかかります。通常の環境では、ブートブロックに 割り込みをかける必要はありませんが、 ちゃんとセットアップされているかどうか確かめるために、 割り込みをかけることができるようになっています。</p></div><div class=paragraph><p>ブートプロセスに割り込みをかけるには、 コンソールの (Enter 以外の) キーをたたいて下さい。 ブートブロックはその時、操作を指定するためのプロンプトを表示します。 こんな風に表示されるでしょう。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>&gt;&gt;</span> FreeBSD/i386 BOOT
Default: 0:wd<span class=o>(</span>0,a<span class=o>)</span>/boot/loader
boot:</code></pre></div></div><div class=paragraph><p>上に示したメッセージが、シリアルか内蔵、 あるいはその両方といった、<span class=filename>/boot.config</span> で指定したとおりのコンソールに表示されることを確認して下さい。 メッセージが正しいコンソールに表示されたら、 Enter キーを押してブートプロセスを継続してください。</p></div><div class=paragraph><p>もし、シリアルコンソールを利用するように設定しているのに シリアル端末にプロンプトが出てこない場合は、 設定のどこかに間違いがあります。 ブートブロック(とブートローダ、カーネル)に対して シリアルポートをコンソールに使うことを伝えるため、 割り込みをかけた時に <code>-h</code> を入力し、 (可能ならば) Enter/Return キーを押して下さい。そして、 一度システムを起動させてから、どこが悪いのかをチェックして下さい。</p></div></li></ol></div></div></div><div class=paragraph><p>ブートローダがロードされ、ブートプロセスの第三ステージに いる時には、まだ内蔵コンソールとシリアルコンソールを切り替えることができます。 それにはブートローダの環境変数を適切に設定すれは良いのですが、 詳細については <a href=#serialconsole-loader>ブートローダからコンソールを変更するには</a> を参照してください。</p></div></div><div class=sect2><h3 id=serialconsole-summary>17.6.3. まとめ<a class=anchor href=#serialconsole-summary></a></h3><div class=paragraph><p>このセクションで扱ったさまざまな設定と、 最終的に選択されるコンソールに関するまとめです。</p></div><div class=sect3><h4 id=_case_1_sio0_の_flags_に_0x10_をセットした場合>17.6.3.1. Case 1: <span class=filename>sio0</span> の flags に 0x10 をセットした場合<a class=anchor href=#_case_1_sio0_の_flags_に_0x10_をセットした場合></a></h4><div class="literalblock programlisting"><div class=content><pre>device sio0 at isa? port &#34;IO_COM1&#34; tty flags 0x10 irq 4</pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">/boot.config 内のオプション</th><th class="tableblock halign-left valign-top">ブートブロック実行中のコンソール</th><th class="tableblock halign-left valign-top">ブートローダ実行中のコンソール</th><th class="tableblock halign-left valign-top">カーネルのコンソール</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>なし</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-h</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-D</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵、シリアルの両方</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-Dh</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵、シリアルの両方</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>、キーボードが存在する場合</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>、キーボードが存在しない場合</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵、シリアルの両方</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr></tbody></table></div><div class=sect3><h4 id=_case_2_sio0_の_flags_に_0x30_をセットした場合>17.6.3.2. Case 2: sio0 の flags に 0x30 をセットした場合<a class=anchor href=#_case_2_sio0_の_flags_に_0x30_をセットした場合></a></h4><div class="literalblock programlisting"><div class=content><pre>device sio0 at isa? port &#34;IO_COM1&#34; tty flags 0x30 irq 4</pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">/boot.config 内のオプション</th><th class="tableblock halign-left valign-top">ブートブロック実行中のコンソール</th><th class="tableblock halign-left valign-top">ブートローダ実行中のコンソール</th><th class="tableblock halign-left valign-top">カーネルのコンソール</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>なし</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-h</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-D</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵、シリアルの両方</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-Dh</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵、シリアルの両方</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>、キーボードが存在する場合</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>、キーボードが存在しない場合</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>内蔵、シリアルの両方</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>シリアル</p></td></tr></tbody></table></div></div><div class=sect2><h3 id=serialconsole-tips>17.6.4. シリアルコンソールを利用する上で役に立つ情報<a class=anchor href=#serialconsole-tips></a></h3><div class=sect3><h4 id=_シリアルポートの通信速度をもっと速いものに設定するには>17.6.4.1. シリアルポートの通信速度をもっと速いものに設定するには<a class=anchor href=#_シリアルポートの通信速度をもっと速いものに設定するには></a></h4><div class=paragraph><p>デフォルトのシリアルポート通信速度は、9600 ボー、 8 ビット、パリティなし、ストップビット 1 です。 通信速度を変更したい場合には、少なくとも ブートブロックの再コンパイルが必要になります。 <span class=filename>/etc/make.conf</span> に次のような行を追加して、 新しくブートブロックをコンパイルして下さい。</p></div><div class="literalblock programlisting"><div class=content><pre>BOOT_COMCONSOLE_SPEED=19200</pre></div></div><div class=paragraph><p>もし、シリアルコンソールがブート時の <code>-h</code> オプション以外の方法で設定されていたり、 カーネルが利用するシリアルコンソールが ブートブロック実行中のものと異なる場合には、 カーネルコンフィグレーションファイルに次のオプションを追加して、 新しくカーネルをコンパイルしなければなりません。</p></div><div class="literalblock programlisting"><div class=content><pre>options CONSPEED=19200</pre></div></div></div><div class=sect3><h4 id=serialconsole-com2>17.6.4.2. <span class=filename>sio0</span> 以外のシリアルポートを コンソールとして使うには<a class=anchor href=#serialconsole-com2></a></h4><div class=paragraph><p><span class=filename>sio0</span> 以外のポートをコンソールとして使うには、再コンパイルが必要です。 それがどんな理由であれ、他のポートを使用する場合には ブートブロック、ブートローダ、カーネルを 次のようにして再コンパイルして下さい。</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>カーネルソースを取得する (<a href=../cutting-edge/#updating-upgrading>FreeBSD のアップデートとアップグレード</a> をご覧ください)。</p></li><li><p><span class=filename>/etc/make.conf</span> を編集し、 <code>BOOT_COMCONSOLE_PORT</code> に 使用したいポートのアドレス(0x3F8、0x2F8、0x3E8 or 0x2E8)を 設定してください。使用可能なのは <span class=filename>sio0</span> から <span class=filename>sio3</span> (<span class=filename>COM1</span> から <span class=filename>COM4</span>) までで、 マルチポートシリアルカードは使えません。 また、ここで割り込みの設定をする必要はありません。</p></li><li><p>設定を変更するために新たなカーネルコンフィグレーションファイルを作成し、 使いたいシリアルポートのフラグを適切に設定します。 例えば、<span class=filename>sio1</span> (<span class=filename>COM2</span>) をコンソールにしたければ、</p><div class="literalblock programlisting"><div class=content><pre>device sio1 at isa? port &#34;IO_COM2&#34; tty flags 0x10 irq 3</pre></div></div><div class=paragraph><p>または、</p></div><div class="literalblock programlisting"><div class=content><pre>device sio1 at isa? port &#34;IO_COM2&#34; tty flags 0x30 irq 3</pre></div></div><div class=paragraph><p>とします。その際、 他のシリアルポートにコンソールフラグをつけてはいけません。</p></div></li><li><p>ブートブロックを再コンパイルし、インストールする。</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /sys/boot/i386/boot2</span>
<span class=c># make</span>
<span class=c># make install</span></code></pre></div></div></li><li><p>ブートローダを再コンパイルし、インストールする。</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /sys/boot/i386/loader</span>
<span class=c># make</span>
<span class=c># make install</span></code></pre></div></div></li><li><p>カーネルを再構築し、インストールする。</p></li><li><p><a href="https://man.freebsd.org/cgi/man.cgi?query=disklabel&amp;sektion=8&amp;format=html">disklabel(8)</a> を使ってブートブロックをブートディスクに書き込み、 新しいカーネルから起動する。</p></li></ol></div></div></div></div><div class=sect3><h4 id=_シリアルポートから_ddb_デバッガを起動するには>17.6.4.3. シリアルポートから DDB デバッガを起動するには<a class=anchor href=#_シリアルポートから_ddb_デバッガを起動するには></a></h4><div class=paragraph><p>シリアルコンソールからカーネルデバッガを起動したい(これは リモートで診断する際に便利ですが、もしおかしな BREAK 信号がシリアルポートに送られるような場合には危険です!) 場合には、次のオプションを使ってカーネルをコンパイルして下さい。</p></div><div class="literalblock programlisting"><div class=content><pre>options BREAK_TO_DEBUGGER
options DDB</pre></div></div></div><div class=sect3><h4 id=_シリアルコンソールにログインプロンプトを表示させるには>17.6.4.4. シリアルコンソールにログインプロンプトを表示させるには<a class=anchor href=#_シリアルコンソールにログインプロンプトを表示させるには></a></h4><div class=paragraph><p>シリアルコンソールからブートメッセージを確認したり、 シリアルコンソールを経由してカーネルデバッグセッションに入ることが できるので、これは必要がないかもしれませんが、 <em>login</em> プロンプトをシリアルポートに 出力するように設定することもできます。 これには、次のようにします。</p></div><div class=paragraph><p>エディタで <span class=filename>/etc/ttys</span> というファイルを開き、 次に示す行に移動して下さい。</p></div><div class="literalblock programlisting"><div class=content><pre>ttyd0 &#34;/usr/libexec/getty std.9600&#34; unknown off secure
ttyd1 &#34;/usr/libexec/getty std.9600&#34; unknown off secure
ttyd2 &#34;/usr/libexec/getty std.9600&#34; unknown off secure
ttyd3 &#34;/usr/libexec/getty std.9600&#34; unknown off secure</pre></div></div><div class=paragraph><p><code>ttyd0</code> から <code>ttyd3</code> は、 <span class=filename>COM1</span> から <span class=filename>COM4</span> に対応しています。 設定したいポートの <code>off</code> を <code>on</code> に変更して下さい。 また、もしシリアルポートの通信速度を変更しているなら、 <code>std.9600</code> が実際の通信速度になるように、 例えば <code>std.19200</code> のように変更して下さい。</p></div><div class=paragraph><p>さらに、実際のシリアル端末に合わせて、 端末タイプを <code>unknown</code> から変更することも可能です。</p></div><div class=paragraph><p>ファイルの編集が終了したら、 変更を有効化するために <code>kill -HUP 1</code> を実行しなければなりません。</p></div></div></div><div class=sect2><h3 id=serialconsole-loader>17.6.5. ブートローダからコンソールを変更するには<a class=anchor href=#serialconsole-loader></a></h3><div class=paragraph><p>前セクションは、ブートブロックの設定を変更することでシリアルコンソールを セットアップする方法について解説していました。 このセクションでは、ブートローダへのコマンド入力と環境変数設定で コンソールの指定を行なう方法を紹介します。 ブートローダがブートブロックの後、 ブートプロセスの第三ステージで呼び出されたとき、 ブートローダの設定には、ブートブロックの設定がそのまま使われます。</p></div><div class=sect3><h4 id=_シリアルコンソールをセットアップする>17.6.5.1. シリアルコンソールをセットアップする<a class=anchor href=#_シリアルコンソールをセットアップする></a></h4><div class=paragraph><p>ブートローダとカーネルに対して シリアルコンソールを使用するように設定するには、 単に <span class=filename>/boot/loader.rc</span> のファイルに、次のような一行を書くだけで実現できます。</p></div><div class="literalblock programlisting"><div class=content><pre>set console=comconsole</pre></div></div><div class=paragraph><p>これは、前セクションで扱ったブートブロックの設定に 全く関係なく機能します。</p></div><div class=paragraph><p>上に示した行は、 <span class=filename>/boot/loader.rc</span> の最初の行に書き込まなくてはいけません。 これはできるだけ早く、ブートメッセージをシリアルコンソールに 出力させるために必要なことです。</p></div><div class=paragraph><p>同様にして、次のように内蔵コンソールを指定することもできます。</p></div><div class="literalblock programlisting"><div class=content><pre>set console=vidconsole</pre></div></div><div class=paragraph><p>もし、ブートローダの環境変数 <code>console</code> が設定されていない場合、 ブートローダ、そしてその次に起動するカーネルは ブートブロックで指定された <code>-h</code> オプションに 示されたコンソールを使用します。</p></div><div class=paragraph><p>3.2 以降のバージョンにおいては <span class=filename>/boot/loader.rc</span> ではなく、 <span class=filename>/boot/loader.conf.local</span> や <span class=filename>/boot/loader.conf</span> にコンソール指定を書き込みます。 その場合、 <span class=filename>/boot/loader.rc</span> は次のようになっていなければなりません。</p></div><div class="literalblock programlisting"><div class=content><pre>include /boot/loader.4th
start</pre></div></div><div class=paragraph><p>それから、<span class=filename>/boot/loader.conf.local</span> を作成して、次の行をそこに追加して下さい。</p></div><div class="literalblock programlisting"><div class=content><pre>console=comconsole</pre></div></div><div class=paragraph><p>か、もしくは</p></div><div class="literalblock programlisting"><div class=content><pre>console=vidconsole</pre></div></div><div class=paragraph><p>です。詳細については、<a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> を参照して下さい。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>その際、ブートローダはオプション指定なし (ブートブロックに <code>-P</code> オプションが指定されたのと等価)になり、 キーボードの存在を調べて 内蔵コンソールとシリアルコンソールを自動的に選択する機能は働きません。</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_sio0_以外のシリアルポートを_コンソールとして使うには>17.6.5.2. <span class=filename>sio0</span> 以外のシリアルポートを コンソールとして使うには<a class=anchor href=#_sio0_以外のシリアルポートを_コンソールとして使うには></a></h4><div class=paragraph><p><span class=filename>sio0</span> 以外のシリアルポートを コンソールとして使うには、ブートローダを再コンパイルする必要があります。 それには、 <a href=#serialconsole-com2><span class=filename>sio0</span> 以外のシリアルポートを コンソールとして使うには</a> に書かれている説明にしたがって下さい。</p></div></div></div><div class=sect2><h3 id=serialconsole-caveats>17.6.6. 注意<a class=anchor href=#serialconsole-caveats></a></h3><div class=paragraph><p>シリアルコンソールというアイデアは、 グラフィック出力用のハードウェアやキーボードが接続されていない 専用サーバのセットアップを可能にするためのものです。 ほとんどのシステムはキーボードなしで起動できますが、 不幸にも、グラフィックアダプタなしでは起動できないシステムはたくさんあります。 AMI BIOS を採用しているマシンでは、CMOS 設定の <code>graphics adapter</code> を <code>Not Installed</code> にするだけで、 グラフィックアダプタがなくとも起動できるように設定することができます。</p></div><div class=paragraph><p>しかしながら、多くのマシンはこのようなオプションを持っていませんし、 ディスプレイハードウェアがシステムに存在しないと起動しないように なっています。そのようなマシンでは、 モニタを接続する必要がなかったとしても、 適当なグラフィックカード(モノクロのジャンク品でも構いません)を 挿入したままにしておく必要があるでしょう。 また、AMI BIOS をインストールする、という手もあります。</p></div></div></div></div></div><hr><div class=last-modified><p><strong>最終更新日</strong>: 2024年3月9日 by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=http://172.16.201.134:1313/ja/books/handbook/partiv class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=http://172.16.201.134:1313/ja/books/handbook/ppp-and-slip class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#serial-synopsis>17.1. この章では</a></li><li><a href=#serial>17.2. はじめに</a></li><li><a href=#term>17.3. シリアル端末</a></li><li><a href=#dialup>17.4. ダイアルインサービス</a></li><li><a href=#dialout>17.5. ダイアルアウトサービス</a></li><li><a href=#serialconsole-setup>17.6. シリアルコンソールの設定</a></li></ul></nav><hr><div class=resources><h3>リソース</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="PDF 版のダウンロード"></i><a href=https://download.freebsd.org/doc/ja/books/handbook/handbook_ja.pdf>PDF 版のダウンロード</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/ja/_index target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/ja/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Choose language">
<span>日本語</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/ja class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/ja/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>