<!doctype html><html class=theme-light lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/ja/books/porters-handbook/book/><title>FreeBSD port 作成者のためのハンドブック | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="FreeBSD port 作成者のためのハンドブック"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="ja"><meta property="og:url" content="https://docs.freebsd.org/ja/books/porters-handbook/book/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/ja\/books\/porters-handbook\/book\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/ja>Documentation portal</a></li><li><a href=https://docs.freebsd.org/ja/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/ja/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/ja/books>Books</a></li><li><a href=https://docs.freebsd.org/ja/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/ja/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=ja>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><div class=book><h1 class=title>FreeBSD port 作成者のためのハンドブック</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=copyright>Copyright © 2000-2020 The FreeBSD Documentation Project</div><div class=legalnotice><a id=trademarks></a><details><summary>trademarks</summary><p>FreeBSD は The FreeBSD Foundation の登録商標です。</p><p>Sun, Sun Microsystems, Java, Java Virtual Machine, JDK, JRE, JSP, JVM, Netra, OpenJDK, Solaris, StarOffice, SunOS および VirtualBox は アメリカ合衆国およびその他の国における Sun Microsystems, Inc. の 商標または登録商標です。</p><p>UNIX は アメリカ合衆国およびその他の国における The Open Group の登録商標です。</p><p>製造者および販売者が製品を区別するのに 用いている表示の多くは、商標とされています。この文書に登場する表示のうち FreeBSD Project がその商標を確認しているものには、その表示に続いて“™” または “®” 記号がおかれています。</p></details></div><div class=toc-mobile><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#why-port>Chapter 1. はじめに</a></li><li><a href=#own-port>Chapter 2. 自分で port を作成するには</a></li><li><a href=#quick-porting>Chapter 3. 分間 porting</a><ul><li><a href=#porting-makefile>3.1. <span class=filename>Makefile</span> の作成</a></li><li><a href=#porting-desc>3.2. package 記述ファイルの作成</a></li><li><a href=#porting-checksum>3.3. チェックサムファイルの作成</a></li><li><a href=#porting-testing>3.4. port のテスト</a></li><li><a href=#porting-portlint>3.5. <code>portlint</code> によるチェック</a></li><li><a href=#porting-submitting>3.6. port の提出</a></li></ul></li><li><a href=#slow>Chapter 4. 本格的な port</a><ul><li><a href=#slow-work>4.1. port 構築の詳細</a></li><li><a href=#slow-sources>4.2. オリジナルのソースの入手</a></li><li><a href=#slow-modifying>4.3. port の修正</a></li><li><a href=#slow-patch>4.4. パッチの適用</a></li><li><a href=#slow-configure>4.5. コンフィグレーション</a></li><li><a href=#slow-user-input>4.6. ユーザからの入力の扱い</a></li></ul></li><li><a href=#makefile>Chapter 5. <span class=filename>Makefile</span> の作成</a><ul><li><a href=#makefile-source>5.1. オリジナルのソース</a></li><li><a href=#makefile-naming>5.2. 名前の付け方</a></li><li><a href=#makefile-categories>5.3. カテゴリ分類</a></li><li><a href=#makefile-distfiles>5.4. 配布ファイル</a></li><li><a href=#makefile-maintainer>5.5. <code>MAINTAINER</code></a></li><li><a href=#makefile-comment>5.6. <code>COMMENT</code></a></li><li><a href=#makefile-depend>5.7. 依存関係</a></li><li><a href=#makefile-wrkdir>5.8. 作業ディレクトリの指定</a></li><li><a href=#conflicts>5.9. <code>CONFLICTS</code></a></li><li><a href=#makefile-build>5.10. ビルドのメカニズム</a></li></ul></li><li><a href=#special>Chapter 6. 特別な配慮</a><ul><li><a href=#porting-shlibs>6.1. 共有ライブラリ</a></li><li><a href=#porting-restrictions>6.2. 配布制限がある ports</a></li><li><a href=#using-perl>6.3. <code>perl</code> の利用</a></li><li><a href=#using-x11>6.4. X11 の利用</a></li><li><a href=#using-automake>6.5. <code>automake</code>, <code>autoconf</code> および <code>libtool</code> の利用</a></li><li><a href=#using-gnome>6.6. GNOME の利用</a></li><li><a href=#using-kde>6.7. KDE の利用</a></li><li><a href=#using-bison>6.8. Bison の利用</a></li><li><a href=#using-java>6.9. Java の利用</a></li><li><a href=#using-python>6.10. Python の利用</a></li><li><a href=#using-emacs>6.11. Emacs の利用</a></li><li><a href=#using-ruby>6.12. Ruby の利用</a></li><li><a href=#using-sdl>6.13. SDL の利用</a></li></ul></li><li><a href=#porting-masterdir>Chapter 7. <code>MASTERDIR</code></a></li><li><a href=#shared>Chapter 8. 共有ライブラリのバージョン</a></li><li><a href=#porting-manpages>Chapter 9. マニュアルページ</a></li><li><a href=#porting-motif>Chapter 10. Motif を必要とする port</a><ul><li><a href=#motif-use>10.1. <code>USE_MOTIF</code></a></li><li><a href=#motif-lib>10.2. <code>MOTIFLIB</code></a></li></ul></li><li><a href=#x11-fonts>Chapter 11. X11 のフォント</a></li><li><a href=#porting-info>Chapter 12. Info ファイル</a></li><li><a href=#pkg-files>Chapter 13. <span class=filename>pkg-*</span> ファイル</a><ul><li><a href=#porting-message>13.1. <span class=filename>pkg-message</span></a></li><li><a href=#pkg-install>13.2. <span class=filename>pkg-install</span></a></li><li><a href=#pkg-deinstall>13.3. <span class=filename>pkg-deinstall</span></a></li><li><a href=#pkg-req>13.4. <span class=filename>pkg-req</span></a></li><li><a href=#porting-plist>13.5. make の変数にあわせた <span class=filename>pkg-plist</span> の変更</a></li><li><a href=#pkg-names>13.6. <span class=filename>pkg-*</span> ファイルの名前変更</a></li></ul></li><li><a href=#testing>Chapter 14. port のテスト</a><ul><li><a href=#testing-portlint>14.1. portlint</a></li><li><a href=#porting-prefix>14.2. <code>PREFIX</code></a></li><li><a href=#testing-freshports>14.3. FreshPorts 正当性テスト</a></li></ul></li><li><a href=#port-upgrading>Chapter 15. アップグレード</a></li><li><a href=#porting-dads>Chapter 16. やっていいことといけないこと</a><ul><li><a href=#dads-intro>16.1. はじめに</a></li><li><a href=#dads-strip>16.2. バイナリの strip</a></li><li><a href=#dads-install>16.3. <code>INSTALL_*</code> マクロ</a></li><li><a href=#porting-wrkdir>16.4. <code>WRKDIR</code></a></li><li><a href=#porting-wrkdirprefix>16.5. <code>WRKDIRPREFIX</code></a></li><li><a href=#porting-versions>16.6. OS の種類やバージョンの識別</a></li><li><a href=#freebsd-versions>16.7. __FreeBSD_version の値</a></li><li><a href=#dads-after-port-mk>16.8. <span class=filename>bsd.port.mk</span> の後に書くこと</a></li><li><a href=#dads-documentation>16.9. 付加的な文書のインストール</a></li><li><a href=#dads-subdirs>16.10. ディレクトリ構成</a></li><li><a href=#porting-cleaning>16.11. 空のディレクトリの削除</a></li><li><a href=#dads-uid>16.12. UID</a></li><li><a href=#dads-rational>16.13. 合理的な port</a></li><li><a href=#dads-cc>16.14. <code>CC</code> および <code>CXX</code> の尊重</a></li><li><a href=#dads-cflags>16.15. <code>CFLAGS</code> の尊重</a></li><li><a href=#dads-config>16.16. コンフィグレーション (設定) ファイル</a></li><li><a href=#dads-freedback>16.17. フィードバック</a></li><li><a href=#dads-readme>16.18. <span class=filename>README.html</span></a></li><li><a href=#dads-broken>16.19. Port に <code>BROKEN</code>, <code>FORBIDDEN</code> などの印をつける</a></li><li><a href=#dads-workarounds>16.20. 必要な回避策</a></li><li><a href=#dads-misc>16.21. その他諸々</a></li><li><a href=#dads-stuck>16.22. 困ったら…​</a></li></ul></li><li><a href=#porting-samplem>Chapter 17. <span class=filename>Makefile</span> のサンプル</a></li><li><a href=#porting-autoplist>Chapter 18. パッキングリストの自動生成</a></li><li><a href=#changes>Chapter 19. この文書と ports システムの変更</a></li></ul></nav></div><div>[ <a href=../>Split HTML</a> / Single HTML ]</div><div class=book-content><div id=preamble><div class=sectionbody><div class="paragraph abstract-title"><p>概要</p></div><div class=paragraph><p>このハンドブックは FreeBSD の port 作成者 (porter) 向けに、 具体的な port の作成方法や注意点などをまとめたものです。</p></div><div class=paragraph><p>日本語版の作成は FreeBSD 日本語ドキュメンテーション プロジェクト (FreeBSD doc-jp) が行なっています。 日本語訳および、日本語版のみに関することは FreeBSD 日本語ドキュメンテーションプロジェクト &lt;<a href=mailto:doc-jp@jp.FreeBSD.org>doc-jp@jp.FreeBSD.org</a>> に おいて日本語で議論されています。</p></div><div class=paragraph><p>文書の日本語訳に関するお問い合わせや、 文書の原文に関する問い合わせをしたいが英語が得意でないという方は、 FreeBSD 日本語ドキュメンテーションプロジェクト &lt;<a href=mailto:doc-jp@jp.FreeBSD.org>doc-jp@jp.FreeBSD.org</a>> まで日本語でコメントをお寄せください。</p></div><hr></div></div><div class=sect1><h2 id=why-port>Chapter 1. はじめに<a class=anchor href=#why-port></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD Ports Collection は、ほとんどの人が FreeBSD でアプリケーション ("ports") をインストールする手段です。 FreeBSD に関する他のすべてと同じく、 これも基本的にボランティア活動によるものです。 この文書を読む際には必ずこのことを念頭においてください。</p></div><div class=paragraph><p>FreeBSD では、誰もが新たな port を提出したり、 メンテナンスされていない既存の port をメンテナンスできます。 そのためには特にソースコードを管理する (commit) 権限は必要ありません。</p></div></div></div><div class=sect1><h2 id=own-port>Chapter 2. 自分で port を作成するには<a class=anchor href=#own-port></a></h2><div class=sectionbody><div class=paragraph><p>自分で port を作ることや、既存の port の 更新作業に興味があるのですか。それはすばらしい!</p></div><div class=paragraph><p>ここでは FreeBSD 用の port を作る際の ガイドラインをいくつか示します。 既存の port を更新したいと考えている場合であっても、 まずこの章を読んでから、次に <a href=./#port-upgrading>アップグレード</a> を読むようにしてください。</p></div><div class=paragraph><p>この文書では充分に詳細がわからない場合には、 <span class=filename>/usr/ports/Mk/bsd.port.mk</span> を参照してください。 このファイルは、port の Makefile が例外なくインクルードしているものです。 これには細かくコメントが書かれていますので、Makefile を読むのに あまり慣れていない人でも、たくさんの情報を得ることができるでしょう。 それでも解決できないような質問は、<a href=https://lists.FreeBSD.org/subscription/freebsd-ports>FreeBSD ports メーリングリスト</a> にポストしてみるのも 良いでしょう。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>この文書では、上書き可能な 変数 (<code><em>VAR</em></code>) のうち 一部のものについてだけ述べています。 (すべてでは無いかもしれませんが、) ほとんどの変数は <span class=filename>bsd.port.mk</span> の先頭部分に記述されています。 それ以外のものも記述すべきかもしれません。 なお、このファイルは非標準のタブ設定を使用しています。 Emacs や Vim は、 この設定をファイルの読み込み時に認識するはずです。 <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a> と <a href="https://man.freebsd.org/cgi/man.cgi?query=ex&amp;sektion=1&amp;format=html">ex(1)</a> では、 一旦ファイルを読み込んでから <code>:set tabstop=4</code> と タイプすることで、正しい値に設定することができます。</p></div></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=quick-porting>Chapter 3. 分間 porting<a class=anchor href=#quick-porting></a></h2><div class=sectionbody><div class=paragraph><p>このセクションでは、簡単な port の作り方について説明します。 多くの場合、これだけでは不十分なので、 この文書の続きを読まなければならないでしょう。</p></div><div class=paragraph><p>まず、元の tar ファイルを <code>DISTDIR</code> に置きます。この変数の デフォルト値は <span class=filename>/usr/ports/distfiles</span> です。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>以下の例では、そのソフトウェアが そのままコンパイル可能なものと仮定しています。 つまり、FreeBSD マシンで動かすために、 変更がまったく必要ないという意味です。 もし何か変更が必要な場合には、次のセクションも 参照する必要があるでしょう。</p></div></td></tr></tbody></table></div><div class=sect2><h3 id=porting-makefile>3.1. <span class=filename>Makefile</span> の作成<a class=anchor href=#porting-makefile></a></h3><div class=paragraph><p>最小限の <span class=filename>Makefile</span> は 次のようなものになります。</p></div><div class="literalblock programlisting"><div class=content><pre># New ports collection makefile for:   oneko
# Date created:     5 December 1994
# Whom:             asami
#
# $FreeBSD$
#

PORTNAME=       oneko
PORTVERSION=    1.1b
CATEGORIES=     games
MASTER_SITES=   ftp://ftp.cs.columbia.edu/archives/X11R5/contrib/

MAINTAINER=     asami@FreeBSD.org
COMMENT=        A cat chasing a mouse all over the screen

MAN1=           oneko.1
MANCOMPRESSED=  yes
USE_IMAKE=      yes

.include &lt;bsd.port.mk&gt;</pre></div></div><div class=paragraph><p>おわかりでしょうか。<code>$FreeBSD$</code> を 含む行の内容については、気にする必要はありません。 この行は、このファイルが FreeBSD の ports ツリーに 取り込まれる際に、CVS によって自動的に書き込まれます。 もっと詳しい例が見たい場合には、 <a href=#porting-samplem>Makefile のサンプル</a>の セクションをご覧ください。</p></div></div><div class=sect2><h3 id=porting-desc>3.2. package 記述ファイルの作成<a class=anchor href=#porting-desc></a></h3><div class=paragraph><p>package にするしないに関わらず、どのような port でも 2 つの記述ファイルが必要です。それは <span class=filename>pkg-descr</span> と <span class=filename>pkg-plist</span> です。ファイル名が <span class=filename>pkg-</span> で始まっていることで 他のファイルと区別できるようになっています。</p></div><div class=sect3><h4 id=_pkg_descr>3.2.1. <span class=filename>pkg-descr</span><a class=anchor href=#_pkg_descr></a></h4><div class=paragraph><p>このファイルには、その port についての少し長い説明を書きます。 その port が何をするのかについての、 数段落程度の簡潔な解説があれば充分です。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>これはマニュアルでもなければ、使用方法やコンパイル方法に ついての細かい説明書でも<em>ありません</em>。 <em><span class=filename>README</span> ファイルや マニュアルを引用するつもりなら注意が必要です</em>。 これらは多くの場合、その port の簡潔な説明になっていなかったり、 扱いにくい形式になっていたりします。 (マニュアルの場合、行を揃えるために空白が調整されていたりします。) このソフトウェアに公式のウェブサイトがあるのなら、 ここに書いてください。その際自動化ツールが正しく動作するように、 ウェブサイトのうちの<em>一つ</em>には、 先頭に <code>WWW:</code> をつけておいてください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>このファイルの最後に、あなたの名前を書くことが推奨されています。 たとえば、こんな具合です。</p></div><div class="literalblock programlisting"><div class=content><pre>This is a port of oneko, in which a cat chases a poor mouse all over
the screen.
 :
(うんぬん。)

WWW: http://www.oneko.org/

- Satoshi
asami@cs.berkeley.edu</pre></div></div></div><div class=sect3><h4 id=_pkg_plist>3.2.2. <span class=filename>pkg-plist</span><a class=anchor href=#_pkg_plist></a></h4><div class=paragraph><p>このファイルには、その port によってインストールされる すべてのファイルを列挙します。 このファイルは package を作る際のリストとして使われるため、 "パッキングリスト (packing list)" とも呼ばれます。 ここに書くパス名は、インストール時のプレフィックス (通常 <span class=filename>/usr/local</span> または <span class=filename>/usr/X11R6</span>) からの相対パスです。 <code>MAN<em>n</em></code> 変数を 使用している場合 (使用することが推奨されています)、このリストに マニュアルは入れないようにしてください。</p></div><div class=paragraph><p>簡単な例を載せておきましょう。</p></div><div class="literalblock programlisting"><div class=content><pre>bin/oneko
lib/X11/app-defaults/Oneko
lib/X11/oneko/cat1.xpm
lib/X11/oneko/cat2.xpm
lib/X11/oneko/mouse.xpm
@dirrm lib/X11/oneko</pre></div></div><div class=paragraph><p>パッキングリストの詳細については、 <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_create&amp;sektion=1&amp;format=html">pkg_create(1)</a> のマニュアルを参照してください。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>このリストには、すべてのファイルを列挙しなければ なりませんが、ディレクトリそのものは列挙する必要がありません。 また、この port がインストール時に独自のディレクトリを 作成する場合には、この port が削除されるときに そのディレクトリも削除されるよう、<code>@dirrm</code> の行を 追加しておくのを忘れないでください。</p></div><div class=paragraph><p>このファイルでは、すべてのファイル名を アルファベット順にソートしておくことを推奨します。 そうすることで、port を更新する際の 変更点の確認が楽になります。</p></div><div class=paragraph><p>パッキングリストを手作業で作成するのは、 時にとても退屈な作業になります。 その port が非常に多数のファイルをインストールするとしたら、 <a href=#porting-autoplist>パッキングリストの 自動生成</a>を行なえば、時間の節約になるかもしれません。</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=porting-checksum>3.3. チェックサムファイルの作成<a class=anchor href=#porting-checksum></a></h3><div class=paragraph><p><code>make makesum</code> と入力するだけで、 (訳注: <span class=filename>bsd.port.mk</span> に書かれている) port 生成ルールに従い、 自動的に <span class=filename>distinfo</span> ファイルが生成されます。</p></div></div><div class=sect2><h3 id=porting-testing>3.4. port のテスト<a class=anchor href=#porting-testing></a></h3><div class=paragraph><p>package 化も含め、その port が思った通りに 動くことを確認してください。 確認の必要な重要ポイントは以下の通りです。</p></div><div class=ulist><ul><li><p>その port がインストールしないものが <span class=filename>pkg-plist</span> に含まれていないこと。</p></li><li><p>その port がインストールする、すべてのものが <span class=filename>pkg-plist</span> に含まれていること。</p></li><li><p><code>reinstall</code> ターゲットを使うことで、その port が 何度でもインストール可能なこと。</p></li><li><p>その port が deintall される際には <a href=#porting-cleaning>後片付け</a>をすること。</p></li></ul></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: 推奨されるテストの手順</strong></p></div><div class="olist arabic"><ol class=arabic><li><p><code>make install</code></p></li><li><p><code>make package</code></p></li><li><p><code>make deinstall</code></p></li><li><p><code>pkg_add package 名</code></p></li><li><p><code>make deinstall</code></p></li><li><p><code>make reinstall</code></p></li><li><p><code>make package</code></p></li></ol></div></div></div><div class=paragraph><p><code>package</code> および <code>deinstall</code> の段階で、 どんな警告 (warning) も出力されないことを確認してください。 ステップ 3 の後、(訳注: その port が作成した) すべての新しい ディレクトリが正しく消去されていることを確認してください。 また、ステップ 4 の後にそのソフトウェアを使用してみて、 package からインストールされた場合にも正しく動作することを 確認してください。</p></div></div><div class=sect2><h3 id=porting-portlint>3.5. <code>portlint</code> によるチェック<a class=anchor href=#porting-portlint></a></h3><div class=paragraph><p><code>portlint</code> を使い、その port が FreeBSD の ガイドラインに沿っているかどうかを確認してください。 <code>portlint</code> プログラムは ports collection に 含まれています。 特に、<a href=#porting-samplem>Makefile</a> が 正しい形式になっているか、 <a href=#porting-pkgname>package</a> の 名前が正しいかどうかをチェックするのに良いでしょう。</p></div></div><div class=sect2><h3 id=porting-submitting>3.6. port の提出<a class=anchor href=#porting-submitting></a></h3><div class=paragraph><p>まず、<a href=#porting-dads>やって良いこと悪いこと</a>の セクションを読んでください。</p></div><div class=paragraph><p>さて、満足のいく port が完成したら、残るは それを FreeBSD のメインの ports ツリーに置いて、 他の人にも使ってもらうだけです。 <span class=filename>work</span> ディレクトリや <span class=filename>pkgname.tgz</span> といった package は 必要ありませんから、まずこれらを消去してください。 あとは <code>shar find port_dir</code> の出力を バグレポートに入れ、<a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> プログラムを使用して 送ってください (<a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> についての詳細は<a href=https://docs.freebsd.org/ja/articles/contributing/#CONTRIB-GENERAL>バグ報告と一般的な論評</a>を参照してください)。 もし、圧縮していない状態で 20KB 以上あるような port であれば、 それを ひとつの tar ファイルにまとめて圧縮し、 バグレポートに入れる前に <a href="https://man.freebsd.org/cgi/man.cgi?query=uuencode&amp;sektion=1&amp;format=html">uuencode(1)</a> を使用してください (20KB 以下のものを tar ファイルにして送っても良いのですが、 あまり歓迎されません)。 バクレポートの category は必ず <code>ports</code>, class は <code>change-request</code> としてください (レポートを <code>confidential</code> (機密) 指定には しないでください!)。 また、port 化したプログラムの短い説明文を バグレポートの "Description" フィールドに追加して、 "Fix" フィールドには shar したファイル、 もしくは uuencode した tar ファイルを追加するようにしてください。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>障害報告の概要 (synopsis) 欄がよく書けていると、 わたしたちが作業しやすくなります。 新しい port を提出するなら "New port: &lt;カテゴリ>/&lt;port 名> &lt;短い port の概要>"、 port の更新なら、 "Update port: &lt;カテゴリ>/&lt;port 名> &lt;短い更新の概要>" のような形が歓迎されます。 この考え方に沿っていれば、 誰かがあなたの障害報告を時間をおかずに見てくれる可能性が高くなります。</p></div></td></tr></tbody></table></div><div class=paragraph><p>もう一度、<em>オリジナルのソースファイルや <span class=filename>work</span> ディレクトリ、 <code>make package</code> で作成した package が 含まれていないこと</em>を確認してください。</p></div><div class=paragraph><p>port を提出したら、辛抱強くお待ちください。時には、ある port が FreeBSD に取り込まれるまで、数日しかかかりそうもないの に、数ヶ月かかることもあります。<a href="http://www.FreeBSD.org/cgi/query-pr-summary.cgi?category=ports">FreeBSD へのコミット待ちの ports</a> の一覧が見られます。</p></div><div class=paragraph><p>わたしたちがひとたびその port をチェックしたら、必要なら あなたに確認して、それをツリーへ置きます。 あなたの名前は<a href=https://docs.freebsd.org/en/articles/contributors/#contrib-additional>その他の FreeBSD への貢献者</a>の一覧やその他のファイルにも載るでしょう。 う～ん、素晴らしい。:-)</p></div></div></div></div><div class=sect1><h2 id=slow>Chapter 4. 本格的な port<a class=anchor href=#slow></a></h2><div class=sectionbody><div class=paragraph><p>残念ながら移植がそう簡単ではなく、それを動かすために 多少の変更が必要になる場合もあるでしょう。 このセクションでは、模範的な ports の作法に従い、 どのように変更を行なって動くようにするのかを 順を追って説明します。</p></div><div class=sect2><h3 id=slow-work>4.1. port 構築の詳細<a class=anchor href=#slow-work></a></h3><div class=paragraph><p>まず、あなたが port のディレクトリで <code>make</code> と 入力してから起こる一連の出来事について、 順を追って説明します。 ここを読むときには、別のウィンドウに <span class=filename>bsd.port.mk</span> を表示しておくと 理解の助けになるかもしれません。</p></div><div class=paragraph><p>しかし、<span class=filename>bsd.port.mk</span> が何をしているのか 完全に理解できなくても 心配する必要はありません。 それほど多くの人が理解している というわけでは ありませんから…​。 <em>f(<sup></sup></em>;)_</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>まず、<code>fetch</code> という ターゲットが実行されます。 この <code>fetch</code> ターゲットは、 配布ファイルがローカルの <code>DISTDIR</code> に 存在することを保証する役目を持っています。 もし必要なファイルが <code>DISTDIR</code> に 存在しなければ、<code>fetch</code> ターゲットは <span class=filename>Makefile</span> で指定された <code>MASTER_SITES</code> 中の URL や、 FreeBSD のメイン FTP サイト <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/>ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/</a> (ここにはバックアップとして、われわれ ports 管理者が確認した 配布ファイルを置いてあります) を探しにいきます。 <code>make</code> を実行するマシンがインターネットに 接続されていて、目的のファイルを <code>FETCH</code> で 取ってこれた場合には、それを <code>DISTDIR</code> に 保存します。</p></li><li><p>次に <code>extract</code> ターゲットが実行されます。 このターゲットは <code>DISTDIR</code> から 配布ファイル (普通は gzip された tar ファイル) を読み込み、 その内容を作業ディレクトリ <code>WRKDIR</code> (デフォルトでは <span class=filename>work</span>) に展開します。</p></li><li><p>次に <code>patch</code> ターゲットが実行されます。 まず、<code>PATCHFILES</code> にパッチファイルが 指定されていれば、そのパッチを適用します。 次に、<code>PATCHDIR</code> ディレクトリ (デフォルトでは <span class=filename>files</span> サブディレクトリ) に <span class=filename>patch-*</span> という 名前のパッチファイルが存在すれば、 これらをアルファベット順に適用します。</p></li><li><p>次に <code>configure</code> ターゲットが 実行されます。 これには、いろいろな場合があります。</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p><span class=filename>scripts/configure</span> が 存在する場合には、そのスクリプトが実行されます。</p></li><li><p><code>HAS_CONFIGURE</code> または <code>GNU_CONFIGURE</code> がセットされていれば、 <span class=filename>WRKSRC/configure</span> が 実行されます。</p></li><li><p><code>USE_IMAKE</code> がセットされていれば、 <code>XMKMF</code> (デフォルトでは <code>xmkmf -a</code>) が 実行されます。</p></li></ol></div></li><li><p>最後に <code>build</code> ターゲットが実行されます。 これは作業ディレクトリ (<code>WRKSRC</code>) に降りていき、 ビルド (コンパイル) を実行するのが役目です。 <code>USE_GMAKE</code> がセットされていれば GNU <code>make</code> が使用され、 セットされていなければ FreeBSD の <code>make</code> が 使用されます。</p></li></ol></div></div></div><div class=paragraph><p>上記はデフォルトの動作です。これに加えて <code>pre-<em> 何とか</em></code>や <code>post-<em>何とか</em></code>という ターゲットを定義したり、そのような名前のスクリプトを <span class=filename>scripts</span> サブディレクトリに置くことも可能で、 それぞれデフォルトの動作の前や後に実行されます。</p></div><div class=paragraph><p>たとえば、<code>post-extract</code> ターゲットが <span class=filename>Makefile</span> に定義されていて、 <span class=filename>scripts</span> サブディレクトリに <span class=filename>pre-build</span> というファイルが置かれている場合、 <code>post-extract</code> ターゲットは 通常の展開動作の後に呼び出され、 <span class=filename>pre-build</span> スクリプトは デフォルトのコンパイル動作の前に実行されます。 実行する動作が簡単であれば、スクリプトよりも <span class=filename>Makefile</span> のターゲットを使用することが 推奨されています。 なぜなら、その port では どのような非標準の動作が必要とされるのか、 一箇所にまとめて書いてあった方が他の人に理解しやすいからです。</p></div><div class=paragraph><p>デフォルトの動作は <span class=filename>bsd.port.mk</span> の <code>do-<em>何とか</em></code>という ターゲットで実行されます。 たとえば port を展開するコマンドは <code>do-extract</code> ターゲットに書かれています。 もしデフォルトのターゲットに不満があれば、 <span class=filename>Makefile</span> 中で <code>do-<em> 何とか</em></code>という ターゲットを再定義することにより、 好きなように変更することができます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>"メイン"のターゲット (たとえば <code>extract</code>, <code>configure</code>、その他) は、 すべての前段階が実行されていることを確認してから、 実際のターゲットやスクリプトを呼び出す以外のことは 行ないませんし、これらが変更されることも想定されていません。 もし展開の方法を変更したいときには <code>do-extract</code> の変更によって実現し、 <code>extract</code> の動作は絶対に変更しないでください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>これで、ユーザが <code>make</code> と 入力したときに何が起こるのかが理解できたと思います。 では、完璧な port を作成するための推奨手順を 順に見ていきましょう。</p></div></div><div class=sect2><h3 id=slow-sources>4.2. オリジナルのソースの入手<a class=anchor href=#slow-sources></a></h3><div class=paragraph><p>(通常の場合、) 圧縮された tar ファイルの形 (<span class=filename>foo.tar.gz</span> あるいは <span class=filename>foo.tar.Z</span>) で オリジナルのソースを入手して、 それを <code>DISTDIR</code> にコピーします。 できる限り、<em>主流の</em>ソースを 使用するようにしてください。</p></div><div class=paragraph><p>もとの tar ファイルがどこにあるかを示すために、変数 <code>MASTER_SITES</code> を設定する必要があります。 主なサイトのほとんどについては省略形が <span class=filename>bsd.sites.mk</span> で定義されています。 これらのサイト (と付随する定義) を、ソースコード内で同じ情報が繰り返されるのを避けるために、 可能な限り使うようにしてください。 これらのサイトは時とともに変わってゆきますので、そうしないと、 関係者一同にとってメンテナンスの悪夢になってしまいます。</p></div><div class=paragraph><p>ネットワークへの接続の良好な FTP/HTTP サイトを 見つけることができなかったり、頭にくるような非標準的な形式しか 置いていないサイトしか見つけられないときには、 自分の管理下にあり信頼できる FTP サーバや HTTP サーバ (たとえば、あなた自身のホームページ) に置くこともできます。</p></div><div class=paragraph><p>そのような便利かつ信頼のおける置き場所が見つからない場合、 我々が <code>ftp.FreeBSD.org</code> に "置き場所"を提供することもできますが、 これはなるべく避けたい解決法です。 配布ファイルは、誰かの <code>freefall</code> アカウントの <span class=filename>~/public_distfiles/</span> に置かれることでしょう。 その port をコミットする人に、置いてもらえるように頼んでください。 その人は配布ファイルを置いて、<code>MASTER_SITES</code> を <code>MASTER_SITE_LOCAL</code> にセットし、 <code>MASTER_SITE_SUBDIR</code> には 自分の <code>freefall</code> ユーザ名を 入れておいてくれるでしょう。</p></div><div class=paragraph><p>その port の配布ファイルが、 作者によるバージョン更新のようなことがなく変更されるなら、 その配布ファイルを あなたのホームページに置いて、<code>MASTER_SITES</code> の 最初に指定することも考えてみてください。できれば、その port の作者にそういうことをしないようにお願いしてみてください。 そのためには、何かしらのソースコード管理を行うと役に立つでしょう。 あなたが独自のバージョンを置けば、ユーザが <code>checksum mismatch</code> エラーに悩まされることもなくなりますし、FreeBSD の FTP サイトの 保守担当者の負担も減らすこともできます。 また、その port にマスターサイトが一つしか存在しない場合には、 あなたのサイトにバックアップを置き、 それを <code>MASTER_SITES</code> の 2 番目に 指定すると良いでしょう。</p></div><div class=paragraph><p>その port がインターネット上で入手できる追加パッチを 必要とするのなら、それも取ってきて <code>DISTDIR</code> に置いてください。 それらがメインのソースの tar ファイルとは別のサイトに あったとしても、心配する必要はありません。 そのような状況にも ちゃんと対応できるようになっています (後述の <a href=#porting-patchfiles>PATCHFILES の記述</a>を ご覧ください)。</p></div></div><div class=sect2><h3 id=slow-modifying>4.3. port の修正<a class=anchor href=#slow-modifying></a></h3><div class=paragraph><p>作業用のディレクトリに tar ファイルを展開し、 最新バージョンの FreeBSD 上で正しくコンパイルするために必要な、 あらゆる変更を行ないます。 この処理は最終的に自動化するわけですから、 何を行なったかを<em>注意深く記録しておきましょう</em>。 この port が完成した暁には、ファイルの削除、追加、 修正を含むすべての処理が自動化されたスクリプトや パッチファイルで行なえるようになっていなければなりません。</p></div><div class=paragraph><p>その port のコンパイルやインストールのために必要な手作業が あまりに多いようならば、Larry Wall の芸術的な Configure スクリプトを 参考にしたほうが良いかもしれません。 新しい ports collection は、エンドユーザにとって個々の port が 可能な限り"プラグ & プレイ"かつ 最小のディスク消費で make できることを目指しています。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>明示的に記述されている場合を除き、あなたが作成して FreeBSD の ports collection に寄付したパッチファイル、 スクリプトおよびその他のファイルは、標準的な BSD の 著作権条件によりカバーされているものと見なされます。</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=slow-patch>4.4. パッチの適用<a class=anchor href=#slow-patch></a></h3><div class=paragraph><p>port の準備段階で追加されたり変更されたりしたファイルは、 再帰的 <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> により後で <a href="https://man.freebsd.org/cgi/man.cgi?query=patch&amp;sektion=1&amp;format=html">patch(1)</a> に与えられる形にすることができます。 パッチは適当にまとめて <span class=filename>patch-<strong></strong></span><strong> という名前のファイルに入れてください。 <span class=filename></span></strong> はパッチが適用される順番を示します - これらは <em>アルファベット順</em>、 つまり <code>aa</code> が最初、 <code>ab</code> が その次といった順番で処理されます。 お望みなら、<span class=filename>patch-Imakefile</span> とか <span class=filename>patch-src-config.h</span> のように、 パッチ対象のファイルのパス名を示す名前を使うこともできます。 これらのファイルは <code>PATCHDIR</code> に置いてください。 そうすれば自動的に適用されるようになっています。 すべてのパッチは <code>WRKSRC</code> からの相対パスにするべきです (通常、<code>WRKSRC</code> は port の tar ファイルが展開されるディレクトリで、 make が実行されるところと同じです)。 修正やアップグレードを容易にするため、 複数のパッチで同じファイルを修正するのは避けてください (たとえば、<span class=filename>patch-aa</span> と <span class=filename>patch-ab</span> が共に <span class=filename>WRKSRC/foobar.c</span> を修正するなど)。</p></div><div class=paragraph><p>RCS にとって特別な意味を持つ文字列をパッチ内に入れないようにしてください。 ファイルを私たちのソースツリーに入れる時、 これらの文字列は CVS によって書き換えられてしまい、 後でまたパッチを使おうとした時にうまくいかないことがあります。 RCS 文字列はドル記号 (<code>$</code>) で囲まれており、 <code>$FreeBSD</code> や <code>$RCS</code> などで始まります。</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> の再帰 (<code>-r</code>) フラグを使って再帰的なパッチを作るのは大変結構なのですが、 でき上がったパッチは必ず目でチェックして余計なゴミが入っていないことを確認してください。 よくあるのはバックアップファイル同士の変更点、あるいは <code>Imake</code> や GNU <code>configure</code> を使うソフトウェアの <span class=filename>Makefile</span> の変更点が入っている場合などです。 また <span class=filename>configure.in</span> を編集して <code>autoconf</code> を使って <code>configure</code> を作り直すときには、 <code>configure</code> の diff は含めずに (それらは良く数千行におよぶことがあります)、 <code>USE_AUTOCONF=yes</code> を定義して <span class=filename>configure.in</span> の diff をとってください。</p></div><div class=paragraph><p>ファイルをまるごと消す場合には、 パッチを使わずに <code>post-extract</code> ターゲットで消す方が簡単です。 できあがった差分に満足したら、 それらをソースのファイルごとに別々のパッチファイルに分割してください。</p></div></div><div class=sect2><h3 id=slow-configure>4.5. コンフィグレーション<a class=anchor href=#slow-configure></a></h3><div class=paragraph><p>カスタマイズのために追加したいコマンドがあれば、 <span class=filename>configure</span> という名前のスクリプトに入れて <span class=filename>scripts</span> サブディレクトリに置いてください。 上で述べたように、<span class=filename>pre-configure</span> あるいは <span class=filename>post-configure</span> という <span class=filename>Makefile</span> ターゲットや、 スクリプトで処理することもできます。</p></div></div><div class=sect2><h3 id=slow-user-input>4.6. ユーザからの入力の扱い<a class=anchor href=#slow-user-input></a></h3><div class=paragraph><p>もし、その port がビルド、コンフィグレーション、または インストールの際にユーザからの入力を必要とするならば、 <span class=filename>Makefile</span> 中で <code>IS_INTERACTIVE</code> を設定しなければなりません。 これにより、ユーザが環境変数 <code>BATCH</code> を セットしている場合には、この port の処理がスキップされるので "夜間の無人ビルド" が実行可能になります。 (逆に環境変数 <code>INTERACTIVE</code> がセットされていると、 ユーザからの入力を必要とする port <em>だけ</em>が コンパイルされます)。 これは、連続して ports をビルドするマシン群で、 無駄になる時間を大きく減らします。</p></div><div class=paragraph><p>もし、適切なデフォルト設定が存在するのであれば、 <code>PACKAGE_BUILDING</code> 変数をチェックして、 それが設定されている場合には ユーザ入力のスクリプトを起動しないようにしてください。 こうすることによって、我々 ports 管理者が CDROM や FTP に 置く package を作成することができます。</p></div></div></div></div><div class=sect1><h2 id=makefile>Chapter 5. <span class=filename>Makefile</span> の作成<a class=anchor href=#makefile></a></h2><div class=sectionbody><div class=paragraph><p><span class=filename>Makefile</span> の作成は非常に単純です。 繰り返しますが、始めるまえに既存の例を見ておくことを推奨します。 また、このハンドブックには <a href=#porting-samplem>Makefile のサンプル</a>があります。 それを見て、Makefile 内の変数の順番や 空行を入れるところなどの参考にしてください。 そうすると他の人々にも読みやすいものとなります。</p></div><div class=paragraph><p>では、<span class=filename>Makefile</span> を設計するときに 問題となるところを順に追って見てみましょう。</p></div><div class=sect2><h3 id=makefile-source>5.1. オリジナルのソース<a class=anchor href=#makefile-source></a></h3><div class=paragraph><p>ソースは <span class=filename>foozolix-1.2.tar.gz</span> といった名前の 標準的な gzip された tar ファイルの形式で <code>DISTDIR</code> に置かれていますか? そうなっていれば、次のステップに進めます。 異なっている場合には、変数 <code>DISTNAME</code>, <code>EXTRACT_CMD</code>, <code>EXTRACT_BEFORE_ARGS</code>, <code>EXTRACT_AFTER_ARGS</code>, <code>EXTRACT_SUFX</code>, <code>DISTFILES</code> のうち いくつかを書き換える必要があります。 どれだけ変更しないといけないかは、その port の配布ファイルが どの程度標準からかけはなれているかによります (最もよくあるのは gzip ではなく普通の compress コマンドで tar ファイルが圧縮されている場合で、そのときは <code>EXTRACT_SUFX=.tar.Z</code> とするだけです)。</p></div><div class=paragraph><p>最悪の場合には、自分で <code>do-extract</code> ターゲットを作成して、 デフォルトを上書きすることもできます。 しかし、そこまでする必要があることはめったにないでしょう。</p></div></div><div class=sect2><h3 id=makefile-naming>5.2. 名前の付け方<a class=anchor href=#makefile-naming></a></h3><div class=paragraph><p>Port の <span class=filename>Makefile</span> のはじめの部分で port に名前をつけ、バージョン番号を記述し、適切なカテゴリに載せます。</p></div><div class=sect3><h4 id=_portname_および_portversion>5.2.1. <code>PORTNAME</code> および <code>PORTVERSION</code><a class=anchor href=#_portname_および_portversion></a></h4><div class=paragraph><p><code>PORTNAME</code> には port の名前の基幹部分を入れ、 <code>PORTVERSION</code> には port のバージョン番号を入れます。</p></div></div><div class=sect3><h4 id=_portrevision_および_portepoch>5.2.2. <code>PORTREVISION</code> および <code>PORTEPOCH</code><a class=anchor href=#_portrevision_および_portepoch></a></h4><div class=sect4><h5 id=_portrevision>5.2.2.1. <code>PORTREVISION</code><a class=anchor href=#_portrevision></a></h5><div class=paragraph><p><code>PORTREVISION</code> 変数は単調増加する値です。 <code>PORTVERSION</code> が増加した時 (つまり、 新しいオフィシャルベンダーリリースが行なわれた時) には いつでも 0 にリセットされます。 また、その値が 0 でない場合には package 名に追加されます。 <code>PORTREVISION</code> の変更は、(例えば <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_version&amp;sektion=1&amp;format=html">pkg_version(1)</a> 等の) 自動化ツールが、 新たな package が入手できることを示すのに使われます。</p></div><div class=paragraph><p>その port から作られる package の内容や構造に 大きな影響を与える変更を行なった時には、 <code>PORTREVISION</code> を増やしてください。</p></div><div class=paragraph><p><code>PORTREVISION</code> を上げる必要がある変更の例:</p></div><div class=ulist><ul><li><p>セキュリティ上の脆弱性やバグを修正するため、または その port に新しい機能を追加するためのパッチの追加。</p></li><li><p>package のコンパイル時オプションの有効化や 無効化のための port の <span class=filename>Makefile</span> の変更。</p></li><li><p>パッキングリストの変更や、package のインストール時の 挙動の変更 (たとえば、ssh のホストキーのような package の 初期データを生成するスクリプトの変更など)。</p></li><li><p>その port が依存する共有ライブラリのバージョンを 上げる場合 (新しいバージョンの共有ライブラリが インストールされた後に、そのライブラリに依存していた 古い package をインストールを試みる場合、 その package は新しい libfoo.(x+1) ではなく 古い libfoo.x を探そうとするため、インストールに失敗します。 (訳注: そのため、PORTREVISION を上げた package を 作成する必要があるわけです))。</p></li><li><p>ひそかに port 配布ファイルの変更が行なわれ、 その機能に大きな変化があった場合。 つまり、<span class=filename>distinfo</span> の修正を 必要とするような配布ファイルの変更が行なわれ、 新旧のバージョンの <code>diff -ru</code> を取ると 些細とは言えない変更が認められるにもかかわらず、 オリジナルのバージョン番号が変更されていないことから <code>PORTVERSION</code> の変更は難しい場合。</p></li></ul></div><div class=paragraph><p>PORTREVISION を上げる必要の無い変更の例:</p></div><div class=ulist><ul><li><p>生成される package に機能の変化が起らないような port スケルトンのスタイル変更。</p></li><li><p>生成される package に影響しないような <code>MASTER_SITES</code> その他の port に対する機能変更。</p></li><li><p>誤植の修正などの些細な変更で、その package のユーザが アップグレードを必要とするほどには重要でないパッチ。</p></li><li><p>以前にはコンパイルが通らなかった package を ビルド可能にするための修正 (その port が以前にビルド可能だった プラットフォームにおいて、その変更により何らかの機能的な 違いが発生しない場合に限ります)。 <code>PORTREVISION</code> は package の内容を反映したものなので、その package が以前にビルド可能でなかったのなら、変更を示すために、 <code>PORTREVISION</code> を 増やす必要はありません。</p></li></ul></div><div class=paragraph><p>経験的な判断方法としては、ある port にコミットされた変更が (それが強化や修正によるものであれ、新しい package による 実質的な効能であれ)、アップデートすることにより、 誰もが利益を受けるような何かかどうか、また定期的に ports ツリーを更新している人に更新を強制するということに値するか自問してみることです。 もし答がイエスであれば、 <code>PORTREVISION</code> を上げるべきでしょう。</p></div></div><div class=sect4><h5 id=_portepoch>5.2.2.2. <code>PORTEPOCH</code><a class=anchor href=#_portepoch></a></h5><div class=paragraph><p>ソフトウェアのベンダや FreeBSD の port 作成者は、 以前のものよりも小さい数字のバージョン番号をつけたソフトウェアをリリースするといった、 何か馬鹿げたことをすることが時々あります。 例をあげると、ある port が foo-20000801 から foo-1.0 になるといった具合です (数字として見ると 20000801 は 1 よりも大きいため、 間違って前者の方が新しいバージョンとして扱われてしまいます)。</p></div><div class=paragraph><p>このような場合には <code>PORTEPOCH</code> バージョンを増やしてください。 上のセクション 0 で説明したように、 <code>PORTEPOCH</code> がゼロでない場合には、 それがパッケージ名の後ろにつけられます。絶対に <code>PORTEPOCH</code> を減らしたり、ゼロにリセットしてはいけません。 さもないと、以前に作成された package との比較に失敗する (つまり、その package が古くなっていることがわからない) ためです: 新しいバージョン番号 (上の例では<code>1.0,1</code>) は 依然として前のバージョン番号 (20000801) よりも 数字としては小さいのですが、自動化ツールが サフィックス <code>,1</code> を特別扱いすることで、 以前の package には明示されていないサフィックス <code>,0</code> よりも新しいことがわかります。</p></div><div class=paragraph><p>誤って <code>PORTEPOCH</code> を削除したりリセットしたりすると、終わりのない悲劇に見舞われます。 上記の議論を理解できないなら、 わかるまで議論をたどるかメーリングリストで質問してください。</p></div><div class=paragraph><p>大多数の ports では、<code>PORTEPOCH</code> が 必要になることは まず無いものと考えられています。 また、注意深く <code>PORTVERSION</code> を使用することで、 そのソフトウェアの将来のリリースがバージョン構造を変更する必要が出てきた場合にも、 多くの場合前もって対応しておくことができるでしょう。 しかし、"スナップショット"リリースのように、 オフィシャルなバージョン番号を持たないベンダーリリースが行なわれた時には、 FreeBSD 版の port 作者によるケアが必要になります。 そういったリリースに対し、 リリース日付を使ったラベルを付けたいという誘惑にかられることがあるでしょうが、 そうすると新しい"オフィシャル"リリースが行なわれた時に、 上の例で示したような問題が起きることでしょう。</p></div><div class=paragraph><p>例えば、あるソフトウェアのスナップショットリリースが 20000917 に行なわれ、以前のバージョン番号が 1.2 だったとすると、 そのスナップショットの <code>PORTVERSION</code> には 20000917 ではなく 1.2.20000917 か何か、そのような番号を 指定するのが良いでしょう。 そうしておけば、例えばバージョン番号 1.3 として後続のリリースが 行なわれた場合にも、大小関係が崩されずにすむわけです。</p></div></div><div class=sect4><h5 id=_portrevision_と_portepoch_の使い方の例>5.2.2.3. <code>PORTREVISION</code> と <code>PORTEPOCH</code> の使い方の例<a class=anchor href=#_portrevision_と_portepoch_の使い方の例></a></h5><div class=paragraph><p><code>gtkmumble</code> の port, バージョン <code>0.10</code> が ports collection にコミットされます。</p></div><div class="literalblock programlisting"><div class=content><pre>PORTNAME=       gtkmumble
PORTVERSION=    0.10</pre></div></div><div class=paragraph><p><code>PKGNAME</code> は <code>gtkmumble-0.10</code> になります。</p></div><div class=paragraph><p>ローカルな FreeBSD パッチを必要とする セキュリティホールが発見されました。 それに合わせて <code>PORTREVISION</code> を増やします。</p></div><div class="literalblock programlisting"><div class=content><pre>PORTNAME=       gtkmumble
PORTVERSION=    0.10
PORTREVISION=   1</pre></div></div><div class=paragraph><p><code>PKGNAME</code> は <code>gtkmumble-0.10_1</code> になります。</p></div><div class=paragraph><p>ベンダから <code>0.2</code> という番号が振られた 新バージョンがリリースされます (これにより、 作者は <code>0.10</code> という番号を "0.9 の次という意味ではなく"、 実際には <code>0.1.0</code> のつもりで 使用していたことがわかります - あらら、今さら遅すぎる)。 新しいマイナーバージョン <code>2</code> は数字として以前のバージョン番号 <code>10</code> より小さいので、 強制的に新しい package "の方が新しい"と認識させるため <code>PORTEPOCH</code> を増やす必要があります。 これは新しいベンダーリリースなので、 <code>PORTREVISION</code> は 0 にリセット (または <span class=filename>Makefile</span> から削除) されます。</p></div><div class="literalblock programlisting"><div class=content><pre>PORTNAME=       gtkmumble
PORTVERSION=    0.2
PORTEPOCH=      1</pre></div></div><div class=paragraph><p><code>PKGNAME</code> は <code>gtkmumble-0.2,1</code> になります。</p></div><div class=paragraph><p>次のリリースは 0.3 です。 <code>PORTEPOCH</code> は減少することが無いため、 今度のバージョン変数は次のようになります:</p></div><div class="literalblock programlisting"><div class=content><pre>PORTNAME=       gtkmumble
PORTVERSION=    0.3
PORTEPOCH=      1</pre></div></div><div class=paragraph><p><code>PKGNAME</code> は <code>gtkmumble-0.3,1</code> になります。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>もし、このアップグレードによって <code>PORTEPOCH</code> が <code>0</code> に リセットされたとすると、<code>3</code> は数字として <code>10</code> よりも小さいため、 <code>gtkmumble-0.10_1</code> の package をインストールした誰かは <code>gtkmumble-0.3</code> の package の方が新しいことに気がつかないことになるでしょう。 これが、そもそも <code>PORTEPOCH</code> が導入された肝心な理由です。</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=_pkgnameprefix_および_pkgnamesuffix>5.2.3. <code>PKGNAMEPREFIX</code> および <code>PKGNAMESUFFIX</code><a class=anchor href=#_pkgnameprefix_および_pkgnamesuffix></a></h4><div class=paragraph><p>二つのオプション変数 <code>PKGNAMEPREFIX</code> と <code>PKGNAMESUFFIX</code> は、 <code>PORTNAME</code> および <code>PORTVERSION</code> と結合され、 <code>PKGNAME</code> を <code>${PKGNAMEPREFIX}${PORTNAME}${PKGNAMESUFFIX}-${PORTVERSION}</code> として定義します。 この時、<a href=#porting-pkgname>適切な package 名を選ぶための ガイドライン</a>に沿っているかどうかを確認してください。 特に、<code>PORTVERSION</code> 中に ハイフン (<code>-</code>) を使用することは<em>禁止</em>されています。 また、package 名に <em>language-</em> もしくは <em>-compiled.specifics</em> 部分が 含まれる場合、それぞれ <code>PKGNAMEPREFIX</code> と <code>PKGNAMESUFFIX</code> を使用してください。 これらを <code>PORTNAME</code> の一部としてはいけません。</p></div></div><div class=sect3><h4 id=porting-pkgname>5.2.4. package 名についての規則<a class=anchor href=#porting-pkgname></a></h4><div class=paragraph><p>package の名前は以下のルールにしたがってつけてください。 これは package のディレクトリを見やすくするためで、 既に何千ものパッケージがありますし、 目を痛めてしまうようだとユーザはそっぽを向くでしょう。</p></div><div class=paragraph><p>package の名前は以下のようにしてください。 <span class=filename>言語-名前-オプションバージョン.番号</span></p></div><div class=paragraph><p>package 名は <code>${PKGNAMEPREFIX}${PORTNAME}${PKGNAMESUFFIX}-${PORTVERSION}</code> というように定義されています。 変数がこの書式と適合していることを確認してください。</p></div><div class="olist arabic"><ol class=arabic><li><p>FreeBSD はユーザの慣れ親しんだ言語のサポートに力を入れています。 特定の言語のための port の package 名には <em>言語-</em> に ISO-639 で定義されている言語名の略称を入れてください。 たとえば日本語なら <code>ja</code>、 ロシア語なら <code>ru</code>、 ベトナム語なら <code>vi</code>、 中国語なら <code>zh</code>、 韓国語ならば <code>ko</code>、 ドイツ語なら <code>de</code> といった具合です。</p><div class=paragraph><p>port がある言語地域に特化したものである場合には、 さらに二文字の国名コードを付加してください。 たとえば合衆国英語圏は <code>en_US</code> となり、 スイスのフランス語圏は <code>fr_CH</code> となります。</p></div><div class=paragraph><p><em>言語-</em> 部分は、 <code>PKGNAMEPREFIX</code> 変数に 定義されなければなりません。</p></div></li><li><p><span class=filename>名前</span>の部分の最初の文字は 小文字でなければなりません。 (名前の残りの部分は大文字を含んでいても構わないため、 大文字を含んだソフトウェア名を変換する際の規則は、 あなた自身の裁量に任されています。) <code>perl 5</code> のモジュールでは先頭に <code>p5-</code> を付け、 二重コロン (<code>::</code>) のセパレータをハイフン (<code>-</code>) に置きかえる習慣になっています。 たとえば <code>Data::Dumper</code> は <code>p5-Data-Dumper</code> になります。 また、そのソフトウェアの名前として通常使われるものに番号、 ハイフン、あるいは下線が入っている場合には、 それらを使うことも構いません (<code>kinput2</code>など)。</p></li><li><p>コンパイル時に環境変数や <code>make</code> の引数などで<a href=#porting-masterdir>ハードコードされたデフォルト</a>を変えてコンパイルできる場合、 <em>-compiled.specifics</em> にそのコンパイル時のデフォルトを入れてください (ハイフンはあってもなくてもかまいません)。 用紙のサイズ、あるいはフォントの解像度などがこれにあたります。</p><div class=paragraph><p><em>-compiled.specifics</em> 部分は、 <code>PKGNAMESUFFIX</code> 変数に定義されなければなりません。</p></div></li><li><p>バージョン番号は数字とアルファベットからなり、 ピリオド (.) で区切ります。 アルファベットは二文字以上続けてはいけません。 唯一の例外は"パッチレベル"を意味する文字列 <code>pl</code> で、 それ以外にバージョン番号がまったくついていない場合にのみ使うことができます。 もしソフトウェアのバージョンに "alpha", "beta", "rc" や "pre" といった文字列が含まれるなら、 ピリオドの後に最初の一文字をとってください。 これらの後に、さらにバージョン文字列が続く場合には、 一文字のアルファベットの後にピリオドをつけずに番号を続けます。</p><div class=paragraph><p>この考え方は、 バージョン文字列を見て簡単に ports を並べられるようにするためのものです。 特に、バージョン番号の各部分が必ずピリオドで区切られていること、 また日付の部分がバージョン文字列の一部となっている場合には <code>yyyy.mm.dd</code> という書式を使っていることを確認してください。 <code>dd.mm.yyyy</code> や、2000 年問題に対応していない <code>yy.mm.dd</code> という書式を使ってはいけません。</p></div></li></ol></div><div class=paragraph><p>では、<code>DISTNAME</code>を正しい <code>PKGNAME</code> に直す例を見てみましょう:</p></div><div class=paragraph><p>以下は、ソフトウェアの作者が決めた名前から 適切な package 名に変換する方法を示した (実際の) 例です。</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:16.6666%><col style=width:16.6666%><col style=width:16.6666%><col style=width:16.6666%><col style=width:16.6666%><col style=width:16.667%><thead><tr><th class="tableblock halign-left valign-top">配布名</th><th class="tableblock halign-left valign-top">PKGNAMEPREFIX</th><th class="tableblock halign-left valign-top">PORTNAME</th><th class="tableblock halign-left valign-top">PKGNAMESUFFIX</th><th class="tableblock halign-left valign-top">PORTVERSION</th><th class="tableblock halign-left valign-top">理由</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>mule-2.2.2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>mule</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>変更の必要はありません</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>XFree86-3.3.6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>XFree86</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3.3.6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>変更の必要はありません</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EmiClock-1.0.2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>emiclock</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1.0.2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>プログラム一つだけの時は小文字のみ</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rdist-1.3alpha</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>rdist</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1.3.a</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>alpha</code> のような文字列は使えない</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>es-0.9-beta1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>es</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.9.b1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>alpha</code> のような文字列は使えない</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>mailman-2.0rc3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>mailman</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2.0.r3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>rc</code> のような文字列は使えない</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>v3.3beta021.src</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>tiff</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3.3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>なんなんでしょう ;)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tvtwm</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>tvtwm</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>pl11</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>バージョン番号は必ず必要</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>piewm</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>piewm</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1.0</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>同上</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>xvgr-2.10pl1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>xvgr</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2.10.1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>pl</code> が使えるのは、 他にメジャー/マイナーバージョン番号がない場合のみ</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>gawk-2.15.6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ja-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>gawk</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2.15.6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>日本語バージョン</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>psutils-1.13</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>psutils</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-letter</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1.13</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>コンパイル時に用紙のサイズを指定</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>pkfonts</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(空)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>pkfonts</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1.0</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300dpiフォント用の package</p></td></tr></tbody></table><div class=paragraph><p>オリジナルのソースにまったくバージョン情報が見当たらず、 また原作者が新しいバージョンをリリースする可能性が低いときには、 バージョン番号として <code>1.0</code> を使えばいいでしょう (上記の <code>piewm</code> の例がこれにあたります)。 そうでない場合には原作者に聞くか、日付 (<code>yyyy.mm.dd</code>) を使うなどしてください。</p></div></div></div><div class=sect2><h3 id=makefile-categories>5.3. カテゴリ分類<a class=anchor href=#makefile-categories></a></h3><div class=sect3><h4 id=_categories>5.3.1. <code>CATEGORIES</code><a class=anchor href=#_categories></a></h4><div class=paragraph><p>パッケージが作成されると <span class=filename>/usr/ports/packages/All</span> に置かれ、一つ以上の <span class=filename>/usr/ports/packages</span> のサブディレクトリからリンクが張られます。 これらのサブディレクトリの名称は、<code>CATEGORIES</code> 変数で指定されます。これは、ユーザが FTP サイトや CDROM のパッケージの山から探し出すのを容易にするためのものです。 既存の<a href=#porting-categories>カテゴリ</a>を参照して、 あなたの port にふさわしいものを選んでください。</p></div><div class=paragraph><p>また、このリストは、その port が ports ツリーのどこにインポートされるかも決定します。 ここに複数のカテゴリを指定すると、port のファイルは最初のカテゴリ名のサブディレクトリに置かれることになります。 適切なカテゴリの選択方法については<a href=#porting-categories>カテゴリ</a>節をご覧ください。</p></div><div class=paragraph><p>あなたが作成した port が、本当に既存のどのカテゴリにも当てはまらない場合には、 新たにカテゴリ名を作成することもできます。 その場合、新しいカテゴリを提案するメールを <a href=https://lists.FreeBSD.org/subscription/freebsd-ports>FreeBSD ports メーリングリスト</a> 宛に送ってください。 しかし、一般的にはあなたが提案したカテゴリにあてはまる ports が一握りではすまない場合でなければ、 あなたの提案は却下されるでしょう。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>時々、カテゴリを 2 階層構造や、 何か他のキーワードを利用した構造に再構成することを提案する人がいます。 今日まで、その提案はどれも実現しませんでした。 なぜなら、その構成を実現することは簡単なのですが、既存の Ports Collection 全体を構成しなおしたものに合わせて改修する労力は、 控え目にいっても気が遠くなるものだからです。 こういうアイディアを送る前に、 それらの提案の歴史をメーリングリストのアーカイブで調べてください。 さらに、動作するプロトタイプを示せと言われるのに対する準備をしておきましょう。</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=porting-categories>5.3.2. 現在のカテゴリのリスト<a class=anchor href=#porting-categories></a></h4><div class=paragraph><p>ここに現在の port のカテゴリの一覧を示します。 アスタリスク(<code>*</code>) が付いているものは仮想 (<em>virtual</em>) カテゴリです - これらには対応するサブディレクトリが port ツリーにはありません。 これらは第 2 の補助的なカテゴリとして、 検索目的にしか使われません。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>仮想カテゴリでないものは、 そのサブディレクトリ内の <span class=filename>pkg/COMMENT</span> に一行の記述があります (例: <span class=filename>archivers/pkg/COMMENT</span>)。</p></div></td></tr></tbody></table></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">カテゴリ</th><th class="tableblock halign-left valign-top">説明</th><th class="tableblock halign-left valign-top">Notes</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>accessibility</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>障害を持ったユーザの役に立つ ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>afterstep*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=http://www.afterstep.org>AfterStep</a> ウィンドウマネージャをサポートする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>arabic</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>アラビア語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>archivers</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>アーカイブ用ツール</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>astro</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>天文学関連の ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>audio</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>サウンドをサポートする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>benchmarks</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ベンチマークユーティリティ</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>biology</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>生物学関連のソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>cad</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CAD ツール</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>chinese</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>中国語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>comms</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>通信ソフトウェア</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ほとんどはシリアルポート用のソフトウェア</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>converters</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>文字コード変換</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>databases</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>データベース</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>deskutils</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>コンピュータが発明される以前に机上で使われていた道具</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(訳注: いわゆるデスクトップユーティリティのこと)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>devel</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>開発ユーティリティ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>単にライブラリだからというだけで、 どうしてもここに置かなければならない理由があるのでない限り、 ライブラリをここに含めないでください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>dns</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DNS 関連ソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>editors</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>一般的なエディタ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>特殊なエディタはそれぞれふさわしいセクションに入れます (たとえば数式エディタは <span class=filename>math</span> です)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>elisp</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Emacs-lisp の ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>emulators</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>他のオペレーティングシステム用のエミュレータ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>端末エミュレータはここに<em>含まれません</em> - X ベースのものは <span class=filename>x11</span> に、 テキストベースのものは機能によって <span class=filename>comms</span> か <span class=filename>misc</span> に分類されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>finance</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>金融や財務会計関連のアプリケーション。</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>french</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>フランス語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>ftp</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FTP クライアントとサーバユーティリティ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>port が FTP と HTTP の両方に対応していれば、 <span class=filename>ftp</span> に入れ、第 2 カテゴリを <span class=filename>www</span> とします。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>games</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ゲーム</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>german</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ドイツ語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>gnome*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=http://www.gnome.org>GNOME</a> プロジェクトの ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>graphics</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>グラフィックユーティリティ</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>haskell*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Haskell 言語関連のソフトウェア。</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>hebrew</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ヘブライ語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>hungarian</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ハンガリー語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>ipv6*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IPv6 関連のソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>irc</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>インターネットリレーチャット (IRC) 用ユーティリティ</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>japanese</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>日本語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>java</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Java 言語関連のソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>kde*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=http://www.kde.org>K Desktop Environment (kde)</a> プロジェクトの ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>korean</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>韓国語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>lang</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>プログラミング言語</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>linux*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Linux アプリケーションとサポートユーティリティ</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>lisp*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lisp 言語関連のソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>mail</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>メールソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>math</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>数値計算ソフトウェアやその他の数学ソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>mbone</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>MBone アプリケーション</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>misc</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>種々のユーティリティ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>基本的に他のカテゴリに属さないものです。 これは他の仮想でないカテゴリを伴わない、唯一のカテゴリです。 <code>misc</code> と他のカテゴリが <code>CATEGORIES</code> 行に書かれている場合、 <code>misc</code> を削除して他のサブディレクトリにおいて良いという意味になります。 このカテゴリに置かれた ports は見落とされやすいので、 可能な限り <code>misc</code> よりふさわしいカテゴリを探してください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>multimedia</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>マルチメディアソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>net</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>種々のネットワークソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>net-mgmt</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ネットワーク管理ソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>news</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>USENET ニュースソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>offix*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=http://leb.net/OffiX/>OffiX</a> suite の ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>palm</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=http://www.palm.com/>Palm™</a> シリーズをサポートするソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>parallel*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>並列計算を行うアプリケーション</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>pear*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pear PHP フレームワーク関連の ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>perl5*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Perl バージョン 5 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>picobsd</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=http://people.FreeBSD.org/~picobsd/>PicoBSD</a> をサポートするための ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>plan9*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=http://www.cs.bell-labs.com/plan9dist/>Plan9</a> に由来するさまざまなソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>polish</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ポーランド語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>portuguese</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ポルトガル語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>print</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>印刷ソフトウェア</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTP 用ツール (プレビューアなど) もここに分類されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>python*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=http://www.python.org/>Python</a> 言語関連のソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>ruby*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=http://www.ruby-lang.org/>Ruby</a> 言語関連のソフトウェア</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>russian</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ロシア語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>science</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>astro</span> や <span class=filename>biology</span>, <span class=filename>math</span> 等、 他のカテゴリにはあてはまらない科学関連の ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>security</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>セキュリティ関連のユーティリティ</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>shells</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>コマンドラインシェル</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>sysutils</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>システムユーティリティ</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tcl76*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Tcl バージョン 7.6 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tcl80*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Tcl バージョン 8.0 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tcl81*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Tcl バージョン 8.1 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tcl82*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Tcl バージョン 8.2 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tcl83*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Tcl バージョン 8.3 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>textproc</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>テキスト処理ユーティリティ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTP ツールはここではなく、<span class=filename>print</span> に分類されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tk42*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Tk バージョン 4.2 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tk80*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Tk バージョン 8.0 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tk81*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Tk バージョン 8.1 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tk82*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Tk バージョン 8.2 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tk83*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に Tk バージョン 8.3 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>tkstep80*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>実行に TkSTEP バージョン 8.0 を必要とする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>ukrainian</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ウクライナ語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>vietnamese</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ベトナム語サポート</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>windowmaker*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>WindowMaker ウィンドウマネージャをサポートする ports</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>www</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>World Wide Web 関連のソフトウェア</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>HTML 言語サポートもここに分類されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>x11</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>X ウィンドウシステムとその関連ソフトウェア</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>このカテゴリは、 直接ウィンドウシステムをサポートするソフトウェアのみを対象とするものです。 通常の X アプリケーションをここに分類しないでください。 ほとんどは他の <span class=filename>x11-*</span> カテゴリ (下記参照) に分類されるべきです。 あなたの port が X アプリケーションで、 <code>USE_XLIB</code> を定義し (<code>USE_IMAKE</code> を定義すると自動的に定義されます)、 適切なカテゴリに分類してください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>x11-clocks</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>X11 用時計</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>x11-fm</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>X11 用ファイルマネージャ</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>x11-fonts</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>X11 フォントとフォントユーティリティ</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>x11-servers</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>X11 サーバ</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>x11-toolkits</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>X11 ツールキット</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>x11-wm</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>X11 ウィンドウマネージャ</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>zope*</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=http://www.zope.org/>Zope</a> サポート</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table></div><div class=sect3><h4 id=_適切なカテゴリの選択>5.3.3. 適切なカテゴリの選択<a class=anchor href=#_適切なカテゴリの選択></a></h4><div class=paragraph><p>多くのカテゴリに重なるので、 どれを"第一"カテゴリにするかを決めなければならないことがたびたびあるでしょう。 これをうまく決めるルールがいくつかあります。 以下はその優先順のリストで、優先度の高いものから低いものの順に書いてあります。</p></div><div class=ulist><ul><li><p>言語特有のカテゴリがまず最初です。 たとえば日本語の X11 のフォントをインストールする port の場合、 <code>CATEGORIES</code> 行は <span class=filename>japanese x11-fonts</span> となるでしょう。</p></li><li><p>より特徴的なカテゴリが、 一般的なカテゴリより優先されます。 たとえば、HTML エディタの場合は <span class=filename>www editors</span> となります。 これを逆順にはしないでください。 また、 port が <span class=filename>irc</span>, <span class=filename>mail</span>, <span class=filename>mbone</span>, <span class=filename>news</span>, <span class=filename>security</span>, <span class=filename>www</span> のいずれかに属する場合には <span class=filename>net</span> は暗黙のうちに含まれますので、入れるべきではありません。</p></li><li><p><span class=filename>x11</span> を第二カテゴリにするのは第一カテゴリが自然言語の場合のみにしてください。 特に X のアプリケーションには <span class=filename>x11</span> を指定しないでください。</p></li><li><p>Emacs のモードは、 そのモードで対応しているアプリケーションと同じ ports カテゴリに置くようにして、 <span class=filename>editors</span> には置かないでください。 例えば、あるプログラミング言語のソースファイルを編集するための Emacs モードは、 <span class=filename>lang</span> に置くべきです。</p></li><li><p>もし、あなたの port が他のどのカテゴリにも属しない場合には <span class=filename>misc</span> にしてください。</p></li></ul></div><div class=paragraph><p>もし、あなたがカテゴリについて自信が持てない場合には、 そのことを <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> する時に書き加えてください。 そうすればインポートする前にそれについて議論できます (もしあなたがコミッターであれば、 そのことを <a href=https://lists.FreeBSD.org/subscription/freebsd-ports>FreeBSD ports メーリングリスト</a> に送って先に議論するようにしてください。 新しい port が間違ったカテゴリに import されて、 すぐ移動されることがあまりに多いのです。そうなると、 ソースリポジトリのマスターが不要で好ましくない膨れ方をしてしまいます。</p></div></div></div><div class=sect2><h3 id=makefile-distfiles>5.4. 配布ファイル<a class=anchor href=#makefile-distfiles></a></h3><div class=paragraph><p><span class=filename>Makefile</span> の第二の部分では、 その port をビルドするためにダウンロードしなければならないファイルと、 それをどこからダウンロードできるか説明しています。</p></div><div class=sect3><h4 id=_distname>5.4.1. <code>DISTNAME</code><a class=anchor href=#_distname></a></h4><div class=paragraph><p><code>DISTNAME</code> は製作者が決めたソフトウェアの名前です。 デフォルトでは <code>DISTNAME</code> は <code>${PORTNAME}-${PORTVERSION}</code> になりますので、 必要にな場合だけ書き換えるようにしてください。 <code>DISTNAME</code> は二つの場所でしか使われません。 一つ目は配布ファイルリスト (<code>DISTFILES</code>) のデフォルト <code>${DISTNAME} ${EXTRACT_SUFX}</code> で、二つ目は配布ファイルが展開されるサブディレクトリ <code>WRKSRC</code> のデフォルト <span class=filename>work/${DISTNAME}</span> です。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>PKGNAMEPREFIX</code> や <code>PKGNAMESUFFIX</code> は <code>DISTNAME</code> に影響を与えません。 また、元のソースアーカイブが <code>${PORTNAME}-${PORTVERSION}${EXTRACT_SUFX}</code> という 名前ではないのに、<code>WRKSRC</code> を <span class=filename>work/${PORTNAME}-${PORTVERSION}</span> と設定しているなら、おそらく <code>DISTNAME</code> はそのままにしておく必要があることに注意してください - <code>DISTNAME</code> と <code>WRKSRC</code> の両方を (そして おそらく <code>EXTRACT_SUFX</code> も) セットするよりは、<code>DISTFILES</code> を定義する方が楽でしょう。</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_master_sites>5.4.2. <code>MASTER_SITES</code><a class=anchor href=#_master_sites></a></h4><div class=paragraph><p>元になる配布ファイルを指し示す、FTP/HTTP の URL のファイル名を除いた部分を <code>MASTER_SITES</code> に設定します。 最後にスラッシュ (<span class=filename>/</span>) をつけることをお忘れなく!</p></div><div class=paragraph><p>このシステム上に配布ファイルが見つからなかった場合、 <code>make</code> マクロは <code>FETCH</code> を使ってこの変数に指定されたサイトから配布ファイルを取得しようとします。</p></div><div class=paragraph><p>このリストには、 できれば異なる大陸に存在する複数のサイトを入れておくことが推奨されています。 これにより、広域ネットワークのトラブルに対する耐性を高めることができます。 さらに私たちは、自動的に最も近いマスタサイトを判断して、 そこから取ってくるメカニズムの導入を計画しています。 複数のサイトがあれば、この取組を大きく助けることになります。</p></div><div class=paragraph><p>元になる tar ファイルが X-contrib や GNU, Perl CPAN 等の有名なアーカイブサイトに置かれている場合には、 <code>MASTER_SITE_*</code> を使ってこれらのサイトを簡潔に (例えば <code>MASTER_SITE_XCONTRIB</code> とか、 <code>MASTER_SITE_PERL_CPAN</code> のように) 指定することができます。 <code>MASTER_SITES</code> を これらの変数の一つにセットし、 サイト内でのパスを <code>MASTER_SITE_SUBDIR</code> に指定するだけです。 以下に例を示します。</p></div><div class="literalblock programlisting"><div class=content><pre>MASTER_SITES=         ${MASTER_SITE_XCONTRIB}
MASTER_SITE_SUBDIR=   applications</pre></div></div><div class=paragraph><p>これらの変数は <span class=filename>/usr/ports/Mk/bsd.sites.mk</span> で定義されています。 いつでも新しい項目が追加されて行きますので、 port を提出する前に このファイルの最新版を チェックするように心掛けてください。</p></div><div class=paragraph><p>ユーザは <span class=filename>/etc/make.conf</span> 中で <code>MASTER_SITE_*</code> 変数を上書きすることもできます。 そうすることで、これらの有名なアーカイブそのものではなく、 好みのミラーサイトを使用することができます。</p></div></div><div class=sect3><h4 id=_extract_sufx>5.4.3. <code>EXTRACT_SUFX</code><a class=anchor href=#_extract_sufx></a></h4><div class=paragraph><p>配布ファイルが 1 つで、 圧縮方式を示すのに普通と異なる接尾辞を使っていたら、 <code>EXTRACT_SUFX</code> を設定してください。</p></div><div class=paragraph><p>例えば、配布ファイルがより一般的な <span class=filename>foo.tar.gz</span> ではなく、 <span class=filename>foo.tgz</span> となっていたら、 次のように書きます。</p></div><div class="literalblock programlisting"><div class=content><pre>DISTNAME=      foo
EXTRACT_SUFX=  .tgz</pre></div></div><div class=paragraph><p><code>USE_BZIP2</code> と <code>USE_ZIP</code> 変数を設定すると、<code>EXTRACT_SUFX</code> は必要に応じて自動的に <code>.bz2</code> または <code>.zip</code> に設定されます。 どちらも設定されていなければ、<code>EXTRACT_SUFX</code> は <code>.tar.gz</code> に設定されます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>EXTRACT_SUFX</code> と <code>DISTFILES</code> を両方設定する必要はありません。</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_distfiles>5.4.4. <code>DISTFILES</code><a class=anchor href=#_distfiles></a></h4><div class=paragraph><p>時々、ダウンロードするファイルの名称が port の名称とまったく似ていないことがあります。たとえば、 <span class=filename>source.tar.gz</span> などと名づけられていることもあるでしょう。 ほかに、ソースコードがいくつかのアーカイブに分かれていて、 そのすべてをダウンロードしなければならないならないこともあります。</p></div><div class=paragraph><p>この場合、<code>DISTFILES</code> に、ダウンロードしなければならないファイルすべてのリストを、 スペースで区切って設定してください。</p></div><div class="literalblock programlisting"><div class=content><pre>DISTFILES=     source1.tar.gz source2.tar.gz</pre></div></div><div class=paragraph><p>明示的に設定されていない場合、 <code>DISTFILES</code> は <code>${DISTNAME}${EXTRACT_SUFX}</code> に設定されます。</p></div></div><div class=sect3><h4 id=_extract_only>5.4.5. <code>EXTRACT_ONLY</code><a class=anchor href=#_extract_only></a></h4><div class=paragraph><p><code>DISTFILES</code> の一部だけを展開すべき (例えば、一方がソースコードで、もう一方は圧縮されていない文書という) 場合、展開しなければならないファイル名を <code>EXTRACT_ONLY</code> に設定してください。</p></div><div class="literalblock programlisting"><div class=content><pre>DISTFILES=     source.tar.gz manual.html
EXTRACT_ONLY=  source.tar.gz</pre></div></div><div class=paragraph><p><em>どの</em><code>DISTFILES</code> も展開すべきでは<em>ない</em>なら、 <code>EXTRACT_ONLY</code> に空文字列を設定してください。</p></div><div class="literalblock programlisting"><div class=content><pre>EXTRACT_ONLY=</pre></div></div></div><div class=sect3><h4 id=porting-patchfiles>5.4.6. <code>PATCHFILES</code><a class=anchor href=#porting-patchfiles></a></h4><div class=paragraph><p>その port が配布ファイルの他に FTP や HTTP で手に入る追加パッチを必要とする場合には、 <code>PATCHFILES</code> にはそのパッチのファイル名を、 <code>PATCH_SITES</code> にはそのファイルが置かれているディレクトリの URL をセットしてください。(書き方は <code>MASTER_SITES</code> と同じです。)</p></div><div class=paragraph><p>そのパッチに記録されているファイル名に余計なパス名がついていて、 ソースツリーのトップディレクトリ (つまり <code>WKRSRC</code>) からの相対パスになっていない場合には、 それに応じた <code>PATCH_DIST_STRIP</code> を指定してください。 たとえば、パッチ内のすべてのファイル名の先頭に、余計な <code>foozolix-1.0/</code> がついている場合には、 <code>PATCH_DIST_STRIP=-p1</code> としてください。</p></div><div class=paragraph><p>これらのパッチは圧縮されていても大丈夫です。 ファイル名が <span class=filename>.gz</span> や <span class=filename>.Z</span> で終わる場合には、自動的に展開されるようになっています。</p></div><div class=paragraph><p>もしパッチが、ドキュメント等その他のファイルと一緒に gzip された tar ファイルで配布されている場合には、単に <code>PATCHFILES</code> を使うだけではうまくいきません。 このような場合には、このパッチの tar ファイルの名前と場所を <code>DISTFILES</code> と <code>MASTER_SITES</code> に追加しておきます。 それから、<code>EXTRA_PATCHES</code> 変数にそれらのパッチを指定すれば、 <span class=filename>bsd.port.mk</span> が 自動的にパッチを適用してくれます。 特に注意が必要なのは、パッチファイルを <code>PATCHDIR</code> ディレクトリにコピー<em>してはならない</em>ことです - (訳注: port が CD-ROM 上に置かれている等の場合には、) そのディレクトリには書き込みができないかもしれません。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>それが普通の gzip か compress された tar ファイルであれば、 通常のソースファイルと一緒にパッチ適用時までに展開されていますので、 明示的に展開する必要はありません。 もしパッチを <code>DISTFILES</code> に追加した場合には、パッチを含むファイルが展開される際に、 そのディレクトリにある何かを上書きしないように注意してください。 さらに、コピーされたパッチファイルを削除するコマンドを <code>pre-clean</code> ターゲットに追加することを忘れないでください。</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=porting-master-sites-n>5.4.7. 異なるサイトやサブディレクトリからの複数の配布ファイルまたはパッチ (<code>MASTER_SITES:n</code>)<a class=anchor href=#porting-master-sites-n></a></h4><div class=paragraph><p>(これはいささか"高度な話題"です。 この文書を初めて読む人は、 最初はこの節を飛ばしてもよいでしょう)。</p></div><div class=paragraph><p>この節は <code>MASTER_SITES:n</code> や <code>MASTER_SITES_NN</code> と呼ばれる取得方法について説明しています。 ここでは、この方式を <code>MASTER_SITES:n</code> と呼びます。</p></div><div class=paragraph><p>まず、背景を少し説明しておきましょう。OpenBSD には、<code>DISTFILES</code> と <code>PATCHFILES</code> 変数の両方に素敵な機能があります。ファイル、パッチの両方とも、 後ろに <code>:n</code> (<code>n</code> は <code>[0-9]</code> のどれかになります) をつけてグループを指示できます。たとえば、</p></div><div class="literalblock programlisting"><div class=content><pre>DISTFILES=      alpha:0 beta:1</pre></div></div><div class=paragraph><p>OpenBSD では、配布ファイル <span class=filename>alpha</span> は、通常の <code>MASTER_SITES</code> ではなく <code>MASTER_SITES0</code> に、 <span class=filename>beta</span> は <code>MASTER_SITES1</code> に結び付けられます。</p></div><div class=paragraph><p>これは、正しいダウンロードサイトを際限なく探す羽目になるのを減らせる、 興味深い機能です。</p></div><div class=paragraph><p><code>DISTFILES</code> にファイルが 2 つ指定され、<code>MASTER_SITES</code> が 20 サイトあって、サイトはものすごく遅く、 <span class=filename>beta</span> は <code>MASTER_SITES</code> 中のすべてのサイトに置かれていますが、 <span class=filename>alpha</span> は 20 番目のサイトにしかないという場合を考えてください。 メンテナがあらかじめそのことを知っていたら、 すべてのサイトを確認するのは無駄だと思いませんか? 楽しい週末のはじまりというわけにはゆきませんね。</p></div><div class=paragraph><p>イメージできたら、今度は <code>DISTFILES</code> や <code>MASTER_SITES</code> がもっと沢山あるのを想像してください。 "distfiles 調査マイスタ"は、 ネットワーク負荷が緩和されることを喜ぶに違いありません。</p></div><div class=paragraph><p>次節からは、FreeBSD におけるこのアイディアの実装について説明します。 OpenBSD の考え方を多少改良しています。</p></div></div><div class=sect3><h4 id=_簡単な説明>5.4.8. 簡単な説明<a class=anchor href=#_簡単な説明></a></h4><div class=paragraph><p>この節では、複数の配布ファイルやパッチを、 異なるサイトやサブディレクトリから細かく分けて取得する簡単な設定を示します。 ここでは、単純化した <code>MASTER_SITES:n</code> の使い方を説明します。ほとんどの場面ではこれで十分です。 さらに詳しいことを知りたければ、次の節をお読みください。</p></div><div class=paragraph><p>アプリケーションによっては、 いくつもの異なるサイトからダウンロードする複数の配布ファイルからなっているものがあります。 たとえば、Ghostscript は、中核部のプログラムと、 ユーザのプリンタに応じて使い分けられる多数のドライバファイルからなっています。 このドライバファイルの一部は中核部と共に配布されますが、 多くはさまざまなサイトからダウンロードしなければなりません。</p></div><div class=paragraph><p>これに対応するため、<code>DISTFILES</code> の各項目の後ろには、コロンと"タグ名" をつけられるようになっています。<code>MASTER_SITES</code> に設定されているそれぞれのサイトの末尾にも、コロンと、 そのサイトからダウンロードすべきファイルを示すためのタグを加えます。</p></div><div class=paragraph><p>たとえば、ソースコードが <span class=filename>source1.tar.gz</span> と <span class=filename>source2.tar.gz</span> の 2 つに分けられていて、 2 つの別のサイトからダウンロードしなければならないアプリケーションを考えてみましょう。 その port の <span class=filename>Makefile</span> には、<a href=#ports-master-sites-n-example-simple-use-one-file-per-site>各サイトに 1 つファイルがある場合の、簡単な <code>MASTER_SITES:n</code> の使用法</a> のような行があるとします。</p></div><div id=ports-master-sites-n-example-simple-use-one-file-per-site class=exampleblock><div class=title>例 1. 各サイトに 1 つファイルがある場合の、簡単な <code>MASTER_SITES:n</code> の使用法</div><div class=content><div class="literalblock programlisting"><div class=content><pre>MASTER_SITES=   ftp://ftp.example1.com/:source1 \
                ftp://ftp.example2.com/:source2
DISTFILES=      source1.tar.gz:source1 \
                source2.tar.gz:source2</pre></div></div></div></div><div class=paragraph><p>複数の配布ファイルに同じタグがついていてもかまいません。 先ほどの例に続いて、3 番目の配布ファイル <span class=filename>source3.tar.gz</span> があって、 <code>ftp.example2.com</code> からダウンロードすべきだとしましょう。 <span class=filename>Makefile</span> は <a href=#ports-master-sites-n-example-simple-use-more-than-one-file-per-site>各サイトに 1 つ以上ファイルがある場合の、簡単な <code>MASTER_SITES:n</code> の使用法</a> のようになります。</p></div><div id=ports-master-sites-n-example-simple-use-more-than-one-file-per-site class=exampleblock><div class=title>例 2. 各サイトに 1 つ以上ファイルがある場合の、簡単な <code>MASTER_SITES:n</code> の使用法</div><div class=content><div class="literalblock programlisting"><div class=content><pre>MASTER_SITES=   ftp://ftp.example1.com/:source1 \
                ftp://ftp.example2.com/:source2
DISTFILES=      source1.tar.gz:source1 \
                source2.tar.gz:source2 \
                source3.tar.gz:source2</pre></div></div></div></div></div><div class=sect3><h4 id=_詳しい説明>5.4.9. 詳しい説明<a class=anchor href=#_詳しい説明></a></h4><div class=paragraph><p>分かりました。 前節の例ではあなたの要求を満足できなかったわけですね。 この節では、ファイルの取得を細かく制御する仕組み <code>MASTER_SITES:n</code> がどう働くかと、これを利用するために ports をどう変更すればよいかを詳しく説明します。</p></div><div class="olist arabic"><ol class=arabic><li><p>要素の末尾に <code>:n</code> をつけることができます。 ここで、<em>n</em> は <code><span class=^:>` つまり、概念上はいかなる文字と数字からなる文字列でもよいのですが、 われわれとしては、当面は `[a-zA-Z_][0-9a-zA-Z_]</span></code> に制限します。</p><div class=paragraph><p>さらに、文字列のマッチは大文字と小文字を区別します。 つまり、<code>n</code> と <code>N</code> は別の文字として扱われます。</p></div><div class=paragraph><p>しかし、 <code>default</code>, <code>all</code>, <code>ALL</code> は特別な意味を与えられているので、 末尾に付加するのには使えません (これは、<a href=#porting-master-sites-n-what-changes-in-port-targets>ii</a> 項で内部的に利用されています)。 さらに、<code>DEFAULT</code> は特別な意味を持つ単語です (<a href=#porting-master-sites-n-DEFAULT-group>3</a> の項を確認してください)。</p></div></li><li><p><code>:n</code> がついた要素は、グループ <code>n</code> に属し、 <code>:m</code> がついた要素は、グループ <code>m</code> に属するということになります。</p></li><li><p>接尾辞がついていない要素はグループに属しません。 これは、特別なグループ <code>DEFAULT</code> に属しているとして扱われます。 要素の後ろに <code>DEFAULT</code> をつけるのは、その要素を <code>DEFAULT</code> とそれ以外のグループに同時に割り当てたいのでなければ、 冗長に過ぎません (<a href=#porting-master-sites-n-comma-operator>5</a> の項を確認してください)。</p><div class=paragraph><p>次の例はどちらも同じ意味ですが、 最初の方が好ましいです。</p></div><div class="literalblock programlisting"><div class=content><pre>MASTER_SITES=   alpha

MASTER_SITES=   alpha:DEFAULT</pre></div></div></li><li><p>グループは相互排他ではありません。 ひとつの要素が同時に複数のグループに属することができ、 ひとつのグループには複数の要素が属することも、 何も割り当てないこともできます。 同じグループで何回も指定された要素は、 単に複数回指定された要素ということになります。</p></li><li><p>ある要素を同時にいくつものグループに所属させたい時は、 カンマ演算子 (<code>,</code>) が使えます。</p><div class=paragraph><p>その都度別の接尾辞をつけて繰り返すかわりに、 一度だけ接尾辞を指定して複数のグループを指定できます。 たとえば、<code>:m,n,o</code> と書くと、その要素はグループ <code>m</code>, <code>n</code> および <code>o</code> に属することを示します。</p></div><div class=paragraph><p>以下の例はすべて同等ですが、 最後の形式がもっともよいでしょう。</p></div><div class="literalblock programlisting"><div class=content><pre>MASTER_SITES=   alpha alpha:SOME_SITE

MASTER_SITES=   alpha:DEFAULT alpha:SOME_SITE

MASTER_SITES=   alpha:SOME_SITE,DEFAULT

MASTER_SITES=   alpha:DEFAULT,SOME_SITE</pre></div></div></li><li><p>任意のグループ内のサイトは、 <code>MASTER_SORT_AWK</code> によって整列されます。 <code>MASTER_SITES</code> と <code>PATCH_SITES</code> 内のすべてのグループについても同様に整列されます。</p></li></ol></div><div id=porting-master-sites-n-group-semantics class="olist arabic"><ol class=arabic><li><p>グループの概念は、変数 <code>MASTER_SITES</code>, <code>PATCH_SITES</code>, <code>MASTER_SITE_SUBDIR</code>, <code>PATCH_SITE_SUBDIR</code>, <code>DISTFILES</code> および <code>PATCHFILES</code> においても、下記の文法に従って使えます。</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p><code>MASTER_SITES</code>, <code>PATCH_SITES</code>, <code>MASTER_SITE_SUBDIR</code> および <code>PATCH_SITE_SUBDIR</code> のすべての要素はスラッシュ <code>/</code> 記号で終端されていなければなりません。 ある要素がどれかのグループに属しているなら、 グループの接尾辞 <code>:n</code> は、終端記号 <code>/</code> のすぐ後にこなければなりません。 <code>MASTER_SITES:n</code> の仕組みでは、終端記号 <code>/</code> があることで、 <code>:n</code> が要素の有効な一部である場合と、 <code>:n</code> がグループ <code>n</code> を示す場合の混同を避けることができます。 以前は、 <code>MASTER_SITE_SUBDIR</code> と <code>PATCH_SITE_SUBDIR</code> 要素のいずれにおいても終端記号 <code>/</code> は不要だったので、互換性を保つために、 接尾辞の直前の文字が <code>/</code> でなければ、 要素の接尾辞が <code>:n</code> であっても、 グループの接尾語ではなく、 要素の有効な一部分として扱われます。 <a href=#ports-master-sites-n-example-detailed-use-master-site-subdir><code>MASTER_SITE_SUBDIR</code> における <code>MASTER_SITES:n</code> の詳細な使用法</a> と <a href=#ports-master-sites-n-example-detailed-use-complete-example-master-sites>カンマ演算子、複数のファイル、複数のサイト、 複数のサブディレクトリと合わせた <code>MASTER_SITES:n</code> の詳細な使用法</a> の両方をご覧ください。</p><div id=ports-master-sites-n-example-detailed-use-master-site-subdir class=exampleblock><div class=title>例 3. <code>MASTER_SITE_SUBDIR</code> における <code>MASTER_SITES:n</code> の詳細な使用法</div><div class=content><div class="literalblock programlisting"><div class=content><pre>MASTER_SITE_SUBDIR=     old:n new/:NEW</pre></div></div><div class=ulist><ul><li><p>グループ <code>DEFAULT</code> に属するディレクトリ → old:n</p></li><li><p>グループ <code>NEW</code> に属するディレクトリ → new</p></li></ul></div></div></div><div id=ports-master-sites-n-example-detailed-use-complete-example-master-sites class=exampleblock><div class=title>例 4. カンマ演算子、複数のファイル、複数のサイト、 複数のサブディレクトリと合わせた <code>MASTER_SITES:n</code> の詳細な使用法</div><div class=content><div class="literalblock programlisting"><div class=content><pre>MASTER_SITES=   http://site1/%SUBDIR%/ http://site2/:DEFAULT \
                http://site3/:group3 http://site4/:group4 \
                http://site5/:group5 http://site6/:group6 \
                http://site7/:DEFAULT,group6 \
                http://site8/%SUBDIR%/:group6,group7 \
                http://site9/:group8
DISTFILES=      file1 file2:DEFAULT file3:group3 \
                file4:group4,group5,group6 file5:grouping \
                file6:group7
MASTER_SITE_SUBDIR=     directory-trial:1 directory-n/:groupn \
                        directory-one/:group6,DEFAULT \
                        directory</pre></div></div><div class=paragraph><p>上の例は、次のような細かく分けた取得を実現します。 サイトは、利用される順番で挙げられています。</p></div><div class=ulist><ul><li><p><span class=filename>file1</span> は次のサイトから取得されます。</p><div class=ulist><ul><li><p><code>MASTER_SITE_OVERRIDE</code></p></li><li><p><a href=http://site1/directory/ class=bare>http://site1/directory/</a></p></li><li><p><a href=http://site1/directory-one/ class=bare>http://site1/directory-one/</a></p></li><li><p><a href=http://site1/directory-trial:1/ class=bare>http://site1/directory-trial:1/</a></p></li><li><p><a href=http://site2/ class=bare>http://site2/</a></p></li><li><p><a href=http://site7/ class=bare>http://site7/</a></p></li><li><p><code>MASTER_SITE_BACKUP</code></p></li></ul></div></li><li><p><span class=filename>file2</span> は、<span class=filename>file1</span> と同じグループに属しているので、 まったく同じように取得されます。</p><div class=ulist><ul><li><p><code>MASTER_SITE_OVERRIDE</code></p></li><li><p><a href=http://site1/directory/ class=bare>http://site1/directory/</a></p></li><li><p><a href=http://site1/directory-one/ class=bare>http://site1/directory-one/</a></p></li><li><p><a href=http://site1/directory-trial:1/ class=bare>http://site1/directory-trial:1/</a></p></li><li><p><a href=http://site2/ class=bare>http://site2/</a></p></li><li><p><a href=http://site7/ class=bare>http://site7/</a></p></li><li><p><code>MASTER_SITE_BACKUP</code></p></li></ul></div></li><li><p><span class=filename>file3</span> は次のサイトから取得されます。</p><div class=ulist><ul><li><p><code>MASTER_SITE_OVERRIDE</code></p></li><li><p><a href=http://site3/ class=bare>http://site3/</a></p></li><li><p><code>MASTER_SITE_BACKUP</code></p></li></ul></div></li><li><p><span class=filename>file4</span> は次のサイトから取得されます。</p><div class=ulist><ul><li><p><code>MASTER_SITE_OVERRIDE</code></p></li><li><p><a href=http://site4/ class=bare>http://site4/</a></p></li><li><p><a href=http://site5/ class=bare>http://site5/</a></p></li><li><p><a href=http://site6/ class=bare>http://site6/</a></p></li><li><p><a href=http://site7/ class=bare>http://site7/</a></p></li><li><p><a href=http://site8/directory-one/ class=bare>http://site8/directory-one/</a></p></li><li><p><code>MASTER_SITE_BACKUP</code></p></li></ul></div></li><li><p><span class=filename>file5</span> は次のサイトから取得されます。</p><div class=ulist><ul><li><p><code>MASTER_SITE_OVERRIDE</code></p></li><li><p><code>MASTER_SITE_BACKUP</code></p></li></ul></div></li><li><p><span class=filename>file6</span> は次のサイトから取得されます。</p><div class=ulist><ul><li><p><code>MASTER_SITE_OVERRIDE</code></p></li><li><p><a href=http://site8/directory-one/ class=bare>http://site8/directory-one/</a></p></li><li><p><code>MASTER_SITE_BACKUP</code></p></li></ul></div></li></ul></div></div></div></li></ol></div></li><li><p><code>MASTER_SITE_SOURCEFORGE</code> のように、<span class=filename>bsd.sites.mk</span> で定義される特別な変数をグループに割り当てるにはどうすればよいですか?</p><div class=paragraph><p><a href=#ports-master-sites-n-example-detailed-use-master-site-sourceforge><code>MASTER_SITE_SOURCEFORGE</code> と合わせた <code>MASTER_SITES:n</code> の詳しい使用法</a> をご覧ください。</p></div><div id=ports-master-sites-n-example-detailed-use-master-site-sourceforge class=exampleblock><div class=title>例 5. <code>MASTER_SITE_SOURCEFORGE</code> と合わせた <code>MASTER_SITES:n</code> の詳しい使用法</div><div class=content><div class="literalblock programlisting"><div class=content><pre>MASTER_SITES=   http://site1/ ${MASTER_SITE_SOURCEFORGE:S/$/:sourceforge,TEST/}
DISTFILES=      something.tar.gz:sourceforge</pre></div></div></div></div><div class=paragraph><p><span class=filename>something.tar.gz</span> は、<code>MASTER_SITE_SOURCEFORGE</code> に含まれるあらゆるサイトから取得されます。</p></div></li><li><p>これを <code>PATCH*</code> 変数と組み合わせて使うにはどうすればよいでしょうか?</p><div class=paragraph><p>すべての例で <code>MASTER*</code> 変数を使っていますが、<a href=#ports-master-sites-n-example-detailed-use-patch-sites><code>PATCH_SITES</code> と合わせた <code>MASTER_SITES:n</code> の簡単な使用法</a> にあるように、<code>PATCH*</code> 変数に対してもまったく同じように働きます。</p></div><div id=ports-master-sites-n-example-detailed-use-patch-sites class=exampleblock><div class=title>例 6. <code>PATCH_SITES</code> と合わせた <code>MASTER_SITES:n</code> の簡単な使用法</div><div class=content><div class="literalblock programlisting"><div class=content><pre>PATCH_SITES=    http://site1/ http://site2/:test
PATCHFILES=     patch1:test</pre></div></div></div></div></li></ol></div></div><div class=sect3><h4 id=_ports_について何が変更され何が変わらないのでしょうか>5.4.10. ports について何が変更され、何が変わらないのでしょうか?<a class=anchor href=#_ports_について何が変更され何が変わらないのでしょうか></a></h4><div class="olist lowerroman"><ol class=lowerroman type=i><li><p>現在のすべての ports はそのまま変わりません。 <code>MASTER_SITES:n</code> 機能のコードは、<a href=#porting-master-sites-n-group-semantics>7</a> で述べた文法に従う <code>:n</code> のような形式が後ろについた要素がある場合だけ動作します。</p></li></ol></div><div id=porting-master-sites-n-what-changes-in-port-targets class="olist arabic"><ol class=arabic><li><p>port を make する際のターゲットにも変更はありません。 <code>checksum</code>, <code>makesum</code>, <code>patch</code>, <code>configure</code>, <code>build</code> 等です。 もちろん、<code>do-fetch</code>, <code>fetch-list</code>, <code>master-sites</code> それから <code>patch-sites</code> は例外です。</p><div class=ulist><ul><li><p><code>do-fetch</code> は、新しくグループ分けの接尾辞のついた <code>DISTFILES</code> と <code>PATCHFILES</code> を設定します。それぞれが、対応する <code>MASTER_SITES</code> と <code>PATCH_SITES</code> を利用し、さらに対応する <code>MASTER_SITE_SUBDIR</code> と <code>PATCH_SITE_SUBDIR</code> を利用します。<a href=#ports-master-sites-n-example-detailed-use-complete-example-master-sites>カンマ演算子、複数のファイル、複数のサイト、 複数のサブディレクトリと合わせた <code>MASTER_SITES:n</code> の詳細な使用法</a> をご覧ください。</p></li><li><p><code>fetch-list</code> は、<code>do-fetch</code> と同じようにグループを利用するということを除いて、以前の <code>fetch-list</code> のように動作します。</p></li><li><p><code>master-sites</code> および <code>patch-sites</code> は、 (古いバージョンと互換性がなくなり) <code>DEFAULT</code> グループの要素を返すだけになっています。 実際は、それぞれ <code>master-sites-default</code> および <code>patch-sites-default</code> というターゲットを実行します。</p><div class=paragraph><p>さらに、 <code>MASTER_SITES</code> や <code>PATCH_SITES</code> を直接確認するよりも、 <code>master-sites-all</code> または <code>patch-sites-all</code> のどちらかのターゲットを使う方がよいです。 また、将来のバージョンでも直接確認ができるかどうかは保証されていません。 これら新規 port ターゲットについては、<a href=#porting-master-sites-n-new-port-targets-master-sites-all>B</a> の項をご確認ください。</p></div></li></ul></div></li><li><p>新規の port ターゲット</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p><code>MASTER_SITES</code> および <code>PATCH_SITES</code> のそれぞれについて、 グループ <em>n</em> の要素を表示する <code>master-sites-<em>n</em></code> および <code>patch-sites-<em>n</em></code> ターゲットがあります。たとえば、 <code>master-sites-DEFAULT</code> および <code>patch-sites-DEFAULT</code> のいずれも <code>DEFAULT</code> グループの要素を返し、 <code>master-sites-test</code> および <code>patch-sites-test</code> は <code>test</code> グループの要素を返します。</p></li></ol></div></li></ol></div><div id=porting-master-sites-n-new-port-targets-master-sites-all class="olist loweralpha"><ol class=loweralpha type=a><li><p>以前の <code>master-sites</code> および <code>patch-sites</code> が行っていた作業を行う <code>master-sites-all</code> および <code>patch-sites-all</code> という新たなターゲットがあります。 これらのターゲットは、 すべてのグループの要素をすべてが同じグループに属しているかのように返します。 ただし、 <code>master-sites-all</code> および <code>patch-sites-all</code> のそれぞれについて、 <code>DISTFILES</code> や <code>PATCHFILES</code> で定義されているグループと同じ数だけ <code>MASTER_SITE_BACKUP</code> と <code>MASTER_SITE_OVERRIDE</code> を表示します。</p></li></ol></div></div><div class=sect3><h4 id=_dist_subdir>5.4.11. <code>DIST_SUBDIR</code><a class=anchor href=#_dist_subdir></a></h4><div class=paragraph><p><span class=filename>/usr/ports/distfiles</span> ディレクトリ内をあまり散らかさないようにしてください。 たくさんのファイルを取ってくる port や、他の port と名前の衝突が起きる恐れのあるファイル (<span class=filename>Makefile</span> など) がある場合には、 <code>DIST_SUBDIR</code> に port の名前 (<code>${PORTNAME}</code> か <code>${PKGNAMEPREFIX}${PORTNAME}</code> を使うといいでしょう) を入れてください。すると <code>DISTDIR</code> がデフォルトの <span class=filename>/usr/ports/distfiles</span> から <span class=filename>/usr/ports/distfiles/DIST_SUBDIR</span> に変更され、 取ってきたファイルはすべてそのサブディレクトリの中に置かれるようになります。</p></div><div class=paragraph><p>また、 ファイルを取ってくるときにバックアップサイトとして使われる <span class=filename>ftp.FreeBSD.org</span> のディレクトリ名にもこの変数の値が使われます (<code>Makefile</code> の中で <code>DISTDIR</code> を明示的に指定した場合、 ローカルのファイルを置くところは変わりますが、 このサイトのディレクトリ名は変わりません。 必ず <code>DIST_SUBDIR</code> を使うようにしてください)。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>この変数は <span class=filename>Makefile</span> 中で明示的に指定された <code>MASTER_SITES</code> には影響しません。</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=makefile-maintainer>5.5. <code>MAINTAINER</code><a class=anchor href=#makefile-maintainer></a></h3><div class=paragraph><p>あなたのメールアドレスをここに入れてください。 お願いします。 <em>:-)</em></p></div><div class=paragraph><p><code>MAINTAINER</code> の値は、コメント部のない単一のアドレスしか受け付けられません。 <code>user@hostname.domain</code> という形式を利用してください。この項目には、 あなたの本名などの説明用のテキストは一切いれないでください。 (そうしても、ただ <span class=filename>bsd.port.mk</span> が混乱するだけです)。そういう情報は <span class=filename>pkg-descr</span> に書いてください。</p></div><div class=paragraph><p>保守担当者 (maintainer) の責任に関する詳細説明は、 <a href=https://docs.freebsd.org/en/books/developers-handbook/#POLICIES-MAINTAINER>Makefile 中の MAINTAINER</a> の セクションを参照してください。</p></div><div class=paragraph><p>Port のメンテナがユーザからの更新要求に (主な公休日を除いて) 2 週間返答しなかったら、 保守担当者の持ち時間が切れたとみなして、 保守担当者の明示的な了承なしに更新して構いません。 保守担当者が 3 ヶ月以内に返答しない場合は、 その保守担当者は無断で不在にしているとみなして、 問題となっている port の保守担当者を入れ替えても構いません。 例外となるは、ports 管理チーム &lt;<a href=mailto:portmgr@FreeBSD.org>portmgr@FreeBSD.org</a>> または セキュリティオフィサチーム &lt;<a href=mailto:security-officer@FreeBSD.org>security-officer@FreeBSD.org</a>> が保守しているものです。このグループが保守している port に対しては許可を得ずにコミットしてはいけません。</p></div><div class=paragraph><p>ports 管理チーム &lt;<a href=mailto:portmgr@FreeBSD.org>portmgr@FreeBSD.org</a>> は、何か理由があれば、 誰かを保守担当から外したり、別の方を担当者にする権利を持ちます。 セキュリティオフィサチーム &lt;<a href=mailto:security-officer@FreeBSD.org>security-officer@FreeBSD.org</a>> は、セキュリティ上の理由で、 保守担当者の権限を剥奪したり担当者を変更する権利を持ちます。</p></div></div><div class=sect2><h3 id=makefile-comment>5.6. <code>COMMENT</code><a class=anchor href=#makefile-comment></a></h3><div class=paragraph><p>その port の 1 行の説明です。 コメントにはパッケージ名 (やソフトウェアのバージョン) を<em>入れないでください</em>。 コメントは大文字で始め、最後にピリオドは付けないでください。 たとえば、こんな具合です。</p></div><div class="literalblock programlisting"><div class=content><pre>COMMENT=       A cat chasing a mouse all over the screen</pre></div></div><div class=paragraph><p><span class=filename>Makefile</span> 中で、 COMMENT 変数は MAINTAINER 変数の直後においてください。</p></div><div class=paragraph><p>COMMENT 行は、port の 1 行の要約としてユーザに示されるので、 70 文字未満に抑えるようにしてください。</p></div></div><div class=sect2><h3 id=makefile-depend>5.7. 依存関係<a class=anchor href=#makefile-depend></a></h3><div class=paragraph><p>多くの port は他の port に依存しています。 必要なものすべてがユーザのマシン上に存在することを 保証するために使用可能な、7 つの変数が用意されています。 よくあるケースのためにあらかじめ設定された依存変数に加え、 いくつかの依存関係の制御のための変数があります。</p></div><div class=sect3><h4 id=_lib_depends>5.7.1. <code>LIB_DEPENDS</code><a class=anchor href=#_lib_depends></a></h4><div class=paragraph><p>その port が必要とする共有ライブラリを、この変数で指定します。 (訳注: libc 等、標準のライブラリは指定する必要がありません。) これは <em>lib:dir</em><code>:target</code> という 組のリストです。 <em>lib</em> が共有ライブラリの名前、 <em>dir</em> が そのライブラリが見つからない場合に インストールされる port のディレクトリ、 <em>target</em>が そのディレクトリで呼ばれるターゲットです。 たとえば、</p></div><div class="literalblock programlisting"><div class=content><pre>LIB_DEPENDS= jpeg.9:${PORTSDIR}/graphics/jpeg:install</pre></div></div><div class=paragraph><p>と指定されていた場合、まずメジャーバージョンが 9 の jpeg 共有ライブラリがインストールされているかどうかを確認します。 インストールされていない場合には、ports ツリーの <span class=filename>graphics/jpeg</span> サブディレクトリに移動し、 <em>target</em> のコンパイルとインストールを行ないます。 <em>target</em> の部分は、 それが <code>DEPENDS_TARGET</code> (デフォルトでは <code>install</code>) と 等しいときには省略することができます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>先頭の <em>lib</em> の部分は <code>ldconfig -r | grep -wF</code> への引数になります。 この変数には正規表現を入れないようにしてください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>この依存関係のチェックは、 <code>extract</code> ターゲットと <code>install</code> ターゲットの中で、2 回行なわれます。 (訳注: これは、その port をビルドするマシンとインストールされるマシンが違う場合、 どちらのマシンでもそのライブラリが利用できることを確認するためです)。 同様に、依存するライブラリの名前は package 中にも書き込まれていて、 <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> 実行時にそのライブラリがユーザのシステムに存在していなければ、 自動的にインストールされます。</p></div></div><div class=sect3><h4 id=_run_depends>5.7.2. <code>RUN_DEPENDS</code><a class=anchor href=#_run_depends></a></h4><div class=paragraph><p>この port の実行時に必要となるプログラム、 またはファイルがあるときにはこの変数で指定します。これは <em>path:dir</em><code>:target</code> という組のリストです。 <em>path</em> がファイルまたはプログラムの名前、 <em>dir</em> が それが見つからない場合にインストールされる port のディレクトリ、 <em>target</em> が そのディレクトリで呼ばれるターゲットです。 <em>path</em> の最初の文字がスラッシュ (<code>/</code>) の場合にはファイルかディレクトリとみなし、 存在するかどうか <code>test -e</code> を使ってチェックします。 そうでない場合には実行可能ファイルであると考えて、 そのプログラムがユーザのサーチパス上にあるかどうか <code>which -s</code> を使って確認します。</p></div><div class=paragraph><p>たとえば Makefile に以下のように書いてあるとします。</p></div><div class="literalblock programlisting"><div class=content><pre>RUN_DEPENDS=   ${LOCALBASE}/etc/innd:${PORTSDIR}/news/inn \
                wish8.0:${PORTSDIR}/x11-toolkits/tk80</pre></div></div><div class=paragraph><p>まず、<span class=filename>/usr/local/etc/innd</span> というファイルかディレクトリが存在するか確認します。 存在しない場合には、ports ツリーの <span class=filename>news/inn</span> というサブディレクトリで ビルドとインストールを行ないます。 さらに、<code>wish8.0</code> というプログラムがユーザのサーチパス中にあるかどうか探します。 ない場合には同じく ports ツリーの <span class=filename>x11-toolkits/tk80</span> というサブディレクトリでコンパイルとインストールを行ないます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>この例で、<code>innd</code> は実際にはプログラムです。 このように、プログラムであっても一般ユーザのサーチパスに 含まれているとは考えにくいところに置かれているものの場合には、 絶対パスで指定してください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>この依存関係は <code>install</code> ターゲット中でチェックされます。 また、<a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> によるインストールの際に、その package が依存するものがユーザのシステムに存在しない場合には自動的に追加インストールできるように、 依存するものの名前も package 中に記録されます。 <em>target</em> の部分が <code>DEPENDS_TARGET</code> と同じ場合には、 <em>target</em> の部分を省略することができます。</p></div></div><div class=sect3><h4 id=_build_depends>5.7.3. <code>BUILD_DEPENDS</code><a class=anchor href=#_build_depends></a></h4><div class=paragraph><p>この port のビルド時に必要となるプログラム、 またはファイルがあるときにはこの変数で指定します。 <code>RUN_DEPENDS</code> と同様に、これは <em>path:dir</em><code>:target</code> という組のリストです。たとえば、</p></div><div class="literalblock programlisting"><div class=content><pre>BUILD_DEPENDS=unzip:${PORTSDIR}/archivers/unzip</pre></div></div><div class=paragraph><p>と指定されていた場合、まず <code>unzip</code> という名前のプログラムがインストールされているかどうかを確認します。 インストールされていない場合には ports ツリーの <span class=filename>archivers/unzip</span> サブディレクトリに移動し、 ビルドとインストールを行ないます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>ここで言う"ビルド"とは、 ファイルの展開からコンパイルまでのすべての処理を意味します。 この依存関係は、<code>extract</code> ターゲットの中でチェックされます。 <em>target</em> の部分は、 <code>DEPENDS_TARGET</code> と同じ場合には省略することができます。</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_fetch_depends>5.7.4. <code>FETCH_DEPENDS</code><a class=anchor href=#_fetch_depends></a></h4><div class=paragraph><p>この port を取ってくるのに必要となるプログラム、 またはファイルがあるときにはこの変数で指定します。 上の二つと同様に、これは <em>path:dir</em><code>:target</code> という組のリストです。たとえば、</p></div><div class="literalblock programlisting"><div class=content><pre>FETCH_DEPENDS=ncftp2:${PORTSDIR}/net/ncftp2</pre></div></div><div class=paragraph><p>と指定されていれば、<code>ncftp2</code> という名前のプログラムを探します。 見つからない場合には、ports ツリーの <span class=filename>net/ncftp2</span> サブディレクトリでビルドとインストールを行ないます。</p></div><div class=paragraph><p>この依存関係は <code>fetch</code> ターゲット中でチェックされます。 <em>target</em> の部分は、 <code>DEPENDS_TARGET</code> と同じ場合には省略することができます。</p></div></div><div class=sect3><h4 id=_extract_depends>5.7.5. <code>EXTRACT_DEPENDS</code><a class=anchor href=#_extract_depends></a></h4><div class=paragraph><p>この変数には、この port の展開に必要な実行ファイルや、他のファイルを指定します。 前の変数と同じく、これは <em>path:dir</em><code>:target</code> のタプルの一覧です。たとえば、</p></div><div class="literalblock programlisting"><div class=content><pre>EXTRACT_DEPENDS=
	    unzip:${PORTSDIR}/archivers/unzip</pre></div></div><div class=paragraph><p>は、<code>unzip</code> という実行形式のファイルがあるかどうか確認し、 見つからなければ、ports ツリーの <span class=filename>archivers/unzip</span> サブディレクトリに降りてビルドおよびインストールを行います。</p></div><div class=paragraph><p>依存関係は <code>extract</code> ターゲットにおいて確認されます。 <em>target</em> 部分が <code>DEPENDS_TARGET</code> と同じなら、省いて構いません。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>この変数は、展開が働いておらず (デフォルトでは <code>gzip</code> を仮定しています)、 <a href=#use-vars><code>USE_*</code></a> で説明されている <code>USE_ZIP</code> や <code>USE_BZIP2</code> を使っても動かない場合にだけ使ってください。</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_patch_depends>5.7.6. <code>PATCH_DEPENDS</code><a class=anchor href=#_patch_depends></a></h4><div class=paragraph><p>この変数は、この port がパッチを当てる際に必要とする実行ファイルや他のファイルを指定します。 前の変数と同じく、これは <em>path:dir</em><code>:target</code> のタプルの一覧です。たとえば、</p></div><div class="literalblock programlisting"><div class=content><pre> PATCH_DEPENDS=
	    ${NONEXISTENT}:${PORTSDIR}/java/jfc:extract</pre></div></div><div class=paragraph><p>は、ports ツリーの <span class=filename>java/jfc</span> サブディレクトリに移動して、 ビルドおよびインストールを行います。</p></div><div class=paragraph><p>依存関係は、<code>patch</code> ターゲットにおいて確認されます。<em>target</em> 部分が <code>DEPENDS_TARGET</code> と同じなら省略して構いません。</p></div></div><div class=sect3><h4 id=_depends>5.7.7. <code>DEPENDS</code><a class=anchor href=#_depends></a></h4><div class=paragraph><p>上記のいずれにもあてはまらないような依存関係がある場合、 または他の port がインストールされているだけではなく ソースが展開されている必要がある場合には、この変数を使います。 これは上記の四つと違い、特に"確認"するものが ありませんので、 <em>dir</em><code>:target</code> という形式のリストになります。 <em>target</em> の部分は <code>DEPENDS_TARGET</code> と同じ場合には省略することができます。</p></div></div><div class=sect3><h4 id=use-vars>5.7.8. <code>USE_*</code><a class=anchor href=#use-vars></a></h4><div class=paragraph><p>多くの ports に共通の依存関係をカプセル化するために、 いくつもの変数が存在しています。</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>表 1. <code>USE_*</code> 変数</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">変数</th><th class="tableblock halign-left valign-top">意味</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_BZIP2</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port の tarball は <code>bzip2</code> で圧縮されています。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_ZIP</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port の tarball は <code>zip</code> で圧縮されています。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_GMAKE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port をビルドするのに <code>gmake</code> が必要です。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PERL5</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port をビルドしてインストールするのに <code>perl 5</code> が必要です。 <code>perl</code> に関連して設定可能な他の変数については <a href=./#using-perl>perl の利用</a> をご覧ください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_X_PREFIX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は <code>PREFIX</code> ではなく <code>X11BASE</code> にインストールされます。 X11 に関連して設定可能な他の変数については、 <a href=./#using-x11>X11 の利用</a> をご覧ください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_AUTOMAKE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port のビルドに GNU <code>automake</code> が使われます。<code>automake</code> に関わる他に設定可能な変数については、 <a href=./#using-automake><code>automake</code> - <code>autoconf</code> および libtool の利用</a> をご覧ください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_AUTOCONF</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port のビルドに GNU <code>autoconf</code> が使われます。<code>autoconf</code> に関わる他に設定可能な変数については、 <a href=./#using-automake><code>automake</code> - <code>autoconf</code> および libtool の利用</a> をご覧ください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_LIBTOOL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port のビルドに GNU <code>libtool</code> が使われます。<code>libtool</code> に関わる他に設定可能な変数については、 <a href=./#using-automake><code>automake</code> - <code>autoconf</code> および libtool の利用</a> をご覧ください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>GMAKE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gmake</code> が <code>PATH</code> に入っていない場合のフルパス</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_BISON</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port のビルドに <code>bison</code> が使われます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_SDL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port のビルドや実行に <code>SDL</code> が使われます。 <code>USE_SDL</code> の使い方について、詳しくは <a href=./#using-sdl>SDL の利用</a> をご覧ください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>NO_INSTALL_MANPAGES</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>install.man</code> ターゲットを使いません。</p></td></tr></tbody></table><div class=paragraph><p>その ports が X Window System を必要とするのであれば、 <code>USE_XLIB=yes</code> を定義してください (これは <code>USE_IMAKE</code> が定義されていれば自動的に定義されます)。 BSD <code>make</code> ではなく GNU <code>make</code> を必要とする場合には <code>USE_GMAKE=yes</code> を、 GNU autoconf を実行する必要がある場合には <code>USE_AUTOCONF=yes</code> を、 最新の qt toolkit を使用する場合には <code>USE_QT=yes</code> を、 <code>perl</code> 言語のバージョン 5 を必要とする場合には <code>USE_PERL5=yes</code> を定義してください (特に最後のものは重要です。 FreeBSD のバージョンにより、基本システムに <code>perl5</code> が含まれていたり、いなかったりします)。</p></div></div><div class=sect3><h4 id=_依存関係に関する注意>5.7.9. 依存関係に関する注意<a class=anchor href=#_依存関係に関する注意></a></h4><div class=paragraph><p>上で述べたように、依存する ports が必要になったときに呼ばれるデフォルトのターゲットは <code>DEPENDS_TARGET</code> で、そのデフォルトは <code>install</code> です。 これはユーザが使用する変数であり、 port の <span class=filename>Makefile</span> で定義するものではありません。 もし、その port が特別な方法で依存関係を扱う必要がある場合には、 <code>DEPENDS_TARGET</code> を再定義するのではなく <code>*_DEPENDS</code> 変数の <code>:target</code> 部分を使用してください。</p></div><div class=paragraph><p><code>make clean</code> と入力したときには、 その port が依存する port も自動的に clean されます。 そうならないようにしたい場合には、 環境変数 <code>NOCLEANDEPENDS</code> を設定してください。KDE, GNOME や Mozilla のように、再ビルドするのに時間がかかる port に依存している場合は特に望ましいかもしれません。</p></div><div class=paragraph><p>無条件に他の port に依存させるには、 <code>BUILD_DEPENDS</code> や <code>RUN_DEPENDS</code> の最初のフィールドに <code>${NONEXISTENT}</code> という変数を指定してください。 これは、他の port のソースが必要なときのみ使用してください。 ターゲットも指定することで、 コンパイルの時間を節約できる場合もあります。 たとえば</p></div><div class="literalblock programlisting"><div class=content><pre>BUILD_DEPENDS=   ${NONEXISTENT}:${PORTSDIR}/graphics/jpeg:extract</pre></div></div><div class=paragraph><p>とすると、常に <code>jpeg</code> port のディレクトリに行ってソースの展開を行ないます。</p></div><div class=paragraph><p>あなたがやりたいことが他の方法ではできない場合以外には <code>DEPENDS</code> を使わないでください。 これは常に他の port の作成を行ない (さらにデフォルトでは インストールも行ない)、package まで作成します。 この動作が本当に所望のものでしたら、 それを <code>BUILD_DEPENDS</code> と <code>RUN_DEPENDS</code> に書くべきでしょう - 少なくとも意図を明確にすることができます。</p></div></div><div class=sect3><h4 id=_オプション選択可能な依存ライブラリ>5.7.10. オプション選択可能な依存ライブラリ<a class=anchor href=#_オプション選択可能な依存ライブラリ></a></h4><div class=paragraph><p>巨大なアプリケーションの中には、 複数のコンフィギュレーションでビルドすることができるものがあります。 つまり、いくつもの外部ライブラリやアプリケーションの中の、 あるものが利用可能な場合に、 それを拡張機能として使用するように設定することができるということです。 それらのライブラリやアプリケーションを、 必ずしも すべてのユーザが必要としているわけではありませんので、ports システムではどのコンフィギュレーションがビルドされるべきかを port 作者が決めるために使えるフックを用意しています。 これらを適切にサポートすることにより、ユーザをハッピーにしたり、 port 1 つ分のコストで 2 つまたはそれ以上の port を提供するのと同様の効率化を行なうことが可能です。</p></div><div class=paragraph><p>これらのフックのうちで最も簡単に使えるものは <code>WITHOUT_X11</code> でしょう。 その port が X Window System のサポートありと、 サポートなしの設定でビルドできるのであれば、 通常は X Window System サポートありでビルドするべきでしょう。 ビルド時に <code>WITHOUT_X11</code> が定義されていれば、 その時は X Window System サポートなしのバージョンが ビルドされるべきです。</p></div><div class=paragraph><p>GNOME 環境の様々なパーツも、そのようなノブ (フック) を持っていますが、それらは幾分使いにくいものです。 <span class=filename>Makefile</span> 中で その目的に使用される変数は <code>WANT_*</code> と <code>HAVE_*</code> になります。 そのアプリケーションが、 以下に示されている依存ライブラリの一つについて、 サポートあり、なしの両方でビルドできる場合、 <span class=filename>Makefile</span> には <code>WANT_PKG</code> をセットする必要があります。 そして、ビルド時に <code>HAVE_PKG</code> が定義されていれば <code>PKG</code> を使うバージョンがビルドされることになります。</p></div><div class=paragraph><p>現在、このような形でサポートされている <code>WANT_*</code> 変数は、 <code>WANT_GLIB</code>, <code>WANT_GTK</code>, <code>WANT_ESOUND</code>, <code>WANT_IMLIB</code>, そして <code>WANT_GNOME</code> です。</p></div></div><div class=sect3><h4 id=_致命的な依存の循環>5.7.11. 致命的な依存の循環<a class=anchor href=#_致命的な依存の循環></a></h4><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Ports ツリーに循環する依存性を持ち込まないでください!</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ports の構築技術は循環依存性を許容していません。 循環依存させてしまうと、たちまちどこかの誰かがインストールしている FreeBSD を駄目にしてしまい、その数はまたたく間に増えて行きます。 この問題は見付けるのが非常に難しいです。 問題がありそうな場合は、その変更を行う前に <code>cd /usr/ports; make index</code> を実行するようにしてください。 この処理は古いマシンではかなり遅いかもしれませんが、 (あなたも含めて) 多くの人がその処理を行って嘆くことにならずに済ませられるでしょう。</p></div></div></div><div class=sect2><h3 id=makefile-wrkdir>5.8. 作業ディレクトリの指定<a class=anchor href=#makefile-wrkdir></a></h3><div class=paragraph><p>それぞれの port は作業ディレクトリに展開されるので、 作業ディレクトリは書き込み可能でなければなりません。 Ports システムは、デフォルトでは <code>DISTFILES</code> が <code>${DISTNAME}</code> というディレクトリに展開されると想定します。 つまり、次のように設定していたら、</p></div><div class="literalblock programlisting"><div class=content><pre>PORTNAME=      foo
PORTVERSION=   1.0</pre></div></div><div class=paragraph><p>その port の配布ファイルの内容は、最上位のディレクトリが <span class=filename>foo-1.0</span> で、 残りのファイルはそのディレクトリの下に置かれているということです。</p></div><div class=paragraph><p>そうでない場合に上書きできる変数がたくさんあります。</p></div><div class=sect3><h4 id=_wrksrc>5.8.1. <code>WRKSRC</code><a class=anchor href=#_wrksrc></a></h4><div class=paragraph><p>この変数は、 アプリケーションの配布ファイルが展開された時に作成されるディレクトリの名称を示します。 前の例で、(<span class=filename>foo-1.0</span> ではなく) <span class=filename>foo</span> というディレクトリに展開されるなら、</p></div><div class="literalblock programlisting"><div class=content><pre>WRKSRC=      ${WRKDIR}/foo</pre></div></div><div class=paragraph><p>または、</p></div><div class="literalblock programlisting"><div class=content><pre>WRKSRC=      ${WRKDIR}/${PORTNAME}</pre></div></div><div class=paragraph><p>と書いてください。</p></div></div><div class=sect3><h4 id=_no_wrksubdir>5.8.2. <code>NO_WRKSUBDIR</code><a class=anchor href=#_no_wrksubdir></a></h4><div class=paragraph><p>その port がサブディレクトリに展開しないのであれば、 それを示すために <code>NO_WRKSUBDIR</code> を設定してください。</p></div><div class="literalblock programlisting"><div class=content><pre>NO_WRKSUBDIR= yes</pre></div></div></div></div><div class=sect2><h3 id=conflicts>5.9. <code>CONFLICTS</code><a class=anchor href=#conflicts></a></h3><div class=paragraph><p>あなたが作成している package が他の packageと (ファイルの衝突や実行時の非互換性により) 共存できないのであれば、<code>CONFLICTS</code> 変数にその package の名称を挙げてください。 <code>*</code> や <code>?</code> のようなシェルの補完が利用できます。package 名は <span class=filename>/var/db/pkg</span> にあるのと同じ形式で並べてください。</p></div></div><div class=sect2><h3 id=makefile-build>5.10. ビルドのメカニズム<a class=anchor href=#makefile-build></a></h3><div class=paragraph><p>そのソフトウェアがビルドの際に GNU <code>make</code> を使う場合には、<code>USE_GMAKE=yes</code> をセットしてください。 <code>configure</code> を使う場合には、 <code>HAS_CONFIGURE=yes</code> をセットしてください。 GNU <code>configure</code> を使う場合には、 <code>GNU_CONFIGURE=yes</code> をセットしてください (これにより <code>HAS_CONFIGURE</code> もセットされます)。 <code>configure</code> に追加の引数を渡したい場合には、 追加部分を <code>CONFIGURE_ARGS</code> に指定してください。 (デフォルトの引数リストは、GNU <code>configure</code> では <code>--prefix=${PREFIX}</code> に、 GNU でない <code>configure</code> では空リストになります。) GNU <code>autoconf</code> を使う場合には、 <code>USE_AUTOCONF=yes</code> をセットしてください。 これにより <code>GNU_CONFIGURE</code> もセットされ、 <code>configure</code> を実行する前に <code>autoconf</code> が実行されます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>もしそのパッケージが GNU <code>configure</code> を使っていて、作成された実行形式のファイルが <span class=filename>i386-portbld-freebsd4.7-</span><em>appname</em> のような"奇妙な"名称だった場合は、さらに <code>CONFIGURE_TARGET</code> を上書きして、新しいバージョンの <code>autoconf</code> で生成されたスクリプトが要求する方法でターゲットを指定する必要があります。 <span class=filename>Makefile</span> の <code>GNU_CONFIGURE=yes</code> 行のすぐ後に次の行を追加してください。</p></div><div class=paragraph><p><code>CONFIGURE_TARGET=--build=${MACHINE_ARCH}-portbld-freebsd${OSREL}</code></p></div></td></tr></tbody></table></div><div class=paragraph><p>そのソフトウェアが X Window System のアプリケーションなどで、 <code>imake</code> を使って <span class=filename>Imakefile</span> から <span class=filename>Makefile</span> を作成する場合には、 <code>USE_IMAKE=yes</code> を指定してください。 そうするとコンフィグレーションステージで自動的に <code>xmkmf -a</code> が実行されます。 もし <code>-a</code> フラグが問題を引き起こすなら、 さらに <code>XMKMF=xmkmf</code> をセットしてください。 もし、その port が <code>imake</code> を使用するけれども <code>install.man</code> ターゲットを持たない場合には、 <code>NO_INSTALL_MANPAGES=yes</code> をセットしてください。 ついでに、そのソフトウェアの作者を探し出して八つ裂きにするといいでしょう。 <em>(-</em>-#)_</p></div><div class=paragraph><p>そのソフトウェアの元々の <span class=filename>Makefile</span> が <code>all</code> 以外のものをメインのターゲットとしている場合には、それを <code>ALL_TARGET</code> に指定してください。 <code>install</code> と <code>INSTALL_TARGET</code> も同様です。</p></div></div></div></div><div class=sect1><h2 id=special>Chapter 6. 特別な配慮<a class=anchor href=#special></a></h2><div class=sectionbody><div class=paragraph><p>port を作成する場合、 考慮しなくてはいけないことが他にもいくつかあります。 このセクションでは、それらのうちでも特によくあることについて説明します。</p></div><div class=sect2><h3 id=porting-shlibs>6.1. 共有ライブラリ<a class=anchor href=#porting-shlibs></a></h3><div class=paragraph><p>その port が共有ライブラリのインストールを行なう場合、 make 変数 <code>INSTALLS_SHLIB</code> を定義してください。 これにより、<span class=filename>bsd.port.mk</span> が <code>post-install</code> ターゲットの実行時に新しいライブラリがインストールされたディレクトリ (通常は <span class=filename>PREFIX/lib</span>) に <code>${LDCONFIG} -m</code> を実行し、 共有ライブラリキャッシュへの登録が行なわれるようになります。 また、この変数が定義されている場合、共有ライブラリを インストールしたユーザが それをすぐに使い始められるように、 また、削除の際には そのライブラリが まだ存在していると システムに誤認されないように、 適切な <code>@exec /sbin/ldconfig -m</code> と <code>@unexec /sbin/ldconfig -R</code> のペアが <span class=filename>pkg-plist</span> ファイルに 指定されているように扱われます。</p></div><div class=paragraph><p>必要であれば、 共有ライブラリがインストールされるディレクトリのリストを格納する make 変数 <code>LDCONFIG_DIRS</code> を定義することにより、 新しいライブラリがインストールされるデフォルトの位置を上書きすることも可能です。 例えば、その port が共有ライブラリを <span class=filename>PREFIX/lib/foo</span> と <span class=filename>PREFIX/lib/bar</span> に インストールする場合、<span class=filename>Makefile</span> で以下の記述を使用することができます:</p></div><div class="literalblock programlisting"><div class=content><pre>INSTALLS_SHLIB= yes
LDCONFIG_DIRS=  %%PREFIX%%/lib/foo %%PREFIX%%/lib/bar</pre></div></div><div class=paragraph><p><span class=filename>pkg-plist</span> の他の部分と同様に、 <code>LDCONFIG_DIRS</code> の内容も <a href="https://man.freebsd.org/cgi/man.cgi?query=sed&amp;sektion=1&amp;format=html">sed(1)</a> による処理が行なわれるため、ここでも <code>PLIST_SUB</code> に指定した置換が行なわれることに注意してください。 <code>PREFIX</code> には <code>%%PREFIX%%</code> を、 <code>LOCALBASE</code> には <code>%%LOCALBASE%%</code>, <code>X11BASE</code> には <code>%%X11BASE%%</code> を使用することを推奨します。</p></div></div><div class=sect2><h3 id=porting-restrictions>6.2. 配布制限がある ports<a class=anchor href=#porting-restrictions></a></h3><div class=paragraph><p>ライセンスにはさまざまなものがあり、なかには、 アプリケーションをパッケージ化するやり方、営利目的で販売できるか、 といったことに制限をかけているものがあります。</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>port 作成者として、あなたには、使用許諾条件をよく読み、 FTP/HTTP または CD-ROM で再配布してはいけないソースコードやコンパイルされたバイナリを配布してしまい、 その責任が FreeBSD プロジェクトにかかってくることのないよう注意する義務があります。 疑わしい場合には <a href=https://lists.FreeBSD.org/subscription/freebsd-ports>FreeBSD ports メーリングリスト</a> で聞いてみてください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>そのような場合、次の節で説明されている変数が設定できます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>RESTRICTED</code> は、それだけを設定すれば済むように、暗黙のうちに <code>NO_CDROM</code> と <code>NO_PACKAGE</code> を設定します。それに対して、 <code>NO_PACKAGE</code> と <code>NO_CDROM</code> は独立で、同時に設定可能です。</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_no_package>6.2.1. <code>NO_PACKAGE</code><a class=anchor href=#_no_package></a></h4><div class=paragraph><p>この変数が設定されていたら、 このアプリケーションのバイナリパッケージを作成してはいけないということです。 ただし、この port の <code>DISTFILES</code> は自由に配布できます。</p></div><div class=paragraph><p>また、<code>NO_PACKAGE</code> は、バイナリパッケージが汎用的ではなく、 いつもアプリケーションをソースコードからコンパイルすべき場合にも利用すべきです。 たとえば、アプリケーションにサイト特有の設定情報がコンパイル時にハードコードされるような場合には、 <code>NO_PACKAGE</code> を設定してください。</p></div><div class=paragraph><p><code>NO_PACKAGE</code> には、 パッケージを作成すべきではない理由を述べた文字列を設定すべきです。</p></div></div><div class=sect3><h4 id=_no_cdrom>6.2.2. <code>NO_CDROM</code><a class=anchor href=#_no_cdrom></a></h4><div class=paragraph><p>この変数は、バイナリパッケージの作成は許可されていますが、 その package や port の <code>DISTFILES</code> を販売用の CD-ROM (や DVD-ROM) に載せるのは許されていないことを表します。なんにせよ、 バイナリパッケージと port の <code>DISTFILES</code> は、FTP/HTTP で入手できます。</p></div><div class=paragraph><p><code>NO_CDROM</code> には、その port が何故 CD-ROM で再配布できないか説明する文字列を設定するべきです。 これはたとえば、その port のライセンスが"非商用" 利用に限っている場合に使うべきです。</p></div></div><div class=sect3><h4 id=_restricted>6.2.3. <code>RESTRICTED</code><a class=anchor href=#_restricted></a></h4><div class=paragraph><p>アプリケーションのライセンスが、FTP/HTTP で、そのアプリケーションの <code>DISTFILES</code> をミラーすることや、 バイナリパッケージを配布することを禁じていたら、 この変数を設定してください。</p></div><div class=paragraph><p><code>RESTRICTED</code> には、その port が何故再配布できないか説明する文字列を設定するべきです。 典型的な場合としては、その port がプロプライエタリなソフトウェアを含んでいて、 <code>DISTFILES</code> を、おそらくソフトウェアに関する登録を行ったり、 EULA を承諾した後で、 手動でダウンロードしなければならないことを表します。</p></div></div><div class=sect3><h4 id=_restricted_files>6.2.4. <code>RESTRICTED_FILES</code><a class=anchor href=#_restricted_files></a></h4><div class=paragraph><p><code>RESTRICTED</code> や <code>NO_CDROM</code> が設定されている時は、この変数はデフォルトで <code>${DISTFILES} ${PATCHFILES}</code> になります。それ以外は空です。 一部の配布ファイルだけに制限がかかっていたら、 この変数にそのファイルのリストを設定してください。</p></div><div class=paragraph><p>port committer は、設定した配布ファイル毎に <span class=filename>/usr/ports/LEGAL</span> に制限の内容を説明する項目を追加すべきことに注意してください。</p></div></div></div><div class=sect2><h3 id=using-perl>6.3. <code>perl</code> の利用<a class=anchor href=#using-perl></a></h3><table class="tableblock frame-none grid-all stretch"><caption class=title>表 2. <code>perl</code> を使用する ports 用の変数</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">変数</th><th class="tableblock halign-left valign-top">意味</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PERL5</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port のビルドと実行に <code>perl 5</code> を使用することを示します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PERL5_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port をビルドするのに <code>perl 5</code> を使用することを示します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PERL5_RUN</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port を実行するのに <code>perl 5</code> を使用することを示します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PERL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>システムまたは port からインストールされた <code>perl 5</code> の完全なパスからバージョン番号を省いたもの。 スクリプトの “#!” 行を置き換える必要があれば使ってください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PERL_CONFIGURE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Perl の MakeMaker を使ってコンフィグレーションを行います。暗黙のうちに <code>USE_PERL5</code> を設定します。</p></td></tr></tbody></table></div><div class=sect2><h3 id=using-x11>6.4. X11 の利用<a class=anchor href=#using-x11></a></h3><table class="tableblock frame-none grid-all stretch"><caption class=title>表 3. X を利用する ports 用の変数</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_X_PREFIX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は <code>PREFIX</code> ではなく <code>X11BASE</code> にインストールされます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_XLIB</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は X ライブラリを使用します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_MOTIF</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は Motif ツールキットを使用します。 <code>USE_XPM</code> が自動的に設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_IMAKE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は <code>imake</code> を使用します。<code>USE_X_PREFIX</code> が自動的に設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>XMKMF</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>xmkmf</code> が <code>PATH</code> にない場合にパスを設定してください。 デフォルトは <code>xmkmf -a</code> になります。</p></td></tr></tbody></table></div><div class=sect2><h3 id=using-automake>6.5. <code>automake</code>, <code>autoconf</code> および <code>libtool</code> の利用<a class=anchor href=#using-automake></a></h3><table class="tableblock frame-none grid-all stretch"><caption class=title>表 4. automake, autoconf または libtool を使用する ports 用の変数</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">変数</th><th class="tableblock halign-left valign-top">意味</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_AUTOMAKE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は <code>automake</code> を使用します。 <code>USE_AUTOCONF</code> と <code>USE_AUTOMAKE_VER?=14</code> が自動的に設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOMAKE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>automake</code> が <code>PATH</code> に含まれない場合のフルパス。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_AUTOMAKE_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は <code>automake</code> を使用します。この変数の有効な値は <code>14</code> と <code>15</code> で、<code>AUTOMAKE_DIR</code> および <code>ACLOCAL_DIR</code> 変数が適切な値に設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOMAKE_ARGS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_AUTOMAKE_VER</code> が設定されていた場合に <code>AUTOMAKE</code> に渡す 1 つまたはそれ以上のコマンドライン引数</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOMAKE_ENV</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOMAKE</code> を実行する前に設定する 1 つまたはそれ以上の環境変数 (とその値)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ACLOCAL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNU <code>aclocal</code> が <code>PATH</code> にない場合にパスを設定してください。デフォルトは <code>USE_AUTOMAKE_VER</code> 変数に応じて設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ACLOCAL_DIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNU <code>aclocal</code> の共有ディレクトリのパスを設定してください。 デフォルトは <code>USE_AUTOMAKE_VER</code> 変数に応じて設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOMAKE_DIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNU <code>automake</code> の共有ディレクトリのパスを設定してください。 デフォルトは <code>USE_AUTOMAKE_VER</code> 変数に応じて設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_AUTOCONF_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port が <code>autoconf</code> を使用することを指定します。デフォルト値は 213 です。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_AUTOCONF</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port が <code>autoconf</code> を使用することを指定します。<code>GNU_CONFIGURE</code> および <code>USE_AUTOCONF_VER?=213</code> を自動的に設定します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOCONF</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNU <code>autoconf</code> が <code>PATH</code> にない場合にパスを設定してください。デフォルトは <code>USE_AUTOCONF_VER</code> 変数の値に応じて設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOCONF_ARGS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>autoconf</code> に渡すコマンドライン引数</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOCONF_ENV</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>この変数で指定された <code>変数=値</code> の組を <code>autoconf</code> を実行する前に環境変数として設定してください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOHEADER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNU <code>autoheader</code> が <code>PATH</code> にない場合にパスを設定してください。デフォルトは <code>USE_AUTOCONF_VER</code> の値に応じて設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTORECONF</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNU <code>autoreconf</code> が <code>PATH</code> にない場合にパスを設定してください。デフォルトは <code>USE_AUTOCONF_VER</code> に応じて設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOSCAN</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNU <code>autoscan</code> が <code>PATH</code> にない場合にパスを設定してください。デフォルトは <code>USE_AUTOCONF_VER</code> に応じて設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AUTOIFNAMES</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNU <code>autoifnames</code> が <code>PATH</code> にない場合にパスを設定してください。デフォルトは <code>USE_AUTOCONF_VER</code> に応じて設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_LIBTOOL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は <code>libtool</code> を使用します。<code>GNU_CONFIGURE</code> を自動的に設定します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LIBTOOL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>libtool</code> が <code>PATH</code> にない場合にパスを設定してください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LIBTOOLFILES</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>libtool</code> 用のパッチファイル。 デフォルトは <code>USE_AUTOCONF</code> が設定されていれば <code>aclocal.m4</code>、 それ以外は <code>configure</code> です。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LIBTOOLFLAGS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ltconfig</code> に追加で渡すフラグ。 デフォルトは <code>--disable-ltlibs</code>。</p></td></tr></tbody></table></div><div class=sect2><h3 id=using-gnome>6.6. GNOME の利用<a class=anchor href=#using-gnome></a></h3><div class=paragraph><p>FreeBSD/GNOME プロジェクトは、ある特定の port が使っている GNOME コンポーネントを特定するために 独自の変数群を使っています。 FreeBSD/GNOME プロジェクトのページに <a href=http://www.FreeBSD.org/gnome/docs/porting/>その変数のわかりやすい一覧</a> があります。</p></div></div><div class=sect2><h3 id=using-kde>6.7. KDE の利用<a class=anchor href=#using-kde></a></h3><table class="tableblock frame-none grid-all stretch"><caption class=title>表 5. KDE を利用する ports 用の変数</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_QT_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は Qt ツールキットを使用します。 設定できる値は、 <code>1</code>, <code>2</code> および <code>3</code> で、それぞれ使用する Qt のメジャーバージョンを示します。 これは、<code>MOC</code> と <code>QTCPPFLAGS</code> をデフォルトの適切な値に設定します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_KDELIBS_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は KDE ライブラリを使用します。 設定できる値は、 <code>1</code>, <code>2</code> および <code>3</code> で、それぞれ使用する KDE のメジャーバージョンを示します。 暗黙で <code>USE_QT_VER</code> に適切なバージョンを設定します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_KDEBASE_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port は KDE base を使用します。 設定できる値は、 <code>1</code>, <code>2</code> および <code>3</code> で、それぞれ使用する KDE のメジャーバージョンを示します。 暗黙で <code>USE_KDELIBS_VER</code> に適切なバージョンを設定します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>MOC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>moc</code> へのパスを設定してください。 デフォルトでは、<code>USE_QT_VER</code> の値に応じて設定されます。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QTCPPFLAGS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Qt のコードを処理する際の <code>CPPFLAGS</code> を設定してください。デフォルトでは <code>USE_QT_VER</code> の値に応じて設定されます。</p></td></tr></tbody></table></div><div class=sect2><h3 id=using-bison>6.8. Bison の利用<a class=anchor href=#using-bison></a></h3><div class=paragraph><p>この節はまだ書かれていません。</p></div></div><div class=sect2><h3 id=using-java>6.9. Java の利用<a class=anchor href=#using-java></a></h3><div class=paragraph><p>あなたが作成している port の構築、実行、 または配布ファイルの展開に Java™ 開発キット (JDK) が必要なら、<code>USE_JAVA</code> を定義してください。</p></div><div class=paragraph><p>Ports Collection には、さまざまなベンダの JDK のいろいろなバージョンがあります。 あなたが作成している port がその中のいずれかのバージョンを使わなければならないなら、 どれを使うか指定できます。最新のバージョンは、 <a class=package href=https://cgit.freebsd.org/ports/tree/java/jdk14/>java/jdk14</a> です。</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>表 6. Java を利用する ports で定義すべき変数</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">変数</th><th class="tableblock halign-left valign-top">意味</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_JAVA</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>この後の変数を有効にするには、 この変数を定義しなければなりません。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_VERSION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>スペースで区切られた、適合する Java のバージョン一覧。<code>""` を使ってバージョンの範囲を指定することもできます (使える値は、 `1.1[] 1.2[] 1.3[] 1.4[+]</code>) です)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_OS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>スペースで区切られた、その port に適合する JDK port の OS 一覧。(使える値は、 <code>native linux</code>) です。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_VENDOR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>スペースで区切られた、その port に適合する JDK port のベンダの一覧。(使える値は、 <code>freebsd bsdjava sun ibm blackdown</code>) です。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>この変数が設定されていると、選択した JDK を、その port の構築依存性に追加します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_RUN</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>この変数が設定されていると、選択した JDK を、その port の実行依存性に追加します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_EXTRACT</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>この変数が設定されていると、選択した JDK を、その port の展開依存性に追加します。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_JIKES</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>その port の構築に <code>jikes</code> バイトコードコンパイラを使うべきかどうかを示します。 この変数に何の値も設定されていない時は、port は <code>jikes</code> が使えたら構築に利用します。 <code>jikes</code> の利用を明示的に禁止したり、 強制したりすることも可能です (<code>'no'</code> か <code>'yes'</code> を設定してください)。 後者の場合は、<a class=package href=https://cgit.freebsd.org/ports/tree/devel/jikes/>devel/jikes</a> が port の構築依存性に追加されます。</p></td></tr></tbody></table><div class=paragraph><p>以下は、<code>USE_JAVA</code> を設定した port で行われる設定の一覧です。</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>表 7. Java を利用する ports で設定される変数</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">変数</th><th class="tableblock halign-left valign-top">値</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>JDK port の名称 (例: <code>'java/jdk14'</code>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT_VERSION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>JDK の完全なバージョン (例: <code>'1.4.2'</code>)。最初の数字 2 つだけしか必要でなければ、 <code>${JAVA_PORT_VERSION:C/^([0-9])\.([0-9])(.*)$/\1.\2/}</code> を使ってください。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT_OS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>JDK port が利用する OS (例: <code>'linux'</code>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT_VENDOR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>JDK port のベンダ (例: <code>'sun'</code>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT_OS_DESCRIPTION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>JDK port が利用する OS の説明 (例: <code>'Linux'</code>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT_VENDOR_DESCRIPTION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>JDK port のベンダの説明 (例: <code>'FreeBSD Foundation'</code>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_HOME</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>JDK がインストールされているディレクトリのパス (例: <span class=filename>'/usr/local/jdk1.3.1'</span>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVAC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>使用する Java コンパイラのパス (例: <span class=filename>'/usr/local/jdk1.1.8/bin/javac'</span> または <span class=filename>'/usr/local/bin/jikes'</span>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>使用する <code>jar</code> ツールのパス (例: <span class=filename>'/usr/local/jdk1.2.2/bin/jar'</span> または <span class=filename>'/usr/local/bin/fastjar'</span>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>APPLETVIEWER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>appletviewer</code> ユーティリティへのパス (例: <span class=filename>'/usr/local/linux-jdk1.2.2/bin/appletviewer'</span>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>java</code> 実行ファイルへのパス。 Java プログラムの実行にはこれを使ってください (例: <span class=filename>'/usr/local/jdk1.3.1/bin/java'</span>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVADOC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>javadoc</code> ユーティリティプログラムへのパス。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVAH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>javah</code> プログラムへのパス。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVAP</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>javap</code> プログラムへのパス。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_KEYTOOL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>keytool</code> ユーティリティプログラムへのパス。 この変数は、JDK が Java 1.2 以上の場合のみ利用可能です。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_N2A</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>native2ascii</code> ツールへのパス。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_POLICYTOOL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>policytool</code> プログラムへのパス。この変数は、JDK が Java 1.2 以上の場合のみ利用可能です。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_SERIALVER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>serialver</code> ユーティリティプログラムへのパス。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RMIC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RMI スタブ/スケルトンジェネレータ <code>rmic</code> へのパス。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RMIREGISTRY</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RMI レジストリプログラム <code>rmiregistry</code> へのパス。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RMID</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RMI デーモンプログラム <code>rmid</code> へのパス。この変数は、JDK が Java 1.2 以上の場合のみ利用可能です。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_CLASSES</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>JDK クラスファイルが入っているアーカイブへのパス。 JDK 1.2 以降では、これは <span class=filename>${JAVA_HOME}/jre/lib/rt.jar</span> です。 それより前の JDK は、 <span class=filename>${JAVA_HOME}/lib/classes.zip</span> を使います。</p></td></tr></tbody></table><div class=paragraph><p>Port のデバッグ情報を得るのに、 <code>java-debug</code> make ターゲットが使えます。 これは、前述の変数の多くについて値を表示します。</p></div></div><div class=sect2><h3 id=using-python>6.10. Python の利用<a class=anchor href=#using-python></a></h3><div class=paragraph><p>この節はまだ書かれていません。</p></div></div><div class=sect2><h3 id=using-emacs>6.11. Emacs の利用<a class=anchor href=#using-emacs></a></h3><div class=paragraph><p>この節はまだ書かれていません。</p></div></div><div class=sect2><h3 id=using-ruby>6.12. Ruby の利用<a class=anchor href=#using-ruby></a></h3><div class=paragraph><p>この節はまだ書かれていません。</p></div></div><div class=sect2><h3 id=using-sdl>6.13. SDL の利用<a class=anchor href=#using-sdl></a></h3><div class=paragraph><p><code>USE_SDL</code> 変数は、 <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl12/>devel/sdl12</a> や <a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/sdl_gui/>x11-toolkits/sdl_gui</a> など、SDL ベースの ports への依存を自動設定するのに使われます。</p></div><div class=paragraph><p>今のところ、次の SDL ライブラリが認識されます。</p></div><div class=ulist><ul><li><p>sdl: <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl12/>devel/sdl12</a></p></li><li><p>gfx: <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sdl_gfx/>graphics/sdl_gfx</a></p></li><li><p>gui: <a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/sdl_gui/>x11-toolkits/sdl_gui</a></p></li><li><p>image: <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sdl_image/>graphics/sdl_image</a></p></li><li><p>ldbad: <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl_ldbad/>devel/sdl_ldbad</a></p></li><li><p>mixer: <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sdl_mixer/>audio/sdl_mixer</a></p></li><li><p>mm: <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdlmm/>devel/sdlmm</a></p></li><li><p>net: <a class=package href=https://cgit.freebsd.org/ports/tree/net/sdl_net/>net/sdl_net</a></p></li><li><p>sound: <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sdl_sound/>audio/sdl_sound</a></p></li><li><p>ttf: <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sdl_ttf/>graphics/sdl_ttf</a></p></li></ul></div><div class=paragraph><p>したがって、ある port が <a class=package href=https://cgit.freebsd.org/ports/tree/net/sdl_net/>net/sdl_net</a> と <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sdl_mixer/>audio/sdl_mixer</a> に依存していたら、構文は次のようになります。</p></div><div class="literalblock programlisting"><div class=content><pre>USE_SDL=	  net mixer</pre></div></div><div class=paragraph><p><a class=package href=https://cgit.freebsd.org/ports/tree/net/sdl_net/>net/sdl_net</a> と <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sdl_mixer/>audio/sdl_mixer</a> が必要とする <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl12/>devel/sdl12</a> の依存も自動的に追加されます。</p></div><div class=paragraph><p><code>USE_SDL</code> を使うと、以下のことが自動的に行われます。</p></div><div class=ulist><ul><li><p><code>BUILD_DEPENDS</code> に sdl11-config への依存を追加します。</p></li><li><p><code>CONFIGURE_ENV</code> に <code>SDL_CONFIG</code> 変数を追加します。</p></li><li><p><code>LIB_DEPENDS</code> に選択したライブラリへの依存を追加します。</p></li></ul></div><div class=paragraph><p>SDL ライブラリが利用できるかどうか調べるためには、 <code>WANT_SDL</code> 変数を使ってください。</p></div><div class="literalblock programlisting"><div class=content><pre>WANT_SDL=yes

.include &lt;bsd.port.pre.mk&gt;

.if ${HAVE_SDL:Mmixer}!=&#34;&#34;
USE_SDL+=   mixer
.endif

.include &lt;bsd.port.post.mk&gt;</pre></div></div></div></div></div><div class=sect1><h2 id=porting-masterdir>Chapter 7. <code>MASTERDIR</code><a class=anchor href=#porting-masterdir></a></h2><div class=sectionbody><div class=paragraph><p>その port の変数 (たとえば解像度とか紙のサイズなど) を 変えたりした、少しだけ違うバージョンを作成する必要があるときには、 ユーザが分りやすいように package ごとに別々のサブディレクトリを作成し、 できるだけ port 間でファイルを共有するようにしてください。 ほとんどの場合、うまく変数を使えば、一つを除くすべてのディレクトリには とても短い <span class=filename>Makefile</span> を置くだけで済みます。 その短い <span class=filename>Makefile</span> では、 <code>MASTERDIR</code> を使って、 残りのファイルがあるディレクトリを指定できます。 また、<a href=#porting-pkgname><code>PKGNAMESUFFIX</code></a> の 一部に変数に使って、package が別々の名前を持つようにしてください。</p></div><div class=paragraph><p>具体的な例を示すのが一番わかりやすいでしょう。 これは <span class=filename>japanese/xdvi300/Makefile</span> の一部です。</p></div><div class="literalblock programlisting"><div class=content><pre>PORTNAME=       xdvi
PORTVERSION=    17
PKGNAMEPREFIX=  ja-
PKGNAMESUFFIX=  ${RESOLUTION}
 :
# default
RESOLUTION?=   300
.if ${RESOLUTION} != 118 &amp;&amp; ${RESOLUTION} != 240 &amp;&amp; \
       ${RESOLUTION} != 300 &amp;&amp; ${RESOLUTION} != 400
       @${ECHO} &#34;Error: invalid value for RESOLUTION: \&#34;${RESOLUTION}\&#34;&#34;
       @${ECHO} &#34;Possible values are: 118, 240, 300 (default) and 400.&#34;
       @${FALSE}
.endif</pre></div></div><div class=paragraph><p><a class=package href=https://cgit.freebsd.org/ports/tree/japanese/xdvi300/>japanese/xdvi300</a> には <span class=filename>Makefile</span> の他に通常のパッチや、 package ファイル等が置かれています。 このディレクトリで <code>make</code> を実行すると、 デフォルトの解像度 (300) を使って、 普通に port のビルドを行ないます。</p></div><div class=paragraph><p>他の解像度に関していうと、 <span class=filename>xdvi118/Makefile</span> に 必要なのは_これだけ_です:</p></div><div class="literalblock programlisting"><div class=content><pre>RESOLUTION=     118
MASTERDIR=      ${.CURDIR}/../xdvi300

.include &#34;${MASTERDIR}/Makefile&#34;</pre></div></div><div class=paragraph><p>(<span class=filename>xdvi240/Makefile</span> や <span class=filename>xdvi400/Makefile</span> も同様のものになります)。 <span class=filename>bsd.port.mk</span> は、 <code>MASTERDIR</code> の定義から <code>FILESDIR</code> や <code>SCRIPTDIR</code> 等の 通常のサブディレクトリが <span class=filename>xdvi300</span> 以下に存在することを理解します。 <code>RESOLUTION=118</code> の行が、 <span class=filename>xdvi300/Makefile</span> の <code>RESOLUTION=300</code> の行を上書きし、 port は解像度を 118 として作成されます。</p></div></div></div><div class=sect1><h2 id=shared>Chapter 8. 共有ライブラリのバージョン<a class=anchor href=#shared></a></h2><div class=sectionbody><div class=paragraph><p>まず<a href=https://docs.freebsd.org/en/books/developers-handbook/#policies-shlib>共有ライブラリのバージョンについての指針</a>を読んで、 一般的に共有ライブラリのバージョンをどうすれば良いかを理解してください。 ソフトウェアの作者は自分がしていることを理解していると、 盲目的に信じていてはいけません。多くの場合は理解していないのです。 細部にわたって注意深く考慮することは大変重要です。なぜなら我々は、 互換性がないかもしれない大量のソフトウェアを共存させようとする特殊な状況にあるからです。 むかし、不注意な port の導入が共有ライブラリに関する重大な問題を引き起してしまったことがあります (なぜ <span class=filename>jpeg-6b</span> の共有ライブラリのバージョン番号が 9 なのか、今まで不思議に思ったことはありませんか?)。 もし疑問があれば、<a href=https://lists.FreeBSD.org/subscription/freebsd-ports>FreeBSD ports メーリングリスト</a> にメールを送ってください。 ほとんどの時間は正しい共有ライブラリのバージョンを決めることと、 それを実現するためのパッチを作成することに終始します。</p></div></div></div><div class=sect1><h2 id=porting-manpages>Chapter 9. マニュアルページ<a class=anchor href=#porting-manpages></a></h2><div class=sectionbody><div class=paragraph><p><code>MAN[1-9LN]</code> 変数に指定したマニュアルは 自動的に <span class=filename>pkg-plist</span> に追加されます (つまり、マニュアルを <span class=filename>pkg-plist</span> に加えては<em>いけません</em>- <a href=#porting-plist>pkg-plist の生成</a>を参照してください)。 また、<span class=filename>/etc/make.conf</span> 中の <code>NOMANCOMPRESS</code> の設定に従って、インストール時に マニュアルを自動的に圧縮したり復元したりします。</p></div><div class=paragraph><p>その port が、シンボリックリンクやハードリンクを用いて、 複数のファイル名を持つマニュアルをインストールする場合には、 それらを識別するために <code>MLINKS</code> 変数を使用しなければなりません。 port によってインストールされたリンクは、 意図したファイルをきちんと指しているかどうか確認するため、 <span class=filename>bsd.port.mk</span> によって削除されたり、 再作成されたりします。 MLINKS に指定されたマニュアルも、 <span class=filename>pkg-plist</span> に含めてはいけません。</p></div><div class=paragraph><p>マニュアルをインストール時に圧縮するかどうかを指定するには、 <code>MANCOMPRESSED</code> 変数を使用します。 この変数は <code>yes</code>, <code>no</code> そして <code>maybe</code> の三つの値をとることができます、 <code>yes</code> はマニュアルが既に圧縮されてインストールされていること、 <code>no</code> は圧縮されていないこと、 <code>maybe</code> は既にそのソフトウェアが <code>NOMANCOMPRESS</code> の値に従っていて、 <span class=filename>bsd.port.mk</span> は特別なにもする必要がないことを意味します。</p></div><div class=paragraph><p><code>USE_IMAKE</code> がセットされていて、 <code>NO_INSTALL_MANPAGES</code> がセットされていなければ、 <code>MANCOMPRESSED</code> は自動的に <code>yes</code> に設定されます。それ以外の場合には、<code>MANCOMPRESSED</code> は <code>no</code> に設定されます。 その port にとって、デフォルトの設定が適切でない場合以外には、 明示的に設定する必要はありません。</p></div><div class=paragraph><p><code>PREFIX</code> 以外のディレクトリの下にマニュアルを置くような port では、そのディレクトリを <code>MANPREFIX</code> で指定することができます。 さらに、いくつかの <code>perl</code> モジュールの ports のように、 特定のセクションのマニュアルだけを非標準の場所にインストールする場合、 個々のマニュアルのパスを <code>MAN_sect_PREFIX</code> (ここで <em>sect</em> は <code>1-9</code>, <code>L</code>, または <code>N</code> のいずれか) により指定することができます。</p></div><div class=paragraph><p>マニュアルが言語特有のサブディレクトリに置かれる場合には、 その言語名を <code>MANLANG</code> に設定してください。 この変数のデフォルト値は <code>""</code> になっています (つまり、英語のみ)。</p></div><div class=paragraph><p>これは、全部をまとめた例です。</p></div><div class="literalblock programlisting"><div class=content><pre>MAN1=           foo.1
MAN3=           bar.3
MAN4=           baz.4
MLINKS=         foo.1 alt-name.8
MANLANG=        &#34;&#34; ja
MAN3PREFIX=     ${PREFIX}/shared/foobar
MANCOMPRESSED=  yes</pre></div></div><div class=paragraph><p>これは、この port により以下の 6 個のファイルがインストールされることを表しています。</p></div><div class="literalblock programlisting"><div class=content><pre>${PREFIX}/man/man1/foo.1.gz
${PREFIX}/man/ja/man1/foo.1.gz
${PREFIX}/shared/foobar/man/man3/bar.3.gz
${PREFIX}/shared/foobar/man/ja/man3/bar.3.gz
${PREFIX}/man/man4/baz.4.gz
${PREFIX}/man/ja/man4/baz.4.gz</pre></div></div><div class=paragraph><p>さらに <span class=filename>${PREFIX}/man/man8/alt-name.8.gz</span> がこの port によってインストールされるかどうかわかりませんが、 それとは無関係に foo(1) と alt-name(8) のマニュアルページを指すシンボリックリンクが作成されます。</p></div></div></div><div class=sect1><h2 id=porting-motif>Chapter 10. Motif を必要とする port<a class=anchor href=#porting-motif></a></h2><div class=sectionbody><div class=paragraph><p>コンパイルに Motif ライブラリを必要とするアプリケーションがいくつかあります (Motif 自体は有料のものがいくつかの会社から手に入りますし、 <a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/lesstif/>x11-toolkits/lesstif</a> には多くのアプリケーションを動作させることが可能な無料の互換ライブラリもあります)。 Motif は広く使われているツールキットですし、 有料のもののライセンスでもライブラリを静的にリンクした実行形式の再配布が認められている場合が多いので、 Motif を必要とするソフトウェアを簡単に (port からコンパイルする人々のために) 動的にでも、 (package を配布する人々のために) 静的にでもリンクできるような仕組みが用意されています。</p></div><div class=sect2><h3 id=motif-use>10.1. <code>USE_MOTIF</code><a class=anchor href=#motif-use></a></h3><div class=paragraph><p>Motif が無いとコンパイルできない port の <span class=filename>Makefile</span> では、この変数を指定してください。 これにより、Motif を持っていない人がこの port をコンパイルしようとするのを未然に防ぎます。</p></div></div><div class=sect2><h3 id=motif-lib>10.2. <code>MOTIFLIB</code><a class=anchor href=#motif-lib></a></h3><div class=paragraph><p>この変数は <span class=filename>bsd.port.mk</span> によって適当な Motif ライブラリの指定に置き換えられます。Port のソースの <span class=filename>Makefile</span> や <span class=filename>Imakefile</span> で Motif ライブラリを参照しているところを、 この変数を参照するようにパッチを適用してください。</p></div><div class=paragraph><p>代表的な例としては以下の二つがあげられます:</p></div><div class="olist arabic"><ol class=arabic><li><p>Makefile か Imakefile の中で Motif ライブラリが <code>-lXm</code> として使われている場合には、 かわりに <code>MOTIFLIB</code> と書いてください。</p></li><li><p>Imakefile の中で <code>XmClientLibs</code> が使われている場合には、それを <code>${MOTIFLIB} ${XTOOLLIB} ${XLIB}</code> と書きかえてください。</p></li></ol></div><div class=paragraph><p>なお <code>MOTIFLIB</code> は通常、 <code>-L/usr/X11R6/lib -lXm</code> か <code>/usr/X11R6/lib/libXm.a</code> に置き換えられます。 したがって前に <code>-L</code> や <code>-l</code> をつける必要はありません。</p></div></div></div></div><div class=sect1><h2 id=x11-fonts>Chapter 11. X11 のフォント<a class=anchor href=#x11-fonts></a></h2><div class=sectionbody><div class=paragraph><p>もし、あなたの port が X Window System のフォントをインストールするのであれば、 それらを <span class=filename>X11BASE/lib/X11/fonts/local</span> に置くようにしてください。このディレクトリは XFree86 3.3.3 で新設されたものです。 このディレクトリが存在しなければ作成して、ユーザに XFree86 を 3.3.3 かそれより新しいものに更新するか、 少なくともこのディレクトリを <span class=filename>/etc/XF86Config</span> のフォントパスに加えるように促すメッセージを出力するようにしてください。</p></div></div></div><div class=sect1><h2 id=porting-info>Chapter 12. Info ファイル<a class=anchor href=#porting-info></a></h2><div class=sectionbody><div class=paragraph><p>あなたが作成している package で GNU info ファイルをインストールする必要があれば、それを <code>INFO</code> 変数に (後ろの <code>.info</code> なしで) 書いてください。package 登録の前に一時的に生成された <span class=filename>pkg-plist</span> に、 適切なインストールおよびアンインストールコードが自動的に追加されます。</p></div></div></div><div class=sect1><h2 id=pkg-files>Chapter 13. <span class=filename>pkg-*</span> ファイル<a class=anchor href=#pkg-files></a></h2><div class=sectionbody><div class=paragraph><p><span class=filename>pkg-*</span> ファイルには、 まだ取り上げていない何かと重宝なトリックがいくつかあります。</p></div><div class=sect2><h3 id=porting-message>13.1. <span class=filename>pkg-message</span><a class=anchor href=#porting-message></a></h3><div class=paragraph><p>もしインストールする人にメッセージを表示する必要がある場合には、 そのメッセージを <span class=filename>pkg-message</span> に置くことができます。 この機能は <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> の後の追加のインストール手続きを表示するときなどに重宝します。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><span class=filename>pkg-message</span> ファイルは <span class=filename>pkg-plist</span> に加える必要はありません。 また、もしユーザが package ではなく port を使用している場合には自動的には表示されませんので、 明示的に <code>post-install</code> で表示するようにするべきでしょう。</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=pkg-install>13.2. <span class=filename>pkg-install</span><a class=anchor href=#pkg-install></a></h3><div class=paragraph><p>バイナリパッケージが <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> でインストールされるときに実行する必要のあるコマンドがあれば、 <span class=filename>pkg-install</span> スクリプトを使って実行することができます。 このスクリプトは自動的に package に加えられ、 <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> によって 2 回実行されます。 1 回目は <code>${SH} pkg-install ${PKGNAME} PRE-INSTALL</code> として、2 回目には <code>${SH} pkg-install ${PKGNAME} POST-INSTALL</code> として実行されます。 どちらのモードで実行されているかは <code>$2</code> を調べることによってわかります。 環境変数 <code>PKG_PREFIX</code> には package がインストールされるディレクトリが設定されます。 詳細は <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> を見てください。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>port を <code>make install</code> でインストールするときにはこのスクリプトは自動的に実行されません。 もし実行される必要があるならば port の Makefile から明示的に呼ぶ必要があります。</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=pkg-deinstall>13.3. <span class=filename>pkg-deinstall</span><a class=anchor href=#pkg-deinstall></a></h3><div class=paragraph><p>このスクリプトは package が削除される際に実行されます。</p></div><div class=paragraph><p>このスクリプトは、<a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> から 2 回実行されます。1 回目は <code>${SH} pkg-install ${PKGNAME} DEINSTALL</code> と、2 回目は <code>${SH} pkg-install ${PKGNAME} POST-DEINSTALL</code> という形で実行されます。</p></div></div><div class=sect2><h3 id=pkg-req>13.4. <span class=filename>pkg-req</span><a class=anchor href=#pkg-req></a></h3><div class=paragraph><p>(訳注: 実行されるマシンの状態に応じて) その port をインストールするべきか、そうでないかを判断する必要があるときには、 "要件 (requirements)" スクリプト <span class=filename>pkg-req</span> を作ることができます。 インストールや削除を実行すべきかどうか判断するために、 このスクリプトがインストールや削除を実行する際に自動的に実行されます。</p></div><div class=paragraph><p>このスクリプトはインストール時には <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> により <code>pkg-req ${PKGNAME} INSTALL</code> として実行され、 削除時には <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> により <code>pkg-req ${PKGNAME} DEINSTALL</code> として 実行されます。</p></div></div><div class=sect2><h3 id=porting-plist>13.5. make の変数にあわせた <span class=filename>pkg-plist</span> の変更<a class=anchor href=#porting-plist></a></h3><div class=paragraph><p>いくつかの port、特に <code>p5-</code> ports などは、configure のオプション (あるいは、<code>p5-</code> の場合は <code>perl</code> のバージョン) によって <span class=filename>pkg-plist</span> を変える必要があります。 これを容易に実現するために <span class=filename>pkg-plist</span> 中の <code>%%OSREL%%</code>, <code>%%PERL_VER%%</code>, <code>%%PERL_VERSION%%</code> は適切に置き換えられるようになっています。 <code>%%OSREL%%</code> の値はオペレーティングシステムの数字で表されたリビジョンです (たとえば <code>4.9</code>)。 <code>%%PERL_VERSION%%</code> は <code>perl</code> のバージョン番号全体 (たとえば <code>5.00502</code>) で、<code>%%PERL_VER%%</code> は <code>perl</code> のバージョン番号からパッチレベルを引いたものです (たとえば <code>5.005</code>)。</p></div><div class=paragraph><p>他の置き換えが必要であれば、<code>PLIST_SUB</code> 変数に <code>VAR=VALUE</code> という形式のペアのリストを設定することによって、 <span class=filename>pkg-plist</span> 中の <code>%%VAR%%</code> は <em>VALUE</em> に置き換えられます。 たとえばバージョンに固有のたくさんのファイルをインストールする場合には、 <span class=filename>Makefile</span> に</p></div><div class="literalblock programlisting"><div class=content><pre>OCTAVE_VERSION= 2.0.13
PLIST_SUB=      OCTAVE_VERSION=${OCTAVE_VERSION}</pre></div></div><div class=paragraph><p>と書いて、<span class=filename>PLIST</span> 中のバージョン番号が表われるすべてのところに、 <code>%%OCTAVE_VERSION%%</code> と書きます。 このようにしておけば、port をアップグレードするときに、 何十行 (時として、何百行) も <span class=filename>pkg-plist</span> を書き替えないですみます。</p></div><div class=paragraph><p>この書き換えは (<a href=#porting-manpages>マニュアル</a>の追加も) <code>pre-install</code> と <code>do-install</code> ターゲットの間に <code>pkg-plist</code> を読み <code>TMPPLIST</code> (デフォルトは <span class=filename>WRKDIR/.PLIST.mktmp</span>) に書き込むことによって行なわれます。 もし、あなたの port が <code>PLIST</code> を実行時に生成するのであれば、 <code>pre-install</code> の間かその前に行なうようにしてください。 また、書きかえられたあとのファイルを編集する必要がある場合には、 <code>post-install</code> で <code>TMPPLIST</code> を書きかえてください。</p></div></div><div class=sect2><h3 id=pkg-names>13.6. <span class=filename>pkg-*</span> ファイルの名前変更<a class=anchor href=#pkg-names></a></h3><div class=paragraph><p><span class=filename>pkg-*</span> ファイルの名前はすべて変数を使用して定義されていますので、 必要であれば <span class=filename>Makefile</span> 中で変更可能です。 いくつかの ports で一つの <span class=filename>pkg-*</span> ファイルを共有する場合や、 上記のファイルに書き込みをしなければならないときなど特に便利です (<span class=filename>pkg-*</span> サブディレクトリに直接書き込むのが良くない理由については <a href=#porting-wrkdir><code>WRKDIR</code> 以外への書きこみ</a> を参照してください)。</p></div><div class=paragraph><p>以下に変数名と そのデフォルト値のリストを示します。 (<code>PKGDIR</code> のデフォルト値は <code>${MASTERDIR}</code> になっています。)</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">変数名</th><th class="tableblock halign-left valign-top">デフォルト値</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>DESCR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>${PKGDIR}/pkg-descr</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PLIST</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>${PKGDIR}/pkg-plist</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PKGINSTALL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>${PKGDIR}/pkg-install</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PKGDEINSTALL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>${PKGDIR}/pkg-deinstall</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PKGREQ</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>${PKGDIR}/pkg-req</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PKGMESSAGE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>${PKGDIR}/pkg-message</code></p></td></tr></tbody></table><div class=paragraph><p><code>PKG_ARGS</code> を上書きせずにこれらの変数を変更するようにしてください。 <code>PKG_ARGS</code> を変更すると、これらのファイルは port から正しく <span class=filename>/var/db/pkg</span> にインストールされなくなります。</p></div></div></div></div><div class=sect1><h2 id=testing>Chapter 14. port のテスト<a class=anchor href=#testing></a></h2><div class=sectionbody><div class=sect2><h3 id=testing-portlint>14.1. portlint<a class=anchor href=#testing-portlint></a></h3><div class=paragraph><p>送付や commit をする前に <a href=#porting-portlint><code>portlint</code></a> を使ってチェックしましょう。</p></div></div><div class=sect2><h3 id=porting-prefix>14.2. <code>PREFIX</code><a class=anchor href=#porting-prefix></a></h3><div class=paragraph><p>なるべく port は <code>PREFIX</code> に対する相対パスにインストールすることができるように心がけてください (この変数の値は <code>USE_X_PREFIX</code> か <code>USE_IMAKE</code> が指定してある時には <code>X11BASE</code> (デフォルトは <span class=filename>/usr/X11R6</span>)、 そうでない場合には<code>LOCALBASE</code> (デフォルトは <span class=filename>/usr/local</span>) にセットされます)。</p></div><div class=paragraph><p>サイトによってフリーソフトウェアがインストールされる場所が違いますので、 ソース内で <span class=filename>/usr/local</span> や <span class=filename>/usr/X11R6</span> を明示的に書かないようにしてください。 X のプログラムで <code>imake</code> を使うものについては、 これは問題にはなりません。 それ以外の場合には port の <span class=filename>scripts/Makefile</span> で <span class=filename>/usr/local</span> (imake を使わない X のプログラムは <span class=filename>/usr/X11R6</span>) と書いてあるところを、 <code>${PREFIX}</code> に書き換えてください。 この値は port のコンパイルおよび、 インストールの全段階において、自動的に下位のプロセスに渡されます。</p></div><div class=paragraph><p>そのアプリケーションが <code>PREFIX</code> を 使用しないで、何かを直接 <span class=filename>/usr/local</span> に インストールしないことを確認してください。 以下のようにすると、簡単なテストを行なうことができます:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make clean; make package PREFIX=/var/tmp/port-name</span></code></pre></div></div><div class=paragraph><p>この時、もし <code>PREFIX</code> の外に 何かがインストールされていた場合、package 生成プロセスは ファイルが見つからないと文句を言うはずです。</p></div><div class=paragraph><p>ただし、これは そのソフトウェアが内部で決め打ちの参照を していないかどうか だとか、他の port によってインストールされる ファイルを参照する際に <code>LOCALBASE</code> を 正しく使用しているかどうかをテストしているわけではありません。 その port を他の場所にインストールした状態で、 <span class=filename>/var/tmp/port-name</span> に 対するインストールを試みることにより、 そのテストをすることができるでしょう。</p></div><div class=paragraph><p><code>USE_X_PREFIX</code> は本当に必要な時 (つまり X のライブラリをリンクしたり、<code>X11BASE</code> 以下にある ファイルを参照したりする必要がある時) 以外には 設定しないでください。</p></div><div class=paragraph><p>変数 <code>PREFIX</code> の値は port の Makefile やユーザの環境で変更することもできます。 しかし、個々の port が Makefile でこの変数の値を明示的に設定することはなるべくしないでください。</p></div><div class=paragraph><p>また、他の port によりインストールされるプログラムや ファイルを指定する場合には、直接的なパス名を使用するのではなく 上で述べた変数を使用してください。 たとえば <code>less</code> のフルパスを <code>PAGER</code> というマクロに入れたい場合は、 <code>-DPAGER=\"/usr/local/bin/less\"</code> というフラグをコンパイラに渡すかわりに</p></div><div class="literalblock programlisting"><div class=content><pre>-DPAGER=\&#34;${PREFIX}/bin/less\&#34;</pre></div></div><div class=paragraph><p>(X Window System を使う port の場合には</p></div><div class="literalblock programlisting"><div class=content><pre>-DPAGER=\&#34;${LOCALBASE}/bin/less\&#34;</pre></div></div><div class=paragraph><p>) を渡してください。 こうしておけば、システム管理者が <span class=filename>/usr/local</span> を まるごと どこか他の場所に移していたとしても、その port が そのまま使える可能性が高くなります。</p></div></div><div class=sect2><h3 id=testing-freshports>14.3. FreshPorts 正当性テスト<a class=anchor href=#testing-freshports></a></h3><div class=paragraph><p><a href=http://www.FreshPorts.org/>http://www.FreshPorts.org/</a> には、FreeBSD ports へ commit されたものについて、 自動的に正当性テストを行う仕組みがあります。 このサービスに登録すると、あなたが commit したものについて、 正当性テストでエラーが起きると連絡が行きます。</p></div><div class=paragraph><p>このサービスを利用したい場合、必要なのは FreshPorts のアカウントだけです。登録したメールアドレスが <code>@FreeBSD.org</code> のものであれば、 ウェブページの右側にサービスを選択するリンクがあるはずです。 FreshPorts にアカウントを持っていても <code>@FreeBSD.org</code> のメールアドレスを利用していない場合、メールアドレスを <code>@FreeBSD.org</code> に変え、登録したあとで、 メールアドレスをまた変更してください。</p></div></div></div></div><div class=sect1><h2 id=port-upgrading>Chapter 15. アップグレード<a class=anchor href=#port-upgrading></a></h2><div class=sectionbody><div class=paragraph><p>port のバージョンが原作者からのものに比べて古いことに気がついたら、 まずはあなたの持っている port が私たちの最新のもの (最新の port は FreeBSD FTP ミラーサイトの <span class=filename>ports/ports-current</span> というディレクトリにあります) であることを確認してください。 また、Ports Collection 全体を最新の状態に保つために CVSup を利用することもできます。 詳しくは <a href=https://docs.freebsd.org/ja/books/handbook/#CVSUP-CONFIG>FreeBSD ハンドブック</a>をご覧ください。</p></div><div class=paragraph><p>次に port の <span class=filename>Makefile</span> に <code>MAINTAINER</code> (保守担当者) のアドレスが書いてある場合には、その人にメールを出してみましょう。 保守担当者の人がすでにアップグレードの準備をしているかも知れませんし、 (新しいバージョンの安定度に問題があるなど) あえてアップグレードをしない理由があるのかも知れません。 その人たちと作業を重複させたくはないでしょう。 なお、保守されていない ports は、保守担当者が <code>ports@FreeBSD.org</code> になっています。その場合は、 そのアドレスにメールを送っても役に立たないでしょう。</p></div><div class=paragraph><p>保守担当者にアップグレードをしてくれと頼まれた場合、 あるいは、保守担当者が <code>ports@FreeBSD.org</code> の場合は、あなたがアップグレードをしてくださると助かります。 その場合にはアップグレードを作成した後、 変更前と変更後のディレクトリの再帰的 <code>diff</code> の出力結果を保存してください (たとえば変更前のディレクトリが <span class=filename>superedit.bak</span> という名前でとってあり、変更後のものが <span class=filename>superedit</span> に入っているなら、 <code>diff -ruN superedit.bak superedit</code> の結果を保存してください)。 unified または context diff のどちらでも構いませんが port のコミッターは一般に unified diff の方を好むようです。 <code>-N</code> オプションの使い方を覚えておいてください。 これは、新たにファイルが追加されたり、 古いファイルが削除された場合を diff が正しく扱えるようにする方法です。わたしたちに差分を送る前に、 すべての変更が正しくなされているか出力結果を確認してください。</p></div><div class=paragraph><p>差分を送る一番良い方法は <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> (カテゴリは <code>ports</code>) に diff の出力結果を添えて、わたしたちに送ってもらうのが一番良いです。 commit する際に CVS に明確に記述しなければならないので、 あなたがその port のメンテナになるなら、概要 (synopsis) 行の先頭に <code>[maintainer update]</code> と記入し、PR の "Class" を <code>maintainer-update</code> にしてください。 付け加えたり削除したりしたファイルがあればそれについて書いておいてください。 もし diff の大きさが 20 KB 程度を超えるようであれば、 圧縮したものを uuencode してください。 そうでなければそのまま PR に入れるだけで構いません。</p></div><div class=paragraph><p>最後に、役に立つ障害報告の書き方について詳しいことは、 障害報告についての記事の <a href=https://docs.freebsd.org/ja/articles/problem-reports/#pr-writing>障害報告の書き方</a>の節を読んでください。</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>更新の動機が、セキュリティ上の問題や、 現在 commit されている port に重大な欠陥である場合は、 ports 管理チーム &lt;<a href=mailto:portmgr@FreeBSD.org>portmgr@FreeBSD.org</a>> に連絡して、あなたの port のパッケージをただちに作りなおして再配布するように要求してください。 そうしないと、無防備な <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> のユーザたちが、何週間にもわたって <code>pkg_add -r</code> で古いバージョンをインストールし続けてしまいます。</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>繰り返しになりますが、既存の ports の変更を送るときには <a href="https://man.freebsd.org/cgi/man.cgi?query=shar&amp;sektion=1&amp;format=html">shar(1)</a> ではなく <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> を使用してください!</p></div></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=porting-dads>Chapter 16. やっていいことといけないこと<a class=anchor href=#porting-dads></a></h2><div class=sectionbody><div class=sect2><h3 id=dads-intro>16.1. はじめに<a class=anchor href=#dads-intro></a></h3><div class=paragraph><p>このセクションではソフトウェアを port する上で、 良くある落し穴などについて説明します。 このリストを使ってあなた自身が作成した port のチェックはもとより、 さらに<a href=http://www.FreeBSD.org/cgi/query-pr-summary.cgi?query>障害報告データベース</a> にある他の人が提出した port のチェックもできます。 PR データベースにある、 他の人が作成した port のチェックもできます。 あなたがチェックした port についてのコメントを<a href=https://docs.freebsd.org/ja/articles/contributing/#CONTRIB-GENERAL>バグ報告と一般的な論評</a>にしたがって送ってください。 PR データベースにある port をチェックすることは、 わたしたちがそれらを commit するのを早めるとともに、 何をしているかをあなたが理解していることも証明します。</p></div></div><div class=sect2><h3 id=dads-strip>16.2. バイナリの strip<a class=anchor href=#dads-strip></a></h3><div class=paragraph><p>バイナリは特に必要がなければ、手動で strip しないでください。 すべてのバイナリは strip すべきですが、 <code>INSTALL_PROGRAM</code> マクロがバイナリのインストールと strip を同時に行います (次節をご覧ください)。</p></div><div class=paragraph><p>ファイルを strip する必要はあるものの <code>INSTALL_PROGRAM</code> マクロを使いたくない場合は、 <code>${STRIP_CMD}</code> でプログラムを strip できます。 これは、多くの場合 <code>post-install</code> ターゲット内で行われます。たとえば</p></div><div class="literalblock programlisting"><div class=content><pre>post-install:
	${STRIP_CMD} ${PREFIX}/bin/xdl</pre></div></div><div class=paragraph><p>インストールされた実行形式がすでに strip されているかどうかは <code>file</code> コマンドで確認できます。 "not stripped" と表示されなければ strip されていることを示しています。 さらに、<a href="https://man.freebsd.org/cgi/man.cgi?query=strip&amp;sektion=1&amp;format=html">strip(1)</a> はすでに strip されたプログラムは strip せず、問題なく終了します。</p></div></div><div class=sect2><h3 id=dads-install>16.3. <code>INSTALL_*</code> マクロ<a class=anchor href=#dads-install></a></h3><div class=paragraph><p>あなた自身の <code>*-install</code> ターゲットでファイルの正しいモードとオーナを保証するために、 必ず <span class=filename>bsd.port.mk</span> で提供されているマクロを使用してください。</p></div><div class=ulist><ul><li><p><code>${INSTALL_PROGRAM}</code> は実行可能なバイナリをインストール (し、その過程で strip 処理)するコマンドです。</p></li><li><p><code>${INSTALL_SCRIPT}</code> は実行可能なスクリプトをインストールするコマンドです。</p></li><li><p><code>${INSTALL_DATA}</code> は共有可能なデータをインストールするコマンドです。</p></li><li><p><code>${INSTALL_MAN}</code> はマニュアルとその他の文書をインストールするコマンドです (圧縮はしません)。</p></li></ul></div><div class=paragraph><p>これらは基本的に <code>install</code> コマンドに適切なフラグを与えたものです。 それらは distfile の <span class=filename>Makefile</span> で、頭に "BSD_" が付けられた (つまり BSD_INSTALL_PROGRM というような) 形で使うことができます。 どのようにこれらを使用するかは以下の例を見てください。</p></div></div><div class=sect2><h3 id=porting-wrkdir>16.4. <code>WRKDIR</code><a class=anchor href=#porting-wrkdir></a></h3><div class=paragraph><p><code>WRKDIR</code> の外に存在するファイルには何も書き込んではいけません。 port のビルド中に書き込み可能なことが保証されているのは <code>WRKDIR</code> の中だけです (書き込み不可のツリー上での port ビルドの例については、 <a href=https://docs.freebsd.org/ja/books/handbook/ports#PORTS-CD>CDROM からの ports のインストール</a> を参照のこと)。 <span class=filename>pkg-*</span> ファイルを変更する必要があるときには、 ファイルを上書きするのではなく <a href=#porting-pkgfiles>変数の再定義</a>により 行なうようにしてください。</p></div></div><div class=sect2><h3 id=porting-wrkdirprefix>16.5. <code>WRKDIRPREFIX</code><a class=anchor href=#porting-wrkdirprefix></a></h3><div class=paragraph><p><code>WRKDIRPREFIX</code> を尊重していることを確認してください。特に、別の port の <code>WRKDIR</code> を参照しているときには気を付けてください。 正しい場所は、 <span class=filename>WRKDIRPREFIXPORTSDIR/subdir/name/work</span> です。 <span class=filename>PORTSDIR/subdir/name/work</span> や <span class=filename>.CURDIR/../../subdir/name/work</span> ではありません。</p></div><div class=paragraph><p>また、 自分で <code>WRKDIR</code> 定義するときには先頭に <code>${WRKDIRPREFIX}${.CURDIR}</code> が付いていることを確認してください。</p></div></div><div class=sect2><h3 id=porting-versions>16.6. OS の種類やバージョンの識別<a class=anchor href=#porting-versions></a></h3><div class=paragraph><p>どのバージョンの Unix で動かすかによって、 変更や条件つきコンパイルが必要なコードに出くわすこともあるでしょう。 そのような変更を行なう場合には、 古い FreeBSD システムへのバックポートや、 CSRG の 4.4BSD, BSD/386, 386BSD, NetBSD, OpenBSD 等、 他の BSD システムへの移植が可能なように、 できるだけ汎用的な変更を行なうことを心がけてください。</p></div><div class=paragraph><p>4.3BSD/Reno (1990) と、それより新しいバージョンの BSD コードを区別するには、 <span class=filename>&lt;sys/param.h></span> で定義されている <code>BSD</code> マクロを利用するのがよいでしょう。 このファイルがすでにインクルードされていれば良いのですが、 そうでない場合には、その <span class=filename>.c</span> ファイルの 適当な場所に以下のコードを追加してください。</p></div><div class="literalblock programlisting"><div class=content><pre>#if (defined(__unix__) || defined(unix)) &amp;&amp; !defined(USG)
#include &lt;sys/param.h&gt;
#endif</pre></div></div><div class=paragraph><p>これらの二つのシンボルが定義されているシステムには必ず <span class=filename>sys/param.h</span> があるはずです。 もしそうでないシステムを発見したら、 <a href=https://lists.FreeBSD.org/subscription/freebsd-ports>FreeBSD ports メーリングリスト</a> までメールを送ってわたしたちに伝えてください。</p></div><div class=paragraph><p>あるいは、GNU Autoconf のスタイルを使用することもできます。</p></div><div class="literalblock programlisting"><div class=content><pre>#ifdef HAVE_SYS_PARAM_H
#include &lt;sys/param.h&gt;
#endif</pre></div></div><div class=paragraph><p>この方法を使用するときには、 <span class=filename>Makefile</span> 中の <code>CFLAGS</code>に <code>-DHAVE_SYS_PARAM_H</code> を加えることを忘れないようにしてください。</p></div><div class=paragraph><p>いったん <span class=filename>sys/param.h</span> がインクルードされると、</p></div><div class="literalblock programlisting"><div class=content><pre>#if (defined(BSD) &amp;&amp; (BSD &gt;= 199103))</pre></div></div><div class=paragraph><p>このようにしてそのコードが 4.3 Net2 コードベース、 またはそれより新しいもの (例: FreeBSD 1.x, 4.3/Reno, NetBSD 0.9, 386BSD, BSD/386 1.1 とそれ以前) の上でコンパイルされているかを検出できます。</p></div><div class="literalblock programlisting"><div class=content><pre>#if (defined(BSD) &amp;&amp; (BSD &gt;= 199306))</pre></div></div><div class=paragraph><p>これは、4.4コードベース、またはそれより新しいもの (例: FreeBSD 2.x, 4.4, NetBSD 1.0, BSD/386 2.0 とそれ以後) の上でコンパイルされているかどうかを検出するために使用します。</p></div><div class=paragraph><p>4.4BSD-Lite2 コードベースでは <code>BSD</code> マクロの値は <code>199506</code> になっています。 これは参考程度の意味合いしかありません。 4.4-Lite ベースの FreeBSD と 4.4-Lite2 での変更がマージされたバージョンとを区別するのに使用するべきものではありません。 この目的のためにはかわりに {freebsd} マクロを使用してください。</p></div><div class=paragraph><p>以下は控え目に使ってください。</p></div><div class=ulist><ul><li><p>{freebsd} はFreeBSDのすべての版で定義されています。 変更が FreeBSD だけに適用されるとき以外は使用しないでください。 port でよくある <code>strerror()</code> ではなく <code>sys_errlist[]</code> を使うなどは FreeBSDでの変更ではなく BSD の流儀です。</p></li><li><p>FreeBSD 2.xでは {freebsd} が <code>2</code> と定義されています。 それ以前の版では <code>1</code> になっています。 その後の版でもメジャー番号に合うように上げています。</p></li><li><p>もし FreeBSD 1.x システムと FreeBSD 2.x 以降のシステムを区別する必要があれば、 上で述べた <code>BSD</code> マクロを使用するのが大抵の場合において正しい答です。 もし FreeBSD 特有の変更であれば (<code>ld</code> を使うときの共有ライブラリ用のオプションなど)、 {freebsd}を使い <code>#if {freebsd} > 1</code> のようにFreeBSD 2.x および、 それ以降のシステムを検出するのはかまいません。 もし 2.0-RELEASE 以降の FreeBSD システムを細かく検出したければ、 以下を使用することができます。</p><div class="literalblock programlisting"><div class=content><pre>#if __FreeBSD__ &gt;= 2
#include &lt;osreldate.h&gt;
#    if __FreeBSD_version &gt;= 199504
         /* 2.0.5+ release specific code here */
#    endif
#endif</pre></div></div></li></ul></div><div class=paragraph><p>これまで、何百もの port が作られてきましたが、 {freebsd} が正しく使われたのは一つか二つの場合だけでしょう。 以前の port が間違ってふさわしくない場所で そのマクロを使っているからといって、 それをまねする理由はありません。</p></div></div><div class=sect2><h3 id=freebsd-versions>16.7. __FreeBSD_version の値<a class=anchor href=#freebsd-versions></a></h3><div class=paragraph><p>以下は、<span class=filename>sys/param.h</span> で定義されている <code>__FreeBSD_version</code> の便利な一覧です。</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>表 8. __FreeBSD_version values</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Release</th><th class="tableblock halign-left valign-top">__FreeBSD_version</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.0-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>119411</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>199501, 199503</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.0.5-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>199504</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.1 以前の 2.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>199508</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.1.0-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>199511</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.1.5 以前の 2.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>199512</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.1.5-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>199607</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.1.6 以前の 2.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>199608</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.1.6-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>199612</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.1.7-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>199612</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>220000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.1-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>220000 (変更なし)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.1-RELEASE 以降の 2.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>220000 (変更なし)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>texinfo-3.9 以降の 2.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>221001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>top 導入以降の 2.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>221002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.2-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>222000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.2-RELEASE 以降の 2.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>222001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.5-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>225000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.5-RELEASE 以降の 2.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>225001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ldconfig -R マージ以降の 2.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>225002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.6-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>226000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.7-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>227000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.7-RELEASE 以降の 2.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>227001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=semctl&amp;sektion=2&amp;format=html">semctl(2)</a> 変更以降の 2.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>227002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.8-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>228000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2.2.8-RELEASE 以降の 2.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>228001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=2&amp;format=html">mount(2)</a> 変更以前の 3.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=2&amp;format=html">mount(2)</a> 変更以降の 3.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=semctl&amp;sektion=2&amp;format=html">semctl(2)</a> 変更以降の 3.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ioctl 引数変更以降の 3.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300003</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ELF 化以降の 3.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300004</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.0-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300005</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.0-RELEASE 以降の 3.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300006</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3/4 の分岐以降の 3.0-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300007</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.1-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>310000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.1-RELEASE 以降の 3.1-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>310001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>C++ コンストラクタ/デストラクタ順序変更の後の 3.1-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>310002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.2-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>320000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>320001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>バイナリ互換性のない IPFW とソケットの変更後の 3.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>320002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.3-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>330000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.3-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>330001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>libc に <a href="https://man.freebsd.org/cgi/man.cgi?query=mkstemp&amp;sektion=3&amp;format=html">mkstemp(3)</a> が追加された後の 3.3-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>330002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.4-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>340000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.4-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>340001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.5-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>350000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.5-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>350001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3.4 が分岐した後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>dynamic linker の変更後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>C++ コンストラクタ/デストラクタ順序変更の後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=dladdr&amp;sektion=3&amp;format=html">dladdr(3)</a> 機能追加後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400003</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>__deregister_frame_info dynamic linker のバグ修正、 EGCS 1.1.2 導入後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400004</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=suser&amp;sektion=9&amp;format=html">suser(9)</a> の API 変更、newbus 化 以降の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400005</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>cdevsw 登録方法の変更後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400006</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ソケットレベルの証明書 (credential) のために so_cred が追加された後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400007</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>libc_r への poll syscall ラッパー追加後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400008</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>kernel の <code>dev_t</code> 型から <code>struct spacinfo</code> ポインタへの 変更後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400009</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=2&amp;format=html">jail(2)</a> のセキュリティホール 修正後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400010</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sigset_t</code> の データ型変更後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400011</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>システムコンパイラを gcc 2.95.2 にアップグレードした 後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400012</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>動的組み込み可能な Linux モードの ioctl ハンドラが 追加された後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400013</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>OpenSSL 導入後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400014</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GCC 2.95.2 の C++ ABI 変更で、 デフォルトを -fvtable-thunks から -fno-vtable-thunks に 変更した後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400015</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>OpenSSH 導入後の 4.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400016</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.0-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400017</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.0-RELEASE 以降の 4.0-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400018</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>チェックサム計算タイミングの変更後の 4.0-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400019</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>libxpg4 が libc にマージされた後の 4.0-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400020</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Binutils を 2.10.0 にアップグレードし、 ELF バイナリのマーク付け (branding) 方法を変更し、 tcsh をベースシステムに導入した後の 4.0-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400021</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.1-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>410000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.1-RELEASE 以降の 4.1-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>410001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=setproctitle&amp;sektion=3&amp;format=html">setproctitle(3)</a> が libutil から libc に 移動した後の 4.1-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>410002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.1.1-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>411000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.1.1-RELEASE 以降の 4.1.1-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>411001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.2-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>420000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>libgcc.a と libgcc_r.a の結合および、関連する GCC linkage 変更が行なわれた後の 4.2-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>420001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.3-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>430000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>wint_t 導入後の 4.3-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>430001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>PCI パワーステート API マージ後の 4.3-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>430002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.4-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>440000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>d_thread_t 導入後の 4.4-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>440001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>マウント構造変更 (ファイルシステム kld に影響あり) 後の 4.4-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>440002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>smbfs のユーザランド部が取り込まれた後の 4.4-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>440003</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.5-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>450000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>usb の構成要素の名称が変更された後の 4.5-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>450001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> の <code>sendmail_enable</code> 変数が <code>NONE</code> という値をとれるようになった後の 4.5-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>450004</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>package 作成のデフォルトを XFree86 4 に移行した後の 4.5-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>450005</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>accept filter が修正され、 簡単なサービス妨害攻撃には影響を受けなくなった後の 4.5-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>450006</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.6-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>460000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=sendfile&amp;sektion=2&amp;format=html">sendfile(2)</a> をドキュメントに適合するよう修正して、 送信されたいかなるヘッダも、 ファイルから送信されたデータの総量に合計しないようにした 4.6-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>460001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.6.2-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>460002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.6-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>460100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sed -i</code> を MFC した後の 4.6-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>460101</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>多くの新たな pkg_install の機能を HEAD から MFC した後の 4.6-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>460102</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.7-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>470000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.7-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>470100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><em>sF の代わりに </em>std{in,out,err}p 参照生成を開始。 これは、std{in,out,err} をコンパイル時の定数から、 ランタイムに変更します。</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>470101</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>m_aux mbuf を m_tag で置き換える mbuf の変更を MFC した後の 4.7-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>470102</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>OpenSSL 0.9.7 導入後の 4.7-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>470103</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.8-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>480000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.8-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>480100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=realpath&amp;sektion=3&amp;format=html">realpath(3)</a> がスレッドセーフになった後の 4.8-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>480101</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.8-STABLE における twe の 3ware API の変更</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>480102</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.9-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>490000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.9-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>490100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>構造体 kinfo_eproc に e_sid が追加された後の 4.9-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>490101</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rtld に libmap 機能を MFC した後の 4.9-STABLE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>490102</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4.10-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>491000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ELF ヘッダフィールドの追加と ELF バイナリのマーク付け (branding) 方法の変更後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500001</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>kld メタデータ変更後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500002</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>buf/bio 変更後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500003</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>binutils アップグレード後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500004</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>libxpg4 コードの libc へのマージと、 TASKQ インターフェイスの導入後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500005</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>AGP インターフェイス追加後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500006</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Perl を 5.6.0 にアップグレードした後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500007</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KAME コードを 2000/07 版のソースに更新した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500008</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ether_ifattach() および ether_ifdetach() 変更後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500009</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>mtree のデフォルトをオリジナルの変種に戻し、 シンボリックリンクをたどる -L オプションを追加した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500010</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>kqueue API 変更後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500011</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=setproctitle&amp;sektion=3&amp;format=html">setproctitle(3)</a> が libutil から libc へ移動した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500012</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>最初の SMPng がコミットされた後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500013</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>&lt;sys/select.h> が &lt;sys/selinfo.h> に 移動した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500014</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>libgcc.a と libgcc_r.a の結合および関連する GCC linkage 変更が行なわれた後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500015</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>libc と libc_r の混合リンクを許し、 -pthread オプションを deprecate する 変更後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500016</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>mountd 等が使用する kernel-exported API の 安定化のため、ucred 構造体から xucred 構造体へ 移行した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500017</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CPU 依存の最適化を制御するための make 変数 CPUTYPE が追加された後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500018</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>&lt;machine/ioctl_fd.h> が &lt;sys/fdcio.h> に移動した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500019</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ロケール名変更の後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500020</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Bzip2 導入後の 5.0-CURRENT。 また、S/Key が削除されていることも示す。</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500021</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SSE サポート後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500022</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KSE マイルストーン 2 以降の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500023</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>d_thread_t 導入、および UUCP を ports に移動した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500024</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>64 ビットプラットホーム上のデスクリプタおよび cred 受け渡し ABI 変更後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500025</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>package 作成のデフォルトを XFree86 4 に移行し、libc に新たに strnstr() 関数を追加した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500026</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>libc に新たに strcasestr() 関数を追加した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500027</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>smbfs のユーザランド部が取り込まれた後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500028</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>C99 の新しい特定サイズの整数型追加後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500028 (変更なし)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=sendfile&amp;sektion=2&amp;format=html">sendfile(2)</a> の戻り値が変更された後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500029</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ファイルフラグにふさわしいサイズの <code>fflags_t</code> が導入された後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500030</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>usb の構成要素の名称が変更された後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500031</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Perl 5.6.1 導入後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500032</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> の <code>sendmail_enable</code> 変数が <code>NONE</code> という値をとれるようになった後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500033</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>mtx_init() に 3 番目の引数が加わった後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500034</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GCC 3.1 が取り込まれた 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500035</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>/usr/src に Perl がなくなった 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500036</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=dlfunc&amp;sektion=3&amp;format=html">dlfunc(3)</a> 追加後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500037</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>構造体 sockbuf のメンバの型が一部変更され、順序が変更された後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500038</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ヘッダで <em>BSD_FOO_T</em> の使用をやめ、 _FOO_T_DECLARED を使うようになった後の 5.0-CURRENT。 また、この変数は <a href="https://man.freebsd.org/cgi/man.cgi?query=bzip2&amp;sektion=1&amp;format=html">bzip2(1)</a> パッケージに対応したことが確実な目安としても使えます。</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500039</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ディスクラベルの内部構造の依存性を除く名目で行われた、 ディスク関連の機能へのさまざまな変更を加えた後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500040</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>libc に <a href="https://man.freebsd.org/cgi/man.cgi?query=getopt_long&amp;sektion=3&amp;format=html">getopt_long(3)</a> を加えた後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500041</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Binutils 2.13 にアップグレードした後の 5.0-CURRENT。このアップグレードには、新たな FreeBSD の emulation, vec および出力形式が含まれている。</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500042</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>libc に pthread_XXX への弱いスタブを追加し、 libXThrStub.so が obsolete になった後の 5.0-CURRENT。 5.0-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500043</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RELENG_5_0 が分岐した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>&lt;sys/dkstat.h> は空なので include すべきではない</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500101</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>d_mmap_t インターフェイス変更後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500102</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>taskqueue_swi が Giant ロック無しで実行され、 Giant ロックされて実行される taskqueue_swi_giant が追加された後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500103</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>cdevsw_add() と cdevsw_remove() はもう存在しません。 MAJOR_AUTO 割り当て機能が登場しました</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500104</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>cdevsw の新たな初期化方法が導入された後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500105</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>devstat_add_entry() が devstat_new_entry() に置き換えられました</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500106</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Devstat のインターフェイス変更。 sys/sys/param.h 1.149 を参照のこと</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500107</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>トークンリングインターフェイスの変更</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500108</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>vm_paddr_t の追加</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500109</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=realpath&amp;sektion=3&amp;format=html">realpath(3)</a> がスレッドセーフになった後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500110</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=usbhid&amp;sektion=3&amp;format=html">usbhid(3)</a> が NetBSD と同期した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500111</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>新たな NSS 実装と POSIX.1 準拠の getpw*_r, getgr*_r 関数が導入後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500112</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>古い rc システムを削除した後の 5.0-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>500113</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>5.1-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RELENG_5_1 が分岐した後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>sigtimedwait(2) と sigwaitinfo(2) の動作を修正した後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501101</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=bus_dma_tag_create&amp;sektion=9&amp;format=html">bus_dma_tag_create(9)</a> に lockfunc と lockfuncarg フィールドを追加した後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501102</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GCC 3.3.1-pre 20030711 snapshot 導入後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501103</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>5.1-CURRENT における twe の 3ware API の変更</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501104</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>/bin と /sbin がダイナミックリンクされ、 ライブラリを /lib に移動した 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501105</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Coda 6.x のカーネルサポートを追加した後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501106</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>16550 UART 定数を <span class=filename>&lt;dev/sio/sioreg.h></span> から <span class=filename>&lt;dev/ic/ns16550.h></span> に移動した後の 5.1-CURRENT。 また、rtld が 無条件で libmap 機能をサポートした時点。</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501107</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>PFIL_HOOKS API を更新した後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501108</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>kiconv(3) を追加した後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501109</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>cdevsw の open および close のデフォルトの操作を変更した後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501110</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>cdevsw のレイアウトを変更した後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501111</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>kobj の多重継承を追加した後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501112</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>構造体 ifnet の if_xname が変更された後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501113</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>/bin と /sbin をダイナミックリンクに変更した後の 5.1-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>501114</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>5.2-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>5.2.1-RELEASE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502010</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RELENG_5_2 が分岐した後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><em>cxa_atexit/</em>cxa_finalize 関数が libc に追加された後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502101</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>デフォルトの pthread ライブラリを libc_r から libpthread に変更した後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502102</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>デバイスドライバ API の大規模パッチをあてた後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502103</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>getopt_long_only() が追加された後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502104</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>C に対して NULL が ((void *)0) になり、warning をより多く出すようになった 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502105</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>pf がビルドおよびインストールされるようになった後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502106</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>sparc64 で time_t を 64 ビットの値に変更した後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502107</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>一部のヘッダで Intel C/C++ に対応し、 execve(2) をより厳密に POSIX に適合させた後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502108</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>bus_alloc_resource_any API 導入後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502109</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>UTF-8 ロケール追加後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502110</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>getvfsent(3) API を削除した後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502111</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>make に .warning 命令を追加した後の 5.2-CURRENT</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>502112</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>(2.2-STABLE は 2.2.5-RELESE 以後、 "2.2.5-STABLE" と呼ばれることがあります。) 見てのとおりこれは年・月というフォーマットになっていましたが、 バージョン 2.2 からより直接的にメジャー/マイナー番号を使うように変更になりました。 並行していくつかのブランチ (枝分かれしたバージョン) を開発する場合には、 リリースされた日付でそれらのリリースを分類することが不可能だからです (あなたが今 port を作成するときに、古い -CURRENT 達について心配する必要はありません。 これは参考のために挙げられているに過ぎないからです)。</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=dads-after-port-mk>16.8. <span class=filename>bsd.port.mk</span> の後に書くこと<a class=anchor href=#dads-after-port-mk></a></h3><div class=paragraph><p><code>.include &lt;bsd.port.mk></code> の行の後には何も書かないようにしてください。 大抵の場合は <span class=filename>Makefile</span> の中程のどこかで <span class=filename>bsd.port.pre.mk</span> をインクルードして、 最後に <span class=filename>bsd.port.pre.mk</span> をインクルードすることによって避けることができます。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><span class=filename>bsd.port.pre.mk</span>/<span class=filename>bsd.port.post.mk</span> のペアか <span class=filename>bsd.port.mk</span> だけのどちらかだけをインクルードし、二つを混ぜないでください。</p></div></td></tr></tbody></table></div><div class=paragraph><p>前者はいくつかの変数の定義だけをして <span class=filename>Makefile</span> でのテストに使用し、後者は残りを定義します。</p></div><div class=paragraph><p>以下は <span class=filename>bsd.port.pre.mk</span> で定義される重要な変数です (これは、すべてではありません。 完全なリストは <span class=filename>bsd.port.mk</span> を参照してください)。</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">変数名</th><th class="tableblock halign-left valign-top">解説</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ARCH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>uname -m</code> で返されるアーキテクチャ。(例、<code>i386</code>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>OPSYS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>uname -s</code> で返されるオペレーティングシステム (例、<code>FreeBSD</code>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>OSREL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>オペレーティングシステムのリリースバージョン (例、<code>2.1.5</code>, <code>2.2.7</code>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>OSVERSION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>数字形式のオペレーティングシステムのバージョン、 上記の <a href=#freebsd-versions><code>__FreeBSD_version</code></a> と同じです。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PORTOBJFORMAT</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>システムのオブジェクトフォーマット (<code>elf</code> あるいは <code>aout</code> ただし、"最近の" FreeBSD のバージョンでは <code>aout</code> は廃止予定になっています)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LOCALBASE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>"local" ツリーのベース。 (例、<code>/usr/local/</code>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>X11BASE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>"X11" ツリーのベース。 (例、<code>/usr/X11R6/</code>)。</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PREFIX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ports のインストール先 (<a href=#porting-prefix><code>PREFIX</code>について</a>を参照)。</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>USE_IMAKE</code>, <code>USE_X_PREFIX</code> あるいは <code>MASTERDIR</code> などの変数を定義する必要がある場合には、 <span class=filename>bsd.port.pre.mk</span> をインクルード前に定義してください。 他のものは <span class=filename>bsd.port.pre.mk</span> の前でも後でもかまいません。</p></div></td></tr></tbody></table></div><div class=paragraph><p>以下は <span class=filename>bsd.port.pre.mk</span> の後に書けるものの例です。</p></div><div class="literalblock programlisting"><div class=content><pre># no need to compile lang/perl5 if perl5 is already in system
.if ${OSVERSION} &gt; 300003
BROKEN= perl is in system
.endif

# only one shlib version number for ELF
.if ${PORTOBJFORMAT} == &#34;elf&#34;
TCL_LIB_FILE=  ${TCL_LIB}.${SHLIB_MAJOR}
.else
TCL_LIB_FILE=  ${TCL_LIB}.${SHLIB_MAJOR}.${SHLIB_MINOR}
.endif

# software already makes link for ELF, but not for a.out
post-install:
.if ${PORTOBJFORMAT} == &#34;aout&#34;
       ${LN} -sf liblinpack.so.1.0 ${PREFIX}/lib/liblinpack.so
.endif</pre></div></div><div class=paragraph><p><code>BROKEN=</code> と <code>TCL_LIB_FILE=</code> の後にスペースではなくタブを使うことを覚えていましたか? :-)</p></div></div><div class=sect2><h3 id=dads-documentation>16.9. 付加的な文書のインストール<a class=anchor href=#dads-documentation></a></h3><div class=paragraph><p>普通のマニュアルや info ファイルの他にユーザにとって有用だと思えるような文書がある場合には、 <span class=filename>PREFIX/shared/doc</span> の下にインストールしてください。 これは前記と同様 <code>post-install</code> ターゲットの中から行なうと良いでしょう。</p></div><div class=paragraph><p>まず、あなたの port のために新しいディレクトリを作ります。 どの port の文書か簡単にわかるような名前にする必要がありますので、 普通は <code>PORTNAME</code> を使うと良いでしょう。 もちろん、ユーザが異なるバージョンのものを同時に使うことが予想される port の場合には <code>PKGNAME</code> をそのまま使っても構いません。</p></div><div class=paragraph><p>ユーザが <span class=filename>/etc/make.conf</span> でこの部分を禁止するために <code>NOPORTDOCS</code> という変数をセットしている場合には、 これらの文書がインストールされないようにしてください。 こんな具合です。</p></div><div class="literalblock programlisting"><div class=content><pre>post-install:
.if !defined(NOPORTDOCS)
        ${MKDIR} ${DOCSDIR}
        ${INSTALL_MAN} ${WRKSRC}/docs/xvdocs.ps ${DOCSDIR}
.endif</pre></div></div><div class=paragraph><p>ここでは、変数をいくつかと、それを <span class=filename>Makefile</span> で利用した時にどう展開されるかを説明します。</p></div><div class=ulist><ul><li><p><code>${DATADIR}</code> は <span class=filename>${PREFIX}/shared/${PORTNAME}</span> に展開されます。</p></li><li><p><code>${DOCSDIR}</code> は <span class=filename>${PREFIX}/shared/doc/${PORTNAME}</span> に展開されます。</p></li><li><p><code>${EXAMPLESDIR}</code> は <span class=filename>${PREFIX}/shared/examples/${PORTNAME}</span> に展開されます。</p></li></ul></div><div class=paragraph><p>文書ファイルおよびディレクトリはすべて <span class=filename>pkg-plist</span> の中に <code>%%PORTDOCS%%</code> を頭につけて書く必要があります。 たとえば、次のようにしてください。</p></div><div class="literalblock programlisting"><div class=content><pre>%%PORTDOCS%%%%DOCSDIR%%/AUTHORS
%%PORTDOCS%%%%DOCSDIR%%/CONTACT
%%PORTDOCS%%@dirrm %%DOCSDIR%%</pre></div></div><div class=paragraph><p>インストール時に <span class=filename>pkg-message</span> ファイルを利用してメッセージを表示することができます。詳細は <a href=#porting-message>pkg-message を使う</a> のセクションを参照してください。</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><span class=filename>pkg-message</span> ファイルを <span class=filename>pkg-plist</span> に加える必要はありません。</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=dads-subdirs>16.10. ディレクトリ構成<a class=anchor href=#dads-subdirs></a></h3><div class=paragraph><p>インストール時には <code>PREFIX</code> の正しいサブディレクトリにファイルを置くように心がけてください。 ソフトウェアによっては新しいディレクトリを一つ作って、 ファイルを全部それに入れてしまうものがありますが、 それは良くありません。 また、バイナリ、ヘッダファイルとマニュアル以外のすべてを <span class=filename>lib</span> というディレクトリに入れてしまう port もありますが、これも BSD 的なファイルシステム構成とはうまく合いません。 これは以下のように分散すべきです。 <span class=filename>etc</span> にセットアップ/コンフィグレーションファイル、 <span class=filename>libexec</span> に内部で使用されるプログラム (コマンドラインから呼ばれることのないコマンド)、 <span class=filename>sbin</span> に管理者用のコマンド、 <span class=filename>info</span> に GNU Info 用の文書、 そして <span class=filename>share</span> にアーキテクチャに依存しないファイルが入ります。 詳細については <a href="https://man.freebsd.org/cgi/man.cgi?query=hier&amp;sektion=7&amp;format=html">hier(7)</a> を参照してください。 <span class=filename>/usr</span> の構成方針はほとんどそのまま <span class=filename>/usr/local</span> にもあてはまります。 USENET "ニュース"を扱う ports は例外です。 これらはファイルのインストール先として <span class=filename>PREFIX/news</span> を使用します。</p></div></div><div class=sect2><h3 id=porting-cleaning>16.11. 空のディレクトリの削除<a class=anchor href=#porting-cleaning></a></h3><div class=paragraph><p>ports は削除の際に、 自分自身を消去したあとに (ディレクトリの) 削除をするようにしてください。 これは大抵の場合 <code>@dirrm</code> の行を ports が作成するすべてのディレクトリについて加えることによって実現できます。 親ディレクトリは子ディレクトリを先に消さないと消せないことに注意してください。</p></div><div class="literalblock programlisting"><div class=content><pre> :
lib/X11/oneko/pixmaps/cat.xpm
lib/X11/oneko/sounds/cat.au
 :
@dirrm lib/X11/oneko/pixmaps
@dirrm lib/X11/oneko/sounds
@dirrm lib/X11/oneko</pre></div></div><div class=paragraph><p>といった感じです。</p></div><div class=paragraph><p>しかし時として、 他の port とディレクトリを共有しているために <code>@dirrm</code> がエラーを返すことがあります。 <code>rmdir</code> を <code>@unexec</code> から呼びだすことによって、 警告(warning)なしで空のディレクトリのみを削除することができます。</p></div><div class="literalblock programlisting"><div class=content><pre>@unexec rmdir %D/shared/doc/gimp 2&gt;/dev/null || true</pre></div></div><div class=paragraph><p>これを使えば、たとえ他の port がファイルをインストールしていて <span class=filename>PREFIX/shared/doc/gimp</span> が空でない場合でもエラーメッセージは表示されませんし、 <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> が異常終了することもありません。</p></div></div><div class=sect2><h3 id=dads-uid>16.12. UID<a class=anchor href=#dads-uid></a></h3><div class=paragraph><p>あなたの port が、 インストールされるシステム上に特定のユーザを必要とする場合は <span class=filename>pkg-install</span> スクリプトから <code>pw</code> コマンドを実行して自動的にそのユーザを追加するようにしてください。 <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup-mirror/>net/cvsup-mirror</a> の port が参考になるでしょう。</p></div><div class=paragraph><p>あなたの port がバイナリの package としてインストールされる場合とコンパイルされる場合の両方で、 同じユーザー/グループ ID を使わなければならないのなら、50 から 999 の間で空いている UID を選んで登録してください。 <a class=package href=https://cgit.freebsd.org/ports/tree/japanese/Wnn6/>japanese/Wnn6</a> の port が参考になるでしょう。</p></div><div class=paragraph><p>既にシステムや他の port で利用されている UID を使わないように十分注意してください。</p></div><div class=paragraph><p>現在の 50 から 999 までの間の UID は以下のとおりです。</p></div><div class="literalblock programlisting"><div class=content><pre>bind:*:53:53:Bind Sandbox:/:/sbin/nologin
majordom:*:54:54:Majordomo Pseudo User:/usr/local/majordomo:/nonexistent
cyrus:*:60:60:the cyrus mail server:/nonexistent:/nonexistent
gnats:*:61:1:GNATS database owner:/usr/local/shared/gnats/gnats-db:/bin/sh
proxy:*:62:62:Packet Filter pseudo-user:/nonexistent:/nonexistent
uucp:*:66:66:UUCP pseudo-user:/var/spool/uucppublic:/usr/libexec/uucp/uucico
xten:*:67:67:X-10 daemon:/usr/local/xten:/nonexistent
pop:*:68:6:Post Office Owner (popper):/nonexistent:/sbin/nologin
wnn:*:69:7:Wnn:/nonexistent:/nonexistent
pgsql:*:70:70:PostgreSQL pseudo-user:/usr/local/pgsql:/bin/sh
oracle:*:71:71::0:0:Oracle:/usr/local/oracle7:/sbin/nologin
ircd:*:72:72:IRC daemon:/nonexistent:/nonexistent
ircservices:*:73:73:IRC services:/nonexistent:/nonexistent
ifmail:*:75:66:Ifmail user:/nonexistent:/nonexistent
www:*:80:80:World Wide Web Owner:/nonexistent:/sbin/nologin
alias:*:81:81:QMail user:/var/qmail/alias:/nonexistent
qmaild:*:82:81:QMail user:/var/qmail:/nonexistent
qmaill:*:83:81:QMail user:/var/qmail:/nonexistent
qmailp:*:84:81:QMail user:/var/qmail:/nonexistent
qmailq:*:85:82:QMail user:/var/qmail:/nonexistent
qmailr:*:86:82:QMail user:/var/qmail:/nonexistent
qmails:*:87:82:QMail user:/var/qmail:/nonexistent
mysql:*:88:88:MySQL Daemon:/var/db/mysql:/sbin/nologin
vpopmail:*:89:89:VPop Mail User:/usr/local/vpopmail:/nonexistent
firebird:*:90:90:Firebird Database Administrator:/usr/local/firebird:/bin/sh
mailman:*:91:91:Mailman User:/usr/local/mailman:/sbin/nologin
gdm:*:92:92:GDM Sandbox:/:/sbin/nologin
jabber:*:93:93:Jabber Daemon:/nonexistent:/nonexistent
p4admin:*:94:94:Perforce admin:/usr/local/perforce:/sbin/nologin
interch:*:95:95:Interchange user:/usr/local/interchange:/sbin/nologin
squeuer:*:96:96:SQueuer Owner:/nonexistent:/bin/sh
mud:*:97:97:MUD Owner:/usr/local/shared/dgd:/bin/sh
msql:*:98:98:mSQL-2 pseudo-user:/var/db/msqldb:/bin/sh
rscsi:*:99:99:Remote SCSI:/usr/local/rscsi:/usr/local/sbin/rscsi
squid:*:100:100:squid caching-proxy pseudo user:/usr/local/squid:/sbin/nologin
quagga:*:101:101:Quagga route daemon pseudo user:/usr/local/etc/quagga:/sbin/nologin
ganglia:*:102:102:Ganglia User:/nonexistent:/sbin/nologin
sgeadmin:*:103:103:Sun Grid Engine Admin:/nonexistent:/sbin/nologin
slimserv:*:104:104:Slim Devices SlimServer pseudo-user:/nonexistent:/sbin/nologin
fido:*:111:111:Fido System:/usr/local/fido:/bin/sh
postfix:*:125:125:Postfix Mail System:/var/spool/postfix:/sbin/nologin
rbldns:*:153:153:rbldnsd pseudo-user:/nonexistent:/sbin/nologin
sfs:*:171:171:Self-Certifying File System:/nonexistent:/sbin/nologin
agk:*:172:172:AquaGateKeeper:/nonexistent:/nonexistent
ldap:*:389:389:OpenLDAP Server:/nonexistent:/sbin/nologin
drweb:*:426:426:Dr.Web Mail Scanner:/nonexistent:/sbin/nologin
qtss:*:554:554:Darwin Streaming Server:/nonexistent:/sbin/nologin
ircdru:*:555:555:Russian hybrid IRC server:/nonexistent:/bin/sh
bacula:*:910:910:Bacula Daemon:/var/db/bacula:/sbin/nologin</pre></div></div><div class=paragraph><p>以下は、現在予約されている GID の一覧です。</p></div><div class="literalblock programlisting"><div class=content><pre>bind:*:53:
cyrus:*:60:
proxy:*:62:
authpf:*:63:
uucp:*:66:
dialer:*:68:
network:*:69:
pgsql:*:70:
www:*:80:
qnofiles:*:81:
qmail:*:82:
mailman:*:91:
postfix:*:125:
maildrop:*:126:
rbldns:*:153:
qtss:*:554:
ircdru:*:555:</pre></div></div><div class=paragraph><p>このリストを最新の状態に保つためにも、 この範囲の UID や GID を予約するような port を作ったり、 既存の port にそのような改変を行なってわたしたちに送るときには UID の予約に関する注意書きをつけてください。</p></div></div><div class=sect2><h3 id=dads-rational>16.13. 合理的な port<a class=anchor href=#dads-rational></a></h3><div class=paragraph><p><span class=filename>Makefile</span> は単純かつ適切であるべきです。もし、 <span class=filename>Makefile</span> を数行短かくできたり、 もっと読みやすくできるのであればそうしてください。 たとえば、 シェルの <code>if</code> 構文を使うかわりに make の <code>.if</code> 構文を使う、 <code>EXTRACT*</code> の再定義で代用できるのであれば <code>do-extract</code> を再定義しない、 <code>CONFIGURE_ARGS += --prefix=${PREFIX}</code> とするかわりに <code>GNU_CONFIGURE</code> とする、などです。</p></div><div class=paragraph><p>何かをするのに自分で新しくコードをたくさん書かなければならなくなった場合は、 戻って <span class=filename>bsd.port.mk</span> であなたがやろうとしていることが既に実装されていないか見直してください。 読むのは大変ですが、難しく見える問題で <span class=filename>bsd.port.mk</span> が簡単な解決法を提供しているものが数多くあります。</p></div></div><div class=sect2><h3 id=dads-cc>16.14. <code>CC</code> および <code>CXX</code> の尊重<a class=anchor href=#dads-cc></a></h3><div class=paragraph><p>Port は <code>CC</code> および <code>CXX</code> 変数を尊重すべきです。ここで言いたいのは、port は、既存の値を上書きしてこれらの変数をまるごと設定しなおすべきではなく、 その代わり必要な値を既存の値に追加してゆくべきだということです。 そうすれば、すべての ports に影響するビルドオプションをグローバルに設定できます。</p></div><div class=paragraph><p>Port がこれらの変数を尊重しない場合は、 <span class=filename>Makefile</span> に <code>NO_PACKAGE=ignores either cc or cxx</code> を追加してください。</p></div><div class=paragraph><p><code>CC</code> と <code>CXX</code> 変数を尊重している <span class=filename>Makefile</span> の例を次に示します。<code>?=</code> に注意してください。</p></div><div class="literalblock programlisting"><div class=content><pre>CC ?= gcc</pre></div></div><div class="literalblock programlisting"><div class=content><pre>CXX ?= g++</pre></div></div><div class=paragraph><p>こちらは、<code>CC</code> 変数も <code>CXX</code> 変数も尊重していない例です。</p></div><div class="literalblock programlisting"><div class=content><pre>CC = gcc</pre></div></div><div class="literalblock programlisting"><div class=content><pre>CXX = g++</pre></div></div><div class=paragraph><p>FreeBSD システム上では、<code>CC</code> および <code>CFLAGS</code> 変数は、どちらも <span class=filename>/etc/make.conf</span> で定義できます。最初の例では、システム全体の定義を保存している <span class=filename>/etc/make.conf</span> で値がすでに設定されてない場合に限って、値を設定します。 2 番目の例では、すでに設定されていた内容を上書きしてしまいます。</p></div></div><div class=sect2><h3 id=dads-cflags>16.15. <code>CFLAGS</code> の尊重<a class=anchor href=#dads-cflags></a></h3><div class=paragraph><p><code>CFLAGS</code> 変数は尊重すべきです。 ここでいいたいのは、port は、 既存の値を上書きしてこの変数をまるごと設定しなおすべきではなく、 その代わり必要な値を既存の値に追加してゆくべきだということです。 そうすれば、すべてての ports に影響するビルドオプションをグローバルに設定できます。</p></div><div class=paragraph><p>port がこれを尊重しない場合は、 <code>NO_PACKAGE=ignores cflags</code> を <span class=filename>Makefile</span> に加えてください。</p></div><div class=paragraph><p><code>CFLAGS</code> 変数をきちんと考慮した <span class=filename>Makefile</span> の例を以下に示します。 <code>+=</code> の部分に注目してください。</p></div><div class="literalblock programlisting"><div class=content><pre>CFLAGS += -Wall -Werror</pre></div></div><div class=paragraph><p>次は <code>CFLAGS</code> 変数を考慮しない <span class=filename>Makefile</span> の例です。</p></div><div class="literalblock programlisting"><div class=content><pre>CFLAGS = -Wall -Werror</pre></div></div><div class=paragraph><p><code>CFLAGS</code> 変数は、FreeBSD システムの <span class=filename>/etc/make.conf</span> で定義されています。 最初の例では既存の定義を保存しつつ <code>CFLAGS</code> 変数にオプションフラグを追加しているのに対し、 二番目の例では既存の定義をすべて無効にしてしまっています。</p></div></div><div class=sect2><h3 id=dads-config>16.16. コンフィグレーション (設定) ファイル<a class=anchor href=#dads-config></a></h3><div class=paragraph><p>もしあなたの port が設定ファイルを <span class=filename>PREFIX/etc</span> に置く必要がある場合には、それを単純にインストールしたり、 <span class=filename>pkg-plist</span> に加えては<em>いけません</em>。 こうしてしまうと <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> によってユーザが苦労して作ったファイルが消えてしまったり、 新しくインストールする時に上書きされてしまったりします。</p></div><div class=paragraph><p>かわりに見本となるファイルをサフィックス (<span class=filename>filename.sample</span> が良いでしょう) を付けてインストールして<a href=#porting-message>メッセージ</a>を表示し、 ソフトウェアを動かす前にユーザがそのファイルをコピーして編集をしなければならないことを知らせましょう。</p></div></div><div class=sect2><h3 id=dads-freedback>16.17. フィードバック<a class=anchor href=#dads-freedback></a></h3><div class=paragraph><p>port を作るためにソフトウェアに変更を加えたら、 なるべく原作者にその旨を伝えてパッチ等を送ってください。 これらが次のリリースに取り入れられればアップグレードが楽になります。</p></div></div><div class=sect2><h3 id=dads-readme>16.18. <span class=filename>README.html</span><a class=anchor href=#dads-readme></a></h3><div class=paragraph><p><span class=filename>README.html</span> というファイルを含めてはいけません。 このファイルは、cvs コレクションの一部ではなく、 <code>make readme</code> コマンドで生成されるファイルです。</p></div></div><div class=sect2><h3 id=dads-broken>16.19. Port に <code>BROKEN</code>, <code>FORBIDDEN</code> などの印をつける<a class=anchor href=#dads-broken></a></h3><div class=paragraph><p>ある port にセキュリティ脆弱性があることが判明したり、 根本的に壊れてしまい修正に何時間もの注意深い作業が必要になったり、 基本的には廃れてしまったものの、 何らかの理由で ports ツリーには残される (もちろんあとで修正しますよね?) という日が来るのは避けられません。 ある port が壊れていることを示すために、port の <span class=filename>Makefile</span> では 3 つの <code>make</code> 変数が使えます。以下の <code>make</code> 変数の値は、 その port が壊れている理由を説明するためにユーザに示されます。 それぞれの make 変数は、ユーザと <span class=filename>Makefile</span> を処理する自動化システムに対して根本的に異なる意味を伝えますので、 正しい <code>make</code> 変数をお使いください。</p></div><div class=ulist><ul><li><p><code>BROKEN</code> は、動作しないためインストールすべきでない port 用のものです。これは、ユーザがその port をインストールしないようにしますが、 <code>BROKEN</code> とされた port は <a href=http://bento.FreeBSD.org/>Bento クラスタ</a>で引き続きビルドされます。 ユーザには port をインストールしてほしくないけれども Bento ではビルドしてほしい場合は、port を <code>BROKEN</code> にしてください。</p></li><li><p><code>FORBIDDEN</code> は、セキュリティ脆弱性があったり、その port をインストールすると FreeBSD システムの安全性に重大な懸念を生じる (たとえば、セキュアでないという評判があるプログラムや、 容易に悪用できるサービスを提供するプログラムなど) port 用のものです。 あるソフトウェアの一部に脆弱性があることが判明し、 修正がリリースされていない場合は <code>FORBIDDEN</code> にすべきです。 理想的には、セキュリティ脆弱性が発見された時は、 脆弱性を抱えた FreeBSD ホストの数を減らすために、 ただちに ports を更新すべきです (我々は、セキュアであるという評判を得たいのです)。 しかし、脆弱性が公表されてから、 脆弱性を抱えたソフトウェアの新しい版がリリースされるまでに無視できない時間があくことがままあります。 セキュリティ以外の理由で port を <code>FORBIDDEN</code> にしないでください。</p></li><li><p><code>IGNORE</code> は、どんな理由であれビルドすべきではない port 用です。 ユーザも <a href=http://bento.FreeBSD.org/>Bento クラスタ</a> も、どんな状況であれ <code>IGNORE</code> とされた port はビルドしません。 嘘だと思うなら、port のビルドを妨げるのに <code>IGNORE</code> を使ってみてください。</p></li></ul></div><div class=paragraph><p>この変数を使うのは、port が更新できない場合の最後の手段にしてください。 ずっと壊れたままの port は、ports ツリーから完全に削除すべきです。</p></div></div><div class=sect2><h3 id=dads-workarounds>16.20. 必要な回避策<a class=anchor href=#dads-workarounds></a></h3><div class=paragraph><p>古いバージョンの FreeBSD のソフトウェアにあるバグを回避する必要があることがあります。</p></div><div class=ulist><ul><li><p><a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> は、少なくとも 4.8 と 5.0 を含むいくつかのバージョンで、<code>OSVERSION</code> に基づく比較に関してバグがあります。 これは、<code>make describe</code> の最中にエラーを起こすことになりやすく (したがって <code>make index</code> 全体も失敗することに) なります。回避策は、条件比較を括弧にいれることで、たとえば</p><div class="literalblock programlisting"><div class=content><pre>if ( ${OSVERSION} &gt; 500023 )</pre></div></div></li></ul></div><div class=paragraph><p>となります。4.9 と 5.2 で port のインストールテストを行っても、 この問題は<em>見つかりません</em>。</p></div></div><div class=sect2><h3 id=dads-misc>16.21. その他諸々<a class=anchor href=#dads-misc></a></h3><div class=paragraph><p>ファイル <span class=filename>pkg-descr</span> と <span class=filename>pkg-plist</span> はそれぞれ二重にチェックしてください。 再検討してもっと良い記述があればそれに置きかえてください。</p></div><div class=paragraph><p>GNU General Public License (GNU一般公有使用許諾) のコピーは (すでにあるので) コピーしないでください。 お願いします。</p></div><div class=paragraph><p>法律に関することには十分注意をはらってください。 わたしたちに法律に反するような形でソフトウェアの配布をさせないでください!</p></div></div><div class=sect2><h3 id=dads-stuck>16.22. 困ったら…​<a class=anchor href=#dads-stuck></a></h3><div class=paragraph><p>わたしたちに質問を送る前に、 既存の port の例と <span class=filename>bsd.port.mk</span> をちゃんと読んでください! <em>;)</em></p></div><div class=paragraph><p>それでもわからないことがあったら一人で悩まないでどんどん質問してください! <em>:-)</em></p></div></div></div></div><div class=sect1><h2 id=porting-samplem>Chapter 17. <span class=filename>Makefile</span> のサンプル<a class=anchor href=#porting-samplem></a></h2><div class=sectionbody><div class=paragraph><p>これは port の <span class=filename>Makefile</span> を作る際のお手本です。 かぎかっこ ([]) 内のコメントは忘れずに取ってください。</p></div><div class=paragraph><p>変数の順番、段落の間の空行など、 <span class=filename>Makefile</span> を作るときはなるべくこの形式に従ってください。 この形式は重要な情報が簡単に見つけられるように設計されています。 <a href=#porting-portlint>portlint</a> を使って <span class=filename>Makefile</span> をチェックすることが推奨されています。</p></div><div class="literalblock programlisting"><div class=content><pre>[ヘッダ ... どのような port の Makefile かすぐにわかるようになっています]
# New ports collection makefile for:    xdvi
[&#34;version required&#34; 行は、PORTVERSION 変数では port のバージョンを
十分に表現できない場合にのみ必要です。]
# Date created: 26 May 1995
[このソフトウェアを最初に FreeBSD に port した人の名前、つまり、
 この Makefile の最初の版を書いた人です。この port をアップグレー
 ドするとき、この行も変えないでください。]
# Whom:         Satoshi Asami &lt;asami@FreeBSD.org&gt;
#
# $FreeBSD$
[ ^^^^^^^^^ この部分は、CVS ツリーに入れる時に自動的に RCS の ID 文字列に
 置き換えられます。]
#

[port 自体、およびオリジナルのソースを取ってくるところを記述する部分。
 最初は必ず PORTNAME と PORTVERSION, そして必要なら PKGNAME,
 CATEGORIES, 続いて MASTER_SITES が置かれ、さらに MASTER_SITE_SUBDIR が
 置かれることもあります。必要なら PKGNAMEPREFIX と PKGNAMESUFFIX が
 それに続き、そして DISTNAME, EXTRACT_SUFX, DISTFILES が、
 また、その後に必要に応じて EXTRACT_ONLY が置かれます。]
PORTNAME=       xdvi
PORTVERSION=    18.2
CATEGORIES=     print
[MASTER_SITE_* マクロを使用しない場合は、
最後のスラッシュを忘れないように (&#34;/&#34;)!]
MASTER_SITES= ${MASTER_SITE_XCONTRIB}
MASTER_SITE_SUBDIR= applications
DISTNAME=       xdvi-pl18
[ソースファイルが標準の &#34;.tar.gz&#34; 形式でない時にこれを使いましょう]
EXTRACT_SUFX=   .tar.Z

[配布パッチセクション -- ない場合もあります]
PATCH_SITES=    ftp://ftp.sra.co.jp/pub/X11/japanese/
PATCHFILES=     xdvi-18.patch1.gz xdvi-18.patch2.gz

[保守責任者 -- これは *必ず* 必要です。担当者 (あなた) 自身、あるいは
 担当者に素早く連絡をとれる人のアドレスを書いてください。どうしてもこ
 こに自分のアドレスを書くのがいやな人は &#34;ports@FreeBSD.org&#34; と書いて
 もいいです]
MAINTAINER=     asami@FreeBSD.org
COMMENT=       A DVI Previewer for the X Window System

[依存するport -- ない場合もあります]
RUN_DEPENDS=    gs:${PORTSDIR}/print/ghostscript
LIB_DEPENDS=    Xpm.5:${PORTSDIR}/graphics/xpm

[ここには標準の bsd.port.mk の変数で、上のどれにもあてはまらないものを
 書きます]
[コンフィグレーション、コンパイル、インストールなどの時に質問をする
 なら…]
IS_INTERACTIVE=yes
[${DISTNAME} 以外のディレクトリにソースが展開されるなら…]
WRKSRC= ${WRKDIR}/xdvi-new
[配布されているパッチが ${WRKSRC} に対する相対パスで作られてい
 い場合にこの変数の指定が必要かも…]
PATCH_DIST_STRIP=       -p1
[GNU autoconf によって生成された &#34;configure&#34; スクリプトを走らせたいなら…]
GNU_CONFIGURE=  yes
[/usr/bin/makeでなく、GNU make を使わないといけないなら…]
USE_GMAKE=      yes
[これが X のアプリケーションで、&#34;xmkmf -a&#34; を走らせたいなら…]
USE_IMAKE=      yes
[などなど]

[下の方のルールで使う非標準の変数]
MY_FAVORITE_RESPONSE=   &#34;yeah, right&#34;

[そして、特別なターゲット、使用順に]
pre-fetch:
        i go fetch something, yeah

post-patch:
        i need to do something after patch, great

pre-install:
        and then some more stuff before installing, wow

[最後には必ず]
.include &lt;bsd.port.mk&gt;</pre></div></div></div></div><div class=sect1><h2 id=porting-autoplist>Chapter 18. パッキングリストの自動生成<a class=anchor href=#porting-autoplist></a></h2><div class=sectionbody><div class=paragraph><p>まず、あなたの port に <span class=filename>pkg-plist</span> がないことを除けば完成していることを確認してください。</p></div><div class=paragraph><p>次に、あなたの port をインストールする一時ディレクトリを作成して、 依存するものをすべてインストールしてください。 <em>port-type</em> は X アプリケーションではない port については <code>local</code>、 XFree86 4 またはそれより前の XFree86 のディレクトリ階層にインストールする ports については、それぞれ <code>x11-4</code> または <code>x11</code> にすべきです。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/tmp/port-name</span>
<span class=c># mtree -U -f /etc/mtree/BSD.port-type.dist -d -e -p /var/tmp/port-name</span>
<span class=c># make depends PREFIX=/var/tmp/port-name</span></code></pre></div></div><div class=paragraph><p>このディレクトリ構造を新しいファイルに保存してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># (cd /var/tmp/port-name &amp;&amp; find -d * -type d) | sort &gt; OLD-DIRS</span></code></pre></div></div><div class=paragraph><p>空の <span class=filename>pkg-plist</span> ファイルを作成してください。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch pkg-plist</span></code></pre></div></div><div class=paragraph><p>もしあなたの port が <code>PREFIX</code> にちゃんと従うなら、 ここで port をインストールしてパッキングリストを作ることができます。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make install PREFIX=/var/tmp</span>
<span class=c># (cd /var/tmp/port-name &amp;&amp; find -d * \! -type d) | sort &gt; pkg-plist</span></code></pre></div></div><div class=paragraph><p>新しく生成されたディレクトリはすべてパッキングリストに追加する必要があります。</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># (cd /var/tmp/port-name &amp;&amp; find -d * -type d) | sort | comm -13 OLD-DIRS - | sort -r | sed -e &#39;s#^#@dirrm #&#39; &gt;&gt; pkg-plist</span></code></pre></div></div><div class=paragraph><p>最後にパッキングリストを手で整える必要があります; <em>すべて</em>が自動化されているわけではありません。 マニュアルはパッキングリストに記述するのではなく、 port の <span class=filename>Makefile</span> 中の <code>MAN_n_</code> に 記述しなければなりません。 ユーザ設定ファイルは削除するか <span class=filename>filename.sample</span> としてインストールされなければなりません。 また <span class=filename>info/dir</span> ファイルはリストに含めず、 <a href=#porting-info>info ファイル</a>に記述されているように、 適切な <span class=filename>install-info</span> 行に追加しなければなりません。 port によってインストールされるライブラリは、 <a href=#porting-shlibs>共有ライブラリ</a> のセクションで示したように記載されるべきです。</p></div><div class=paragraph><p>または、<span class=filename>/usr/ports/Tools/scripts/</span> にある <code>plist</code> スクリプトを使ってパッキングリストを自動的に生成してください。</p></div></div></div><div class=sect1><h2 id=changes>Chapter 19. この文書と ports システムの変更<a class=anchor href=#changes></a></h2><div class=sectionbody><div class=paragraph><p>もしあなたが、たくさんの ports の保守をしているのであれば、 <a href=https://lists.FreeBSD.org/subscription/freebsd-ports>FreeBSD ports メーリングリスト</a> の内容を読むことを考えてください。 ports のしくみについての重要な変更点はここに アナウンスされます。 最新の変更点については、いつでも、 <a href=http://www.FreeBSD.org/cgi/cvsweb.cgi/ports/Mk/bsd.port.mk>bsd.port.mk の CVS ログ</a>で詳細な情報を得ることができます。</p></div><div class=paragraph><p>port メンテナを補助するほかのリソースとして、 <code>bento クラスタ</code>に置かれている <a href=http://bento.FreeBSD.org/>パッケージビルド記録とエラー</a>一覧、また <a href=http://people.FreeBSD.org/\~fenner/portsurvey/>FreeBSD Ports distfiles 調査</a>があります。</p></div></div></div></div><hr><div class=last-modified><p><strong>最終更新日</strong>: 2021年12月11日 by <a href="https://cgit.freebsd.org/doc/commit/?id=2b027dd017" target=_blank>Sergio Carlavilla Delgado</a></p></div><div class=buttons><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#why-port>Chapter 1. はじめに</a></li><li><a href=#own-port>Chapter 2. 自分で port を作成するには</a></li><li><a href=#quick-porting>Chapter 3. 分間 porting</a><ul><li><a href=#porting-makefile>3.1. <span class=filename>Makefile</span> の作成</a></li><li><a href=#porting-desc>3.2. package 記述ファイルの作成</a></li><li><a href=#porting-checksum>3.3. チェックサムファイルの作成</a></li><li><a href=#porting-testing>3.4. port のテスト</a></li><li><a href=#porting-portlint>3.5. <code>portlint</code> によるチェック</a></li><li><a href=#porting-submitting>3.6. port の提出</a></li></ul></li><li><a href=#slow>Chapter 4. 本格的な port</a><ul><li><a href=#slow-work>4.1. port 構築の詳細</a></li><li><a href=#slow-sources>4.2. オリジナルのソースの入手</a></li><li><a href=#slow-modifying>4.3. port の修正</a></li><li><a href=#slow-patch>4.4. パッチの適用</a></li><li><a href=#slow-configure>4.5. コンフィグレーション</a></li><li><a href=#slow-user-input>4.6. ユーザからの入力の扱い</a></li></ul></li><li><a href=#makefile>Chapter 5. <span class=filename>Makefile</span> の作成</a><ul><li><a href=#makefile-source>5.1. オリジナルのソース</a></li><li><a href=#makefile-naming>5.2. 名前の付け方</a></li><li><a href=#makefile-categories>5.3. カテゴリ分類</a></li><li><a href=#makefile-distfiles>5.4. 配布ファイル</a></li><li><a href=#makefile-maintainer>5.5. <code>MAINTAINER</code></a></li><li><a href=#makefile-comment>5.6. <code>COMMENT</code></a></li><li><a href=#makefile-depend>5.7. 依存関係</a></li><li><a href=#makefile-wrkdir>5.8. 作業ディレクトリの指定</a></li><li><a href=#conflicts>5.9. <code>CONFLICTS</code></a></li><li><a href=#makefile-build>5.10. ビルドのメカニズム</a></li></ul></li><li><a href=#special>Chapter 6. 特別な配慮</a><ul><li><a href=#porting-shlibs>6.1. 共有ライブラリ</a></li><li><a href=#porting-restrictions>6.2. 配布制限がある ports</a></li><li><a href=#using-perl>6.3. <code>perl</code> の利用</a></li><li><a href=#using-x11>6.4. X11 の利用</a></li><li><a href=#using-automake>6.5. <code>automake</code>, <code>autoconf</code> および <code>libtool</code> の利用</a></li><li><a href=#using-gnome>6.6. GNOME の利用</a></li><li><a href=#using-kde>6.7. KDE の利用</a></li><li><a href=#using-bison>6.8. Bison の利用</a></li><li><a href=#using-java>6.9. Java の利用</a></li><li><a href=#using-python>6.10. Python の利用</a></li><li><a href=#using-emacs>6.11. Emacs の利用</a></li><li><a href=#using-ruby>6.12. Ruby の利用</a></li><li><a href=#using-sdl>6.13. SDL の利用</a></li></ul></li><li><a href=#porting-masterdir>Chapter 7. <code>MASTERDIR</code></a></li><li><a href=#shared>Chapter 8. 共有ライブラリのバージョン</a></li><li><a href=#porting-manpages>Chapter 9. マニュアルページ</a></li><li><a href=#porting-motif>Chapter 10. Motif を必要とする port</a><ul><li><a href=#motif-use>10.1. <code>USE_MOTIF</code></a></li><li><a href=#motif-lib>10.2. <code>MOTIFLIB</code></a></li></ul></li><li><a href=#x11-fonts>Chapter 11. X11 のフォント</a></li><li><a href=#porting-info>Chapter 12. Info ファイル</a></li><li><a href=#pkg-files>Chapter 13. <span class=filename>pkg-*</span> ファイル</a><ul><li><a href=#porting-message>13.1. <span class=filename>pkg-message</span></a></li><li><a href=#pkg-install>13.2. <span class=filename>pkg-install</span></a></li><li><a href=#pkg-deinstall>13.3. <span class=filename>pkg-deinstall</span></a></li><li><a href=#pkg-req>13.4. <span class=filename>pkg-req</span></a></li><li><a href=#porting-plist>13.5. make の変数にあわせた <span class=filename>pkg-plist</span> の変更</a></li><li><a href=#pkg-names>13.6. <span class=filename>pkg-*</span> ファイルの名前変更</a></li></ul></li><li><a href=#testing>Chapter 14. port のテスト</a><ul><li><a href=#testing-portlint>14.1. portlint</a></li><li><a href=#porting-prefix>14.2. <code>PREFIX</code></a></li><li><a href=#testing-freshports>14.3. FreshPorts 正当性テスト</a></li></ul></li><li><a href=#port-upgrading>Chapter 15. アップグレード</a></li><li><a href=#porting-dads>Chapter 16. やっていいことといけないこと</a><ul><li><a href=#dads-intro>16.1. はじめに</a></li><li><a href=#dads-strip>16.2. バイナリの strip</a></li><li><a href=#dads-install>16.3. <code>INSTALL_*</code> マクロ</a></li><li><a href=#porting-wrkdir>16.4. <code>WRKDIR</code></a></li><li><a href=#porting-wrkdirprefix>16.5. <code>WRKDIRPREFIX</code></a></li><li><a href=#porting-versions>16.6. OS の種類やバージョンの識別</a></li><li><a href=#freebsd-versions>16.7. __FreeBSD_version の値</a></li><li><a href=#dads-after-port-mk>16.8. <span class=filename>bsd.port.mk</span> の後に書くこと</a></li><li><a href=#dads-documentation>16.9. 付加的な文書のインストール</a></li><li><a href=#dads-subdirs>16.10. ディレクトリ構成</a></li><li><a href=#porting-cleaning>16.11. 空のディレクトリの削除</a></li><li><a href=#dads-uid>16.12. UID</a></li><li><a href=#dads-rational>16.13. 合理的な port</a></li><li><a href=#dads-cc>16.14. <code>CC</code> および <code>CXX</code> の尊重</a></li><li><a href=#dads-cflags>16.15. <code>CFLAGS</code> の尊重</a></li><li><a href=#dads-config>16.16. コンフィグレーション (設定) ファイル</a></li><li><a href=#dads-freedback>16.17. フィードバック</a></li><li><a href=#dads-readme>16.18. <span class=filename>README.html</span></a></li><li><a href=#dads-broken>16.19. Port に <code>BROKEN</code>, <code>FORBIDDEN</code> などの印をつける</a></li><li><a href=#dads-workarounds>16.20. 必要な回避策</a></li><li><a href=#dads-misc>16.21. その他諸々</a></li><li><a href=#dads-stuck>16.22. 困ったら…​</a></li></ul></li><li><a href=#porting-samplem>Chapter 17. <span class=filename>Makefile</span> のサンプル</a></li><li><a href=#porting-autoplist>Chapter 18. パッキングリストの自動生成</a></li><li><a href=#changes>Chapter 19. この文書と ports システムの変更</a></li></ul></nav><hr><div class=resources><h3>リソース</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="PDF 版のダウンロード"></i><a href=https://download.freebsd.org/doc/ja/books/porters-handbook/porters-handbook_ja.pdf>PDF 版のダウンロード</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/ja/book target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/ja/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>日本語</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/ja class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/ja/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>